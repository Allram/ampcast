(globalThis.webpackChunkampcast=globalThis.webpackChunkampcast||[]).push([[296],{6998:function(e){e.exports=function(e,t){if(null==t&&(t={fuzzy:!0}),/youtu\.?be/.test(e)){var n,r=[/youtu\.be\/([^#\&\?]{11})/,/\?v=([^#\&\?]{11})/,/\&v=([^#\&\?]{11})/,/embed\/([^#\&\?]{11})/,/\/v\/([^#\&\?]{11})/];for(n=0;n<r.length;++n)if(r[n].test(e))return r[n].exec(e)[1];if(t.fuzzy){var i=e.split(/[\/\&\?=#\.\s]/g);for(n=0;n<i.length;++n)if(/^[^#\&\?]{11}$/.test(i[n]))return i[n]}}return null}},2763:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),r=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Float32Array;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t instanceof e?(this.ArrayType=t.ArrayType,this.real=new this.ArrayType(t.real),this.imag=new this.ArrayType(t.imag)):(this.ArrayType=n,this.real=new this.ArrayType(t),this.imag=new this.ArrayType(this.real.length)),this.length=this.real.length}return n(e,[{key:"toString",value:function(){var e=[];return this.forEach((function(t,n){e.push("("+t.real.toFixed(2)+", "+t.imag.toFixed(2)+")")})),"["+e.join(", ")+"]"}},{key:"forEach",value:function(e){for(var t=this.length,n=Object.seal(Object.defineProperties({},{real:{writable:!0},imag:{writable:!0}})),r=0;r<t;r++)n.real=this.real[r],n.imag=this.imag[r],e(n,r,t)}},{key:"map",value:function(e){var t=this;return this.forEach((function(n,r,i){e(n,r,i),t.real[r]=n.real,t.imag[r]=n.imag})),this}},{key:"conjugate",value:function(){return new e(this).map((function(e){e.imag*=-1}))}},{key:"magnitude",value:function(){var e=new this.ArrayType(this.length);return this.forEach((function(t,n){e[n]=Math.sqrt(t.real*t.real+t.imag*t.imag)})),e}}]),e}();t.default=r},4843:(e,t,n)=>{"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.rS=function(e){return function(e){return e instanceof l&&e||new l(e)}(e).InvFFT()};var i,a=(i=n(2763))&&i.__esModule?i:{default:i},o=Math.PI,s=Math.SQRT1_2,l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"FFT",value:function(){return c(this,!1)}},{key:"InvFFT",value:function(){return c(this,!0)}},{key:"frequencyMap",value:function(e){return this.FFT().map(e).InvFFT()}}]),t}(a.default);function c(e,t){var n=e.length;return n&n-1?function(e,t){var n=e.length;if(1===n)return e;for(var r=new l(n,e.ArrayType),i=function(e){for(var t=Math.sqrt(e),n=3;n<=t;){if(e%n==0)return n;n+=2}return e}(n),a=n/i,s=1/Math.sqrt(i),u=new l(a,e.ArrayType),d=0;d<i;d++){for(var m=0;m<a;m++)u.real[m]=e.real[m*i+d],u.imag[m]=e.imag[m*i+d];a>1&&(u=c(u,t));for(var h=Math.cos(2*o*d/n),f=(t?-1:1)*Math.sin(2*o*d/n),p=1,v=0,b=0;b<n;b++){var g=u.real[b%a],y=u.imag[b%a];r.real[b]+=p*g-v*y,r.imag[b]+=p*y+v*g;var w=[p*h-v*f,v=p*f+v*h];p=w[0],v=w[1]}}for(var E=0;E<n;E++)e.real[E]=s*r.real[E],e.imag[E]=s*r.imag[E];return e}(e,t):function(e,t){for(var n=e.length,r=function(e){for(var t=e.length,n=new Set,r=0;r<t;r++){var i=u(r,t);if(!n.has(r)){var a=[e.real[i],e.real[r]];e.real[r]=a[0],e.real[i]=a[1];var o=[e.imag[i],e.imag[r]];e.imag[r]=o[0],e.imag[i]=o[1],n.add(i)}}return e}(e),i=r.real,a=r.imag,l=1;l<n;){for(var c=Math.cos(o/l),d=(t?-1:1)*Math.sin(o/l),m=0;m<n/(2*l);m++)for(var h=1,f=0,p=0;p<l;p++){var v=2*m*l+p,b=v+l,g=i[v],y=a[v],w=h*i[b]-f*a[b],E=f*i[b]+h*a[b];i[v]=s*(g+w),a[v]=s*(y+E),i[b]=s*(g-w),a[b]=s*(y-E);var x=[h*c-f*d,h*d+f*c];h=x[0],f=x[1]}l<<=1}return r}(e,t)}function u(e,t){for(var n=0;t>1;)n<<=1,n+=1&e,e>>=1,t>>=1;return n}},745:(e,t,n)=>{"use strict";var r=n(3935);t.s=r.createRoot,r.hydrateRoot},6657:e=>{e.exports=function(e,t,n){"use strict";if(e===t)return 1;if(""===t)return 0;var r=0,i=e.toLowerCase(),a=e.length,o=t.toLowerCase(),s=t.length,l=0,c=1;n=n?1-n:0;for(var u=0;u<s;u+=1){var d=i.indexOf(o[u],l);if(-1===d){if(!n)return 0;c+=n}else{var m=0;l===d?m=.7:(m=.1," "===e[d-1]&&(m+=.8)),e[d]===t[u]&&(m+=.1),r+=m,l=d+1}}var h=.5*(r/a+r/s)/c;return o[0]===i[0]&&h<.85&&(h+=.15),h}},1655:(e,t,n)=>{"use strict";var r=n(7294),i=n(745),a=n(6657),o=n.n(a),s=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function l(e){return null!=e}function c(e){return s(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{const r="ampcast-loaded";let i=document.querySelector(`script[src="${e}"]`);(null==i?void 0:i.hasAttribute(r))?t():(i||(i=document.createElement("script"),i.async=!0,i.src=e),i.addEventListener("load",(function(){this.setAttribute(r,""),t()})),i.addEventListener("error",(()=>n(`Failed to load script: '${e}'`))),i.parentElement||document.head.appendChild(i))}))}))}function u(e,t=1){if(t<=0)return[];const n=[...e],r=[];for(;n.length;)r.push(n.splice(0,t));return r}function d(e,t){const n=[],r=[];for(const i of e)t(i)?n.push(i):r.push(i);return[n,r]}function m(e){return e.filter(((e,t,n)=>t===n.findIndex((t=>e===t))))}function h(e,t){return e.filter(((e,n,r)=>n===r.findIndex((n=>e[t]===n[t]))))}function f(e){let t=e.length;for(;t>0;){const n=Math.floor(Math.random()*t);t--;const r=e[t];e[t]=e[n],e[n]=r}return e}function p(e=Date.now()){return`${(e=new Date(e)).getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function v(e){return p(e).slice(0,7)}function b(e){return new Date(Math.round(1e3*(e||0))).toISOString().slice(11,19).replace(/^[0:]+(.{4,})$/,"$1")}function g(e){e.preventDefault()}function y(e){e.stopPropagation()}function w(e){e.preventDefault(),e.stopPropagation()}function E(e,t){return 1===e.length?e[0]:(void 0!==t&&(e=e.filter((e=>e!==t))),e[Math.floor(Math.random()*e.length)])}function x(e,t={}){return m(Object.keys(e).concat(Object.keys(t))).reduce(((n,r)=>(void 0!==e[r]?n[r]=e[r]:void 0!==t[r]&&(n[r]=t[r]),n)),{})}function k(e,t,n){const r=e.filter(t,n);return 0===r.length?e:r}function S(e,t,n=.9){return Math.max(o()(e,t,.99),o()(t,e,.99))>=n}const C=document.createElement("p");function T(e){return C.innerHTML=e,C.textContent||""}class P{constructor(e="",t=!1,n=window.console){const r=e?` ${e}:`:"",i=(e,t)=>e&&t?`${e}/${t}`:t||e,a=(...t)=>{e.startsWith(P.only)&&n.log(...t)};this.log=(...e)=>a(`##${r}`,...e),this.warn=(...e)=>a(`###${r}`,...e),this.error=t=>{e.startsWith(P.only)&&(a(`####${r} ERROR`),n.error(t))},t&&(this.next=this.log,this.complete=()=>this.log("***complete***")),this.id=r=>new P(i(e,r),t,n),this.rx=t=>new P(i(e,t),!0,n),this.only=()=>this}}P.only="";const A=P,I=new Map,O={get length(){return I.size},clear(){I.clear()},key(e){var t;return null!==(t=[...I.keys()][e])&&void 0!==t?t:null},getItem(e){var t;return null!==(t=I.get(String(e)))&&void 0!==t?t:null},setItem(e,t){I.set(String(e),String(t))},removeItem(e){I.delete(String(e))}},M=O,N=new A("LiteStorage");class ${constructor(e,t="local"){const n=`${t}-${e}`;if($.ids.includes(n))throw Error(`Duplicate storageId: ${n}`);switch($.ids.push(n),this.id=`ampcast/${e}`,t){case"local":this.storage=localStorage;break;case"session":this.storage=sessionStorage;break;case"memory":this.storage=M}}getBoolean(e){const t=this.getItem(e);return!!t&&"false"!==t}setBoolean(e,t){this.setItem(e,String(!!t))}getJson(e,t=null){const n=this.getItem(e);try{return n?JSON.parse(n):t}catch(e){N.error(e)}return null!=t?t:null}setJson(e,t){try{null==t?this.removeItem(e):this.setItem(e,JSON.stringify(t))}catch(e){N.error(e)}}getNumber(e,t=0){var n;const r=Number(null!==(n=this.getItem(e))&&void 0!==n?n:t);return isNaN(r)?t:r}setNumber(e,t){this.setItem(e,String(Number(t)||0))}getString(e,t=""){var n;return String(null!==(n=this.getItem(e))&&void 0!==n?n:t)}setString(e,t){this.setItem(e,t)}getItem(e){return this.storage.getItem(`${this.id}/${e}`)}setItem(e,t){e=`${this.id}/${e}`,null==t?this.storage.removeItem(e):this.storage.setItem(e,t)}removeItem(e){this.storage.removeItem(`${this.id}/${e}`)}clear(){const e=`${this.id}/`,t=[];for(let n=0;n<this.storage.length;n++){const r=this.storage.key(n);r.startsWith(e)&&t.push(r)}t.forEach((e=>this.storage.removeItem(e)))}}$.ids=[];const z=$,j=(0,n(3631).qY)(),L=(null==j?void 0:j.name)||"unknown",R=/^edge/.test(L)?"Microsoft Edge":L.replace(/^\w/,(e=>e.toUpperCase())),D=(null==j?void 0:j.version)||"0",_=(null==j?void 0:j.os)||"unknown",F="Mac OS"===_?"metaKey":"ctrlKey",V="Mac OS"===_?"âŒ˜":"Ctrl",U={name:L,displayName:R,version:D,os:_,desktop:!/^(iOS|Android OS|BlackBerry OS|Windows Mobile|Amazon OS)$/.test(_),ctrlKey:F,ctrlKeyStr:V},B=new z("layout"),H={get:(e,t=0)=>B.getNumber(e,t),set(e,t){B.setNumber(e,t)}};var Y=function(e,t){return Y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Y(e,t)};function K(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Y(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function W(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function q(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function J(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function Q(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function G(e){return this instanceof G?(this.v=e,this):new G(e)}function X(e){return"function"==typeof e}function Z(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Object.create,Object.create;var ee=Z((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function te(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var ne=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=q(a),s=o.next();!s.done;s=o.next())s.value.remove(this)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var l=this.initialTeardown;if(X(l))try{l()}catch(e){i=e instanceof ee?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var u=q(c),d=u.next();!d.done;d=u.next()){var m=d.value;try{ae(m)}catch(e){i=null!=i?i:[],e instanceof ee?i=Q(Q([],J(i)),J(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}if(i)throw new ee(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)ae(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&te(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&te(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}(),re=ne.EMPTY;function ie(e){return e instanceof ne||e&&"closed"in e&&X(e.remove)&&X(e.add)&&X(e.unsubscribe)}function ae(e){X(e)?e():e.unsubscribe()}var oe={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},se={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=se.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,Q([e,t],J(n))):setTimeout.apply(void 0,Q([e,t],J(n)))},clearTimeout:function(e){var t=se.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function le(e){se.setTimeout((function(){var t=oe.onUnhandledError;if(!t)throw e;t(e)}))}function ce(){}var ue=de("C",void 0,void 0);function de(e,t,n){return{kind:e,value:t,error:n}}var me=null;function he(e){if(oe.useDeprecatedSynchronousErrorHandling){var t=!me;if(t&&(me={errorThrown:!1,error:null}),e(),t){var n=me,r=n.errorThrown,i=n.error;if(me=null,r)throw i}}else e()}var fe=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,ie(t)&&t.add(n)):n.destination=Ee,n}return K(t,e),t.create=function(e,t,n){return new ge(e,t,n)},t.prototype.next=function(e){this.isStopped?we(function(e){return de("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?we(de("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?we(ue,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(ne),pe=Function.prototype.bind;function ve(e,t){return pe.call(e,t)}var be=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){ye(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){ye(e)}else ye(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){ye(e)}},e}(),ge=function(e){function t(t,n,r){var i,a,o=e.call(this)||this;return X(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:o&&oe.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},i={next:t.next&&ve(t.next,a),error:t.error&&ve(t.error,a),complete:t.complete&&ve(t.complete,a)}):i=t,o.destination=new be(i),o}return K(t,e),t}(fe);function ye(e){var t;oe.useDeprecatedSynchronousErrorHandling?(t=e,oe.useDeprecatedSynchronousErrorHandling&&me&&(me.errorThrown=!0,me.error=t)):le(e)}function we(e,t){var n=oe.onStoppedNotification;n&&se.setTimeout((function(){return n(e,t)}))}var Ee={closed:!0,next:ce,error:function(e){throw e},complete:ce},xe="function"==typeof Symbol&&Symbol.observable||"@@observable";function ke(e){return e}var Se=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this,i=function(e){return e&&e instanceof fe||function(e){return e&&X(e.next)&&X(e.error)&&X(e.complete)}(e)&&ie(e)}(e)?e:new ge(e,t,n);return he((function(){var e=r,t=e.operator,n=e.source;i.add(t?t.call(i,n):n?r._subscribe(i):r._trySubscribe(i))})),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Ce(t))((function(t,r){var i=new ge({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[xe]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?ke:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=Ce(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Ce(e){var t;return null!==(t=null!=e?e:oe.Promise)&&void 0!==t?t:Promise}var Te=Z((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),Pe=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return K(t,e),t.prototype.lift=function(e){var t=new Ae(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new Te},t.prototype.next=function(e){var t=this;he((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=q(t.currentObservers),a=i.next();!a.done;a=i.next())a.value.next(e)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;he((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;he((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,a=n.observers;return r||i?re:(this.currentObservers=null,a.push(e),new ne((function(){t.currentObservers=null,te(a,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new Se;return e.source=this,e},t.create=function(e,t){return new Ae(e,t)},t}(Se),Ae=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return K(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:re},t}(Pe),Ie=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return K(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Pe);function Oe(e){return function(t){if(function(e){return X(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function Me(e,t,n,r,i){return new Ne(e,t,n,r,i)}var Ne=function(e){function t(t,n,r,i,a,o){var s=e.call(this,t)||this;return s.onFinalize=a,s.shouldUnsubscribe=o,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return K(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(fe);function $e(e,t,n){var r=X(e)||t||n?{next:e,error:t,complete:n}:e;return r?Oe((function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(Me(t,(function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)}),(function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()}),(function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)}),(function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)})))})):ke}function ze(e,t){return Oe((function(n,r){var i=0;n.subscribe(Me(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}function je(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function Le(e){return Math.min(1,Math.max(0,e))}function Re(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function De(e){return e<=1?"".concat(100*Number(e),"%"):e}function _e(e){return 1===e.length?"0"+e:String(e)}function Fe(e,t,n){e=je(e,255),t=je(t,255),n=je(n,255);var r=Math.max(e,t,n),i=Math.min(e,t,n),a=0,o=0,s=(r+i)/2;if(r===i)o=0,a=0;else{var l=r-i;switch(o=s>.5?l/(2-r-i):l/(r+i),r){case e:a=(t-n)/l+(t<n?6:0);break;case t:a=(n-e)/l+2;break;case n:a=(e-t)/l+4}a/=6}return{h:a,s:o,l:s}}function Ve(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*n*(t-e):n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function Ue(e,t,n){e=je(e,255),t=je(t,255),n=je(n,255);var r=Math.max(e,t,n),i=Math.min(e,t,n),a=0,o=r,s=r-i,l=0===r?0:s/r;if(r===i)a=0;else{switch(r){case e:a=(t-n)/s+(t<n?6:0);break;case t:a=(n-e)/s+2;break;case n:a=(e-t)/s+4}a/=6}return{h:a,s:l,v:o}}function Be(e,t,n,r){var i=[_e(Math.round(e).toString(16)),_e(Math.round(t).toString(16)),_e(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function He(e){return Ye(e)/255}function Ye(e){return parseInt(e,16)}var Ke={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var We="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),qe="[\\s|\\(]+(".concat(We,")[,|\\s]+(").concat(We,")[,|\\s]+(").concat(We,")\\s*\\)?"),Je="[\\s|\\(]+(".concat(We,")[,|\\s]+(").concat(We,")[,|\\s]+(").concat(We,")[,|\\s]+(").concat(We,")\\s*\\)?"),Qe={CSS_UNIT:new RegExp(We),rgb:new RegExp("rgb"+qe),rgba:new RegExp("rgba"+Je),hsl:new RegExp("hsl"+qe),hsla:new RegExp("hsla"+Je),hsv:new RegExp("hsv"+qe),hsva:new RegExp("hsva"+Je),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Ge(e){return Boolean(Qe.CSS_UNIT.exec(String(e)))}var Xe=function(){function e(t,n){var r;if(void 0===t&&(t=""),void 0===n&&(n={}),t instanceof e)return t;"number"==typeof t&&(t=function(e){return{r:e>>16,g:(65280&e)>>8,b:255&e}}(t)),this.originalInput=t;var i=function(e){var t,n,r,i={r:0,g:0,b:0},a=1,o=null,s=null,l=null,c=!1,u=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(Ke[e])e=Ke[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var n=Qe.rgb.exec(e);return n?{r:n[1],g:n[2],b:n[3]}:(n=Qe.rgba.exec(e))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Qe.hsl.exec(e))?{h:n[1],s:n[2],l:n[3]}:(n=Qe.hsla.exec(e))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Qe.hsv.exec(e))?{h:n[1],s:n[2],v:n[3]}:(n=Qe.hsva.exec(e))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Qe.hex8.exec(e))?{r:Ye(n[1]),g:Ye(n[2]),b:Ye(n[3]),a:He(n[4]),format:t?"name":"hex8"}:(n=Qe.hex6.exec(e))?{r:Ye(n[1]),g:Ye(n[2]),b:Ye(n[3]),format:t?"name":"hex"}:(n=Qe.hex4.exec(e))?{r:Ye(n[1]+n[1]),g:Ye(n[2]+n[2]),b:Ye(n[3]+n[3]),a:He(n[4]+n[4]),format:t?"name":"hex8"}:!!(n=Qe.hex3.exec(e))&&{r:Ye(n[1]+n[1]),g:Ye(n[2]+n[2]),b:Ye(n[3]+n[3]),format:t?"name":"hex"}}(e)),"object"==typeof e&&(Ge(e.r)&&Ge(e.g)&&Ge(e.b)?(t=e.r,n=e.g,r=e.b,i={r:255*je(t,255),g:255*je(n,255),b:255*je(r,255)},c=!0,u="%"===String(e.r).substr(-1)?"prgb":"rgb"):Ge(e.h)&&Ge(e.s)&&Ge(e.v)?(o=De(e.s),s=De(e.v),i=function(e,t,n){e=6*je(e,360),t=je(t,100),n=je(n,100);var r=Math.floor(e),i=e-r,a=n*(1-t),o=n*(1-i*t),s=n*(1-(1-i)*t),l=r%6;return{r:255*[n,o,a,a,s,n][l],g:255*[s,n,n,o,a,a][l],b:255*[a,a,s,n,n,o][l]}}(e.h,o,s),c=!0,u="hsv"):Ge(e.h)&&Ge(e.s)&&Ge(e.l)&&(o=De(e.s),l=De(e.l),i=function(e,t,n){var r,i,a;if(e=je(e,360),t=je(t,100),n=je(n,100),0===t)i=n,a=n,r=n;else{var o=n<.5?n*(1+t):n+t-n*t,s=2*n-o;r=Ve(s,o,e+1/3),i=Ve(s,o,e),a=Ve(s,o,e-1/3)}return{r:255*r,g:255*i,b:255*a}}(e.h,o,l),c=!0,u="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(a=e.a)),a=Re(a),{ok:c,format:e.format||u,r:Math.min(255,Math.max(i.r,0)),g:Math.min(255,Math.max(i.g,0)),b:Math.min(255,Math.max(i.b,0)),a}}(t);this.originalInput=t,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(r=n.format)&&void 0!==r?r:i.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},e.prototype.getLuminance=function(){var e=this.toRgb(),t=e.r/255,n=e.g/255,r=e.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(e){return this.a=Re(e),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){return 0===this.toHsl().s},e.prototype.toHsv=function(){var e=Ue(this.r,this.g,this.b);return{h:360*e.h,s:e.s,v:e.v,a:this.a}},e.prototype.toHsvString=function(){var e=Ue(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.v);return 1===this.a?"hsv(".concat(t,", ").concat(n,"%, ").concat(r,"%)"):"hsva(".concat(t,", ").concat(n,"%, ").concat(r,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var e=Fe(this.r,this.g,this.b);return{h:360*e.h,s:e.s,l:e.l,a:this.a}},e.prototype.toHslString=function(){var e=Fe(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.l);return 1===this.a?"hsl(".concat(t,", ").concat(n,"%, ").concat(r,"%)"):"hsla(".concat(t,", ").concat(n,"%, ").concat(r,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(e){return void 0===e&&(e=!1),Be(this.r,this.g,this.b,e)},e.prototype.toHexString=function(e){return void 0===e&&(e=!1),"#"+this.toHex(e)},e.prototype.toHex8=function(e){return void 0===e&&(e=!1),function(e,t,n,r,i){var a,o=[_e(Math.round(e).toString(16)),_e(Math.round(t).toString(16)),_e(Math.round(n).toString(16)),_e((a=r,Math.round(255*parseFloat(a)).toString(16)))];return i&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))&&o[3].startsWith(o[3].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}(this.r,this.g,this.b,this.a,e)},e.prototype.toHex8String=function(e){return void 0===e&&(e=!1),"#"+this.toHex8(e)},e.prototype.toHexShortString=function(e){return void 0===e&&(e=!1),1===this.a?this.toHexString(e):this.toHex8String(e)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),n=Math.round(this.b);return 1===this.a?"rgb(".concat(e,", ").concat(t,", ").concat(n,")"):"rgba(".concat(e,", ").concat(t,", ").concat(n,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var e=function(e){return"".concat(Math.round(100*je(e,255)),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var e=function(e){return Math.round(100*je(e,255))};return 1===this.a?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var e="#"+Be(this.r,this.g,this.b,!1),t=0,n=Object.entries(Ke);t<n.length;t++){var r=n[t],i=r[0];if(e===r[1])return i}return!1},e.prototype.toString=function(e){var t=Boolean(e);e=null!=e?e:this.format;var n=!1,r=this.a<1&&this.a>=0;return t||!r||!e.startsWith("hex")&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this.a?this.toName():this.toRgbString()},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.l+=t/100,n.l=Le(n.l),new e(n)},e.prototype.brighten=function(t){void 0===t&&(t=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-t/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-t/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-t/100*255))),new e(n)},e.prototype.darken=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.l-=t/100,n.l=Le(n.l),new e(n)},e.prototype.tint=function(e){return void 0===e&&(e=10),this.mix("white",e)},e.prototype.shade=function(e){return void 0===e&&(e=10),this.mix("black",e)},e.prototype.desaturate=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.s-=t/100,n.s=Le(n.s),new e(n)},e.prototype.saturate=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.s+=t/100,n.s=Le(n.s),new e(n)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var n=this.toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,new e(n)},e.prototype.mix=function(t,n){void 0===n&&(n=50);var r=this.toRgb(),i=new e(t).toRgb(),a=n/100;return new e({r:(i.r-r.r)*a+r.r,g:(i.g-r.g)*a+r.g,b:(i.b-r.b)*a+r.b,a:(i.a-r.a)*a+r.a})},e.prototype.analogous=function(t,n){void 0===t&&(t=6),void 0===n&&(n=30);var r=this.toHsl(),i=360/n,a=[this];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,a.push(new e(r));return a},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){void 0===t&&(t=6);for(var n=this.toHsv(),r=n.h,i=n.s,a=n.v,o=[],s=1/t;t--;)o.push(new e({h:r,s:i,v:a})),a=(a+s)%1;return o},e.prototype.splitcomplement=function(){var t=this.toHsl(),n=t.h;return[this,new e({h:(n+72)%360,s:t.s,l:t.l}),new e({h:(n+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var n=this.toRgb(),r=new e(t).toRgb(),i=n.a+r.a*(1-n.a);return new e({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var n=this.toHsl(),r=n.h,i=[this],a=360/t,o=1;o<t;o++)i.push(new e({h:(r+o*a)%360,s:n.s,l:n.l}));return i},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();const Ze=JSON.parse('{"name":"Astronaut","backgroundColor":"#000000","textColor":"#95a5d6","frameColor":"#141415","frameTextColor":"#b1bdcd","selectedBackgroundColor":"#221650","selectedTextColor":"#ffffff","spacing":0.72,"roundness":0.57,"flat":false}'),et=JSON.parse('{"name":"Black Gold","backgroundColor":"#0d0c0c","textColor":"#a9aa92","frameColor":"#1c1c12","frameTextColor":"#e8e8bf","selectedBackgroundColor":"#545549","selectedTextColor":"#ffffff","spacing":0.375,"roundness":0.25,"flat":false}'),tt=JSON.parse('{"name":"(boring default)","backgroundColor":"#0d0f12","textColor":"#8facbc","frameColor":"#32312f","frameTextColor":"#d1d1d1","selectedBackgroundColor":"#163d5a","selectedTextColor":"#ebebeb","spacing":0.38,"roundness":0.48,"flat":false}'),nt=JSON.parse('{"name":"Debug","backgroundColor":"#9dceec","textColor":"#0e0425","frameColor":"#00af4d","frameTextColor":"#fbf6ac","selectedBackgroundColor":"#ffcd03","selectedTextColor":"#000000","buttonColor":"#f57d20","buttonTextColor":"#000000","scrollbarColor":"#dd1a21","scrollbarTextColor":"#fff579","mediaButtonColor":"#f4f4f4","mediaButtonTextColor":"#181818","spacing":0.38,"roundness":0.48,"flat":false}'),rt=JSON.parse('{"name":"Glacier","backgroundColor":"#d9e6e8","textColor":"#0d272b","frameColor":"#bfd4e8","frameTextColor":"#1c1c12","selectedBackgroundColor":"#ffffff","selectedTextColor":"#04030c","spacing":0.65,"roundness":0.3,"flat":false}'),it=JSON.parse('{"name":"Indigo","backgroundColor":"#06181e","textColor":"#d1d3f5","frameColor":"#43477a","frameTextColor":"#f3f3f7","selectedBackgroundColor":"#2c2e4f","selectedTextColor":"#ffffff","spacing":0.625,"roundness":0.84375,"flat":true}'),at=JSON.parse('{"name":"Moody Blue","backgroundColor":"#051a23","textColor":"#bec1c0","frameColor":"#125673","frameTextColor":"#d8eee7","selectedBackgroundColor":"#124373","selectedTextColor":"#ffffff","spacing":0.53125,"roundness":0.40625,"flat":false}'),ot=JSON.parse('{"name":"Pale Pink","backgroundColor":"#f7f7f7","textColor":"#120f0c","frameColor":"#cfbdd0","frameTextColor":"#121211","selectedBackgroundColor":"#b9d8f3","selectedTextColor":"#000000","spacing":0.375,"roundness":0.53125,"flat":true}'),st=JSON.parse('{"name":"Purplelicious (Winamp)","backgroundColor":"#000000","textColor":"#ffb464","frameColor":"#3e0445","frameTextColor":"#ffb464","selectedBackgroundColor":"#3e0445","selectedTextColor":"#ffb464","spacing":0.21875,"roundness":0.09375,"flat":false}'),lt=JSON.parse('{"name":"Radioactive","backgroundColor":"#0f0f10","textColor":"#d1f5d2","frameColor":"#322724","frameTextColor":"#c3feca","selectedBackgroundColor":"#43304b","selectedTextColor":"#ffffff","mediaButtonColor":"#c3feca","mediaButtonTextColor":"#021c05","spacing":0.73,"roundness":0.86,"flat":false}'),ct=JSON.parse('{"name":"Saddle","backgroundColor":"#271607","textColor":"#cbbe86","frameColor":"#331d0a","frameTextColor":"#fedfc3","selectedBackgroundColor":"#5d3512","selectedTextColor":"#ffffff","spacing":0.375,"roundness":0.34375,"flat":false}'),ut=JSON.parse('{"name":"Velvet","backgroundColor":"#160916","textColor":"#a7bdd2","frameColor":"#280b1f","frameTextColor":"#cdd1d6","mediaButtonColor":"#aa8f00","mediaButtonTextColor":"#0d0b04","selectedBackgroundColor":"#412438","selectedTextColor":"#ebebeb","spacing":1,"roundness":0.15,"flat":true}'),dt=JSON.parse('{"name":"Winamp Classic","backgroundColor":"#000000","textColor":"#00e200","frameColor":"#383757","frameTextColor":"#d2d2d2","buttonColor":"#464379","buttonTextColor":"#d2d2d2","mediaButtonColor":"#cccccc","mediaButtonTextColor":"#111111","selectedBackgroundColor":"#040dae","selectedTextColor":"#d2d2d2","spacing":0.21875,"roundness":0.09375,"flat":false}'),mt=JSON.parse('{"name":"Winamp Modern (WACUP)","backgroundColor":"#14121c","textColor":"#8ac440","frameColor":"#1f1f36","frameTextColor":"#f0f0f0","mediaButtonColor":"#cccccc","mediaButtonTextColor":"#111111","selectedBackgroundColor":"#2f2f76","selectedTextColor":"#f0f0f0","spacing":0.21875,"roundness":0.09375,"flat":false}'),ht={name:"(none)",backgroundColor:"black",textColor:"white",frameColor:"black",frameTextColor:"white",selectedBackgroundColor:"blue",selectedTextColor:"white",buttonColor:"",buttonTextColor:"",scrollbarColor:"",scrollbarTextColor:"",mediaButtonColor:"",mediaButtonTextColor:"",spacing:0,roundness:0,flat:!1},ft=Object.assign(Object.assign({},ht),tt),pt=[ft,Ze,et,rt,it,at,ot,st,lt,ct,ut,dt,mt,nt];var vt=n(9520),bt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const gt=new A("themeStore");class yt extends vt.ZP{constructor(){super("ampcast/themes"),this.defaultThemes=new Map(pt.map((e=>[e.name,e]))),this.themes$=new Ie([]),this.version(1).stores({themes:"&name"}),(0,vt.Y1)((()=>this.themes.toArray())).subscribe(this.themes$)}observeUserThemes(){return this.themes$}getDefaultTheme(e){return this.defaultThemes.get(e)}getDefaultThemes(){return[...this.defaultThemes.values()]}getUserTheme(e){return this.getUserThemes().find((t=>t.name===e))}getUserThemes(){return this.themes$.getValue()}save(e){return bt(this,void 0,void 0,(function*(){try{gt.log("save",{theme:e}),yield this.themes.put(Object.assign(Object.assign({},e),{userTheme:!0}))}catch(e){gt.error(e)}}))}remove(e){return bt(this,void 0,void 0,(function*(){try{gt.log("remove",{name:e}),yield this.themes.delete(e)}catch(e){gt.error(e)}}))}rename(e,t){return bt(this,void 0,void 0,(function*(){try{const n=yield this.themes.get(e);if(!n)throw Error(`Theme '${e}' not found.`);yield this.themes.delete(e),yield this.themes.put(Object.assign(Object.assign({},n),{name:t,userTheme:!0}))}catch(e){gt.error(e)}}))}}const wt=new yt,Et=new A("theme"),xt=new class{constructor(){this.defaultFontSize=17.2,this.storage=new z("theme"),this.app=document.getElementById("app"),this.popup=document.getElementById("popup"),this.system=document.getElementById("system"),this.theme$=new Ie(ft),this.applyingUpdate=!1;const e=document.createElement("style");document.head.append(e),this.sheet=e.sheet,this.rootStyle=this.createStyle(":root"),this.appStyle=this.createStyle(".app"),this.playheadStyle=this.createStyle("#playhead"),this.system.classList.toggle("selection-dark",!0),this.restore(),this.observe().pipe($e((()=>this.applyAppStyles()))).subscribe(Et)}observe(){return this.theme$.pipe(ze((()=>!this.applyingUpdate)))}get backgroundColor(){return this.current.backgroundColor}set backgroundColor(e){this.setColor("backgroundColor",e)}get black(){if(this.isLight){const e=new Xe(this.defaultButtonColor).toHsl();return e.s-=.6*e.s,e.l-=.8*e.l,this.fromHsl(e)}return new Xe(this.backgroundColor).darken(33).toHexString()}get buttonColor(){return this.current.buttonColor}set buttonColor(e){this.setColor("buttonColor",e,this.defaultButtonColor),this.scrollbarColor=this.current.scrollbarColor}get buttonTextColor(){return this.current.buttonTextColor}set buttonTextColor(e){this.setColor("buttonTextColor",e,this.defaultButtonTextColor),this.scrollbarTextColor=this.current.scrollbarTextColor}get current(){return this.theme$.value}get defaultButtonColor(){const e=new Xe(this.frameColor).toHsl();return e.s+=.05,e.l+=.05,this.fromHsl(e)}get defaultButtonTextColor(){return this.frameTextColor}get defaultMediaButtonColor(){const e=new Xe(this.frameColor).toHsl();return e.s+=.33*(1-e.s),e.l+=.5*(1-e.l),this.fromHsl(e)}get defaultMediaButtonTextColor(){const e=new Xe(this.mediaButtonColor||this.defaultMediaButtonColor).toHsl();return e.s-=.5*e.s,e.l-=.9*e.l,this.fromHsl(e)}get defaultScrollbarColor(){return this.buttonColor||this.defaultButtonColor}get defaultScrollbarTextColor(){return this.buttonTextColor||this.defaultButtonTextColor}get edited(){const e=this.userTheme?wt.getUserTheme(this.name):wt.getDefaultTheme(this.name);return!!e&&!Object.keys(e).every((t=>e[t]===this[t]))}get flat(){return this.current.flat}set flat(e){this.app.classList.toggle("flat",!!e),this.popup.classList.toggle("flat",!!e),this.theme$.next(Object.assign(Object.assign({},this.current),{flat:e}))}get focusRingColor(){return this.isFrameDark?new Xe(this.isMediaButtonLight?this.mediaButtonColor:this.defaultMediaButtonColor).triad()[1].saturate(20).lighten(20).toHexString():new Xe(this.frameColor).triad()[2].saturate(33).darken(50).toHexString()}get fontSize(){return Number(this.rootStyle.getPropertyValue("--font-size"))||this.defaultFontSize}set fontSize(e){this.rootStyle.setProperty("--font-size",String(e)),this.createPlayheadSmiley()}get frameColor(){return this.current.frameColor}set frameColor(e){this.setColor("frameColor",e),this.buttonColor=this.current.buttonColor,this.mediaButtonColor=this.current.mediaButtonColor}get frameTextColor(){return this.current.frameTextColor}set frameTextColor(e){this.setColor("frameTextColor",e),this.buttonTextColor=this.current.buttonTextColor}get mediaButtonColor(){return this.current.mediaButtonColor}set mediaButtonColor(e){this.setColor("mediaButtonColor",e,this.defaultMediaButtonColor),this.mediaButtonTextColor=this.current.mediaButtonTextColor}get mediaButtonTextColor(){return this.current.mediaButtonTextColor}set mediaButtonTextColor(e){this.setColor("mediaButtonTextColor",e,this.defaultMediaButtonTextColor),this.createPlayheadSmiley()}get name(){return this.current.name}set name(e){this.theme$.next(Object.assign(Object.assign({},this.current),{name:e}))}get roundness(){return this.current.roundness}set roundness(e){this.setProperty("roundness",e),this.theme$.next(Object.assign(Object.assign({},this.current),{roundness:e}))}get scrollbarColor(){return this.current.scrollbarColor}set scrollbarColor(e){this.setColor("scrollbarColor",e,this.defaultScrollbarColor)}get scrollbarTextColor(){return this.current.scrollbarTextColor}set scrollbarTextColor(e){this.setColor("scrollbarTextColor",e,this.defaultScrollbarTextColor)}get selectedBackgroundColor(){return this.current.selectedBackgroundColor}set selectedBackgroundColor(e){this.setColor("selectedBackgroundColor",e);const t=new Xe(e);this.setProperty("selected-background-color-blurred",t.desaturate(50).setAlpha(.75).toRgbString())}get selectedTextColor(){return this.current.selectedTextColor}set selectedTextColor(e){this.setColor("selectedTextColor",e)}get spacing(){return this.current.spacing}set spacing(e){this.setProperty("spacing",e),this.theme$.next(Object.assign(Object.assign({},this.current),{spacing:e}))}get textColor(){return this.current.textColor}set textColor(e){this.setColor("textColor",e)}get isDark(){return new Xe(this.backgroundColor).isDark()}get isLight(){return new Xe(this.backgroundColor).isLight()}get isButtonDark(){return new Xe(this.buttonColor||this.defaultButtonColor).isDark()}get isButtonLight(){return new Xe(this.buttonColor||this.defaultButtonColor).isLight()}get isFrameDark(){return new Xe(this.frameColor).isDark()}get isFrameLight(){return new Xe(this.frameColor).isLight()}get isFrameTextDark(){return new Xe(this.frameTextColor).isDark()}get isFrameTextLight(){return new Xe(this.frameTextColor).isLight()}get isMediaButtonLight(){return new Xe(this.mediaButtonColor).isLight()}get isScrollbarDark(){return new Xe(this.scrollbarColor||this.defaultScrollbarColor).isDark()}get isScrollbarLight(){return new Xe(this.scrollbarColor||this.defaultScrollbarColor).isLight()}get isSelectionDark(){return new Xe(this.selectedBackgroundColor).isDark()}get isSelectionLight(){return new Xe(this.selectedBackgroundColor).isLight()}get isTextDark(){return new Xe(this.textColor).isDark()}get isTextLight(){return new Xe(this.textColor).isLight()}get userTheme(){return!!this.current.userTheme}set userTheme(e){this.theme$.next(Object.assign(Object.assign({},this.current),{userTheme:e}))}getVisualizerColors(){const e=new Xe(this.defaultMediaButtonColor);return[this.isDark?this.textColor:this.isFrameTextLight?this.frameTextColor:this.backgroundColor,...e.tetrad().map((e=>e.toRgbString()))]}apply(e){this.applyingUpdate=!0;const t=Object.assign(Object.assign(Object.assign({},ht),{userTheme:void 0}),e);this.frameColor=t.frameColor,this.frameTextColor=t.frameTextColor,Object.assign(this,t),this.applyingUpdate=!1,this.theme$.next(this.current)}applyAppStyles(){this.setProperty("black",this.black),this.setProperty("focus-ring-color",this.focusRingColor),this.toggleClasses(this.app),this.toggleClasses(this.popup)}restore(){const e=this.storage.getJson("current",ft);this.apply(e),this.fontSize=this.storage.getNumber("fontSize",this.defaultFontSize),this.system.classList.toggle("dark",this.isDark),this.system.classList.toggle("light",this.isLight)}save(){this.storage.setNumber("fontSize",this.fontSize),this.storage.setJson("current",this.current),this.system.classList.toggle("dark",this.isDark),this.system.classList.toggle("light",this.isLight)}validate(e){if(!e||"object"!=typeof e||"length"in e)return!1;const t={name:"string",frameColor:"string",frameTextColor:"string",backgroundColor:"string",textColor:"string",selectedBackgroundColor:"string",selectedTextColor:"string"},n={mediaButtonColor:"string",mediaButtonTextColor:"string",buttonColor:"string",buttonTextColor:"string",scrollbarColor:"string",scrollbarTextColor:"string",spacing:"number",roundness:"number",flat:"boolean"};return Object.keys(t).every((n=>n in e&&typeof e[n]===t[n]))&&Object.keys(e).every((r=>r in t||typeof e[r]===n[r]))}toggleClasses(e){const t=e.classList;t.toggle("dark",this.isDark),t.toggle("light",this.isLight),t.toggle("frame-dark",this.isFrameDark),t.toggle("frame-light",this.isFrameLight),t.toggle("frame-text-dark",this.isFrameTextDark),t.toggle("frame-text-light",this.isFrameTextLight),t.toggle("button-dark",this.isButtonDark),t.toggle("button-light",this.isButtonLight),t.toggle("scrollbar-dark",this.isScrollbarDark),t.toggle("scrollbar-light",this.isScrollbarLight),t.toggle("selection-dark",this.isSelectionDark),t.toggle("selection-light",this.isSelectionLight)}setColor(e,t,n){const r=this.toDashName(e);let i=t||n;if(i){"string"==typeof i&&(i=new Xe(i));const n=i.toHsl();this.setProperty(`${r}-h`,String(n.h)),this.setProperty(`${r}-s`,100*n.s+"%"),this.setProperty(`${r}-l`,100*n.l+"%"),this.theme$.next(Object.assign(Object.assign({},this.current),{[e]:t?i.toHexString():""}))}else this.setProperty(`${r}-h`,null),this.setProperty(`${r}-s`,null),this.setProperty(`${r}-l`,null),this.theme$.next(Object.assign(Object.assign({},this.current),{[e]:""}))}setProperty(e,t){this.appStyle.setProperty(`--${e}`,null==t?null:String(t))}createStyle(e){const t=this.sheet.insertRule(`${e}{}`);return this.sheet.cssRules[t].style}get smileyColor(){return this.mediaButtonTextColor||this.defaultMediaButtonTextColor}createPlayheadSmiley(){const e=new Xe(this.smileyColor).toRgbString(),t=[`<path fill='${e}' d='M 160.5,164.5 C 183.647,162.813 194.147,173.48 192,196.5C 186.494,211.009 175.994,216.842 160.5,214C 145.991,208.494 140.158,197.994 143,182.5C 145.683,173.318 151.517,167.318 160.5,164.5 Z'/>`,`<path fill='${e}' d='M 335.5,164.5 C 358.647,162.813 369.147,173.48 367,196.5C 361.494,211.009 350.994,216.842 335.5,214C 320.991,208.494 315.158,197.994 318,182.5C 320.683,173.318 326.517,167.318 335.5,164.5 Z'/>`,`<path fill='${e}' d='M 164.5,296.5 C 172.699,295.1 179.865,297.1 186,302.5C 201.99,327.582 224.823,341.582 254.5,344.5C 279.499,342.418 299.999,331.751 316,312.5C 318.955,308.756 321.789,304.922 324.5,301C 334.716,294.616 344.55,295.116 354,302.5C 358.296,308.845 359.63,315.845 358,323.5C 334.118,361.698 299.618,382.365 254.5,385.5C 209.382,382.365 174.882,361.698 151,323.5C 148.138,310.557 152.638,301.557 164.5,296.5 Z'/>`].join(""),n=this.createBase64SVG(512,512,t);this.playheadStyle.setProperty("--smiley",n),this.playheadStyle.setProperty("--thumb-size",`${Math.round(1.25*this.fontSize)}px`)}createBase64SVG(e,t,n){return`url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='${e}' height='${t}'>${n}</svg>")`}toDashName(e){return e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))}fromHsl({h:e,s:t,l:n}){return t=Math.min(Math.max(t,0),1),n=Math.min(Math.max(n,0),1),new Xe({h:e,s:t,l:n}).toHexString()}};function kt(e,t){const n=(0,r.useRef)(t);(0,r.useEffect)((()=>{n.current=t}),[t]),(0,r.useEffect)((()=>{const t=e.current;if(t){const r=new ResizeObserver((()=>{e.current&&n.current()}));return r.observe(t),()=>r.disconnect()}}),[e])}const St=document.createElement("div");function Ct(){const e=(0,r.useRef)(St),[t,n]=(0,r.useState)(0);return(0,r.useEffect)((()=>{St.parentElement||(document.body.append(St),n(Tt()))}),[]),kt(e,(()=>n(Tt()))),t}function Tt(){return parseFloat(getComputedStyle(St).fontSize)||xt.defaultFontSize}function Pt({vertical:e,primary:t,size:n,children:i}){const a={};return t||(e?a.height=`${n}px`:a.width=`${n}px`),r.createElement("div",{className:"layout-pane layout-pane-"+(t?"primary":"secondary"),style:a},i)}function At({id:e,arrange:t="columns",primaryIndex:n=0,children:i}){const a=(0,r.useRef)(null),[o,s]=(0,r.useState)({width:0,height:0}),[l,c]=(0,r.useState)(0),[u,d]=(0,r.useState)(0),[m,h]=(0,r.useState)(0),[f,p]=(0,r.useState)((()=>e?H.get(e):0)),[v,b]=(0,r.useState)(-1),[g,y]=(0,r.useState)(0),w=-1!==v,E=Ct(),x="rows"===t;(0,r.useEffect)((()=>{e&&H.set(e,f)}),[e,f]),(0,r.useLayoutEffect)((()=>{var e;if(E>0){const t=a.current,n=x?"minHeight":"minWidth",r=t.querySelector(":scope > .layout-pane-primary");if(r){r.style[n]="";const e=parseInt(getComputedStyle(r)[n],10);r.style[n]="unset",c(e||80)}const i=t.querySelector(":scope > .layout-pane-secondary");if(i){i.style[n]="";const r=parseInt(getComputedStyle(i)[n],10);i.style[n]="unset",d(r||80);const a=x?"offsetHeight":"offsetWidth",o=t.querySelector(":scope > .layout-splitter");h(null!==(e=null==o?void 0:o[a])&&void 0!==e?e:4)}}}),[x,E]),(0,r.useLayoutEffect)((()=>{const e=x?o.height:o.width;if(e>0){const t=e-m-f;t<l?p(Math.max(f-(l-t),0)):f<u&&p(Math.min(e-m-l,u))}}),[x,o,l,u,m,f]);const k=(0,r.useCallback)((e=>{if(0===e.button){const t=x?e.screenY:e.screenX;b(t),y(f),e.preventDefault()}}),[x,f]),S=(0,r.useCallback)((e=>{const t=(x?e.screenY:e.screenX)-v;p(0===n?g-t:g+t)}),[x,n,v,g]),C=(0,r.useCallback)((()=>{b(-1),y(0)}),[]);return(0,r.useEffect)((()=>{if(w)return document.documentElement.style.cursor=x?"ns-resize":"ew-resize",document.body.classList.add("dragging"),document.addEventListener("mouseup",C),document.addEventListener("mousemove",S),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",C),document.removeEventListener("mousemove",S)}}),[x,w,S,C]),kt(a,(()=>{const e=a.current;s({width:e.clientWidth,height:e.clientHeight})})),r.createElement("div",{className:`splitter splitter-${t}`,id:e,ref:a},r.Children.toArray(i).slice(0,2).map(((e,t)=>{const i=t===n,a=i?0:f,o=[];return 1===t&&o.push(r.createElement("div",{className:"layout-splitter "+(w?"active":""),role:"separator",onMouseDown:k,key:"splitter"})),o.push(r.createElement(Pt,{vertical:x,primary:i,size:a,key:t},e)),o})))}St.style.cssText="\n    position: absolute;\n    pointer-events: none;\n    visibility: hidden;\n    font-size: 1rem;\n    width: 1rem;\n    height: 1rem;\n";var It=function(e){function t(t,n){return e.call(this)||this}return K(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(ne),Ot={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Ot.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,Q([e,t],J(n))):setInterval.apply(void 0,Q([e,t],J(n)))},clearInterval:function(e){var t=Ot.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},Mt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return K(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),Ot.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&Ot.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,te(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(It),Nt={now:function(){return(Nt.delegate||Date).now()},delegate:void 0},$t=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=Nt.now,e}(),zt=new(function(e){function t(t,n){void 0===n&&(n=$t.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return K(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}($t))(Mt),jt=zt;function Lt(e){return e&&X(e.schedule)}function Rt(e,t,n){void 0===e&&(e=0),void 0===n&&(n=jt);var r=-1;return null!=t&&(Lt(t)?n=t:r=t),new Se((function(t){var i=function(e){return e instanceof Date&&!isNaN(e)}(e)?+e-n.now():e;i<0&&(i=0);var a=0;return n.schedule((function(){t.closed||(t.next(a++),0<=r?this.schedule(void 0,r):t.complete())}),i)}))}function Dt(e,t){return void 0===e&&(e=0),void 0===t&&(t=zt),e<0&&(e=0),Rt(e,e,t)}function _t({children:e}){return r.createElement(r.Fragment,null,e)}var Ft=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Vt(e){return X(null==e?void 0:e.then)}function Ut(e){return X(e[xe])}function Bt(e){return Symbol.asyncIterator&&X(null==e?void 0:e[Symbol.asyncIterator])}function Ht(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Yt="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Kt(e){return X(null==e?void 0:e[Yt])}function Wt(e){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){a.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof G?Promise.resolve(n.value.v).then(l,c):u(a[0][2],n)}catch(e){u(a[0][3],e)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}(this,arguments,(function(){var t,n,r;return W(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,G(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,G(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,G(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function qt(e){return X(null==e?void 0:e.getReader)}function Jt(e){if(e instanceof Se)return e;if(null!=e){if(Ut(e))return i=e,new Se((function(e){var t=i[xe]();if(X(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(Ft(e))return t=e,new Se((function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()}));if(Vt(e))return r=e,new Se((function(e){r.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,le)}));if(Bt(e))return Qt(e);if(Kt(e))return n=e,new Se((function(e){var t,r;try{for(var i=q(n),a=i.next();!a.done;a=i.next()){var o=a.value;if(e.next(o),e.closed)return}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.complete()}));if(qt(e))return Qt(Wt(e))}var t,n,r,i;throw Ht(e)}function Qt(e){return new Se((function(t){(function(e,t){var n,r,i,a,o,s,l,c;return o=this,s=void 0,c=function(){var o,s;return W(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=q(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}(e),l.label=1;case 1:return[4,n.next()];case 2:if((r=l.sent()).done)return[3,4];if(o=r.value,t.next(o),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=l.sent(),i={error:s},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((l=void 0)||(l=Promise))((function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):function(e){return e instanceof l?e:new l((function(t){t(e)}))}(t.value).then(n,r)}i((c=c.apply(o,s||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function Gt(e,t){return Oe((function(n,r){var i=0;n.subscribe(Me(r,(function(n){r.next(e.call(t,n,i++))})))}))}function Xt(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var a=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(a),!i)return a}function Zt(e,t,n){return void 0===n&&(n=1/0),X(t)?Zt((function(n,r){return Gt((function(e,i){return t(n,e,r,i)}))(Jt(e(n,r)))}),n):("number"==typeof t&&(n=t),Oe((function(t,r){return function(e,t,n,r,i,a,o,s){var l=[],c=0,u=0,d=!1,m=function(){!d||l.length||c||t.complete()},h=function(e){return c<r?f(e):l.push(e)},f=function(e){c++;var i=!1;Jt(n(e,u++)).subscribe(Me(t,(function(e){t.next(e)}),(function(){i=!0}),void 0,(function(){if(i)try{c--;for(;l.length&&c<r;)e=void 0,e=l.shift(),f(e);m()}catch(e){t.error(e)}var e})))};return e.subscribe(Me(t,h,(function(){d=!0,m()}))),function(){}}(t,r,e,n)})))}var en=Array.isArray;function tn(e){return Gt((function(t){return function(e,t){return en(t)?e.apply(void 0,Q([],J(t))):e(t)}(e,t)}))}var nn=["addListener","removeListener"],rn=["addEventListener","removeEventListener"],an=["on","off"];function on(e,t,n,r){if(X(n)&&(r=n,n=void 0),r)return on(e,t,n).pipe(tn(r));var i=J(function(e){return X(e.addEventListener)&&X(e.removeEventListener)}(e)?rn.map((function(r){return function(i){return e[r](t,i,n)}})):function(e){return X(e.addListener)&&X(e.removeListener)}(e)?nn.map(sn(e,t)):function(e){return X(e.on)&&X(e.off)}(e)?an.map(sn(e,t)):[],2),a=i[0],o=i[1];if(!a&&Ft(e))return Zt((function(e){return on(e,t,n)}))(Jt(e));if(!a)throw new TypeError("Invalid event target");return new Se((function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return a(t),function(){return o(t)}}))}function sn(e,t){return function(n){return function(r){return e[n](t,r)}}}function ln(e){return void 0===e&&(e=1/0),Zt(ke,e)}var cn=new Se((function(e){return e.complete()}));function un(e){return e[e.length-1]}function dn(e){return X(un(e))?e.pop():void 0}function mn(e){return Lt(un(e))?e.pop():void 0}function hn(e,t){return void 0===t&&(t=0),Oe((function(n,r){n.subscribe(Me(r,(function(n){return Xt(r,e,(function(){return r.next(n)}),t)}),(function(){return Xt(r,e,(function(){return r.complete()}),t)}),(function(n){return Xt(r,e,(function(){return r.error(n)}),t)})))}))}function fn(e,t){return void 0===t&&(t=0),Oe((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}function pn(e,t){if(!e)throw new Error("Iterable cannot be null");return new Se((function(n){Xt(n,t,(function(){var r=e[Symbol.asyncIterator]();Xt(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}function vn(e,t){return t?function(e,t){if(null!=e){if(Ut(e))return function(e,t){return Jt(e).pipe(fn(t),hn(t))}(e,t);if(Ft(e))return function(e,t){return new Se((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if(Vt(e))return function(e,t){return Jt(e).pipe(fn(t),hn(t))}(e,t);if(Bt(e))return pn(e,t);if(Kt(e))return function(e,t){return new Se((function(n){var r;return Xt(n,t,(function(){r=e[Yt](),Xt(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return X(null==r?void 0:r.return)&&r.return()}}))}(e,t);if(qt(e))return function(e,t){return pn(Wt(e),t)}(e,t)}throw Ht(e)}(e,t):Jt(e)}function bn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=mn(e),r=function(e,t){return"number"==typeof un(e)?e.pop():1/0}(e),i=e;return i.length?1===i.length?Jt(i[0]):ln(r)(vn(i,n)):cn}function gn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ln(1)(vn(e,mn(e)))}function yn(e,t){return Oe((function(n,r){var i=null,a=0,o=!1,s=function(){return o&&!i&&r.complete()};n.subscribe(Me(r,(function(n){null==i||i.unsubscribe();var o=0,l=a++;Jt(e(n,l)).subscribe(i=Me(r,(function(e){return r.next(t?t(n,e,l,o++):e)}),(function(){i=null,s()})))}),(function(){o=!0,s()})))}))}function wn(e){return Oe((function(t,n){Jt(e).subscribe(Me(n,(function(){return n.complete()}),ce)),!n.closed&&t.subscribe(n)}))}function En(e,t){switch(t.type){case"resize":{const n=Math.max(t.clientSize,0),r=Math.max(t.scrollSize,n);if(n!==e.clientSize||r!==e.scrollSize){const t=r-n,i=xn(e.position,t);return Object.assign(Object.assign({},e),{position:i,max:t,clientSize:n,scrollSize:r})}return e}case"scrollBy":{const n=xn(e.position+t.amount,e.max);return n!==e.position?Object.assign(Object.assign({},e),{position:n}):e}case"scrollTo":{const n=xn(t.position,e.max);return n!==e.position?Object.assign(Object.assign({},e),{position:n}):e}default:return e}}function xn(e,t){return Math.min(Math.max(e,0),t)}const kn={position:0,max:0,clientSize:0,scrollSize:0};const Sn=(0,r.memo)((function(e){var{scrollableId:t,orientation:n,scrollAmount:i,onChange:a,onResize:o,scrollbarRef:s}=e,l=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["scrollableId","orientation","scrollAmount","onChange","onResize","scrollbarRef"]);const c=(0,r.useRef)(null),u=(0,r.useRef)(null),{position:d,max:m,clientSize:h,scrollSize:f,resize:p,scrollBy:v,scrollTo:b}=function(){const[{position:e,max:t,clientSize:n,scrollSize:i},a]=(0,r.useReducer)(En,kn),o=(0,r.useCallback)(((e,t)=>a({type:"resize",clientSize:e,scrollSize:t})),[]),s=(0,r.useCallback)((e=>a({type:"scrollTo",position:e})),[]);return{position:e,max:t,clientSize:n,scrollSize:i,scrollTo:s,scrollBy:(0,r.useCallback)((e=>a({type:"scrollBy",amount:e})),[]),resize:o}}(),[g,y]=(0,r.useState)(0),[E,x]=(0,r.useState)(0),[k,S]=(0,r.useState)(0),[C,T]=(0,r.useState)(-1),[P,A]=(0,r.useState)(0),I=-1!==C,O="vertical"===n,M=Math.ceil(d/m*(E-k));(0,r.useEffect)((()=>{s.current={scrollBy:v,scrollTo:b}}),[s,v,b]),(0,r.useLayoutEffect)((()=>p(l.clientSize,l.scrollSize)),[l.clientSize,l.scrollSize,p]),(0,r.useLayoutEffect)((()=>null==a?void 0:a(d)),[d,a]),(0,r.useLayoutEffect)((()=>null==o?void 0:o(g)),[g,o]),kt(c,(()=>{const e=c.current.getBoundingClientRect();x(O?e.height:e.width),y(O?e.width:e.height)})),kt(u,(()=>{const e=u.current.getBoundingClientRect();S(O?e.height:e.width)}));const N=(0,r.useCallback)(((e,t)=>{const n=()=>s.current.scrollBy(t),r=t=>t.target===e,i=on(document,"mouseup"),a=on(e,"mouseover").pipe(Gt(r),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=mn(e);return Oe((function(t,r){(n?gn(e,t,n):gn(e,t)).subscribe(r)}))}(!0)),o=bn(a,on(e,"mouseout").pipe(ze(r),Gt((()=>!1)))).pipe(yn(((e,t)=>e?Rt(0===t?400:0,40):cn)),wn(i)).subscribe(n);return n(),()=>o.unsubscribe()}),[s]),$=(0,r.useCallback)((e=>{if(0===e.button)return N(e.target,-i)}),[i,N]),z=(0,r.useCallback)((e=>{if(0===e.button)return N(e.target,i)}),[i,N]),j=(0,r.useCallback)((e=>{if(0===e.button){const t=O?e.nativeEvent.offsetY:e.nativeEvent.offsetX;return N(e.target,t<M?-h:h)}}),[O,h,M,N]),L=(0,r.useCallback)((e=>{e.stopPropagation(),0===e.button&&(T(O?e.screenY:e.screenX),A(M))}),[O,M]),R=(0,r.useCallback)((e=>{const t=O?e.screenY:e.screenX;b((P+(t-C))*m/(E-k))}),[O,C,P,m,k,E,b]),D=(0,r.useCallback)((()=>{T(-1),A(0)}),[]);return(0,r.useEffect)((()=>{if(I)return document.body.classList.add("dragging"),document.addEventListener("mouseup",D),document.addEventListener("mousemove",R),()=>{document.body.classList.remove("dragging"),document.removeEventListener("mouseup",D),document.removeEventListener("mousemove",R)}}),[I,R,D]),r.createElement("div",{className:`scrollbar scrollbar-${n}`,role:"scrollbar","aria-controls":t,"aria-orientation":n,"aria-valuenow":Number((100*d/m).toFixed(1)),"aria-valuemin":0,"aria-valuemax":100,onContextMenu:w,onMouseDown:w},r.createElement("div",{className:"scrollbar-button scrollbar-button-decrement",onMouseDown:$},r.createElement("svg",{className:"icon",viewBox:"0 0 50 50"},r.createElement("polygon",{points:O?"0,50 25,0 50,50":"50,0 0,25 50,50"}))),r.createElement("div",{className:"scrollbar-track",onMouseDown:j,ref:c},r.createElement("div",{className:"scrollbar-thumb",onMouseDown:L,style:{[O?"height":"width"]:E*(f?h/f:0)+"px",transform:`translate${O?"Y":"X"}(${M}px)`},ref:u})),r.createElement("div",{className:"scrollbar-button scrollbar-button-increment",onMouseDown:z},r.createElement("svg",{className:"icon",viewBox:"0 0 50 50"},r.createElement("polygon",{points:O?"0,0 25,50 50,0":"0,0 50,25 0,50"}))))}));function Cn({children:e,scrollWidth:t=0,scrollHeight:n=0,scrollAmount:i=10,droppable:a,onResize:o,onScroll:s,scrollableRef:l}){const c=(0,r.useId)(),u=(0,r.useRef)(null),m=(0,r.useRef)(null),h=(0,r.useRef)(null),f=(0,r.useRef)(null),p=(0,r.useRef)(null),v=(0,r.useRef)(null),[b,g]=(0,r.useState)(0),[y,w]=(0,r.useState)(0),[E,x]=(0,r.useState)(0),[k,S]=(0,r.useState)(0),[C,T]=(0,r.useState)(0),[P,A]=(0,r.useState)(t),[I,O]=(0,r.useState)(n),[M,N]=(0,r.useState)(0),[$,z]=(0,r.useState)(0),[j,L]=(0,r.useState)(!1),[R,D]=(0,r.useState)(!1),[_,F]=(0,r.useState)(0),V=Math.max(M-(R?y:0),0),U=Math.max($-(j?b:0),0);(0,r.useEffect)((()=>{l&&(l.current={scrollTo:({left:e,top:t})=>{void 0!==e&&p.current.scrollTo(e),void 0!==t&&v.current.scrollTo(t)}})}),[l]),(0,r.useLayoutEffect)((()=>{P&&V?L(P-V>1):D(!1)}),[P,V]),(0,r.useLayoutEffect)((()=>{D(!(!I||!U)&&I-U>1)}),[I,U]),(0,r.useLayoutEffect)((()=>{u.current.classList.toggle("overflow-x",j)}),[j]),(0,r.useLayoutEffect)((()=>{u.current.classList.toggle("overflow-y",R)}),[R]),(0,r.useLayoutEffect)((()=>{var e;A(0===t?(null===(e=m.current)||void 0===e?void 0:e.scrollWidth)||0:t)}),[t]),(0,r.useLayoutEffect)((()=>{var e;O(0===n?(null===(e=m.current)||void 0===e?void 0:e.scrollHeight)||0:n)}),[n]);const B=(0,r.useCallback)((()=>{const e=u.current;N(e.clientWidth),z(e.clientHeight),x(e.getBoundingClientRect().top)}),[]),H=(0,r.useCallback)((()=>{var e;const r=m.current,i=f.current;0===t&&A(r.scrollWidth),0===n&&O(i.scrollHeight+((null===(e=h.current)||void 0===e?void 0:e.clientHeight)||0));const{clientWidth:a,clientHeight:s}=r,{scrollWidth:l,scrollHeight:c}=i;null==o||o({clientWidth:a,clientHeight:s,scrollWidth:l,scrollHeight:c})}),[t,n,o]);kt(u,B),kt(m,H),kt(f,H),(0,r.useLayoutEffect)((()=>{null==s||s({left:k,top:C})}),[k,C,s]);const Y=(0,r.useCallback)((e=>{v.current.scrollBy(3*i*Math.sign(e.deltaY))}),[i]),K=(0,r.useCallback)((e=>{const t=e.nativeEvent.clientY-E;t+i/2>$?F(i):t<i&&F(-i)}),[E,$,i]);(0,r.useEffect)((()=>{if(_){const e=()=>v.current.scrollBy(_),t=Dt(100).subscribe(e);return()=>t.unsubscribe()}}),[_]);const W=(0,r.useCallback)((()=>F(0)),[]),[q,J]=d(r.Children.toArray(e),(e=>(null==e?void 0:e.type)===_t));return r.createElement("div",{className:"scrollable",id:c,onWheel:Y,ref:u},r.createElement("div",{className:"scrollable-content",onDragOver:a?K:void 0,onDragLeave:a?W:void 0,onDragEnd:a?W:void 0,onDrop:a?W:void 0,style:{right:R?`${y}px`:"0",bottom:j?`${b}px`:"0",transform:`translateX(-${k}px)`},ref:m},q?r.createElement("div",{className:"scrollable-head",ref:h},q):null,r.createElement("div",{className:"scrollable-body",style:{width:t?`${t}px`:void 0}},r.createElement("div",{className:"scrollable-body-content",style:{transform:`translateY(-${C}px)`},ref:f},J))),r.createElement(Sn,{scrollableId:c,orientation:"horizontal",clientSize:V,scrollSize:P,scrollAmount:i,onChange:S,onResize:g,scrollbarRef:p}),r.createElement(Sn,{scrollableId:c,orientation:"vertical",clientSize:U,scrollSize:I,scrollAmount:i,onChange:T,onResize:w,scrollbarRef:v}))}function Tn(e){return Oe((function(t,n){var r=!1,i=null,a=null,o=function(){if(null==a||a.unsubscribe(),a=null,r){r=!1;var e=i;i=null,n.next(e)}};t.subscribe(Me(n,(function(t){null==a||a.unsubscribe(),r=!0,i=t,a=Me(n,o,ce),Jt(e(t)).subscribe(a)}),(function(){o(),n.complete()}),void 0,(function(){i=a=null})))}))}function Pn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return vn(e,mn(e))}function An(e,t=200){const[n,i]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{const n=t=>!e||e.includes(t.code),r=(e,t)=>on(document,e,{capture:!0}).pipe(ze(n),Gt((()=>t))),a=bn(r("keydown",!0),r("keyup",!1)).pipe(Tn((e=>e?Pn(0):Rt(t)))).subscribe(i);return()=>a.unsubscribe()}),[e,t]),n}function In(e){return(0,r.useMemo)((()=>On(e)),[e])}function On(e){return e.reduce(((e,t)=>(e.push(t.id),t.children?e.concat(On(t.children)):e)),[])}function Mn(e){return{storeExpandedState:(0,r.useCallback)(((t,n)=>{e&&localStorage.setItem(`${e}/${t}`,String(!!n))}),[e]),retrieveExpandedState:(0,r.useCallback)(((t,n=!1)=>{if(e){const r=localStorage.getItem(`${e}/${t}`);return"string"==typeof r?"true"===r:n}return n}),[e]),storeSelectedNodeId:(0,r.useCallback)((t=>{e&&localStorage.setItem(`${e}/selectedId`,t)}),[e]),retrieveSelectedNodeId:(0,r.useCallback)((t=>e&&localStorage.getItem(`${e}/selectedId`)||t),[e])}}function Nn(e,t){return e.reduce(((e,n)=>(t(n.id,n.startExpanded)&&e.push(n.id),n.children?e.concat(Nn(n.children,t)):e)),[])}function $n(e,t){return(0,r.useMemo)((()=>zn(e,t)),[e,t])}function zn(e,t){return e.reduce(((e,n)=>(e.push(n.id),n.children&&t.includes(n.id)?e.concat(zn(n.children,t)):e)),[])}var jn=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Ln({id:e,label:t,children:n=[],selectedId:i,expandedIds:a,level:o,rowHeight:s,nodeIndex:l,setSize:c,emptyMarker:u,onSelect:d,onToggle:m}){const h=a.includes(e),f=0!==n.length,p=e===i,v=`${f?"expandable":""} ${h?"expanded":""} ${p?"selected":""} ${0===n.length?"empty":""}`,b=(0,r.useCallback)((e=>{e.stopPropagation()}),[]),g=(0,r.useCallback)((t=>{t.stopPropagation(),null==d||d(e)}),[e,d]),y=(0,r.useCallback)((t=>{t.stopPropagation(),null==m||m(e)}),[e,m]),w=(0,r.useCallback)((t=>{t.stopPropagation(),null==m||m(e),h&&Vn(n,i)&&(null==d||d(e))}),[e,i,h,n,d,m]);return r.createElement("li",{className:`tree-view-node ${v}`,id:`tree-view-node-${e}`,role:"treeitem","aria-selected":p?"true":void 0,"aria-expanded":h?"true":void 0,"aria-labelledby":`tree-view-node-label-${e}`,"aria-level":o,"aria-setsize":c,"aria-posinset":l+1,onMouseDown:g},r.createElement("span",{className:"tree-view-row "+(p?"selected-text":""),onDoubleClick:y,style:{height:`${s}px`}},f?r.createElement("svg",{className:"tree-view-node-marker",viewBox:`0 0 ${h?320:256} 512`,onMouseDown:b,onClick:w},h?r.createElement("path",{d:"M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"}):r.createElement("path",{d:"M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"})):u&&r.createElement("svg",{className:"tree-view-node-marker empty-marker",viewBox:"0 0 24 24",onMouseDown:b},r.createElement("circle",{cx:"12",cy:"12",r:"4"})),r.createElement("span",{className:"tree-view-node-label",id:`tree-view-node-label-${e}`},t)),h&&r.createElement("ul",{className:"tree-view-node-children",role:"group"},n.map(((e,t)=>{var{id:l}=e,c=jn(e,["id"]);return r.createElement(Ln,Object.assign({},c,{id:l,selectedId:i,expandedIds:a,level:o+1,rowHeight:s,nodeIndex:t,setSize:n.length,onSelect:d,onToggle:m,key:l}))}))))}var Rn=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Dn=24,_n=["ArrowUp","ArrowDown"];function Fn({roots:e,className:t="",storageId:n,onContextMenu:i,onDelete:a,onEnter:o,onInfo:s,onSelect:l,treeViewRef:c}){const u=(0,r.useRef)(null),d=(0,r.useRef)(null),m=(0,r.useRef)(null),{storeSelectedNodeId:h,retrieveSelectedNodeId:f}=Mn(n),[p,v]=(0,r.useState)(""),{expandedIds:b,toggle:g}=function(e,t){const{storeExpandedState:n,retrieveExpandedState:i}=Mn(t),a=In(e),[o,s]=(0,r.useState)((()=>Nn(e,i)));(0,r.useEffect)((()=>{s(Nn(e,i))}),[e,i]),(0,r.useEffect)((()=>{const e=o.filter((e=>a.includes(e)));e.length!==o.length&&s(e)}),[a,o]);const l=(0,r.useCallback)(((e,t)=>{const r=o.includes(e);r!==t&&(s(r?o.filter((t=>t!==e)):o.concat(e)),n(e,!r))}),[o,n]);return{expandedIds:o,toggle:l}}(e,n),y=$n(e,b),w=y.indexOf(p),[E,x]=(0,r.useState)(0),[k,S]=(0,r.useState)(Dn),[C,T]=(0,r.useState)(0),P=Math.floor(E/k)-1,A=y.length,I=Un(e,p),O=An(_n)&&!(0===w||w===A-1),[M,N]=(0,r.useState)((()=>I)),$=(0,r.useCallback)((()=>u.current.focus()),[]);(0,r.useEffect)((()=>{c&&(c.current={focus:$})}),[c,$]),(0,r.useEffect)((()=>{!p&&e.length>0&&v(f(e[0].id))}),[e,p,f]),(0,r.useLayoutEffect)((()=>{if(!Vn(e,p)){const t=e.find((e=>null==p?void 0:p.startsWith(`${e.id}/`)))||e[0];v(null==t?void 0:t.id)}}),[e,p]),(0,r.useLayoutEffect)((()=>{null==l||l(M)}),[M,l]),(0,r.useEffect)((()=>{p&&h(p)}),[p,h]),(0,r.useEffect)((()=>{O||N(I)}),[I,O]);const z=(0,r.useCallback)((e=>{e.preventDefault(),null==i||i(I,e.pageX,e.pageY)}),[I,i]),j=(0,r.useCallback)((e=>{switch(e.code){case"Enter":e.stopPropagation(),e.repeat||null==o||o(I);break;case"Delete":e.stopPropagation(),e.repeat||null==a||a(I);break;case"KeyI":e.stopPropagation(),!e[U.ctrlKey]||e.shiftKey||e.repeat||null==s||s(I);break;case"ArrowLeft":e.stopPropagation(),e.repeat||g(p,!1);break;case"ArrowRight":e.stopPropagation(),e.repeat||g(p,!0);break;default:{const t=function(e,t,n){switch(e){case"ArrowUp":return t[t.indexOf(n)-1]||n;case"ArrowDown":return t[t.indexOf(n)+1]||n;case"Home":return t[0]||n;case"End":return t[t.length-1]||n;default:return""}}(e.key,y,p);if(t&&(e.preventDefault(),t!==p)){e.stopPropagation();const n=d.current,r=Math.floor(C/k),i=y.indexOf(t);if(i>=r+P-1){const e=A*k,t=A-P-1,r=Math.min(A-1,i+1)-P,a=r===t?e:r*k;n.scrollTo({top:a})}else if(i<=r){const e=Math.max(0,i-1)*k;n.scrollTo({top:e})}v(t)}}}}),[y,p,I,k,P,A,C,a,o,s,g]),L=(0,r.useCallback)((({clientHeight:e})=>x(e)),[]),R=(0,r.useCallback)((({top:e})=>T(e)),[]);return kt(m,(()=>{S(m.current.getBoundingClientRect().height)})),r.createElement("div",{className:`tree-view ${t}`,tabIndex:0,onContextMenu:z,onKeyDown:j,ref:u},r.createElement(Cn,{scrollAmount:k,onResize:L,onScroll:R,scrollableRef:d},r.createElement("ul",{role:"tree"},e.map(((t,n)=>{var{id:i}=t,a=Rn(t,["id"]);return r.createElement(Ln,Object.assign({},a,{id:i,selectedId:p,expandedIds:b,level:1,rowHeight:k,nodeIndex:n,setSize:e.length,emptyMarker:!0,onSelect:v,onToggle:g,key:i}))}))),r.createElement("div",{className:"tree-view-cursor",style:{transform:`translateY(${w*k}px)`},ref:m})))}function Vn(e,t){for(const n of e){if(n.id===t)return!0;if(n.children&&Vn(n.children,t))return!0}return!1}function Un(e,t){return e.reduce(((e,n)=>{if(void 0===e)if(n.id===t)e=n.value;else if(n.children)return Un(n.children,t);return e}),void 0)}var Bn;!function(e){e.Pin="pin",e.Unpin="unpin",e.Like="like",e.Unlike="unlike",e.Rate="rate",e.Info="info",e.AddToLibrary="library-add",e.RemoveFromLibrary="library-remove",e.PlayNow="play-now",e.PlayNext="play-next",e.Queue="queue"}(Bn||(Bn={}));const Hn=Bn;var Yn;!function(e){e[e.Media=0]="Media",e[e.Album=1]="Album",e[e.Artist=2]="Artist",e[e.Playlist=3]="Playlist",e[e.Folder=4]="Folder"}(Yn||(Yn={}));const Kn=Yn;var Wn;!function(e){e[e.Default=0]="Default",e[e.History=1]="History",e[e.RecentlyPlayed=2]="RecentlyPlayed",e[e.MostPlayed=3]="MostPlayed",e[e.Library=4]="Library",e[e.Ratings=5]="Ratings"}(Wn||(Wn={}));const qn=Wn;var Jn=Array.isArray,Qn=Object.getPrototypeOf,Gn=Object.prototype,Xn=Object.keys;function Zn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=mn(e),r=dn(e),i=function(e){if(1===e.length){var t=e[0];if(Jn(t))return{args:t,keys:null};if((r=t)&&"object"==typeof r&&Qn(r)===Gn){var n=Xn(t);return{args:n.map((function(e){return t[e]})),keys:n}}}var r;return{args:e,keys:null}}(e),a=i.args,o=i.keys;if(0===a.length)return vn([],n);var s=new Se(function(e,t,n){return void 0===n&&(n=ke),function(r){er(t,(function(){for(var i=e.length,a=new Array(i),o=i,s=i,l=function(i){er(t,(function(){var l=vn(e[i],t),c=!1;l.subscribe(Me(r,(function(e){a[i]=e,c||(c=!0,s--),s||r.next(n(a.slice()))}),(function(){--o||r.complete()})))}),r)},c=0;c<i;c++)l(c)}),r)}}(a,n,o?function(e){return function(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})}(o,e)}:ke));return r?s.pipe(tn(r)):s}function er(e,t,n){e?Xt(n,e,t):t()}function tr(e,t){return void 0===t&&(t=ke),e=null!=e?e:nr,Oe((function(n,r){var i,a=!0;n.subscribe(Me(r,(function(n){var o=t(n);!a&&e(i,o)||(a=!1,i=o,r.next(n))})))}))}function nr(e,t){return e===t}const rr=new Pe,ir={dispatch:function(e){const t=Array.isArray(e)?e:[e];rr.next(t)},observe:function(){return rr}};var ar=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};class or extends vt.ZP{constructor(){super("ampcast/library-removals"),this.libraryRemovals$=new Ie([]),this.lock$=new Ie(null),this.version(1).stores({libraryRemovals:"&src"}),(0,vt.Y1)((()=>this.libraryRemovals.toArray())).subscribe(this.libraryRemovals$)}observeRemovals(e){return Zn([this.libraryRemovals$,this.lock$]).pipe(ze((([e])=>e.length>0)),Gt((([t])=>t.filter((t=>t.src.startsWith(`${e}:`)&&!this.isLocked(t))))),tr(((e,t)=>{const n=e.map((e=>e.src)).sort(),r=t.map((e=>e.src)).sort();return String(n)===String(r)})))}lock(e,t){this.lock$.next({serviceId:e,itemType:t})}unlock(){this.lock$.next(null)}store(e,t){return ar(this,void 0,void 0,(function*(){const n=e.src,[r]=n.split(":"),i=_l(r);if(!i)throw Error(`Service not found '${r}'.`);if(!i.store)throw Error(`store() not supported by ${r}.`);this.isLocked(e)?t?yield this.libraryRemovals.delete(n):yield this.libraryRemovals.put(this.createLibraryObject(e)):yield i.store(e,t),ir.dispatch({match:e=>e.src===n,values:{inLibrary:t}})}))}applyRemovals(e){return ar(this,void 0,void 0,(function*(){if(e.length>0){const t=e.map((e=>e.src));yield this.libraryRemovals.bulkDelete(t),ir.dispatch({match:e=>t.includes(e.src),values:{inLibrary:!1}})}}))}get(e,t){return!this.isRemoved(e)&&t}isRemoved(e){return-1!==this.libraryRemovals$.getValue().findIndex((t=>t.src===e))}isLocked(e){const t=this.lock$.getValue();if(t){const[n]=e.src.split(":");return t.serviceId===n&&t.itemType===e.itemType}return!1}createLibraryObject(e){if("pager"in e){const{pager:t}=e;return function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["pager"])}return e}}const sr=new or;function lr(e,t){return X(t)?Zt(e,t,1):Zt(e,1)}function cr(e){return Oe((function(t,n){var r,i=null,a=!1;i=t.subscribe(Me(n,void 0,void 0,(function(o){r=Jt(e(o,cr(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0}))),a&&(i.unsubscribe(),i=null,r.subscribe(n))}))}var ur=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};class dr extends vt.ZP{constructor(){super("ampcast/rating-removals"),this.ratingRemovals$=new Ie([]),this.lock$=new Ie(null),this.logger=new A("ratingStore"),this.version(1).stores({ratingRemovals:"&src"}),(0,vt.Y1)((()=>this.ratingRemovals.toArray())).subscribe(this.ratingRemovals$)}addObserver(e,t=10){if(!e.rate)return void this.logger.error(`rate() not supported by ${e.id}.`);const n=this.logger.id(e.id);this.observeRemovals(e.id).pipe(Gt((e=>e.slice(0,t))),lr((t=>Promise.all(t.map((t=>e.rate(t,0).then((()=>t))))))),lr((e=>this.applyRemovals(e))),cr((e=>(n.error(e),[])))).subscribe(n)}observeRemovals(e){return Zn([this.ratingRemovals$,this.lock$]).pipe(ze((([e])=>e.length>0)),Gt((([t])=>t.filter((t=>t.src.startsWith(`${e}:`)&&!this.isLocked(t))))),tr(((e,t)=>{const n=e.map((e=>e.src)).sort(),r=t.map((e=>e.src)).sort();return String(n)===String(r)})))}lock(e,t){this.lock$.next({serviceId:e,itemType:t})}unlock(){this.lock$.next(null)}rate(e,t){return ur(this,void 0,void 0,(function*(){const n=e.src,[r]=n.split(":"),i=_l(r);if(!i)throw Error(`Service not found '${r}'.`);if(!i.rate)throw Error(`rate() not supported by ${r}.`);{const n=this.getRemovedItem(e);this.isLocked(e)?t?(n&&(yield this.ratingRemovals.delete(n.src)),t>1&&(yield i.rate(e,t))):n||(yield this.ratingRemovals.put(this.createRatingObject(e))):(n&&(yield this.ratingRemovals.delete(n.src)),yield i.rate(e,t)),ir.dispatch({match:t=>i.compareForRating(t,e),values:{rating:t}})}}))}get(e,t){return this.getRemovedItem(e)?0:t}applyRemovals(e){return ur(this,void 0,void 0,(function*(){const t=e.map((e=>this.getRemovedItem(e))).filter(l);if(t.length>0){const e=t.map((e=>e.src));yield this.ratingRemovals.bulkDelete(e),ir.dispatch({match:e=>{const[n]=e.src.split(":"),r=_l(n);return t.some((t=>null==r?void 0:r.compareForRating(e,t)))},values:{rating:0}})}}))}getRemovedItem(e){const[t]=e.src.split(":"),n=_l(t);if(null==n?void 0:n.rate)return this.ratingRemovals$.getValue().find((t=>n.compareForRating(t,e)))}isLocked(e){const t=this.lock$.getValue();if(t){const[n]=e.src.split(":");return t.serviceId===n&&t.itemType===e.itemType}return!1}createRatingObject(e){if("pager"in e){const{pager:t}=e;return function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["pager"])}return e}}const mr=new dr;function hr(e){return e<=0?function(){return cn}:Oe((function(t,n){var r=0;t.subscribe(Me(n,(function(t){++r<=e&&(n.next(t),e<=r&&n.complete())})))}))}function fr(e,{timeout:t=5e3,keepAlive:n=!1}={}){return new Promise(((r,i)=>{const a=n?void 0:()=>e.disconnect(),o=e.observeItems(),s=bn(e.observeError(),Rt(t).pipe(Gt((()=>Error("timeout")))));o.pipe(wn(s),hr(1)).subscribe({next:r,complete:a}),s.pipe(wn(o),hr(1)).subscribe({next:i,complete:a}),e.fetchAt(0)}))}class pr{constructor(e=[]){this.items=e}get maxSize(){}observeItems(){return Pn(this.items)}observeSize(){return Pn(this.items.length)}observeError(){return cn}fetchAt(){}disconnect(){this.items.forEach((e=>{var t;return null===(t=e.pager)||void 0===t?void 0:t.disconnect()}))}}const vr="eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ijk3RjI2N1daRDkifQ.eyJpYXQiOjE2NzY5MTcxNzEsImV4cCI6MTY5MjQ2OTE3MSwiaXNzIjoiODM4Nk5ERlhMQiJ9.gb8gDSxxWxSQNKWz_OtyMumKDn8wil6kYAMYHcNgzYhr9k0QS7R8JJp_3DCJxy_9KlgGe7wmlLESpvsQ2Zd2Pg".toString(),br="41bd731be5b78200d2bbaea2312b917b".toString(),gr="78aa93b641329f00e68cf1542356b8fc".toString(),yr="68c1c915728f4b9da193da1028692f0d".toString(),wr="AIzaSyD-cQaU5ntJBcCEBAbmK5pIXD4FQ19fdho".toString(),Er="364143070327-sgopc15lidje8uq4l16k1u8pqo2hpc4o.apps.googleusercontent.com".toString(),xr=new z("apple"),kr={get useMusicKitBeta(){return xr.getBoolean("useMusicKitBeta")},set useMusicKitBeta(e){xr.setBoolean("useMusicKitBeta",e)},clear(){xr.clear()}};var Sr=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};class Cr{constructor(e){this.MusicKit=e}get version(){return this.MusicKit.version}get Events(){return this.MusicKit.Events}get PlaybackStates(){return this.MusicKit.PlaybackStates}configure(e){return Sr(this,void 0,void 0,(function*(){const t=this.MusicKit.configure(e);return this.instance=t,Object.defineProperties(t,{volume:{get:()=>t.player.volume,set:e=>t.player.volume=e},queue:{get:()=>t.player.queue},isPlaying:{get:()=>t.player.isPlaying},nowPlayingItem:{get:()=>t.player.nowPlayingItem}}),Object.defineProperties(t.api,{music:{get:()=>(e,t,n)=>this.music(e,t,n)}}),this.instance}))}getInstance(){const e=this.instance;if(e)return e.api.music||Object.defineProperties(e.api,{music:{get:()=>(e,t,n)=>this.music(e,t,n)}}),e;throw Error("Not configured.")}formatArtworkURL(e,t,n){return this.MusicKit.formatArtworkURL(e,t,n)}music(e,t,n){return Sr(this,void 0,void 0,(function*(){const r=this.getInstance();t&&(e=`${e}${e.includes("?")?"&":"?"}${new URLSearchParams(t)}`),e=e.replace("{{storefrontId}}",r.storefrontId);const i=(null==n?void 0:n.fetchOptions)||{};i.headers||(i.headers={}),i.headers=Object.assign(Object.assign({},i.headers),{authorization:`Bearer ${r.developerToken}`,"music-user-token":r.musicUserToken});const a=yield fetch(`https://api.music.apple.com${e}`,i);if(!a.ok){const e=new Error(String(a.status));throw e.data=a,e}return{data:yield a.json()}}))}}var Tr=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::appleAuth");const Pr=new A("appleAuth"),Ar=new Ie(!1);function Ir(){return Ar.getValue()}function Or(){return Ar.pipe(tr())}function Mr(){return Tr(this,void 0,void 0,(function*(){if(Ir()){Pr.log("logout");const e=yield $r();try{e.isPlaying&&e.stop(),e.queue.isEmpty||(yield e.setQueue({}))}catch(e){Pr.error(e)}yield e.unauthorize(),Ar.next(!1)}}))}function Nr(){return Tr(this,void 0,void 0,(function*(){throw Pr.log("refreshToken"),yield Mr(),Error("Access token refresh is not supported.")}))}function $r(){return Tr(this,void 0,void 0,(function*(){return window.MusicKit?MusicKit.getInstance():new Promise(((e,t)=>{c(`https://js-cdn.music.apple.com/musickit/v${kr.useMusicKitBeta?3:1}/musickit.js`).then(void 0,t),document.addEventListener("musickitloaded",(()=>Tr(this,void 0,void 0,(function*(){Pr.log("Loaded MusicKit version",MusicKit.version),window.MusicKit.version.startsWith("1")&&(window.MusicKit=new Cr(MusicKit));try{const t=yield window.MusicKit.configure({developerToken:vr,app:{name:"ampcast",build:"0.8.15"},sourceType:8,suppressErrorDialog:!0});e(t)}catch(e){t(e)}}))))}))}))}var zr;!function(){Tr(this,void 0,void 0,(function*(){const e=yield $r();e.isAuthorized&&(yield e.authorize(),Pr.log("Access token successfully obtained."),Ar.next(!0)),e.addEventListener(MusicKit.Events.authorizationStatusDidChange,(()=>{Pr.log("authorizationStatusDidChange",e.isAuthorized),e.isAuthorized||Ar.next(!1)}))}))}(),function(e){e[e.Audio=0]="Audio",e[e.Video=1]="Video"}(zr||(zr={}));const jr=zr,Lr=new A("DualPager");class Rr{constructor(e,t){this.topPager=e,this.mainPager=t,this.fetches$=new Ie({index:0,length:0}),this.disconnected=!1}get maxSize(){}observeItems(){return Zn([this.topPager.observeItems(),this.mainPager.observeItems()]).pipe(Gt((([e,t])=>e.concat(t))))}observeSize(){return Zn([this.topPager.observeSize(),this.mainPager.observeSize()]).pipe(Gt((([e,t])=>e+t)))}observeError(){return this.mainPager.observeError()}disconnect(){var e;this.disconnected||(this.disconnected=!0,null===(e=this.subscriptions)||void 0===e||e.unsubscribe(),this.topPager.disconnect(),this.mainPager.disconnect())}fetchAt(e,t){this.disconnected?Lr.warn("disconnected"):(this.subscriptions||this.connect(),this.fetches$.next({index:e,length:t}))}connect(){this.subscriptions||(this.subscriptions=new ne,this.subscriptions.add(Zn([this.topPager.observeSize(),this.observeFetches()]).pipe($e((([e,t])=>this.mainPager.fetchAt(Math.max(t.index-e,0),t.length)))).subscribe(Lr)))}observeFetches(){return this.fetches$.pipe(ze((e=>e.length>0)))}}var Dr=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=Nt);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return K(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,i=n._buffer,a=n._infiniteTimeWindow,o=n._timestampProvider,s=n._windowTime;r||(i.push(t),!a&&i.push(o.now()+s)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,a=(i?1:2)*t;if(t<1/0&&a<r.length&&r.splice(0,r.length-a),!i){for(var o=n.now(),s=0,l=1;l<r.length&&r[l]<=o;l+=2)s=l;s&&r.splice(0,s+1)}},t}(Pe);const _r=[],Fr=new A("AbstractPager");let Vr=0;class Ur{constructor(e={}){this.config=e,this.items$=new Ie(_r),this.size$=new Dr(1),this.error$=new Dr(1),this.fetches$=new Ie({index:0,length:0}),this.disconnected=!1}get maxSize(){return this.config.maxSize}observeAdditions(){return this.items$.pipe(Oe((function(e,t){var n,r=!1;e.subscribe(Me(t,(function(e){var i=n;n=e,r&&t.next([i,e]),r=!0})))})),Gt((([e,t])=>t.filter((t=>!e.find((e=>(null==e?void 0:e.src)===t.src)))))),ze((e=>e.length>0)))}observeItems(){return this.items$.pipe(ze((e=>e!==_r)))}observeSize(){return this.size$.pipe(tr())}observeError(){return this.error$}disconnect(){this.disconnected||(this.disconnected=!0,this.subscriptions&&(this.subscriptions.unsubscribe(),Vr--),this.items.forEach((e=>{var t;return null===(t=e.pager)||void 0===t?void 0:t.disconnect()})),this.items$.complete(),this.size$.complete(),this.error$.complete())}fetchAt(e,t=this.config.pageSize){if(this.disconnected)Fr.warn("disconnected");else{if(t||(t=50),!this.subscriptions&&(this.connect(),this.config.calculatePageSize)){const{minPageSize:e=10,maxPageSize:n=100}=this.config,r=10*Math.ceil(2*t/10);this.config.pageSize=Math.max(Math.min(r,n),e)}this.fetches$.next({index:e,length:t})}}get items(){return this.items$.getValue()}observeComplete(){return Zn([this.observeItems(),this.observeSize()]).pipe(ze((([e,t])=>e.reduce((e=>e+1),0)===t)),Gt((([e])=>e)),hr(1))}connect(){this.disconnected||this.subscriptions||(Vr++,Vr>100&&Fr.warn(`Too many pagers? Connected pagers=${Vr}.`),this.subscriptions=new ne,this.config.lookup||(this.subscriptions.add(this.observeAdditions().pipe($e((e=>this.addMissingTrackCounts(e)))).subscribe(Fr)),this.subscriptions.add(ir.observe().pipe($e((e=>this.applyChanges(e)))).subscribe(Fr))))}applyChanges(e){let t=!1;const n=this.items.map((n=>{for(const{match:r,values:i}of e)if(r(n))return t=!0,Object.assign(Object.assign({},n),i);return n}));t&&this.items$.next(n)}addMissingTrackCounts(e){e.forEach((e=>{e.itemType===Kn.Playlist&&!e.trackCount&&e.pager&&this.subscriptions.add(e.pager.observeSize().pipe($e((t=>{const n=e.src,r=this.items.findIndex((e=>e.src===n));if(-1!==r){const e=this.items.slice(),n=e[r];e[r]=Object.assign(Object.assign({},n),{trackCount:t}),this.items$.next(e)}}))).subscribe(Fr))}))}}const Br=new A("SequentialPager");class Hr extends Ur{constructor(e,t){super(t),this.fetchNext=e,this.fetching$=new Ie(!1),this.maxEmptyCount=2,this.emptyCount=0}connect(){this.subscriptions||(super.connect(),this.subscriptions.add(this.observeShouldFetch().pipe($e((()=>this.fetching$.next(!0))),lr((()=>this.fetchNext(this.config.pageSize))),$e((e=>this.addPage(e))),cr((e=>(Br.error(e),this.error$.next(e),Pn(void 0)))),$e((()=>this.fetching$.next(!1))),wn(this.observeComplete()),hr(100)).subscribe(Br)))}observeShouldFetch(){const e=Zn([this.fetches$,this.items$]).pipe(Gt((([{index:e,length:t},n])=>e+2*t>=n.length)),ze((e=>e)),Gt((()=>{})),hr(1));return this.fetching$.pipe(yn((t=>t?cn:e)))}addPage(e){var t,n;const r=(e.items||[]).filter(l),i=h(this.items.concat(r),"src");i.length===this.items.length&&this.emptyCount++,i.length=Math.min(i.length,null!==(t=this.maxSize)&&void 0!==t?t:1/0);const a=e.atEnd||i.length===this.maxSize||this.emptyCount>this.maxEmptyCount?i.length:e.total;void 0!==a&&this.size$.next(Math.min(a,null!==(n=this.maxSize)&&void 0!==n?n:1/0)),this.items$.next(i)}}class Yr extends Ur{constructor(e){super(),this.fetch=e}fetchAt(e){if(!this.disconnected&&!this.subscriptions){this.connect();const t=this.fetch(e);this.size$.next(t.length),this.items$.next(t)}}disconnect(){super.disconnect(),this.items.forEach((e=>{var t;return null===(t=e.pager)||void 0===t?void 0:t.disconnect()}))}}var Kr=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const Wr=new A("pinStore"),qr=[];class Jr extends vt.ZP{constructor(){super("ampcast/pins"),this.pins$=new Ie(qr),this.lockedPin$=new Ie(null),this.version(1).stores({pins:"&src"}),(0,vt.Y1)((()=>this.pins.toArray())).subscribe(this.pins$)}lock(e){this.lockedPin$.next(e)}unlock(){this.lockedPin$.next(null)}pin(e){return Kr(this,void 0,void 0,(function*(){try{const t=Array.isArray(e)?e:[e];Wr.log("pin",{playlists:t}),yield this.pins.bulkPut(t.map((e=>{const{pager:t}=e,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["pager"]);return Object.assign(Object.assign({},n),{isPinned:!0})}))),ir.dispatch(t.map((e=>({match:t=>t.src===e.src,values:{isPinned:!0}}))))}catch(e){Wr.error(e)}}))}unpin(e){return Kr(this,void 0,void 0,(function*(){try{const t=Array.isArray(e)?e:[e];Wr.log("unpin",{playlists:t}),yield this.pins.bulkDelete(t.map((e=>e.src))),ir.dispatch(t.map((e=>({match:t=>t.src===e.src,values:{isPinned:!1}}))))}catch(e){Wr.error(e)}}))}isPinned(e){return-1!==this.pins$.getValue().findIndex((t=>t.src===e))}observe(){return Zn([this.pins$,this.lockedPin$]).pipe(ze((([e])=>e!==qr)),Gt((([e])=>e)))}getPinsForService(e){const t=this.pins$.getValue().slice(),n=this.lockedPin$.getValue();return n&&!t.find((e=>e.src===n.src))&&t.push(n),t.filter((t=>t.src.startsWith(`${e}:`))).sort(((e,t)=>e.title.localeCompare(t.title,void 0,{sensitivity:"accent",ignorePunctuation:!0})))}}const Qr=new Jr;var Gr=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const Xr=new A("MusicKitPager");class Zr{static defaultToPage(e){var t,n,r;const i=(null===(n=null===(t=e.data[0])||void 0===t?void 0:t.relationships)||void 0===n?void 0:n.tracks)||e,a=i.data||[],o=i.next;return{items:a,total:null===(r=i.meta)||void 0===r?void 0:r.total,nextPageUrl:o}}constructor(e,t,n,r,i=Zr.defaultToPage){this.options=n,this.parent=r,this.nextPageUrl=void 0,this.pager=new Hr((n=>Gr(this,void 0,void 0,(function*(){const r=yield this.fetchNext(this.nextPageUrl||e,n?t?Object.assign(Object.assign({},t),{limit:n}):{limit:n}:t),a=i(r.data),o=this.createItems(a.items),s=a.total,l=!a.nextPageUrl;return this.nextPageUrl=a.nextPageUrl,{items:o,total:s,atEnd:l}}))),n)}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){var e;this.pager.disconnect(),null===(e=this.subscriptions)||void 0===e||e.unsubscribe()}fetchAt(e,t){this.subscriptions||this.connect(),this.pager.fetchAt(e,t)}connect(){var e;this.subscriptions||(this.subscriptions=new ne,(null===(e=this.options)||void 0===e?void 0:e.lookup)||(this.subscriptions.add(this.pager.observeAdditions().pipe(Zt((e=>hi(e,!0)))).subscribe(Xr)),this.subscriptions.add(this.pager.observeAdditions().pipe(Zt((e=>fi(e,!0,this.parent)))).subscribe(Xr))))}fetchNext(e,t){return Gr(this,void 0,void 0,(function*(){try{return yield MusicKit.getInstance().api.music(e,t)}catch(n){const r=null==n?void 0:n.data.status;if(401===r||403===r)return yield Nr(),MusicKit.getInstance().api.music(e,t);throw n}}))}createItems(e){return e.map((e=>this.createItem(e)))}createItem(e){switch(e.type){case"playlists":case"library-playlists":return this.createMediaPlaylist(e);case"artists":case"library-artists":return this.createMediaArtist(e);case"albums":case"library-albums":return this.createMediaAlbum(e);case"songs":case"library-songs":case"music-videos":case"library-music-videos":return this.createMediaItem(e)}}createMediaPlaylist(e){var t,n;const r=this.createFromLibrary(e),i=(null===(t=r.description)||void 0===t?void 0:t.standard)||(null===(n=r.description)||void 0===n?void 0:n.short),a=`apple:${e.type}:${e.id}`,o=this.getCatalogId(e),s={src:a,itemType:Kn.Playlist,externalUrl:r.url||void 0,title:r.name,description:i?T(i):void 0,thumbnails:this.createThumbnails(r),owner:r.curatorName?{name:r.curatorName}:void 0,modifiedAt:Math.floor(new Date(r.lastModifiedDate).valueOf()/1e3)||void 0,unplayable:!r.playParams||void 0,isPinned:Qr.isPinned(a),inLibrary:sr.get(a,e.type.startsWith("library-")||void 0),apple:{catalogId:o}};return s.rating=mr.get(s),s.pager=new Zr(`${e.href}/tracks`,void 0,void 0,s),s}createMediaArtist(e){var t,n;const r=this.createFromLibrary(e),i=(null===(t=r.editorialNotes)||void 0===t?void 0:t.standard)||(null===(n=r.editorialNotes)||void 0===n?void 0:n.short),a=this.getCatalogId(e);return{itemType:Kn.Artist,src:`apple:${e.type}:${e.id}`,externalUrl:r.url||void 0,title:r.name,description:i?T(i):void 0,thumbnails:this.createThumbnails(r),genres:this.getGenres(r),pager:this.createArtistAlbumsPager(e),apple:{catalogId:a}}}createArtistTopTracks(e){const t=this.createFromLibrary(e);return{itemType:Kn.Album,src:`apple:top-tracks:${e.id}`,title:"Top Tracks",thumbnails:this.createThumbnails(t),artist:t.name,genres:this.getGenres(t),pager:this.createTopTracksPager(e),synthetic:!0,inLibrary:!1,apple:{catalogId:""}}}createMediaAlbum(e){var t,n;const r=this.createFromLibrary(e),i=`apple:${e.type}:${e.id}`,a=(null===(t=r.editorialNotes)||void 0===t?void 0:t.standard)||(null===(n=r.editorialNotes)||void 0===n?void 0:n.short),o=this.getCatalogId(e),s={itemType:Kn.Album,src:i,externalUrl:r.url||void 0,title:r.name,description:a?T(a):void 0,thumbnails:this.createThumbnails(r),artist:r.artistName,trackCount:r.trackCount,genres:this.getGenres(r),year:new Date(r.releaseDate).getFullYear()||0,unplayable:!r.playParams||void 0,inLibrary:sr.get(i,e.type.startsWith("library-")||void 0),apple:{catalogId:o}};return s.rating=mr.get(s),s.pager=new Zr(`${e.href}/tracks`,void 0,void 0,s),s}createMediaItem(e){var t,n,r,i,a;const o=this.createFromLibrary(e),{id:s,kind:l}=o.playParams||{id:e.id,kind:"music-videos"===e.type?"musicVideo":"song"},c=`apple:${e.type}:${s}`,u=(null===(t=o.editorialNotes)||void 0===t?void 0:t.standard)||(null===(n=o.editorialNotes)||void 0===n?void 0:n.short),d=e.type.startsWith("library-"),m=(null===(r=this.parent)||void 0===r?void 0:r.itemType)===Kn.Playlist,h=this.getCatalogId(e);let f=o.url||void 0;!f&&h&&(null===(i=this.parent)||void 0===i?void 0:i.itemType)===Kn.Album&&this.parent.externalUrl&&(f=`${this.parent.externalUrl}?i=${h}`);const p={itemType:Kn.Media,mediaType:"musicVideo"===l?jr.Video:jr.Audio,src:c,externalUrl:f,title:o.name,description:u?T(u):void 0,thumbnails:this.createThumbnails(o),artists:[o.artistName],albumArtist:(null===(a=this.parent)||void 0===a?void 0:a.itemType)===Kn.Album?this.parent.artist:void 0,album:o.albumName,duration:o.durationInMillis/1e3,genres:this.getGenres(o),disc:o.discNumber,track:o.trackNumber,year:new Date(o.releaseDate).getFullYear()||void 0,isrc:o.isrc,unplayable:!o.playParams||void 0,playedAt:0,inLibrary:sr.get(c,d&&!m||void 0),apple:{catalogId:h}};return p.rating=mr.get(p),p}getCatalogId(e){var t,n,r;if(e.type.startsWith("library-")){let i=null===(n=null===(t=e.attributes)||void 0===t?void 0:t.playParams)||void 0===n?void 0:n["library-playlists"===e.type?"globalId":"catalogId"];return i||(i=null===(r=this.getCatalog(e))||void 0===r?void 0:r.id),i||""}return e.id}createFromLibrary(e){var t;return x(e.attributes,null===(t=this.getCatalog(e))||void 0===t?void 0:t.attributes)}getCatalog(e){var t,n,r;return null===(r=null===(n=null===(t=e.relationships)||void 0===t?void 0:t.catalog)||void 0===n?void 0:n.data)||void 0===r?void 0:r[0]}createThumbnails({artwork:e}){return e?[this.createThumbnail(e,120),this.createThumbnail(e,240),this.createThumbnail(e,360),this.createThumbnail(e,480)]:void 0}createThumbnail(e,t){return{url:MusicKit.formatArtworkURL(e,t,t),width:t,height:t}}createArtistAlbumsPager(e){const t=new Zr(`${e.href}/albums`);if(e.type.startsWith("library-"))return t;const n=this.createArtistTopTracks(e),r=new Yr((()=>[n]));return r.fetchAt(0),new Rr(r,t)}createTopTracksPager(e){return new Zr(e.href,{"limit[artists:top-songs]":"20",views:"top-songs"},{maxSize:20},void 0,(e=>{var t,n,r;const i=(null===(n=null===(t=e.data[0])||void 0===t?void 0:t.views)||void 0===n?void 0:n["top-songs"])||e,a=i.data||[],o=i.next;return{items:a,total:null===(r=i.meta)||void 0===r?void 0:r.total,nextPageUrl:o}}))}getGenres({genreNames:e=[]}){return e.filter((e=>"Music"!==e))}}var ei=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::apple");const ti={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","Duration"]},ni={id:"apple/recommendations",title:"Recommended",icon:"playlist",itemType:Kn.Playlist,defaultHidden:!0,search:()=>new Zr("/v1/me/recommendations",void 0,void 0,void 0,(({data:e=[],next:t,meta:n})=>{const r=e.map((e=>e.relationships.contents.data.filter((e=>"playlists"===e.type)))).flat();return{items:r,total:null==n?void 0:n.total,nextPageUrl:t}}))},ri={id:"apple/recently-played",title:"Recently Played",icon:"clock",itemType:Kn.Media,layout:ti,search:()=>new Zr("/v1/me/recent/played/tracks",void 0,{pageSize:30,maxSize:200})},ii={id:"apple/library-songs",title:"My Songs",icon:"tick",itemType:Kn.Media,viewType:qn.Library,layout:ti,defaultHidden:!0,search:()=>new Zr("/v1/me/library/songs")},ai={id:"apple/library-albums",title:"My Albums",icon:"tick",itemType:Kn.Album,viewType:qn.Library,search:()=>new Zr("/v1/me/library/albums",{"fields[library-albums]":"name,artistName,playParams","include[library-albums]":"catalog"})},oi={id:"apple/library-artists",title:"My Artists",icon:"tick",itemType:Kn.Artist,viewType:qn.Library,defaultHidden:!0,search:()=>new Zr("/v1/me/library/artists",{"fields[library-artists]":"name,playParams","include[library-artists]":"catalog","omit[resource:artists]":"relationships"})},si={id:"apple/playlists",title:"Playlists",icon:"playlist",itemType:Kn.Playlist,viewType:qn.Library,search:()=>new Zr("/v1/me/library/playlists",{"fields[library-playlists]":"name,playParams","include[library-playlists]":"catalog"})},li={id:"apple/library-videos",title:"My Videos",icon:"tick",itemType:Kn.Media,viewType:qn.Library,layout:ti,defaultHidden:!0,search:()=>new Zr("/v1/me/library/music-videos")},ci={id:"apple",name:"Apple Music",icon:"apple",url:"https://music.apple.com",roots:[di(Kn.Media,{title:"Songs",layout:ti}),di(Kn.Album,{title:"Albums"}),di(Kn.Artist,{title:"Artists"}),di(Kn.Playlist,{title:"Playlists"}),di(Kn.Media,{title:"Videos",layout:ti},{types:"music-videos"},{maxSize:250})],sources:[ii,ai,oi,li,ri,si,ni],labels:{[Hn.AddToLibrary]:"Add to Apple Music Library",[Hn.RemoveFromLibrary]:"Saved to Apple Music Library",[Hn.Like]:"Love on Apple Music",[Hn.Unlike]:"Unlove on Apple Music"},canRate:function(){return!1},canStore:function(e){switch(e.itemType){case Kn.Media:case Kn.Playlist:return!0;case Kn.Album:return!e.synthetic;default:return!1}},compareForRating:function(e,t){return e.src===t.src},createSourceFromPin:function(e){return{title:e.title,itemType:Kn.Playlist,id:e.src,icon:"pin",isPin:!0,search(){const[,t,n]=e.src.split(":"),r=t.startsWith("library-");return new Zr(`${r?"/v1/me/library":"/v1/catalog/{{storefrontId}}"}/playlists/${n}`,r?{"include[library-playlists]":"catalog","fields[library-playlists]":"name,playParams"}:{"omit[resource:playlists]":"relationships"})}}},getMetadata:function(e){var t;return ei(this,void 0,void 0,(function*(){if(e.itemType===Kn.Playlist&&e.isOwn)return e;let n=e;if(!e.externalUrl){const[,r,i]=e.src.split(":"),a=r.startsWith("library-"),o=new Zr(`${a?"/v1/me/library":"/v1/catalog/{{storefrontId}}"}/${r.replace("library-","")}/${i}${a?"/catalog":""}`,a?void 0:{[`omit[resource:${r.replace("library-","")}]`]:"relationships"},{lookup:!0}),s=yield fr(o,{timeout:2e3});n=x(e,s[0]),n.description=(null===(t=s[0])||void 0===t?void 0:t.description)||e.description}return n.inLibrary=sr.get(n.src,n.inLibrary),void 0===n.inLibrary&&fi([n]),n.rating=mr.get(n,n.rating),void 0===n.rating&&hi([n]),n}))},lookup:function(e,t,n=10,r){return ei(this,void 0,void 0,(function*(){return e&&t?fr(mi(Kn.Media,`${e} ${t}`,void 0,{pageSize:n,maxSize:n,lookup:!0}),{timeout:r}):[]}))},rate:function(e,t){return ei(this,void 0,void 0,(function*(){const n=MusicKit.getInstance(),[,r,i]=e.src.split(":"),a=`/v1/me/ratings/${r}/${i}`;t?yield n.api.music(a,void 0,{fetchOptions:{method:"PUT",body:JSON.stringify({type:"rating",attributes:{value:t}})}}):yield n.api.music(a,void 0,{fetchOptions:{method:"DELETE"}})}))},store:function(e,t){var n;return ei(this,void 0,void 0,(function*(){const r=MusicKit.getInstance(),[,i]=e.src.split(":"),a=i.replace("library-",""),o=null===(n=e.apple)||void 0===n?void 0:n.catalogId,s="/v1/me/library";if(t){const e=`ids[${a}]`;return r.api.music(s,{[e]:o},{fetchOptions:{method:"POST"}})}return r.api.music(`${s}/${a}/${o}`,void 0,{fetchOptions:{method:"DELETE"}})}))},observeIsLoggedIn:Or,isLoggedIn:Ir,login:function(){return Tr(this,void 0,void 0,(function*(){if(!Ir()){Pr.log("login");try{const e=yield $r();yield e.authorize(),Pr.log("Access token successfully obtained."),Ar.next(!0)}catch(e){Pr.log("Could not obtain access token."),Pr.error(e)}}}))},logout:Mr},ui=ci;function di(e,t,n,r){return Object.assign(Object.assign({},t),{itemType:e,id:`apple/search/${t.title.toLowerCase()}`,icon:"search",searchable:!0,search:({q:t=""}={})=>mi(e,t,n,r)})}function mi(e,t,n,r){if(t){const i=Object.assign(Object.assign({},n),{term:t});if(!i.types){switch(e){case Kn.Media:i.types="songs";break;case Kn.Album:i.types="albums";break;case Kn.Artist:i.types="artists";break;case Kn.Playlist:i.types="playlists"}i[`omit[resource:${i.types}]`]="relationships"}const a=i.types;return new Zr("/v1/catalog/{{storefrontId}}/search",i,Object.assign({maxSize:250,pageSize:25},r),void 0,(e=>{var t;const n=e.results[a]||{data:[]},r=n.next,i=null===(t=e.meta)||void 0===t?void 0:t.total;return{items:n.data,total:i,nextPageUrl:r}}))}return new pr}function hi(e,t=!1){return ei(this,void 0,void 0,(function*(){const n=e[0];if(!n||!ci.canRate(n,t))return;const r=e.filter((e=>void 0===e.rating)).map((e=>{const[,,t]=e.src.split(":");return t}));if(0===r.length)return;const[,i]=n.src.split(":"),a=MusicKit.getInstance(),{data:{data:o}}=yield a.api.music(`/v1/me/ratings/${i}`,{ids:r});if(!o)return;const s=new Map(o.map((e=>[e.id,e.attributes.value])));ir.dispatch(r.map((e=>({match:t=>t.src===`apple:${i}:${e}`,values:{rating:s.get(e)||0}}))))}))}function fi(e,t=!1,n){return ei(this,void 0,void 0,(function*(){const r=e[0];if(!r||!ci.canStore(r,t))return;const i=(null==n?void 0:n.itemType)===Kn.Album,a=e.filter((e=>void 0===e.inLibrary&&!(i&&e.src.startsWith("apple:library-")))).map((e=>{var t;return null===(t=e.apple)||void 0===t?void 0:t.catalogId})).filter((e=>!!e));if(0===a.length)return;let[,o]=r.src.split(":");o=o.replace("library-","");const s=MusicKit.getInstance(),{data:{resources:l}}=yield s.api.music("/v1/catalog/{{storefrontId}}",{[`fields[${o}]`]:"inLibrary","format[resources]":"map",[`ids[${o}]`]:a,"omit[resource]":"autos"}),c=l[o];if(!c)return;const u=new Map(Object.keys(c).map((e=>[e,c[e].attributes.inLibrary])));ir.dispatch(a.map((e=>({match:t=>{var n;return(null===(n=t.apple)||void 0===n?void 0:n.catalogId)===e},values:{inLibrary:u.get(e)||!1}}))))}))}let pi=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"");const vi=new z("jellyfin"),bi={get host(){return vi.getString("host")},set host(e){vi.setString("host",e)},get device(){return"PC"},get deviceId(){let e=vi.getString("deviceId");return e||(e=pi(),vi.setString("deviceId",e)),e},get serverId(){return vi.getString("serverId")},set serverId(e){vi.setString("serverId",e)},get token(){return vi.getString("token")},set token(e){vi.setString("token",e)},get userId(){return vi.getString("userId")},set userId(e){vi.setString("userId",e)},clear(){vi.removeItem("serverId"),vi.removeItem("userId"),vi.removeItem("token")}};var gi=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function yi(e,t){return gi(this,void 0,void 0,(function*(){const{device:n,deviceId:r,token:i}=bi;if(!i)throw Error("No access token.");return e.startsWith("/")&&(e=e.slice(1)),t.headers=Object.assign(Object.assign({},t.headers),{"X-Emby-Authorization":`MediaBrowser Client="ampcast", Version="0.8.15", Device="${n}", DeviceId="${r}", Token="${i}"`}),window.fetch(`${bi.host}/${e}`,t)}))}console.log("module::jellyfinApi");const wi={delete:function(e,t={}){return gi(this,void 0,void 0,(function*(){return yi(`${e}?${new URLSearchParams(t)}`,{method:"DELETE"})}))},get:function(e,t={}){return gi(this,void 0,void 0,(function*(){return yi(`${e}?${new URLSearchParams(t)}`,{method:"GET"})}))},post:function(e,t={}){return gi(this,void 0,void 0,(function*(){const n=JSON.stringify(t);return yi(e,{method:"POST",headers:{"Content-Type":"application/json"},body:n})}))},getPlayableUrlFromSrc:function(e){const{host:t,userId:n,token:r,deviceId:i}=bi;if(t&&n&&r&&i){const[,,a]=e.split(":");return`${t}/Audio/${a}/universal?${new URLSearchParams({MaxStreamingBitrate:"140000000",MaxSampleRate:"48000",TranscodingProtocol:"hls",TranscodingContainer:"ts",Container:"opus,webm|opus,mp3,aac,m4a|aac,m4a|alac,m4b|aac,flac,webma,webm|webma,wav,ogg",AudioCodec:"aac",static:"true",UserId:n,api_key:r,DeviceId:i})}`}throw Error("Not logged in.")}},Ei=wi;function xi({name:e,className:t=""}){switch(t=`icon icon-${e} ${t}`,e){case"ampcast":return r.createElement("svg",{className:t,viewBox:"0 0 24 24"},r.createElement("circle",{cx:"12",cy:"12",r:"8",strokeWidth:"4",stroke:"orange",fill:"black"}),r.createElement("circle",{cx:"12",cy:"12",r:"2",stroke:"none",fill:"white"}));case"play":return r.createElement("svg",{className:t,viewBox:"0 0 448 512"},r.createElement("path",{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"}));case"pause":return r.createElement("svg",{className:t,viewBox:"0 0 448 512"},r.createElement("path",{d:"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"}));case"stop":return r.createElement("svg",{className:t,viewBox:"0 0 448 512"},r.createElement("path",{d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"}));case"volume":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{className:"high medium",stroke:"none",d:"M11.536 14.01A8.473 8.473 0 0 0 14.026 8a8.473 8.473 0 0 0-2.49-6.01l-.708.707A7.476 7.476 0 0 1 13.025 8c0 2.071-.84 3.946-2.197 5.303l.708.707z"}),r.createElement("path",{className:"medium",stroke:"none",d:"M10.121 12.596A6.48 6.48 0 0 0 12.025 8a6.48 6.48 0 0 0-1.904-4.596l-.707.707A5.483 5.483 0 0 1 11.025 8a5.483 5.483 0 0 1-1.61 3.89l.706.706z"}),r.createElement("path",{stroke:"none",d:"M8.707 11.182A4.486 4.486 0 0 0 10.025 8a4.486 4.486 0 0 0-1.318-3.182L8 5.525A3.489 3.489 0 0 1 9.025 8 3.49 3.49 0 0 1 8 10.475l.707.707zM6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06z"}));case"muted":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{stroke:"none",d:"M6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06zm7.137 2.096a.5.5 0 0 1 0 .708L12.207 8l1.647 1.646a.5.5 0 0 1-.708.708L11.5 8.707l-1.646 1.647a.5.5 0 0 1-.708-.708L10.793 8 9.146 6.354a.5.5 0 1 1 .708-.708L11.5 7.293l1.646-1.647a.5.5 0 0 1 .708 0z"}));case"prev":return r.createElement("svg",{className:t,viewBox:"0 0 448 512"},r.createElement("path",{d:"M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z"}));case"next":return r.createElement("svg",{className:t,viewBox:"0 0 448 512"},r.createElement("path",{d:"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"}));case"info":return r.createElement("svg",{className:t,viewBox:"0 0 512 512"},r.createElement("path",{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"}));case"menu":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{d:"M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"}));case"settings":return r.createElement("svg",{className:t,viewBox:"0 0 512 512"},r.createElement("path",{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}));case"album":return r.createElement("svg",{className:t,viewBox:"0 0 24 24"},r.createElement("circle",{cx:"12",cy:"12",r:"8.5",strokeWidth:"6.5",fill:"none"}),r.createElement("circle",{cx:"12",cy:"12",r:"2",stroke:"none"}));case"locked":return r.createElement("svg",{className:t,viewBox:"0 0 448 512",transform:"scale(0.95)"},r.createElement("path",{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"}));case"unlocked":return r.createElement("svg",{className:t,viewBox:"0 0 576 512",transform:"scale(0.95)"},r.createElement("path",{d:"M423.5 0C339.5.3 272 69.5 272 153.5V224H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48h-48v-71.1c0-39.6 31.7-72.5 71.3-72.9 40-.4 72.7 32.1 72.7 72v80c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24v-80C576 68 507.5-.3 423.5 0z"}));case"left":return r.createElement("svg",{className:t,viewBox:"0 0 320 512"},r.createElement("path",{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"}));case"right":return r.createElement("svg",{className:t,viewBox:"0 0 320 512"},r.createElement("path",{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"}));case"saved":return r.createElement("svg",{className:t,viewBox:"0 0 448 512"},r.createElement("path",{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}));case"unsaved":return r.createElement("svg",{className:t,viewBox:"0 0 448 512"},r.createElement("path",{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM272 80v80H144V80h128zm122 352H54a6 6 0 0 1-6-6V86a6 6 0 0 1 6-6h42v104c0 13.255 10.745 24 24 24h176c13.255 0 24-10.745 24-24V83.882l78.243 78.243a6 6 0 0 1 1.757 4.243V426a6 6 0 0 1-6 6zM224 232c-48.523 0-88 39.477-88 88s39.477 88 88 88 88-39.477 88-88-39.477-88-88-88zm0 128c-22.056 0-40-17.944-40-40s17.944-40 40-40 40 17.944 40 40-17.944 40-40 40z"}));case"close":return r.createElement("svg",{className:t,viewBox:"0 0 64 64"},r.createElement("path",{d:"M 10.5,-0.5 C 12.1667,-0.5 13.8333,-0.5 15.5,-0.5C 20.7971,5.29805 26.2971,10.9647 32,16.5C 37.0314,10.303 42.5314,4.63636 48.5,-0.5C 49.8333,-0.5 51.1667,-0.5 52.5,-0.5C 55.8333,3.5 59.5,7.16667 63.5,10.5C 63.5,11.8333 63.5,13.1667 63.5,14.5C 57.7019,19.7971 52.0353,25.2971 46.5,31C 52.0353,36.7029 57.7019,42.2029 63.5,47.5C 63.5,49.1667 63.5,50.8333 63.5,52.5C 59.5,55.8333 55.8333,59.5 52.5,63.5C 50.8333,63.5 49.1667,63.5 47.5,63.5C 42.1604,57.8275 36.8271,52.1608 31.5,46.5C 25.479,51.8543 19.8123,57.521 14.5,63.5C 13.1667,63.5 11.8333,63.5 10.5,63.5C 7.16667,59.5 3.5,55.8333 -0.5,52.5C -0.5,50.8333 -0.5,49.1667 -0.5,47.5C 5.17254,42.1604 10.8392,36.8271 16.5,31.5C 10.8392,26.1729 5.17254,20.8396 -0.5,15.5C -0.5,13.8333 -0.5,12.1667 -0.5,10.5C 3.5,7.16667 7.16667,3.5 10.5,-0.5 Z"}));case"audio":return r.createElement("svg",{className:t,viewBox:"0 0 24 24"},r.createElement("path",{stroke:"none",d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"}));case"video":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{strokeWidth:.5,d:"M0 5a2 2 0 0 1 2-2h7.5a2 2 0 0 1 1.983 1.738l3.11-1.382A1 1 0 0 1 16 4.269v7.462a1 1 0 0 1-1.406.913l-3.111-1.382A2 2 0 0 1 9.5 13H2a2 2 0 0 1-2-2V5zm11.5 5.175 3.5 1.556V4.269l-3.5 1.556v4.35zM2 4a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h7.5a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1H2z"}));case"star":return r.createElement("svg",{className:t,viewBox:"0 0 576 512"},r.createElement("path",{className:"icon-star-outer",d:"M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z"}),r.createElement("path",{className:"icon-star-inner",d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"}));case"star-fill":return r.createElement("svg",{className:t,viewBox:"0 0 576 512"},r.createElement("path",{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"}));case"heart":return r.createElement("svg",{className:t,viewBox:"0 0 512 512"},r.createElement("path",{d:"M458.4 64.3C400.6 15.7 311.3 23 256 79.3 200.7 23 111.4 15.6 53.6 64.3-21.6 127.6-10.6 230.8 43 285.5l175.4 178.7c10 10.2 23.4 15.9 37.6 15.9 14.3 0 27.6-5.6 37.6-15.8L469 285.6c53.5-54.7 64.7-157.9-10.6-221.3zm-23.6 187.5L259.4 430.5c-2.4 2.4-4.4 2.4-6.8 0L77.2 251.8c-36.5-37.2-43.9-107.6 7.3-150.7 38.9-32.7 98.9-27.8 136.5 10.5l35 35.7 35-35.7c37.8-38.5 97.8-43.2 136.5-10.6 51.1 43.1 43.5 113.9 7.3 150.8z"}));case"heart-fill":return r.createElement("svg",{className:t,viewBox:"0 0 512 512"},r.createElement("path",{d:"M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"}));case"thumbs-up":return r.createElement("svg",{className:t,viewBox:"0 0 512 512"},r.createElement("path",{d:"M466.27 286.69C475.04 271.84 480 256 480 236.85c0-44.015-37.218-85.58-85.82-85.58H357.7c4.92-12.81 8.85-28.13 8.85-46.54C366.55 31.936 328.86 0 271.28 0c-61.607 0-58.093 94.933-71.76 108.6-22.747 22.747-49.615 66.447-68.76 83.4H32c-17.673 0-32 14.327-32 32v240c0 17.673 14.327 32 32 32h64c14.893 0 27.408-10.174 30.978-23.95 44.509 1.001 75.06 39.94 177.802 39.94 7.22 0 15.22.01 22.22.01 77.117 0 111.986-39.423 112.94-95.33 13.319-18.425 20.299-43.122 17.34-66.99 9.854-18.452 13.664-40.343 8.99-62.99zm-61.75 53.83c12.56 21.13 1.26 49.41-13.94 57.57 7.7 48.78-17.608 65.9-53.12 65.9h-37.82c-71.639 0-118.029-37.82-171.64-37.82V240h10.92c28.36 0 67.98-70.89 94.54-97.46 28.36-28.36 18.91-75.63 37.82-94.54 47.27 0 47.27 32.98 47.27 56.73 0 39.17-28.36 56.72-28.36 94.54h103.99c21.11 0 37.73 18.91 37.82 37.82.09 18.9-12.82 37.81-22.27 37.81 13.489 14.555 16.371 45.236-5.21 65.62zM88 432c0 13.255-10.745 24-24 24s-24-10.745-24-24 10.745-24 24-24 24 10.745 24 24z"}));case"tick":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{stroke:"none",d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"}),r.createElement("path",{stroke:"none",d:"M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.235.235 0 0 1 .02-.022z"}));case"plus":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{stroke:"none",d:"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"}),r.createElement("path",{stroke:"none",d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"}));case"tick-fill":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{stroke:"none",d:"M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm10.03 4.97a.75.75 0 0 1 .011 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.75.75 0 0 1 1.08-.022z"}));case"artist":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{stroke:"none",d:"M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"}));case"folder":return r.createElement("svg",{className:t,viewBox:"0 0 24 24",transform:"scale(1.25)"},r.createElement("path",{stroke:"none",d:"m9.17 6 2 2H20v10H4V6h5.17M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"}));case"folder-up":return r.createElement("svg",{className:t,viewBox:"0 0 24 24",transform:"scale(1.25)"},r.createElement("path",{stroke:"none",d:"M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V6h5.17l2 2H20v10zM9.41 14.42 11 12.84V17h2v-4.16l1.59 1.59L16 13.01 12.01 9 8 13.01l1.41 1.41z"}));case"file-audio":return r.createElement("svg",{className:t,strokeWidth:"0",viewBox:"0 0 16 16"},r.createElement("path",{d:"M14.341 3.579c-0.347-0.473-0.831-1.027-1.362-1.558s-1.085-1.015-1.558-1.362c-0.806-0.591-1.197-0.659-1.421-0.659h-7.75c-0.689 0-1.25 0.561-1.25 1.25v13.5c0 0.689 0.561 1.25 1.25 1.25h11.5c0.689 0 1.25-0.561 1.25-1.25v-9.75c0-0.224-0.068-0.615-0.659-1.421v0zM12.271 2.729c0.48 0.48 0.856 0.912 1.134 1.271h-2.406v-2.405c0.359 0.278 0.792 0.654 1.271 1.134v0zM14 14.75c0 0.136-0.114 0.25-0.25 0.25h-11.5c-0.135 0-0.25-0.114-0.25-0.25v-13.5c0-0.135 0.115-0.25 0.25-0.25 0 0 7.749-0 7.75 0v3.5c0 0.276 0.224 0.5 0.5 0.5h3.5v9.75z"}),r.createElement("path",{d:"M11.817 6.113c-0.116-0.095-0.268-0.133-0.415-0.104l-5 1c-0.234 0.047-0.402 0.252-0.402 0.49v3.701c-0.294-0.128-0.636-0.201-1-0.201-1.105 0-2 0.672-2 1.5s0.895 1.5 2 1.5 2-0.672 2-1.5v-3.59l4-0.8v2.091c-0.294-0.128-0.636-0.201-1-0.201-1.105 0-2 0.672-2 1.5s0.895 1.5 2 1.5 2-0.672 2-1.5v-5c0-0.15-0.067-0.292-0.183-0.387z"}));case"file-video":return r.createElement("svg",{className:t,viewBox:"0 0 16 16",strokeWidth:"0"},r.createElement("path",{d:"M14.341 3.579c-0.347-0.473-0.831-1.027-1.362-1.558s-1.085-1.015-1.558-1.362c-0.806-0.591-1.197-0.659-1.421-0.659h-7.75c-0.689 0-1.25 0.561-1.25 1.25v13.5c0 0.689 0.561 1.25 1.25 1.25h11.5c0.689 0 1.25-0.561 1.25-1.25v-9.75c0-0.224-0.068-0.615-0.659-1.421v0 0zM12.271 2.729c0.48 0.48 0.856 0.912 1.134 1.271h-2.406v-2.405c0.359 0.278 0.792 0.654 1.271 1.134v0 0zM14 14.75c0 0.136-0.114 0.25-0.25 0.25h-11.5c-0.135 0-0.25-0.114-0.25-0.25v-13.5c0-0.135 0.115-0.25 0.25-0.25 0 0 7.749-0 7.75 0v3.5c0 0.276 0.224 0.5 0.5 0.5h3.5v9.75z"}),r.createElement("path",{d:"M4 8h5v5h-5v-5z"}),r.createElement("path",{d:"M9 10l3-2v5l-3-2z"}));case"most-played":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{stroke:"none",d:"M2 3a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 0-1h-11A.5.5 0 0 0 2 3zm2-2a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7A.5.5 0 0 0 4 1zm2.765 5.576A.5.5 0 0 0 6 7v5a.5.5 0 0 0 .765.424l4-2.5a.5.5 0 0 0 0-.848l-4-2.5z"}),r.createElement("path",{stroke:"none",d:"M1.5 14.5A1.5 1.5 0 0 1 0 13V6a1.5 1.5 0 0 1 1.5-1.5h13A1.5 1.5 0 0 1 16 6v7a1.5 1.5 0 0 1-1.5 1.5h-13zm13-1a.5.5 0 0 0 .5-.5V6a.5.5 0 0 0-.5-.5h-13A.5.5 0 0 0 1 6v7a.5.5 0 0 0 .5.5h13z"}));case"clock":return r.createElement("svg",{className:t,viewBox:"0 0 512 512"},r.createElement("path",{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"}));case"globe":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{stroke:"none",d:"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855-.143.268-.276.56-.395.872.705.157 1.472.257 2.282.287V1.077zM4.249 3.539c.142-.384.304-.744.481-1.078a6.7 6.7 0 0 1 .597-.933A7.01 7.01 0 0 0 3.051 3.05c.362.184.763.349 1.198.49zM3.509 7.5c.036-1.07.188-2.087.436-3.008a9.124 9.124 0 0 1-1.565-.667A6.964 6.964 0 0 0 1.018 7.5h2.49zm1.4-2.741a12.344 12.344 0 0 0-.4 2.741H7.5V5.091c-.91-.03-1.783-.145-2.591-.332zM8.5 5.09V7.5h2.99a12.342 12.342 0 0 0-.399-2.741c-.808.187-1.681.301-2.591.332zM4.51 8.5c.035.987.176 1.914.399 2.741A13.612 13.612 0 0 1 7.5 10.91V8.5H4.51zm3.99 0v2.409c.91.03 1.783.145 2.591.332.223-.827.364-1.754.4-2.741H8.5zm-3.282 3.696c.12.312.252.604.395.872.552 1.035 1.218 1.65 1.887 1.855V11.91c-.81.03-1.577.13-2.282.287zm.11 2.276a6.696 6.696 0 0 1-.598-.933 8.853 8.853 0 0 1-.481-1.079 8.38 8.38 0 0 0-1.198.49 7.01 7.01 0 0 0 2.276 1.522zm-1.383-2.964A13.36 13.36 0 0 1 3.508 8.5h-2.49a6.963 6.963 0 0 0 1.362 3.675c.47-.258.995-.482 1.565-.667zm6.728 2.964a7.009 7.009 0 0 0 2.275-1.521 8.376 8.376 0 0 0-1.197-.49 8.853 8.853 0 0 1-.481 1.078 6.688 6.688 0 0 1-.597.933zM8.5 11.909v3.014c.67-.204 1.335-.82 1.887-1.855.143-.268.276-.56.395-.872A12.63 12.63 0 0 0 8.5 11.91zm3.555-.401c.57.185 1.095.409 1.565.667A6.963 6.963 0 0 0 14.982 8.5h-2.49a13.36 13.36 0 0 1-.437 3.008zM14.982 7.5a6.963 6.963 0 0 0-1.362-3.675c-.47.258-.995.482-1.565.667.248.92.4 1.938.437 3.008h2.49zM11.27 2.461c.177.334.339.694.482 1.078a8.368 8.368 0 0 0 1.196-.49 7.01 7.01 0 0 0-2.275-1.52c.218.283.418.597.597.932zm-.488 1.343a7.765 7.765 0 0 0-.395-.872C9.835 1.897 9.17 1.282 8.5 1.077V4.09c.81-.03 1.577-.13 2.282-.287z"}));case"visualizer":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{stroke:"none",d:"M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5v12h-2V2h2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3z"}));case"palette":return r.createElement("svg",{className:t,viewBox:"0 0 16 16"},r.createElement("path",{stroke:"none",d:"M8 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zm4 3a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zM5.5 7a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm.5 6a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"}),r.createElement("path",{stroke:"none",d:"M16 8c0 3.15-1.866 2.585-3.567 2.07C11.42 9.763 10.465 9.473 10 10c-.603.683-.475 1.819-.351 2.92C9.826 14.495 9.996 16 8 16a8 8 0 1 1 8-8zm-8 7c.611 0 .654-.171.655-.176.078-.146.124-.464.07-1.119-.014-.168-.037-.37-.061-.591-.052-.464-.112-1.005-.118-1.462-.01-.707.083-1.61.704-2.314.369-.417.845-.578 1.272-.618.404-.038.812.026 1.16.104.343.077.702.186 1.025.284l.028.008c.346.105.658.199.953.266.653.148.904.083.991.024C14.717 9.38 15 9.161 15 8a7 7 0 1 0-7 7z"}));case"pin":return r.createElement("svg",{className:t,viewBox:"0 0 24 24",transform:"scale(1.125)"},r.createElement("path",{stroke:"none",d:"M14 4v5c0 1.12.37 2.16 1 3H9c.65-.86 1-1.9 1-3V4h4m3-2H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3V4h1c.55 0 1-.45 1-1s-.45-1-1-1z"}));case"pin-fill":return r.createElement("svg",{className:t,viewBox:"0 0 24 24",transform:"scale(1.125)"},r.createElement("path",{stroke:"none",fillRule:"evenodd",d:"M16 9V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3z"}));case"link":return r.createElement("svg",{className:t,viewBox:"0 0 512 512"},r.createElement("path",{stroke:"none",d:"M320 0c-17.7 0-32 14.3-32 32s14.3 32 32 32h82.7L201.4 265.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L448 109.3V192c0 17.7 14.3 32 32 32s32-14.3 32-32V32c0-17.7-14.3-32-32-32H320zM80 32C35.8 32 0 67.8 0 112V432c0 44.2 35.8 80 80 80H400c44.2 0 80-35.8 80-80V320c0-17.7-14.3-32-32-32s-32 14.3-32 32V432c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V112c0-8.8 7.2-16 16-16H192c17.7 0 32-14.3 32-32s-14.3-32-32-32H80z"}));case"search":return r.createElement("svg",{className:t,viewBox:"0 0 16 16",transform:"scale(0.875)"},r.createElement("path",{stroke:"none",d:"M15.504 13.616l-3.79-3.223c-0.392-0.353-0.811-0.514-1.149-0.499 0.895-1.048 1.435-2.407 1.435-3.893 0-3.314-2.686-6-6-6s-6 2.686-6 6 2.686 6 6 6c1.486 0 2.845-0.54 3.893-1.435-0.016 0.338 0.146 0.757 0.499 1.149l3.223 3.79c0.552 0.613 1.453 0.665 2.003 0.115s0.498-1.452-0.115-2.003zM6 10c-2.209 0-4-1.791-4-4s1.791-4 4-4 4 1.791 4 4-1.791 4-4 4z"}));case"swap":return r.createElement("svg",{className:t,viewBox:"0 0 448 512"},r.createElement("path",{stroke:"none",d:"M438.6 150.6c12.5-12.5 12.5-32.8 0-45.3l-96-96c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.7 96 32 96C14.3 96 0 110.3 0 128s14.3 32 32 32l306.7 0-41.4 41.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l96-96zm-333.3 352c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 416 416 416c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0 41.4-41.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3l96 96z"}));case"playlist-add":return r.createElement("svg",{className:t,viewBox:"0 0 24 24"},r.createElement("path",{stroke:"none",d:"M14 10H3v2h11v-2zm0-4H3v2h11V6zm4 8v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zM3 16h7v-2H3v2z"}));case"recently-added":return r.createElement("svg",{className:t,viewBox:"0 0 384 512"},r.createElement("path",{d:"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48z"}),r.createElement("rect",{x:"177",y:"220",width:"40",height:"210",strokeWidth:"20",strokeLinejoin:"round"}),r.createElement("rect",{x:"87",y:"310",width:"210",height:"40",strokeWidth:"20",strokeLinejoin:"round"}));case"playlist":return r.createElement("svg",{className:t,viewBox:"0 0 512 512"},r.createElement("path",{d:"M88 48C101.3 48 112 58.75 112 72V120C112 133.3 101.3 144 88 144H40C26.75 144 16 133.3 16 120V72C16 58.75 26.75 48 40 48H88zM480 64C497.7 64 512 78.33 512 96C512 113.7 497.7 128 480 128H192C174.3 128 160 113.7 160 96C160 78.33 174.3 64 192 64H480zM480 224C497.7 224 512 238.3 512 256C512 273.7 497.7 288 480 288H192C174.3 288 160 273.7 160 256C160 238.3 174.3 224 192 224H480zM480 384C497.7 384 512 398.3 512 416C512 433.7 497.7 448 480 448H192C174.3 448 160 433.7 160 416C160 398.3 174.3 384 192 384H480zM16 232C16 218.7 26.75 208 40 208H88C101.3 208 112 218.7 112 232V280C112 293.3 101.3 304 88 304H40C26.75 304 16 293.3 16 280V232zM88 368C101.3 368 112 378.7 112 392V440C112 453.3 101.3 464 88 464H40C26.75 464 16 453.3 16 440V392C16 378.7 26.75 368 40 368H88z"}));case"file":case"blob":return r.createElement("svg",{className:t,viewBox:"0 0 448 512",transform:"scale(0.875)"},r.createElement("path",{fill:"#00cccc",d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"}));case"apple":return r.createElement("svg",{className:t,viewBox:"0 0 73 73"},r.createElement("linearGradient",{id:"apple-linear-gradient",gradientUnits:"userSpaceOnUse",x1:"36",y1:"2.2858",x2:"36",y2:"72.455",gradientTransform:"matrix(1 0 0 -1 0 74.0068)"},r.createElement("stop",{offset:"0",style:{stopColor:"#FA233B"}}),r.createElement("stop",{offset:"1",style:{stopColor:"#FB5C74"}})),r.createElement("rect",{className:"icon-apple-inner",x:"10",y:"10",width:"53",height:"53"}),r.createElement("path",{className:"icon-apple-outer",fillRule:"evenodd",clipRule:"evenodd",stroke:"none",d:"M72,19.94c0-0.72-0.01-1.45-0.03-2.17c-0.04-1.58-0.14-3.17-0.42-4.73c-0.28-1.58-0.75-3.06-1.48-4.5\r\n\t\t\tc-0.72-1.41-1.66-2.71-2.78-3.83c-1.12-1.12-2.42-2.06-3.83-2.78c-1.44-0.73-2.91-1.2-4.49-1.48c-1.56-0.28-3.15-0.37-4.73-0.42\r\n\t\t\tC53.51,0.02,52.78,0.01,52.06,0c-0.86,0-1.72,0-2.58,0H22.52c-0.86,0-1.72,0-2.58,0c-0.72,0-1.45,0.01-2.17,0.03\r\n\t\t\tc-1.58,0.04-3.17,0.14-4.73,0.42C11.46,0.74,9.98,1.2,8.55,1.94C7.13,2.66,5.84,3.6,4.72,4.72S2.65,7.13,1.93,8.55\r\n\t\t\tc-0.73,1.44-1.2,2.91-1.48,4.5c-0.28,1.56-0.37,3.15-0.42,4.73C0.02,18.5,0.01,19.22,0,19.94c0,0.86,0,1.72,0,2.58v26.95\r\n\t\t\tc0,0.86,0,1.72,0,2.58c0,0.72,0.01,1.45,0.03,2.17c0.04,1.58,0.14,3.17,0.42,4.73c0.28,1.58,0.75,3.06,1.48,4.5\r\n\t\t\tc0.72,1.41,1.66,2.71,2.78,3.83s2.42,2.06,3.83,2.78c1.44,0.73,2.91,1.2,4.49,1.48c1.56,0.28,3.15,0.37,4.73,0.42\r\n\t\t\tc0.72,0.02,1.45,0.03,2.17,0.03c0.86,0.01,1.72,0,2.58,0h26.95c0.86,0,1.72,0,2.58,0c0.72,0,1.45-0.01,2.17-0.03\r\n\t\t\tc1.58-0.04,3.17-0.14,4.73-0.42c1.58-0.28,3.06-0.75,4.49-1.48c1.41-0.72,2.71-1.66,3.83-2.78c1.12-1.12,2.06-2.41,2.78-3.83\r\n\t\t\tc0.73-1.44,1.2-2.91,1.48-4.5c0.28-1.56,0.37-3.15,0.42-4.73c0.02-0.72,0.03-1.45,0.03-2.17c0.01-0.86,0-1.72,0-2.58V22.52\r\n\t\t\tC72,21.66,72,20.8,72,19.94z M52.71,46.85c0,0.91-0.01,1.74-0.2,2.65c-0.19,0.89-0.53,1.72-1.05,2.47\r\n\t\t\tc-0.52,0.75-1.19,1.36-1.97,1.82c-0.79,0.47-1.62,0.73-2.5,0.91c-1.66,0.33-2.79,0.41-3.86,0.2c-1.03-0.21-1.9-0.68-2.6-1.32\r\n\t\t\tc-1.03-0.95-1.68-2.23-1.82-3.56c-0.16-1.57,0.36-3.24,1.53-4.48c0.59-0.62,1.34-1.11,2.34-1.5c1.04-0.4,2.19-0.65,3.96-1\r\n\t\t\tc0.47-0.09,0.93-0.19,1.4-0.28c0.61-0.12,1.14-0.28,1.56-0.8c0.43-0.52,0.43-1.16,0.43-1.78V24.32c0-1.21-0.54-1.54-1.7-1.32\r\n\t\t\tc-0.83,0.16-18.62,3.75-18.62,3.75c-1,0.24-1.36,0.57-1.36,1.82v23.23c0,0.91-0.05,1.74-0.24,2.65c-0.19,0.89-0.53,1.72-1.05,2.47\r\n\t\t\tc-0.52,0.75-1.19,1.36-1.97,1.82c-0.79,0.47-1.62,0.74-2.5,0.92c-1.66,0.33-2.79,0.41-3.86,0.2c-1.03-0.21-1.9-0.69-2.6-1.33\r\n\t\t\tc-1.03-0.95-1.63-2.23-1.78-3.56c-0.16-1.57,0.31-3.24,1.49-4.48c0.59-0.62,1.34-1.11,2.34-1.5c1.04-0.4,2.19-0.65,3.96-1\r\n\t\t\tc0.47-0.09,0.93-0.19,1.4-0.28c0.61-0.12,1.14-0.28,1.56-0.8c0.42-0.52,0.47-1.13,0.47-1.75c0-4.92,0-26.78,0-26.78\r\n\t\t\tc0-0.36,0.03-0.6,0.05-0.72c0.09-0.56,0.31-1.05,0.72-1.39c0.34-0.28,0.78-0.48,1.33-0.6l0.01,0L49,11.33\r\n\t\t\tc0.19-0.04,1.73-0.31,1.91-0.33c1.16-0.1,1.81,0.66,1.81,1.89L52.71,46.85L52.71,46.85z"}));case"plex":return r.createElement("svg",{className:t,viewBox:"0 0 122.88 122.88"},r.createElement("path",{className:"icon-plex-outer",d:"M18.43,0h86.02c10.18,0,18.43,8.25,18.43,18.43v86.02c0,10.18-8.25,18.43-18.43,18.43H18.43 C8.25,122.88,0,114.63,0,104.45l0-86.02C0,8.25,8.25,0,18.43,0L18.43,0z"}),r.createElement("polygon",{className:"icon-plex-inner",points:"61.44,16.8 35.52,16.8 61.44,61.44 35.52,106.08 61.44,106.08 87.36,61.44 61.44,16.8"}));case"jellyfin":return r.createElement("svg",{className:t,viewBox:"0 0 512 512"},r.createElement("defs",null,r.createElement("linearGradient",{id:"jellyfin-linear-gradient",gradientUnits:"userSpaceOnUse",x1:"110.25",y1:"213.3",x2:"496.14",y2:"436.09"},r.createElement("stop",{offset:"0",style:{stopColor:"#aa5cc3"}}),r.createElement("stop",{offset:"1",style:{stopColor:"#00a4dc"}}))),r.createElement("path",{d:"M256,201.6c-20.4,0-86.2,119.3-76.2,139.4s142.5,19.9,152.4,0S276.5,201.6,256,201.6z"}),r.createElement("path",{d:"M256,23.3c-61.6,0-259.8,359.4-229.6,420.1s429.3,60,459.2,0S317.6,23.3,256,23.3z M406.5,390.8c-19.6,39.3-281.1,39.8-300.9,0s110.1-275.3,150.4-275.3S426.1,351.4,406.5,390.8z"}));case"spotify":return r.createElement("svg",{className:t,viewBox:"0 0 168 168"},r.createElement("path",{stroke:"none",d:"m83.996 0.277c-46.249 0-83.743 37.493-83.743 83.742 0 46.251 37.494 83.741 83.743 83.741 46.254 0 83.744-37.49 83.744-83.741 0-46.246-37.49-83.738-83.745-83.738l0.001-0.004zm38.404 120.78c-1.5 2.46-4.72 3.24-7.18 1.73-19.662-12.01-44.414-14.73-73.564-8.07-2.809 0.64-5.609-1.12-6.249-3.93-0.643-2.81 1.11-5.61 3.926-6.25 31.9-7.291 59.263-4.15 81.337 9.34 2.46 1.51 3.24 4.72 1.73 7.18zm10.25-22.805c-1.89 3.075-5.91 4.045-8.98 2.155-22.51-13.839-56.823-17.846-83.448-9.764-3.453 1.043-7.1-0.903-8.148-4.35-1.04-3.453 0.907-7.093 4.354-8.143 30.413-9.228 68.222-4.758 94.072 11.127 3.07 1.89 4.04 5.91 2.15 8.976v-0.001zm0.88-23.744c-26.99-16.031-71.52-17.505-97.289-9.684-4.138 1.255-8.514-1.081-9.768-5.219-1.254-4.14 1.08-8.513 5.221-9.771 29.581-8.98 78.756-7.245 109.83 11.202 3.73 2.209 4.95 7.016 2.74 10.733-2.2 3.722-7.02 4.949-10.73 2.739z"}));case"lastfm":return r.createElement("svg",{className:t,viewBox:"0 0 455 455"},r.createElement("rect",{className:"icon-lastfm-inner",x:"5",y:"5",width:"445",height:"445"}),r.createElement("path",{className:"icon-lastfm-outer",fillRule:"evenodd",clipRule:"evenodd",d:"M0,0v455h455V0H0z M309.94,315.01c-62.425,0-84.085-28.145-95.625-63.145 L202.77,215.77c-8.65-26.33-18.75-46.915-50.505-46.915c-22.035,0-44.395,15.88-44.395,60.275c0,34.63,17.695,56.29,42.575,56.29 c28.145,0,46.915-20.94,46.915-20.94l11.565,31.385c0,0-19.495,19.125-60.275,19.125c-50.51,0-78.65-29.57-78.65-84.435 c0-56.99,28.14-90.565,81.19-90.565c47.99,0,72.165,17.325,87.305,64.235L250.41,240.3c8.65,26.35,23.805,45.47,60.25,45.47 c24.555,0,37.52-5.41,37.52-18.77c0-10.45-6.13-18.025-24.53-22.365l-24.53-5.76c-29.94-7.225-41.855-22.735-41.855-47.265 c0-39.335,31.755-51.6,64.215-51.6c36.82,0,59.18,13.34,62.07,45.82l-36.07,4.335c-1.445-15.53-10.82-22.015-28.145-22.015 c-15.88,0-25.625,7.21-25.625,19.475c0,10.84,4.685,17.325,20.565,20.94l23.085,5.055c31.035,7.21,47.64,22.365,47.64,51.585 C385,301.295,354.685,315.01,309.94,315.01z"}));case"listenbrainz":case"musicbrainz":return r.createElement("svg",{className:t,viewBox:"0 0 27 30"},r.createElement("polygon",{className:`icon-${e}-left`,stroke:"none",points:"13 1 1 8 1 22 13 29 13 1"}),r.createElement("polygon",{className:`icon-${e}-right`,stroke:"none",points:"14 1 26 8 26 22 14 29 14 1"}));case"youtube":return r.createElement("svg",{className:t,viewBox:"0 0 576 512",transform:"scale(1.125)"},r.createElement("rect",{className:"icon-youtube-inner",x:"144",y:"128",width:"288",height:"256"}),r.createElement("path",{className:"icon-youtube-outer",d:"M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"}));case"lookup-pending":return r.createElement("svg",{className:`${t} icon-lookup`,viewBox:"0 0 16 16"},r.createElement("title",null,"Lookup scheduled"),r.createElement("circle",{className:"icon-lookup-outer",cx:"8",cy:"8",r:"8",stroke:"none"}),r.createElement("path",{className:"icon-lookup-inner",d:"M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"}));case"lookup-looking":return r.createElement("svg",{className:`${t} icon-lookup`,viewBox:"0 0 100 100"},r.createElement("title",null,"Searching..."),r.createElement("circle",{className:"icon-lookup-outer",cx:"50",cy:"50",r:"50",stroke:"none"}),r.createElement("path",{className:"icon-lookup-inner",d:"M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50"},r.createElement("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",dur:"1s",from:"0 50 50",to:"360 50 50",repeatCount:"indefinite"})));case"lookup-not-found":return r.createElement("svg",{className:`${t} icon-lookup`,viewBox:"0 0 16 16",transform:"rotate(45)"},r.createElement("title",null,"Not found"),r.createElement("circle",{className:"icon-lookup-outer",cx:"8",cy:"8",r:"8",stroke:"none"}),r.createElement("path",{className:"icon-lookup-inner",d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"}))}}var ki=n(908);const Si={left:0,top:0},Ci=(0,r.forwardRef)((function(e,t){var{title:n,className:i="",children:a,onClose:o}=e,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["title","className","children","onClose"]);const l=(0,r.useRef)(null),[c,u]=(0,r.useState)(Si),[d,m]=(0,r.useState)(null),[h,f]=(0,r.useState)(Si);(0,r.useImperativeHandle)(t,(()=>({close:e=>{l.current.open&&l.current.close(e)}}))),(0,r.useEffect)((()=>{const e=l.current;ki.Z.registerDialog(e),e.showModal()}),[]);const p=(0,r.useCallback)((()=>{l.current.close()}),[]),v=(0,r.useCallback)((()=>{o(l.current.returnValue)}),[o]),b=(0,r.useCallback)((e=>{let t=e.target;for(;t&&"BUTTON"!==t.nodeName;)t=t.parentElement;"#cancel"===(null==t?void 0:t.value)&&(e.preventDefault(),l.current.close())}),[]),g=(0,r.useCallback)((e=>{e.preventDefault(),0===e.button&&m({left:e.screenX,top:e.screenY})}),[]),w=(0,r.useCallback)((e=>{f({left:e.screenX-d.left,top:e.screenY-d.top})}),[d]),E=(0,r.useCallback)((e=>{u({left:c.left+(e.screenX-d.left),top:c.top+(e.screenY-d.top)}),f(Si),m(null)}),[c,d]);return(0,r.useEffect)((()=>{if(d)return document.documentElement.style.cursor="default",document.body.classList.add("dragging"),document.addEventListener("mouseup",E),document.addEventListener("mousemove",w),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",E),document.removeEventListener("mousemove",w)}}),[d,w,E]),r.createElement("dialog",Object.assign({},s,{className:`dialog ${i}`,onClose:v,style:{transform:`translate(${c.left+h.left}px, ${c.top+h.top}px)`},ref:l}),r.createElement("header",{className:"dialog-head",onMouseDown:g},r.createElement("h2",null,n),r.createElement("div",{className:"dialog-close",role:"button",onClick:p,onMouseDown:y,"aria-label":"Close"},r.createElement(xi,{name:"close"}))),r.createElement("div",{className:"dialog-body",onClick:b},a))}));var Ti=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function Pi(e,t=!1){return Ti(this,void 0,void 0,(function*(){return new Promise(((n,a)=>{const o=document.createElement("div"),s=(0,i.s)(o);try{const i=e=>{s.unmount(),o.remove(),n(e)};document.getElementById(t?"system":"popup").append(o),s.render(r.createElement(e,{onClose:i}))}catch(e){s.unmount(),o.remove(),a(e)}}))}))}var Ai=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Ii({title:e,message:t,system:n=!1}){return i=this,a=void 0,s=function*(){"string"==typeof t&&(t=r.createElement("p",null,t)),yield Pi((n=>r.createElement(Oi,Object.assign({},n,{title:e,message:t}))),n)},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{l(s.next(e))}catch(e){t(e)}}function r(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof o?e:new o((function(t){t(e)}))}(t.value).then(n,r)}l((s=s.apply(i,a||[])).next())}));var i,a,o,s}function Oi(e){var{message:t,title:n="Message"}=e,i=Ai(e,["message","title"]);return r.createElement(Ci,Object.assign({},i,{className:"alert-dialog",title:n}),r.createElement("form",{method:"dialog"},r.createElement("div",{className:"alert-message"},t),r.createElement("footer",{className:"dialog-buttons"},r.createElement("button",null,"OK"))))}function Mi({value:e="",submitText:t="Confirm",onCancel:n,onSubmit:i}){return r.createElement("footer",{className:"dialog-buttons"},r.createElement("button",{type:"button",value:"#cancel",onClick:n},"Cancel"),r.createElement("button",{value:e,onClick:i},t))}var Ni=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))},$i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const zi=new z("confirm");function ji({title:e,message:t,okLabel:n,storageId:i,system:a=!1}){return Ni(this,void 0,void 0,(function*(){return!(!i||!zi.getBoolean(i))||("string"==typeof t&&(t=r.createElement("p",null,t)),"confirmed"===(yield Pi((a=>r.createElement(Li,Object.assign({},a,{title:e,message:t,okLabel:n,storageId:i}))),a)))}))}function Li(e){var{title:t="Confirm",message:n,okLabel:i="OK",storageId:a}=e,o=$i(e,["title","message","okLabel","storageId"]);const s=(0,r.useId)(),l=(0,r.useRef)(null),c=(0,r.useCallback)((()=>{a&&l.current.checked&&zi.setBoolean(a,!0)}),[a]);return r.createElement(Ci,Object.assign({},o,{className:"confirm-dialog",title:t}),r.createElement("form",{method:"dialog",onSubmit:c},r.createElement("div",{className:"confirm-message"},n),r.createElement(Mi,{value:"confirmed",submitText:i}),a?r.createElement("footer",{className:"confirm-dialog-storage"},r.createElement("input",{id:s,type:"checkbox",ref:l}),r.createElement("label",{htmlFor:s},"Don't show this message again.")):null))}var Ri=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Di(e){var t,n,i,a,{system:o=!1}=e,s=Ri(e,["system"]);return t=this,n=void 0,a=function*(){return Pi((e=>r.createElement(_i,Object.assign({},e,s))),o)},new((i=void 0)||(i=Promise))((function(e,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(t.value).then(o,s)}l((a=a.apply(t,n||[])).next())}))}function _i(e){var{title:t="Input",label:n,suggestedValue:i="",okLabel:a="OK"}=e,o=Ri(e,["title","label","suggestedValue","okLabel"]);const s=(0,r.useId)(),[l,c]=(0,r.useState)(i),u=(0,r.useCallback)((e=>{c(e.target.value)}),[]);return r.createElement(Ci,Object.assign({},o,{className:"prompt-dialog",title:t}),r.createElement("form",{method:"dialog"},n?r.createElement("p",{className:"prompt-message"},r.createElement("label",{htmlFor:s},n,": ")):null,r.createElement("p",null,r.createElement("input",{type:"text",id:s,defaultValue:i,autoFocus:!0,spellCheck:!1,autoComplete:"off",autoCapitalize:"off",onChange:u})),r.createElement(Mi,{value:l,submitText:a})))}var Fi=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function Vi(e){const t=(0,r.useId)(),n=(0,r.useRef)(null),i=(0,r.useRef)(null),a=(0,r.useRef)(null),o=(0,r.useRef)(null),s=(0,r.useCallback)((()=>Fi(this,void 0,void 0,(function*(){try{const e=a.current.value,t=o.current.value;bi.host=i.current.value.replace(/\/+$/,"");const{device:r,deviceId:s}=bi,l=`MediaBrowser Client="ampcast", Version="0.8.15", Device="${r}", DeviceId="${s}"`,c=yield fetch(`${bi.host}/Users/AuthenticateByName`,{method:"POST",headers:{"Content-Type":"application/json","X-Emby-Authorization":l},body:JSON.stringify({Username:e,Pw:t})});if(!c.ok)throw Error(`${c.status}: ${c.statusText}`);const u=yield c.json(),d=u.ServerId,m=u.User.Id,h=u.AccessToken;n.current.close(JSON.stringify({serverId:d,userId:m,token:h}))}catch(e){console.error(e)}}))),[]),l=(0,r.useCallback)((e=>{e.preventDefault(),s()}),[s]);return r.createElement(Ci,Object.assign({},e,{className:"jellyfin-login-dialog",title:"Log in to Jellyfin",ref:n}),r.createElement("form",{method:"dialog",onSubmit:l},r.createElement("div",{className:"table-layout"},r.createElement("p",null,r.createElement("label",{htmlFor:`${t}-host`},"Host:"),r.createElement("input",{type:"url",id:`${t}-host`,defaultValue:bi.host,placeholder:"https://",ref:i,required:!0})),r.createElement("p",null,r.createElement("label",{htmlFor:`${t}-username`},"User:"),r.createElement("input",{type:"text",id:`${t}-username`,autoFocus:!0,spellCheck:!1,autoComplete:"off",autoCapitalize:"off",ref:a,required:!0})),r.createElement("p",null,r.createElement("label",{htmlFor:`${t}-password`},"Password:"),r.createElement("input",{type:"password",id:`${t}-password`,ref:o,required:!0}))),r.createElement(Mi,{submitText:"Login"})))}var Ui=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::jellyfinAuth");const Bi=new A("jellyfinAuth"),Hi=new Ie("");function Yi(){return""!==Hi.getValue()}function Ki(){return Hi.pipe(tr()).pipe(Gt((e=>""!==e)),tr())}function Wi(e){bi.token=e,e&&Bi.log("Access token successfully obtained."),Hi.next(e)}Wi(bi.token);var qi;!function(e){e[e.Pending=0]="Pending",e[e.Fulfilled=1]="Fulfilled",e[e.Rejected=2]="Rejected"}(qi||(qi={}));const Ji=new A("OffsetPager");class Qi extends Ur{constructor(e,t){super(t),this.fetch=e,this.fetchStates={},this.size=0}connect(){this.subscriptions||(super.connect(),this.subscriptions.add(this.fetches$.pipe(ze((({index:e,length:t})=>t>0&&this.isInRange(e))),Gt((({index:e,length:t})=>this.getPageNumbersFromIndex(e,t))),Zt((e=>e)),Zt((e=>this.fetchPage(e))),cr((e=>(Ji.error(e),this.error$.next(e),Pn(void 0)))),wn(this.observeComplete())).subscribe(Ji)))}get pageSize(){return this.config.pageSize||20}fetchPage(e){return t=this,n=void 0,i=function*(){if(this.fetchStates[e]!==qi.Fulfilled&&this.fetchStates[e]!==qi.Pending){this.fetchStates[e]=qi.Pending;try{const t=yield this.fetch(e,this.pageSize);this.fetchStates[e]=qi.Fulfilled,this.insertPage(e,t)}catch(t){throw this.fetchStates[e]=qi.Rejected,t}}},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(t.value).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}insertPage(e,t){var n;const r=this.items.slice(),i=Math.min(t.total,null!==(n=this.maxSize)&&void 0!==n?n:1/0),a=Math.ceil(i/this.pageSize),o=(e-1)*this.pageSize,s=e===a;if(r.length=s||t.items.length<this.pageSize?o:i,t.items.forEach(((e,t)=>r[t+o]=e)),r.length=Math.min(r.length,i),t.items.length===i)for(let e=0;e<=a;e++)this.fetchStates[e+1]=qi.Fulfilled;this.size=i,this.size$.next(i),this.items$.next(r)}getPageNumbersFromIndex(e,t){const n=this.size,r=Math.max(Math.ceil(this.pageSize/2),t),i=Math.max(e-r,0),a=Math.min(e+r+t-1,0===n?this.maxSize?this.maxSize-1:1/0:n-1),o=this.getPageNumberFromIndex(i),s=this.getPageNumberFromIndex(a);if(o===s)return[o];{const e=[];for(let t=o;t<=s;t++)e.push(t);return e}}getPageNumberFromIndex(e){return Math.floor(e/this.pageSize)+1}isInRange(e){return 0===this.size?e>=0:e>=0&&e<this.size}}class Gi{constructor(e,t={},n,r){this.path=e,this.params=t,this.parent=r,this.pageSize=(null==n?void 0:n.pageSize)||100,this.pager=new Qi((e=>this.fetch(e)),Object.assign({pageSize:this.pageSize},n))}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems().pipe(Gt((e=>{var t;return(null===(t=this.parent)||void 0===t?void 0:t.itemType)===Kn.Folder?e.sort(((e,t)=>e.itemType===t.itemType?e.itemType===Kn.Folder?e.fileName.localeCompare(t.fileName):0:e.itemType===Kn.Folder?-1:1)):e})))}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}fetch(e){return t=this,n=void 0,i=function*(){const t=Object.assign(Object.assign({IncludeItemTypes:"Audio",Fields:"AudioInfo,Genres,Path",EnableUserData:!0,Recursive:!0,ImageTypeLimit:1,EnableImageTypes:"Primary"},this.params),{Limit:String(this.pageSize),StartIndex:String((e-1)*this.pageSize)}),n=yield Ei.get(this.path,t);if(!n.ok)throw n;const r=yield n.json();return r.Type?{items:[this.createItem(r)],total:1}:{items:r.Items.map((e=>this.createItem(e))),total:r.TotalRecordCount}},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(t.value).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}createItem(e){var t;if((null===(t=this.parent)||void 0===t?void 0:t.itemType)===Kn.Folder&&e.IsFolder)return this.createMediaFolder(e);{let t;switch(e.Type){case"MusicArtist":t=this.createMediaArtist(e);break;case"MusicAlbum":t=this.createMediaAlbum(e);break;case"Playlist":t=this.createMediaPlaylist(e);break;default:t=this.createMediaItemFromTrack(e)}return ua.canRate(t)&&(t.rating=this.getRating(t,e)),t}}createMediaArtist(e){var t;return{itemType:Kn.Artist,src:`jellyfin:album:${e.Id}`,externalUrl:this.getExternalUrl(e),title:e.Name||"",playCount:(null===(t=e.UserData)||void 0===t?void 0:t.PlayCount)||void 0,genres:e.Genres||void 0,thumbnails:this.createThumbnails(e.Id),pager:this.createAlbumsPager(e)}}createMediaAlbum(e){var t,n;return{itemType:Kn.Album,src:`jellyfin:album:${e.Id}`,externalUrl:this.getExternalUrl(e),title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,playedAt:(null===(t=e.UserData)||void 0===t?void 0:t.LastPlayedDate)?Math.floor(new Date(e.UserData.LastPlayedDate).getTime()/1e3):void 0,playCount:(null===(n=e.UserData)||void 0===n?void 0:n.PlayCount)||void 0,genres:e.Genres||void 0,thumbnails:this.createThumbnails(e.Id),trackCount:e.ChildCount||void 0,pager:this.createAlbumPager(e),artist:e.AlbumArtist||void 0,year:e.ProductionYear||void 0}}createMediaPlaylist(e){var t,n;const r=`jellyfin:playlist:${e.Id}`;return{src:r,itemType:Kn.Playlist,externalUrl:this.getExternalUrl(e),title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,playedAt:(null===(t=e.UserData)||void 0===t?void 0:t.LastPlayedDate)?Math.floor(new Date(e.UserData.LastPlayedDate).getTime()/1e3):void 0,playCount:(null===(n=e.UserData)||void 0===n?void 0:n.PlayCount)||void 0,genres:e.Genres||void 0,thumbnails:this.createThumbnails(e.Id),trackCount:e.ChildCount||void 0,pager:this.createPlaylistPager(e),isPinned:Qr.isPinned(r)}}createMediaFolder(e){var t;const n=this.getFileName(e.Path||"")||e.Name||"[unknown]",r={itemType:Kn.Folder,src:`jellyfin:folder:${e.Id}`,title:e.Name||"[unknown]",fileName:n,path:(null===(t=this.parent)||void 0===t?void 0:t.itemType)===Kn.Folder?`${this.parent.path}/${n}`:"/",parent:this.parent};return r.pager=this.createFolderPager(r),r}createMediaItemFromTrack(e){var t,n,r;const i=(null===(t=e.ImageTags)||void 0===t?void 0:t.Primary)?e.Id:e.AlbumId;return{itemType:Kn.Media,mediaType:jr.Audio,src:`jellyfin:audio:${e.Id}`,externalUrl:this.getExternalUrl(e),fileName:this.getFileName(e.Path||"")||e.Name||"[unknown]",title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,year:e.ProductionYear||void 0,playedAt:(null===(n=e.UserData)||void 0===n?void 0:n.LastPlayedDate)?Math.floor(new Date(e.UserData.LastPlayedDate).getTime()/1e3):0,playCount:(null===(r=e.UserData)||void 0===r?void 0:r.PlayCount)||void 0,genres:e.Genres||void 0,thumbnails:this.createThumbnails(i),artists:e.Artists||(e.AlbumArtist?[e.AlbumArtist]:void 0),albumArtist:e.AlbumArtist||void 0,album:e.Album||void 0,disc:e.Album&&e.ParentIndexNumber||void 0,track:e.Album&&e.IndexNumber||0}}createThumbnails(e){return e?[this.createThumbnail(e,120),this.createThumbnail(e,240),this.createThumbnail(e,360),this.createThumbnail(e,480)]:void 0}createThumbnail(e,t,n=t){return{url:`${bi.host}/Items/${e}/Images/Primary?fillWidth=${t}&fillHeight=${n}`,width:t,height:n}}createAlbumPager(e){return new Gi(`Users/${bi.userId}/Items`,{ParentId:e.Id,SortBy:"SortName",SortOrder:"Ascending"})}createAlbumsPager(e){return new Gi(`Users/${bi.userId}/Items`,{AlbumArtistIds:e.Id,IncludeItemTypes:"MusicAlbum",SortOrder:"Descending"})}createPlaylistPager(e){return new Gi(`Playlists/${e.Id}/Items`,{UserId:bi.userId,MediaType:"Audio",Fields:"ChildCount"})}createFolderPager(e){var t;const[,,n]=e.src.split(":"),r=new Gi(`Users/${bi.userId}/Items`,{ParentId:n,IncludeItemTypes:"Folder,MusicAlbum,MusicArtist,Audio",Fields:"AudioInfo,Genres,UserData,ParentId,Path",EnableUserData:!0,Recursive:!1,SortBy:"SortName",SortOrder:"Ascending"},{pageSize:Gi.maxPageSize},e);if((null===(t=this.parent)||void 0===t?void 0:t.itemType)===Kn.Folder){const e=Object.assign(Object.assign({},this.parent),{fileName:`../${this.parent.fileName}`}),t=new pr([e]);return new Rr(t,r)}return r}getExternalUrl(e){return`${bi.host}/web/index.html#!/details?id=${e.Id}&serverId=${bi.serverId}`}getFileName(e){return e.split(/[/\\]/).pop()}getRating(e,t){const n=t.UserData;return mr.get(e,n?n.IsFavorite?1:0:void 0)}}Gi.minPageSize=10,Gi.maxPageSize=1e3;const Xi=Gi;var Zi=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::jellyfin");const ea="jellyfin",ta={view:"details",fields:["Index","Artist","Title","Album","Track","Duration","PlayCount"]},na={id:"jellyfin/liked-songs",title:"My Songs",icon:"heart",itemType:Kn.Media,viewType:qn.Ratings,layout:{view:"details",fields:["Artist","Title","Album","Track","Duration","Genre","PlayCount"]},search:()=>fa({Filters:"IsFavorite",SortBy:"AlbumArtist,Album,SortName"})},ra={id:"jellyfin/liked-albums",title:"My Albums",icon:"heart",itemType:Kn.Album,viewType:qn.Ratings,search:()=>fa({Filters:"IsFavorite",IncludeItemTypes:"MusicAlbum",SortBy:"AlbumArtist,SortName"})},ia={id:"jellyfin/liked-artists",title:"My Artists",icon:"heart",itemType:Kn.Artist,viewType:qn.Ratings,defaultHidden:!0,search:()=>new Xi("Artists/AlbumArtists",{isFavorite:!0,UserId:bi.userId})},aa={id:"jellyfin/recently-played",title:"Recently Played",icon:"clock",itemType:Kn.Media,viewType:qn.RecentlyPlayed,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search:()=>fa({SortBy:"DatePlayed",SortOrder:"Descending",Filters:"IsPlayed"})},oa={id:"jellyfin/most-played",title:"Most Played",icon:"most-played",itemType:Kn.Media,viewType:qn.MostPlayed,layout:{view:"details",fields:["PlayCount","Artist","Title","Album","Track","Duration","Genre"]},search:()=>fa({SortBy:"PlayCount,DatePlayed",SortOrder:"Descending",Filters:"IsPlayed"})},sa={id:"jellyfin/playlists",title:"Playlists",icon:"playlist",itemType:Kn.Playlist,secondaryLayout:ta,search:()=>fa({SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"Playlist"})},la={id:"jellyfin/folders",title:"Folders",icon:"folder",itemType:Kn.Folder,defaultHidden:!0,search(){const e={itemType:Kn.Folder,src:"",title:"Folders",fileName:"",path:""};return e.pager=new Xi("Library/MediaFolders",{IncludeItemTypes:"Folder,MusicAlbum,MusicArtist,Audio",Fields:"AudioInfo,Genres,UserData,ParentId,Path",Recursive:!1,SortBy:"SortName",SortOrder:"Ascending"},{pageSize:Xi.maxPageSize},e),e.pager}},ca={id:ea,icon:ea,name:"Jellyfin",url:"https://jellyfin.org",roots:[ma(Kn.Media,{title:"Songs"}),ma(Kn.Album,{title:"Albums"}),ma(Kn.Artist,{title:"Artists"}),ma(Kn.Playlist,{title:"Playlists",secondaryLayout:ta})],sources:[na,ra,ia,oa,aa,sa,la],labels:{[Hn.Like]:"Add to Jellyfin Favorites",[Hn.Unlike]:"Remove from Jellyfin Favorites"},canRate:da,canStore:()=>!1,compareForRating:function(e,t){return e.src===t.src},createSourceFromPin:function(e){return{title:e.title,itemType:Kn.Playlist,id:e.src,icon:"pin",isPin:!0,search(){const[,,t]=e.src.split(":");return fa({ids:t,IncludeItemTypes:"Playlist"})}}},getMetadata:function(e){return Zi(this,void 0,void 0,(function*(){if(!da(e)||void 0!==e.rating)return e;const t=mr.get(e);if(void 0!==t)return Object.assign(Object.assign({},e),{rating:t});const[,,n]=e.src.split(":"),r=new Xi(`Users/${bi.userId}/Items/${n}`,void 0,{pageSize:1,maxSize:1}),i=yield fr(r,{timeout:2e3});return x(e,i[0])}))},lookup:function(e,t,n=10,r){return Zi(this,void 0,void 0,(function*(){if(!e||!t)return[];const i={pageSize:n,maxSize:n,lookup:!0};return fr(ha(Kn.Media,t,{Artists:e},i),{timeout:r})}))},rate:function(e,t){return Zi(this,void 0,void 0,(function*(){const[,,n]=e.src.split(":"),r=`Users/${bi.userId}/FavoriteItems/${n}`;t?Ei.post(r):Ei.delete(r)}))},observeIsLoggedIn:Ki,isLoggedIn:Yi,login:function(){return Ui(this,void 0,void 0,(function*(){if(!Yi())try{const e=yield function(){return Fi(this,void 0,void 0,(function*(){return Pi(Vi,!0)}))}();if(e){const{serverId:t,userId:n,token:r}=JSON.parse(e);bi.serverId=t,bi.userId=n,Wi(r)}}catch(e){Bi.log("Could not obtain access token."),Bi.error(e)}}))},logout:function(){return Ui(this,void 0,void 0,(function*(){Wi(""),bi.clear()}))}},ua=ca;function da(e){switch(e.itemType){case Kn.Album:return!e.synthetic;case Kn.Folder:return!1;default:return!0}}function ma(e,t){return Object.assign(Object.assign({},t),{itemType:e,id:`jellyfin/search/${t.title.toLowerCase()}`,icon:"search",searchable:!0,search:({q:t=""}={})=>ha(e,t)})}function ha(e,t,n,r){if(t){const i=Object.assign(Object.assign({},n),{SearchTerm:t});if(e===Kn.Artist)return new Xi("Artists/AlbumArtists",Object.assign(Object.assign({},i),{UserId:bi.userId}),r);switch(e){case Kn.Media:i.IncludeItemTypes="Audio";break;case Kn.Album:i.IncludeItemTypes="MusicAlbum";break;case Kn.Playlist:i.IncludeItemTypes="Playlist"}return fa(i,r)}return new pr}function fa(e,t){return new Xi(`Users/${bi.userId}/Items`,e,t)}mr.addObserver(ca);var pa=n(2568),va=n.n(pa);const ba=new z("lastfm"),ga={get token(){return ba.getString("token")},set token(e){ba.setString("token",e)},get userId(){return ba.getString("userId")},set userId(e){ba.setString("userId",e)},get sessionKey(){return ba.getString("sessionKey")},set sessionKey(e){ba.setString("sessionKey",e)},get firstScrobbledAt(){return ba.getString("firstScrobbledAt")},set firstScrobbledAt(e){ba.setString("firstScrobbledAt",e)},get playCount(){return ba.getNumber("playCount")},set playCount(e){ba.setNumber("playCount",e)},get removeDuplicates(){return ba.getBoolean("removeDuplicates")},set removeDuplicates(e){ba.setBoolean("removeDuplicates",e)},clear(){ba.clear()}};var ya=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::lastfmAuth");const wa=new A("lastfmAuth"),Ea=new Ie(""),xa=new Ie("");function ka(){return""!==Ea.getValue()}function Sa(){return Ea.pipe(tr()).pipe(Gt((e=>""!==e)),tr())}function Ca(e){const t=Object.keys(e);let n="";return t.sort(),t.forEach((t=>n+=t+e[t])),n+=gr,va()(n)}xa.next(ga.sessionKey),Ea.next(ga.token);var Ta=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::lastfmApi");const Pa=new A("lastfmApi"),Aa=new class{constructor(){this.host="https://ws.audioscrobbler.com/2.0",this.placeholderImage="2a96cbd8b46e442fc41c2b86b821562f.png"}scrobble(e){return Ta(this,void 0,void 0,(function*(){Pa.log("scrobble",{items:e});const t="track.scrobble";if(1===e.length){const n=e[0],r=String(n.playedAt);yield this.post(Object.assign({method:t,timestamp:r},this.getScrobbleParams(n)))}else if(e.length>0){const n={};e.forEach(((e,t)=>{const r=this.getScrobbleParams(e);n[`timestamp[${t}]`]=String(e.playedAt),Object.keys(r).forEach((e=>{n[`${e}[${t}]`]=r[e]}))})),yield this.post(Object.assign({method:t},n))}}))}updateNowPlaying(e){return Ta(this,void 0,void 0,(function*(){Pa.log("updateNowPlaying",{item:e});try{this.canScrobble(e)&&(yield this.post(Object.assign({method:"track.updateNowPlaying"},this.getScrobbleParams(e))))}catch(t){Pa.log('Failed to update "now playing":',{item:e}),Pa.error(t)}}))}getUserInfo(){return Ta(this,void 0,void 0,(function*(){return this.get({method:"user.getInfo",user:ga.userId})}))}createThumbnails(e){const t=e?[this.createThumbnail(e[0],34),this.createThumbnail(e[1],64),this.createThumbnail(e[2],174),this.createThumbnail(e[3],300)].filter(l):[];return 0===t.length?void 0:t}get(e){return Ta(this,void 0,void 0,(function*(){const t=`${this.host}?${new URLSearchParams(Object.assign(Object.assign({},e),{api_key:br,format:"json"}))}`,n=yield fetch(t,{method:"GET"});if(!n.ok)throw n;return n.json()}))}post(e){return Ta(this,void 0,void 0,(function*(){const t=ga.token,n=ga.sessionKey,r=Ca(e=Object.assign(Object.assign({},e),{api_key:br,token:t,sk:n})),i=`${new URLSearchParams(e)}&api_sig=${r}`,a=yield fetch(this.host,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i});if(!a.ok)throw a;return a}))}getScrobbleParams(e){const t={};return t.track=e.title,t.artist=e.artists[0],e.album&&"[Unknown Album]"!==e.album&&(t.album=e.album,e.albumArtist&&(t.albumArtist=e.albumArtist)),e.duration&&(t.duration=String(Math.round(e.duration))),e.track&&(t.trackNumber=String(e.track)),e.recording_mbid&&(t.mbid=e.recording_mbid),t}canScrobble(e){var t;return!!e&&!!e.title&&!!(null===(t=e.artists)||void 0===t?void 0:t[0])&&e.duration>30}createThumbnail(e,t,n=t){if(e){const r=e["#text"];if(r&&!r.endsWith(this.placeholderImage))return{url:r,width:t,height:n}}}};class Ia{constructor(e,t,n,r){this.album=r,this.defaultConfig={minPageSize:Ia.minPageSize,maxPageSize:Ia.maxPageSize,pageSize:50},this.pageNumber=1,this.playCountName="playcount";const i=Object.assign(Object.assign({},this.defaultConfig),n),{page:a}=e,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["page"]);this.pageNumber=Number(a)||1,this.method=e.method,this.playCountName=i.playCountName||"playcount",this.pager=new Hr(((e=this.defaultConfig.pageSize)=>{return n=this,r=void 0,a=function*(){const n=this.pageNumber,r=yield Aa.get(Object.assign(Object.assign({},o),{page:n,limit:e}));this.pageNumber++;const{items:i,total:a,atEnd:s,itemType:l}=t(r);return{items:this.createMediaObjects(l,i),total:a,atEnd:s}},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(t.value).then(o,s)}l((a=a.apply(n,r||[])).next())}));var n,r,i,a}),i)}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createMediaObjects(e,t){switch(e){case Kn.Artist:return t.map((e=>this.createMediaArtist(e)));case Kn.Album:return t.map((e=>this.createMediaAlbum(e)));case Kn.Media:return t.map((e=>this.createMediaItem(e)));default:return[]}}createMediaItem(e){var t,n,r,i,a,o;const s=e.date&&Number(e.date.uts)||0,l=null===(t=e["@attr"])||void 0===t?void 0:t.rank;return Object.assign(Object.assign({},this.createMediaObject(Kn.Media,e)),{mediaType:jr.Audio,src:s?`lastfm:listen:${s}`:`lastfm:track:${pi()}`,artists:e.artist?[e.artist.name]:void 0,album:(null===(n=this.album)||void 0===n?void 0:n.name)||(null===(r=e.album)||void 0===r?void 0:r["#text"]),albumArtist:null===(i=this.album)||void 0===i?void 0:i.artist.name,release_mbid:(null===(a=this.album)||void 0===a?void 0:a.mbid)||(null===(o=e.album)||void 0===o?void 0:o.mbid),duration:Number(e.duration)||0,track:l&&Number(l)||void 0,rating:"loved"in e?Number(e.loved)||0:"user.getLovedTracks"===this.method?1:void 0,playedAt:s})}createMediaAlbum(e){var t;return Object.assign(Object.assign({},this.createMediaObject(Kn.Album,e)),{src:`lastfm:album:${pi()}`,artist:e.artist.name,year:(null===(t=e.wiki)||void 0===t?void 0:t.published)&&new Date(e.wiki.published).getFullYear()||void 0,pager:this.createAlbumPager(e)})}createMediaArtist(e){return Object.assign(Object.assign({},this.createMediaObject(Kn.Artist,e)),{src:`lastfm:artist:${pi()}`,pager:this.createArtistAlbumsPager(e)})}createArtistTopTracks(e){return{itemType:Kn.Album,title:"Top Tracks",thumbnails:Aa.createThumbnails(e.image),src:`lastfm:top-tracks:${pi()}`,artist:e.name,pager:this.createTopTracksPager(e),synthetic:!0}}createMediaObject(e,t){return{itemType:e,title:t.name,playCount:Number(t[this.playCountName])||void 0,globalPlayCount:"userplaycount"===this.playCountName&&Number(t.playcount)||void 0,thumbnails:Aa.createThumbnails(t.image),externalUrl:t.url||void 0}}createArtistAlbumsPager(e){const t=this.createArtistTopTracks(e),n=new Yr((()=>[t])),r=new Ia({method:"artist.getTopAlbums",artist:e.name},(({topalbums:e})=>{const t=e["@attr"];return{items:e.album,total:Number(t.total)||void 0,atEnd:t.page===t.totalPages,itemType:Kn.Album}}),{maxSize:100,playCountName:"userplaycount"});return n.fetchAt(0),new Rr(n,r)}createAlbumPager(e){return new Ia({method:"album.getInfo",album:e.name,artist:e.artist.name,user:ga.userId},(({album:e})=>{if(e.tracks){const t=e.tracks.track,n=(t?Array.isArray(t)?t:[t]:[]).map((t=>Object.assign(Object.assign({},t),{album:{"#text":e.name},image:t.image||e.image})));return{items:n,total:n.length,atEnd:!0,itemType:Kn.Media}}throw Error("No track info")}),{playCountName:"userplaycount"},e)}createTopTracksPager(e){return new Ia({method:"artist.getTopTracks",artist:e.name},(({toptracks:e})=>{const t=e["@attr"];return{items:e.track,total:Number(t.total)||void 0,atEnd:t.page===t.totalPages,itemType:Kn.Media}}),{maxSize:20})}}Ia.minPageSize=10,Ia.maxPageSize=200;const Oa=Ia;class Ma extends Oa{constructor(e,t){super(Object.assign(Object.assign({},e),{method:"user.getRecentTracks",extended:"1",user:ga.userId}),(({recenttracks:e})=>{var t,n;const r=e["@attr"]||{},i=e.track,a=i?Array.isArray(i)?i:[i]:[],o="true"===(null===(n=null===(t=a[0])||void 0===t?void 0:t["@attr"])||void 0===n?void 0:n.nowplaying),s=Number(r.page)||1,l=Number(r.totalPages)||1,c=1===l||s===l,u=Number(r.total)||void 0;return o&&a.shift(),{items:a,total:u,atEnd:c,itemType:Kn.Media}}),t)}}var Na=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::lastfm");const $a={view:"card compact",fields:["Thumbnail","Title","Artist","Year","PlayCount"]},za={view:"details",fields:["Index","Title","Artist"]},ja={id:"lastfm/history",title:"History",icon:"clock",itemType:Kn.Media,defaultHidden:!0,search:({startAt:e=0}={})=>new Ma(e?{to:e}:void 0)},La={id:"lastfm/recently-played",title:"Recently Played",icon:"clock",itemType:Kn.Media,search:()=>new Ma},Ra={id:"lastfm/loved-tracks",title:"Loved Tracks",icon:"heart",itemType:Kn.Media,viewType:qn.Ratings,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear"]},defaultHidden:!0,search:()=>new Oa({method:"user.getLovedTracks",user:ga.userId},(({lovedtracks:e})=>{const t=e["@attr"]||{},n=e.track,r=n?Array.isArray(n)?n:[n]:[],i=Number(t.page)||1,a=Number(t.totalPages)||1,o=1===a||i===a;return{items:r,total:Number(t.total)||void 0,atEnd:o,itemType:Kn.Media}}))},Da={id:"lastfm",name:"last.fm",icon:"lastfm",url:"https://www.last.fm",isScrobbler:!0,roots:[La],sources:[Va("user.getTopTracks",{title:"Top Tracks",itemType:Kn.Media,layout:{view:"card compact",fields:["Thumbnail","Title","Artist","PlayCount"]}}),Va("user.getTopAlbums",{title:"Top Albums",itemType:Kn.Album,layout:$a,secondaryLayout:za}),Va("user.getTopArtists",{title:"Top Artists",itemType:Kn.Artist,layout:{view:"card minimal",fields:["Thumbnail","Title","PlayCount"]},secondaryLayout:$a,tertiaryLayout:za}),ja,Ra],labels:{[Hn.Like]:"Love on last.fm",[Hn.Unlike]:"Unlove on last.fm"},canRate:function(e){var t;return e.itemType===Kn.Media&&!!e.title&&!!(null===(t=e.artists)||void 0===t?void 0:t[0])},canStore:()=>!1,compareForRating:function(e,t){var n,r,i;return e.itemType===Kn.Media&&(e.itemType===t.itemType&&!!e.title&&!!(null===(n=e.artists)||void 0===n?void 0:n[0])&&Fa(e.title,t.title)&&Fa(null===(r=e.artists)||void 0===r?void 0:r[0],null===(i=t.artists)||void 0===i?void 0:i[0]))},getMetadata:function(e){return Na(this,void 0,void 0,(function*(){if(e.itemType!==Kn.Media||void 0!==e.rating)return e;const t={method:"track.getInfo",user:ga.userId};if(e.recording_mbid)t.mbid=e.recording_mbid;else{const{title:n,artists:r=[]}=e;if(t.artist=r[0],t.track=n,!t.artist)return e}const{track:n}=yield Aa.get(t);if(!n||"error"in n)throw Error((null==n?void 0:n.message)||"Not found");{const t={};return n.album&&(t.album=n.album.title,t.albumArtist=n.album.artist,e.thumbnails||(t.thumbnails=Aa.createThumbnails(n.album.image))),Object.assign(Object.assign(Object.assign({},e),t),{rating:mr.get(e,Number(n.userloved)||0),playCount:Number(n.userplaycount)||0,globalPlayCount:Number(n.playcount)||0})}}))},rate:function(e,t){return Na(this,void 0,void 0,(function*(){if(e.itemType===Kn.Media){const{title:n,artists:r=[]}=e,i=r[0];n&&i&&(yield Aa.post({method:t?"track.love":"track.unlove",track:n,artist:i}))}}))},observeIsLoggedIn:Sa,isLoggedIn:ka,login:function(){return ya(this,void 0,void 0,(function*(){if(!ka())try{const e=yield function(){return ya(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{const n=location.hostname,r=("localhost"===n?`http://${n}:${location.port}`:`https://${n}`)+"/auth/lastfm/callback/";let i=null;const a=n=>{if(/(localhost|ampcast)/.test(n.origin)){if(clearInterval(o),window.removeEventListener("message",a,!1),null==i||i.close(),i=null,n.origin!==location.origin)return void t({message:`Origin ${n.origin} does not match ${location.origin}`});e(n.data.token)}};window.addEventListener("message",a,!1),i=window.open(`https://www.last.fm/api/auth?api_key=${br}&cb=${r}`,"last.fm","popup");const o=setInterval((()=>{(null==i?void 0:i.closed)&&(clearInterval(o),t({message:"access_denied"}))}),500)}))}))}(),t=yield function(e){return ya(this,void 0,void 0,(function*(){const t="auth.getSession",n=Ca({api_key:br,token:e,method:t}),r=yield fetch(`https://ws.audioscrobbler.com/2.0?method=${t}&api_key=${br}&token=${e}&api_sig=${n}&format=json`);if(!r.ok)throw r;const{session:i}=yield r.json();return ga.userId=i.name,ga.token=e,ga.sessionKey=i.key,i.key}))}(e);wa.log("Access token successfully obtained."),xa.next(t),Ea.next(e)}catch(e){wa.log("Could not obtain access token."),wa.error(e)}}))},logout:function(){return ya(this,void 0,void 0,(function*(){ga.clear(),xa.next(""),Ea.next("")}))}},_a=Da;function Fa(e,t=""){return 0===e.localeCompare(t,void 0,{sensitivity:"accent"})}function Va(e,t){return Object.assign(Object.assign({},t),{id:`lastfm/top/${e.slice(11).toLowerCase()}`,icon:"star",searchable:!1,search:({period:n="overall"}={})=>new Oa({method:e,period:n,user:ga.userId},(n=>{const[,r]=e.toLowerCase().split("."),i=n[r.slice(3)],a=i["@attr"],o=i[r.slice(6,-1)],s=Number(a.page)||1,l=Number(a.totalPages)||1,c=1===l||s===l;return{items:o,total:Number(a.total)||void 0,atEnd:c,itemType:t.itemType}}))})}mr.addObserver(Da,5);const Ua=new z("listenbrainz"),Ba={get token(){return Ua.getString("token")},set token(e){Ua.setString("token",e)},get userId(){return Ua.getString("userId")},set userId(e){Ua.setString("userId",e)},get firstScrobbledAt(){return Ua.getString("firstScrobbledAt")},set firstScrobbledAt(e){Ua.setString("firstScrobbledAt",e)},clear(){Ua.clear()}};var Ha=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::listenbrainzApi");const Ya=new A("listenbrainzApi"),Ka=new class{constructor(){this.host="https://api.listenbrainz.org/1",this.rateLimitRemainingCalls=2,this.rateLimitResetTime=0}rate(e,t){return Ha(this,void 0,void 0,(function*(){if(e.recording_msid||e.recording_mbid){const n="feedback/recording-feedback",r={score:t};e.recording_msid&&(r.recording_msid=e.recording_msid),e.recording_mbid&&(r.recording_mbid=e.recording_mbid);const i=yield this.post(n,r);if(!i.ok)throw i}}))}addRatings(e){return Ha(this,void 0,void 0,(function*(){if((e=e.filter((e=>!!e.recording_msid||!!e.recording_mbid))).length>0){const t=yield this.getRatings(e);ir.dispatch(e.map(((e,n)=>({match:t=>Xo(t,e),values:{rating:t[n]}}))))}}))}getRatings(e){return Ha(this,void 0,void 0,(function*(){if((e=e.filter((e=>!!e.recording_msid||!!e.recording_mbid))).length>0){const[t,n]=d(e,(e=>!!e.recording_mbid)),r=t.map((e=>e.recording_mbid)),i=n.map((e=>e.recording_msid)),a={};r.length>0&&(a.recording_mbids=r),i.length>0&&(a.recording_msids=i);const{feedback:o}=yield this.get(`feedback/user/${Ba.userId}/get-feedback-for-recordings`,a);return e.map((e=>{var t;return 1===(null===(t=o.find((t=>!!e.recording_mbid&&e.recording_mbid===t.recording_mbid||!!e.recording_msid&&e.recording_msid===t.recording_msid)))||void 0===t?void 0:t.score)?1:0}))}return[]}))}getListeningActivity({range:e="all_time"}={}){return Ha(this,void 0,void 0,(function*(){const{payload:{listening_activity:t}}=yield this.get(`stats/user/${Ba.userId}/listening-activity`,{range:e});return t}))}getListenCount(){return Ha(this,void 0,void 0,(function*(){const{payload:{count:e}}=yield this.get(`user/${Ba.userId}/listen-count`);return e}))}getListens(e){return Ha(this,void 0,void 0,(function*(){return yield this.get(`user/${Ba.userId}/listens`,e)}))}scrobble(e){return Ha(this,void 0,void 0,(function*(){e.length>0&&(Ya.log("scrobble",{items:e}),yield this.post("submit-listens",{listen_type:1===e.length?"single":"import",payload:e.map((e=>({listened_at:e.playedAt,track_metadata:this.getScrobbleParams(e)})))}))}))}updateNowPlaying(e){return Ha(this,void 0,void 0,(function*(){Ya.log("updateNowPlaying",{item:e});try{this.canScrobble(e)&&(yield this.post("submit-listens",{listen_type:"playing_now",payload:[{track_metadata:this.getScrobbleParams(e)}]}))}catch(t){Ya.log('Failed to update "now playing":',{item:e}),Ya.error(t)}}))}get(e,t,n){return Ha(this,void 0,void 0,(function*(){t&&(e=`${e}?${new URLSearchParams(t)}`);const r=yield this.fetch(e,{method:"GET"},n);if(!r.ok||204===r.status)throw r;return r.json()}))}post(e,t){return Ha(this,void 0,void 0,(function*(){const n=JSON.stringify(t);return this.fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:n},!0)}))}fetch(e,t,n=!1){return Ha(this,void 0,void 0,(function*(){yield this.applyRateLimiting(),n&&(t.headers=Object.assign(Object.assign({},t.headers),{Authorization:`Token ${Ba.token}`})),e.startsWith("/")&&(e=e.slice(1));const r=yield window.fetch(`${this.host}/${e}`,t);if(!r.ok)throw r;const i=r.headers;return i.has("x-ratelimit-remaining")&&(this.rateLimitRemainingCalls=Number(i.get("x-ratelimit-remaining"))||1),i.has("x-ratelimit-reset-in")&&(this.rateLimitResetTime=Date.now()+1e3*(Number(i.get("x-ratelimit-reset-in"))||1)),this.rateLimitRemainingCalls<5&&Ya.log({rateLimitRemainingCalls:this.rateLimitRemainingCalls,rateLimitReset:new Date(this.rateLimitResetTime).toISOString()}),r}))}getScrobbleParams(e){const t={media_player:"ampcast",media_player_version:"0.8.15",submission_client:"ampcast"};e.duration&&(t.duration=Math.round(e.duration)),e.track&&(t.tracknumber=e.track),e.artist_mbids&&(t.artist_mbids=e.artist_mbids),e.release_mbid&&(t.release_mbid=e.release_mbid),e.recording_mbid&&(t.recording_mbid=e.recording_mbid),e.isrc&&(t.isrc=e.isrc);const[n]=e.src.split(":");switch(n){case"spotify":e.externalUrl&&(t.origin_url=e.externalUrl,t.spotify_id=e.externalUrl),t.music_service="spotify.com";break;case"apple":e.externalUrl&&(t.origin_url=e.externalUrl),t.music_service="music.apple.com";break;case"youtube":e.externalUrl&&(t.origin_url=e.externalUrl),t.music_service="youtube.com";break;case"jellyfin":t.music_service_name="Jellyfin";break;case"plex":t.music_service_name="Plex";break;case"blob":case"file":t.music_service_name="Local file"}const r={track_name:e.title,artist_name:e.artists[0],additional_info:t};return e.album&&"[Unknown Album]"!==e.album&&(r.release_name=e.album),r}canScrobble(e){var t;return!!e&&!!e.title&&!!(null===(t=e.artists)||void 0===t?void 0:t[0])&&e.duration>30}applyRateLimiting(){return new Promise((e=>{if(this.rateLimitRemainingCalls)this.rateLimitRemainingCalls--,e();else{const t=this.rateLimitResetTime-Date.now();t>0?setTimeout(e,t):e()}}))}},Wa=Ka;var qa=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Ja(e){var{href:t,className:n="",children:i=t}=e,a=qa(e,["href","className","children"]);return r.createElement("a",Object.assign({},a,{className:`external-link ${n}`,href:t,target:"_blank",rel:"noopener"}),r.createElement("span",{className:"external-link-text"},i),r.createElement(xi,{name:"link"}))}var Qa=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function Ga(e){const t=(0,r.useId)(),n=(0,r.useRef)(null),i=(0,r.useRef)(null),a=(0,r.useRef)(null),o="https://listenbrainz.org/profile/",s=(0,r.useCallback)((()=>Qa(this,void 0,void 0,(function*(){try{const e=i.current.value,t=a.current.value;Ba.userId=e;const r=yield fetch("https://api.listenbrainz.org/1/validate-token",{headers:{"Content-Type":"application/json",Authorization:`Token ${t}`}});if(!r.ok)throw r;const{valid:o,user_name:s}=yield r.json();if(!o)throw Error("Invalid token.");if(s!==e)throw Error("Token not valid for this user.");n.current.close(JSON.stringify({userId:e,token:t}))}catch(e){console.error(e)}}))),[]),l=(0,r.useCallback)((e=>{e.preventDefault(),s()}),[s]);return r.createElement(Ci,Object.assign({},e,{className:"listenbrainz-login-dialog",title:"Log in to ListenBrainz",ref:n}),r.createElement("form",{method:"dialog",onSubmit:l},r.createElement("div",{className:"table-layout"},r.createElement("p",null,r.createElement("label",{htmlFor:`${t}-username`},"User:"),r.createElement("input",{type:"text",id:`${t}-username`,autoFocus:!0,required:!0,spellCheck:!1,autoComplete:"off",autoCapitalize:"off",ref:i})),r.createElement("p",null,r.createElement("label",{htmlFor:`${t}-token`},"Token:"),r.createElement("input",{type:"password",id:`${t}-token`,required:!0,ref:a}))),r.createElement("p",{className:"listenbrainz-link"},r.createElement(Ja,{href:o},r.createElement(xi,{name:"listenbrainz"}),o)),r.createElement(Mi,{submitText:"Login"})))}var Xa=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::listenbrainzAuth");const Za=new A("listenbrainzAuth"),eo=new Ie("");function to(){return""!==eo.getValue()}function no(){return eo.pipe(tr()).pipe(Gt((e=>""!==e)),tr())}eo.next(Ba.token);var ro=n(6998),io=n.n(ro);const ao="https://musicbrainz.org";var oo=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::youtubeAuth");const so=new A("youtubeAuth"),lo="https://www.googleapis.com/auth/youtube.readonly",co=["https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest"],uo=new Ie("");function mo(){return""!==ho()}function ho(){return uo.getValue()}function fo(){var e,t;return oo(this,void 0,void 0,(function*(){return(null===(t=null===(e=window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.oauth2)||(yield c("https://accounts.google.com/gsi/client")),google.accounts.oauth2}))}!function(){oo(this,void 0,void 0,(function*(){const e=(yield function(){return oo(this,void 0,void 0,(function*(){const e=yield function(){return oo(this,void 0,void 0,(function*(){return window.gapi||(yield c("https://apis.google.com/js/api.js")),window.gapi}))}();return e.client?e.client:new Promise(((t,n)=>{e.load("client",{callback:()=>{const r={apiKey:wr,clientId:Er,discoveryDocs:co,scope:lo};e.client.init(r).then((()=>t(e.client)),n)},onerror:n})}))}))}()).getToken();e&&(so.log("Access token successfully obtained."),uo.next(e.access_token)),gapi.load("client:auth2",(()=>{gapi.auth2.getAuthInstance().isSignedIn.listen((e=>{if(e){const e=gapi.client.getToken();uo.next((null==e?void 0:e.access_token)||"")}else uo.next("")}))}))}))}();var po=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const vo=new A("youtubeCache");class bo extends vt.ZP{constructor(){super("ampcast/youtube/cache"),this.version(1).stores({entries:"&key, timeStamp"}),setTimeout((()=>this.removeExpired()))}store(e,t){return po(this,void 0,void 0,(function*(){try{yield this.entries.put({key:e,response:t,timeStamp:Date.now()})}catch(e){vo.error(e)}}))}fetch(e){return po(this,void 0,void 0,(function*(){try{const t=yield this.entries.get(e);return null==t?void 0:t.response}catch(e){vo.error(e)}}))}removeExpired(){const e=Date.now()-12096e5;this.entries.where("timeStamp").below(e).delete()}}const go=new bo;var yo=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))},wo=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};class Eo{constructor(e,t,n){this.defaultConfig={pageSize:Eo.maxPageSize},this.nextPageToken=void 0,this.pageNumber=1,this.config=Object.assign(Object.assign({},this.defaultConfig),n),this.pager=new Hr((()=>yo(this,void 0,void 0,(function*(){return this.fetchPage(e,t)}))),this.config)}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createItems({kind:e,items:t=[]},n){return yo(this,void 0,void 0,(function*(){switch(e){case"youtube#playlistListResponse":return t.map((e=>this.createMediaPlaylist(e)));case"youtube#playlistItemListResponse":{const e=t.map((e=>e.contentDetails.videoId));return(yield this.fetchVideos(e,n)).map((e=>this.createMediaItem(e)))}case"youtube#searchListResponse":{const e=t.map((e=>e.id.videoId));return(yield this.fetchVideos(e,n)).map((e=>this.createMediaItem(e)))}default:return t.map((e=>this.createMediaItem(e)))}}))}createMediaPlaylist(e){var t,n,r;const i=`youtube:playlist:${e.id}`;return{src:i,itemType:Kn.Playlist,externalUrl:`${So}/playlist?list=${e.id}`,title:(null===(t=e.snippet)||void 0===t?void 0:t.title)||e.id,thumbnails:this.mapThumbnails(null===(n=e.snippet)||void 0===n?void 0:n.thumbnails),trackCount:null===(r=e.contentDetails)||void 0===r?void 0:r.itemCount,owner:this.createOwner(e.snippet),pager:this.createPlaylistPager(e.id),isPinned:Qr.isPinned(i)}}createMediaItem(e){var t,n,r,i,a;return{itemType:Kn.Media,mediaType:jr.Video,src:`youtube:video:${e.id}`,externalUrl:Io(e.id),title:(null===(t=e.snippet)||void 0===t?void 0:t.title)||e.id,duration:this.parseDuration(null===(n=e.contentDetails)||void 0===n?void 0:n.duration),thumbnails:this.mapThumbnails(null===(r=e.snippet)||void 0===r?void 0:r.thumbnails),owner:this.createOwner(e.snippet),globalRating:this.parseNumber(null===(i=e.statistics)||void 0===i?void 0:i.likeCount),globalPlayCount:this.parseNumber(null===(a=e.statistics)||void 0===a?void 0:a.viewCount),playedAt:0}}createOwner({channelId:e="",channelTitle:t=""}){return e?{name:t,url:`${So}/channel/${e}`}:void 0}createPlaylistPager(e){return new Eo("/playlistItems",{playlistId:e,part:"contentDetails",fields:"items(contentDetails(videoId))"})}mapThumbnails(e){if(e)return Object.keys(e).map((t=>e[t]))}parseDuration(e=""){const[,t=0,n=0,r=0]=/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/.exec(e)||[];return 60*Number(t)*60+60*Number(n)+Number(r)||0}fetchPage(e,t){return yo(this,void 0,void 0,(function*(){const n=this.createCacheKey(e,t,this.pageNumber),r=yield this.getFromCache(n),i=this.nextPageToken,a=yield this.fetch(e,Object.assign(Object.assign({},t),{fields:`etag,kind,pageInfo,nextPageToken,${t.fields||"items"}`,maxResults:String(this.config.pageSize),pageToken:i}),r),{pageInfo:o,nextPageToken:s}=a,l=wo(a,["pageInfo","nextPageToken"]),c=yield this.createItems(l,n),u=null==o?void 0:o.totalResults,d=!s;return this.nextPageToken=s,this.pageNumber++,yield this.saveToCache(n,a),{items:c,total:u,atEnd:d}}))}fetchVideos(e,t){return yo(this,void 0,void 0,(function*(){const n=`${t}/videos`,r=yield this.getFromCache(n),i=yield this.fetch("/videos",{id:e.join(","),part:"contentDetails,snippet,statistics",fields:`etag,${Eo.videoFields}`},r);return yield this.saveToCache(n,i),i.items||[]}))}fetch(e,t,n){return yo(this,void 0,void 0,(function*(){const r=(null==n?void 0:n.etag)?{"If-None-Match":n.etag}:void 0;return gapi.client.request({path:`https://www.googleapis.com/youtube/v3${e}`,params:t,headers:r}).then((e=>yo(this,void 0,void 0,(function*(){const{result:t,status:r,statusText:i}=e;if(t)return t;if(304===r&&n)return n;throw Error(i||`Error (${r})`)}))))}))}getFromCache(e){return yo(this,void 0,void 0,(function*(){return go.fetch(e)}))}saveToCache(e,t){return yo(this,void 0,void 0,(function*(){this.config.noCache||(yield go.store(e,t))}))}createCacheKey(e,t,n){const{fields:r}=t,i=wo(t,["fields"]);return`${e}?${new URLSearchParams(i)}#${n}`}parseNumber(e){if(null!=e&&!isNaN(Number(e)))return Number(e)}}Eo.minPageSize=5,Eo.maxPageSize=50,Eo.videoFields="items(id,snippet(title,thumbnails,channelId,channelTitle),contentDetails(duration),statistics(viewCount,likeCount))",Eo.playlistFields="items(id,snippet(title,thumbnails,channelId,channelTitle),contentDetails(itemCount))";const xo=Eo;var ko=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::youtube");const So="https://www.youtube.com",Co={view:"card",fields:["Thumbnail","Title","Duration","Owner","Views"]},To={id:"youtube/likes",title:"Likes",icon:"thumbs-up",itemType:Kn.Media,viewType:qn.Ratings,layout:Co,defaultHidden:!0,search:()=>new xo("/videos",{myRating:"like",part:"snippet,contentDetails,statistics",fields:xo.videoFields})},Po={id:"youtube/playlists",title:"Playlists",icon:"playlist",itemType:Kn.Playlist,secondaryLayout:Co,search:()=>new xo("/playlists",{mine:"true",part:"snippet,contentDetails",fields:xo.playlistFields})};function Ao(e=""){if(e.startsWith("youtube:"))return e;const t=io()(e);if(t)return`youtube:video:${t}`;if(/youtu\.?be/.test(e)){const t=new URLSearchParams(new URL(e).search).get("list")||"";if(t)return`youtube:playlist:${t}`}return""}function Io(e){return`${So}/watch?v=${e}`}function Oo(e){return ko(this,void 0,void 0,(function*(){const t=Io(e),n=yield fetch(`${So}/oembed?url=${t}&format=json`);if(!n.ok)switch(n.status){case 401:throw Error("Embedding prevented by channel owner.");case 403:throw Error("Private video.");case 404:throw Error("Video does not exist.");default:throw Error(`${n.statusText} (${n.status})`)}const r=yield n.json();return{itemType:Kn.Media,mediaType:jr.Video,src:`youtube:video:${e}`,externalUrl:t,title:r.title,aspectRatio:r.width/r.height||16/9,duration:0,track:0,thumbnails:[{url:r.thumbnail_url,width:r.thumbnail_width,height:r.thumbnail_height}],owner:{name:r.author_name,url:r.author_url},playedAt:0}}))}const Mo={id:"youtube",name:"YouTube",icon:"youtube",url:"https://www.youtube.com",defaultNoScrobble:!0,roots:[{id:"youtube/search/videos",title:"Video",icon:"",itemType:Kn.Media,layout:Co,searchable:!0,search:({q:e=""}={})=>e?new xo("/search",{q:e,type:"video",videoCategoryId:"10",part:"id",fields:"items(id(videoId))"},{maxSize:xo.maxPageSize,noCache:!0}):new pr}],sources:[To,Po],canRate:()=>!1,canStore:()=>!1,compareForRating:()=>!1,createSourceFromPin:function(e){return{title:e.title,itemType:Kn.Playlist,id:e.src,icon:"pin",isPin:!0,secondaryLayout:Object.assign(Object.assign({},Co),{view:"card compact"}),search(){const[,,t]=e.src.split(":");return new xo("/playlists",{id:t,part:"snippet,contentDetails",fields:xo.playlistFields})}}},observeIsLoggedIn:function(){return uo.pipe(tr()).pipe(Gt((e=>""!==e)),tr())},isLoggedIn:mo,login:function(){return oo(this,void 0,void 0,(function*(){if(!mo())try{const e=yield function(){return oo(this,void 0,void 0,(function*(){const e=yield fo();return new Promise(((t,n)=>{e.initTokenClient({client_id:Er,scope:lo,prompt:"",callback:e=>{e.error?n(e.error_description):(uo.next(e.access_token),t(e.access_token))}}).requestAccessToken()}))}))}();so.log("Access token successfully obtained."),uo.next(e)}catch(e){so.log("Could not obtain access token."),so.error(e)}}))},logout:function(){return oo(this,void 0,void 0,(function*(){const e=ho();e&&((yield fo()).revoke(e,(()=>uo.next(""))),google.accounts.id.disableAutoSelect())}))}},No=Mo;const $o=new A("ListenBrainzHistoryPager");class zo{constructor(e,t=!1){this.fetchListenCount=t,this.size$=new Dr(1),this.nextPageParams=void 0,this.pager=new Hr(((t=50)=>{return n=this,r=void 0,a=function*(){try{const{payload:n}=yield Wa.get(`user/${Ba.userId}/listens`,Object.assign(Object.assign(Object.assign({},e),{count:t}),this.nextPageParams)),r=n.listens,i=this.createItems(r),a=i.length<t;return this.nextPageParams=a?void 0:{max_ts:r.at(-1).listened_at-1},{items:i,atEnd:a}}catch(e){if(this.isNoContentError(e))return{items:[],atEnd:!0};throw e}},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(t.value).then(o,s)}l((a=a.apply(n,r||[])).next())}));var n,r,i,a}),{pageSize:50})}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.size$.pipe(tr())}observeError(){return this.pager.observeError()}disconnect(){var e;this.pager.disconnect(),null===(e=this.subscriptions)||void 0===e||e.unsubscribe()}fetchAt(e,t){this.subscriptions||this.connect(),this.pager.fetchAt(e,t)}connect(){this.subscriptions||(this.subscriptions=new ne,this.subscriptions.add(this.pager.observeAdditions().pipe(Zt((e=>Wa.addRatings(e)))).subscribe($o)),this.fetchListenCount&&this.subscriptions.add(vn(Wa.getListenCount()).pipe($e((e=>this.size$.next(e)))).subscribe($o)))}createItems(e){return e.map((e=>this.createItem(e)))}createItem(e){var t,n,r;const i=e.track_metadata,a=i.additional_info,o=(null===(t=i.mbid_mapping)||void 0===t?void 0:t.recording_mbid)||void 0,s=this.getPlayableSrc(a)||"";return{itemType:Kn.Media,mediaType:s.startsWith("youtube:")?jr.Video:jr.Audio,src:`listenbrainz:listen:${e.listened_at}`,title:i.track_name,addedAt:e.inserted_at,artists:i.artist_name?[i.artist_name]:void 0,albumArtist:null==a?void 0:a.release_artist_name,album:i.release_name,duration:(null==a?void 0:a.duration)||((null==a?void 0:a.duration_ms)?Math.round(a.duration_ms/1e3):0),track:(null==a?void 0:a.tracknumber)||(null==a?void 0:a.track_number),disc:null==a?void 0:a.discnumber,isrc:null==a?void 0:a.isrc,externalUrl:o?`${ao}/recording/${o}`:void 0,recording_mbid:o,recording_msid:e.recording_msid||void 0,release_mbid:null===(n=i.mbid_mapping)||void 0===n?void 0:n.release_mbid,artist_mbids:null===(r=i.mbid_mapping)||void 0===r?void 0:r.artist_mbids,playedAt:e.listened_at,link:{src:s,externalUrl:this.getExternalUrl(null==a?void 0:a.origin_url)}}}getExternalUrl(e){if(e&&/youtu\.?be/.test(e)){const t=io()(e);if(t)return Io(t)}return e||void 0}getPlayableSrc(e){var t;if(e){if(e.spotify_id)return this.getSpotifySrc(e.spotify_id);const n=e.origin_url;if(n){if(n.includes("apple.com"))return this.getAppleSrc(n);if(n.includes("spotify.com"))return this.getSpotifySrc(n);if(/youtu\.?be/.test(n))return Ao(n)}const r=(null===(t=e.music_service_name)||void 0===t?void 0:t.toLowerCase())||"",i="jellyfin|spotify|youtube|apple|plex".split("|");for(const e of i)if(r.includes(e))return`${e}:`}}getAppleSrc(e){if(e){const t=e.split("i=").pop();if(t)return`apple:song:${t}`}}getSpotifySrc(e){if(e){const t=e.split("/").pop();if(t)return`spotify:track:${t}`}}isNoContentError(e){return 204===(null==e?void 0:e.status)}}zo.maxPageSize=100;const jo=zo;class Lo{constructor(){let e=0;this.pager=new Hr(((t=50)=>{return n=this,r=void 0,a=function*(){try{const n=yield Wa.get(`feedback/user/${Ba.userId}/get-feedback`,{score:1,metadata:!0,offset:e,count:t});e+=t;const r=this.createItems(n.feedback),i=n.total_count;return{items:r,total:i,atEnd:n.offset+r.length>=i}}catch(e){if(this.isNoContentError(e))return{items:[],atEnd:!0};throw e}},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(t.value).then(o,s)}l((a=a.apply(n,r||[])).next())}));var n,r,i,a}),{pageSize:50})}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createItems(e){return e.map((e=>this.createItem(e)))}createItem(e){var t,n;const r=e.track_metadata,i=r.additional_info,a=e.recording_mbid;return{itemType:Kn.Media,mediaType:jr.Audio,src:`listenbrainz:track:${pi()}`,title:r.track_name,artists:r.artist_name?[r.artist_name]:void 0,albumArtist:null==i?void 0:i.release_artist_name,album:r.release_name,duration:(null==i?void 0:i.duration)||((null==i?void 0:i.duration_ms)?Math.round(i.duration_ms/1e3):0),track:(null==i?void 0:i.tracknumber)||(null==i?void 0:i.track_number),disc:null==i?void 0:i.discnumber,isrc:null==i?void 0:i.isrc,externalUrl:a?`${ao}/recording/${a}`:void 0,recording_mbid:a,recording_msid:e.recording_msid||void 0,release_mbid:null===(t=r.mbid_mapping)||void 0===t?void 0:t.release_mbid,artist_mbids:null===(n=r.mbid_mapping)||void 0===n?void 0:n.artist_mbids,playedAt:0,rating:1}}isNoContentError(e){return 204===(null==e?void 0:e.status)}}Lo.maxPageSize=100;const Ro=Lo;var Do=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::musicbrainzApi");const _o=new class{constructor(){this.host="https://musicbrainz.org/ws/2",this.lastCall=0}getISRCs(e){return Do(this,void 0,void 0,(function*(){return(yield this.get(`/recording/${e}`,{inc:"isrcs"})).isrcs||[]}))}getRecordingsByISRC(e){return Do(this,void 0,void 0,(function*(){return(yield this.get(`/isrc/${e}`)).recordings||[]}))}get(e,t={}){return Do(this,void 0,void 0,(function*(){e.startsWith("/")&&(e=e.slice(1)),t.fmt="json",e=`${e}?${new URLSearchParams(t)}`,yield this.applyRateLimiting(),this.lastCall=Date.now();const n=yield fetch(`${this.host}/${e}`,{method:"GET",headers:{"User-Agent":"ampcast/0.8.15 ( rekky.rosso@gmail.com )"}});if(!n.ok)throw n;return yield n.json()}))}applyRateLimiting(){return new Promise((e=>{const t=Date.now()-this.lastCall;t>1e3?e():setTimeout((()=>e),t)}))}};class Fo{constructor(e,t){this.release_mbid=e,this.pager=new Hr((()=>{return n=this,r=void 0,a=function*(){var n;const{media:r=[]}=yield _o.get(`release/${e}`,{inc:"recordings"});return{items:this.createItems((null===(n=r[0])||void 0===n?void 0:n.tracks)||[],t),atEnd:!0}},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(t.value).then(o,s)}l((a=a.apply(n,r||[])).next())}));var n,r,i,a}))}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createItems(e,t){return e.map((e=>this.createItem(e,t)))}createItem(e,t){const n=e.recording,r=n.id||void 0;return{itemType:Kn.Media,mediaType:jr.Audio,src:`musicbrainz:track:${r||pi()}`,title:e.title,artists:(null==t?void 0:t.artist)?[t.artist]:void 0,albumArtist:null==t?void 0:t.artist,album:null==t?void 0:t.title,duration:e.length/1e3||0,track:e.number?Number(e.number):void 0,recording_mbid:r,release_mbid:this.release_mbid,year:(null==t?void 0:t.year)||new Date(n["first-release-date"]).getUTCFullYear()||void 0,playedAt:0,externalUrl:r?`https://musicbrainz.org/recording/${r}`:void 0}}}const Vo=new A("ListenBrainzStatsPager");class Uo{constructor(e,t){let n=0;this.pager=new Hr(((r=50)=>{return i=this,a=void 0,s=function*(){try{const i=yield Wa.get(e,Object.assign(Object.assign({},t),{offset:n,count:r}));return n+=r,this.createPage(i)}catch(e){if(this.isNoContentError(e))return{items:[],atEnd:!0};throw e}},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{l(s.next(e))}catch(e){t(e)}}function r(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof o?e:new o((function(t){t(e)}))}(t.value).then(n,r)}l((s=s.apply(i,a||[])).next())}));var i,a,o,s}),{pageSize:50})}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){var e;this.pager.disconnect(),null===(e=this.subscriptions)||void 0===e||e.unsubscribe()}fetchAt(e,t){this.subscriptions||this.connect(),this.pager.fetchAt(e,t)}connect(){this.subscriptions||(this.subscriptions=new ne,this.subscriptions.add(this.pager.observeAdditions().pipe(Gt((e=>e.filter((e=>e.itemType===Kn.Media)))),ze((e=>e.length>0)),Zt((e=>Wa.addRatings(e)))).subscribe(Vo)))}createPage(e){if(this.isRecordingsResponse(e)){const t=e.payload,n=t.recordings.map((e=>this.createMediaItem(e))),r=t.total_recording_count;return{items:n,total:r,atEnd:t.offset+n.length>=r}}if(this.isReleasesResponse(e)){const t=e.payload,n=t.releases.map((e=>this.createMediaAlbum(e))),r=t.total_release_count;return{items:n,total:r,atEnd:t.offset+n.length>=r}}if(this.isArtistsResponse(e)){const t=e.payload,n=t.artists.map((e=>this.createMediaArtist(e))),r=t.total_artist_count;return{items:n,total:r,atEnd:t.offset+n.length>=r}}throw Error("Unknown response.")}createMediaArtist(e){var t;const n=(null===(t=e.artist_mbids)||void 0===t?void 0:t[0])||void 0;return{itemType:Kn.Artist,src:`listenbrainz:artist:${pi()}`,externalUrl:n?`${ao}/artist/${n}`:void 0,title:e.artist_name,artist_mbid:n,playCount:e.listen_count,pager:new pr}}createMediaAlbum(e){const t=e.release_mbid||void 0,n={itemType:Kn.Album,src:`listenbrainz:album:${pi()}`,externalUrl:t?`${ao}/release/${t}`:void 0,title:e.release_name,artist:e.artist_name,release_mbid:t,artist_mbids:e.artist_mbids,playCount:e.listen_count};return Object.assign(Object.assign({},n),{pager:t?new Fo(t,n):new pr})}createMediaItem(e){const t=e.recording_mbid||void 0;return{itemType:Kn.Media,mediaType:jr.Audio,src:`listenbrainz:track:${pi()}`,externalUrl:t?`${ao}/recording/${t}`:void 0,title:e.track_name,artists:e.artist_name?[e.artist_name]:void 0,album:e.release_name,duration:0,recording_mbid:t,release_mbid:e.release_mbid||void 0,artist_mbids:e.artist_mbids,playCount:e.listen_count,playedAt:0}}isRecordingsResponse(e){return"total_recording_count"in e.payload}isReleasesResponse(e){return"total_release_count"in e.payload}isArtistsResponse(e){return"total_artist_count"in e.payload}isNoContentError(e){return 204===(null==e?void 0:e.status)}}console.log("module::listenbrainz");const Bo={id:"listenbrainz/history",title:"History",icon:"clock",itemType:Kn.Media,defaultHidden:!0,search:({startAt:e=0}={})=>new jo(e?{max_ts:e}:void 0)},Ho={id:"listenbrainz/recently-played",title:"Recently Played",icon:"clock",itemType:Kn.Media,search:()=>new jo},Yo={id:"listenbrainz/loved-tracks",title:"Loved Tracks",icon:"heart",itemType:Kn.Media,viewType:qn.Ratings,defaultHidden:!0,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear"]},search:()=>new Ro},Ko={id:"listenbrainz/top/tracks",title:"Top Tracks",icon:"star",itemType:Kn.Media,layout:{view:"card compact",fields:["Thumbnail","Title","Artist","PlayCount"]},search:e=>new Uo(`stats/user/${Ba.userId}/recordings`,e)},Wo={id:"listenbrainz/top/albums",title:"Top Albums",icon:"star",itemType:Kn.Album,layout:{view:"card compact",fields:["Thumbnail","Title","Artist","Year","PlayCount"]},search:e=>new Uo(`stats/user/${Ba.userId}/releases`,e)},qo={id:"listenbrainz/top/artists",title:"Top Artists",icon:"star",itemType:Kn.Artist,layout:{view:"card minimal",fields:["Thumbnail","Title","PlayCount"]},defaultHidden:!0,search:e=>new Uo(`stats/user/${Ba.userId}/artists`,e)},Jo={id:"listenbrainz",name:"ListenBrainz",icon:"listenbrainz",url:"https://listenbrainz.org",isScrobbler:!0,roots:[Ho],sources:[Ko,Wo,qo,Bo,Yo],labels:{[Hn.Like]:"Love on ListenBrainz",[Hn.Unlike]:"Unlove on ListenBrainz"},canRate:Go,canStore:()=>!1,compareForRating:Xo,rate:function(e,t){return n=this,r=void 0,a=function*(){Go(e)&&(yield Wa.rate(e,t))},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(t.value).then(o,s)}l((a=a.apply(n,r||[])).next())}));var n,r,i,a},observeIsLoggedIn:no,isLoggedIn:to,login:function(){return Xa(this,void 0,void 0,(function*(){if(!to())try{const e=yield function(){return Qa(this,void 0,void 0,(function*(){return Pi(Ga,!0)}))}();if(e){const{userId:t,token:n}=JSON.parse(e);Ba.userId=t,Ba.token=n,Za.log("Access token successfully obtained."),eo.next(n)}}catch(e){Za.log("Could not obtain access token."),Za.error(e)}}))},logout:function(){return Xa(this,void 0,void 0,(function*(){eo.next(""),Ba.clear()}))}},Qo=Jo;function Go(e){return e.itemType===Kn.Media&&!(!e.recording_mbid&&!e.recording_msid)}function Xo(e,t){return e.itemType===Kn.Media&&e.itemType===t.itemType&&(!!e.recording_mbid&&e.recording_mbid===t.recording_mbid||!!e.recording_msid&&e.recording_msid===t.recording_msid)}mr.addObserver(Jo,5);const Zo=new z("plex"),es={get clientId(){let e=Zo.getString("clientId");return e||(e=pi(),Zo.setString("clientId",e)),e},get connection(){return Zo.getJson("connection")},set connection(e){Zo.setJson("connection",e)},get host(){var e;return(null===(e=this.connection)||void 0===e?void 0:e.uri)||""},get libraryId(){return Zo.getString("libraryId")},set libraryId(e){Zo.setString("libraryId",e)},get server(){return Zo.getJson("server")},set server(e){Zo.setJson("server",e)},get serverToken(){var e;return(null===(e=this.server)||void 0===e?void 0:e.accessToken)||""},get userToken(){return Zo.getString("userToken")},set userToken(e){Zo.setString("userToken",e)},get userId(){return Zo.getString("userId")},set userId(e){Zo.setString("userId",e)},clear(){const e=this.clientId;Zo.clear(),e&&Zo.setString("clientId",e)}};var ts=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function ns({host:e=es.host,path:t,method:n="GET",params:r,headers:i,body:a,token:o,keepalive:s}){return ts(this,void 0,void 0,(function*(){if(!e)throw Error("No Plex connection.");(t=r?`${t}?${new URLSearchParams(r)}`:t).startsWith("/")||(t=`/${t}`),o||(o=e===es.host?es.serverToken:es.userToken);const l=yield window.fetch(`${e}${t}`,{method:n,headers:Object.assign(Object.assign({},i),rs(o)),body:a,keepalive:s});if(!l.ok)throw Error(l.statusText);return l}))}function rs(e){const t={"X-Plex-Product":"ampcast","X-Plex-Version":"0.8.15","X-Plex-Platform":U.displayName,"X-Plex-Platform-Version":U.version,"X-Plex-Device":U.os,"X-Plex-Device-Name":U.displayName,"X-Plex-Client-Identifier":es.clientId,"X-Plex-Model":"hosted","Accept-Encoding":"gzip, deflate, br"};return e&&(t["X-Plex-Token"]=e),t}console.log("module::plexApi");const is={fetch:ns,fetchJSON:function(e){var{headers:t,body:n}=e,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["headers","body"]);return ts(this,void 0,void 0,(function*(){return t=Object.assign(Object.assign({},t),{Accept:"application/json"}),n&&(t=Object.assign(Object.assign({},t),{"Content-Type":"application/json"}),n=JSON.stringify(n)),(yield ns(Object.assign({headers:t,body:n},r))).json()}))},getPlayableUrlFromSrc:function(e){const{host:t,serverToken:n}=es;if(t&&n){const[,,r]=e.split(":");return`${t}${r}?X-Plex-Token=${n}`}throw Error("Not logged in.")}},as=is;var os=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::plexAuth");const ss=new A("plexAuth"),ls="https://plex.tv/api/v2",cs=new Ie(""),us=new Ie(!1);let ds;function ms(){return""!==cs.getValue()}function hs(){return cs.pipe(tr()).pipe(Gt((e=>""!==e)),tr())}function fs(e){es.userToken=e,e&&ss.log("Access token successfully obtained."),cs.next(e)}fs(es.userToken),hs().pipe(ze((e=>e)),$e((()=>os(void 0,void 0,void 0,(function*(){const e=function(e,t){return os(this,void 0,void 0,(function*(){try{return yield as.fetch({host:e.uri,path:"/",method:"HEAD",token:t}),e}catch(e){return null}}))},t=es.connection;if(t){if(yield e(t,es.serverToken))return ss.log(`Using existing ${t.local?"local":"public"} connection.`),void us.next(!0);es.server=null,es.connection=null}ss.log("Searching for a connection...");try{const t=(yield function(){return os(this,void 0,void 0,(function*(){return as.fetchJSON({host:ls,path:"/resources",params:{includeHttps:"1"}})}))}()).filter((e=>"server"===e.provides));for(const n of t){const t=yield Promise.all([...n.connections.map((t=>e(t,n.accessToken)))]),r=t.filter(l);if(r.length){const e=r.find((e=>e.local))||r[0];return es.server=n,es.connection=e,ss.log(`Using ${e.local?"local":"public"} connection.`),void us.next(!0)}}ss.log("Could not establish a connection.")}catch(e){ss.log(e),fs("")}}))))).subscribe(ss),us.pipe(ze((e=>e)),$e((()=>os(void 0,void 0,void 0,(function*(){ss.log("Connected");const{MediaContainer:{Directory:e}}=yield as.fetchJSON({path:"/library/sections"}),t=e.find((e=>"artist"===e.type));es.libraryId=(null==t?void 0:t.key)||""}))))).subscribe(ss);class ps{constructor(e,t,n,r){var i;this.path=e,this.params=t,this.parent=r,this.pageSize=(null==n?void 0:n.pageSize)||((null===(i=es.connection)||void 0===i?void 0:i.local)?ps.maxPageSize:100),this.pager=new Qi((e=>this.fetch(e)),Object.assign({pageSize:this.pageSize},n))}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}fetch(e){return t=this,n=void 0,i=function*(){const t=yield as.fetchJSON({path:this.path,params:this.params,headers:{"X-Plex-Container-Size":String(this.pageSize),"X-Plex-Container-Start":String((e-1)*this.pageSize)}}),{MediaContainer:{Metadata:n=[],size:r,totalSize:i}}=t;return{items:n.map((e=>this.createItem(e))),total:i||r}},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(t.value).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}createItem(e){switch(e.type){case"clip":return this.createMediaItemFromVideo(e);case"album":return this.createMediaAlbum(e);case"artist":return this.createMediaArtist(e);case"playlist":return this.createMediaPlaylist(e);case"track":return this.createMediaItemFromTrack(e);default:return this.createMediaFolder(e)}}createMediaItemFromTrack(e){const[t]=e.Media,[n]=t.Part,r=(e.title||"").trim(),i=!!r,a=i?"[Unknown Album]"===e.parentTitle?void 0:e.parentTitle||void 0:void 0,o=this.getFileName(n.file)||"[Unknown]";return{itemType:Kn.Media,mediaType:jr.Audio,src:`plex:audio:${n.key}`,externalUrl:this.getExternalUrl(`/library/metadata/${e.parentRatingKey}`),fileName:o,title:r||o.replace(/\.\w+/,""),addedAt:e.addedAt,artists:i?e.originalTitle?[e.originalTitle]:e.grandparentTitle?[e.grandparentTitle]:void 0:void 0,albumArtist:a&&!e.originalTitle?e.grandparentTitle:void 0,album:a,duration:e.duration/1e3,track:a?e.index:void 0,rating:e.userRating||0,year:e.parentYear,playedAt:e.lastViewedAt||0,playCount:e.viewCount,plex:{ratingKey:e.ratingKey},thumbnails:this.createThumbnails(e.thumb)}}createMediaAlbum(e){var t;return{itemType:Kn.Album,src:`plex:album:${e.ratingKey}`,externalUrl:this.getExternalUrl(`/library/metadata/${e.ratingKey}`),title:e.title||"",description:e.summary,addedAt:e.addedAt,artist:e.parentTitle,rating:e.userRating||0,year:e.year,playedAt:e.lastViewedAt,playCount:e.viewCount,genres:null===(t=e.Genre)||void 0===t?void 0:t.map((e=>e.tag)),plex:{ratingKey:e.ratingKey},pager:this.createPager(e.key),thumbnails:this.createThumbnails(e.thumb)}}createMediaArtist(e){var t,n;return{itemType:Kn.Artist,src:`plex:album:${e.ratingKey}`,externalUrl:this.getExternalUrl(`/library/metadata/${e.ratingKey}`),title:e.title,description:e.summary,country:null===(t=e.Country)||void 0===t?void 0:t.map((e=>e.tag)).join(", "),addedAt:e.addedAt,rating:e.userRating||0,genres:null===(n=e.Genre)||void 0===n?void 0:n.map((e=>e.tag)),plex:{ratingKey:e.ratingKey},pager:this.createPager(`/library/sections/${es.libraryId}/all`,{"artist.id":e.ratingKey,type:"9",sort:"year:desc,originallyAvailableAt:desc,artist.titleSort:desc,album.titleSort,album.index"}),thumbnails:this.createThumbnails(e.thumb)}}createMediaItemFromVideo(e){const[t]=e.Media,[n]=t.Part;return{itemType:Kn.Media,mediaType:jr.Video,src:`plex:video:${n.key}`,externalUrl:e.art?this.getExternalUrl(e.art.replace(/\/art\/\d+$/,"")):"",fileName:this.getFileName(n.file),title:e.title||"Video",addedAt:e.addedAt,artists:e.grandparentTitle?[e.grandparentTitle]:void 0,duration:e.duration/1e3,playedAt:e.lastViewedAt||0,playCount:e.viewCount,plex:{ratingKey:e.ratingKey},thumbnails:this.createThumbnails(e.thumb)}}createMediaPlaylist(e){const t=`plex:playlist:${e.key}`;return{itemType:Kn.Playlist,src:t,externalUrl:this.getExternalUrl(`/playlists/${e.ratingKey}`,"playlist"),title:e.title,description:e.summary,addedAt:e.addedAt,duration:e.duration/1e3,playedAt:e.lastViewedAt,playCount:e.viewCount,trackCount:e.leafCount,plex:{ratingKey:e.ratingKey},pager:this.createPager(e.key),thumbnails:this.createThumbnails(e.composite),isPinned:Qr.isPinned(t)}}createMediaFolder(e){var t;const n={itemType:Kn.Folder,src:`plex:folder:${e.key}`,title:e.title,fileName:e.title,path:(null===(t=this.parent)||void 0===t?void 0:t.itemType)===Kn.Folder?`${this.parent.path}/${e.title}`:"/",parent:this.parent};return n.pager=this.createFolderPager(n),n}get webHost(){var e;const t=null===(e=es.server)||void 0===e?void 0:e.clientIdentifier;return t?`https://app.plex.tv/desktop/#!/server/${t}`:""}getExternalUrl(e,t="details"){const n=this.webHost;return n?`${n}/${t}?key=${encodeURIComponent(e)}`:""}getFileName(e){return e.split(/[/\\]/).pop()}createThumbnails(e){return e?[this.createThumbnail(e,120),this.createThumbnail(e,240),this.createThumbnail(e,360),this.createThumbnail(e,480)]:void 0}createThumbnail(e,t,n=t){return{url:`${es.host}/photo/:/transcode?url=${encodeURIComponent(e)}&width=${t}&height=${n}&minSize=1&upscale=1&X-Plex-Token={plex-token}`,width:t,height:n}}createPager(e,t){return new ps(e,t)}createFolderPager(e){var t;const[,,n]=e.src.split(":"),r=new ps(n,void 0,void 0,e);if((null===(t=this.parent)||void 0===t?void 0:t.itemType)===Kn.Folder){const e=Object.assign(Object.assign({},this.parent),{fileName:`../${this.parent.fileName}`}),t=new pr([e]);return new Rr(t,r)}return r}}ps.minPageSize=10,ps.maxPageSize=1e3;const vs=ps;var bs=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::plex");const gs={view:"details",fields:["Index","Artist","Title","Duration","PlayCount","Rate"]},ys={view:"details",fields:["Index","Artist","Title","Album","Track","Duration","PlayCount","Rate"]},ws={id:"plex/video",title:"Music Video",icon:"video",itemType:Kn.Media,searchable:!0,defaultHidden:!0,layout:{view:"details",fields:["Index","Artist","Title","Duration","PlayCount"]},search:({q:e=""}={})=>new vs(`/library/sections/${es.libraryId}/extras/all`,{title:e,type:"8",extraType:"4"})},Es={id:"plex/recently-played",title:"Recently Played",icon:"clock",itemType:Kn.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search:()=>new vs(`/library/sections/${es.libraryId}/all`,{type:"10","lastViewedAt>":"0",sort:"lastViewedAt:desc"})},xs={id:"plex/most-played",title:"Most Played",icon:"most-played",itemType:Kn.Media,layout:{view:"details",fields:["PlayCount","Artist","Title","Album","Track","Duration","Rate"]},search:()=>new vs(`/library/sections/${es.libraryId}/all`,{type:"10","viewCount>":"1",sort:"viewCount:desc,lastViewedAt:desc"})},ks={id:"plex/top-tracks",title:"Top Tracks",icon:"star",itemType:Kn.Media,viewType:qn.Ratings,layout:{view:"details",fields:["Rate","Artist","Title","Album","Track","Duration","PlayCount"]},search:()=>new vs(`/library/sections/${es.libraryId}/all`,{type:"10","track.userRating>":"1",sort:"track.userRating:desc,viewCount:desc,lastViewedAt:desc"})},Ss={id:"plex/top-albums",title:"Top Albums",icon:"star",itemType:Kn.Album,viewType:qn.Ratings,layout:{view:"card compact",fields:["Thumbnail","Title","Artist","Year","Rate"]},secondaryLayout:gs,search:()=>new vs(`/library/sections/${es.libraryId}/all`,{type:"9","album.userRating>":"1",sort:"album.userRating:desc,viewCount:desc,lastViewedAt:desc"})},Cs={id:"plex/top-artists",title:"Top Artists",icon:"star",itemType:Kn.Artist,viewType:qn.Ratings,defaultHidden:!0,layout:{view:"card compact",fields:["Thumbnail","Title","Genre","Rate"]},tertiaryLayout:gs,search:()=>new vs(`/library/sections/${es.libraryId}/all`,{type:"8","artist.userRating>":"1",sort:"artist.userRating:desc,viewCount:desc,lastViewedAt:desc"})},Ts={id:"plex/playlists",title:"Playlists",icon:"playlist",itemType:Kn.Playlist,secondaryLayout:ys,search:()=>new vs("/playlists/all",{type:"15",playlistType:"audio"})},Ps={id:"plex/folders",title:"Folders",icon:"folder",itemType:Kn.Folder,defaultHidden:!0,search({key:e=`library/sections/${es.libraryId}/folder`}={}){const t={itemType:Kn.Folder,src:"",title:"Folders",fileName:"",path:""};return t.pager=new vs(e,{includeCollections:"1"},void 0,t),t.pager}},As={id:"plex",name:"Plex",icon:"plex",url:"https://www.plex.tv",roots:[Ms(Kn.Media,{title:"Songs",layout:{view:"details",fields:["Artist","Title","Album","Track","Duration","PlayCount","Rate"]}}),Ms(Kn.Album,{title:"Albums"}),Ms(Kn.Artist,{title:"Artists"}),Ms(Kn.Playlist,{title:"Playlists",secondaryLayout:ys})],sources:[ks,Ss,Cs,xs,Es,Ts,ws,Ps],canRate:Os,canStore:()=>!1,compareForRating:function(e,t){return e.plex.ratingKey===t.plex.ratingKey},createSourceFromPin:function(e){return{title:e.title,itemType:Kn.Playlist,id:e.src,icon:"pin",isPin:!0,search:()=>new vs(`/playlists/${e.plex.ratingKey}`,{type:"15",playlistType:"audio"})}},getMetadata:function(e){return bs(this,void 0,void 0,(function*(){if(!Os(e)||void 0!==e.rating)return e;const t=mr.get(e);if(void 0!==t)return Object.assign(Object.assign({},e),{rating:t});const n=e.itemType===Kn.Playlist?`/playlists/${e.plex.ratingKey}`:`/library/metadata/${e.plex.ratingKey}`,r=new vs(n,void 0,{pageSize:1,maxSize:1}),i=yield fr(r,{timeout:2e3});return x(e,i[0])}))},lookup:function(e,t,n=10,r){return bs(this,void 0,void 0,(function*(){if(!e||!t)return[];const i={pageSize:n,maxSize:n,lookup:!0},a=e=>bs(this,void 0,void 0,(function*(){return fr(Ns(Kn.Media,t,e,i),{timeout:r})}));return h((yield Promise.all([a({"artist.title":e}),a({originalTitle:e})])).flat(),"src")}))},rate:function(e,t){return bs(this,void 0,void 0,(function*(){yield as.fetch({path:"/:/rate",method:"PUT",params:{key:e.plex.ratingKey,identifier:"com.plexapp.plugins.library",rating:t||-1}})}))},observeIsLoggedIn:hs,isLoggedIn:ms,login:function(){return os(this,void 0,void 0,(function*(){if(!ms())try{const{id:e,authToken:t}=yield function(){return os(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{const n=location.hostname,r=("localhost"===n?`http://${n}:${location.port}`:`https://${n}`)+"/auth/plex/callback/";let i=null;const a=n=>{if(/(localhost|ampcast)/.test(n.origin)){if(clearInterval(s),window.removeEventListener("message",a,!1),null==i||i.close(),i=null,n.origin!==location.origin)return void t({message:`Origin ${n.origin} does not match ${location.origin}`});let r=10;const o=()=>os(this,void 0,void 0,(function*(){r--;try{const{authToken:n,id:i}=yield as.fetchJSON({host:ls,path:`/pins/${ds.id}`});n?e({id:i,authToken:n}):r?setTimeout(o,200):t("Timeout.")}catch(e){t(e)}}));o()}};window.addEventListener("message",a,!1);const o=`clientID=${es.clientId}&code=${ds.code}&forwardUrl=${encodeURIComponent(r)}&context%5Bdevice%5D%5Bproduct%5D=ampcast`;i=window.open(`https://app.plex.tv/auth#?${o}`,"Plex","popup");const s=setInterval((()=>{(null==i?void 0:i.closed)&&(clearInterval(s),t({message:"access_denied"}))}),500)}))}))}();es.userId=e,fs(t)}catch(e){ss.log("Could not obtain access token."),ss.error(e)}}))},logout:function(){return os(this,void 0,void 0,(function*(){us.next(!1),fs(""),es.clear()}))}},Is=As;function Os(e,t){if(t)return!1;switch(e.itemType){case Kn.Album:return!e.synthetic;case Kn.Artist:return!0;case Kn.Media:return e.mediaType===jr.Audio;default:return!1}}function Ms(e,t){return Object.assign(Object.assign({},t),{itemType:e,id:`plex/search/${t.title.toLowerCase()}`,icon:"search",searchable:!0,search:({q:t=""}={})=>Ns(e,t)})}function Ns(e,t,n,r){if(t){const i=e===Kn.Playlist?"/playlists/all":`/library/sections/${es.libraryId}/all`,a=Object.assign(Object.assign({},n),{title:t,sort:"titleSort:asc"});switch(e){case Kn.Media:a.type="10";break;case Kn.Album:a.type="9";break;case Kn.Artist:a.type="8";break;case Kn.Playlist:a.playlistType="audio",a.type="15"}return new vs(i,a,r)}return new pr}function $s(e){return Oe((function(t,n){var r=!1,i=0;t.subscribe(Me(n,(function(t){return(r||(r=!e(t,i++)))&&n.next(t)})))}))}mr.addObserver(As);var zs=n(5754),js=n.n(zs),Ls=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::spotifyAuth");const Rs=new A("spotifyAuth"),Ds=new z("spotify/auth"),_s=location.hostname,Fs=("localhost"===_s?`http://${_s}:${location.port}`:`https://${_s}`)+"/auth/spotify/callback/",Vs="https://accounts.spotify.com";let Us;const Bs=new Ie("");function Hs(){return Bs.pipe(tr())}function Ys(){return""!==Bs.getValue()}function Ks(){return Ls(this,void 0,void 0,(function*(){Rs.log("refreshToken");const e=qs(),t=null==e?void 0:e.refresh_token;if(t){const e=yield fetch(`${Vs}/api/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({client_id:yr,grant_type:"refresh_token",refresh_token:t})});if(!e.ok)throw Qs(),e;const n=yield e.json();return Ws(n),n.access_token}throw Qs(),Error("No 'refresh_token'")}))}function Ws(e){const{access_token:t,refresh_token:n,expires_in:r}=e,i=new Date,a=new Date(i.setSeconds(i.getSeconds()+r)).toISOString();Ds.setJson("token",{access_token:t,refresh_token:n,expires_at:a}),Js(t)}function qs(){const e=Ds.getJson("token");return e&&(e.expires_at=new Date(e.expires_at)),e}function Js(e){Rs.log("Access token successfully obtained."),Bs.next(e)}function Qs(){Ds.removeItem("token"),Bs.next("")}function Gs(){return Ls(this,void 0,void 0,(function*(){const e=function(e){let t="";for(let e=0;e<64;e++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t}();Ds.setString("code_verifier",e),Us=yield function(e){return Ls(this,void 0,void 0,(function*(){const t=yield crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}))}(e)}))}!function(){Ls(this,void 0,void 0,(function*(){try{const e=qs();if(e)return void(e.expires_at.getTime()-Date.now()<=0?yield Ks():Js(e.access_token))}catch(e){Rs.error(e),Qs()}yield Gs()}))}();var Xs=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const Zs=new A("SpotifyPager");class el{constructor(e,t,n){this.defaultConfig={minPageSize:el.minPageSize,maxPageSize:el.maxPageSize,pageSize:el.maxPageSize},this.pageNumber=1,this.config=Object.assign(Object.assign({},this.defaultConfig),t),this.pager=new Hr(((t=this.defaultConfig.pageSize)=>Xs(this,void 0,void 0,(function*(){const r=(this.pageNumber-1)*t,i=()=>Xs(this,void 0,void 0,(function*(){const{items:i,total:a,next:o}=yield e(r,t);return this.pageNumber++,{items:i.map((e=>this.createMediaObject(e,n))),total:a,atEnd:!o}}));try{return yield i()}catch(e){if(401===e.status)return yield Ks(),yield i();throw e}}))),this.config)}get maxSize(){return this.pager.maxSize}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){var e;this.pager.disconnect(),null===(e=this.subscriptions)||void 0===e||e.unsubscribe()}fetchAt(e,t){this.subscriptions||this.connect(),this.pager.fetchAt(e,t)}connect(){this.subscriptions||(this.subscriptions=new ne,this.config.lookup||this.subscriptions.add(this.pager.observeAdditions().pipe(Zt((e=>this.addInLibrary(e)))).subscribe(Zs)))}createMediaObject(e,t){switch(e.type){case"episode":return this.createMediaItemFromEpisode(e);case"artist":return this.createMediaArtist(e);case"album":return this.createMediaAlbum(e,t);case"playlist":return this.createMediaPlaylist(e,t);case"track":return this.createMediaItemFromTrack(e,t)}}createMediaItemFromEpisode(e){return{itemType:Kn.Media,mediaType:jr.Audio,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,duration:e.duration_ms/1e3,thumbnails:e.images,unplayable:!1===e.is_playable,playedAt:e.played_at?Math.floor((new Date(e.played_at).getTime()||0)/1e3):0}}createMediaAlbum(e,t){var n;return{itemType:Kn.Album,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,artist:e.artists.map((e=>e.name)).join(", "),year:new Date(e.release_date).getFullYear(),thumbnails:e.images,trackCount:null===(n=e.tracks)||void 0===n?void 0:n.total,pager:this.createAlbumPager(e),inLibrary:sr.get(e.uri,t)}}createMediaArtist(e){return{itemType:Kn.Artist,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,genres:e.genres,thumbnails:e.images,pager:this.createArtistAlbumsPager(e)}}createArtistTopTracks(e){return{itemType:Kn.Album,src:`spotify:top-tracks:${e.id}`,title:"Top Tracks",artist:e.name,thumbnails:e.images,pager:this.createTopTracksPager(e),synthetic:!0}}createMediaPlaylist(e,t){const n=e.owner.id===il.getString("userId");return{itemType:Kn.Playlist,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,description:e.description?T(e.description):void 0,thumbnails:e.images,trackCount:e.tracks.total,pager:this.createPlaylistPager(e),owner:{name:e.owner.display_name||"",url:e.owner.external_urls.spotify},isPinned:Qr.isPinned(e.uri),isOwn:n,inLibrary:!n&&sr.get(e.uri,t)}}createMediaItemFromTrack(e,t){var n,r,i,a,o;const s=/album|compilation/i.test((null===(n=e.album)||void 0===n?void 0:n.album_type)||"")?e.album:void 0;return{itemType:Kn.Media,mediaType:jr.Audio,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,artists:null===(r=e.artists)||void 0===r?void 0:r.map((e=>e.name)),albumArtist:null==s?void 0:s.artists.map((e=>e.name)).join(", "),album:null==s?void 0:s.name,duration:e.duration_ms/1e3,playedAt:e.played_at?Math.floor((new Date(e.played_at).getTime()||0)/1e3):0,genres:null===(i=e.album)||void 0===i?void 0:i.genres,disc:s?e.disc_number:void 0,track:s?e.track_number:void 0,year:e.album&&new Date(e.album.release_date).getUTCFullYear()||void 0,isrc:null===(a=e.external_ids)||void 0===a?void 0:a.isrc,thumbnails:null===(o=e.album)||void 0===o?void 0:o.images,unplayable:!1===e.is_playable,inLibrary:sr.get(e.uri,t)}}createArtistAlbumsPager(e){const t=this.getMarket(),n=this.createArtistTopTracks(e),r=new Yr((()=>[n])),i=new el(((n,r)=>Xs(this,void 0,void 0,(function*(){const{items:i,total:a,next:o}=yield al.getArtistAlbums(e.id,{offset:n,limit:r,market:t,include_groups:"album,compilation,single"});return{items:i,total:a,next:o}}))));return r.fetchAt(0),new Rr(r,i)}createTopTracksPager(e){const t=this.getMarket();return new el(((n,r)=>Xs(this,void 0,void 0,(function*(){const{tracks:i}=yield al.getArtistTopTracks(e.id,t,{offset:n,limit:r,market:t});return{items:i,next:""}}))))}createAlbumPager(e){var t;const n=null===(t=e.tracks)||void 0===t?void 0:t.items;if(n&&n.length===e.total_tracks)return new Yr((()=>{const t=n.map((t=>this.createMediaItemFromTrack(Object.assign(Object.assign({},t),{album:e}))));return this.addInLibrary(t),t}));{const t=this.getMarket();return new el(((n,r)=>Xs(this,void 0,void 0,(function*(){const{items:i,total:a,next:o}=yield al.getAlbumTracks(e.id,{offset:n,limit:r,market:t});return{items:i.map((t=>Object.assign(Object.assign({},t),{album:e}))),total:a,next:o}}))))}}createPlaylistPager(e){var t;const n=null===(t=e.tracks)||void 0===t?void 0:t.items;if(n&&n.length===e.tracks.total)return new Yr((()=>{const e=n.filter((e=>!!e.track)).map((e=>this.createMediaItemFromTrack(e.track)));return this.addInLibrary(e),e}));{const t=this.getMarket();return new el(((n,r)=>Xs(this,void 0,void 0,(function*(){const{items:i,total:a,next:o}=yield al.getPlaylistTracks(e.id,{offset:n,limit:r,market:t});return{items:i.map((e=>e.track)).filter(l),total:a,next:o}}))))}}getMarket(){return il.getString("market")}addInLibrary(e){return Xs(this,void 0,void 0,(function*(){const t=e[0];if(t){const n=e.filter((e=>void 0===e.inLibrary&&vl.canStore(e,!0))).map((e=>{const[,,t]=e.src.split(":");return t}));if(0===n.length)return;let r=[];r=t.itemType===Kn.Album?yield al.containsMySavedAlbums(n):yield al.containsMySavedTracks(n),ir.dispatch(e.map((({src:e},t)=>({match:t=>t.src===e,values:{inLibrary:r[t]}}))))}}))}}el.minPageSize=10,el.maxPageSize=50;const tl=el;var nl=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::spotify");const rl=new A("spotify"),il=new z("spotify"),al=new(js()),ol={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","Duration"]},sl={view:"details",fields:["Index","Artist","Title","Album","Track","Duration"]},ll={id:"spotify/recently-played",title:"Recently Played",icon:"clock",itemType:Kn.Media,defaultHidden:!0,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search(){return new tl(((e,t)=>nl(this,void 0,void 0,(function*(){const{items:e,total:n}=yield al.getMyRecentlyPlayedTracks({limit:t});return{items:e.map((e=>Object.assign({played_at:e.played_at},e.track))),total:n,next:void 0}}))),{maxSize:50,pageSize:50})}},cl={id:"spotify/top-tracks",title:"Top Tracks",icon:"star",itemType:Kn.Media,layout:ol,search(){return new tl(((e,t)=>nl(this,void 0,void 0,(function*(){return al.getMyTopTracks({offset:e,limit:t})}))))}},ul={id:"spotify/top-artists",title:"Top Artists",icon:"star",itemType:Kn.Artist,defaultHidden:!0,search(){return new tl(((e,t)=>nl(this,void 0,void 0,(function*(){return al.getMyTopArtists({offset:e,limit:t})}))))}},dl={id:"spotify/liked-songs",title:"My Songs",icon:"heart",itemType:Kn.Media,viewType:qn.Library,layout:ol,search(){const e=El();return new tl(((t,n)=>nl(this,void 0,void 0,(function*(){const{items:r,total:i,next:a}=yield al.getMySavedTracks({offset:t,limit:n,market:e});return{items:r.map((e=>e.track)),total:i,next:a}}))),void 0,!0)}},ml={id:"spotify/liked-albums",title:"My Albums",icon:"heart",itemType:Kn.Album,viewType:qn.Library,search(){const e=El();return new tl(((t,n)=>nl(this,void 0,void 0,(function*(){const{items:r,total:i,next:a}=yield al.getMySavedAlbums({offset:t,limit:n,market:e});return{items:r.map((e=>e.album)),total:i,next:a}}))),{calculatePageSize:!0},!0)}},hl={id:"spotify/playlists",title:"Playlists",icon:"playlist",itemType:Kn.Playlist,viewType:qn.Library,secondaryLayout:sl,search(){const e=El();return new tl(((t,n)=>nl(this,void 0,void 0,(function*(){const{items:r,total:i,next:a}=yield al.getUserPlaylists(void 0,{offset:t,limit:n,market:e});return{items:r,total:i,next:a}}))),void 0,!0)}},fl={id:"spotify/featured-playlists",title:"Featured Playlists",icon:"playlist",itemType:Kn.Playlist,defaultHidden:!0,secondaryLayout:sl,search(){const e=El();return new tl(((t,n)=>nl(this,void 0,void 0,(function*(){const{playlists:{items:r,total:i,next:a}}=yield al.getFeaturedPlaylists({offset:t,limit:n,market:e});return{items:r,total:i,next:a}}))))}},pl={id:"spotify",name:"Spotify",icon:"spotify",url:"https://www.spotify.com",roots:[yl(Kn.Media,{title:"Songs",layout:ol}),yl(Kn.Album,{title:"Albums"}),yl(Kn.Artist,{title:"Artists"}),yl(Kn.Playlist,{title:"Playlists",secondaryLayout:sl})],sources:[dl,ml,ll,cl,ul,hl,fl],icons:{[Hn.AddToLibrary]:"heart",[Hn.RemoveFromLibrary]:"heart-fill"},labels:{[Hn.AddToLibrary]:"Add to Spotify Library",[Hn.RemoveFromLibrary]:"Remove from Spotify Library"},canRate:()=>!1,canStore:bl,compareForRating:function(e,t){return e.src===t.src},createSourceFromPin:function(e){return{title:e.title,itemType:Kn.Playlist,id:e.src,icon:"pin",isPin:!0,search(){const[,,t]=e.src.split(":"),n=El();return new tl((()=>nl(this,void 0,void 0,(function*(){return{items:[yield al.getPlaylist(t,{market:n,fields:"id,type,external_urls,name,description,images,owner,uri,tracks.total"})],total:1}}))))}}},getMetadata:function(e){return nl(this,void 0,void 0,(function*(){if(!bl(e)||void 0!==e.inLibrary)return e;const t=sr.get(e.src);if(void 0!==t)return Object.assign(Object.assign({},e),{inLibrary:t});const[,,n]=e.src.split(":");switch(e.itemType){case Kn.Album:{const[t]=yield al.containsMySavedAlbums([n]);return Object.assign(Object.assign({},e),{inLibrary:t})}case Kn.Media:{const[t]=yield al.containsMySavedTracks([n]);return Object.assign(Object.assign({},e),{inLibrary:t})}case Kn.Playlist:{const[t]=yield al.areFollowingPlaylist(n,[il.getString("userId")]);return Object.assign(Object.assign({},e),{inLibrary:t})}default:return e}}))},lookup:function(e,t,n=10,r){return nl(this,void 0,void 0,(function*(){if(!e||!t)return[];const i=e=>e.replace(/['"]/g," "),a={pageSize:n,maxSize:n,lookup:!0};return fr(wl(Kn.Media,`${i(e)} ${i(t)}`,a),{timeout:r})}))},store:function(e,t){return nl(this,void 0,void 0,(function*(){return gl([e],t)}))},observeIsLoggedIn:function(){return Hs().pipe(Gt((e=>""!==e)),tr())},isLoggedIn:Ys,login:function(){return Ls(this,void 0,void 0,(function*(){if(!Ys()){Rs.log("login");try{Ws(yield function(){return Ls(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{let n=null;const r=i=>{if(/(localhost|ampcast)/.test(i.origin)){if(clearInterval(a),window.removeEventListener("message",r,!1),null==n||n.close(),n=null,i.origin!==location.origin)return void t({message:`Origin ${i.origin} does not match ${location.origin}`});(function(e){return Ls(this,void 0,void 0,(function*(){const t=Ds.getString("code_verifier"),n=yield fetch(`${Vs}/api/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({client_id:yr,grant_type:"authorization_code",code:e,redirect_uri:Fs,code_verifier:t})});if(!n.ok)throw n;return yield n.json()}))})(i.data.code).then(e,t)}};window.addEventListener("message",r,!1);const i=new URLSearchParams({client_id:yr,scope:["user-read-recently-played","user-read-playback-position","user-top-read","user-read-playback-state","user-modify-playback-state","user-read-currently-playing","streaming","user-read-email","user-read-private","playlist-read-private","playlist-modify-private","playlist-modify-public","user-library-read","user-library-modify"].join(" "),redirect_uri:Fs,response_type:"code",code_challenge_method:"S256",code_challenge:Us});n=window.open(`${Vs}/authorize?${i}`,"Spotify","popup");const a=setInterval((()=>{(null==n?void 0:n.closed)&&(clearInterval(a),t({message:"access_denied"}))}),500)}))}))}())}catch(e){Rs.log("Could not obtain access token."),Rs.error(e)}}}))},logout:function(){return Ls(this,void 0,void 0,(function*(){Rs.log("logout"),Qs(),yield Gs()}))}},vl=pl;function bl(e,t){switch(e.itemType){case Kn.Album:return!e.synthetic;case Kn.Media:return!0;case Kn.Playlist:return!e.isOwn&&!t;default:return!1}}function gl(e,t){return nl(this,void 0,void 0,(function*(){const n=e[0];if(!n)return;const r=e.map((e=>{const[,,t]=e.src.split(":");return t})),i=()=>nl(this,void 0,void 0,(function*(){switch(n.itemType){case Kn.Album:t?yield Promise.all(u(r,20).map((e=>al.addToMySavedAlbums(e)))):yield Promise.all(u(r,20).map((e=>al.removeFromMySavedAlbums(e))));break;case Kn.Media:t?yield Promise.all(u(r,50).map((e=>al.addToMySavedTracks(e)))):yield Promise.all(u(r,50).map((e=>al.removeFromMySavedTracks(e))));break;case Kn.Playlist:t?yield Promise.all(r.map((e=>al.followPlaylist(e)))):yield Promise.all(r.map((e=>al.unfollowPlaylist(e))))}}));try{yield i()}catch(e){if(401!==e.status)throw e;yield Ks(),yield i()}}))}function yl(e,t){return Object.assign(Object.assign({},t),{itemType:e,id:`spotify/search/${t.title.toLowerCase()}`,icon:"search",searchable:!0,search:({q:t=""}={})=>wl(e,t)})}function wl(e,t,n){return t?new tl(function(e,t){const n=El();switch(e){case Kn.Media:return(e,r)=>nl(this,void 0,void 0,(function*(){const{tracks:{items:i,total:a,next:o}}=yield al.searchTracks(t,{offset:e,limit:r,market:n});return{items:i,total:a,next:o}}));case Kn.Album:return(e,r)=>nl(this,void 0,void 0,(function*(){const{albums:{items:i,total:a,next:o}}=yield al.searchAlbums(t,{offset:e,limit:r,market:n});return{items:i,total:a,next:o}}));case Kn.Artist:return(e,r)=>nl(this,void 0,void 0,(function*(){const{artists:{items:i,total:a,next:o}}=yield al.searchArtists(t,{offset:e,limit:r,market:n});return{items:i,total:a,next:o}}));case Kn.Playlist:return(e,r)=>nl(this,void 0,void 0,(function*(){const{playlists:{items:i,total:a,next:o}}=yield al.searchPlaylists(t,{offset:e,limit:r,market:n});return{items:i,total:a,next:o}}));default:throw TypeError("Fetch not supported for this type of media.")}}(e,t),Object.assign({maxSize:250},n)):new pr}function El(){return il.getString("market")}function xl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=dn(e);return Oe((function(t,r){for(var i=e.length,a=new Array(i),o=e.map((function(){return!1})),s=!1,l=function(t){Jt(e[t]).subscribe(Me(r,(function(e){a[t]=e,s||o[t]||(o[t]=!0,(s=o.every(ke))&&(o=null))}),ce))},c=0;c<i;c++)l(c);t.subscribe(Me(r,(function(e){if(s){var t=Q([e],J(a));r.next(n?n.apply(void 0,Q([],J(t))):t)}})))}))}function kl(e){return ze((function(t,n){return e<=n}))}function Sl(e,t){return t?function(n){return gn(t.pipe(hr(1),Oe((function(e,t){e.subscribe(Me(t,ce))}))),n.pipe(Sl(e)))}:Zt((function(t,n){return Jt(e(t,n)).pipe(hr(1),function(e){return Gt((function(){return e}))}(t))}))}function Cl(e,t){void 0===t&&(t=zt);var n=Rt(e,t);return Sl((function(){return n}))}Hs().subscribe((e=>al.setAccessToken(e))),El()||Hs().pipe($s((e=>!e)),Zt((()=>al.getMe())),$e((e=>{il.setString("userId",e.id),il.setString("market",e.country)})),hr(1)).subscribe(rl),sr.observeRemovals("spotify").pipe(Gt((e=>{var t;switch(null===(t=e[0])||void 0===t?void 0:t.itemType){case Kn.Media:return e.slice(0,500);case Kn.Album:return e.slice(0,200);case Kn.Playlist:return e.slice(0,10);default:return[]}})),ze((e=>e.length>0)),lr((e=>gl(e,!1).then((()=>e)))),lr((e=>sr.applyRemovals(e))),cr((e=>(rl.error(e),[])))).subscribe(rl);var Tl,Pl,Al,Il=Z((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})),Ol=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))},Ml=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},Nl=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};const $l=new A("SpotifyPlayer"),zl="Spotify player not connected.",jl=(e,t)=>e.paused===t.paused&&e.position===t.position;Tl=new WeakMap,Pl=new WeakMap,Al=new WeakMap;const Ll=new class{constructor(e){this.accessToken$=e,this.player=null,this.paused$=new Ie(!0),this.src$=new Ie(""),this.currentTrackSrc$=new Ie(""),this.error$=new Pe,this.playerReady$=new Ie(!1),this.playerStarted$=new Ie(!1),this.state$=new Ie(null),this.loadedSrc="",this.isLoggedIn=!1,this.deviceId="",this.hidden=!0,this.loop=!1,Tl.set(this,!1),Pl.set(this,!0),Al.set(this,1),this.onSpotifyWebPlaybackSDKReady=()=>{$l.log("onSpotifyWebPlaybackSDKReady"),this.observeAccessToken().pipe(ze((e=>""!==e)),Zt((e=>this.connect(e))),$e((()=>this.playerReady$.next(!0))),hr(1)).subscribe($l)},window.onSpotifyWebPlaybackSDKReady=this.onSpotifyWebPlaybackSDKReady,this.observeReady().pipe($e((()=>this.player.activateElement())),hr(1)).subscribe($l),this.observeReady().pipe(yn((()=>this.observeIsLoggedIn())),yn((e=>e?this.observePaused():cn)),yn((e=>e?cn:this.observeSrc())),xl(this.observeAccessToken()),yn((([e,t])=>e&&e!==this.loadedSrc?Pn(void 0).pipe(yn((()=>this.loadError?this.reconnect(t):Pn(void 0))),Zt((()=>this.addToQueue(e,t))),cr((t=>(this.loadedSrc="",this.loadError={src:e,error:t},this.error$.next(t),this.currentTrackSrc$.next(""),cn))),hr(1)):cn))).subscribe($l),this.observeSrc().subscribe((()=>this.currentTrackSrc$.next(""))),this.observeState().pipe($e((e=>{var t,n;const r=null===(n=null===(t=e.track_window)||void 0===t?void 0:t.current_track)||void 0===n?void 0:n.uri;r&&this.loadedSrc===this.src&&this.currentTrackSrc!==r&&this.currentTrackSrc$.next(r)}))).subscribe($l),this.currentTrackSrc$.pipe(ze((e=>!!e)),yn((()=>this.observeCurrentTrackState().pipe(kl(2),Zt((e=>!e.paused&&this.paused?this.safePause():Pn(void 0))),hr(1))))).subscribe($l),this.observeIsLoggedIn().pipe($s((e=>e===this.isLoggedIn)),$e((e=>{this.isLoggedIn=e,e||this.paused||this.error$.next(Error(zl))}))).subscribe($l),this.observeError().subscribe($l.error),c("https://sdk.scdn.co/spotify-player.js")}get autoplay(){return Ml(this,Tl,"f")}set autoplay(e){Ml(this,Tl,"f")!==e&&(Nl(this,Tl,e,"f"),e&&this.playerStarted$.next(!0))}get muted(){return Ml(this,Pl,"f")}set muted(e){Ml(this,Pl,"f")!==e&&(Nl(this,Pl,e,"f"),this.safeVolume(e?0:this.volume))}get volume(){return Ml(this,Al,"f")}set volume(e){Ml(this,Al,"f")!==e&&(Nl(this,Al,e,"f"),this.safeVolume(this.muted?0:e))}observeCurrentTime(){return bn(this.observeCurrentTrackState(),this.observePaused().pipe(yn((e=>e?this.getCurrentState():Dt(250).pipe(Zt((()=>this.getCurrentState()))))))).pipe(Gt((e=>{var t,n;return(null===(n=null===(t=null==e?void 0:e.track_window)||void 0===t?void 0:t.current_track)||void 0===n?void 0:n.uri)===this.currentTrackSrc?e.position/1e3:0})),tr())}observeDuration(){return this.observeCurrentTrackState().pipe(Gt((e=>e.duration/1e3)),tr())}observeEnded(){return this.observePlaying().pipe(yn((()=>this.observeCurrentTrackState())),tr(jl),xl(this.observePaused()),Gt((([e,t])=>!t&&e.paused&&0===e.position)),ze((e=>e)),Gt((()=>{})))}observeError(){return this.error$}observePlaying(){return this.observeCurrentTrackState().pipe(tr(jl),xl(this.observePaused()),Gt((([e,t])=>!t&&!e.paused)),tr(),ze((e=>e)),Gt((()=>{})))}observeCurrentTrackState(){return this.observeState().pipe(ze((e=>{var t,n;return(null===(n=null===(t=e.track_window)||void 0===t?void 0:t.current_track)||void 0===n?void 0:n.uri)===this.currentTrackSrc})))}appendTo(){}load(e){$l.log("load",{src:e}),this.src$.next(e),this.autoplay&&this.paused$.next(!1),this.player&&this.isLoggedIn?this.autoplay&&e===this.loadedSrc&&this.safePlay():this.autoplay&&this.error$.next(Error(zl))}play(){var e;$l.log("play"),this.paused$.next(!1),this.player&&this.isLoggedIn?this.src===(null===(e=this.loadError)||void 0===e?void 0:e.src)?this.error$.next(this.loadError.error):this.src===this.loadedSrc&&this.safePlay():this.error$.next(Error(zl))}pause(){$l.log("pause"),this.paused$.next(!0),this.safePause()}stop(){$l.log("stop"),this.paused$.next(!0),this.safeStop()}seek(e){var t;null===(t=this.player)||void 0===t||t.seek(1e3*e)}resize(){}getCurrentState(){var e;return Ol(this,void 0,void 0,(function*(){return(null===(e=this.player)||void 0===e?void 0:e.getCurrentState())||null}))}get paused(){return this.paused$.getValue()}get src(){return this.src$.getValue()}get currentTrackSrc(){return this.currentTrackSrc$.getValue()}observeAccessToken(){return this.accessToken$}observeIsLoggedIn(){return this.observeAccessToken().pipe(Gt((e=>!!e)),tr())}observePaused(){return this.paused$.pipe(tr())}observeReady(){return Zn([this.playerReady$,this.playerStarted$]).pipe(ze((([e,t])=>e&&t)),Gt((()=>{})),hr(1))}observeSrc(){return this.src$.pipe(tr())}observeState(){return this.state$.pipe(ze(l))}addToQueue(e,t,n=3){return Ol(this,void 0,void 0,(function*(){if(!t)throw Error(zl);const r=yield fetch(`https://api.spotify.com/v1/me/player/play?device_id=${this.deviceId}`,{method:"PUT",body:JSON.stringify({uris:[e],position_ms:0}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!r.ok){if(n>0)switch(r.status){case 401:{const t=yield Ks();return this.addToQueue(e,t,--n)}case 404:case 502:case 503:return yield this.reconnect(t),this.addToQueue(e,t,--n)}throw r}this.loadError=void 0,this.loadedSrc=e}))}connect(e){return Ol(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{let r=!1;const i=new Spotify.Player({name:"ampcast",getOAuthToken:t=>Ol(this,void 0,void 0,(function*(){r&&(e=yield Ks()),r=!0,t(e)})),volume:this.muted?0:this.volume});i.addListener("initialization_error",n),i.addListener("authentication_error",n),i.addListener("account_error",n),i.addListener("playback_error",(e=>this.error$.next(e))),i.addListener("player_state_changed",(e=>this.state$.next(e))),i.addListener("not_ready",(()=>{$l.log("not_ready"),this.deviceId="",n("not_ready")})),i.addListener("ready",(({device_id:e})=>{$l.log("ready"),this.player=i,this.deviceId=e,t(i)})),i.connect()}))}))}disconnect(){return Ol(this,void 0,void 0,(function*(){this.loadedSrc="",this.currentTrackSrc$.next(""),this.loadError=void 0;const e=this.player;e&&(e.removeListener("initialization_error"),e.removeListener("authentication_error"),e.removeListener("account_error"),e.removeListener("playback_error"),e.removeListener("player_state_changed"),e.removeListener("not_ready"),e.removeListener("ready"),yield this.safePause(),e.disconnect())}))}reconnect(e){return Ol(this,void 0,void 0,(function*(){return $l.log("reconnect"),t=vn(this.disconnect()).pipe(Cl(1e3),Zt((()=>this.connect(e))),Cl(3e3),Gt((()=>{}))),new Promise((function(e,n){var r=new ge({next:function(t){e(t),r.unsubscribe()},error:n,complete:function(){n(new Il)}});t.subscribe(r)}));var t}))}safePause(){return Ol(this,void 0,void 0,(function*(){try{this.player&&this.loadedSrc&&(yield this.player.pause())}catch(e){$l.error(e)}}))}safePlay(){return Ol(this,void 0,void 0,(function*(){try{this.player&&this.loadedSrc&&(yield this.player.resume())}catch(e){this.error$.next(e)}}))}safeStop(){return Ol(this,void 0,void 0,(function*(){try{if(this.player&&this.loadedSrc){yield this.player.pause();const e=yield this.getCurrentState();(null==e?void 0:e.position)&&(yield this.player.seek(0))}}catch(e){$l.error(e)}}))}safeVolume(e){var t;return Ol(this,void 0,void 0,(function*(){try{yield null===(t=this.player)||void 0===t?void 0:t.setVolume(e)}catch(e){$l.error(e)}}))}}(Hs());function Rl(){return[ui,vl,No,Is,ua,_a,Qo]}function Dl(){return Rl().filter((e=>!!e.lookup))}function _l(e){return Rl().find((t=>t.id===e))}function Fl(e){if(e){const[t,n,r]=e.split(":");return"blob"===t||"file"===t||!!r&&!!n&&function(e){const t=_l(e);return!!t&&!t.isScrobbler}(t)}return!1}function Vl(e){return!!e&&Fl(e.src)}const Ul=new z("services"),Bl=Ul.getJson("hidden",{}),Hl=new Ie(Bl);function Yl(e){return!function(e){var t;return null!==(t=Hl.getValue()[e.id])&&void 0!==t?t:!!e.defaultHidden}(e)}function Kl(e){const t=Hl.getValue(),n=Object.assign(Object.assign({},t),e);Ul.setJson("hidden",n),Hl.next(n)}var Wl=n(7068);function ql({service:e}){return r.createElement("p",null,r.createElement("button",{className:"branded login",onClick:e.login},"Log in to ",e.name))}function Jl({service:e}){return r.createElement("p",{className:"service-link"},r.createElement(xi,{name:e.icon}),r.createElement(Ja,{href:e.url}))}function Ql({service:e}){return r.createElement("div",{className:"panel"},r.createElement("div",{className:"page login"},r.createElement("p",null,"You need to be logged in to play music from ",e.name,"."),r.createElement(ql,{service:e}),r.createElement(Jl,{service:e})))}function Gl(){return(0,r.useEffect)((()=>{const e=new Pe,t=e.pipe(Zt((e=>Rt(e))),Zt((()=>function(){return os(this,void 0,void 0,(function*(){return ds=yield as.fetchJSON({host:ls,path:"/pins",method:"POST",params:{strong:"true"}}),ds}))}())),Gt((e=>1e3*e.expiresIn)),$e((t=>e.next(t)))).subscribe();return e.next(0),()=>t.unsubscribe()})),r.createElement(Ql,{service:Is})}function Xl({service:e}){return r.createElement("div",{className:"dev-mode note"},r.createElement("p",null,"This application is in ",r.createElement("strong",null,"development mode"),"."),r.createElement("p",null,"You currently need to be an approved user to access services from ",e.name,"."))}function Zl(){return r.createElement("div",{className:"panel"},r.createElement("div",{className:"page login"},r.createElement(Xl,{service:vl}),r.createElement("p",null,"You need to be logged in to play music from Spotify.*"),r.createElement(ql,{service:vl}),r.createElement("p",null,r.createElement("small",null,"*Spotify Premium required.")),r.createElement(Jl,{service:vl})))}function ec(e,t){return void 0===t&&(t=zt),Oe((function(n,r){var i=null,a=null,o=null,s=function(){if(i){i.unsubscribe(),i=null;var e=a;a=null,r.next(e)}};function l(){var n=o+e,a=t.now();if(a<n)return i=this.schedule(void 0,n-a),void r.add(i);s()}n.subscribe(Me(r,(function(n){a=n,o=t.now(),i||(i=t.schedule(l,e),r.add(i))}),(function(){s(),r.complete()}),void 0,(function(){a=i=null})))}))}function tc(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}function nc(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const r=tc(n);return(e,n)=>r.then((r=>n(r.transaction(t,e).objectStore(t))))}let rc;function ic(){return rc||(rc=nc("keyval-store","keyval")),rc}function ac(e,t=ic()){return t("readonly",(t=>tc(t.get(e))))}function oc(e,t,n=ic()){return n("readwrite",(n=>(n.put(t,e),tc(n.transaction))))}var sc;!function(e){e.Looking="looking",e.NotFound="not-found"}(sc||(sc={}));const lc=sc;var cc=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const uc=new A("file");function dc(e){var t,r,i;return cc(this,void 0,void 0,(function*(){const{parseBlob:a}=yield Promise.all([n.e(463),n.e(12)]).then(n.bind(n,2463));let o;try{o=yield a(e,{duration:!0,skipCovers:!0})}catch(t){uc.log(`Error parsing file: ${e.name}`),uc.error(t),o={format:{},common:{}}}const{common:s,format:l}=o,c=e.type.startsWith("video"),u=l.duration||(yield function(e){return cc(this,void 0,void 0,(function*(){return new Promise((t=>{const n=e.type.startsWith("video"),r=document.createElement(n?"video":"audio"),i=URL.createObjectURL(e),a=()=>{const e=r.error?0:r.duration;r.ondurationchange=null,r.onerror=null,r.src="",r.removeAttribute("src"),URL.revokeObjectURL(i),t(e)};r.ondurationchange=a,r.onerror=a,r.onended=a,r.muted=!0,r.src=i}))}))}(e)),d=(e=0)=>Math.floor(Number(e))||0;return{itemType:Kn.Media,mediaType:c?jr.Video:jr.Audio,src:`blob:${pi()}`,externalUrl:"",title:s.title||e.name.replace(/\.\w+$/,""),artists:s.artist?[s.artist]:s.artists,albumArtist:s.album&&s.albumartist||"",album:s.album||"",genres:s.genre,duration:u?Number(u.toFixed(3)):0,track:d(null===(t=s.track)||void 0===t?void 0:t.no),disc:d(null===(r=s.disk)||void 0===r?void 0:r.no),year:d(s.year),mood:s.mood||"",rating:Number(s.rating)||0,isrc:null===(i=s.isrc)||void 0===i?void 0:i[0],recording_mbid:s.musicbrainz_recordingid,playedAt:0,blob:e}}))}var mc=n(4909),hc=n.n(mc),fc=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module:localdb/listens");const pc=new A("localdb/listens"),vc=[],bc=new Ie(vc);class gc extends vt.ZP{constructor(){super("ampcast/listens"),this.version(1).stores({items:"&playedAt, src, lastfmScrobbledAt, listenbrainzScrobbledAt"})}}const yc=new gc;function wc(){return bc.pipe(ze((e=>e!==vc)))}function Ec(e){return fc(this,void 0,void 0,(function*(){try{e.length>0&&(yield yc.items.bulkPut(e))}catch(e){pc.error(e)}}))}function xc(e,t=30){return Math.round(e.playedAt/t)}function kc(e,t,n=5){const r=t.playedAt,i=r-n,a=r+t.duration+n;for(const n of e){if(n.playedAt<i)return;if(n.playedAt>i&&n.playedAt<a&&Cc(t,n,.75))return n}}function Sc(e,t){const n=bc.getValue();return function(e,t,n=5){const r=t.playedAt;if(r)for(let i=0;i<e.length;i++){const a=e[i-1];if(a&&a.playedAt<r)return;const o=e[i],s=o.playedAt-n,l=o.playedAt+o.duration+n;if(r>s&&r<l&&Cc(o,t,.75))return o}}(n,e,t)||function(e,t){return e.find((e=>t.src===e.src||t.externalUrl&&t.externalUrl===e.externalUrl||t.isrc&&t.isrc===e.isrc||t.recording_mbid&&t.recording_mbid===e.recording_mbid))}(n,e)||Bc(n,e)}function Cc(e,t,n){return S(e.title,t.title,n)}function Tc(e){return fc(this,void 0,void 0,(function*(){const t=`${e}ScrobbledAt`,n=Math.floor(Date.now()/1e3)-1209600,r=yield yc.items.where(t).equals(0).toArray();yield Ec(r.filter((e=>e.playedAt<n)).map((e=>Object.assign(Object.assign({},e),{[t]:-1}))))}))}fc(void 0,void 0,void 0,(function*(){try{yield Tc("lastfm"),yield Tc("listenbrainz")}catch(e){pc.error(e)}(0,vt.Y1)((()=>yc.items.orderBy("playedAt").reverse().toArray())).subscribe(bc)}));const Pc=new Pe,Ac=new Pe,Ic=new z("lookup"),Oc={get preferredService(){return Ic.getString("preferredService")},set preferredService(e){Ic.setString("preferredService",e)}},Mc=["rating","globalRating","playCount","globalPlayCount","inLibrary","lookupStatus"];function Nc(e){return Object.keys(e).reduce(((t,n)=>(void 0===e[n]||Mc.includes(n)||(t[n]=e[n]),t)),{})}var $c=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const zc=new A("lookupStore");class jc extends vt.ZP{constructor(){super("ampcast/lookup"),this.version(1).stores({items:"&[service+artist+title]"})}add(e,t,n,r){return $c(this,void 0,void 0,(function*(){try{e&&(zc.log("add",{service:e,artist:t,title:n,items:r}),t=t.toLowerCase(),n=n.toLowerCase(),r=r.map((e=>Nc(e))),yield this.items.put({service:e,artist:t,title:n,items:r}))}catch(e){zc.error(e)}}))}get(e,t,n){return $c(this,void 0,void 0,(function*(){return this.items.get([e,t.toLowerCase(),n.toLowerCase()])}))}}const Lc=new jc;var Rc=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))},Dc=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const _c=new A("lookup");let Fc="";function Vc(e,t){return Rc(this,void 0,void 0,(function*(){try{if(!e.lookup)return[];const{artist:n,title:r}=Qc(t),i=yield Lc.get(e.id,n,r);if(i)return i.items;if(e.isLoggedIn()){const i=e=>Jc(e).replace(/[([].*$/,"").replace(/['"]/g," ").replace(/\s\s+/g," "),a=Hc(yield e.lookup(i(t.albumArtist||Gc(n)),i(Gc(r)),10,2e3),t);return yield Lc.add(e.id,n,r,a),a}}catch(e){_c.error(e)}return[]}))}function Uc(e,t,n){return Rc(this,void 0,void 0,(function*(){const r=Dl().filter((e=>e!==n&&e.isLoggedIn()===t));return 0===r.length?[]:(yield Promise.all([...r.map((t=>Vc(t,e)))])).flat()}))}function Bc(e,t){const{artist:n,title:r}=Qc(t);if(!n||!r)return;const i=Oc.preferredService||Fc;let a=Hc(e,t);return a=k(a,(e=>Wc(e,t))),i&&(a=k(a,(e=>e.src.startsWith(i)))),a[0]}function Hc(e,t){let n=e.filter((e=>Kc(e,t,!0)));return 0===n.length&&(n=e.filter((e=>Kc(e,t,!1)))),n}const Yc=/\s*(feat\.|[([]?\s?feat[\s.]).*$/i;function Kc(e,t,n){return(function(e,t,n){let r=t.title;if(!r)return!1;if(qc(r,e.title))return!0;if(n)return!1;const i=Jc(e.title);if(r=Jc(r),qc(r,i))return!0;const[,...a]=e.artists||[];if(a.length>0){const e=a.length>1?` & ${a.pop()}`:"";if(qc(r,`${i} (feat. ${a.join(", ")}${e})`))return!0}return!(!Yc.test(r)||!qc(Gc(r),i))||!(!Yc.test(e.title)||!qc(r,Gc(i)))}(e,t,n)||function(e,t){if(!Wc(e,t))return!1;if(e.track!==t.track)return!1;const n=Jc(e.title),r=Jc(t.title);return!(!n.startsWith(r)&&!r.startsWith(n))||S(n,r,.75)}(e,t))&&function(e,t,n){var r;const i=null===(r=t.artists)||void 0===r?void 0:r[0];if(!i)return!1;const a=e.artists;if(!a)return!1;const o=a[0];if(!o)return!1;if(qc(i,o))return!0;if(n)return!1;if(qc(Jc(i),Jc(o)))return!0;if(qc(Gc(i),Gc(o)))return!0;const s=t.albumArtist;if(s&&qc(Jc(s),Jc(o)))return!0;if(qc(Gc(i),e.albumArtist))return!0;const l=",;&|/".split("").map((e=>[e,`${e} `,` ${e} `])).flat();for(const e of l){const[t]=a[0].split(e);if(qc(i,t))return!0;if(a.length>1&&qc(i,a.join(e)))return!0}return!1}(e,t,n)}function Wc(e,t){return!(!e.album||!t.album)&&qc(Jc(t.album),Jc(e.album))}function qc(e,t=""){return 0===e.localeCompare(t,void 0,{sensitivity:"accent"})}function Jc(e){return hc()(e).replace(/\s\s+/g," ")}function Qc(e){return{artist:e.artists&&e.artists[0]||"",title:e.title}}function Gc(e){return e.replace(Yc,"")}const Xc=new z("playlist"),Zc=new Ie(Xc.getJson("settings",{allowDuplicates:!0,showLineNumbers:!0,zeroPadLineNumbers:!0,showSourceIcons:!0})),eu={observe:function(){return Zc},get:function(){return Zc.getValue()},set:function(e){Xc.setJson("settings",e),Zc.next(e)}};var tu=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::playlist");const nu=new A("playlist"),ru=nc("ampcast/playlist","keyval"),iu=[],au=new Ie(iu),ou=new Ie("");function su(){return au.getValue()}function lu(e){e=e.concat(),au.next(e),0===e.length?uu(""):du()||uu(e[0].id)}function cu(){return ou.getValue()}function uu(e){ou.next(e)}function du(){const e=su(),t=cu();return e.find((e=>e.id===t))||null}function mu(e){uu(e.id)}function hu(){return Zn([au,ou]).pipe(Gt((([e,t])=>{var n;return null!==(n=e.find((e=>e.id===t)))&&void 0!==n?n:null})),tr())}function fu(){return Zn([au,ou]).pipe(Gt((([e,t])=>e.findIndex((e=>e.id===t)))),tr())}function pu(){const e=au.getValue(),t=cu();return e.findIndex((e=>e.id===t))}function vu(){return au.getValue().length}function bu(e){const t=cu();if(t){const n=su(),r=n.findIndex((e=>e.id===t));if(-1!==r){const t=n[r+e];t&&mu(t)}}}function gu(e,t){return tu(this,void 0,void 0,(function*(){const n=su(),r=eu.get().allowDuplicates;let i=yield function(e){return tu(this,void 0,void 0,(function*(){const t=e=>"itemType"in e&&e.itemType===Kn.Album;let n=[];if(Array.isArray(e))if(t(e[0])){const t=yield Promise.all(e.map((e=>wu(e))));for(const e of t)n=n.concat(e)}else n=yield Promise.all(e.map((e=>Eu(e))));else n=t(e)?yield wu(e):e instanceof FileList?yield Promise.all(Array.from(e).map((e=>dc(e)))):[yield Eu(e)];return n.filter(l)}))}(e);if(r||(i=i.filter((e=>-1===n.findIndex((t=>t.src===e.src))))),i.length>0){const e=i.map((e=>Object.assign(Object.assign({},Nc(e)),{id:pi()})));t>=0&&t<n.length?(n.splice(t,0,...e),lu(n)):lu(n.concat(e))}}))}function yu(e){return tu(this,void 0,void 0,(function*(){const t=su(),n=Array.isArray(e)?e:[e],r=t.filter((e=>!n.includes(e)));if(r.length!==t.length){const e=pu(),t=cu(),n=r.findIndex((e=>e.id===t));if(-1===n)if(-1===e)uu("");else{const t=r[e]||r.at(-1);uu((null==t?void 0:t.id)||"")}lu(r)}}))}function wu(e){return tu(this,void 0,void 0,(function*(){return fr(e.pager,{keepAlive:!0})}))}function Eu(e){return tu(this,void 0,void 0,(function*(){return e instanceof File?/^(audio|video)/.test(e.type)?dc(e):null:e}))}const xu={get atEnd(){return pu()===vu()-1},get atStart(){return 0===vu()||0===pu()},observe:function(){return au.pipe(ze((e=>e!==iu)))},observeCurrentIndex:fu,observeCurrentItem:hu,observeNextItem:function(){return Zn([au,ou]).pipe(Gt((([e,t])=>{const n=e.findIndex((e=>e.id===t));return-1===n?null:e[n+1]||null})),tr())},observeSize:function(){return au.pipe(Gt((e=>e.length)),tr())},getCurrentIndex:pu,getCurrentItem:du,setCurrentItem:mu,add:function(e){return tu(this,void 0,void 0,(function*(){return gu(e,-1)}))},clear:function(){return tu(this,void 0,void 0,(function*(){lu([])}))},eject:function(){return tu(this,void 0,void 0,(function*(){const e=du();if(e)return yu(e)}))},insert:function(e){return tu(this,void 0,void 0,(function*(){return gu(e,pu()+1)}))},insertAt:gu,moveSelection:function(e,t){return tu(this,void 0,void 0,(function*(){const n=su(),r=n[t];if(e.includes(r))return;const i=n.filter((t=>!e.includes(t))),a=i.indexOf(r);a>=0?(i.splice(a,0,...e),lu(i)):lu(i.concat(e))}))},next:function(){return tu(this,void 0,void 0,(function*(){bu(1)}))},prev:function(){return tu(this,void 0,void 0,(function*(){bu(-1)}))},remove:yu,removeAt:function(e){return tu(this,void 0,void 0,(function*(){const t=function(e){var t;return null!==(t=su()[e])&&void 0!==t?t:null}(e);if(t)return yu(t)}))},reverseAt:function(e,t){return tu(this,void 0,void 0,(function*(){const n=su(),r=n.slice(e,e+t).reverse();n.splice(e,t,...r),lu(n)}))},shuffle:function(e){return tu(this,void 0,void 0,(function*(){const t=su().slice();if(t.length>0){const n=du();if(e&&n){const e=f(t.filter((e=>e!==n)));e.unshift(n),lu(e)}else{const e=f(t);lu(e),mu(e[0])}}}))}};tu(void 0,void 0,void 0,(function*(){var e,t;const n=null!==(e=yield ac("items",ru))&&void 0!==e?e:[],r=null!==(t=yield ac("currently-playing-id",ru))&&void 0!==t?t:"";au.next(n),ou.next(r)})),au.pipe(kl(2),ec(200),Zt((e=>oc("items",e=e.map((e=>{if(e.lookupStatus){const{lookupStatus:t}=e;return function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["lookupStatus"])}return e})),ru)))).subscribe(nu),ou.pipe(kl(2),ec(200),Zt((e=>oc("currently-playing-id",e,ru)))).subscribe(nu),Pc.pipe($e((({lookupItem:e})=>{const t=su(),n=t.findIndex((t=>t.src===e.src));if(-1!==n){const e=t[n];t[n]=Object.assign(Object.assign({},e),{lookupStatus:lc.Looking}),lu(t)}}))).subscribe(nu),Ac.pipe($e((({lookupItem:e,foundItem:t})=>{const n=su(),r=n.findIndex((t=>t.src===e.src));if(-1!==r){const e=n[r];n[r]=t?Object.assign(Object.assign({},t),{id:e.id,lookupStatus:void 0}):Object.assign(Object.assign({},e),{lookupStatus:lc.NotFound}),lu(n)}}))).subscribe(nu);var ku,Su,Cu=n(1062),Tu=n.n(Cu),Pu=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},Au=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};const Iu=(e,t)=>e.width===t.width&&e.height===t.height,Ou=16/9,Mu={autohide:1,autoplay:0,controls:0,disablekb:1,enablejsapi:1,fs:0,iv_load_policy:3,modestbranding:1,rel:0,showinfo:0};var Nu;!function(e){e[e.UNSTARTED=-1]="UNSTARTED",e[e.ENDED=0]="ENDED",e[e.PLAYING=1]="PLAYING",e[e.PAUSED=2]="PAUSED",e[e.BUFFERING=3]="BUFFERING",e[e.CUED=5]="CUED"}(Nu||(Nu={}));class $u{constructor(e){this.player=null,this.src$=new Ie(""),this.size$=new Ie({width:0,height:0}),this.error$=new Pe,this.ready$=new Pe,this.state$=new Pe,this.videoId$=new Ie(""),ku.set(this,!0),Su.set(this,1),this.autoplay=!1,this.loop=!1;const t=this.element=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),i=this.logger=new A(`YouTubePlayer/${e}`);this.targetId=`youtube-iframe-${e}`,t.hidden=!0,t.className="youtube-video",n.className="youtube-video-wrapper",r.id=this.targetId,n.append(r),t.append(n),this.observeReady().pipe(Zt((()=>this.observeSrc())),$s((e=>!e)),$e((e=>{const t=this.player,[,n,r,i="0"]=e.split(":"),a=Number(i)||0;if(r){if("playlist"===n){const e={list:r,listType:n,index:a};this.autoplay?t.loadPlaylist(e):t.cuePlaylist(e)}else this.autoplay?t.loadVideoById(r,a):t.cueVideoById(r,a);this.loadError=void 0}else t.stopVideo()}))).subscribe(i),this.observeReady().pipe(Zt((()=>this.observeVideoSize())),$e((({width:e,height:t})=>this.player.setSize(e,t)))).subscribe(i),this.observeState().pipe(ze((e=>e===Nu.ENDED&&this.loop)),$e((()=>this.player.seekTo(0,!0)))).subscribe(i),this.observeState().pipe(ze((e=>e===Nu.PLAYING)),$e((()=>this.element.style.visibility=""))).subscribe(i),this.observeState().pipe(Gt((()=>{var e;return this.getVideoId((null===(e=this.player)||void 0===e?void 0:e.getVideoUrl())||"")})),$e((e=>this.videoId$.next(e)))).subscribe(i),this.observeError().subscribe(i.error)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e,e&&(this.element.style.visibility="hidden")}get muted(){return Pu(this,ku,"f")}set muted(e){Pu(this,ku,"f")!==e&&(Au(this,ku,e,"f"),this.player&&(e?this.player.mute():0!==this.volume&&this.player.unMute()))}get volume(){return Pu(this,Su,"f")}set volume(e){Pu(this,Su,"f")!==e&&(Au(this,Su,e,"f"),this.player&&(this.player.setVolume(100*e),0===e?this.player.mute():this.muted||this.player.unMute()))}observeCurrentTime(){return this.observeState().pipe(yn((e=>{var t;return e===Nu.PLAYING?Rt(250-Math.round(1e3*this.player.getCurrentTime())%250,250).pipe(Gt((()=>this.player.getCurrentTime())),wn(this.observeState())):Pn((null===(t=this.player)||void 0===t?void 0:t.getCurrentTime())||0)})))}observeDuration(){return this.observeState().pipe(Gt((()=>{var e;return(null===(e=this.player)||void 0===e?void 0:e.getDuration())||0})),ze((e=>0!==e)),tr())}observeEnded(){return this.observeState().pipe(ze((e=>e===Nu.ENDED&&!this.loop)),Gt((()=>{})))}observeError(){return this.error$}observePlaying(){return this.observeState().pipe(ze((e=>e===Nu.PLAYING)),Gt((()=>{})))}observeVideoId(){return this.videoId$.pipe(tr())}appendTo(e){e.appendChild(this.element),this.createPlayer()}load(e){this.logger.log("load",{src:e}),this.player||this.createPlayer(),this.autoplay&&this.player&&e===this.src?this.player.playVideo():this.src$.next(e)}play(){var e;this.logger.log("play"),this.player?this.src===(null===(e=this.loadError)||void 0===e?void 0:e.src)?this.error$.next(this.loadError.error):this.player.playVideo():this.error$.next(Error("YouTube player not loaded."))}pause(){var e;this.logger.log("pause"),null===(e=this.player)||void 0===e||e.pauseVideo()}stop(){var e;this.logger.log("stop"),null===(e=this.player)||void 0===e||e.stopVideo()}seek(e){var t;null===(t=this.player)||void 0===t||t.seekTo(e,!0)}resize(e,t){this.size$.next({width:e,height:t})}destroy(){var e;null===(e=this.player)||void 0===e||e.destroy(),this.element.remove()}get src(){return this.src$.getValue()}observeAspectRatio(){return this.observeVideoId().pipe(yn((e=>e?this.getAspectRatio(e):Pn(Ou))),tr())}observeReady(){return this.ready$.pipe(hr(1))}observeSize(){return this.size$.pipe(tr(Iu),ze((({width:e,height:t})=>e*t>0)))}observeSrc(){return this.src$.pipe(tr())}observeState(){return this.state$}observeVideoSize(){return Zn([this.observeSize(),this.observeAspectRatio()]).pipe(Gt((([{width:e,height:t},n])=>{const r=Math.max(Math.round(e/n),t);return{width:Math.max(Math.round(r*n),e),height:r}})),tr(Iu))}createPlayer(){if(!this.player&&this.element.isConnected){const e=Tu()(this.targetId,{playerVars:Mu});e.on("ready",(({target:e})=>{this.player=e,e.setVolume(100*this.volume),(this.muted||0===this.volume)&&e.mute(),this.ready$.next(void 0)})),e.on("stateChange",(({data:e})=>{this.state$.next(e)})),e.on("error",(e=>{this.loadError={src:this.src,error:e},this.error$.next(e)}))}}getAspectRatio(e){return vn(Oo(e)).pipe(wn(Rt(3e3)),wn(this.observeVideoId().pipe(kl(1))),Gt((({aspectRatio:e})=>e||Ou)),cr((t=>(this.logger.log(`Could not obtain oembed info (videoId=${e}): ${t.message}`),this.loadError={src:this.src,error:t},this.error$.next(t),Pn(Ou)))))}getPlayerState(){return this.player?this.player.getPlayerState():Nu.UNSTARTED}getVideoId(e){if(e.startsWith("youtube:video")){const[,,t]=e.split(":");return t}return io()(e)||""}}ku=new WeakMap,Su=new WeakMap;var zu=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};let ju=0;class Lu extends $u{constructor(e){super("loader-"+ju++),this.load(e)}loadPlaylist(){return zu(this,void 0,void 0,(function*(){return yield this.cue(),this.player.getPlaylist()||[]}))}observeVideoSize(){return cn}loadDuration(){return zu(this,void 0,void 0,(function*(){return yield this.cue(),this.player.getDuration()||0}))}cue(){return new Promise(((e,t)=>{const n=this.observeCued(),r=bn(this.observeError(),Rt(3e3).pipe(Gt((()=>Error("timeout")))));n.pipe(wn(r),hr(1)).subscribe({next:e}),r.pipe(wn(n),hr(1)).subscribe({next:t}),setTimeout((()=>this.appendTo(document.body)))}))}observeCued(){return this.observeState().pipe(ze((e=>e===Nu.CUED)),Gt((()=>{})),hr(1))}}var Ru=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function Du(){const e=(0,r.useRef)(null),[t,n]=(0,r.useState)(""),i=(0,r.useCallback)((t=>Ru(this,void 0,void 0,(function*(){try{t.preventDefault();const r=e.current.value,i=io()(r),a=yield Oo(i),o=yield function(e){return zu(this,void 0,void 0,(function*(){const t=new Lu(e);try{return yield t.loadDuration()}finally{t.destroy()}}))}(a.src);yield xu.add(Object.assign(Object.assign({},a),{duration:o})),n("Queued.")}catch(e){n(e.message||"This video cannot be embedded.")}}))),[]),a=(0,r.useCallback)((()=>{n("");const t=e.current.value;let r="Not a valid YouTube url.";/^https?/.test(t)&&/youtu\.?be/.test(t)&&(r="Not a YouTube video.",io()(t)&&(r="")),e.current.setCustomValidity(r)}),[]);return r.createElement("form",{className:"add-youtube-video",onSubmit:i},r.createElement("fieldset",null,r.createElement("legend",null,"Add video from url:"),r.createElement("p",{className:"text-with-button"},r.createElement("input",{type:"url",required:!0,onInput:a,ref:e}),r.createElement("button",{title:"Add to playlist"},r.createElement(xi,{name:"playlist-add"}))),r.createElement("p",null,r.createElement("output",null,t))))}function _u(){return r.createElement("div",{className:"panel"},r.createElement("div",{className:"page login"},r.createElement(Xl,{service:No}),r.createElement("p",null,"You can still play YouTube videos without being logged in.",r.createElement("br",null),"But you need to be logged in to search for music and access your playlists."),r.createElement(ql,{service:No}),r.createElement(Du,null),r.createElement(Jl,{service:No})))}function Fu({service:e}){switch(e.id){case"plex":return r.createElement(Gl,null);case"spotify":return r.createElement(Zl,null);case"youtube":return r.createElement(_u,null);default:return r.createElement(Ql,{service:e})}}function Vu({icon:e,placeholder:t="Search",onSubmit:n}){const i=(0,r.useRef)(null),a=(0,r.useCallback)((e=>{const t=i.current.value;e.preventDefault(),null==n||n(t)}),[n]);return r.createElement("form",{className:"search-bar",onSubmit:a},r.createElement("p",{className:"text-with-button"},e?r.createElement(xi,{name:e}):null,r.createElement("input",{type:"search",placeholder:t,spellCheck:!1,autoComplete:"off",autoCapitalize:"off",ref:i}),r.createElement("button",{type:"submit",title:"Search"},r.createElement(xi,{name:"search"}))))}function Uu({children:e}){return r.createElement("div",{className:"panel empty-screen"},e)}var Bu,Hu,Yu=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},Ku=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};class Wu{constructor(e,t,n,r){this.players=t,this.selectPlayer=n,this.loadPlayer=r,this.player$=new Ie(null),this.error$=new Pe,Bu.set(this,!1),Hu.set(this,!1);const i=this.element=document.createElement("div");i.className=e,t.forEach((e=>{e.autoplay=!1,e.muted=!0,e.hidden=!0,e.appendTo(i)}))}get autoplay(){return Yu(this,Bu,"f")}set autoplay(e){Ku(this,Bu,e,"f"),this.currentPlayer&&(this.currentPlayer.autoplay=e)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e,this.currentPlayer&&(this.currentPlayer.hidden=e)}get loop(){return this.players[0].loop}set loop(e){this.players.forEach((t=>t.loop=e))}get muted(){return Yu(this,Hu,"f")}set muted(e){Ku(this,Hu,e,"f"),this.currentPlayer&&(this.currentPlayer.muted=e)}get volume(){return this.players[0].volume}set volume(e){this.players.forEach((t=>t.volume=e))}observeCurrentTime(){return this.observeCurrentPlayer().pipe(yn((e=>e?e.observeCurrentTime():Pn(0))),tr())}observeDuration(){return this.observeCurrentPlayer().pipe(yn((e=>e?e.observeDuration():cn)),tr())}observeEnded(){return this.observeCurrentPlayer().pipe(yn((e=>e?e.observeEnded():cn)))}observeError(){return this.observeCurrentPlayer().pipe(yn((e=>e?bn(this.error$,e.observeError()):cn)))}observePlaying(){return this.observeCurrentPlayer().pipe(yn((e=>e?e.observePlaying():cn)))}appendTo(e){e.appendChild(this.element)}load(e){const t=this.currentPlayer,n=this.selectPlayer(e);if(this.player$.next(null),t&&t!==n&&(t.muted=!0,t.hidden=!0,t.stop()),this.player$.next(n),n)try{n.autoplay=this.autoplay,this.loadPlayer(n,e),n.muted=this.muted,n.hidden=this.hidden}catch(e){this.error$.next(e)}else this.error$.next(Error("No player found."))}play(){var e;this.autoplay=!0,null===(e=this.currentPlayer)||void 0===e||e.play()}pause(){var e;this.autoplay=!1,null===(e=this.currentPlayer)||void 0===e||e.pause()}stop(){var e;this.autoplay=!1,null===(e=this.currentPlayer)||void 0===e||e.stop()}seek(e){var t;null===(t=this.currentPlayer)||void 0===t||t.seek(e)}resize(e,t){e*t>0&&this.players.forEach((n=>n.resize(e,t)))}get currentPlayer(){return this.player$.getValue()}observeCurrentPlayer(){return this.player$.pipe(tr())}}Bu=new WeakMap,Hu=new WeakMap;var qu;class Ju{constructor(){qu.set(this,!1),this.loop=!0,this.muted=!0,this.volume=0}get autoplay(){return function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}(this,qu,"f")}set autoplay(e){!function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===r?i.call(e,n):i?i.value=n:t.set(e,n)}(this,qu,e,"f")}observeCurrentTime(){return cn}observeDuration(){return cn}observeEnded(){return cn}observeError(){return cn}observePlaying(){return cn}seek(){}}qu=new WeakMap;class Qu{constructor(e,t){this.error$=new Pe,this.src="",this.autoplay=!1;const n=this.element=document.createElement(e);n.hidden=!0,n.muted=!0,n.autoplay=!1,n.className=`html5-${e} html5-${e}-${t}`,n.crossOrigin="anonymous",on(n,"error").pipe(Gt((()=>n.error))).subscribe(this.error$);const r=this.logger=new A(`HTML5Player/${e}/${t}`);this.observeError().subscribe(r.error)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e}get loop(){return this.element.loop}set loop(e){this.element.loop=e}get muted(){return this.element.muted}set muted(e){this.element.muted=e}get volume(){return this.element.volume}set volume(e){this.element.volume=e}observeCurrentTime(){return on(this.element,"timeupdate").pipe(Gt((()=>this.element.currentTime)),Gt((e=>isFinite(e)?e:0)))}observeDuration(){return on(this.element,"durationchange").pipe(Gt((()=>this.element.duration)),Gt((e=>isFinite(e)?e:0)))}observeEnded(){return on(this.element,"ended").pipe(Gt((()=>{})))}observeError(){return this.error$}observePlaying(){return on(this.element,"playing").pipe(Gt((()=>{})))}appendTo(e){e.appendChild(this.element)}load(e){this.logger.log("load"),this.src=e;try{const e=this.getMediaSource(this.src);this.element.setAttribute("src",e),this.autoplay&&this.safePlay()}catch(e){this.error$.next(e)}}play(){this.logger.log("play");try{const e=this.getMediaSource(this.src);this.element.getAttribute("src")!==e&&this.element.setAttribute("src",e),this.safePlay()}catch(e){this.error$.next(e)}}pause(){this.logger.log("pause"),this.element.pause()}stop(){this.logger.log("stop"),this.element.pause(),this.element.currentTime=0}seek(e){this.element.currentTime=e}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}getMediaSource(e){return e.startsWith("jellyfin:")?Ei.getPlayableUrlFromSrc(e):e.startsWith("plex:")?as.getPlayableUrlFromSrc(e):e}safePlay(){return e=this,t=void 0,r=function*(){try{yield this.element.play()}catch(e){this.error$.next(e)}},new((n=void 0)||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}));var e,t,n,r}}const Gu=new z("visualizer/settings"),Xu={get ambientVideoEnabled(){return Gu.getBoolean("ambientVideoEnabled")},set ambientVideoEnabled(e){var t;e!==this.ambientVideoEnabled&&(Gu.setBoolean("ambientVideoEnabled",e),e||("ambientvideo"===this.provider&&Gu.setString("provider",""),"ambientvideo"===(null===(t=this.lockedVisualizer)||void 0===t?void 0:t.providerId)&&Gu.removeItem("lockedVisualizer")),Zu.next(this))},get ambientVideoSource(){return Gu.getString("ambientVideoSource")},set ambientVideoSource(e){var t;e!==this.ambientVideoSource&&(Gu.setString("ambientVideoSource",e),"ambientvideo"===(null===(t=this.lockedVisualizer)||void 0===t?void 0:t.providerId)&&Gu.removeItem("lockedVisualizer"),Zu.next(this))},get beatsOverlay(){return Gu.getBoolean("beatsOverlay")},set beatsOverlay(e){e!==this.beatsOverlay&&(Gu.setBoolean("beatsOverlay",e),Zu.next(this))},get useAmbientVideoSource(){return Gu.getBoolean("useAmbientVideoSource")},set useAmbientVideoSource(e){var t;e!==this.useAmbientVideoSource&&(Gu.setBoolean("useAmbientVideoSource",e),"ambientvideo"===(null===(t=this.lockedVisualizer)||void 0===t?void 0:t.providerId)&&Gu.removeItem("lockedVisualizer"),Zu.next(this))},get lockedVisualizer(){return Gu.getJson("lockedVisualizer")},set lockedVisualizer(e){if(e){const{providerId:t,name:n}=e;Gu.setJson("lockedVisualizer",{providerId:t,name:n})}else Gu.removeItem("lockedVisualizer");Zu.next(this)},get provider(){return Gu.getString("provider")},set provider(e){var t;e!==this.provider&&(Gu.setString("provider",e),e&&(null===(t=this.lockedVisualizer)||void 0===t?void 0:t.providerId)!==e&&Gu.removeItem("lockedVisualizer"),Zu.next(this))}},Zu=new Ie(Xu),ed=Xu;function td(){return Zu}function nd(e,t,n){void 0===t&&(t=zt);var r=Rt(e,t);return function(e,t){return Oe((function(e,n){var i=null!=t?t:{},a=i.leading,o=void 0===a||a,s=i.trailing,l=void 0!==s&&s,c=!1,u=null,d=null,m=!1,h=function(){null==d||d.unsubscribe(),d=null,l&&(v(),m&&n.complete())},f=function(){d=null,m&&n.complete()},p=function(e){return d=Jt(r).subscribe(Me(n,h,f))},v=function(){if(c){c=!1;var e=u;u=null,n.next(e),!m&&p()}};e.subscribe(Me(n,(function(e){c=!0,u=e,(!d||d.closed)&&(o?v():p())}),(function(){m=!0,(!(l&&c&&d)||d.closed)&&n.complete()})))}))}(0,n)}console.log("module::playback");const rd=new Ie({currentItem:null,currentTime:0,startedAt:0,endedAt:0,duration:0,paused:!0});function id(){return rd}function ad(){return id().pipe(ze((e=>0!==e.startedAt)),tr(((e,t)=>e.startedAt===t.startedAt)))}function od(){return id().pipe(ze((e=>0!==e.endedAt)),tr(((e,t)=>e.endedAt===t.endedAt)))}function sd(e=1e4){return ad().pipe(yn((()=>id().pipe(nd(e,void 0,{trailing:!0}),wn(od())))))}function ld(){return id().pipe(Gt((e=>e.paused)),tr())}function cd(){const e=rd.getValue();e.startedAt&&(e.endedAt||rd.next(Object.assign(Object.assign({},e),{endedAt:Date.now()})),rd.next(Object.assign(Object.assign({},e),{startedAt:0,endedAt:0})))}hu().subscribe((e=>{cd(),rd.next(Object.assign(Object.assign({},rd.getValue()),{currentItem:e,currentTime:0,duration:(null==e?void 0:e.duration)||0,startedAt:0,endedAt:0}))}));const ud={get paused(){return rd.getValue().paused},observePlaybackState:id,observePlaybackStart:ad,observePlaybackEnd:od,observePlaybackProgress:sd,observeCurrentTime:function(){return id().pipe(Gt((e=>e.currentTime)),tr())},observeDuration:function(){return id().pipe(Gt((e=>e.duration)),tr())},observePaused:ld,getCurrentTime:function(){return rd.getValue().currentTime},setCurrentTime:function(e){const t=rd.getValue();(e=Math.max(Math.min(Math.floor(isFinite(e)?e:0),t.duration),0))!==t.currentTime&&rd.next(Object.assign(Object.assign({},t),{currentTime:e}))},getDuration:function(){return rd.getValue().duration},setDuration:function(e){const t=rd.getValue();if((e=Math.max(Math.floor(isFinite(e)?e:0),0))!==t.duration){const n=Math.min(t.currentTime,e);rd.next(Object.assign(Object.assign({},t),{duration:e,currentTime:n}))}},play:function(){const e=rd.getValue();e.currentItem&&e.paused&&rd.next(Object.assign(Object.assign({},e),{paused:!1}))},pause:function(){const e=rd.getValue();e.paused||rd.next(Object.assign(Object.assign({},e),{paused:!0}))},stop:function(){const e=rd.getValue();if(!e.paused||0!==e.currentTime||0!==e.startedAt&&0===e.endedAt){const t=Object.assign(Object.assign({},e),{paused:!0,currentTime:0,endedAt:e.endedAt||(e.startedAt?Date.now():0)});rd.next(t),e.startedAt&&rd.next(Object.assign(Object.assign({},t),{startedAt:0,endedAt:0}))}},started:function(){const e=rd.getValue();e.startedAt||rd.next(Object.assign(Object.assign({},e),{startedAt:Date.now()}))},ended:cd};function dd(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}function md(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return dd((n-r/t)*t,o,i,a,s)}}function hd(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}const fd=Math.sqrt(50),pd=Math.sqrt(10),vd=Math.sqrt(2);function bd(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=fd?10:a>=pd?5:a>=vd?2:1;let s,l,c;return i<0?(c=Math.pow(10,-i)/o,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*o,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=n&&n<2?bd(e,t,2*n):[s,l,c]}function gd(e,t,n){if(!((n=+n)>0))return[];if((e=+e)==(t=+t))return[e];const r=t<e,[i,a,o]=r?bd(t,e,n):bd(e,t,n);if(!(a>=i))return[];const s=a-i+1,l=new Array(s);if(r)if(o<0)for(let e=0;e<s;++e)l[e]=(a-e)/-o;else for(let e=0;e<s;++e)l[e]=(a-e)*o;else if(o<0)for(let e=0;e<s;++e)l[e]=(i+e)/-o;else for(let e=0;e<s;++e)l[e]=(i+e)*o;return l}var yd,wd=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ed(e){if(!(t=wd.exec(e)))throw new Error("invalid format: "+e);var t;return new xd({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function xd(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function kd(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Sd(e,t){var n=kd(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Ed.prototype=xd.prototype,xd.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Cd={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Sd(100*e,t),r:Sd,s:function(e,t){var n=kd(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(yd=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+kd(e,Math.max(0,t+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Td(e){return e}var Pd,Ad,Id=Array.prototype.map,Od=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function Md(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Nd(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function $d(e){let t,n,r;function i(e,r,i=0,a=e.length){if(i<a){if(0!==t(r,r))return a;do{const t=i+a>>>1;n(e[t],r)<0?i=t+1:a=t}while(i<a)}return i}return 2!==e.length?(t=Md,n=(t,n)=>Md(e(t),n),r=(t,n)=>e(t)-n):(t=e===Md||e===Nd?e:zd,n=e,r=e),{left:i,center:function(e,t,n=0,a=e.length){const o=i(e,t,n,a-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r,i=0,a=e.length){if(i<a){if(0!==t(r,r))return a;do{const t=i+a>>>1;n(e[t],r)<=0?i=t+1:a=t}while(i<a)}return i}}}function zd(){return 0}Pd=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Td:(t=Id.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,a=[],o=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(e.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Td:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Id.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"âˆ’":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function d(e){var t=(e=Ed(e)).fill,n=e.align,d=e.sign,m=e.symbol,h=e.zero,f=e.width,p=e.comma,v=e.precision,b=e.trim,g=e.type;"n"===g?(p=!0,g="g"):Cd[g]||(void 0===v&&(v=12),b=!0,g="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var y="$"===m?i:"#"===m&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",w="$"===m?a:/[%p]/.test(g)?l:"",E=Cd[g],x=/[defgprs%]/.test(g);function k(e){var i,a,l,m=y,k=w;if("c"===g)k=E(e)+k,e="";else{var S=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:E(Math.abs(e),v),b&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),S&&0==+e&&"+"!==d&&(S=!1),m=(S?"("===d?d:c:"-"===d||"("===d?"":d)+m,k=("s"===g?Od[8+yd/3]:"")+k+(S&&"("===d?")":""),x)for(i=-1,a=e.length;++i<a;)if(48>(l=e.charCodeAt(i))||l>57){k=(46===l?o+e.slice(i+1):e.slice(i))+k,e=e.slice(0,i);break}}p&&!h&&(e=r(e,1/0));var C=m.length+e.length+k.length,T=C<f?new Array(f-C+1).join(t):"";switch(p&&h&&(e=r(T+e,T.length?f-k.length:1/0),T=""),n){case"<":e=m+e+k+T;break;case"=":e=m+T+e+k;break;case"^":e=T.slice(0,C=T.length>>1)+m+e+k+T.slice(C);break;default:e=T+m+e+k}return s(e)}return v=void 0===v?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),k.toString=function(){return e+""},k}return{format:d,formatPrefix:function(e,t){var n,r=d(((e=Ed(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor((n=t,((n=kd(Math.abs(n)))?n[1]:NaN)/3)))),a=Math.pow(10,-i),o=Od[8+i/3];return function(e){return r(a*e)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),Ad=Pd.format,Pd.formatPrefix;const jd=$d(Md),Ld=jd.right,Rd=(jd.left,$d((function(e){return null===e?NaN:+e})).center,Ld);function Dd(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function _d(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Fd(){}var Vd=.7,Ud=1/Vd,Bd="\\s*([+-]?\\d+)\\s*",Hd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Yd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kd=/^#([0-9a-f]{3,8})$/,Wd=new RegExp(`^rgb\\(${Bd},${Bd},${Bd}\\)$`),qd=new RegExp(`^rgb\\(${Yd},${Yd},${Yd}\\)$`),Jd=new RegExp(`^rgba\\(${Bd},${Bd},${Bd},${Hd}\\)$`),Qd=new RegExp(`^rgba\\(${Yd},${Yd},${Yd},${Hd}\\)$`),Gd=new RegExp(`^hsl\\(${Hd},${Yd},${Yd}\\)$`),Xd=new RegExp(`^hsla\\(${Hd},${Yd},${Yd},${Hd}\\)$`),Zd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function em(){return this.rgb().formatHex()}function tm(){return this.rgb().formatRgb()}function nm(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Kd.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?rm(t):3===n?new om(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?im(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?im(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Wd.exec(e))?new om(t[1],t[2],t[3],1):(t=qd.exec(e))?new om(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Jd.exec(e))?im(t[1],t[2],t[3],t[4]):(t=Qd.exec(e))?im(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Gd.exec(e))?mm(t[1],t[2]/100,t[3]/100,1):(t=Xd.exec(e))?mm(t[1],t[2]/100,t[3]/100,t[4]):Zd.hasOwnProperty(e)?rm(Zd[e]):"transparent"===e?new om(NaN,NaN,NaN,0):null}function rm(e){return new om(e>>16&255,e>>8&255,255&e,1)}function im(e,t,n,r){return r<=0&&(e=t=n=NaN),new om(e,t,n,r)}function am(e,t,n,r){return 1===arguments.length?((i=e)instanceof Fd||(i=nm(i)),i?new om((i=i.rgb()).r,i.g,i.b,i.opacity):new om):new om(e,t,n,null==r?1:r);var i}function om(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function sm(){return`#${dm(this.r)}${dm(this.g)}${dm(this.b)}`}function lm(){const e=cm(this.opacity);return`${1===e?"rgb(":"rgba("}${um(this.r)}, ${um(this.g)}, ${um(this.b)}${1===e?")":`, ${e})`}`}function cm(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function um(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function dm(e){return((e=um(e))<16?"0":"")+e.toString(16)}function mm(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new fm(e,t,n,r)}function hm(e){if(e instanceof fm)return new fm(e.h,e.s,e.l,e.opacity);if(e instanceof Fd||(e=nm(e)),!e)return new fm;if(e instanceof fm)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new fm(o,s,l,e.opacity)}function fm(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function pm(e){return(e=(e||0)%360)<0?e+360:e}function vm(e){return Math.max(0,Math.min(1,e||0))}function bm(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}Dd(Fd,nm,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:em,formatHex:em,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return hm(this).formatHsl()},formatRgb:tm,toString:tm}),Dd(om,am,_d(Fd,{brighter(e){return e=null==e?Ud:Math.pow(Ud,e),new om(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Vd:Math.pow(Vd,e),new om(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new om(um(this.r),um(this.g),um(this.b),cm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:sm,formatHex:sm,formatHex8:function(){return`#${dm(this.r)}${dm(this.g)}${dm(this.b)}${dm(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:lm,toString:lm})),Dd(fm,(function(e,t,n,r){return 1===arguments.length?hm(e):new fm(e,t,n,null==r?1:r)}),_d(Fd,{brighter(e){return e=null==e?Ud:Math.pow(Ud,e),new fm(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Vd:Math.pow(Vd,e),new fm(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new om(bm(e>=240?e-240:e+120,i,r),bm(e,i,r),bm(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new fm(pm(this.h),vm(this.s),vm(this.l),cm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=cm(this.opacity);return`${1===e?"hsl(":"hsla("}${pm(this.h)}, ${100*vm(this.s)}%, ${100*vm(this.l)}%${1===e?")":`, ${e})`}`}}));const gm=e=>()=>e;function ym(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):gm(isNaN(e)?t:e)}const wm=function e(t){var n=function(e){return 1==(e=+e)?ym:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):gm(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=am(e)).r,(t=am(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=ym(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function Em(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=am(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}function xm(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Om(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=a[n](e);return o}}function km(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Sm(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Cm(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=Om(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}Em(md),Em((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return dd((n-r/t)*t,i,a,o,s)}}));var Tm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Pm=new RegExp(Tm.source,"g");function Am(e,t){var n,r,i,a=Tm.lastIndex=Pm.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(n=Tm.exec(e))&&(r=Pm.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,l.push({i:o,x:Sm(n,r)})),a=Pm.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function Im(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(n=0;n<r;++n)i[n]=e[n]*(1-a)+t[n]*a;return i}}function Om(e,t){var n,r,i=typeof t;return null==t||"boolean"===i?gm(t):("number"===i?Sm:"string"===i?(n=nm(t))?(t=n,wm):Am:t instanceof nm?wm:t instanceof Date?km:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?xm:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Cm:Sm:Im))(e,t)}function Mm(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Nm(e){return+e}var $m=[0,1];function zm(e){return e}function jm(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function Lm(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=jm(i,r),a=n(o,a)):(r=jm(r,i),a=n(a,o)),function(e){return a(r(e))}}function Rm(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=jm(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(t){var n=Rd(e,t,1,r)-1;return a[n](i[n](t))}}function Dm(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function _m(e){return Math.log(e)}function Fm(e){return Math.exp(e)}function Vm(e){return-Math.log(-e)}function Um(e){return-Math.exp(-e)}function Bm(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Hm(e){return(t,n)=>-e(-t,n)}function Ym(){const e=function(e){const t=e(_m,Fm),n=t.domain;let r,i,a=10;function o(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(a),i=function(e){return 10===e?Bm:e===Math.E?Math.exp:t=>Math.pow(e,t)}(a),n()[0]<0?(r=Hm(r),i=Hm(i),e(Vm,Um)):e(_m,Fm),t}return t.base=function(e){return arguments.length?(a=+e,o()):a},t.domain=function(e){return arguments.length?(n(e),o()):n()},t.ticks=e=>{const t=n();let o=t[0],s=t[t.length-1];const l=s<o;l&&([o,s]=[s,o]);let c,u,d=r(o),m=r(s);const h=null==e?10:+e;let f=[];if(!(a%1)&&m-d<h){if(d=Math.floor(d),m=Math.ceil(m),o>0){for(;d<=m;++d)for(c=1;c<a;++c)if(u=d<0?c/i(-d):c*i(d),!(u<o)){if(u>s)break;f.push(u)}}else for(;d<=m;++d)for(c=a-1;c>=1;--c)if(u=d>0?c/i(-d):c*i(d),!(u<o)){if(u>s)break;f.push(u)}2*f.length<h&&(f=gd(o,s,h))}else f=gd(d,m,Math.min(m-d,h)).map(i);return l?f.reverse():f},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===a?"s":","),"function"!=typeof n&&(a%1||null!=(n=Ed(n)).precision||(n.trim=!0),n=Ad(n)),e===1/0)return n;const o=Math.max(1,a*e/t.ticks().length);return e=>{let t=e/i(Math.round(r(e)));return t*a<a-.5&&(t*=a),t<=o?n(e):""}},t.nice=()=>n(function(e,t){var n,r=0,i=(e=e.slice()).length-1,a=e[r],o=e[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),e[r]=t.floor(a),e[i]=t.ceil(o),e}(n(),{floor:e=>i(Math.floor(r(e))),ceil:e=>i(Math.ceil(r(e)))})),t}(function(){var e,t,n,r,i,a,o=$m,s=$m,l=Om,c=zm;function u(){var e,t,n,l=Math.min(o.length,s.length);return c!==zm&&(e=o[0],t=o[l-1],e>t&&(n=e,e=t,t=n),c=function(n){return Math.max(e,Math.min(t,n))}),r=l>2?Rm:Lm,i=a=null,d}function d(t){return null==t||isNaN(t=+t)?n:(i||(i=r(o.map(e),s,l)))(e(c(t)))}return d.invert=function(n){return c(t((a||(a=r(s,o.map(e),Sm)))(n)))},d.domain=function(e){return arguments.length?(o=Array.from(e,Nm),u()):o.slice()},d.range=function(e){return arguments.length?(s=Array.from(e),u()):s.slice()},d.rangeRound=function(e){return s=Array.from(e),l=Mm,u()},d.clamp=function(e){return arguments.length?(c=!!e||zm,u()):c!==zm},d.interpolate=function(e){return arguments.length?(l=e,u()):l},d.unknown=function(e){return arguments.length?(n=e,d):n},function(n,r){return e=n,t=r,u()}}()).domain([1,10]);return e.copy=()=>{return(t=e,n=Ym(),n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())).base(e.base());var t,n},Dm.apply(e,arguments),e}var Km=n(4843);const Wm=[16.35,17.32,18.35,19.45,20.6,21.83,23.12,24.5,25.96,27.5,29.14,30.87].map(((e,t)=>{const n=[{index:t,value:e}];for(let r=1;r<12;r++)n[r]={index:t,value:e*Math.pow(2,r)};return n})).flat().sort(((e,t)=>e.value-t.value));function qm(e,t,n){return function(e,t){const n=e*t,r=n+t,i=Wm.filter((e=>e.value>=n&&e.value<r));if(i.length>0)return i.map((({index:e})=>({index:e,value:1})));for(let e=0;e<Wm.length;e++){const t=Wm[e];if(t.value>r){const i=Wm[e-1],a=t.value-i.value;return[{index:i.index,value:1-(r-i.value)/a},{index:t.index,value:1-(t.value-n)/a}]}}return[]}(t,n).map((({index:t,value:n})=>e[t]*n)).reduce(((e,t)=>e+t),0)}var Jm,Qm=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};Jm=new WeakMap;const Gm=new class{constructor(e){this.intervalTypes=["bars","beats","sections","segments","tatums"],this.animationFrameId=0,this.currentTrackId="",this.currentTrackAnalysis=null,this.trackAnalysis={},this.initialTrackProgress=0,this.initialStart=0,this.trackProgress=0,this.active=!1,this.queues={volume:[],beat:[]},this.activeIntervals$=new Ie({bars:{},beats:{},sections:{},segments:{},tatums:{}}),Jm.set(this,0),this.fftSize=2048,this.volumeSmoothing=100,e.observeCurrentTrackState().subscribe((t=>Qm(this,void 0,void 0,(function*(){var n,r;const i=null===(r=null===(n=null==t?void 0:t.track_window)||void 0===n?void 0:n.current_track)||void 0===r?void 0:r.id;if(i&&this.currentTrackId!==i){this.currentTrackId=i,this.currentTrackAnalysis=null;try{this.currentTrackAnalysis=yield al.getAudioAnalysisForTrack(i),t=yield e.getCurrentState()}catch(e){console.error(e),this.currentTrackAnalysis=null,t=null}}t&&this.currentTrackAnalysis&&this.updateState(t),this.active=!(!this.currentTrackAnalysis||!t||t.paused||t.loading),this.active?this.start():this.stop()}))))}get bar(){return this.activeIntervals.bars}get beat(){return this.activeIntervals.beats}get frequencyBinCount(){return this.fftSize/2}get section(){return this.activeIntervals.sections}get segment(){return this.activeIntervals.segments}get tatum(){return this.activeIntervals.tatums}get volume(){return function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}(this,Jm,"f")}observeBar(){return this.observeActiveIntervals().pipe(Gt((e=>e.bars)),tr())}observeBeat(){return this.observeActiveIntervals().pipe(Gt((e=>e.beats)),tr())}observeSection(){return this.observeActiveIntervals().pipe(Gt((e=>e.sections)),tr())}observeSegment(){return this.observeActiveIntervals().pipe(Gt((e=>e.segments)),tr())}observeTatum(){return this.observeActiveIntervals().pipe(Gt((e=>e.tatums)),tr())}getByteFrequencyData(e){if(!this.active)return void e.fill(0);const t=this.segment.pitches;if(t){const n=md([.5,1,.5])(this.beat.progress)*this.volume,r=(this.segment.timbre[1]-180)/360,i=this.frequencyBinCount;for(let a=0;a<i;a++){let o=(a-i/2-r*i)/i+1;(o<0||o>2)&&(o=0);const s=Math.sin(o*(Math.PI/2)),l=qm(t,a,this.sampleSize);e[a]=(l+s)/2*255*n}}else e.fill(0)}getFloatFrequencyData(e){if(!this.active)return void e.fill(0);const t=e.length,n=new Uint8Array(t);this.getByteFrequencyData(n);for(let r=0;r<t;r++)e[r]=n[r]-128}getByteTimeDomainData(e){if(!this.active)return void e.fill(0);const t=e.length,n=new Float32Array(t);this.getFloatTimeDomainData(n);const r=Uint8Array.from(n);for(let n=0;n<t;n++)e[n]=r[n]}getFloatTimeDomainData(e){if(!this.active)return void e.fill(0);const t=e.length,n=new Float32Array(t);this.getFloatFrequencyData(n);const{real:r,imag:i}=(0,Km.rS)(n);for(let n=0;n<t;n++)e[n]=Math.sqrt(r[n]*r[n]+i[n]*i[n])-128}get activeIntervals(){return this.activeIntervals$.getValue()}get sampleSize(){return 22050/this.frequencyBinCount}observeActiveIntervals(){return ld().pipe(yn((e=>e?cn:this.activeIntervals$)),ze((()=>this.active)))}updateState(e){return Qm(this,void 0,void 0,(function*(){this.trackAnalysis=JSON.parse(JSON.stringify(this.currentTrackAnalysis)),this.intervalTypes.forEach((e=>{const t=this.trackAnalysis[e];t[0].duration=t[0].start+t[0].duration,t[0].start=0,t.forEach((e=>{this.isSegment(e)&&(e.loudness_max_time=1e3*e.loudness_max_time),e.start=1e3*(e.start||0),e.duration=1e3*(e.duration||0)}))})),this.initialTrackProgress=e.position,this.trackProgress=e.position,this.initialStart=window.performance.now()}))}setActiveIntervals(){const e=this.activeIntervals,t=e=>{const t=this.trackAnalysis[e],n=this.trackProgress;for(let e=0;e<t.length;e++){if(e===t.length-1)return e;if(t[e].start<n&&n<t[e+1].start)return e}return 0};this.intervalTypes.forEach((n=>{const r=t(n);null!=e[n].start&&r===e[n].index||(e[n]=Object.assign(Object.assign({},this.trackAnalysis[n][r]),{index:r}));const{start:i,duration:a}=e[n],o=this.trackProgress-i;e[n].elapsed=o,e[n].progress=this.easeOutQuart(o/a)})),this.activeIntervals$.next(e)}getVolume(){const{loudness_max:e,loudness_start:t,loudness_max_time:n,duration:r,elapsed:i,start:a,index:o}=this.activeIntervals.segments;if(!this.trackAnalysis.segments[o+1])return 0;const s=this.trackAnalysis.segments[o+1].loudness_start,l=a+i;if(i<n){const r=Math.min(1,i/n);return this.interpolate(t,e)(r)}{const t=l-(a+n),i=r-n,o=Math.min(1,t/i);return this.interpolate(e,s)(o)}}start(){this.animationFrameId||(this.animationFrameId=requestAnimationFrame((e=>this.tick(e))))}stop(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}tick(e){if(this.animationFrameId=requestAnimationFrame((e=>this.tick(e))),!this.active)return;this.trackProgress=e-this.initialStart+this.initialTrackProgress,this.setActiveIntervals();const t=this.getVolume(),n=this.queues;function r(e){return e.reduce(((e,t)=>e+t))/e.length}n.volume.unshift(t),n.volume.length>400&&n.volume.pop(),n.beat.unshift(t),n.beat.length>this.volumeSmoothing&&n.beat.pop();const i=Ym().domain([hd(n.volume),r(n.volume)]).range([0,1]),a=r(n.beat);!function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===r?i.call(e,n):i?i.value=n:t.set(e,n)}(this,Jm,i(a)||0,"f")}interpolate(e,t){return n=>e*(1-n)+t*n}isSegment(e){return"loudness_max_time"in e}easeOutQuart(e){return e=Math.min(Math.max(0,e),1),1- --e*e*e*e}}(Ll);class Xm extends AnalyserNode{constructor(e,t){super(e,t),this.isPlayingSpotify=!1,ad().subscribe((({currentItem:e})=>{this.isPlayingSpotify=!!(null==e?void 0:e.src.startsWith("spotify:"))}))}getByteFrequencyData(e){this.isPlayingSpotify?Gm.getByteFrequencyData(e):super.getByteFrequencyData(e)}getFloatFrequencyData(e){this.isPlayingSpotify?Gm.getFloatFrequencyData(e):super.getFloatFrequencyData(e)}getByteTimeDomainData(e){this.isPlayingSpotify?Gm.getByteTimeDomainData(e):super.getByteTimeDomainData(e)}getFloatTimeDomainData(e){this.isPlayingSpotify?Gm.getFloatTimeDomainData(e):super.getFloatTimeDomainData(e)}}class Zm extends AudioContext{createAnalyser(e){return new Xm(this,e)}}console.log("module::audio");const eh=new Zm,th=eh.createAnalyser({fftSize:2048,smoothingTimeConstant:0});let nh,rh;th.connect(eh.destination);const ih=new Ie(eh.createMediaElementSource(new Audio));function ah(){return ih.pipe(tr())}ad().subscribe((({currentItem:e})=>{if(null==e?void 0:e.src.startsWith("apple:")){if(!rh){const e=document.querySelector("audio#apple-music-player");e&&(rh=eh.createMediaElementSource(e))}rh&&ih.next(rh)}else{if(!nh){const e=document.querySelector("audio.html5-audio");e&&(nh=eh.createMediaElementSource(e))}nh&&ih.next(nh)}})),ah().pipe(kl(1)).subscribe((e=>e.connect(th)));const oh=new A("WaveformPlayer");class sh extends Ju{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.context2D=this.canvas.getContext("2d"),this.animationFrameId=0,this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-waveform"}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e||this.animationFrameId||this.render(performance.now()))}appendTo(e){e.append(this.canvas)}load(e){oh.log("load"),e&&(oh.log(`Using Waveform visualizer: ${e.name}`),this.config=e.config),this.autoplay&&this.play()}play(){oh.log("play"),this.animationFrameId||this.render(performance.now())}pause(){oh.log("pause"),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){oh.log("stop"),this.pause(),this.clear()}resize(e,t){this.canvas.width=e,this.canvas.height=t,this.renderFrame(performance.now())}clear(){const e=this.canvas.width,t=this.canvas.height;this.context2D.clearRect(0,0,e,t)}render(e){this.renderFrame(e),this.autoplay&&!this.hidden&&(this.animationFrameId=requestAnimationFrame((e=>this.render(e))))}renderFrame(e){var t,n;const r=this.context2D,i=this.canvas.width,a=this.canvas.height,o=this.analyser;null===(n=null===(t=this.config)||void 0===t?void 0:t.onPaint)||void 0===n||n.call(t,{context2D:r,width:i,height:a,now:e,analyser:o})}}const lh=new sh(th);lh.load({providerId:"waveform",name:"beats",config:{onPaint:({context2D:e,width:t,height:n,analyser:r})=>{const i=r.frequencyBinCount,a=new Uint8Array(i);r.getByteFrequencyData(a),e.clearRect(0,0,t,n),e.fillStyle=`rgba(255, 255, 255, ${document.fullscreenElement?.45:.6})`,e.strokeStyle="rgba(0, 0, 0, .9)",e.shadowColor="rgba(0, 0, 0, .6)",e.lineWidth=1,e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2;const o=(t-48)/12,s=.0075*n,l=i/12;let c,u=4;for(let t=0;t<i;t+=l){const r=a.slice(t,t+l).reduce(((e,t)=>e+t),0)/l;c=s*r,e.fillRect(u,n-c/2,o,c/2+4),e.strokeRect(u,n-c/2,o,c/2+4),u+=o+4}}}});const ch=lh,uh=new A("ambientVideoPlayer"),dh=new Qu("video","ambient"),mh=new $u("ambient"),hh=new z("ambientVideoPlayer");function fh(){return ed.useAmbientVideoSource&&ed.ambientVideoSource?"user-progress":"progress"}const ph=new Wu("ambient-video-player",[dh,mh,ch],(function(e){return e?e.src.startsWith("youtube:")?mh:dh:null}),(function(e,t){const n=t.src;if(n.startsWith("youtube:")){const[,,t]=n.split(":"),r=fh(),i=hh.getJson(r,{})[t]||("progress"===r?120:0);e.load(`${n}:${i}`)}else e.load(n)}));ph.loop=!0,ph.volume=0,ph.hidden=!0;const vh=new class extends Ju{constructor(e,t){super(),this.videoPlayer=e,this.beatsPlayer=t,td().pipe(Gt((e=>e.beatsOverlay)),tr()).subscribe((e=>{this.beatsPlayer.hidden=this.hidden||!e}))}get autoplay(){return this.videoPlayer.autoplay}set autoplay(e){this.videoPlayer.autoplay=e,this.beatsPlayer.autoplay=e}get hidden(){return this.videoPlayer.hidden}set hidden(e){this.videoPlayer.hidden=e,this.beatsPlayer.hidden=e||!ed.beatsOverlay}observeCurrentTime(){return this.videoPlayer.observeCurrentTime()}observeDuration(){return this.videoPlayer.observeDuration()}observeEnded(){return this.videoPlayer.observeEnded()}observeError(){return this.videoPlayer.observeError()}observePlaying(){return this.videoPlayer.observePlaying()}appendTo(e){this.videoPlayer.appendTo(e)}load(e){this.videoPlayer.load(e),this.autoplay&&ed.beatsOverlay&&this.beatsPlayer.play()}play(){this.videoPlayer.play(),ed.beatsOverlay&&this.beatsPlayer.play()}pause(){this.videoPlayer.pause(),this.beatsPlayer.pause()}stop(){this.videoPlayer.stop(),this.beatsPlayer.stop()}resize(e,t){this.videoPlayer.resize(e,t);const n=document.fullscreenElement?20:10;this.beatsPlayer.resize(xt.fontSize*n,xt.fontSize*n*.225)}}(ph,ch);mh.observeVideoId().pipe(yn((e=>e?mh.observeCurrentTime().pipe(Gt(Math.round),tr(),ze((e=>e>0&&e%30==0)),xl(mh.observeDuration()),ze((([,e])=>e>600)),$e((([t])=>{const n=fh(),r=hh.getJson(n,{});r[e]=t,hh.setJson(n,r)}))):cn))).subscribe(uh),td().pipe(Gt((e=>e.ambientVideoSource)),tr(),kl(1),$e((()=>hh.removeItem("user-progress")))).subscribe(uh);const bh="\nmo2re_RX3Bs blXien2Jh_o etiatMRgFcM DYsMJiwiZSI _MZ7UZ5frCI HCx1Z92PjJE dIP7wWY4Znw gW4nffCscYs\nA1m0SEqmmbE 9uZ8CCa0t4Y MXlFDpaQ1ec wz_ItcoR0-c jS4-FmNEDKo Tz77vqH_LJw K73lfmxDVR0 W8ayfyRWUrg\ncbuldALGsaQ AJZon2grzmA H5ASEM9dMiA GE2YEq7vaLc MYGOdJNAzrI Oszl95YWfbs b0-IkxXyhmY hoYPURX2RuE\nH6Xy97CD9Hs p-OUNPqRzII XaTxLSPh_Is 1n3ezT1cvAM CWU1pZVw0xM ry1Q7KaQdxM VlC5LSTvoj0 j-bG0j3-KzE\n1bClbVe4QyI f6OZ01vvmko o4jE24WixcI BIej9P2LrzM dxw91a7C5BQ lN9LdcAQnjw VVkZKzTbWQs vXCB1zGGFiY\nJHARFKMl8dU KSB1AZ0-I74 IGqfU6cJJc8 8zg22-ZCUfE WMlR8eJRS3I l4D6bnIdehk A5pbF_YBulo dRFRsKobN9I\nBur1ChHBNsQ IlDvBTDGanI SqMzG8xsynw mOmwk3WyYnw im2eWwIiTOc lxQS58t39_U yk076o8NF3k oggiHfuV4m8\np_GnUkm-G1M xVMsAgHy_IY VdZkfef44JI ZxOd8tmdsIM fszuqfJWKxc 0LGL_lx9XcA i_hU5eUrVIs qtwWkv9OdF0\nuZjCNtOeZG4 ZpXnEvW0XD0 -C8TYbhnVTU WzxSiEWK3cg ZE8vuq4aqNA 7HMw3bcIgRE ZJiCEDweLl8 lyh2kAjcmSY\nvFwqZ4qAUkE QLbPYQcUcgM xwf7EssFnXU QXac-wRKITA vvm8b2jAfv0 XkRFSnxXQ_w Ee0Qh_nIoHw 78rppSvbh7A\nNXIaYDJql1c VWHTlq5Fcr8 ZkRjihsMdp8 e1M6jHcRrlM z9Ug-3qhrwY mA30W2dHQIo XIhEPwTMjWk -Tm4H4CrKT0\nT6tapzmF_n0 7QetsPh7BPM xBDqge4w-XA suWbFuw1O_I OvStKpL5Ujo ZX8fSO8uTPg xX9xfFT-Qw0 hf3r9TNSsyY\n-WIamcIaipI Zjc6DwVDvq0 eHjoav_sb88 7E0WVROBsEE BvLIJSmzAnY YPurG3WT8xI 0ocUnSG4oQQ EkmJlmU7uqw\naC7s2UVXt3c EJArkl7K29k 9eFVeErnUzg CLDzwdixWsk B1-yyoNMUzs Ab5I38wGxko sVuqgnXD9AE yMcNorxM9IQ\nY0U0HAwpw2s G20ZaQfTWgs Nde5P8Ob2xg f-Xul0mdBCA ExStG9rRkoY tMzCwwvHwN0 iaVmsp7dU1Y TV4J01qGE8E\nMPch_urCew8 eYpCCSAW3aw XfBNIrQ5JKQ -b68N6Q4Qus H3mdjo7kYiQ 9CJLtzzUphU yy-aMo2ds2k fVRSSNkq3Bk\nLtPGmDskDiY U9rtWGI6H5A NHa506wwN0Y sFSrJSEFXu8 ubQKAfwSLDA aFsNz5VMyC8 h6yhFP_qUro GlotnVckHG4\nPEgQ0dIOB5c KWz3SXWnFys MGRDy2PqCGk 4DcMcAHrURw ETwbuC3p1ls iszl1WqjQIk njcvxMb8TVQ Vpi5By3PG68\nhNNN5xPyyeY 8ls8xBn70gM 2XREaQqoU1U MXL2qjIL4qI 9YqbQcfIre0 nAMkwo2eSbY 8DRItK-C7vU WdtkaLxc464\nPaIH77c53LA FSlhSL8bFoI XLuV3_a-ro0 mo7mUJZV6DM IqWPDr8KCmQ v-QS_Kh_i6o zowLNSKyfI0 Xn8tufsbSz0\n7gG4l70v8mw thurNCHVo08 YgryBZTMVZY XAmU3yQc90M KBUg3U3MRao v_My9t4gadA Xwb1xsWClCM KlH1g1x6RJk\nyFqew9NnNvk LMSmWzCqlPE oN3glsVrnRY PPBV3hem5iM eqzVRpevI8s nSJ67PGjQfQ EoBF2xRsbAc KDUYy3xwCFs\nRZOcoZS_52Q pSP9_otXcTU H36qe8NatNQ qgfd-uWTVwg Blu_yCEFYvk HeYMIBFtwh4 fb0QX7DbqLg kdqyAA0ILD4\nriZWEoGKyuU 4qo9bKRxgYA t0j_GdkG1BM hLq9J32lGRs zfc53CpvlZ4 IjNKQbm4AQ8 hg2FDCmqNkg tG991Undnbc\nsh8l2-cCAGQ XDE5pd4V_xc C2BVXFIX7bY ySPxZpoqXZ8 hiEUaLX4cCM 3F4l-6GwkKM F399teRPBaY 2jw2eAIW8sU\nWsCCYv2adkM wmV7Po_E0pw 9Rvtm2zGEl4 DGlAMkUjcY0 h2s_WOkfTXk 0VhxPdtX0xg 6vuFh6NNa70 ukOHqdPbYYg\nH6OmEQ8RqVk qPp315pPVSI FQqj6gN7M6M Xrwks9O2-JQ ipRwt3TDgY4 aVqRyfRviwA X33dmu12C5c QEwzFKoG7tk\nh98nR30UD8Q Z7WpAwRjprI ilqlSBYfCGs V6SoeDWDon0 d-Hwz42Vfw4 RCdAP0e4W4w 22dlye7h3qU p7l6JQApzak\nblSZ365wpfQ ADF4KgfhzPs jSRvD7Uma1g uLMC6bL_q38 k9DuPxFQ7HQ 7f2taFPyqxc vHf4WQtJvdI NXg0IKlrz-Q\nORHIVufNfRM RT4hEmX5OJ0 H3GL5jO53NU acTsYqhq-AA vp2yiZnjK0w eR5vsN1Lq4E yyNl2HuCTHk 55w2VtMNuvY\n7qXiAaxxGBs m6m6bqHiT6U l5jUOT0XiUM NLxwmtJSvk4 dv_QzcJGHAE kaPD4n9uQ2k r7HpeG2ofU0 O1AQcFpPs04\n44ih4WRTyGg W5BmjLsEsB0 JkNlFaei_k8 2ttB1FzBpZ4 k3Q1vse7In8 7xltSb3VBJQ ojbiGfhnjTU _Qb7TJ-T1HM\ngvT3gIDSwq8 4X95pykbYTY BPDznHIgVMA OIA5xQWkk2U 2uQ58Xwx1V4 UVjCFpYMR6A -uww0BzTb7g EqWBy5i8LyQ\nszErNcJMCdA 5k1DGpr_qDw YNEkjkh0bYo jmjrpHYegzc Eye8xYrjm24 rVLOQB5kGGw F8MN0o6RS9o viim_l9gbF8\nsBtYWK817-0 g0IvwhzSIW0 y7vz1qQGUd8 -0ewPjoBBNI S1emxk9UWBE 1muEwEFDKgk P0MbbslO62E TX9U62sj5nM\nwwXpkTd1CaQ W2A_PcIhUVM ZIb8u6uJwBo TWjid2dVjMk gdJjc6l6iII n3Dru5y3ROc OOf4Z7tyLVM iDXDrTKJehk\nwYhliE9O_3k nw0uvJZonBc cK7x6lUUsYo ltNMSx_imZU e2AUzM6QgGs 3cxyYOXiJss AsD5u6k6dKI d_hx39kXDUg\nhlvfDL3nSoo 6L2xYzu724E URy2Ak-WRpE 9N-sp0FaZEA yttvb9ByOtY ctqujFKaFZQ orTy-IqN9_I JdkM1EBCCKs\nef1wAfrMg5I eN-RZVkFGj0 KPV1hFJIXrg -bp4Bgs7MaQ u1rRUwx_Vy4 iTjgWeJMUJo WL9EOfzoSsA xrCNwCD-z-M\nCC3AanQdQZA ZGLrP5eawdY HoOghpRTkvs N787WRdI35A Cw0d-nqSNE8 2vifO3_gjiM OeJ5xXrbkfU vkYBLYAGavM\njP4gBqxfheI HHi8qOtHnhE oN8q7p57nZw 6vnxzfejWN4 gVamQ6jodK0 iU5QjAbuhec qLIU_90P4Ac z8k_ximc8Og\nZFBoN7yIMZw 4mexI7cACZk bx-0YlFprqc NDWpXTg3koc Vo2AcHSCRiQ UrfJgjQt1SY WXI7byeZk5s y8d7Ihe0IwE\nubmUJcwor3k CGslieDL-04 w7ljU-lmaK4 I0B21LjeSUQ PyFN_FYwqvc bxy9PFJRJ0g ahmrb5EYoxY HGxuVWpN8vQ\nDNR1zyr5Go4 eyPhudLTuis aPWXL4ahxdY JB0A8Me8EKk dGy_6qyyY7c rxrDLgt5YFA uhcocK-td5E 4Z5FLeh7P18\nVB0zDS9ITmk VukLV0AoeFA CouF-tNHV3g lTvYjERVAnY S27YOjpgaaE 24uCC_-zaaE DslTxXsDLsw xilGAQPx5Xw\n9eu4yqpxQGU FDqQlAUDZyk R1OHRQoJOP0 fbqmVbEj9fg asL1AN3hifU fd8spJiYS0k 3ma3yXXc3V8 1U1We59en3s\niNm7PPqO6rM CLRk8SgtVS4 VYO8Biwffns 9Wm8Ij8rHIE ZMOC332wC7A doORhRob3Qg E2sSvVCRI4s 2aVxI4PSiDI\nE6Ww7lpuZ2k Ueqm3PQKYPk eFiKAcbp2MY dAfMgDBeqwU MsUOx11_eLk LAFK1EvwulU OF0iDephya8 L_mlofcsRaA\neZe4Q_58UTU NXObT_Fl-xI H222V6b4DCg _WkkH31sTMI ALJcKvnOjHM 85Y1N8avsXs NCY42RnUpCE 48rsDblF5Ig\n0Tpq2mLtXDc Zp1Oajc7VQw WGi4XiEGe8M b6L40CEYVyM Mw9qiV7XlFs UgHKb_7884o mvIYmMo906E VoXOYFlJTuI\nfsjdpo1o-J8 k9rKpHXwA1E MTG3VA-m6qk cU3XY6Ii8v0 NBIdmswtcnM k5sznEJz8BA R8W3U0Mu6t4 7iSOMLkFizU\n6KBo0GhU9XM d5R3FK9vLBs N5b7Iy4W0ow 2FE1_YK5OPI pughd7ysJyQ A-mPDdnzipI 6gqU-HL68wE RKWLu6UHryQ\nVIlQIVVLWVs 6A-kQCdEIpI _lisL6tLbdg VarS6olPfTA va306f9aN3A YlPawyXaMJI KpFU_kIw6To hNC6-bxHJac\nJBm1ainuk-c PkF4EKJQOOg 0aMUCiKjBDI D1KsEOUqCEU JdE_xc1rQBY omlVslJvzxQ FoS3732REf0 kNMOaRRBat4\nqqC80mXlOKo MS2asGj1-_M NmP0RylitI4 IahW6hJ1-SM 9MIJm1NeUpE 2qzbMPpgtDw H3UY2gQfj-s 9kekiNImlsI\n5zUCClmhjF0 88jpBZdsrT8 UdFae3BAH38 MAFdQs_yWvg BHgDL6ODWSU p7G1lkYIFTM yAKSGmQkjxM 7TML_MTQdg4\nSH4f_DnPIto oaQ8UXlKDiw 5rf_gOfa7O4 MYG6FeY4SKg AVzdfRpE9Q0 1UxoHtG2qas o7XgU4ut6jQ IcOYM87wTRc\noPetbPLA8dM F41dgN-mwrE tpRBHKAJ_tU sTy4stPcD0E p4jroQX6Hwk y2Zl-KXvdSk zffchwaq6KE jv7hNnJEWPU\nDN-BxbMH264 mWaC_VSncEg 8x5Yzxi3LhA 0Txa_T4pHY4 McT_FUPZR5k 5rTo8-CPgU4 WbUgBaEsugI QytjUFgcmWw\n6BLY2zj6pq0 W5Y0deEEszo U6jAaBK7idQ rHZlMW_zxaE 4Xp4J5RYns0 Xsf2ThMqNBM lUbOyYp91NU dpuTxI8KAyc\nOIoAJfLDW1U bXK3EZ1AOZ0 nV62c0XBLDg 7ZWSdWxHAzY LVJHOKOIXK4 8QdnY1lACEs BfkdRwJAeu8 qyCXiUtWhD0\nXLNixgPHzao Q-iZMkvHnFw O47-jQYPznA H0RwPrdQs9g 5hkJkYLounY tlgv2urELis zHAbIALBaog cvoo5xXtiEA\nRpHnKaxt_OQ GsqsG3axUCs eMv6SCniTPg 5BdpkKiY3Fw _85ElkxtQa4 xCfEA0kuNww zsdPYFPTdw0 9pTT6867XJ4\nDUhdSWsapuA EmxS4JvlT5k CGBPXRi1nrM P9iRIGoIc9g Cy3okiPj26M TaKvapV_BwU jg5mnvYmrzU eG89_Vk_cqE\nwqoJj3ZJnXA N3DgwOn9yGI mvUV0FNBnGI 5FJWKoV07VM VaTBFaLFvHk EwlhQziQ-kw c9Ydsd89vWc Id83Esvmmb0\n09h57SoWrvE kwgeurY2omQ uLZlVUnQYY8 4jdV5FbvHpM 44KChB6CQOI XCUk8cRysW4 OdsIYD9F6Og _8fm1yqbPA4\n0hvAQ9hE-V0 df2q8ciX2rU p08ErTYMOh0 MvmxZj9Bo1I fDZYQD1GDd4 cJwiiXmPg-Y fWnlQnposC4 pYqScYQZ-o8\nQ7W4JISNmQk fryghm20GnQ jgtcAEUtgF4 XPKTAyKWoIo n5PqysUA4lU 0bJWDOTyCTY YJJA6pUx2FY JBlJrTkJxi0\nhsNMJp8G5tA pO13fJttJBE iw44ObI2cig 0KIWOl_lF2A 001TlVo_jmg kt0qIFPQBJg 0tZ2Y8kpCLI bzADvjia-mw\nqZezMIk7Oq4 ZHNYXUmEGoU 8dFr3YqPaeg M9KXG8jCq2U djP_T_rp09s Tyd_wjLfA_E ymRww99Yb-I zQrgF2izz2Y\nW0Kl0QfMEPo 5bwHtF7fR94 IXSTdSv-Jlo mf5E3FDZ6rY 7JsOhtl_zG4 vr5dCRHAgb0 Di9jRVy7WHk cVdfUy_VMTY\nLD_jcIQGl0Q ZXas8NdyLsE ELUl-cAtUIE wjMf_bEfqIc\n".match(/\S+/g).map((e=>({providerId:"ambientvideo",name:e,src:`youtube:video:${e}`})));console.log("Default ambient videos:",bh.length);const gh=new A("ambientvideo/visualizers"),yh=new Ie([]);function wh(){return yh}td().pipe(ec(1),Gt((e=>!!e.ambientVideoEnabled)),tr(),yn((e=>e?td().pipe(Gt((e=>!!e.useAmbientVideoSource)),tr(),yn((e=>e?td().pipe(Gt((e=>e.ambientVideoSource||"")),tr(),yn((e=>e?function(e){return t=this,n=void 0,i=function*(){const t=Ao(e),[,n,r]=t.split(":");let i=[r];return"playlist"===n&&(i=yield function(e){return zu(this,void 0,void 0,(function*(){const t=new Lu(e);try{return yield t.loadPlaylist()}finally{t.destroy()}}))}(t)),i.map((e=>({providerId:"ambientvideo",name:e,src:`youtube:video:${e}`})))},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(t.value).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}(e):Pn([])))):Pn(bh)))):Pn([]))),cr((e=>(gh.error(e),Pn([]))))).subscribe(yh),wh().pipe(Gt((e=>e.length)),$s((e=>0===e))).subscribe(gh.rx("size"));const Eh={id:"ambientvideo",name:"Ambient Video",defaultHidden:!0,player:vh,get visualizers(){return yh.getValue()},observeVisualizers:wh},xh=new A("AmpShaderPlayer");const kh=new Ie([]);setTimeout((()=>{return e=void 0,t=void 0,i=function*(){const{default:e}=yield n.e(595).then(n.bind(n,7281));e&&kh.next(e)},new((r=void 0)||(r=Promise))((function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())}));var e,t,r,i}),1e3);const Sh=new class extends Ju{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.gl=this.canvas.getContext("webgl2"),this.animationFrameId=0,this.fragTheme=null,this.fragTime=null,this.fragChannelTime=null,this.fragDate=null,this.shader=null,this.startTime=performance.now();const t=this.gl;this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-ampshader";const n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.R8,512,2,0,t.RED,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR);const r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r);const i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),t.STATIC_DRAW)}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e||this.animationFrameId||this.render())}appendTo(e){e.append(this.canvas)}load(e){xh.log("load"),e&&(xh.log(`Using Ampshader visualizer: ${e.name}`),this.createShader(e.shader)),this.play()}play(){xh.log("play"),this.animationFrameId||this.render()}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){const n=this.canvas,r=this.gl;if(n.width=e,n.height=t,r.viewport(0,0,e,t),this.shader){const e=r.getUniformLocation(this.shader,"iResolution");r.uniform2f(e,n.width,n.height),this.renderFrame()}}get currentDate(){const e=new Date;return[e.getFullYear(),e.getMonth(),e.getDate(),3600*e.getHours()+60*e.getMinutes()+e.getSeconds()+.001*e.getMilliseconds()]}get currentTime(){return(performance.now()-this.startTime)/1e3}get themeColor(){const{r:e,g:t,b:n}=new Xe(xt.frameColor).toRgb();return[e,t,n,1]}clear(){}createShader(e){const t=this.gl,n=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(n,"#version 300 es\nin vec4 as_Position;void main(void){gl_Position=as_Position;}"),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n));const r=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(r));const i=t.createProgram();t.attachShader(i,n),t.attachShader(i,r),t.linkProgram(i),t.useProgram(i);const a=t.getAttribLocation(i,"as_Position");t.enableVertexAttribArray(a),t.vertexAttribPointer(a,2,t.FLOAT,!1,0,0),this.fragTheme=t.getUniformLocation(i,"iTheme"),t.uniform4f(this.fragTheme,...this.themeColor),this.startTime=performance.now();const o=this.currentTime;this.fragTime=t.getUniformLocation(i,"iTime"),t.uniform1f(this.fragTime,o),this.fragChannelTime=t.getUniformLocation(i,"iChannelTime"),t.uniform1fv(this.fragChannelTime,new Float32Array([o,0,0,0])),this.fragDate=t.getUniformLocation(i,"iDate"),t.uniform4f(this.fragDate,...this.currentDate);const s=t.getUniformLocation(i,"iResolution");t.uniform2f(s,this.canvas.width,this.canvas.height),this.shader=i}render(){this.renderFrame(),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((()=>this.render())))}renderFrame(){if(this.shader){const e=this.gl,t=this.analyser.frequencyBinCount,n=new Uint8Array(t),r=new Uint8Array(t),i=new Uint8Array(1024);this.analyser.getByteFrequencyData(n),this.analyser.getByteTimeDomainData(r);for(let e=0;e<512;e++)i[e]=n[e],i[e+512]=r[e];const a=this.currentTime;e.uniform1f(this.fragTime,a),e.uniform1fv(this.fragChannelTime,new Float32Array([a,0,0,0])),e.uniform4f(this.fragDate,...this.currentDate),e.uniform4f(this.fragTheme,...this.themeColor),e.texImage2D(e.TEXTURE_2D,0,e.R8,512,2,0,e.RED,e.UNSIGNED_BYTE,i),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}}}(th),Ch={id:"ampshader",name:"ampshader",player:Sh,get visualizers(){return kh.getValue()},observeVisualizers:function(){return kh}};var Th=n(8841);const Ph=new A("AudioMotionPlayer"),Ah="audiomotion",Ih=[{providerId:Ah,name:"Anemone",options:{radial:!0,ledBars:!1,spinSpeed:1,mode:8,barSpace:0,gradient:"ampcast-rainbow",reflexRatio:.4,showPeaks:!0,mirror:-1,maxFreq:8e3,lineWidth:2,fillAlpha:.2}},{providerId:Ah,name:"Classic LEDs",options:{mode:7,barSpace:0,gradient:"ampcast-classic",ledBars:!0,lumiBars:!1,radial:!1,reflexRatio:0,showPeaks:!0}},{providerId:Ah,name:"Mirror wave",options:{mode:10,fillAlpha:.6,gradient:"ampcast-rainbow",lineWidth:2,mirror:-1,radial:!1,reflexAlpha:1,reflexBright:1,reflexRatio:.5,showPeaks:!1}},{providerId:Ah,name:"Radial overlay",options:{mode:5,barSpace:.1,gradient:"ampcast-prism",radial:!0,ledBars:!1,showPeaks:!0,spinSpeed:1}},{providerId:Ah,name:"Reflex Bars",options:{mode:5,barSpace:.25,gradient:"ampcast-prism",lumiBars:!1,radial:!1,reflexAlpha:.25,reflexBright:1,reflexFit:!0,reflexRatio:.3,ledBars:!1,showPeaks:!0}}];console.log("audioMotion-analyzer visualizers:",Ih.length);const Oh=Ih,Mh=new class extends Ju{constructor(e,t){super();const n=this.element=document.createElement("div");n.hidden=!0,n.className="visualizer visualizer-audiomotion";const r=this.visualizer=new Th.Z(n,{audioCtx:e,showBgColor:!1,overlay:!0,showScaleX:!1,showScaleY:!1,connectSpeakers:!1});t.subscribe((e=>{this.audioSourceNode=e,this.element.hidden||r.connectInput(e)})),xt.observe().pipe($e((()=>this.registerGradients()))).subscribe(Ph)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden!==e&&(this.element.hidden=e,e?this.visualizer.disconnectInput():this.audioSourceNode&&this.visualizer.connectInput(this.audioSourceNode))}appendTo(e){e.append(this.element)}load(e){Ph.log("load"),e&&(Ph.log(`Using AudioMotion visualizer: ${e.name}`),this.visualizer.setOptions(e.options)),this.autoplay&&this.play()}play(){Ph.log("play"),this.visualizer.toggleAnalyzer(!0)}pause(){Ph.log("pause"),this.visualizer.toggleAnalyzer(!1)}stop(){this.visualizer.toggleAnalyzer(!0)}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}registerGradients(){const e=new Xe(xt.isMediaButtonLight?xt.mediaButtonColor:xt.defaultMediaButtonColor),t=[new Xe(xt.mediaButtonColor),new Xe(xt.defaultMediaButtonColor),new Xe(xt.frameColor),new Xe(xt.frameTextColor),new Xe(xt.backgroundColor),new Xe(xt.textColor)].filter((e=>e.getBrightness()<200&&e.getLuminance()>.3&&e.toHsl().s>.3)).sort(((e,t)=>t.getLuminance()-e.getLuminance()))[0]||e,n=t.tetrad().map((e=>e.toRgbString())).slice(1);this.visualizer.registerGradient("ampcast-classic",{bgColor:xt.black,colorStops:[n[0],{pos:.6,color:n[1]},n[2]]}),this.visualizer.registerGradient("ampcast-prism",{bgColor:xt.black,colorStops:xt.getVisualizerColors()}),this.visualizer.registerGradient("ampcast-rainbow",{bgColor:xt.black,colorStops:e.analogous().map((e=>e.toRgbString()))})}}(eh,ah()),Nh={id:"audiomotion",name:"audioMotion-analyzer",externalUrl:"https://audiomotion.dev/",player:Mh,visualizers:Oh,observeVisualizers:()=>Pn(Oh)};var $h=n(2238),zh=n.n($h);const jh=new A("ButterchurnPlayer");const Lh=new Ie([]);function Rh(){return Lh.getValue()}setTimeout((()=>{return e=void 0,t=void 0,i=function*(){const e="butterchurn",{default:t}=yield n.e(577).then(n.t.bind(n,6607,23));if(t){Lh.next(Object.keys(t).map((n=>({providerId:e,name:n,data:t[n]}))));const{default:r}=yield n.e(271).then(n.t.bind(n,3710,23));r&&Lh.next(Rh().concat(Object.keys(r).map((t=>({providerId:e,name:t,data:r[t]})))))}},new((r=void 0)||(r=Promise))((function(n,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){e.done?n(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(o,s)}l((i=i.apply(e,t||[])).next())}));var e,t,r,i}),1e3);const Dh={id:"butterchurn",name:"Butterchurn (Milkdrop)",externalUrl:"https://butterchurnviz.com/",player:new class extends Ju{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.context2D=this.canvas.getContext("2d"),this.animationFrameId=0,this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-butterchurn",(this.visualizer=zh().createVisualizer(e.context,this.canvas,{width:400,height:200})).connectAudio(e)}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e?this.visualizer.disconnectAudio(this.analyser):(this.visualizer.connectAudio(this.analyser),this.animationFrameId||this.render()))}appendTo(e){e.append(this.canvas)}load(e){e&&(jh.log(`Using Butterchurn visualizer: ${e.name}`),this.visualizer.loadPreset(e.data,.5),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0),this.render())}play(){jh.log("play"),this.animationFrameId||this.render()}pause(){jh.log("pause"),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){this.canvas.width=e,this.canvas.height=t,this.visualizer.render(),this.visualizer.setRendererSize(e,t),this.visualizer.render()}clear(){const e=this.canvas.width,t=this.canvas.height;this.context2D.clearRect(0,0,e,t)}render(){this.visualizer.render(),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((()=>this.render())))}}(th),get visualizers(){return Rh()},observeVisualizers:function(){return Lh}},_h=new A("SpotifyVizPlayer");let Fh="",Vh="";const Uh={volumeSmoothing:10,onBar(){const e=xt.getVisualizerColors();Fh=Vh||E(e),Vh=E(e.filter((e=>e!==Vh)))},onPaint({context2D:e,height:t,width:n,now:r,analyser:i}){const a=md([0,10*i.volume,0])(i.bar.progress),o=md([0,300*i.volume,0])(i.beat.progress),{r:s,g:l,b:c}=new Xe(xt.black).toRgb(),u=`${s},${l},${c}`;e.fillStyle=`rgba(${u},0.08)`,e.fillRect(0,0,n,t),e.lineWidth=a,e.strokeStyle=wm(Fh,Vh)(i.bar.progress),function(e,t,n,r,i,a=5){const o=e=>r*Math.sin(e/i+t)+n,{width:s}=e.canvas;e.beginPath();for(let t=-50;t<s+50;t+=a)-50===t?e.moveTo(t,o(t)):e.lineTo(t,o(t))}(e,r/50,t/2,50*i.volume,100),e.stroke(),e.fillStyle=`rgb(${u})`,e.beginPath(),e.lineWidth=o,function(e,t,n,r,i=0,a=2*Math.PI){e.beginPath(),e.arc(t,n,r,i,a),e.closePath()}(e,n/2,t/2,i.volume*t/5+o/10),e.stroke(),e.fill()}},Bh=[{providerId:"spotifyviz",name:"example by zachwinter",config:Uh,externalUrl:"https://github.com/zachwinter/spotify-viz/blob/master/client/example.js"}],Hh=Bh;console.log("spotify-viz visualizers:",Bh.length);const Yh={id:"spotifyviz",name:"spotify-viz",externalUrl:"https://github.com/zachwinter/spotify-viz/",player:new class extends Ju{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.context2D=this.canvas.getContext("2d"),this.animationFrameId=0,this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-spotifyviz",e.observeBar().subscribe((e=>{var t,n;null===(n=null===(t=this.config)||void 0===t?void 0:t.onBar)||void 0===n||n.call(t,e)})),e.observeBeat().subscribe((e=>{var t,n;null===(n=null===(t=this.config)||void 0===t?void 0:t.onBeat)||void 0===n||n.call(t,e)})),e.observeSection().subscribe((e=>{var t,n;null===(n=null===(t=this.config)||void 0===t?void 0:t.onSection)||void 0===n||n.call(t,e)})),e.observeSegment().subscribe((e=>{var t,n;null===(n=null===(t=this.config)||void 0===t?void 0:t.onSegment)||void 0===n||n.call(t,e)})),e.observeTatum().subscribe((e=>{var t,n;null===(n=null===(t=this.config)||void 0===t?void 0:t.onTatum)||void 0===n||n.call(t,e)}))}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e||this.animationFrameId||this.render(performance.now()))}appendTo(e){e.append(this.canvas)}load(e){var t,n;_h.log("load"),e&&(_h.log(`Using SpotifyViz visualizer: ${e.name}`),this.config=e.config,this.analyser.volumeSmoothing=null!==(n=null===(t=e.config)||void 0===t?void 0:t.volumeSmoothing)&&void 0!==n?n:100),this.autoplay&&this.play()}play(){_h.log("play"),this.animationFrameId||this.render(performance.now())}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){this.canvas.width=e,this.canvas.height=t,this.renderFrame(performance.now())}clear(){const e=this.canvas.width,t=this.canvas.height;this.context2D.clearRect(0,0,e,t)}render(e){this.renderFrame(e),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((e=>this.render(e))))}renderFrame(e){var t,n;const r=this.context2D,i=this.canvas.width,a=this.canvas.height,o=this.analyser;null===(n=null===(t=this.config)||void 0===t?void 0:t.onPaint)||void 0===n||n.call(t,{context2D:r,width:i,height:a,now:e,analyser:o})}}(Gm),visualizers:Hh,observeVisualizers:()=>Pn(Hh)};function Kh(){return xt.isLight&&xt.isFrameLight?xt.frameColor:xt.isTextLight?xt.textColor:xt.frameTextColor}const Wh=[{providerId:"waveform",name:"wave",config:{onPaint:({context2D:e,width:t,height:n,analyser:r})=>{const i=r.frequencyBinCount,a=new Uint8Array(i),o=t/i;let s=0;e.lineWidth=Math.round(xt.fontSize/4),e.clearRect(0,0,t,n),e.strokeStyle=Kh(),e.beginPath(),r.getByteTimeDomainData(a);for(let t=0;t<i;t++){const r=a[t]/128*n/2;0===t?e.moveTo(s,r):e.lineTo(s,r),s+=o}e.lineTo(t,n/2),e.stroke()}}},{providerId:"waveform",name:"bars",config:{onPaint:({context2D:e,width:t,height:n,analyser:r})=>{const i=r.frequencyBinCount,a=new Uint8Array(i);r.getByteFrequencyData(a),e.clearRect(0,0,t,n),e.fillStyle=Kh();const o=(t-30)/16,s=.0075*n,l=i/16;let c,u=0;for(let t=0;t<i;t+=l){const r=a.slice(t,t+l).reduce(((e,t)=>e+t),0)/l;c=s*r,e.fillRect(u,n-c/2,o,c/2),u+=o+2}}}}],qh=Wh;console.log("Waveform visualizers:",Wh.length);const Jh={id:"waveform",name:"Waveform",externalUrl:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Visualizations_with_Web_Audio_API",player:new sh(th),visualizers:qh,observeVisualizers:()=>Pn(qh)};function Qh(){return[Eh,Ch,Nh,Dh,Yh,Jh]}function Gh(e){return Qh().find((t=>t.id===e))}function Xh(e){var t;return(null===(t=Gh(e))||void 0===t?void 0:t.visualizers)||[]}console.log("module::visualizerPlayer");const Zh=new A("visualizerPlayer"),ef=new Wu("visualizer-player",Qh().map((e=>e.player)),(function(e){return function(e){var t;return null===(t=Gh(e))||void 0===t?void 0:t.player}(e.providerId)||null}),(function(e,t){e.load(t)}));ef.loop=!0,ef.muted=!0,ef.volume=.07,ef.observeError().subscribe(Zh.error);const tf=ef;var nf,rf,af=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},of=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};const sf=new A("MusicKitPlayer"),lf="Apple Music player not connected.",cf="Video playback not supported.";nf=new WeakMap,rf=new WeakMap;const uf=new class{constructor(e){this.isLoggedIn$=e,this.paused$=new Ie(!0),this.duration$=new Pe,this.currentTime$=new Pe,this.ended$=new Pe,this.playing$=new Pe,this.error$=new Pe,this.playerReady$=new Pe,this.activated$=new Ie(!1),this.src$=new Ie(""),this.loadedSrc="",this.isLoggedIn=!1,this.hasPlayed=!1,this.loop=!1,this.autoplay=!1,nf.set(this,!0),rf.set(this,1),this.onPlaybackStateChange=({state:e})=>{switch(e){case MusicKit.PlaybackStates.playing:{const[,,e]=this.src.split(":"),t=this.player.nowPlayingItem;!1===(null==t?void 0:t.isPlayable)&&(null==t?void 0:t.id)===e?(this.error$.next(Error("Unplayable")),this.stop()):this.paused?this.pause():this.playing$.next(void 0);break}case MusicKit.PlaybackStates.ended:this.ended$.next(void 0)}},this.onPlaybackDurationChange=({duration:e})=>{this.duration$.next(e)},this.onPlaybackTimeChange=({currentPlaybackTime:e})=>{this.currentTime$.next(e)},this.onPlaybackError=e=>{this.error$.next(e)};const t=this.element=document.createElement("div");t.hidden=!0,t.className="apple-video",t.id="apple-music-video-container",this.observeIsLoggedIn().pipe(ze((e=>e)),$e((()=>{const e=this.player=MusicKit.getInstance(),t=MusicKit.Events;e.addEventListener(t.playbackStateDidChange,this.onPlaybackStateChange),e.addEventListener(t.playbackDurationDidChange,this.onPlaybackDurationChange),e.addEventListener(t.playbackTimeDidChange,this.onPlaybackTimeChange),e.addEventListener(t.mediaPlaybackError,this.onPlaybackError),e.volume=this.muted?0:this.volume,this.playerReady$.next(void 0)})),hr(1)).subscribe(sf),this.observeReady().pipe(yn((()=>this.observeIsLoggedIn())),yn((e=>e?this.observePaused():cn)),yn((e=>e?cn:this.observeSrc())),yn((e=>{if(e&&e!==this.loadedSrc){if(!this.canPlay(e))return this.error$.next(Error(cf)),cn;const[,t,n]=e.split(":"),r=t.replace("library-","").replace(/s$/,"").replace(/-([a-z])/g,((e,t)=>t.toUpperCase()));return vn(this.player.setQueue({[r]:n})).pipe(yn((()=>(this.loadedSrc=e,this.autoplay?this.safePlay():cn))),cr((e=>(this.loadedSrc="",this.error$.next(e),cn))))}return cn}))).subscribe(sf),this.observeIsLoggedIn().pipe($s((e=>e===this.isLoggedIn)),$e((e=>{var t;this.isLoggedIn=e,e||(this.loadedSrc="",(null===(t=this.player)||void 0===t?void 0:t.isPlaying)&&(this.stop(),this.error$.next(Error(lf))))}))).subscribe(sf),this.observeError().subscribe(sf.error),this.observeError().pipe(ze((()=>{var e;return!1===(null===(e=this.player)||void 0===e?void 0:e.isAuthorized)})),yn((()=>Nr())),cr((()=>cn))).subscribe(sf)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e}get muted(){return af(this,nf,"f")}set muted(e){af(this,nf,"f")!==e&&(of(this,nf,e,"f"),this.player&&(this.player.volume=e?0:this.volume))}get volume(){return af(this,rf,"f")}set volume(e){af(this,rf,"f")!==e&&(of(this,rf,e,"f"),this.player&&(this.player.volume=this.muted?0:e))}observeCurrentTime(){return this.currentTime$.pipe(tr())}observeDuration(){return this.duration$.pipe(tr())}observePlaying(){return this.playing$}observeEnded(){return this.ended$}observeError(){return this.error$}appendTo(e){e.appendChild(this.element)}load(e){sf.log("load",{src:e}),this.autoplay&&this.activated$.next(!0),this.src$.next(e),this.autoplay&&this.paused$.next(!1),this.player&&this.isLoggedIn?this.autoplay&&(e===this.loadedSrc?this.safePlay():this.canPlay(e)||this.error$.next(Error(cf))):this.autoplay&&this.error$.next(Error(lf))}play(){sf.log("play"),this.activated$.next(!0),this.paused$.next(!1),this.player&&this.isLoggedIn?this.src===this.loadedSrc?this.safePlay():this.canPlay(this.src)||this.error$.next(Error(cf)):this.error$.next(Error(lf))}pause(){var e;sf.log("pause"),this.paused$.next(!0),(null===(e=this.player)||void 0===e?void 0:e.isPlaying)&&this.player.pause()}stop(){sf.log("stop"),this.paused$.next(!0),this.hasPlayed&&this.player.stop()}seek(e){var t;null===(t=this.player)||void 0===t||t.seekToTime(e)}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}get paused(){return this.paused$.getValue()}get src(){return this.src$.getValue()}observeIsLoggedIn(){return this.isLoggedIn$}observePaused(){return this.paused$.pipe(tr())}observeReady(){return this.playerReady$.pipe(yn((()=>this.activated$)),ze((e=>e)),Gt((()=>{})),hr(1))}observeSrc(){return this.src$.pipe(tr())}canPlay(e){var t;return!(null===(t=this.player)||void 0===t?void 0:t.version.startsWith("1"))||!/musicVideo/.test(e)}safePlay(){var e,t,n,r,i;return t=this,n=void 0,i=function*(){try{!1===(null===(e=this.player)||void 0===e?void 0:e.isPlaying)&&(yield this.player.play(),this.hasPlayed=!0)}catch(e){this.error$.next(e)}},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(t.value).then(o,s)}l((i=i.apply(t,n||[])).next())}))}}(Or());console.log("module::mediaPlayer");const df=new Qu("audio","main"),mf=new Qu("video","main"),hf=new $u("main"),ff=new Wu("media-player",[df,mf,hf,uf,Ll],(function(e){return e?e.src.startsWith("youtube:")?hf:e.src.startsWith("apple:")?uf:e.src.startsWith("spotify:")?Ll:e.mediaType===jr.Video?mf:df:null}),(function(e,t){if(null==t?void 0:t.unplayable)throw Error("Unplayable.");e.load(function(e){return e?e.blob?URL.createObjectURL(e.blob):e.src||"":""}(t))}));var pf=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::jellyfinReporting");const vf=new A("jellyfinReporting");function bf(e,t,n,r){return pf(this,void 0,void 0,(function*(){try{const[,,i]=e.src.split(":");yield Ei.post("Sessions/Playing/Progress",{ItemId:i,IsPaused:n,PositionTicks:Math.floor(1e7*t),PlayMethod:"Transcode",EventName:r})}catch(e){vf.error(e)}}))}console.log("module::jellyfinScrobbler");const gf=new A("jellyfinScrobbler"),yf=e=>{var t;return!!(null===(t=e.currentItem)||void 0===t?void 0:t.src.startsWith("jellyfin:"))};Ki().pipe(yn((e=>e?ad():cn)),ze(yf),Zt((({currentItem:e})=>function(e){return pf(this,void 0,void 0,(function*(){try{const[,,t]=e.src.split(":");yield Ei.post("Sessions/Playing",{ItemId:t,IsPaused:!1,PositionTicks:0,PlayMethod:"Transcode"})}catch(e){vf.error(e)}}))}(e)))).subscribe(gf),Ki().pipe(yn((e=>e?od():cn)),ze(yf),Zt((({currentItem:e,currentTime:t})=>function(e,t){return pf(this,void 0,void 0,(function*(){try{const[,,n]=e.src.split(":");yield Ei.post("Sessions/Playing/Stopped",{ItemId:n,IsPaused:!1,PositionTicks:Math.floor(1e7*t),PlayMethod:"Transcode"})}catch(e){vf.error(e)}}))}(e,t)))).subscribe(gf),Ki().pipe(yn((e=>e?sd(1e4):cn)),ze(yf),ze((({currentTime:e})=>e>0)),Zt((({currentItem:e,currentTime:t,paused:n})=>bf(e,t,n,"timeupdate")))).subscribe(gf),Ki().pipe(yn((e=>e?ad():cn)),yn((e=>yf(e)?id().pipe(tr(((e,t)=>e.paused===t.paused)),kl(1),wn(od())):cn)),Zt((({currentItem:e,currentTime:t,paused:n})=>bf(e,t,n,n?"pause":"unpause")))).subscribe(gf);const wf=new z("scrobbling"),Ef=new Ie(wf.getJson("noScrobble",{})),xf=new Ie(wf.getJson("options",{}));function kf(e,t){var n;const r=Ef.getValue()[e.id];return!(null!==(n=null==r?void 0:r[t.id])&&void 0!==n?n:t.defaultNoScrobble)}function Sf(e,t){const n=Ef.getValue(),r=n[e.id],i=Object.assign(Object.assign({},r),t),a=Object.assign(Object.assign({},n),{[e.id]:i});wf.setJson("noScrobble",a),Ef.next(a)}function Cf(e){var t;return!!(null===(t=xf.getValue()[e.id])||void 0===t?void 0:t.updateNowPlaying)}function Tf(e,t){const n=xf.getValue(),r=n[e.id],i=Object.assign(Object.assign({},r),t),a=Object.assign(Object.assign({},n),{[e.id]:i});wf.setJson("options",a),xf.next(a)}const Pf={canScrobble:kf,setNoScrobble:Sf,canUpdateNowPlaying:Cf,updateOptions:Tf};console.log("module::lastfmScrobbler");const Af=new A("lastfmScrobbler");function If(e){const[t]=e.src.split(":"),n=_l(t);return!n||Pf.canScrobble(_a,n)}Sa().pipe(yn((e=>e?ad():cn)),ze((()=>Pf.canUpdateNowPlaying(_a))),Gt((({currentItem:e})=>e)),ze(l),ze((e=>If(e))),Zt((e=>Aa.updateNowPlaying(e)))).subscribe(Af),Sa().pipe(yn((e=>e?wc():cn)),Gt((e=>e.filter((e=>!e.lastfmScrobbledAt)))),ec(1e4),Zt((e=>function(e){return t=this,n=void 0,i=function*(){try{if(0===e.length)return;const t=e[0].playedAt+Math.floor(e[0].duration),n=e.at(-1).playedAt,r=new Ma({from:n-30,to:t+30,limit:Ma.maxPageSize}),i=yield fr(r),a=i.map((e=>xc(e,30))),[o,s]=d(e,(e=>!If(e)||a.includes(xc(e,30))||!!kc(i,e)));if(yield Ec(o.map((e=>Object.assign(Object.assign({},e),{lastfmScrobbledAt:-1})))),s.length>0){s.reverse(),s.length=Math.min(s.length,50),yield Aa.scrobble(s);const e=Math.floor(Date.now()/1e3);yield Ec(s.map((t=>Object.assign(Object.assign({},t),{lastfmScrobbledAt:e}))))}}catch(e){Af.error(e)}},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(t.value).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}(e)))).subscribe(Af);console.log("module::listenbrainzScrobbler");const Of=new A("listenbrainzScrobbler");function Mf(e){const[t]=e.src.split(":"),n=_l(t);return!n||Pf.canScrobble(Qo,n)}no().pipe(yn((e=>e?ad():cn)),ze((()=>Pf.canUpdateNowPlaying(Qo))),Gt((({currentItem:e})=>e)),ze(l),ze((e=>Mf(e))),Zt((e=>Wa.updateNowPlaying(e)))).subscribe(Of),no().pipe(yn((e=>e?wc():cn)),Gt((e=>e.filter((e=>!e.listenbrainzScrobbledAt)))),ec(1e4),Zt((e=>function(e){return t=this,n=void 0,i=function*(){try{if(0===e.length)return;const t=e[0].playedAt+Math.floor(e[0].duration),n=e.at(-1).playedAt,r=new jo({min_ts:n-30,max_ts:t+30,count:jo.maxPageSize}),i=yield fr(r),a=i.map((e=>xc(e,30))),[o,s]=d(e,(e=>!Mf(e)||a.includes(xc(e,30))||!!kc(i,e)));if(yield Ec(o.map((e=>Object.assign(Object.assign({},e),{listenbrainzScrobbledAt:-1})))),s.length>0){s.reverse(),s.length=Math.min(s.length,50),yield Wa.scrobble(s);const e=Math.floor(Date.now()/1e3);yield Ec(s.map((t=>Object.assign(Object.assign({},t),{listenbrainzScrobbledAt:e}))))}}catch(e){Of.error(e)}},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(t.value).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}(e)))).subscribe(Of);var Nf=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module::plexReporting");const $f=new A("plexReporting");let zf=null;function jf(e,t,n){return Nf(this,void 0,void 0,(function*(){try{yield Lf(e,t,n)}catch(e){$f.error(e)}}))}function Lf(e,t,n,r){return Nf(this,void 0,void 0,(function*(){if(!zf)return void $f.warn(`Cannot report state (${n}): playQueue not defined`);const[,,i]=e.src.split(":");yield as.fetch({path:"/:/timeline",params:{key:i,ratingKey:e.plex.ratingKey,playQueueItemID:String(zf.playQueueSelectedItemID),state:n,hasMDE:"1",time:String(Math.floor(1e3*t)),duration:String(Math.floor(1e3*e.duration))},keepalive:r})}))}console.log("module::plexScrobbler");const Rf=new A("plexScrobbler"),Df=e=>{var t;return!!(null===(t=e.currentItem)||void 0===t?void 0:t.src.startsWith("plex:"))};hs().pipe(yn((e=>e?ad():cn)),ze(Df),Zt((({currentItem:e})=>function(e){return Nf(this,void 0,void 0,(function*(){try{const[,,t]=e.src.split(":");zf=null,zf=yield function(e){return Nf(this,void 0,void 0,(function*(){return as.fetchJSON({path:"/playQueues",method:"POST",params:{type:"music",continuous:"0",uri:`server://${es.server.clientIdentifier}/com.plexapp.plugins.library/${e}`,repeat:"0",own:"1",includeExternalMedia:"1"}})}))}(t),yield Lf(e,0,"playing")}catch(e){$f.error(e)}}))}(e)))).subscribe(Rf),hs().pipe(yn((e=>e?od():cn)),ze(Df),Zt((({currentItem:e})=>function(e){return Nf(this,void 0,void 0,(function*(){try{yield Lf(e,0,"stopped",!0),zf=null}catch(e){$f.error(e)}}))}(e)))).subscribe(Rf),hs().pipe(yn((e=>e?sd(1e4):cn)),ze(Df),ze((({currentTime:e})=>e>0)),Zt((({currentItem:e,currentTime:t,paused:n})=>jf(e,t,n?"paused":"playing")))).subscribe(Rf),hs().pipe(yn((e=>e?ad():cn)),yn((e=>Df(e)?id().pipe(tr(((e,t)=>e.paused===t.paused)),kl(1),wn(od())):cn)),Zt((({currentItem:e,currentTime:t,paused:n})=>jf(e,t,n?"paused":"playing")))).subscribe(Rf);const _f=new A("mediaPlayback/scrobbler");od().pipe(Zt((e=>function(e){var t;return fc(this,void 0,void 0,(function*(){try{const n=e.currentItem;if(!n||!e.startedAt||!e.endedAt)throw Error("Invalid PlaybackState.");if(n.title&&(null===(t=n.artists)||void 0===t?void 0:t[0])&&n.duration>30){const t=Math.min(n.duration/2,240),r=Math.floor(e.startedAt/1e3);if(Math.floor(e.endedAt/1e3)-r>t){const{id:e,lookupStatus:t}=n,i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(n,["id","lookupStatus"]);pc.log("add",{listen:i}),yield yc.items.add(Object.assign(Object.assign({},i),{playedAt:r,lastfmScrobbledAt:0,listenbrainzScrobbledAt:0}))}}}catch(e){pc.error(e)}}))}(e)))).subscribe(_f);console.log("module::mediaPlayback");const Ff=new A("mediaPlayback"),Vf=new z("mediaPlayback"),Uf=new z("mediaPlayback","session"),Bf=new Ie(!1),Hf=new Pe;let Yf="forward";function Kf(){return xu.observeCurrentItem()}function Wf(){return ud.observeCurrentTime()}function qf(){return ud.observeDuration()}function Jf(){return ff.observeEnded()}function Qf(){return ud.observePaused()}function Gf(){return ud.observePlaybackStart()}function Xf(){return ud.observePlaybackEnd()}function Zf(){return ff.observePlaying()}function ep(e){Ff.log("load",{item:e}),ff.load(e),ff.autoplay&&ud.play()}function tp(){Ff.log("play"),Yf="forward",up(),ud.play(),ud.paused||(ff.play(),tf.play())}function np(){Ff.log("pause"),mp.stopAfterCurrent=!1,up(),ud.pause(),ff.pause(),tf.pause()}function rp(e){Ff.log("seek",{time:b(e)}),ff.seek(e)}function ip(){Ff.log("stop"),mp.stopAfterCurrent=!1,up(),ud.stop(),ff.stop(),tf.stop()}function ap(){Yf="backward",xu.atStart||(mp.stopAfterCurrent=!1,cp(),xu.prev())}function op(){Yf="forward",xu.atEnd||(mp.stopAfterCurrent=!1,cp(),xu.next())}function sp(){mp.stopAfterCurrent=!1,cp(),xu.eject()}function lp(){return Zn([xu.observeCurrentIndex(),xu.observeSize()]).pipe(Gt((([e,t])=>e===t-1)),tr())}function cp(){ud.paused||!1!==Bf.getValue()||(ud.stop(),ff.stop(),ud.play()),Bf.next(!0)}function up(){Bf.next(!1)}function dp(e){return t=this,n=void 0,i=function*(){if(!Vl(e)){const t=yield function(e){return Rc(this,void 0,void 0,(function*(){try{if(!e)return;if(Vl(e))return e;t=e,Pc.next({lookupItem:t});const n=yield function(e){return Rc(this,void 0,void 0,(function*(){const t=Sc(e);if(t)return t;const{link:n}=e,r=Dc(e,["link"]);if(n&&Vl(n))return Object.assign(Object.assign({},r),n);const{artist:i,title:a}=Qc(e);if(!i||!a)return;let o=[];const[s]=(null==n?void 0:n.src.split(":"))||[],l=_l(s);return l&&(o=yield Vc(l,e)),0===o.length&&(o=yield Uc(e,!0,l)),0===o.length&&(o=yield Uc(e,!1,l)),Bc(o,e)}))}(e);return n&&([Fc]=n.src.split(":")),function(e,t){Ac.next({lookupItem:e,foundItem:t?x(t,e):void 0})}(e,n),n}catch(e){_c.error(e)}var t}))}(e);if(t)return Object.assign(Object.assign({},e),t)}return e},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(t.value).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}const mp={stopAfterCurrent:!1,get autoplay(){return ff.autoplay},set autoplay(e){ff.autoplay=e,tf.autoplay=e},get hidden(){return!1},get loop(){return!1},get muted(){return ff.muted},set muted(e){Uf.setBoolean("muted",e),ff.muted=e},get paused(){return ud.paused},get volume(){return ff.volume},set volume(e){Vf.setNumber("volume",e),ff.volume=e},observeCurrentItem:Kf,observeCurrentTime:Wf,observeDuration:qf,observeEnded:Jf,observeError:function(){return ff.observeError()},observePaused:Qf,observePlaying:Zf,observePlaybackStart:Gf,observePlaybackEnd:Xf,observePlaybackProgress:function(e){return ud.observePlaybackProgress(e)},observePlaybackState:function(){return ud.observePlaybackState()},appendTo:function(e){const t=e.querySelector("#playback");ff.appendTo(t),tf.appendTo(t)},load:ep,play:tp,pause:np,stop:ip,seek:rp,resize:function(e,t){ff.resize(e,t),tf.resize(e,t)},next:op,prev:ap,shuffle:function(){xu.shuffle()}},hp=mp;mp.muted=Uf.getBoolean("muted"),mp.volume=Vf.getNumber("volume",1),ff.observeCurrentTime().subscribe((e=>ud.setCurrentTime(e))),ff.observeDuration().subscribe((e=>ud.setDuration(e))),ff.observePlaying().subscribe((()=>ud.started())),ff.observeEnded().subscribe((()=>ud.ended())),ff.observePlaying().subscribe((()=>Yf="forward")),ff.observeEnded().pipe(xl(lp()),wn(Hf)).subscribe((([,e])=>{e||mp.stopAfterCurrent?ip():xu.next()})),ff.observeError().pipe(xl(Qf(),xu.observeCurrentIndex().pipe(Gt((e=>0===e)),tr()),lp()),wn(Hf)).subscribe((([,e,t,n])=>{e||(n||t&&"backward"===Yf?ip():"backward"===Yf?xu.prev():xu.next())})),xu.observeSize().pipe(Gt((e=>0===e)),tr(),ze((e=>e))).subscribe(ip),Bf.pipe(ec(250),ze((e=>e))).subscribe((()=>{mp.autoplay=!ud.paused,Bf.next(!1)})),Bf.pipe(tr(),yn((e=>e?cn:Kf())),tr(((e,t)=>(null==e?void 0:e.id)===(null==t?void 0:t.id))),yn((e=>e?dp(e):Pn(null))),$e(ep)).subscribe(Ff),Bf.pipe(tr(),yn((e=>e?cn:xu.observeNextItem())),tr(((e,t)=>(null==e?void 0:e.id)===(null==t?void 0:t.id))),ec(1e4),yn((e=>e?dp(e):cn))).subscribe(Ff),on(window,"pagehide").subscribe((function(){Hf.next(void 0),ip()})),qf().pipe(Gt(b),tr()).subscribe(Ff.rx("duration")),Wf().pipe(ze((e=>Math.round(e)%30==0)),Gt(b)).subscribe(Ff.rx("currentTime")),Zf().subscribe(Ff.rx("playing")),Jf().subscribe(Ff.rx("ended")),Gf().subscribe(Ff.rx("playbackStart")),Xf().subscribe(Ff.rx("playbackEnd"));var fp=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function pp(e){var{icon:t,className:n=""}=e,i=fp(e,["icon","className"]);return r.createElement("button",Object.assign({},i,{className:`icon-button icon-button-${t} ${n}`,type:"button",onMouseDown:w,onMouseUp:y}),r.createElement(xi,{name:t}))}var vp=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function bp(e){var{className:t="",children:n}=e,i=vp(e,["className","children"]);return r.createElement("div",Object.assign({},i,{className:`icon-buttons ${t}`}),n)}function gp({children:e,onClose:t,x:n,y:i,align:a="left"}){const o=(0,r.useRef)(null),s=(0,r.useRef)(document.activeElement),[l,c]=(0,r.useState)({visibility:"hidden"}),[u,d]=(0,r.useState)([]),[m,h]=(0,r.useState)("");(0,r.useLayoutEffect)((()=>{const e={},t=o.current,r=Array.from(t.querySelectorAll("button"));"right"===a||n+t.offsetWidth>document.body.clientWidth?e.left=n-t.offsetWidth+"px":e.left=`${n}px`,i+t.offsetHeight>document.body.clientHeight?e.top=i-t.offsetHeight+"px":e.top=`${i}px`,d(r),c(e)}),[a,n,i]),(0,r.useEffect)((()=>{const e=u.find((e=>!e.disabled));null==e||e.focus(),h((null==e?void 0:e.id)||"")}),[u]),(0,r.useEffect)((()=>{const e=bn(Rt(0).pipe(yn((()=>on(document,"mousedown",{capture:!0}).pipe(ze((e=>!o.current.contains(e.target))))))),on(document,"keydown",{capture:!0}).pipe(ze((e=>"Escape"===e.code))),on(window,"blur")).subscribe((()=>{var e;null===(e=s.current)||void 0===e||e.focus(),t()}));return()=>e.unsubscribe()}),[t]);const f=(0,r.useCallback)((e=>{var n;let r=e.target;for(;r&&"BUTTON"!==r.nodeName;)r=r.parentElement;(null==r?void 0:r.value)&&!r.disabled&&(null===(n=s.current)||void 0===n||n.focus(),t(r.value))}),[t]),p=(0,r.useCallback)((e=>{let t=u.indexOf(document.activeElement);"ArrowDown"===e.code?(e.stopPropagation(),t++):"ArrowUp"===e.code&&(e.stopPropagation(),t--),t=Math.min(Math.max(t,0),u.length-1);const n=u[t];n&&!n.disabled&&(n.focus(),h(n.id))}),[u]),v=(0,r.useCallback)((e=>{let t=e.target;for(;t&&"BUTTON"!==t.nodeName;)t=t.parentElement;t&&!t.disabled&&(t.focus(),h(t.id))}),[]);return r.createElement("ul",{className:"popup-menu",tabIndex:-1,role:"menu","aria-label":"Actions","aria-activedescendant":m,style:l,onClick:f,onContextMenu:g,onKeyDown:p,onMouseOver:v,ref:o},e)}var yp=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function wp(e){var{className:t="",label:n,acceleratorKey:i="",role:a="menuitem"}=e,o=yp(e,["className","label","acceleratorKey","role"]);const s=(0,r.useId)();return r.createElement("li",{className:`popup-menu-item ${t}`},r.createElement("button",Object.assign({},o,{id:s,role:a,tabIndex:-1,onMouseDown:w,onMouseUp:y}),r.createElement("span",{className:"popup-menu-item-label"},n),r.createElement("span",{className:"popup-menu-item-accelerator-key"},i)))}var Ep=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function xp(e){var{className:t="",checked:n=!1}=e,i=Ep(e,["className","checked"]);return r.createElement(wp,Object.assign({},i,{className:`popup-menu-item-checkbox ${t}`,role:"menuitemcheckbox","aria-checked":n}))}function kp(){return r.createElement("li",{className:"popup-menu-separator",role:"separator"})}var Sp=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function Cp(e,t,n,a){return Sp(this,void 0,void 0,(function*(){return new Promise(((o,s)=>{const l=document.getElementById("popup"),c=document.createElement("div"),u=(0,i.s)(c);try{const i=e=>{u.unmount(),c.remove(),o(e)};l.append(c),u.render(r.createElement(e,{x:t,y:n,align:a,onClose:i}))}catch(e){u.unmount(),c.remove(),s(e)}}))}))}var Tp=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))},Pp=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Ap(e,t,n,i,a="left"){return Tp(this,void 0,void 0,(function*(){return Cp((n=>r.createElement(Ip,Object.assign({},n,{items:e,isContextMenu:t}))),n,i,a)}))}function Ip(e){var{items:t,isContextMenu:n}=e,i=Pp(e,["items","isContextMenu"]);const a=t[0],o=1===t.length&&!!a,s=t.every((e=>e.itemType===Kn.Media||e.itemType===Kn.Album));return r.createElement(gp,Object.assign({},i),s?r.createElement(Op,null):null,n&&o?r.createElement(Mp,{item:a}):null,o?r.createElement(wp,{label:"Info...",value:Hn.Info,acceleratorKey:`${U.ctrlKeyStr}+I`,key:Hn.Info}):null)}function Op(){return r.createElement(r.Fragment,null,r.createElement(wp,{label:"Queue",value:Hn.Queue,acceleratorKey:"Enter",key:Hn.Queue}),r.createElement(wp,{label:"Play next",value:Hn.PlayNext,acceleratorKey:"Shift+Enter",key:Hn.PlayNext}),r.createElement(wp,{label:"Play now",value:Hn.PlayNow,acceleratorKey:`${U.ctrlKeyStr}+Enter`,key:Hn.PlayNow}),r.createElement(kp,null))}function Mp({item:e}){const[t]=(null==e?void 0:e.src.split(":"))||[],n=_l(t);return r.createElement(r.Fragment,null,e.itemType===Kn.Playlist?r.createElement(wp,{label:e.isPinned?"Unpin":"Pin",value:e.isPinned?Hn.Unpin:Hn.Pin,key:e.isPinned?Hn.Unpin:Hn.Pin}):null,void 0!==e.rating&&(null==n?void 0:n.canRate(e,!0))?r.createElement(wp,{label:e.rating?_p(n,Hn.Unlike):_p(n,Hn.Like),value:e.rating?Hn.Unlike:Hn.Like,key:e.rating?Hn.Unlike:Hn.Like}):null,!1===e.inLibrary&&(null==n?void 0:n.canStore(e,!0))?r.createElement(wp,{label:_p(n,Hn.AddToLibrary),value:Hn.AddToLibrary,key:Hn.AddToLibrary}):null,"apple"!==t&&!0===e.inLibrary&&(null==n?void 0:n.canStore(e,!0))?r.createElement(wp,{label:_p(n,Hn.RemoveFromLibrary),value:Hn.RemoveFromLibrary,key:Hn.RemoveFromLibrary}):null,r.createElement(kp,null))}const Np=()=>{};function $p({rating:e=0,onClick:t=Np}){const n=Math.round(e/2),[i,a]=(0,r.useState)(!1);return r.createElement(bp,{className:"star-rating"},r.createElement(pp,{icon:"star",className:`${n>0?"checked":""} ${i?"clicked":""}`,tabIndex:-1,onClick:()=>{a(!0),t(1===n?0:2)},onMouseLeave:()=>a(!1)}),r.createElement(pp,{icon:"star",className:n>1?"checked":"",tabIndex:-1,onClick:()=>t(2===n?2:4)}),r.createElement(pp,{icon:"star",className:n>2?"checked":"",tabIndex:-1,onClick:()=>t(3===n?4:6)}),r.createElement(pp,{icon:"star",className:n>3?"checked":"",tabIndex:-1,onClick:()=>t(4===n?6:8)}),r.createElement(pp,{icon:"star",className:n>4?"checked":"",tabIndex:-1,onClick:()=>t(5===n?8:10)}))}var zp=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const jp={[Hn.AddToLibrary]:"plus",[Hn.RemoveFromLibrary]:"tick-fill",[Hn.Rate]:"star",[Hn.Like]:"heart",[Hn.Unlike]:"heart-fill"},Lp={[Hn.AddToLibrary]:"Add to library",[Hn.RemoveFromLibrary]:"Remove from library",[Hn.Rate]:"Rate",[Hn.Like]:"Love",[Hn.Unlike]:"Unlove"};function Rp({item:e,inline:t}){const[n]=e.src.split(":"),i=_l(n),a=t?-1:void 0,o=(0,r.useCallback)((()=>zp(this,void 0,void 0,(function*(){e.itemType===Kn.Playlist&&(e.isPinned?yield xv(Hn.Unpin,[e]):yield xv(Hn.Pin,[e]))}))),[e]),s=(0,r.useCallback)((()=>zp(this,void 0,void 0,(function*(){e.rating?yield xv(Hn.Unlike,[e]):yield xv(Hn.Like,[e])}))),[e]),l=(0,r.useCallback)((()=>zp(this,void 0,void 0,(function*(){e.inLibrary?yield xv(Hn.RemoveFromLibrary,[e]):yield xv(Hn.AddToLibrary,[e])}))),[e]),c=(0,r.useCallback)((t=>zp(this,void 0,void 0,(function*(){const n=t.target.getBoundingClientRect(),r=yield Ap([e],!1,n.right,n.bottom,"right");r&&(yield xv(r,[e]))}))),[e]),u=(0,r.useCallback)((t=>zp(this,void 0,void 0,(function*(){yield xv(Hn.Rate,[e],t)}))),[e]);return r.createElement(bp,null,t?r.createElement(pp,{icon:"menu",title:"More...",tabIndex:a,onClick:c,key:"menu"}):null,e.itemType===Kn.Playlist?r.createElement(pp,{icon:e.isPinned?"pin-fill":"pin",title:e.isPinned?"Unpin":"Pin to sidebar",tabIndex:a,onClick:o,key:"pin"}):null,i?r.createElement(r.Fragment,null,void 0!==e.rating&&(null==i?void 0:i.canRate(e,t))?"plex"===n?r.createElement($p,{rating:e.rating,onClick:u}):r.createElement(pp,{icon:e.rating?Dp(i,Hn.Unlike):Dp(i,Hn.Like),title:e.rating?_p(i,Hn.Unlike):_p(i,Hn.Like),tabIndex:a,onClick:s,key:"rate"}):null,void 0!==e.inLibrary&&(null==i?void 0:i.canStore(e,t))?r.createElement(pp,{icon:e.inLibrary?Dp(i,Hn.RemoveFromLibrary):Dp(i,Hn.AddToLibrary),title:e.inLibrary?_p(i,Hn.RemoveFromLibrary):_p(i,Hn.AddToLibrary),tabIndex:a,disabled:"apple"===n&&e.inLibrary,onClick:l,key:"store"}):null):null)}function Dp(e,t){var n;return(null===(n=e.icons)||void 0===n?void 0:n[t])||jp[t]}function _p(e,t){var n;return(null===(n=e.labels)||void 0===n?void 0:n[t])||Lp[t]}var Fp=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};console.log("module:musicbrainz/coverart");const Vp=new A("musicbrainz/coverart");class Up extends vt.ZP{constructor(){super("ampcast/musicbrainz/coverart"),this.version(1).stores({items:"&mbid, album, artist, thumbnails"})}}const Bp=new Up;function Hp(e){switch(e){case"small":return 250;case"large":return 500;default:return Number(e)||0}}function Yp({item:e,size:t,className:n=""}){const[i,a]=(0,r.useState)(!1),[o,s]=(0,r.useState)((()=>e.thumbnails)),l=!!(null==o?void 0:o.length),c=l?function(e,t=240){if(1===e.length)return e[0];let n=e.filter((e=>Wp(e)<1.34));return 0===n.length&&(n=e.filter((e=>Wp(e)<1.5)),0===n.length&&(n=e)),t*=window.devicePixelRatio,n.sort(((e,n)=>Math.abs(e.height-t)-Math.abs(n.height-t))),n[0]}(o,t):void 0,u=c?Kp(c):"",d=function(e){switch(e.itemType){case Kn.Artist:return"artist";case Kn.Album:return"album";case Kn.Media:return e.mediaType===jr.Video?"video":"audio";case Kn.Playlist:return"playlist";case Kn.Folder:return"folder"}}(e);(0,r.useEffect)((()=>s(e.thumbnails)),[e.thumbnails]),(0,r.useEffect)((()=>{if(!l){if(e.itemType===Kn.Media){const t=Sc(e);if(t&&t.thumbnails)return void s(t.thumbnails)}const t=vn(function(e){var t;return Fp(this,void 0,void 0,(function*(){if(!e||e.itemType!==Kn.Album&&e.itemType!==Kn.Media)return;let n=!1;const r=e.release_mbid;if(r){const e=yield Bp.items.get(r);if(n=!!e,null==e?void 0:e.thumbnails)return e.thumbnails}let i,a;if(e.itemType===Kn.Album?(i=e.title,a=e.artist):(i=e.album,a=e.albumArtist||(null===(t=e.artists)||void 0===t?void 0:t[0])),i&&a){const e=yield Bp.items.get({album:i,artist:a});if(e)return e.thumbnails}if(r&&!n)try{const e=yield function(e){return Fp(this,void 0,void 0,(function*(){const t=yield fetch(`https://coverartarchive.org/release/${e}`);if(!t.ok)throw t;return t.json()}))}(r),t=e.images.filter((e=>e.front&&e.approved))[0],n=t?Object.keys(t.thumbnails).filter((e=>0!==Hp(e))).map((e=>({url:t.thumbnails[e],width:Hp(e),height:Hp(e)}))):[];return yield Bp.items.put(0===n.length?{mbid:r}:{mbid:r,album:i,artist:a,thumbnails:n}),n}catch(e){404===e.status?yield Bp.items.put({mbid:r}):Vp.error(e)}}))}(e)).subscribe(s);return()=>t.unsubscribe()}}),[l,e]);const m=(0,r.useCallback)((()=>a(!0)),[]);return r.createElement("figure",{className:`cover-art ${n}`},u&&!i?r.createElement("img",{className:"cover-art-image",src:u,alt:`${e.title}: Cover art`,onError:m}):d?r.createElement(xi,{className:"cover-art-image",name:d}):null)}function Kp(e){return e.url.replace("{plex-token}",es.serverToken)}function Wp({width:e,height:t}){return e/t}function qp({className:e,children:t}){const n=(0,r.useRef)(null),i=(0,r.useRef)(null),[a,o]=(0,r.useState)(0),[s,l]=(0,r.useState)("hidden"),c=(0,r.useCallback)((({scrollHeight:e})=>o(e)),[]);return(0,r.useLayoutEffect)((()=>{setTimeout((()=>requestAnimationFrame((()=>l(void 0)))),50)}),[]),r.createElement("div",{className:`text-box ${e}`,style:{height:`${a}px`,visibility:s},ref:n},r.createElement("div",{style:{position:"relative",height:"100%"}},r.createElement(Cn,{onResize:c,scrollableRef:i},t)))}const Jp=new A("Media/useCurrentItem");var Qp=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Gp(e){const t=function(e){const[t,n]=(0,r.useState)(e),[i,a]=(0,r.useState)("");return(0,r.useEffect)((()=>{if(i!==e.src){const[t]=e.src.split(":"),r=_l(t);if(null==r?void 0:r.getMetadata){const t=vn(r.getMetadata(e)).pipe($e((t=>{a(e.src),n(Object.assign(Object.assign({},e),t))}))).subscribe(Jp);return()=>t.unsubscribe()}a(e.src)}}),[e,i]),(0,r.useEffect)((()=>{const e=ir.observe().pipe($e((e=>{for(const{match:r,values:i}of e)if(r(t)){n(Object.assign(Object.assign({},t),i));break}}))).subscribe(Jp);return()=>e.unsubscribe()}),[t]),t}(e.item);if(e.debug)return r.createElement(fv,{item:t});switch(t.itemType){case Kn.Media:return r.createElement(Xp,{item:t});case Kn.Artist:return r.createElement(ev,{item:t});case Kn.Album:return r.createElement(Zp,{item:t});case Kn.Playlist:return r.createElement(tv,{item:t});case Kn.Folder:return r.createElement(nv,{item:t})}}function Xp({item:e}){var t;return r.createElement("article",{className:"media-info media-item-info"},r.createElement("div",{className:"media-info-main"},r.createElement(hv,{item:e}),r.createElement(rv,{title:e.title}),r.createElement(av,{artist:null===(t=e.artists)||void 0===t?void 0:t.join(", ")}),r.createElement(lv,{album:e.album,year:e.year}),r.createElement(cv,{album:e.album,track:e.track}),r.createElement(ov,{owner:e.owner,src:e.src}),r.createElement(Rp,{item:e})),r.createElement(iv,{description:e.description}),r.createElement(sv,{url:e.externalUrl,src:e.src}))}function Zp({item:e}){return r.createElement("article",{className:"media-info album-info"},r.createElement("div",{className:"media-info-main"},r.createElement(hv,{item:e}),r.createElement(rv,{title:e.title}),r.createElement(av,{artist:e.artist}),r.createElement(uv,{year:e.year}),r.createElement(Rp,{item:e})),r.createElement(iv,{description:e.description}),r.createElement(sv,{url:e.externalUrl,src:e.src}))}function ev({item:e}){return r.createElement("article",{className:"media-info artist-info"},r.createElement("div",{className:"media-info-main"},r.createElement(hv,{item:e}),r.createElement(rv,{title:e.title}),r.createElement(dv,{genres:e.genres}),r.createElement(mv,{country:e.country}),r.createElement(Rp,{item:e})),r.createElement(iv,{description:e.description}),r.createElement(sv,{url:e.externalUrl,src:e.src}))}function tv({item:e}){return r.createElement("article",{className:"media-info playlist-info"},r.createElement("div",{className:"media-info-main"},r.createElement(hv,{item:e}),r.createElement(rv,{title:e.title}),r.createElement(ov,{owner:e.owner,src:e.src}),r.createElement(dv,{genres:e.genres}),r.createElement(Rp,{item:e})),r.createElement(iv,{description:e.description}),r.createElement(sv,{url:e.externalUrl,src:e.src}))}function nv({item:e}){return r.createElement("article",{className:"media-info folder-info"},r.createElement("div",{className:"media-info-main"},r.createElement(hv,{item:e}),r.createElement(rv,{title:e.title})))}function rv({title:e}){return r.createElement("h3",{className:"title"},e||"(no title)")}function iv({description:e}){return e?r.createElement(qp,{className:"blurb"},r.createElement("p",null,e)):null}function av({artist:e}){return e?r.createElement("h4",{className:"artist"},"By: ",e):null}function ov({src:e,owner:t}){if(!t||!t.name)return null;const[n]=e.split(":"),i="youtube"===n?"Channel":"Curator";return r.createElement("p",{className:"owner"},i,":"," ",t.url?r.createElement(Ja,{href:t.url},t.name):t.name)}function sv({src:e,url:t=""}){let[n]=e.split(":"),i=n;switch(n){case"musicbrainz":i="MusicBrainz";break;case"listenbrainz":/musicbrainz/.test(t)?(i="MusicBrainz",n="musicbrainz"):i="ListenBrainz";break;default:{const e=_l(n);e&&(i=e.name)}}return r.createElement("p",{className:"external-view"},r.createElement(xi,{name:n}),t?r.createElement(Ja,{href:t},"View on ",i):r.createElement("span",{className:"external-provider"},"Provided by ",i))}function lv({album:e,year:t}){return e&&t?r.createElement("h4",{className:"album"},"From: ",e," (",t,")"):e?r.createElement("h4",{className:"album"},"From: ",e):t?r.createElement("h4",{className:"album"},"Year: ",t):null}function cv({album:e,disc:t,track:n}){return e&&n?r.createElement(r.Fragment,null,t&&r.createElement("p",{className:"track disc"},"Disc: ",t),r.createElement("p",{className:"track"},"Track: ",n)):null}function uv({year:e}){return e?r.createElement("p",{className:"year"},"Year: ",e):null}function dv({genres:e}){return e?r.createElement("p",{className:"genre"},"Genre: ",e.join(", ")):null}function mv({country:e}){return e?r.createElement("p",{className:"country"},"Country: ",e):null}function hv(e){return r.createElement("div",{className:"thumbnail"},r.createElement(Yp,Object.assign({},e)))}function fv(e){const t=e.item,{pager:n}=t,i=Qp(t,["pager"]);return r.createElement("article",{className:"media-info debug"},r.createElement("pre",null,JSON.stringify(i,void 0,2)),r.createElement(sv,{url:i.externalUrl,src:i.src}))}function pv(e){const[t,n]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{if(e.current){const e=document.querySelectorAll(".focus");for(const t of e)t.classList.toggle("focus",!1)}const t=on(document,"keydown",{capture:!0}).subscribe((t=>{var r;t.repeat||(t.ctrlKey&&t.shiftKey&&"Digit8"===t.code?n((e=>!e)):t[U.ctrlKey]&&!t.shiftKey&&"KeyI"===t.code&&(null===(r=e.current)||void 0===r||r.close()))}));return()=>t.unsubscribe()}),[e]),{debug:t}}var vv=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))},bv=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function gv(e){return vv(this,void 0,void 0,(function*(){yield Pi((t=>r.createElement(yv,Object.assign({},t,{item:e}))))}))}function yv(e){var{item:t}=e,n=bv(e,["item"]);const i=(0,r.useRef)(null),{debug:a}=pv(i),o=function(e){switch(e.itemType){case Kn.Playlist:return"Playlist info";case Kn.Album:return"Album info";case Kn.Artist:return"Artist info";case Kn.Folder:return"Folder info";default:return"Media info"}}(t);return r.createElement(Ci,Object.assign({},n,{className:"media-info-dialog",title:o,ref:i}),r.createElement("form",{method:"dialog"},r.createElement(Gp,{item:t,debug:a}),r.createElement("footer",{className:"dialog-buttons"},r.createElement("button",null,"Close"))))}var wv=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const Ev=new A("ampcast/actions");function xv(e,t,n){return wv(this,void 0,void 0,(function*(){const r=t[0];if(!r)return;const i=r.itemType;switch(e){case Hn.PlayNow:case Hn.PlayNext:case Hn.Queue:!function(e,t){wv(this,void 0,void 0,(function*(){const n=t[0];if(!n)return;const r=n.itemType;if(r===Kn.Media||r===Kn.Album)switch(e){case Hn.PlayNow:case Hn.PlayNext:e===Hn.PlayNow&&(hp.autoplay=!0),r===Kn.Media?yield xu.insert(t):yield xu.insert(n),e===Hn.PlayNow&&xu.next();break;case Hn.Queue:r===Kn.Media?yield xu.add(t):yield xu.add(n)}}))}(e,t);break;case Hn.Like:case Hn.Unlike:case Hn.Rate:case Hn.AddToLibrary:case Hn.RemoveFromLibrary:!function(e,t,n){wv(this,void 0,void 0,(function*(){if(t)try{switch(e){case Hn.Like:yield mr.rate(t,1);break;case Hn.Unlike:yield mr.rate(t,0);break;case Hn.Rate:"number"==typeof n&&(yield mr.rate(t,n));break;case Hn.AddToLibrary:yield sr.store(t,!0);break;case Hn.RemoveFromLibrary:yield sr.store(t,!1)}}catch(r){Ev.warn("Failed to perform action:",{action:e,item:t,payload:n}),Ev.error(r)}}))}(e,r,n);break;case Hn.Pin:i===Kn.Playlist&&(yield Qr.pin(t));break;case Hn.Unpin:i===Kn.Playlist&&(yield Qr.unpin(t));break;case Hn.Info:yield gv(r)}}))}let kv=null,Sv="none";const Cv={getData:function(e){return"#globalDrag"===e.dataTransfer.getData("text")?kv:null},getEffect:function(e){return"#globalDrag"===e.dataTransfer.getData("text")?Sv:"none"},set:function(e,t,n){e.dataTransfer.setData("text","#globalDrag"),e.dataTransfer.effectAllowed=n,kv=t,Sv=n},unset:function(){kv=null,Sv="none"}};function Tv(e){const t=(0,r.useRef)();return(0,r.useEffect)((()=>{t.current=e}),[e]),t.current}function Pv({style:e,title:t}){return r.createElement("div",{className:"list-view-cell",style:e},t)}function Av({col:e,onResize:t}){const[n,i]=(0,r.useState)(e.width),[a,o]=(0,r.useState)(-1),[s,l]=(0,r.useState)(0),c=-1!==a,u=(0,r.useCallback)((e=>{e.preventDefault(),0===e.button&&(o(e.screenX),l(n))}),[n]);(0,r.useEffect)((()=>t(e.index,n)),[e.index,n,t]);const d=(0,r.useCallback)((e=>{i(Math.max(20,s+(e.screenX-a)))}),[a,s]),m=(0,r.useCallback)((()=>{o(-1),l(0)}),[]);return(0,r.useEffect)((()=>{if(c)return document.documentElement.style.cursor="col-resize",document.body.classList.add("dragging"),document.addEventListener("mouseup",m),document.addEventListener("mousemove",d),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",m),document.removeEventListener("mousemove",d)}}),[c,d,m]),r.createElement("span",{className:"column-resizer",onMouseDown:u,style:{left:e.left+n-4+"px"}})}function Iv({width:e,height:t,cols:n,sizeable:i,onColumnResize:a}){const o=(0,r.useCallback)(((e,t)=>{null==a||a(e,t)}),[a]);return r.createElement("header",{className:"list-view-head",style:{width:`${e}px`}},r.createElement("div",{className:"list-view-row",style:{width:`${e}px`,height:`${t}px`}},n.map((e=>r.createElement(Pv,Object.assign({},e,{key:e.index}))))," ",i&&n.map((e=>r.createElement(Av,{col:e,onResize:o,key:e.index})))))}function Ov({rowIndex:e,col:{className:t="",render:n,style:i},item:a}){return r.createElement("div",{className:`list-view-cell ${t}`,style:i},n(a,e))}function Mv({item:e,className:t,id:n,rowIndex:i,height:a,selected:o,cols:s,setSize:l,dragIndex:c}){const u=`${t} ${o?"selected selected-text":""} ${c===l?i===l-1?"drag-over-last":"":c===i?"drag-over":""}`;return r.createElement("li",{role:"option",className:`list-view-row ${u}`,id:n,"aria-selected":o,"aria-setsize":l,"aria-posinset":i+1,style:{height:`${a}px`,transform:`translateY(${a*i}px)`}},s.map((t=>r.createElement(Ov,{rowIndex:i,col:t,item:e,key:t.index}))))}function Nv({listViewId:e,title:t,width:n,height:i,rowHeight:a,cols:o,items:s,itemKey:l,itemClassName:c,selectedId:u,scrollTop:d,overScan:m=2,selection:h,draggable:f,dragIndex:p,multiple:v=!1}){const b=(0,r.useRef)(null),g=s.length,y=Math.floor(d/a),w=Math.floor(i/a),E=Math.max(0,y-m),x=Math.min(g,w+2*m),k=s.slice(E,E+x);return r.createElement("ol",{role:"listbox",className:"list-view-body",draggable:f,style:{width:n?`${n}px`:void 0},"aria-label":t,"aria-multiselectable":v,"aria-activedescendant":u,ref:b},k.map(((t,n)=>r.createElement(Mv,{className:c(t),id:`${e}-${t[l]}`,rowIndex:E+n,height:a,selected:h.includes(t),cols:o,item:t,setSize:g,dragIndex:p,key:t[l]}))))}const $v=[],zv=()=>"";new Image(0,0).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1H\nAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=";const jv=["ArrowUp","ArrowDown","PageUp","PageDown"];function Lv({items:e=[],itemKey:t,title:n,itemClassName:i=zv,layout:a,className:o="",selectedIndex:s=-1,draggable:l,droppable:c,droppableTypes:u=[],multiple:d,reorderable:m,disabled:h,onClick:f,onDoubleClick:p,onContextMenu:v,onDrop:b,onDelete:g,onEnter:y,onInfo:w,onRowIndexChange:E,onScrollIndexChange:x,onPageSizeChange:k,onSelect:S,onMove:C,listViewRef:T}){const P=(0,r.useId)(),A=(0,r.useRef)(null),I=(0,r.useRef)(null),O=(0,r.useRef)(null),M=(0,r.useRef)(null),N=(0,r.useRef)(null),$="details"===a.view&&a.showTitles,z="details"===a.view&&a.sizeable,[j,L]=(0,r.useState)(-1),[R,D]=(0,r.useState)(0),[_,F]=(0,r.useState)(0),[V,B]=(0,r.useState)(0),[H,Y]=(0,r.useState)(0),[K,W]=function(e){const[t,n]=(0,r.useState)([]),i="details"===e.view&&e.sizeable;(0,r.useEffect)((()=>{const t="details"===e.view,r=t&&e.sizeable;n(e.cols.reduce(((e,n,i)=>{const a=e[i-1],o=a?a.left+a.width:0,{title:s="",className:l="",align:c="left",sortOrder:u="none",sortPriority:d=0,width:m=200}=n,h=r?{left:`${o}px`,width:`${m}px`,textAlign:c}:t?{textAlign:c}:{};return e.push(Object.assign(Object.assign({},n),{title:s,className:l,align:c,index:i,left:o,width:m,style:h,sortOrder:u,sortPriority:d})),e}),[]))}),[e]);const a=(0,r.useCallback)(((e,r)=>{i&&t[e].width!==r&&n(t.reduce(((t,n,i)=>{if(i>=e){const a=t[i-1],o=a?a.left+a.width:0,s=i===e?r:n.width,l={left:`${o}px`,width:`${s}px`,textAlign:n.align};t.push(Object.assign(Object.assign({},n),{left:o,width:s,style:l}))}else t.push(n);return t}),[]))}),[t,i]);return[t,a]}(a),q=(0,r.useMemo)((()=>K.reduce(((e,t)=>e+t.width),0)),[K]),J=H?Math.max(Math.floor(_/H),1)-($?1:0):0,Q=e.length,{selectedItems:G,selectAll:X,selectAt:Z,selectRange:ee,toggleSelectionAt:te}=function(e,t,n){const[i,a]=(0,r.useState)([]),o=Tv(e);(0,r.useLayoutEffect)((()=>{if(e!==o){const o=e.filter((e=>i.some((n=>n[t]===e[t]))));if(s=o,(r=i).length!==s.length||!r.every(((e,t)=>s[t]===e))){const t=e.length;t>0&&0===o.length?a(n<t?[e[n]]:n===t?[e[n-1]]:o):a(o)}}var r,s}),[o,e,i,t,n]);const s=(0,r.useCallback)((()=>{a(e.slice())}),[e]),l=(0,r.useCallback)((t=>{const n=e[t];a(n?[n]:[])}),[e]),c=(0,r.useCallback)(((t,n)=>{const r=Math.min(t,n),i=Math.max(t,n),o=e.slice(r,i+1);a(o)}),[e]),u=(0,r.useCallback)(((t,n)=>{const r=e[t],o=i.includes(r);o!==n&&a(o?i.filter((e=>e!==r)):e.filter((e=>i.includes(e)||e===r)))}),[e,i]);return{selectedItems:i,selectAll:s,selectAt:l,selectRange:c,toggleSelectionAt:u}}(e,t,j),ne=G.length>0,re=Ct(),[ie,ae]=(0,r.useState)(-1),[oe,se]=(0,r.useState)(-1),[le,ce]=(0,r.useState)(-1),ue=0===Q,de=-1!==le,me=H?Math.floor(R/H):0,he=An(jv)&&!(0===j||j===Q-1),fe=Tv(e),[pe,ve]=(0,r.useState)((()=>G)),[be,ge,ye,we]=l?G:[],Ee=e[j]?`${P}-${e[j][t]}`:"",xe=(0,r.useCallback)((()=>I.current.focus()),[]),ke=(0,r.useCallback)((e=>{const t=O.current,n=Math.floor(R/H);if(e>=n+J-1){const n=(Q+($?1:0))*H,r=Q-J-1,i=Math.min(Q-1,e+1)-J,a=i===r?n:i*H;t.scrollTo({top:a})}else if(e<=n){const n=Math.max(0,e-1)*H;t.scrollTo({top:n})}}),[R,H,J,$,Q]),Se=(0,r.useCallback)((e=>{ke(e),Z(e),L(e)}),[ke,Z]);(0,r.useEffect)((()=>{A.current={focus:xe,scrollIntoView:Se,scrollTo:ke,selectAll:X,selectAt:Z},T&&(T.current=Object.assign(T.current||{},A.current))}),[T,xe,Se,ke,X,Z]),(0,r.useEffect)((()=>{var e;null===(e=A.current)||void 0===e||e.scrollIntoView(s)}),[s]),(0,r.useLayoutEffect)((()=>null==E?void 0:E(j)),[j,E]),(0,r.useLayoutEffect)((()=>null==x?void 0:x(me)),[me,x]),(0,r.useLayoutEffect)((()=>null==k?void 0:k(J)),[J,k]),(0,r.useLayoutEffect)((()=>null==S?void 0:S(pe)),[pe,S]),(0,r.useEffect)((()=>L(Math.min(Q-1,j))),[Q,j]),(0,r.useEffect)((()=>{if(fe&&e.length!==fe.length){const n=fe[j];if(n){const r=e.findIndex((e=>e&&e[t]===n[t]));-1!==r&&L(r)}}}),[e,fe,j,t]),(0,r.useEffect)((()=>{he||ve(G)}),[G,he]),(0,r.useEffect)((()=>{ue&&L(-1)}),[ue]),(0,r.useLayoutEffect)((()=>{!d&&G.length>1&&Z(j)}),[d,j,G,Z]);const Ce=(0,r.useCallback)((t=>{switch(t.code){case"Enter":t.stopPropagation(),t.repeat||null==y||y(G,t[U.ctrlKey],t.shiftKey);break;case"Delete":t.stopPropagation(),null==g||g(G);break;case"KeyI":if(t.stopPropagation(),t.preventDefault(),t[U.ctrlKey]&&!t.shiftKey&&!t.repeat){null==w||w(G);break}break;case"KeyA":t[U.ctrlKey]&&!t.shiftKey&&(t.preventDefault(),t.stopPropagation(),t.repeat||X());break;case"ShiftLeft":case"ShiftRight":t.repeat||ae(j);break;case"Space":t.preventDefault(),t.repeat||(t[U.ctrlKey]?(t.stopPropagation(),te(j)):G.includes(e[j])||(t.stopPropagation(),te(j,!0)));break;default:{const n=e.length,r=function(e,t,n,r){switch(e){case"ArrowUp":t-=1;break;case"ArrowDown":t+=1;break;case"PageUp":t-=n-1;break;case"PageDown":t+=n-1;break;case"Home":t=0;break;case"End":t=r-1;break;default:return-1}return Math.min(Math.max(t,0),r-1)}(t.key,j,J,n);-1!==r&&(t.preventDefault(),r!==j&&(t.stopPropagation(),ke(r),L(r)),d&&t.shiftKey&&-1!==ie?ee(ie,r):t[U.ctrlKey]||Z(r))}}}),[j,e,J,y,g,w,ke,X,Z,ee,te,G,d,ie]),Te=(0,r.useCallback)((e=>{const t=Rv(e);-1!==t&&(L(t),d&&e.shiftKey?-1===ie?ee(t,j):ee(ie,t):d&&e[U.ctrlKey]?te(t):function(e){const t=Dv(e);return!!(null==t?void 0:t.classList.contains("selected"))}(e)||Z(t))}),[Z,te,ee,j,ie,d]),Pe=(0,r.useCallback)((e=>{if(0===e.button){const t=Rv(e);-1!==t&&(!d||e[U.ctrlKey]||e.shiftKey||Z(t))}}),[Z,d]),Ae=(0,r.useCallback)((e=>{"Shift"===e.key&&ae(-1)}),[]),Ie=(0,r.useCallback)((({clientWidth:e,clientHeight:t})=>{B(e),F(t)}),[]),Oe=(0,r.useCallback)((({top:e})=>{D(e)}),[]);kt(M,(()=>{Y(M.current.getBoundingClientRect().height)})),(0,r.useLayoutEffect)((()=>{I.current.classList.toggle("thin",20*re>V)}),[re,V]);const Me=(0,r.useCallback)((t=>{const n=Rv(t);-1!==n&&(t.preventDefault(),null==f||f(e[n],n))}),[e,f]),Ne=(0,r.useCallback)((e=>{if(e.preventDefault(),-1===e.button){const t=function(e,t){return e.querySelector(`li[aria-posinset="${t+1}"]`)}(I.current,j);if(t){const n=t.getBoundingClientRect();null==v||v(G,Math.min(n.left+V,n.right),n.bottom,j,e.button)}}else null==v||v(G,e.pageX,e.pageY,Rv(e),e.button)}),[j,G,v,V]),$e=(0,r.useCallback)((t=>{const n=Rv(t);-1!==n&&(t.preventDefault(),null==p||p(e[n],n))}),[e,p]);(0,r.useEffect)((()=>{const e=N.current;for(;e.hasChildNodes();)e.removeChild(e.lastChild);const t=Array.from(I.current.querySelectorAll(".list-view-body:not(list-view-drag-image) li.selected"));t.length=Math.min(t.length,4);for(let n=0;n<t.length;n++){const r=t[n].cloneNode(!0);r.removeAttribute("id"),r.removeAttribute("role"),r.style.transform=`translateY(${H*n}px)`,e.appendChild(r)}}),[be,ge,ye,we,H]);const ze=(0,r.useCallback)((e=>{const t=e.dataTransfer;if(l||m){t.setDragImage(N.current,-16,-16);let n="none";n=l&&m?"copyMove":l?"copy":"move",Cv.set(e,G,n),ce(j)}else t.effectAllowed="none"}),[l,m,G,j]),je=(0,r.useCallback)((e=>{e.preventDefault(),e.stopPropagation();const t=e.dataTransfer;if(c||m){const n=t.types.includes("text/plain");let r=Rv(e);-1===r&&(r=Q),de?m&&n?(t.dropEffect="move",se(r)):(t.dropEffect="none",se(-1)):c&&(n||_v(t.items,u))?(t.dropEffect="copy",se(r)):(t.dropEffect="none",se(-1))}else de?t.dropEffect="copy":(t.dropEffect="none",se(-1))}),[Q,de,c,u,m]),Le=(0,r.useCallback)((e=>{if(c||m){const t=e.dataTransfer;let n=Rv(e);-1===n&&(n=Q);const r=Cv.getEffect(e);if("copy"===r){const t=Cv.getData(e);t&&(null==b||b(t,n))}else if("move"===r){const e=le<n?-1:0;null==C||C(G,n),L(n+e)}else c&&_v(t.items,u)&&(null==b||b(t.files,n))}se(-1),e.preventDefault(),e.stopPropagation()}),[Q,G,c,u,m,le,b,C]),Re=(0,r.useCallback)((()=>{Cv.unset(),ce(-1)}),[]),De=(0,r.useCallback)((()=>{se(-1)}),[]),_e=(0,r.useCallback)((()=>{d||ne||Z(Math.max(j,0))}),[ne,j,d,Z]);return r.createElement("div",{className:`list-view list-view-${a.view} ${o}`,tabIndex:h?void 0:ue?-1:0,onClick:Me,onContextMenu:Ne,onDoubleClick:$e,onDragStart:ze,onDragEnter:je,onDragOver:je,onDragLeave:De,onDragEnd:Re,onDrop:Le,onFocus:_e,onKeyDown:Ce,onKeyUp:Ae,onMouseDown:Te,onMouseUp:Pe,ref:I},r.createElement(Cn,{scrollWidth:z?q:void 0,scrollHeight:(Q+(c?1:0)+($?1:0))*H,scrollAmount:H,droppable:c||m&&de,onResize:Ie,onScroll:Oe,scrollableRef:O},$&&r.createElement(_t,null,r.createElement(Iv,{width:q,height:H,sizeable:z,cols:K,onColumnResize:W})),r.createElement(Nv,{title:n,width:z?q:void 0,height:_,rowHeight:H,cols:K,items:e,itemKey:t,itemClassName:i,listViewId:P,selectedId:Ee,scrollTop:R,selection:h?$v:G,dragIndex:oe,draggable:!h&&(l||m),multiple:d}),r.createElement("div",{className:"list-view-cursor",style:{width:z?`${q}px`:void 0,transform:`translateY(${Math.max(j,0)*H}px)`},ref:M})),r.createElement("ul",{className:"list-view-drag-image list-view-body","aria-hidden":!0,ref:N}))}function Rv(e){let t=0;const n=Dv(e);return n&&(t=Number(n.getAttribute("aria-posinset"))||0),t-1}function Dv(e){let t=e.target;for(;t&&!(null==t?void 0:t.hasAttribute("aria-posinset"));)t=t.parentElement;return t}function _v(e,t){return-1!==Array.from(e).findIndex((e=>t.some((t=>((e,t)=>{const[n,r]=e.split("/"),[i,a]=t.split("/");return n===i&&(r===a||"*"===r)})(t,e.type)))))}function Fv(e,t){const[n,i]=(0,r.useState)(t),a=(0,r.useMemo)(e,[e]);return(0,r.useEffect)((()=>{const e=a.subscribe(i);return()=>e.unsubscribe()}),[a]),n}function Vv(){return Fv(hu,null)}function Uv({children:e}){return r.createElement("footer",{className:"status-bar"},e)}function Bv({items:e,size:t,maxSize:n,error:i,loading:a,loadingText:o="Loading",selectedCount:s,itemName:l="item",itemNamePlural:c=l+"s"}){let u="";if(a)u=r.createElement("span",{className:"message"},o,"...");else if(e.length>0){const i=e.reduce((e=>e+1),0),a=r.createElement("span",{className:"selected"},"(",Hv(s)," selected)"),o=i===t?`${t.toLocaleString()} ${1===t?l:c}`:`Loaded ${Hv(i)} of ${void 0===t?n||`${Hv(e.length)}+`:Hv(n?Math.min(t,n):t)} ${c}`;u=r.createElement("span",{className:"message"},o," ",a)}else if(i){const e=function(e){return String(e.message||e.statusText||Yv[e.status]||e.status||"")}(i);u=r.createElement("span",{className:"error"},e?`Error: ${e}`:"Error")}else u=r.createElement("span",{className:"message"},"0 ",c);return r.createElement(Uv,null,u)}function Hv(e=0){return(e=Number(e))<1e4?String(e):e.toLocaleString()}const Yv={401:"Unauthorized",403:"Forbidden",404:"Not found",408:"Timeout",429:"Too many requests",500:"Internal server error",502:"Bad gateway",503:"Service unavailable",504:"Timeout"};function Kv({icon:e,text:t,showConnectivity:n}){return r.createElement("span",{className:"media-source-label"},r.createElement(xi,{name:e,className:n?"show-connectivity":""}),r.createElement("span",{className:"text"},t))}const Wv=(0,r.memo)((function({time:e}){const t=100/6,n=new Date(e);let i=n.getHours()+n.getMinutes()/60,a=Math.min(i,6),o=i-a;return i>12&&(i=24-i,o=Math.min(i,6),a=i-o),r.createElement("span",{role:"presentation",className:"sun-clock",title:n.toLocaleTimeString(),style:{"--am-alpha":a*t+"%","--pm-alpha":o*t+"%"}})}));function qv({time:e,className:t}){return r.createElement("time",{className:t},b(e))}const Jv={view:"details",fields:["Title","Genre","Owner"]};const Qv=e=>r.createElement(qv,{className:"text",time:e.duration||0});function Gv({value:e=""}){return""===e?null:r.createElement("span",{className:"text"},e)}const Xv={Index:{title:"#",render:(e,t)=>t+1,className:"index",align:"right",width:60},Artist:{title:"Artist",render:e=>{var t;return r.createElement(Gv,{value:e.itemType===Kn.Media?null===(t=e.artists)||void 0===t?void 0:t.join(", "):e.artist})},className:"artist"},AlbumArtist:{title:"Album Artist",render:e=>r.createElement(Gv,{value:e.albumArtist}),className:"artist"},Title:{title:"Title",render:e=>r.createElement(Gv,{value:e.title}),className:"title"},IconTitle:{title:"Title",render:e=>{const[t]=e.src.split(":"),n=_l(t);return n?r.createElement(Kv,{icon:n.icon,text:e.title}):r.createElement(Gv,{value:e.title})},className:"title"},Blurb:{title:"Description",render:e=>r.createElement(Gv,{value:e.description}),className:"blurb"},Album:{title:"Album",render:e=>r.createElement(Gv,{value:e.album}),className:"album"},AlbumAndYear:{title:"Album",render:e=>r.createElement(Gv,{value:e.album?e.year?`${e.album} (${e.year})`:e.album:e.year}),className:"album"},Track:{title:"Track",render:e=>r.createElement(Gv,{value:e.track||"-"}),align:"right",width:80,className:"track"},Duration:{title:"Time",render:Qv,align:"right",width:120,className:"duration"},FileIcon:{title:"Thumbnail",render:(e,t)=>{const n=e.itemType===Kn.Media?e.mediaType===jr.Video?"file-video":"file-audio":0===t&&e.fileName.startsWith("../")?"folder-up":"folder";return r.createElement("figure",{className:"cover-art"},r.createElement(xi,{className:"cover-art-image",name:n}))},className:"thumbnail"},FileName:{title:"FileName",render:e=>r.createElement(Gv,{value:e.fileName}),className:"title"},PlayCount:{title:"Plays",render:e=>r.createElement(Gv,{value:Zv(e.playCount)}),align:"right",width:80,className:"play-count"},TrackCount:{title:"Tracks",render:e=>r.createElement(Gv,{value:Zv(e.trackCount)}),align:"right",width:120,className:"track-count"},Year:{title:"Year",render:e=>r.createElement(Gv,{value:e.year}),width:120,className:"year"},Views:{title:"Views",render:e=>void 0===e.globalPlayCount?null:r.createElement(Gv,{value:eb(e.globalPlayCount,"view")}),className:"views"},Genre:{title:"Genre",render:e=>{var t;return r.createElement(Gv,{value:null===(t=e.genres)||void 0===t?void 0:t.join(", ")})},className:"genre"},Owner:{title:"Owner",render:e=>{var t;return r.createElement(Gv,{value:null===(t=e.owner)||void 0===t?void 0:t.name})},className:"owner"},LastPlayed:{title:"Last played",render:e=>{if(!e.playedAt)return"";const t=new Date(1e3*e.playedAt),n=function(e){const t=Date.now()-e,n=6e4;if(t<12e4)return"just now";const r=36e5;if(t<54e5)return`${Math.round(t/n)} mins ago`;const i=24*r;if(t<1.5*i)return`${Math.round(t/r)} hours ago`;if(t<12*i)return`${Math.round(t/i)} days ago`;const a=7*i;if(t<10*a)return`${Math.round(t/a)} weeks ago`;const o=365*i;return t<o?`${Math.round(t/2592e6)} months ago`:t<2*o?"1 year ago":`${Math.floor(t/o)} years ago`}(t.valueOf());return r.createElement("time",{className:"text last-played",title:t.toLocaleDateString()},n)},className:"played-at"},ListenDate:{title:"Played On",render:e=>{if(!e.playedAt)return"";const t=1e3*e.playedAt;return r.createElement("time",{className:"text"},r.createElement(Wv,{time:t}),r.createElement("span",{className:"date"},new Date(t).toLocaleDateString()))},className:"played-at listen-date"},Thumbnail:{title:"Thumbnail",render:e=>r.createElement(Yp,{item:e}),className:"thumbnail"},Rate:{title:r.createElement($p,{rating:0}),render:e=>{const t=(0,r.useCallback)((t=>{return n=void 0,r=void 0,a=function*(){yield xv(Hn.Rate,[e],t)},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(t.value).then(o,s)}l((a=a.apply(n,r||[])).next())}));var n,r,i,a}),[e]);return r.createElement($p,{rating:e.rating,onClick:t})},className:"rate",width:120}};function Zv(e){if(null==e)return"";const t=Number(e);return isNaN(t)?"":t.toLocaleString()}function eb(e=0,t="listen",n=t+"s"){return 1===e?`1 ${t}`:e<1e3?`${e} ${n}`:e<1e5?`${(e/1e3).toFixed(1).replace(".0","")}K  ${n}`:e<1e6?`${Math.round(e/1e3)}K  ${n}`:e<1e8?`${(e/1e6).toFixed(1).replace(".0","")}M  ${n}`:e<1e9?`${Math.round(e/1e6)}M  ${n}`:`${(e/1e9).toFixed(1).replace(".0","")}M  ${n}`}var tb=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))},nb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function rb(e){var{className:t="",pager:n=null,keepAlive:i,statusBar:a=!0,loadingText:o,onDoubleClick:s,onEnter:l,onSelect:c}=e,u=nb(e,["className","pager","keepAlive","statusBar","loadingText","onDoubleClick","onEnter","onSelect"]);const d=function(e=Jv){return(0,r.useMemo)((()=>function(e){const{view:t,fields:n}=e,i=n.map((e=>Xv[e]));return i.push({title:r.createElement(xi,{name:"menu"}),render:e=>r.createElement(Rp,{item:e,inline:!0}),className:"actions",align:"right",width:80}),"details"===t?{view:t,cols:i,showTitles:!0,sizeable:!0}:{view:t,cols:i}}(e)),[e])}(u.layout),[m,h]=(0,r.useState)(0),[f,p]=(0,r.useState)(0),[{items:v,loaded:b,error:g,size:y,maxSize:w},E]=function(e,t=!1){const[n,i]=function(){const e=(0,r.useRef)(null);null===e.current&&(e.current=new Pe),(0,r.useEffect)((()=>()=>{var t;return null===(t=e.current)||void 0===t?void 0:t.complete()}),[]);const t=(0,r.useCallback)((t=>{e.current.next(t)}),[]);return[e.current,t]}(),[a,o]=(0,r.useState)([]),[s,l]=(0,r.useState)(void 0),[c,u]=(0,r.useState)(void 0),[d,m]=(0,r.useState)(),[h,f]=(0,r.useState)(!1),p=(0,r.useMemo)((()=>({items:a,size:s,maxSize:c,error:d,loaded:h})),[a,s,c,d,h]),v=(0,r.useCallback)(((e,t)=>{i([e,t])}),[i]);return(0,r.useEffect)((()=>{if(o([]),l(void 0),u(void 0),m(void 0),f(!1),!e)return;const r=e.observeItems(),i=e.observeSize(),a=e.observeError(),s=bn(r,a).pipe(hr(1),Gt((()=>!0))),c=gn(Pn([]),Pn([]).pipe(Cl(0))),d=new ne;return d.add(gn(c,r).subscribe(o)),d.add(i.subscribe(l)),d.add(a.subscribe(m)),d.add(s.subscribe(f)),d.add(n.subscribe((([t,n])=>e.fetchAt(t,n)))),t||d.add((()=>e.disconnect())),u(e.maxSize),()=>d.unsubscribe()}),[e,n,t]),[p,v]}(n,i),[x,k]=(0,r.useState)(0),S=Vv(),C=function(e){const[t,n]=(0,r.useState)("");return(0,r.useEffect)((()=>{let t=0;"details"!==e.view&&e.cols.forEach((e=>{/played-at/.test(e.className)&&(t=2),2!==t&&/duration|track-count|play-count/.test(e.className)&&(t=1)})),n(t?`clip-${t}`:"")}),[e]),t}(d);(0,r.useEffect)((()=>{m>=0&&f>0&&E(m,f)}),[E,m,f,n]);const T=(0,r.useCallback)((e=>{k(e.length),null==c||c(e)}),[c]),P=(0,r.useCallback)(((e,t,n,r,i)=>tb(this,void 0,void 0,(function*(){if(0===e.length)return;const r=yield Ap(e,!0,t,n,-1===i?"right":"left");r&&(yield xv(r,e))}))),[]),A=(0,r.useCallback)(((e,t)=>tb(this,void 0,void 0,(function*(){ib(e)?yield xv(Hn.Queue,[e]):null==s||s(e,t)}))),[s]),I=(0,r.useCallback)(((e,t,n)=>tb(this,void 0,void 0,(function*(){e.every(ib)?t||n?t&&!n?yield xv(Hn.PlayNow,e):n&&!t&&(yield xv(Hn.PlayNext,e)):yield xv(Hn.Queue,e):null==l||l(e,t,n)}))),[l]),O=(0,r.useCallback)((e=>tb(this,void 0,void 0,(function*(){yield xv(Hn.Info,e)}))),[]),M=(0,r.useCallback)((e=>{if(e.itemType===Kn.Media){const[t]=e.src.split(":");return`source-${t} ${e.src===(null==S?void 0:S.src)?"playing":""} ${e.unplayable?"unplayable":""}`}return""}),[S]);return r.createElement("div",{className:`panel ${t} ${C}`},r.createElement(Lv,Object.assign({},u,{className:"media-list",layout:d,items:v,itemClassName:M,itemKey:"src",selectedIndex:0===v.length?-1:0,onContextMenu:P,onDoubleClick:A,onEnter:I,onInfo:O,onPageSizeChange:p,onScrollIndexChange:h,onSelect:T})),a?r.createElement(Bv,{items:v,error:g,size:y,maxSize:w,loading:!!n&&!b,loadingText:o,selectedCount:x}):null)}function ib(e){return e.itemType===Kn.Media||e.itemType===Kn.Album}var ab=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const ob={view:"details",fields:["Artist","Title","Album","Track","Duration","Genre","PlayCount"]};function sb(e){var{className:t="",layout:n=ob,multiple:i=!0,draggable:a=!0}=e,o=ab(e,["className","layout","multiple","draggable"]);return r.createElement(rb,Object.assign({},o,{className:`media-items ${t}`,layout:n,multiple:i,draggable:a}))}var lb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function cb(e){var{source:t,className:n=""}=e,i=lb(e,["source","className"]);return r.createElement("div",{className:`panel media-item-browser ${n}`},r.createElement(sb,Object.assign({},i,{title:t.title})),";")}function ub(e){var t;return(null===(t=window.MusicKit)||void 0===t?void 0:t.version.startsWith("3"))?r.createElement(cb,Object.assign({},e)):r.createElement(db,null)}function db(){return r.createElement(Uu,null,r.createElement("div",{className:"note"},r.createElement("p",null,r.createElement("strong",null,"Apple MusicKit beta required.")),r.createElement("p",null,"You need to enable ",r.createElement("strong",null,"MusicKit beta")," from the Settings screen to watch videos from Apple Music.")))}function mb({min:e="1970",max:t=hb(),value:n=t,onSelect:i}){const[a,o]=(0,r.useState)((()=>String(new Date(n).getFullYear()))),s=function(e,t){const[n,i]=(0,r.useState)([]);return(0,r.useEffect)((()=>{const n=[],r=new Date(e),a=new Date(t),o=r.getFullYear();let s=a.getFullYear();for(;s>=o;)n.push(s),s--;i(n)}),[e,t]),n}(e,t);(0,r.useEffect)((()=>{null==i||i(a)}),[i,a]);const l=(0,r.useCallback)((e=>{o(e.target.value)}),[]);return r.createElement("span",{className:"year-picker"},r.createElement("select",{defaultValue:a,onChange:l},s.map((e=>r.createElement("option",{value:e,key:e},e)))))}function hb(){const e=new Date;return String(e.getFullYear())}const fb=(()=>{const e=new Intl.DateTimeFormat(navigator.language,{month:"short"}).format;return[...Array(12).keys()].map((t=>e(new Date(2022,t,2))))})();function pb({min:e="1970-01",max:t=v(),value:n=t,onSelect:i}){const a=(0,r.useRef)(null),[o,s]=(0,r.useState)((()=>String(new Date(n).getFullYear()))),[l,c]=(0,r.useState)((()=>new Date(n).getMonth())),u=function(e,t,n){const[i,a]=(0,r.useState)([]);return(0,r.useEffect)((()=>{const r=[],i=new Date(t),o=new Date(n),s=Number(e)===i.getFullYear()?i.getMonth():0;let l=Number(e)===o.getFullYear()?o.getMonth():11;for(;l>=s;)r.push(l),l--;a(r)}),[e,t,n]),i}(o,e,t);(0,r.useEffect)((()=>{const e=u[0];void 0!==e&&(a.current.value=String(e),c(e))}),[u]),(0,r.useEffect)((()=>{-1!==l&&(null==i||i(`${o}-${String(l+1).padStart(2,"0")}`))}),[i,o,l]);const d=(0,r.useCallback)((e=>{c(-1),s(e)}),[]),m=(0,r.useCallback)((e=>{c(Number(e.target.value))}),[]);return r.createElement("span",{className:"month-picker"},r.createElement(mb,{min:e,max:t,value:o,onSelect:d}),r.createElement("select",{defaultValue:l,onChange:m,key:o,ref:a},u.map((e=>r.createElement("option",{value:e,key:e},fb[e])))))}function vb({min:e="1970-01-01",max:t=p(),value:n=t,onSelect:i}){const a=(0,r.useRef)(null),[o,s]=(0,r.useState)((()=>v(n))),[l,c]=(0,r.useState)((()=>new Date(n).getDate())),u=function(e,t,n){const[i,a]=(0,r.useState)([]);return(0,r.useEffect)((()=>{const r=[],i=new Date(t),o=new Date(n),s=e.split("-").map(Number),l=s[0],c=s[1]-1,u=l===i.getFullYear()&&c===i.getMonth()?i.getDate():1;let d=l===o.getFullYear()&&c===o.getMonth()?o.getDate():new Date(l,c+1,0).getDate();for(;d>=u;)r.push(d),d--;a(r)}),[e,t,n]),i}(o,e,t);(0,r.useEffect)((()=>{const e=u[0];e&&(a.current.value=String(e),c(e))}),[u]),(0,r.useEffect)((()=>{l&&(null==i||i(`${o}-${String(l).padStart(2,"0")}`))}),[i,o,l]);const d=(0,r.useCallback)((e=>{c(0),s(e)}),[]),m=(0,r.useCallback)((e=>{c(Number(e.target.value))}),[]);return r.createElement("span",{className:"date-picker"},r.createElement(pb,{min:e,max:t,value:o,onSelect:d}),r.createElement("select",{defaultValue:l,onChange:m,key:o,ref:a},u.map((e=>r.createElement("option",{value:e,key:e},e)))))}function bb({icon:e,children:t}){return r.createElement("h2",{className:"page-header"},r.createElement(Kv,{icon:e,text:t}))}function gb(e,t){const[n,i]=(0,r.useState)(null);return(0,r.useEffect)((()=>{i((null==e?void 0:e.search(t))||null)}),[e,t]),n}var yb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const wb={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","ListenDate"]};function Eb(e){var{service:t,source:n,minDate:i="2010-01-1"}=e,a=yb(e,["service","source","minDate"]);const[o,s]=(0,r.useState)(0),l=function(e,t=0){return gb(e,(0,r.useMemo)((()=>({startAt:t})),[t]))}(n,o),c=(0,r.useCallback)((e=>{const t=new Date,n=new Date(e);n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()?s(0):s(Math.floor(n.valueOf()/1e3))}),[]);return r.createElement(r.Fragment,null,r.createElement(bb,{icon:t.icon},t.name,":",r.createElement(vb,{min:i,onSelect:c})),r.createElement(cb,Object.assign({},a,{className:"history-browser",source:n,pager:l,layout:n.layout||wb})))}const xb="2002-11-20",kb=new A("lastfm/useHistoryStart");function Sb(){const e=function(){const[e,t]=(0,r.useState)((()=>ga.firstScrobbledAt)),n=""===e||e===xb;return(0,r.useEffect)((()=>{if(n){t(xb);const e=vn(Aa.getUserInfo()).pipe(Gt((e=>Number(e.user.playcount))),Zt((e=>{return e?Pn(e):(n=X(t=()=>Error("No history."))?t:function(){return t},new Se((function(e){return e.error(n())})));var t,n})),Gt((e=>Math.floor(e/50))),Gt((e=>new Ma({page:e},{pageSize:50}))),Zt((e=>fr(e))),Gt((e=>e.at(-1))),ze(l),Gt((e=>new Date(1e3*e.playedAt))),Gt(p),$e((e=>ga.firstScrobbledAt=e)),$e(t)).subscribe(kb);return()=>e.unsubscribe()}}),[n]),e}();return r.createElement(Eb,{service:_a,source:ja,minDate:e})}class Cb extends Ur{disconnect(){super.disconnect(),this.items.forEach((e=>{var t;return null===(t=e.pager)||void 0===t?void 0:t.disconnect()}))}fetchAt(){}next(e){this.disconnected||(this.subscriptions||this.connect(),this.size$.next(e.length),this.items$.next(e))}}var Tb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Pb={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]};function Ab(e){var{service:t,source:n,total:i}=e,a=Tb(e,["service","source","total"]);const[,o]=(0,r.useReducer)((e=>e+1),0);return(0,r.useEffect)((()=>{const e=setInterval(o,6e4);return()=>clearInterval(e)}),[]),r.createElement(r.Fragment,null,r.createElement(bb,{icon:t.icon},void 0===i?t.name:r.createElement(r.Fragment,null,t.name,": ",i.toLocaleString()," scrobbles")),r.createElement(cb,Object.assign({},a,{className:"recently-played-browser",source:n,layout:n.layout||Pb})))}var Ib=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const Ob=new A("LastFmRecentlyPlayedBrowser");function Mb(){const{pager:e,total:t}=function(){const e=(0,r.useMemo)((()=>Math.floor(Date.now()/1e3)),[]),[t,n]=(0,r.useState)(null),[i,a]=(0,r.useState)(void 0);return(0,r.useEffect)((()=>{const t=new Cb,r=new Ma({to:e}),i=new Rr(t,r),o=bn(wc().pipe(kl(1),Cl(2e4)),Dt(3e5)),s=new ne;return s.add(r.observeItems().pipe($s((e=>0===e.length)),hr(1),Gt((e=>e[0].playedAt)),yn((e=>o.pipe(Zt((()=>function(e){return Ib(this,void 0,void 0,(function*(){const t=new Ma({from:e});return yield fr(t)}))}(e+1))),$e((e=>t.next(e))))))).subscribe(Ob)),s.add(i.observeSize().pipe($e(a)).subscribe(Ob)),t.next([]),n(i),()=>s.unsubscribe()}),[e]),{pager:t,total:i}}();return r.createElement(Ab,{service:_a,source:La,pager:e,total:t})}var Nb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const $b=[{value:"overall",text:"All time"},{value:"12month",text:"Year"},{value:"1month",text:"Month"},{value:"7day",text:"Week"}];function zb(e){var{source:t}=e,n=Nb(e,["source"]);const i=(0,r.useId)(),[a,o]=(0,r.useState)(),s=function(e,t="overall"){return gb(e,(0,r.useMemo)((()=>({period:t})),[t]))}(t,a),l=(0,r.useCallback)((e=>{o(e.target.value)}),[]);return r.createElement(r.Fragment,null,r.createElement(bb,{icon:_a.icon},_a.name,": ",t.title),r.createElement("div",{className:"lastfm-period-selector options"},r.createElement("ul",{className:"lastfm-periods"},$b.map((({value:e,text:t})=>r.createElement("li",{className:"lastfm-period",key:e},r.createElement("input",{id:`${i}-period-${e}`,type:"radio",name:"lastfm-period",value:e,defaultChecked:"overall"===e,onChange:l}),r.createElement("label",{htmlFor:`${i}-period-${e}`},t)))))),r.createElement(Cg,Object.assign({},n,{source:t,pager:s,layout:t.layout})))}const jb="2015-09-17";function Lb(){const e=function(){const[e,t]=(0,r.useState)(Ba.firstScrobbledAt),n=""===e||e===jb;return(0,r.useEffect)((()=>{if(n){t(jb);const e=vn(Wa.getListeningActivity()).pipe(Gt((e=>e.find((e=>e.listen_count>0)))),ze(l),Gt((e=>p(1e3*Number(e.from_ts)))),$e((e=>Ba.firstScrobbledAt=e)),hr(1)).subscribe(t);return()=>e.unsubscribe()}}),[n]),e}();return r.createElement(Eb,{service:Qo,source:Bo,minDate:e})}var Rb=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const Db=new A("ListenBrainzRecentlyPlayedBrowser");function _b(){const{pager:e,total:t}=function(){const e=(0,r.useMemo)((()=>Math.floor(Date.now()/1e3)),[]),[t,n]=(0,r.useState)(null),[i,a]=(0,r.useState)(void 0);return(0,r.useEffect)((()=>{const t=new Cb,r=new jo({max_ts:e},!0),i=new Rr(t,r),o=bn(wc().pipe(kl(1),Cl(2e4)),Dt(3e5)),s=new ne;return s.add(r.observeItems().pipe($s((e=>0===e.length)),hr(1),Gt((e=>e[0].playedAt)),yn((e=>o.pipe(Zt((()=>function(e){return Rb(this,void 0,void 0,(function*(){const t=new jo({min_ts:e});return yield fr(t)}))}(e+1))),$e((e=>t.next(e))))))).subscribe(Db)),s.add(i.observeSize().pipe($e(a)).subscribe(Db)),t.next([]),n(i),()=>s.unsubscribe()}),[e]),{pager:t,total:i}}();return r.createElement(Ab,{service:Qo,source:Ho,pager:e,total:t})}var Fb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Vb={view:"card compact",fields:["Thumbnail","Title","Artist","Year"]};function Ub(e){var{className:t="",layout:n=Vb,draggable:i=!0}=e,a=Fb(e,["className","layout","draggable"]);return r.createElement(rb,Object.assign({},a,{className:`albums ${t}`,layout:n,draggable:i}))}var Bb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Hb={view:"details",fields:["Index","Title","Artist","Duration"]};function Yb(e){var{source:t,className:n=""}=e,i=Bb(e,["source","className"]);const[a,o]=(0,r.useState)(null),s=(0,r.useCallback)((([e])=>{o(e||null)}),[]);return r.createElement("div",{className:`panel album-browser ${n}`},r.createElement(At,{id:"album-browser-layout",arrange:"rows",primaryIndex:1},r.createElement(Ub,Object.assign({},i,{title:t.title,onSelect:s})),r.createElement(sb,{title:a?`${a.title}: Tracks`:"",className:"album-items",pager:null==a?void 0:a.pager,keepAlive:!0,layout:t.secondaryLayout||Hb})))}var Kb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Wb={view:"card compact",fields:["Thumbnail","Title","Genre"]};function qb(e){var{className:t="",layout:n=Wb}=e,i=Kb(e,["className","layout"]);return r.createElement(rb,Object.assign({},i,{className:`artists ${t}`,layout:n}))}var Jb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Qb=[{value:"all_time",text:"All time"},{value:"year",text:"Year"},{value:"month",text:"Month"},{value:"week",text:"Week"}];function Gb(e){var{source:t}=e,n=Jb(e,["source"]);const i=(0,r.useId)(),[a,o]=(0,r.useState)(),s=function(e,t="all_time"){return gb(e,(0,r.useMemo)((()=>({range:t})),[t]))}(t,a),l=(0,r.useCallback)((e=>{o(e.target.value)}),[]);return r.createElement(r.Fragment,null,r.createElement(bb,{icon:Qo.icon},Qo.name,": ",t.title),r.createElement("div",{className:"listenbrainz-range-selector options"},r.createElement("ul",{className:"listenbrainz-ranges"},Qb.map((({value:e,text:t})=>r.createElement("li",{className:"listenbrainz-range",key:e},r.createElement("input",{id:`${i}-range-${e}`,type:"radio",name:"listenbrainz-range",value:e,defaultChecked:"all_time"===e,onChange:l}),r.createElement("label",{htmlFor:`${i}-range-${e}`},t)))))),r.createElement(Xb,Object.assign({},n,{source:t,pager:s,layout:t.layout})))}function Xb(e){switch(e.source.itemType){case Kn.Artist:return r.createElement("div",{className:"panel artist-browser"},r.createElement(qb,Object.assign({},e,{title:e.source.title})));case Kn.Album:return r.createElement(Yb,Object.assign({},e));default:return r.createElement(cb,Object.assign({},e))}}var Zb=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const eg={view:"card compact",fields:["Thumbnail","Title","Year"]},tg={view:"details",fields:["Index","Title","Artist","Duration"]},ng={view:"details",fields:["Index","Title","Artist","Duration","Album","Year"]};function rg(e){var{source:t,className:n=""}=e,i=Zb(e,["source","className"]);const[a,o]=(0,r.useState)(null),[s,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(tg),d=(0,r.useCallback)((([e])=>{o(e||null)}),[]),m=(0,r.useCallback)((([e])=>{l(e||null),u(/^\w+:top-tracks/.test(null==e?void 0:e.src)?ng:tg)}),[]);return r.createElement("div",{className:`panel artist-browser ${n}`},r.createElement(At,{id:"artist-browser-layout",arrange:"columns",primaryIndex:0},r.createElement(qb,Object.assign({},i,{title:t.title,onSelect:d})),r.createElement(At,{id:"artist-album-browser-layout",arrange:"rows",primaryIndex:1},r.createElement(Ub,{title:a?`${a.title}: Albums`:"",className:"artist-albums",pager:null==a?void 0:a.pager,keepAlive:!0,layout:t.secondaryLayout||eg,onSelect:m}),r.createElement(sb,{title:s?`${s.title}: Tracks`:"",className:"album-items",pager:null==s?void 0:s.pager,keepAlive:!0,layout:t.tertiaryLayout||c}))))}var ig=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const ag={view:"card minimal",fields:["FileIcon","FileName"]};function og(e){var{className:t="",layout:n=ag,multiple:i=!0,draggable:a=!0,onSelect:o}=e,s=ig(e,["className","layout","multiple","draggable","onSelect"]);const[l,c]=(0,r.useState)([]),u=(0,r.useMemo)((()=>i&&l.every((e=>e.itemType===Kn.Media))),[i,l]),d=(0,r.useMemo)((()=>a&&l.every((e=>e.itemType===Kn.Media))),[a,l]),m=(0,r.useCallback)((e=>{c(e),null==o||o(e)}),[o]);return r.createElement(rb,Object.assign({},s,{className:`folder-items ${t}`,layout:n,multiple:u,draggable:d,onSelect:m}))}var sg=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))},lg=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function cg(e){var{service:t,source:n,className:i=""}=e,a=lg(e,["service","source","className"]);const[o,s]=(0,r.useState)(null),[l,c]=(0,r.useState)("/");(0,r.useEffect)((()=>{const e=n.search();return s(e),c("/"),()=>e.disconnect()}),[n]);const u=(0,r.useCallback)((e=>sg(this,void 0,void 0,(function*(){e.itemType===Kn.Folder&&(s(e.pager),c(e.path||"/"))}))),[]),d=(0,r.useCallback)((e=>sg(this,void 0,void 0,(function*(){if(1===e.length){const t=e[0];(null==t?void 0:t.itemType)===Kn.Folder&&(s(t.pager),c(t.path||"/"))}}))),[]);return r.createElement(r.Fragment,null,r.createElement(bb,{icon:t.icon},t.name,": ",l),r.createElement("div",{className:`panel folder-item-browser ${i}`},r.createElement(og,Object.assign({},a,{title:`Path: ${l}`,pager:o,keepAlive:!0,onEnter:d,onDoubleClick:u}))))}function ug({sources:e,onSourceChange:t}){const n=(0,r.useId)(),i=(0,r.useCallback)((n=>{const r=Number(n.target.value),i=e[r];null==t||t(i)}),[e,t]);return r.createElement("div",{className:"media-source-selector options"},r.createElement("ul",{className:"media-sources"},e.map(((e,t)=>r.createElement("li",{className:"media-source",key:e.id},r.createElement("input",{id:`${n}-${e.id}`,type:"radio",name:n,value:t,defaultChecked:0===t,onChange:i}),r.createElement("label",{htmlFor:`${n}-${e.id}`},e.title))))))}var dg=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const mg={view:"card compact",fields:["Thumbnail","Title","TrackCount","Owner"]};function hg(e){var{className:t="",layout:n=mg}=e,i=dg(e,["className","layout"]);return r.createElement(rb,Object.assign({},i,{className:`playlists ${t}`,layout:n}))}var fg=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const pg={view:"details",fields:["Index","Artist","Title","Album","Duration","Genre"]};function vg(e){var{source:t,className:n=""}=e,i=fg(e,["source","className"]);const[a,o]=(0,r.useState)(null),s=(0,r.useCallback)((([e])=>{o(e||null)}),[]);return r.createElement("div",{className:`panel playlist-browser ${n}`},r.createElement(At,{id:"playlist-browser-layout",arrange:"rows",primaryIndex:1},r.createElement(hg,Object.assign({},i,{title:t.title,onSelect:s})),r.createElement(sb,{title:a?`${a.title}: Tracks`:"",className:"playlist-items",pager:null==a?void 0:a.pager,keepAlive:!0,layout:t.secondaryLayout||pg})))}var bg=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const gg={view:"card",fields:["Thumbnail","IconTitle","TrackCount","Owner"]},yg={view:"card compact",fields:["Thumbnail","Title","Artist","AlbumAndYear","Duration"]};function wg(e){var{source:t,className:n=""}=e,i=bg(e,["source","className"]);const[a,o]=(0,r.useState)(null);(0,r.useEffect)((()=>()=>Qr.unlock()),[t]),(0,r.useEffect)((()=>{a&&Qr.lock(a)}),[a]);const s=(0,r.useCallback)((([e])=>{o(e||null)}),[]);return r.createElement("div",{className:`panel playlist-browser pinned-playlist-browser ${n}`},r.createElement(hg,Object.assign({},i,{title:t.title,layout:t.layout||gg,onSelect:s,statusBar:!1,disabled:!0})),r.createElement(sb,{title:`${t.title}: Tracks`,className:"playlist-items",pager:null==a?void 0:a.pager,keepAlive:!0,layout:t.secondaryLayout||yg}))}function Eg({error:e,children:t}){return r.createElement("div",{className:"panel error-screen"},r.createElement("div",{className:"error-screen-content"},r.createElement("h2",null,"Error"),r.createElement("pre",{className:"note error"},(null==e?void 0:e.message)||String(e)),t))}function xg({service:e,sources:t}){const n=Fv(e.observeIsLoggedIn,!1),i=function(e){return(0,r.useMemo)((()=>function({error:t}){return r.createElement(Eg,{error:t},e&&r.createElement("p",null,r.createElement("button",{className:"disconnect",onClick:e.logout},"Reconnect to ",e.name,"...")))}),[e])}(e),a=`${e.id}/${t.map((e=>e.id))}`;return r.createElement("div",{className:`media-browser ${e.id}-browser`,key:a},n?r.createElement(Wl.SV,{fallbackRender:i},r.createElement(kg,{service:e,sources:t})):r.createElement(Fu,{service:e}))}function kg({service:e,sources:t}){const n=1===t.length?t[0]:null;switch((0,r.useEffect)((()=>{(null==n?void 0:n.viewType)===qn.Library?sr.lock(e.id,n.itemType):sr.unlock()}),[e,n]),(0,r.useEffect)((()=>{(null==n?void 0:n.viewType)===qn.Ratings?mr.lock(e.id,n.itemType):mr.unlock()}),[e,n]),(0,r.useEffect)((()=>()=>{sr.unlock(),mr.unlock()}),[e]),null==n?void 0:n.id){case"lastfm/top/tracks":case"lastfm/top/albums":case"lastfm/top/artists":return r.createElement(zb,{source:n});case"listenbrainz/top/tracks":case"listenbrainz/top/albums":case"listenbrainz/top/artists":return r.createElement(Gb,{source:n});case"lastfm/history":return r.createElement(Sb,null);case"listenbrainz/history":return r.createElement(Lb,null);case"lastfm/recently-played":return r.createElement(Mb,null);case"listenbrainz/recently-played":return r.createElement(_b,null);case"jellyfin/folders":case"plex/folders":return r.createElement(cg,{service:e,source:n});default:return r.createElement(Sg,{service:e,sources:t})}}function Sg({service:e,sources:t}){const[n,i]=(0,r.useState)((()=>t[0])),[a,o]=(0,r.useState)(""),s=function(e,t=""){return gb(e,(0,r.useMemo)((()=>({q:t})),[t]))}(n,a),l=!!n.searchable,c=!l&&!n.isPin;return r.createElement(r.Fragment,null,c?r.createElement(bb,{icon:e.icon},e.name,": ",n.title):null,l?r.createElement(Vu,{icon:e.icon,placeholder:`Search ${e.name}`,onSubmit:o}):null,t.length>1?r.createElement(ug,{sources:t,onSourceChange:i}):null,r.createElement(Cg,{className:l?"search-browser":"",source:n,pager:s,layout:n.layout,loadingText:a?"Searching":void 0}))}function Cg(e){switch(e.source.itemType){case Kn.Artist:return r.createElement(rg,Object.assign({},e));case Kn.Album:return r.createElement(Yb,Object.assign({},e));case Kn.Playlist:return e.source.isPin?r.createElement(wg,Object.assign({},e)):r.createElement(vg,Object.assign({},e));default:switch(e.source.id){case"apple/search/videos":case"apple/library-videos":return r.createElement(ub,Object.assign({},e));default:return r.createElement(cb,Object.assign({},e))}}}console.log("component::MediaSources");const Tg=new z("sources");function Pg({onSelect:e}){const t=(0,r.useRef)(null),n=function(){const[e,t]=(0,r.useState)([]);return(0,r.useEffect)((()=>{const e=bn(Hl.pipe(ze((e=>e!==Bl)),Gt((()=>{}))),Qr.observe()).pipe(Gt((()=>Rl().filter(Yl).map((e=>({id:e.id,label:r.createElement(Kv,{icon:e.icon,text:e.name,showConnectivity:!0}),value:r.createElement(xg,{service:e,sources:e.roots}),startExpanded:!0,children:e.sources.filter(Yl).map((t=>({id:t.id,label:r.createElement(Kv,{icon:t.icon,text:t.title}),value:r.createElement(xg,{service:e,sources:[t]})}))).concat(Qr.getPinsForService(e.id).map((t=>{var n;return null===(n=e.createSourceFromPin)||void 0===n?void 0:n.call(e,t)})).filter(l).map((t=>({id:t.id,label:r.createElement(Kv,{icon:t.icon,text:t.title}),value:r.createElement(xg,{service:e,sources:[t]})}))))})))))).subscribe(t);return()=>e.unsubscribe()}),[]),e}();return(0,r.useEffect)((()=>{t.current.focus()}),[]),r.createElement("div",{className:"panel media-sources"},r.createElement(Fn,{roots:n,onSelect:e,storageId:Tg.id,treeViewRef:t}))}var Ag=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Ig(e){var{id:t,item:n,index:i,selected:a}=e,o=Ag(e,["id","item","index","selected"]);return r.createElement("button",Object.assign({},o,{className:"tab",type:"button",id:`${t}-tab-${i}`,tabIndex:a?0:-1,role:"tab","aria-selected":a,"aria-controls":`${t}-panel-${i}`}),n.tab)}function Og({id:e,item:t,index:n,hidden:i}){return r.createElement("div",{className:"tab-panel",id:`${e}-panel-${n}`,hidden:i,role:"tabpanel","aria-labelledby":`${e}-tab-${n}`},t.panel)}function Mg({label:e,items:t,className:n=""}){const i=(0,r.useId)(),a=(0,r.useRef)(null),[o,s]=(0,r.useState)([]),[l,c]=(0,r.useState)(0);(0,r.useLayoutEffect)((()=>{s(Array.from(a.current.querySelectorAll("button")))}),[]);const u=(0,r.useCallback)((e=>{let t=l;"ArrowRight"===e.code?(e.stopPropagation(),t++):"ArrowLeft"===e.code&&(e.stopPropagation(),t--),t=Math.min(Math.max(t,0),o.length-1);const n=o[t];n&&!n.disabled&&n.focus()}),[l,o]),d=(0,r.useCallback)((e=>{const t=e.target;if(t.id){const e=Number(t.id.split("-").pop());c(e)}}),[]);return r.createElement("div",{className:`tab-list ${n}`},r.createElement("ul",{className:"tab-list-tabs",role:"tablist","aria-label":e,onFocus:d,onKeyDown:u,ref:a},t.map(((e,t)=>r.createElement("li",{role:"presentation",key:t},r.createElement(Ig,{id:i,item:e,index:t,selected:t===l}))))),r.createElement("div",{className:"tab-list-panels"},t.map(((e,t)=>r.createElement(Og,{id:i,item:e,index:t,hidden:t!==l,key:t})))))}function Ng({service:e}){const t=(0,r.useId)(),n=(0,r.useRef)(null),i=Fv(e.observeIsLoggedIn,!1),a=(0,r.useCallback)((()=>{const e=n.current.elements,t={};for(const n of e)t[n.value]=!n.checked;Kl(t)}),[]);return r.createElement("form",{className:"media-service-settings-general",method:"dialog",onSubmit:a},r.createElement("p",null,r.createElement("button",{type:"button",className:"disconnect",onClick:e.logout,disabled:!i},i?"Disconnect...":"Not connected")),r.createElement("fieldset",{ref:n},r.createElement("legend",null,"Display"),r.createElement("ul",null,e.sources.map((e=>r.createElement("li",{key:e.id},r.createElement("input",{id:`${t}-${e.id}`,type:"checkbox",value:e.id,defaultChecked:Yl(e)}),r.createElement("label",{htmlFor:`${t}-${e.id}`},e.title)))))),r.createElement(Mi,null))}var $g=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function zg(e){var{renderItem:t=String,className:n=""}=e,i=$g(e,["renderItem","className"]);const a=(0,r.useMemo)((()=>({view:"details",cols:[{render:t}]})),[t]);return r.createElement(Lv,Object.assign({},i,{className:`list-box ${n}`,layout:a}))}var jg=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function Lg({service:e}){const t=(0,r.useMemo)((()=>e=>e.title),[]),[n,i]=(0,r.useState)((()=>Qr.getPinsForService(e.id))),[a,o]=(0,r.useState)([]),s=(0,r.useCallback)((()=>jg(this,void 0,void 0,(function*(){const t=Qr.getPinsForService(e.id);yield Qr.unpin(t.filter((e=>-1===n.findIndex((t=>t.src===e.src)))))}))),[e,n]),l=(0,r.useCallback)((()=>{const e=a.map((e=>e.src));i((t=>t.filter((t=>!e.includes(t.src))))),o([])}),[a]);return r.createElement("form",{className:"pinned-settings",method:"dialog",onSubmit:s},r.createElement("h3",null,"Pinned playlists:"),r.createElement(zg,{title:"Pinned playlists",items:n,itemKey:"src",multiple:!0,renderItem:t,onDelete:l,onSelect:o}),r.createElement("p",{className:"pinned-settings-buttons"},r.createElement("button",{type:"button",disabled:0===a.length,onClick:l},"Remove")),r.createElement(Mi,null))}var Rg=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function Dg(){const e=(0,r.useId)(),t=(0,r.useRef)(null),n=(0,r.useCallback)((()=>Rg(this,void 0,void 0,(function*(){kr.useMusicKitBeta=t.current.checked,(yield ji({title:"Reload required",message:r.createElement(r.Fragment,null,r.createElement("p",null,"You need to reload for changes to take effect."),r.createElement("p",null,"Reload now?")),okLabel:"Reload",system:!0}))&&(yield ui.logout(),location.reload())}))),[]);return r.createElement("form",{className:"apple-beta-settings",method:"dialog",onSubmit:n},r.createElement("fieldset",null,r.createElement("legend",null,"MusicKit*"),r.createElement("p",null,r.createElement("input",{type:"radio",name:"use-musickit",id:`${e}-musickit-stable`,defaultChecked:!kr.useMusicKitBeta}),r.createElement("label",{htmlFor:`${e}-musickit-stable`},"Stable version")),r.createElement("p",null,r.createElement("input",{type:"radio",name:"use-musickit",id:`${e}-musickit-beta`,defaultChecked:kr.useMusicKitBeta,ref:t}),r.createElement("label",{htmlFor:`${e}-musickit-beta`},"Beta version"))),r.createElement("div",{className:"note"},r.createElement("p",null,"MusicKit beta enables playback of music videos."),r.createElement("p",null,"However, this release of MusicKit is still undergoing changes and may be unstable. If you experience any problems then use the stable release."),r.createElement("p",null,"You will need to reload the page for changes to take effect. And you may have to log in again.")),r.createElement("p",null,r.createElement("small",null,"*MusicKit is a JavaScript library supplied by Apple that provides access to Apple Music services and media playback.")),r.createElement(Mi,null))}function _g(){const e=(0,r.useMemo)((()=>[{tab:"General",panel:r.createElement(Ng,{service:ui})},{tab:"Pinned",panel:r.createElement(Lg,{service:ui})},{tab:"Beta",panel:r.createElement(Dg,null)}]),[]);return r.createElement(Mg,{className:"media-service-settings apple-settings",items:e,label:ui.name})}function Fg({service:e}){const t=(0,r.useId)(),n=(0,r.useRef)(null),i=(0,r.useRef)(null),a=(0,r.useMemo)((()=>Rl().filter((e=>!e.isScrobbler))),[]),o=(0,r.useCallback)((()=>{const t=n.current.elements,r={};for(const e of t)r[e.value]=!e.checked;Sf(e,r);const a=i.current.elements,o={};for(const e of a)o[e.value]=e.checked;Tf(e,o)}),[e]);return r.createElement("form",{className:"scrobbling-settings",method:"dialog",onSubmit:o},r.createElement("fieldset",{ref:n},r.createElement("legend",null,"Scrobble"),r.createElement("ul",null,a.map((n=>r.createElement("li",{key:n.id},r.createElement("input",{id:`${t}-${n.id}`,type:"checkbox",value:n.id,defaultChecked:kf(e,n),disabled:"youtube"===n.id}),r.createElement("label",{htmlFor:`${t}-${n.id}`},n.name)))))),r.createElement("fieldset",{ref:i},r.createElement("legend",null,"Options"),r.createElement("ul",null,r.createElement("li",null,r.createElement("input",{id:`${t}-scrobbling-options`,type:"checkbox",value:"updateNowPlaying",defaultChecked:Cf(e)}),r.createElement("label",{htmlFor:`${t}-scrobbling-options`},'Update "Now Playing"')))),r.createElement(Mi,null))}function Vg({service:e}){const t=(0,r.useMemo)((()=>{const t=[{tab:"General",panel:r.createElement(Ng,{service:e})}];return e.createSourceFromPin&&t.push({tab:"Pinned",panel:r.createElement(Lg,{service:e})}),e.isScrobbler&&t.push({tab:"Scrobbling",panel:r.createElement(Fg,{service:e})}),t}),[e]);return r.createElement(Mg,{className:`media-service-settings ${e.id}-settings`,items:t,label:e.name})}function Ug(){return r.createElement(Vg,{service:ua})}function Bg(){return r.createElement(Vg,{service:_a})}function Hg(){return r.createElement(Vg,{service:Qo})}function Yg(){return r.createElement(Vg,{service:Is})}function Kg(){return r.createElement(Vg,{service:vl})}function Wg(){return r.createElement(Vg,{service:No})}function qg(){return Fv((0,r.useMemo)((()=>()=>bn(xt.observe(),wt.observeUserThemes()).pipe(Gt((()=>Object.assign({},xt.current))))),[]),xt.current)}function Jg(){return Fv((0,r.useMemo)((()=>()=>wt.observeUserThemes()),[]),[])}var Qg=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Gg(e){var{colorName:t,onChange:n}=e,i=Qg(e,["colorName","onChange"]);const a=(0,r.useCallback)((e=>{const r=e.target.value;xt[t]=r,null==n||n(r)}),[t,n]);return r.createElement("input",Object.assign({},i,{type:"color",onChange:a}))}function Xg({label:e,backgroundColorName:t,textColorName:n,defaultBackgroundColor:i,defaultTextColor:a,suggestedColors:o,nextSuggestion:s,trackingColor:l="frame"}){const c=qg(),u=i&&a,d=c[t],m=c[n],[h,f]=(0,r.useState)((()=>d||i||"")),[p,v]=(0,r.useState)((()=>m||a||"")),b=!d&&!m,g=(0,r.useCallback)((()=>{if(o&&s){const[e,r]=o;xt[t]=e,xt[n]=r,s()}}),[t,n,o,s]),y=(0,r.useCallback)((()=>{b?(xt[t]=h,xt[n]=p):(xt[t]="",xt[n]="")}),[b,t,n,h,p]),w=(0,r.useCallback)((()=>{const e=xt[t],r=xt[n];xt[t]=r,xt[n]=e}),[t,n]);return r.createElement("p",{className:"color-pair "+(b?"locked":"")},r.createElement("label",null,e,":"),r.createElement(Gg,{colorName:t,value:d||i,title:`${e} background color`,disabled:b,onChange:f}),r.createElement(pp,{icon:"swap",title:"Swap",onClick:w,disabled:b}),r.createElement(Gg,{colorName:n,value:m||a,title:`${e} text color`,disabled:b,onChange:v}),u?r.createElement(pp,{icon:b?"locked":"unlocked",title:b?"Allow editing":`Lock to ${l} color`,onClick:y}):null,o&&s?r.createElement("button",{className:"small",type:"button",onClick:g},"Suggest"):null)}function Zg(e,t){var n=new Xe(e),r=new Xe(t);return(Math.max(n.getLuminance(),r.getLuminance())+.05)/(Math.min(n.getLuminance(),r.getLuminance())+.05)}function ey(e,t,n){void 0===n&&(n={includeFallbackColors:!1,level:"AA",size:"small"});for(var r=null,i=0,a=n.includeFallbackColors,o=n.level,s=n.size,l=0,c=t;l<c.length;l++){var u=c[l],d=Zg(e,u);d>i&&(i=d,r=new Xe(u))}return function(e,t,n){var r,i;void 0===n&&(n={level:"AA",size:"small"});var a=Zg(e,t);switch((null!==(r=n.level)&&void 0!==r?r:"AA")+(null!==(i=n.size)&&void 0!==i?i:"small")){case"AAsmall":case"AAAlarge":return a>=4.5;case"AAlarge":return a>=3;case"AAAsmall":return a>=7;default:return!1}}(e,r,{level:o,size:s})||!a?r:(n.includeFallbackColors=!1,ey(e,["#fff","#000"],n))}var ty=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function ny(e){return ty(this,void 0,void 0,(function*(){return!wt.getUserTheme(e)||ji({title:"My themes",message:`Overwrite existing theme '${e}'?`,okLabel:"Save",storageId:"overwrite-user-theme",system:!0})}))}var ry=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function iy(e){var{suggestedName:t}=e,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["suggestedName"]);const i=(0,r.useId)(),a=(0,r.useMemo)((()=>e=>e.name),[]),[o,s]=(0,r.useState)(t),l=(0,r.useRef)(null),c=(0,r.useRef)(null),u=Jg(),d=(0,r.useCallback)((e=>{s(e.target.value)}),[]),m=(0,r.useCallback)((([e])=>{e&&(c.current.value=e.name,s(e.name))}),[]),h=(0,r.useCallback)((()=>ry(this,void 0,void 0,(function*(){o&&(yield ny(o))&&l.current.close(o)}))),[o]),f=(0,r.useCallback)((e=>ry(this,void 0,void 0,(function*(){e.preventDefault(),h()}))),[h]);return r.createElement(Ci,Object.assign({},n,{className:"save-theme-dialog",title:"Save Theme",onSubmit:f,ref:l}),r.createElement("form",{method:"dialog"},r.createElement("p",{className:"prompt-message"},r.createElement("label",{htmlFor:i},"Name: "),r.createElement("input",{type:"text",id:i,defaultValue:t,spellCheck:!1,autoComplete:"off",autoCapitalize:"off",onChange:d,ref:c})),r.createElement(zg,{title:"My themes",items:u,itemKey:"name",renderItem:a,onDoubleClick:h,onSelect:m}),r.createElement(Mi,{value:o,submitText:"Save"})))}var ay=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const oy=[{tab:"General",panel:r.createElement((function(){const e=(0,r.useId)(),t=qg(),n=(0,r.useRef)(null),i=(0,r.useRef)(null),a=(0,r.useRef)(null),o=(0,r.useMemo)((()=>xt.fontSize),[]),s=(0,r.useMemo)((()=>wt.getDefaultThemes()),[]),l=Jg(),c=!!t.userTheme;(0,r.useLayoutEffect)((()=>{const e=document.getElementById("system").style;return e.setProperty("--font-size",String(xt.fontSize)),()=>{xt.restore(),e.removeProperty("--font-size")}}),[]);const u=(0,r.useCallback)((()=>xt.save()),[]),d=(0,r.useCallback)((()=>{const e=a.current.checked?wt.getUserTheme(i.current.value):wt.getDefaultTheme(n.current.value);e&&xt.apply(e)}),[]),m=(0,r.useCallback)((e=>{xt.fontSize=e.target.valueAsNumber}),[]);return r.createElement("form",{className:"appearance-settings-general",method:"dialog",onSubmit:u},r.createElement("fieldset",null,r.createElement("legend",null,"Theme"),r.createElement("div",{className:"table-layout"},r.createElement("p",null,r.createElement("input",{type:"radio",name:"theme-source",id:`${e}-default-themes`,value:"",checked:!c,onChange:d}),r.createElement("label",{htmlFor:`${e}-default-themes`},"Default themes:"),r.createElement("select",{value:c?void 0:t.name,disabled:c,onChange:d,ref:n},s.map((({name:e})=>r.createElement("option",{value:e,key:e},e))))),r.createElement("p",null,r.createElement("input",{type:"radio",name:"theme-source",id:`${e}-user-themes`,value:"user",checked:c,disabled:0===l.length,onChange:d,ref:a}),r.createElement("label",{htmlFor:`${e}-user-themes`},"My themes:"),r.createElement("select",{value:c?t.name:void 0,onChange:d,disabled:!c,ref:i},l.map((({name:e})=>r.createElement("option",{value:e,key:e},e))))))),r.createElement("fieldset",null,r.createElement("legend",null,"Preferences"),r.createElement("div",{className:"table-layout"},r.createElement("p",{className:"font-size"},r.createElement("label",{htmlFor:"theme-fontSize"},"Font Size:"),r.createElement("input",{type:"range",id:"theme-fontSize",min:12,max:28,step:.4,defaultValue:o,onChange:m})))),r.createElement(Mi,null))}),null)},{tab:"Theme Editor",panel:r.createElement((function(){const e=(0,r.useId)(),t=qg(),n=`${t.name}${xt.edited?" (edited)":""}`,i=`${!!t.userTheme}/${t.name}`,[a,o]=function(e){const[t,n]=(0,r.useState)([]),[i,a]=(0,r.useState)(-1);(0,r.useEffect)((()=>{const t=new Xe(e),r=m([...t.triad(),...t.tetrad(),...t.splitcomplement(),...t.analogous(),...t.monochromatic(),t.lighten(),t.darken(),t.saturate(),t.desaturate(),t.greyscale(),t.brighten()].map((e=>e.toHexString()))).map((e=>new Xe(e))),i=r.reverse().map((e=>[e.toHexString(),ey(e,["black","white"],{includeFallbackColors:!0,level:"AA",size:"large"}).toHexString()]));n(f(i)),a(-1===i.length?-1:0)}),[e]);const o=(0,r.useCallback)((()=>{a((e=>e===t.length-1?-1===t.length?-1:0:e+1))}),[t]);return[t[i],o]}(t.frameColor);(0,r.useLayoutEffect)((()=>{const e=document.getElementById("system").style;return e.setProperty("--font-size",String(xt.fontSize)),()=>{xt.restore(),e.removeProperty("--font-size")}}),[]);const s=(0,r.useCallback)((()=>{xt.save()}),[]),l=(0,r.useCallback)((()=>{!function(e){var t,n,i,a;t=this,n=void 0,a=function*(){const t=yield Pi((t=>r.createElement(iy,Object.assign({},t,{suggestedName:e}))),!0);t&&(xt.name=t,xt.userTheme=!0,yield wt.save(xt.current))},new((i=void 0)||(i=Promise))((function(e,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof i?e:new i((function(t){t(e)}))}(t.value).then(o,s)}l((a=a.apply(t,n||[])).next())}))}(t.name)}),[t]),c=(0,r.useCallback)((e=>{xt.spacing=e.target.valueAsNumber}),[]),u=(0,r.useCallback)((e=>{xt.roundness=e.target.valueAsNumber}),[]),d=(0,r.useCallback)((e=>{xt.flat=e.target.checked}),[]);return r.createElement("form",{className:"theme-editor",method:"dialog",onSubmit:s},r.createElement("div",{className:"table-layout"},r.createElement("p",{className:"theme-name"},r.createElement("label",{htmlFor:`${e}-theme-name`},"Name:"),r.createElement("input",{type:"text",id:`${e}-theme-name`,value:n,spellCheck:!1,readOnly:!0,tabIndex:-1}),r.createElement("button",{className:"small",type:"button",onClick:l},"Save asâ€¦")),r.createElement(Xg,{label:"Frame",backgroundColorName:"frameColor",textColorName:"frameTextColor",key:`${i}/frame`}),r.createElement(Xg,{label:"Content",backgroundColorName:"backgroundColor",textColorName:"textColor",key:`${i}/content`}),r.createElement(Xg,{label:"Selection",backgroundColorName:"selectedBackgroundColor",textColorName:"selectedTextColor",suggestedColors:a,nextSuggestion:o,key:`${i}/selection`}),r.createElement(Xg,{label:"Media button",backgroundColorName:"mediaButtonColor",textColorName:"mediaButtonTextColor",defaultBackgroundColor:xt.defaultMediaButtonColor,defaultTextColor:xt.defaultMediaButtonTextColor,key:`${i}/media-button`}),r.createElement(Xg,{label:"Button",backgroundColorName:"buttonColor",textColorName:"buttonTextColor",defaultBackgroundColor:xt.defaultButtonColor,defaultTextColor:xt.defaultButtonTextColor,key:`${i}/button`}),r.createElement(Xg,{label:"Scrollbar",backgroundColorName:"scrollbarColor",textColorName:"scrollbarTextColor",defaultBackgroundColor:xt.defaultScrollbarColor,defaultTextColor:xt.defaultScrollbarTextColor,trackingColor:"button",key:`${i}/scrollbar`}),r.createElement("p",null,r.createElement("label",{htmlFor:`${e}-theme-spacing`},"Spacing:"),r.createElement("input",{type:"range",id:`${e}-theme-spacing`,min:0,max:1,step:.01,value:t.spacing,onChange:c})),r.createElement("p",null,r.createElement("label",{htmlFor:`${e}-theme-roundness`},"Roundness:"),r.createElement("input",{type:"range",id:`${e}-theme-roundness`,min:0,max:1,step:.01,value:t.roundness,onChange:u})),r.createElement("p",null,r.createElement("label",{htmlFor:`${e}-theme-flat`},"Flat:"),r.createElement("input",{type:"checkbox",id:`${e}-theme-flat`,checked:t.flat,onChange:d}))),r.createElement(Mi,null))}),null)},{tab:"My Themes",panel:r.createElement((function(){const e=(0,r.useRef)(null),t=(0,r.useMemo)((()=>e=>e.name),[]),n=(0,r.useRef)(null),i=Jg(),[a,o]=(0,r.useState)(""),[s,l]=(0,r.useState)([]),[c]=s;(0,r.useEffect)((()=>{if(a){const t=i.findIndex((e=>e.name===a));-1!==t&&(e.current.selectAt(t),o(""))}}),[i,a]);const u=(0,r.useCallback)((()=>ay(this,void 0,void 0,(function*(){if(c){const e=c.name,t=yield Di({title:"My themes",suggestedValue:e,okLabel:"Rename",system:!0});t&&(yield ny(t))&&(yield wt.rename(e,t),o(t))}}))),[c]),d=(0,r.useCallback)((()=>ay(this,void 0,void 0,(function*(){if(c){const e=c.name,t=wt.getUserTheme(e);if(t){const{userTheme:n}=t,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["userTheme"]);!function(e,t,n="text/json"){const r=document.createElement("a");r.href=window.URL.createObjectURL(new Blob([t],{type:n})),r.download=e,r.type=n,r.click()}(`${e}.json`,JSON.stringify(r,void 0,4))}}}))),[c]),m=(0,r.useCallback)((()=>ay(this,void 0,void 0,(function*(){if(c){const e=c.name,t=yield function(e){return t=this,n=void 0,i=function*(){return ji({title:"My themes",message:`Delete theme '${e}'?`,okLabel:"Delete",storageId:"delete-user-theme",system:!0})},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(t.value).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}(e);t&&(yield wt.remove(e),l([]))}}))),[c]),h=(0,r.useCallback)((()=>{n.current.click()}),[]),f=(0,r.useCallback)((e=>ay(this,void 0,void 0,(function*(){var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];n&&(yield function(e){return t=this,n=void 0,i=function*(){const t="Import theme",n=!0;try{const r=yield e.text(),i=JSON.parse(r);if(!xt.validate(i))return void(yield Ii({title:t,message:"Not a valid theme.",system:n}));let a=i.name,o=!1;for(;a&&!o;)a=yield Di({title:t,suggestedValue:a,okLabel:"Import",system:n}),a&&(o=yield ny(a),o&&(yield wt.save(Object.assign(Object.assign({},i),{name:a}))))}catch(e){console.error(e),yield Ii({title:t,message:"Could not load theme.",system:n})}},new((r=void 0)||(r=Promise))((function(e,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(t.value).then(o,s)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}(n),e.target.value="")}))),[]);return r.createElement("form",{className:"user-themes",method:"dialog"},r.createElement("h3",null,"My themes:"),r.createElement(zg,{title:"My themes",items:i,itemKey:"name",renderItem:t,onDelete:m,onSelect:l,listViewRef:e}),r.createElement("p",{className:"user-themes-buttons"},r.createElement("button",{type:"button",onClick:u,disabled:!c},"Renameâ€¦"),r.createElement("button",{type:"button",onClick:d,disabled:!c},"Exportâ€¦"),r.createElement("button",{className:"user-themes-delete",type:"button",onClick:m,disabled:!c},"Delete")),r.createElement("fieldset",{className:"user-themes-import"},r.createElement("legend",null,"Import themes"),r.createElement("p",null,r.createElement("input",{type:"file",accept:"text/json,.json",onChange:f,ref:n}),r.createElement("button",{type:"button",onClick:h},"Importâ€¦"))),r.createElement(Mi,null))}),null)}],sy=[{tab:"General",panel:r.createElement((function(){const e=(0,r.useId)(),t=(0,r.useMemo)((()=>eu.get()),[]),n=Fv(eu.observe,t),i=(0,r.useRef)(null),a=(0,r.useRef)(null),o=(0,r.useRef)(null),s=(0,r.useRef)(null),l=(0,r.useCallback)((()=>{eu.set(t)}),[t]),c=(0,r.useCallback)((()=>{eu.set({allowDuplicates:i.current.checked,showLineNumbers:a.current.checked,zeroPadLineNumbers:o.current.checked,showSourceIcons:s.current.checked})}),[]);return r.createElement("form",{className:"playlist-settings-general",method:"dialog"},r.createElement("fieldset",null,r.createElement("legend",null,"Content"),r.createElement("p",null,r.createElement("input",{id:`${e}-allow-duplicates`,type:"checkbox",checked:n.allowDuplicates,onChange:c,ref:i}),r.createElement("label",{htmlFor:`${e}-allow-duplicates`},"Allow duplicates"))),r.createElement("fieldset",null,r.createElement("legend",null,"Display"),r.createElement("p",null,r.createElement("input",{id:`${e}-item-numbers`,type:"checkbox",checked:n.showLineNumbers,onChange:c,ref:a}),r.createElement("label",{htmlFor:`${e}-item-numbers`},"Show line numbers")),r.createElement("p",null,r.createElement("input",{id:`${e}-zero-pad`,type:"checkbox",checked:n.zeroPadLineNumbers,disabled:!n.showLineNumbers,onChange:c,ref:o}),r.createElement("label",{htmlFor:`${e}-zero-pad`},"Zero pad line numbers")),r.createElement("p",null,r.createElement("input",{id:`${e}-source-icons`,type:"checkbox",checked:n.showSourceIcons,onChange:c,ref:s}),r.createElement("label",{htmlFor:`${e}-source-icons`},"Show media source icons"))),r.createElement(Mi,{onCancel:l}))}),null)}];function ly({providerRef:e,ambientVideoEnabled:t,onSubmit:n}){const i=(0,r.useId)(),a=ed.provider;return r.createElement("form",{className:"visualizer-settings-general",method:"dialog"},r.createElement("p",null,r.createElement("label",{htmlFor:`${i}-visualizer-provider`},"Provider:"),r.createElement("select",{id:`${i}-visualizer-provider`,defaultValue:a,ref:e},r.createElement("option",{value:"none"},"(none)"),r.createElement("option",{value:""},"(random)"),Qh().filter((e=>"ambientvideo"!==e.id||t)).map((e=>r.createElement("option",{value:e.id,key:e.id},e.name))))),r.createElement(Mi,{onSubmit:n}))}function cy({ambientVideoEnabledRef:e,ambientVideoSourceRef:t,useAmbientVideoSourceRef:n,beatsOverlayEnabledRef:i,onAmbientVideoEnabledChange:a,onSubmit:o}){const s=(0,r.useId)(),[l,c]=(0,r.useState)((()=>!!ed.useAmbientVideoSource)),u=(0,r.useCallback)((()=>{t.current.validity.valid||n.current.checked||(t.current.value=""),c(n.current.checked)}),[t,n]),d=(0,r.useCallback)((()=>{const e=t.current.value;let n="Not a valid YouTube url.";/^https?/.test(e)&&/youtu\.?be/.test(e)&&(n="Not a YouTube video or playlist.",Ao(e)&&(n="")),t.current.setCustomValidity(n)}),[t]),m=(0,r.useCallback)((()=>{a(e.current.checked)}),[e,a]);return r.createElement("form",{className:"ambient-video-settings",method:"dialog"},r.createElement("p",null,r.createElement("input",{id:`${s}-ambient-video-enabled`,type:"checkbox",defaultChecked:ed.ambientVideoEnabled,onChange:m,ref:e}),r.createElement("label",{htmlFor:`${s}-ambient-video-enabled`},"Enable ambient video")),r.createElement("fieldset",null,r.createElement("legend",null,"Source"),r.createElement("p",null,r.createElement("input",{type:"radio",name:"video-source",id:`${s}-source-default`,defaultChecked:!ed.useAmbientVideoSource,onChange:u}),r.createElement("label",{htmlFor:`${s}-source-default`},"Default videos")),r.createElement("p",null,r.createElement("input",{type:"radio",name:"video-source",id:`${s}-source-youtube`,defaultChecked:ed.useAmbientVideoSource,onChange:u,ref:n}),r.createElement("label",{id:`${s}-source-youtube-label`,htmlFor:`${s}-source-youtube`},"YouTube video or playlist:")),r.createElement("p",null,r.createElement("input",{type:"url",defaultValue:ed.ambientVideoSource,disabled:!l,required:l,onInput:d,"aria-labelledby":`${s}-source-youtube-label`,ref:t}))),r.createElement("p",null,r.createElement("input",{id:`${s}-beats-overlay`,type:"checkbox",defaultChecked:ed.beatsOverlay,ref:i}),r.createElement("label",{htmlFor:`${s}-beats-overlay`},'Show "beats" overlay')),r.createElement(Mi,{onSubmit:o}))}function uy(){const e=(0,r.useRef)(null),t=(0,r.useRef)(null),n=(0,r.useRef)(null),i=(0,r.useRef)(null),a=(0,r.useRef)(null),[o,s]=(0,r.useState)(ed.ambientVideoEnabled),l=(0,r.useCallback)((()=>{ed.provider=e.current.value,ed.ambientVideoEnabled=t.current.checked,ed.useAmbientVideoSource=i.current.checked,ed.ambientVideoSource=n.current.value,ed.beatsOverlay=a.current.checked}),[]),c=(0,r.useMemo)((()=>[{tab:"General",panel:r.createElement(ly,{providerRef:e,ambientVideoEnabled:o,onSubmit:l})},{tab:"Ambient Video",panel:r.createElement(cy,{ambientVideoEnabledRef:t,ambientVideoSourceRef:n,useAmbientVideoSourceRef:i,beatsOverlayEnabledRef:a,onAmbientVideoEnabledChange:s,onSubmit:l})}]),[e,t,n,i,a,o,l]);return r.createElement(Mg,{className:"visualizer-settings",items:c,label:"Visualizers"})}function dy(e){return r.createElement(Ci,Object.assign({},e,{className:"settings-dialog visualizer-settings-dialog",title:"Visualizer Settings"}),r.createElement(uy,null))}function my(){const e=(0,r.useId)(),t=(0,r.useRef)(null),n=(0,r.useCallback)((()=>{const e=t.current.elements,n={};for(const t of e)n[t.value]=!t.checked;Kl(n)}),[]);return r.createElement("form",{className:"media-library-settings-general",method:"dialog",onSubmit:n},r.createElement("fieldset",{ref:t},r.createElement("legend",null,"Display"),r.createElement("ul",null,Rl().map((t=>r.createElement("li",{key:t.id},r.createElement("input",{id:`${e}-${t.id}`,type:"checkbox",value:t.id,defaultChecked:Yl(t)}),r.createElement("label",{htmlFor:`${e}-${t.id}`},t.name)))))),r.createElement(Mi,null))}function hy(){const e=(0,r.useId)(),t=(0,r.useRef)(null),n=Oc.preferredService,i=(0,r.useCallback)((()=>{Oc.preferredService=t.current.value}),[]);return r.createElement("form",{className:"lookup-settings",method:"dialog",onSubmit:i},r.createElement("label",{htmlFor:`${e}-lookup-services`},"Preferred Service:"),r.createElement("select",{id:`${e}-lookup-services`,defaultValue:n,ref:t},r.createElement("option",{value:""},"(none)"),Dl().map((e=>r.createElement("option",{value:e.id,key:e.id},e.name)))),r.createElement("div",{className:"note"},r.createElement("p",null,"To enable playback from last.fm and ListenBrainz, Ampcast will search your logged in services to find a match."),r.createElement("p",null,"Exact matches are preferred. If you have several exact matches then the match from the preferred lookup service is used.")),r.createElement(Mi,null))}const fy=[{id:"services",label:r.createElement(Kv,{text:"Media Services",icon:"globe"}),value:r.createElement((function(){const e=(0,r.useMemo)((()=>[{tab:"General",panel:r.createElement(my,null)},{tab:"Lookup",panel:r.createElement(hy,null)}]),[]);return r.createElement(Mg,{className:"media-library-settings",items:e,label:"Media Services"})}),null),startExpanded:!0,children:Rl().map((e=>({id:e.id,label:r.createElement(Kv,{icon:e.icon,text:e.name}),value:r.createElement(vy,{service:e})})))},{id:"visualizer",label:r.createElement(Kv,{text:"Visualizer",icon:"visualizer"}),value:r.createElement(uy,null)},{id:"playlist",label:r.createElement(Kv,{text:"Playlist",icon:"playlist"}),value:r.createElement((function(){return r.createElement(Mg,{className:"playlist-settings",items:sy,label:"Playlist Settings"})}),null)},{id:"appearance",label:r.createElement(Kv,{text:"Appearance",icon:"palette"}),value:r.createElement((function(){return r.createElement(Mg,{className:"appearance-settings",items:oy,label:"Appearance"})}),null)}],py=()=>fy;function vy({service:e}){switch(e.id){case"apple":return r.createElement(_g,null);case"spotify":return r.createElement(Kg,null);case"youtube":return r.createElement(Wg,null);case"plex":return r.createElement(Yg,null);case"jellyfin":return r.createElement(Ug,null);case"lastfm":return r.createElement(Bg,null);case"listenbrainz":return r.createElement(Hg,null)}}const by=new z("settings-sources");function gy(e){const t=py(),[n,i]=(0,r.useState)(null);return r.createElement(Ci,Object.assign({},e,{className:"settings-dialog",title:"Settings"}),r.createElement(Fn,{className:"settings-dialog-sources",roots:t,storageId:by.id,onSelect:i}),r.createElement("div",{className:"settings-dialog-source"},n))}console.log("component::MediaLibrary");const yy=(0,r.memo)((function(){const[e,t]=(0,r.useState)(null),n=(0,r.useCallback)((()=>{Pi(gy,!0)}),[]);return r.createElement("div",{className:"media-library"},r.createElement("header",{className:"media-library-head"},r.createElement("h1",{className:"media-library-title"},r.createElement("span",{className:"app-name"},r.createElement(xi,{className:"app-icon",name:"ampcast"}),r.createElement("span",{className:"app-text"},"ampcast")),r.createElement("span",{className:"app-version"},"0.8.15")),r.createElement(pp,{icon:"settings",className:"in-frame",title:"Settings",onClick:n})),r.createElement("div",{className:"media-library-body"},r.createElement(At,{id:"media-library-layout",arrange:"columns",primaryIndex:1},r.createElement(Pg,{onSelect:t}),e||r.createElement(Uu,null))))}));console.log("module::visualizer");const wy=new A("visualizer"),Ey={providerId:"none",name:""},xy=new Ie(Ey),ky=new Pe,Sy=[...Array(75).fill("butterchurn"),...Array(10).fill("ampshader"),...Array(4).fill("audiomotion"),...Array(1).fill("waveform")],Cy=[...Array(70).fill("ampshader"),...Array(10).fill("spotifyviz")],Ty=Array(10).fill("ambientvideo"),Py=Array(20).fill("ambientvideo");function Ay(){return xy}function Iy(){return My().pipe(Gt((e=>Gh(e))),yn((e=>e?e.observeVisualizers():Pn([]))))}function Oy(){return td().pipe(Gt((e=>!!e.lockedVisualizer)),tr())}function My(){return td().pipe(Gt((e=>e.provider||"")),tr())}function Ny(e){ky.next(e)}function $y(){ed.lockedVisualizer=xy.getValue()}function zy(){ed.lockedVisualizer=null}function jy(e,t=1){var n;null===(n=Gh(e))||void 0===n||n.observeVisualizers().pipe($s((e=>0===e.length)),xl(Ay()),$e((([t,n])=>{console.log(`${e} visualizers:`,t.length),n===Ey&&Ny("sync")})),hr(t)).subscribe(wy)}function Ly(){return Fv(Ay,null)}function Ry(e){const[t,n]=(0,r.useState)(null);return(0,r.useEffect)((()=>{null==t&&null!=e&&n(e)}),[t,e]),t}function Dy({visualizer:e}){return r.createElement("article",{className:"visualizer-info"},r.createElement(_y,{visualizer:e}),r.createElement(Fy,{visualizer:e}))}function _y({visualizer:e}){return r.createElement("h3",null,"Visualizer: ",function(e){if(e){const t=Gh(e.providerId);if(t)return t.name}return"none"}(e))}function Fy({visualizer:e}){var t;const n="ambientvideo"===(null==e?void 0:e.providerId)&&e.src.startsWith("youtube:"),i=e?e.externalUrl||(null===(t=Gh(e.providerId))||void 0===t?void 0:t.externalUrl):void 0;return n?r.createElement(Vy,{visualizer:e}):(null==e?void 0:e.name)?r.createElement(r.Fragment,null,r.createElement("h4",null,"Name: ",e.name),i?r.createElement("p",{className:"external-view"},r.createElement("span",null,"Url:")," ",r.createElement(Ja,{href:i})):null):null}function Vy({visualizer:e}){const t=function(e){const[t,,n]=e.split(":"),[i,a]=(0,r.useState)(null);return(0,r.useEffect)((()=>{if(a(null),n&&"youtube"===t){const e=vn(Oo(n)).subscribe(a);return()=>e.unsubscribe()}}),[t,n]),i}(e.src);return t?r.createElement("div",{className:"youtube-video-info"},r.createElement("h4",null,"Title: ",t.title),r.createElement(ov,{owner:t.owner,src:t.src}),r.createElement("p",{className:"external-view"},"View on YouTube: ",r.createElement(xi,{name:"youtube"})," ",r.createElement(Ja,{href:t.externalUrl}))):null}function Uy(e){const t=(0,r.useRef)(null),{debug:n}=pv(t),i=Vv(),a=Ly(),o=Ry(i),s=Ry(a);return r.createElement(Ci,Object.assign({},e,{className:"currently-playing-dialog media-info-dialog",title:"Media Info",ref:t}),r.createElement("form",{method:"dialog"},o?r.createElement(Gp,{item:o,debug:n}):r.createElement("p",null,"The playlist is empty."),o&&o.mediaType!==jr.Video?r.createElement(Dy,{visualizer:s}):null,r.createElement("footer",{className:"dialog-buttons"},r.createElement("button",null,"Close"))))}function By(){const e=(0,r.useRef)(null),t=(0,r.useRef)(null);return(0,r.useLayoutEffect)((()=>{let e;const n=()=>{const r=t.current,i=r.getContext("2d"),a=i.createImageData(r.width,r.height),o=new Uint32Array(a.data.buffer);for(let e=0;e<o.length;e++)o[e]=(255*Math.random()|0)<<24;i.putImageData(a,0,0),e=requestAnimationFrame((()=>n()))};return e=requestAnimationFrame((()=>n())),()=>cancelAnimationFrame(e)}),[]),kt(e,(()=>{const n=t.current,r=e.current.getBoundingClientRect();n.width=r.width,n.height=r.height})),r.createElement("div",{className:"static",ref:e},r.createElement("canvas",{ref:t}))}hu().pipe(ec(200)).subscribe((()=>Ny("item"))),tf.observeError().subscribe((()=>Ny("error"))),Iy().subscribe((()=>Ny("provider"))),ky.pipe(Tn((e=>"click"===e?Rt(50):Pn(void 0)))).pipe(xl(hu(),td()),Gt((([e,t,n])=>function(e,t,n){if(!e||e.mediaType===jr.Video||e.duration<30)return Ey;const r="error"===n,i=e.src.startsWith("spotify:"),a=t.lockedVisualizer;let o=(null==a?void 0:a.providerId)||t.provider;switch(o){case"spotifyviz":if(!i)return Ey;break;case"audiomotion":case"butterchurn":if(i)return Ey;break;case"none":return Ey}if(a)return r?Ey:function(e,t){return Xh(e).find((e=>e.name===t))}(a.providerId,a.name)||Ey;const s=xy.getValue();if(o=t.provider,!o){let e=i?Cy:Sy;t.ambientVideoEnabled&&(e=e.concat(i?Py:Ty)),o=E(e),"click"===n&&o===s.providerId&&1===Xh(o).length&&(o=E(e,o))}const l=Xh(o);return r&&t.provider&&1===l.length?Ey:E(l,s)||Ey}(t,n,e))),tr()).subscribe(xy),Ay().pipe($e((e=>tf.load(e)))).subscribe(wy),jy("ampshader"),jy("butterchurn",2);const Hy=(0,r.memo)((function(){const e=Fv(Iy,[]),t=Fv(Oy,!1),n=Fv(My,void 0),i="none"!==n,a=!t&&(!n||e.length>1),o=function(){const e=Vv(),t=Ly(),[n,i]=(0,r.useState)("");return(0,r.useEffect)((()=>{(null==e?void 0:e.src.startsWith("youtube:"))?i("youtube"):(null==e?void 0:e.src.startsWith("apple:"))&&(null==e?void 0:e.mediaType)===jr.Video?i("apple"):"ambientvideo"===(null==t?void 0:t.providerId)&&(null==t?void 0:t.src.startsWith("youtube:"))?i("youtube"):i("")}),[e,t]),n}(),[s,l]=(0,r.useState)(0),c=(0,r.useCallback)((()=>{Pi(Uy)}),[]),u=(0,r.useCallback)((()=>{Pi(dy,!0)}),[]),d=(0,r.useCallback)((()=>{l(s+1),0===s&&setTimeout((()=>Ny("click")))}),[s]);return(0,r.useEffect)((()=>{if(s){const e=Rt(500).subscribe((()=>l(0)));return()=>e.unsubscribe()}}),[s]),r.createElement("div",{className:"visualizer-controls"},i&&s?r.createElement(By,null):null,r.createElement(bp,{className:"visualizer-controls-settings"},r.createElement(pp,{className:"with-overlay",icon:"info",title:"Info",tabIndex:-1,onClick:c}),r.createElement(pp,{className:"with-overlay",icon:"settings",title:"Settings",tabIndex:-1,onClick:u})),i?r.createElement(bp,{className:"visualizer-controls-selector"},r.createElement(pp,{className:"with-overlay",icon:t?"locked":"unlocked",title:t?"Unlock":"Lock the current visualizer",tabIndex:-1,onClick:t?zy:$y}),a?r.createElement(pp,{className:"with-overlay",icon:"right",title:"Next visualizer",tabIndex:-1,onClick:d}):null):null,o?r.createElement(xi,{className:"source-icon",name:o}):null)}));function Yy(){return Fv(Qf,!0)}const Ky=(0,r.memo)((function(){const e=Vv(),t=Yy(),n=function(){const[e,t]=(0,r.useState)("searching"),n=Vv(),i=null==n?void 0:n.id;return(0,r.useEffect)((()=>t("searching")),[i]),(0,r.useEffect)((()=>{switch(null==n?void 0:n.lookupStatus){case lc.Looking:t("searching");break;case lc.NotFound:t("loaded");break;default:if(n){if(Vl(n)){t("loading");const e=Zf().pipe(hr(1)).subscribe((()=>t("loaded")));return()=>e.unsubscribe()}t("searching")}else t("loaded")}}),[n]),e}(),[i,a]=(0,r.useState)(!1),[o,s]=(0,r.useState)(!1),l=null==e?void 0:e.id;return(0,r.useEffect)((()=>{s(!0);const e=setTimeout((()=>s(!1)),5e3);return()=>clearTimeout(e)}),[l]),(0,r.useEffect)((()=>{if(a(!1),"loaded"===n){const e=setTimeout((()=>a(!0)),4500);return()=>clearTimeout(e)}}),[n]),r.createElement("div",{className:`interstitial ${n} ${i?"ready":""} ${o?"is-recent":""}`},r.createElement("div",{className:"currently-playing"},e?r.createElement(r.Fragment,null,r.createElement("h2",null,e.title),e.artists?r.createElement(r.Fragment,null,r.createElement("span",{className:"by"},"by"),r.createElement("h3",null,e.artists.join(", "))):null):r.createElement("p",null,"The playlist is empty.")),r.createElement("p",{className:"interstitial-state"},t?"":`${"loaded"===n?"playing":n}...`))}));n(6234),console.log("component::Media");const Wy=(0,r.memo)((function(){const e=(0,r.useRef)(null),[t,n]=(0,r.useState)(!1),i=Vv(),a=(null==i?void 0:i.mediaType)===jr.Video,o=function(e,t=200){const[n,i]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{if(e){const n=on(e,"mousemove").pipe($e((()=>i(!0))),ec(t),$e((()=>i(!1)))).subscribe();return()=>n.unsubscribe()}i(!1)}),[e,t]),n}(e.current,4e3),s=Ly(),l=!s||"none"===s.providerId;(0,r.useLayoutEffect)((()=>{hp.appendTo(e.current)}),[]),(0,r.useEffect)((()=>{const t=on(document,"fullscreenchange").pipe(Gt((()=>document.fullscreenElement===e.current))).subscribe(n);return()=>t.unsubscribe()}),[]),kt(e,(()=>{const t=e.current;hp.resize(t.clientWidth,t.clientHeight)}));const c=(0,r.useCallback)((()=>{t?document.exitFullscreen():e.current.requestFullscreen()}),[t]);return r.createElement("div",{className:`panel media ${a?"is-playing-video":""} ${l?"no-visualizer":""}  ${o?"":"idle"}`,onDoubleClick:c,ref:e},r.createElement("div",{id:"playback"}),r.createElement(Ky,null),r.createElement(Hy,null))}));var qy=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Jy(e){var{icon:t,className:n=""}=e,i=qy(e,["icon","className"]);const a=(0,r.useRef)(null),o=(0,r.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),a.current.classList.toggle("active",!0)}),[]);return r.createElement("button",Object.assign({},i,{className:`media-button media-button-${t} ${n}`,type:"button",onMouseDown:o,ref:a}),r.createElement(xi,{name:t}))}const Qy=(0,r.memo)((function(){const[e,t]=(0,r.useState)((()=>hp.muted)),[n,i]=(0,r.useState)((()=>hp.volume)),a=n<=.33?"low":n<=.67?"medium":"high";(0,r.useEffect)((()=>{hp.muted=e}),[e]),(0,r.useEffect)((()=>{hp.volume=n}),[n]);const o=(0,r.useCallback)((e=>{const n=e.target.valueAsNumber;i(n),t(0===n)}),[]),s=(0,r.useCallback)((()=>{i((t=>e?t||.1:t)),t(!e)}),[e]);return r.createElement("div",{className:`volume-control volume-${a}`},r.createElement(pp,{icon:e?"muted":"volume",className:"in-frame","aria-label":e?"Unmute":"Mute",title:e?"unmute":"mute",onClick:s}),r.createElement("input",{type:"range","aria-label":"Volume",min:0,max:1,step:.01,value:e?0:n,onChange:o}))}));function Gy(e){const t=Fv(fu,pu()),n=Yy();return r.createElement(gp,Object.assign({},e),r.createElement(xp,{label:"Stop after current",value:"stop-after-current",checked:hp.stopAfterCurrent,disabled:n,key:"stop-after-current"}),r.createElement(wp,{label:"Jump to current",value:"jump-to-current",disabled:-1===t,key:"jump-to-current"}),r.createElement(kp,null),r.createElement(wp,{label:"Shuffle",value:"shuffle",key:"shuffle"}),r.createElement(kp,null),r.createElement(wp,{label:"Clear",value:"clear",key:"clear"}))}var Xy=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};function Zy({listViewRef:e}){const t=Fv(fu,-1),n=Fv(Wf,0),i=Fv(qf,0),a=Yy(),o=(0,r.useCallback)((e=>{rp(e.target.valueAsNumber)}),[]),s=(0,r.useCallback)((n=>Xy(this,void 0,void 0,(function*(){const i=e.current,o=n.target.getBoundingClientRect();switch(yield function(e,t){return n=this,i=void 0,o=function*(){return Cp((e=>r.createElement(Gy,Object.assign({},e))),e,t)},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{l(o.next(e))}catch(e){t(e)}}function s(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof a?e:new a((function(t){t(e)}))}(t.value).then(r,s)}l((o=o.apply(n,i||[])).next())}));var n,i,a,o}(o.right,o.bottom+4)){case"jump-to-current":i.scrollIntoView(t),i.focus();break;case"stop-after-current":hp.stopAfterCurrent=!hp.stopAfterCurrent;break;case"clear":xu.clear();break;case"shuffle":yield xu.shuffle(!a),i.scrollIntoView(0)}}))),[e,t,a]),l=(0,r.useCallback)((()=>Xy(this,void 0,void 0,(function*(){xu.atStart||(hp.prev(),e.current.scrollIntoView(t-1))}))),[e,t]),c=(0,r.useCallback)((()=>Xy(this,void 0,void 0,(function*(){xu.atEnd||(hp.next(),e.current.scrollIntoView(t+1))}))),[e,t]);return r.createElement("div",{className:"media-controls"},r.createElement("div",{className:"current-time-control"},r.createElement(qv,{time:n}),r.createElement("input",{id:"playhead",type:"range","aria-label":"Seek",min:0,max:i,step:1,value:n,disabled:a,onChange:o})),r.createElement("div",{className:"playback-control"},r.createElement(Qy,null),r.createElement("div",{className:"media-buttons"},r.createElement(Jy,{"aria-label":"Previous track",icon:"prev",onClick:l}),r.createElement(Jy,{"aria-label":a?"Play":"Pause",icon:a?"play":"pause",onClick:a?tp:np}),r.createElement(Jy,{"aria-label":"Stop",icon:"stop",onClick:ip}),r.createElement(Jy,{"aria-label":"Next track",icon:"next",onClick:c})),r.createElement("div",{className:"media-buttons-more"},r.createElement(Jy,{title:"More...",icon:"menu",onClick:s}))))}var ew=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function tw(e){var{items:t,selectedItems:n,rowIndex:i}=e,a=ew(e,["items","selectedItems","rowIndex"]);const o=t.length,s=n.length,l=0===o,c=s===o,u=1===s;return r.createElement(gp,Object.assign({},a),-1===i?null:r.createElement(r.Fragment,null,u?r.createElement(wp,{label:"Play",value:"play",acceleratorKey:"Enter",key:"play"}):null,r.createElement(wp,{label:"Remove",value:"remove",acceleratorKey:"Del",key:"remove"}),u?r.createElement(wp,{label:"Info...",value:"info",acceleratorKey:`${U.ctrlKeyStr}+I`,key:"info"}):null),r.createElement(kp,null),c?null:r.createElement(wp,{label:"Select all",value:"select-all",acceleratorKey:`${U.ctrlKeyStr}+A`,key:"select-all"}),!u&&function(e,t){const n=e.findIndex((e=>e===t[0]));return t.every(((t,r)=>t===e[n+r]))}(t,n)?r.createElement(wp,{label:"Reverse selection",value:"reverse-selection",key:"reverse-selection"}):null,r.createElement(kp,null),l?null:r.createElement(wp,{label:"Clear",value:"clear",key:"clear"}))}const nw={view:"details",showTitles:!1,cols:[{title:"#",render:()=>null,align:"right",className:"index"},{title:"Source",render:function({src:e,lookupStatus:t}){const[n]=e.split(":");let i;switch(t){case lc.Looking:i="lookup-looking";break;case lc.NotFound:i="lookup-not-found";break;default:i=Fl(e)?n:"lookup-pending"}return r.createElement(xi,{name:i,className:"youtube"===n?"":"show-connectivity"})},align:"center",className:"source"},{title:"Title",render:function({title:e,artists:t}){return t?r.createElement(r.Fragment,null,r.createElement("span",{className:"artist-text"},t.join("/")),r.createElement("span",{role:"separator"},"-"),r.createElement("span",{className:"title-text"},e)):r.createElement("span",{className:"title-text"},e)},className:"title"},{title:"Time",render:Qv,align:"right",className:"duration"}]};var rw=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))};const iw=["audio/*","video/*"];function aw(e){var{onSelect:t,onPlay:n,onEject:i,listViewRef:a}=e,o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["onSelect","onPlay","onEject","listViewRef"]);const s=Fv(xu.observe,[]),l=function(e){const t=Vv(),n=Yy(),i=String(e).length,{zeroPadLineNumbers:a,showLineNumbers:o,showSourceIcons:s}=Fv(eu.observe,eu.get());return(0,r.useMemo)((()=>Object.assign(Object.assign({},nw),{cols:nw.cols.filter((e=>{switch(e.className){case"index":return o;case"source":return s;default:return!0}})).map((e=>"index"===e.className?Object.assign(Object.assign({},e),{render:(e,o)=>{const s=function(e,t=0){return r.createElement("span",{className:"number"},String(e+1).padStart(t,"0"))}(o,a?i:0);return e.id===(null==t?void 0:t.id)?r.createElement(r.Fragment,null,r.createElement(xi,{name:n?"pause":"play"}),s):s}}):e))})),[a,o,s,i,t,n])}(s.length),c=Vv(),[u,d]=(0,r.useState)(0),m=(0,r.useCallback)((e=>{const[t]=e.src.split(":");return`source-${t} ${e.id===(null==c?void 0:c.id)?"playing":""} ${e.unplayable||e.lookupStatus===lc.NotFound?"unplayable":""}`}),[c]),h=(0,r.useCallback)((e=>{d(e.length),null==t||t(e)}),[t]),f=(0,r.useCallback)((e=>{null==n||n(e)}),[n]),p=(0,r.useCallback)((e=>{1===e.length&&(null==n||n(e[0]))}),[n]),v=(0,r.useCallback)((e=>{1===e.length&&e[0]===c?null==i||i():xu.remove(e)}),[i,c]),b=(0,r.useCallback)((([e])=>rw(this,void 0,void 0,(function*(){e&&(yield gv(e))}))),[]),g=(0,r.useCallback)(((e,t,i,o,l)=>rw(this,void 0,void 0,(function*(){if(0===s.length)return;const c=yield function(e,t,n,i,a,o="left"){return s=this,l=void 0,u=function*(){return Cp((i=>r.createElement(tw,Object.assign({},i,{items:e,selectedItems:t,rowIndex:n}))),i,a,o)},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function r(e){try{i(u.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):function(e){return e instanceof c?e:new c((function(t){t(e)}))}(t.value).then(n,r)}i((u=u.apply(s,l||[])).next())}));var s,l,c,u}(s,e,o,t,i,-1===l?"right":"left");switch(c){case"play":null==n||n(e[0]);break;case"remove":xu.remove(e);break;case"info":yield gv(e[0]);break;case"select-all":a.current.selectAll();break;case"reverse-selection":{const t=s.findIndex((t=>t===e[0]));xu.reverseAt(t,e.length);break}case"clear":xu.clear()}}))),[n,s,a]);return r.createElement("div",{className:"playlist"},r.createElement(Lv,Object.assign({},o,{title:"Playlist",className:"media-list",layout:l,items:s,itemKey:"id",itemClassName:m,selectedIndex:0===s.length?-1:0,droppable:!0,droppableTypes:iw,multiple:!0,reorderable:!0,onContextMenu:g,onDelete:v,onDoubleClick:f,onDrop:xu.insertAt,onEnter:p,onInfo:b,onMove:xu.moveSelection,onSelect:h,listViewRef:a})),r.createElement(Bv,{items:s,size:s.length,selectedCount:u}))}console.log("component::MediaPlayback");const ow=(0,r.memo)((function(){const e=(0,r.useRef)(null),t=Vv(),n=Yy(),i=(0,r.useCallback)((e=>{e===t?hp.play():(hp.load(null),hp.autoplay=!0,xu.setCurrentItem(e))}),[t]);return r.createElement("div",{className:"media-playback "+(n?"paused":"")},r.createElement(At,{id:"media-playback-layout",arrange:"rows"},r.createElement("div",{className:"panel playback"},r.createElement(Zy,{listViewRef:e}),r.createElement(aw,{onPlay:i,onEject:sp,listViewRef:e})),r.createElement(Wy,null)))}));function sw(e){const t=e.dataTransfer;t&&(e.preventDefault(),t.effectAllowed="none",t.dropEffect="none")}function lw(e=null){var t,n;const r=navigator.mediaSession;e&&(r.metadata=new MediaMetadata({title:e.title,artist:null===(t=e.artists)||void 0===t?void 0:t.join(", "),album:e.artists?"":e.album,artwork:null===(n=e.thumbnails)||void 0===n?void 0:n.map((e=>({src:Kp(e),sizes:`${e.width}x${e.height}`})))})),r.setActionHandler("play",tp),r.setActionHandler("pause",np),r.setActionHandler("stop",ip),r.setActionHandler("previoustrack",ap),r.setActionHandler("nexttrack",op),r.setActionHandler("seekto",(e=>{null!=e.seekTime&&rp(e.seekTime)}))}function cw(e){switch(e.key){case" ":e.target&&!("form"in e.target)&&(e.preventDefault(),uw());break;case"MediaPlayPause":e.preventDefault(),uw();break;case"MediaStop":e.preventDefault(),hp.stop();break;case"MediaTrackPrevious":e.preventDefault(),hp.prev();break;case"MediaTrackNext":e.preventDefault(),hp.next()}}function uw(){hp.paused?hp.play():hp.pause()}const dw=new z("desktopWarning");function mw(){const[e,t]=(0,r.useState)((()=>U.desktop||dw.getBoolean("dismissed"))),n=(0,r.useCallback)((()=>{dw.setBoolean("dismissed",!0),t(!0)}),[]);return e?null:r.createElement("div",{className:"desktop-warning"},r.createElement("h1",null,"ampcast"," ","0.8.15"),r.createElement("p",null,"This application is intended for a desktop browser."),r.createElement("p",null,r.createElement("button",{onClick:n},"Proceed")))}console.log("module::App"),console.log("module::index"),(0,i.s)(document.getElementById("app")).render(r.createElement((function(){return(0,r.useEffect)((()=>{document.body.classList.add(`browser-${U.name.replace(/\s+/g,"-")}`)}),[]),(0,r.useEffect)((()=>{const e=new ne;return Rl().forEach((t=>{const n=t.observeIsLoggedIn().subscribe((e=>{document.body.classList.toggle(`${t.id}-connected`,e),document.body.classList.toggle(`${t.id}-not-connected`,!e)}));e.add(n)})),()=>e.unsubscribe()}),[]),(0,r.useLayoutEffect)((()=>{const e=document.getElementById("app"),t=document.getElementById("system"),n=new ne,r=e=>on(e,"focusin").subscribe((()=>{const t=e.querySelector(".focus");t!==document.activeElement&&(null==t||t.classList.toggle("focus",!1),document.activeElement.classList.toggle("focus",!0))}));return n.add(on(document,"focusout").subscribe((e=>{if(!e.relatedTarget){const e=(document.querySelector(".system .settings-dialog")?t:document).querySelectorAll(".focus");for(const t of e)t.classList.toggle("focus",!1)}}))),n.add(on(document,"mouseup").subscribe((()=>{const e=document.querySelectorAll(".active");for(const t of e)t.classList.toggle("active",!1)}))),n.add(on(t,"mousedown").subscribe(y)),n.add(r(e)),n.add(r(t)),()=>n.unsubscribe()}),[]),(0,r.useEffect)((()=>{const e=on(document,"dragenter"),t=on(document,"dragover"),n=on(document,"drop"),r=bn(e,t).pipe($e(sw)),i=bn(r,n.pipe($e(g))).subscribe();return()=>i.unsubscribe()}),[]),function(){const e=Vv(),t=Fv(Gf,null),n=Fv(Wf,0),i=Fv(qf,0);(0,r.useEffect)((()=>{navigator.mediaSession.setPositionState({duration:i,position:n,playbackRate:1})}),[i,n]),(0,r.useEffect)((()=>lw(null==t?void 0:t.currentItem)),[t]),(0,r.useEffect)((()=>lw(e)),[e])}(),(0,r.useEffect)((()=>{document.getElementById("system").addEventListener("keydown",y),document.getElementById("popup").addEventListener("keydown",y),document.body.addEventListener("keydown",cw)}),[]),function(){(0,r.useEffect)((()=>{(()=>{var e,t,n,r;e=this,t=void 0,r=function*(){var e,t,n,r;const{state:i="granted"}=(yield null===(e=navigator.permissions)||void 0===e?void 0:e.query({name:"persistent-storage"}))||{};let a=yield null===(n=null===(t=navigator.storage)||void 0===t?void 0:t.persisted)||void 0===n?void 0:n.call(t);"granted"!==i||a||(a=yield null===(r=navigator.storage)||void 0===r?void 0:r.persist()),console.log("Persisted storage:",{state:i,persisted:a})},new((n=void 0)||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,s)}l((r=r.apply(e,t||[])).next())}))})()}),[])}(),r.createElement("main",null,r.createElement(At,{id:"main-layout",arrange:"columns"},r.createElement(yy,null),r.createElement(ow,null)),r.createElement(mw,null))}),null))}},e=>{e.O(0,[136,529,503],(()=>(1655,e(e.s=1655)))),e.O()}]);