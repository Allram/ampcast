/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var __webpack_modules__={9742:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),r=t[0],i=t[1];return 3*(r+i)/4-i},t.toByteArray=function(e){var t,r,a=l(e),s=a[0],o=a[1],c=new n(function(e,t,r){return 3*(t+r)/4-r}(0,s,o)),u=0,h=o>0?s-4:s;for(r=0;r<h;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===o&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,c[u++]=255&t),1===o&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,i=e.length,n=i%3,a=[],s=16383,o=0,l=i-n;o<l;o+=s)a.push(c(e,o,o+s>l?l:o+s));return 1===n?(t=e[i-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===n&&(t=(e[i-2]<<8)+e[i-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")};for(var r=[],i=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=a.length;s<o;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,i){for(var n,a,s=[],o=t;o<i;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[(a=n)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},8764:(e,t,r)=>{"use strict";const i=r(9742),n=r(645),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function o(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|p(e,t);let i=o(r);const n=i.write(e,t);return n!==r&&(i=i.slice(0,n)),i}(e,t);if(ArrayBuffer.isView(e))return function(e){if($(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if($(e,ArrayBuffer)||e&&$(e.buffer,ArrayBuffer))return f(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&($(e,SharedArrayBuffer)||e&&$(e.buffer,SharedArrayBuffer)))return f(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return l.from(i,t,r);const n=function(e){if(l.isBuffer(e)){const t=0|m(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||Y(e.length)?o(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),o(e<0?0:0|m(e))}function d(e){const t=e.length<0?0:0|m(e.length),r=o(t);for(let i=0;i<t;i+=1)r[i]=255&e[i];return r}function f(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let i;return i=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(i,l.prototype),i}function m(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||$(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;let n=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return W(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return H(e).length;default:if(n)return i?-1:W(e).length;t=(""+t).toLowerCase(),n=!0}}function g(e,t,r){let i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return x(this,t,r);case"ascii":return I(this,t,r);case"latin1":case"binary":return C(this,t,r);case"base64":return S(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function A(e,t,r){const i=e[t];e[t]=e[r],e[r]=i}function b(e,t,r,i,n){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Y(r=+r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:v(e,t,r,i,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,i,n);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,i,n){let a,s=1,o=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s=2,o/=2,l/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(n){let i=-1;for(a=r;a<o;a++)if(c(e,a)===c(t,-1===i?0:a-i)){if(-1===i&&(i=a),a-i+1===l)return i*s}else-1!==i&&(a-=a-i),i=-1}else for(r+l>o&&(r=o-l),a=r;a>=0;a--){let r=!0;for(let i=0;i<l;i++)if(c(e,a+i)!==c(t,i)){r=!1;break}if(r)return a}return-1}function y(e,t,r,i){r=Number(r)||0;const n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;const a=t.length;let s;for(i>a/2&&(i=a/2),s=0;s<i;++s){const i=parseInt(t.substr(2*s,2),16);if(Y(i))return s;e[r+s]=i}return s}function w(e,t,r,i){return G(W(t,e.length-r),e,r,i)}function E(e,t,r,i){return G(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,i)}function _(e,t,r,i){return G(H(t),e,r,i)}function T(e,t,r,i){return G(function(e,t){let r,i,n;const a=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),i=r>>8,n=r%256,a.push(n),a.push(i);return a}(t,e.length-r),e,r,i)}function S(e,t,r){return 0===t&&r===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,r))}function x(e,t,r){r=Math.min(e.length,r);const i=[];let n=t;for(;n<r;){const t=e[n];let a=null,s=t>239?4:t>223?3:t>191?2:1;if(n+s<=r){let r,i,o,l;switch(s){case 1:t<128&&(a=t);break;case 2:r=e[n+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(a=l));break;case 3:r=e[n+1],i=e[n+2],128==(192&r)&&128==(192&i)&&(l=(15&t)<<12|(63&r)<<6|63&i,l>2047&&(l<55296||l>57343)&&(a=l));break;case 4:r=e[n+1],i=e[n+2],o=e[n+3],128==(192&r)&&128==(192&i)&&128==(192&o)&&(l=(15&t)<<18|(63&r)<<12|(63&i)<<6|63&o,l>65535&&l<1114112&&(a=l))}}null===a?(a=65533,s=1):a>65535&&(a-=65536,i.push(a>>>10&1023|55296),a=56320|1023&a),i.push(a),n+=s}return function(e){const t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);let r="",i=0;for(;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=k));return r}(i)}t.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,r){return function(e,t,r){return u(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},l.allocUnsafe=function(e){return h(e)},l.allocUnsafeSlow=function(e){return h(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if($(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),$(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,i=t.length;for(let n=0,a=Math.min(r,i);n<a;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const i=l.allocUnsafe(t);let n=0;for(r=0;r<e.length;++r){let t=e[r];if($(t,Uint8Array))n+t.length>i.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(i,n)):Uint8Array.prototype.set.call(i,t,n);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(i,n)}n+=t.length}return i},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)A(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)A(this,t,t+3),A(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)A(this,t,t+7),A(this,t+1,t+6),A(this,t+2,t+5),A(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?x(this,0,e):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},a&&(l.prototype[a]=l.prototype.inspect),l.prototype.compare=function(e,t,r,i,n){if($(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return-1;if(t>=r)return 1;if(this===e)return 0;let a=(n>>>=0)-(i>>>=0),s=(r>>>=0)-(t>>>=0);const o=Math.min(a,s),c=this.slice(i,n),u=e.slice(t,r);for(let e=0;e<o;++e)if(c[e]!==u[e]){a=c[e],s=u[e];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},l.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}const n=this.length-t;if((void 0===r||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let a=!1;for(;;)switch(i){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return w(this,e,t,r);case"ascii":case"latin1":case"binary":return E(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const k=4096;function I(e,t,r){let i="";r=Math.min(e.length,r);for(let n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function C(e,t,r){let i="";r=Math.min(e.length,r);for(let n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function P(e,t,r){const i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);let n="";for(let i=t;i<r;++i)n+=K[e[i]];return n}function M(e,t,r){const i=e.slice(t,r);let n="";for(let e=0;e<i.length-1;e+=2)n+=String.fromCharCode(i[e]+256*i[e+1]);return n}function R(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,r,i,n,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<a)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function L(e,t,r,i,n){V(t,i,n,e,r,7);let a=Number(t&BigInt(4294967295));e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function D(e,t,r,i,n){V(t,i,n,e,r,7);let a=Number(t&BigInt(4294967295));e[r+7]=a,a>>=8,e[r+6]=a,a>>=8,e[r+5]=a,a>>=8,e[r+4]=a;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function N(e,t,r,i,n,a){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(e,t,r,i,a){return t=+t,r>>>=0,a||N(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function O(e,t,r,i,a){return t=+t,r>>>=0,a||N(e,0,r,8),n.write(e,t,r,i,52,8),r+8}l.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const i=this.subarray(e,t);return Object.setPrototypeOf(i,l.prototype),i},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let i=this[e],n=1,a=0;for(;++a<t&&(n*=256);)i+=this[e+a]*n;return i},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let i=this[e+--t],n=1;for(;t>0&&(n*=256);)i+=this[e+--t]*n;return i},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=J((function(e){Q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const i=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,n=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(i)+(BigInt(n)<<BigInt(32))})),l.prototype.readBigUInt64BE=J((function(e){Q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const i=t*2**24+65536*this[++e]+256*this[++e]+this[++e],n=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(i)<<BigInt(32))+BigInt(n)})),l.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let i=this[e],n=1,a=0;for(;++a<t&&(n*=256);)i+=this[e+a]*n;return n*=128,i>=n&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let i=t,n=1,a=this[e+--i];for(;i>0&&(n*=256);)a+=this[e+--i]*n;return n*=128,a>=n&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||R(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){e>>>=0,t||R(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=J((function(e){Q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const i=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=J((function(e){Q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const i=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||R(e,4,this.length),n.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||R(e,4,this.length),n.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||R(e,8,this.length),n.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||R(e,8,this.length),n.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,r,i){e=+e,t>>>=0,r>>>=0,i||B(this,e,t,r,Math.pow(2,8*r)-1,0);let n=1,a=0;for(this[t]=255&e;++a<r&&(n*=256);)this[t+a]=e/n&255;return t+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,r,i){e=+e,t>>>=0,r>>>=0,i||B(this,e,t,r,Math.pow(2,8*r)-1,0);let n=r-1,a=1;for(this[t+n]=255&e;--n>=0&&(a*=256);)this[t+n]=e/a&255;return t+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=J((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=J((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*r-1);B(this,e,t,r,i-1,-i)}let n=0,a=1,s=0;for(this[t]=255&e;++n<r&&(a*=256);)e<0&&0===s&&0!==this[t+n-1]&&(s=1),this[t+n]=(e/a>>0)-s&255;return t+r},l.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*r-1);B(this,e,t,r,i-1,-i)}let n=r-1,a=1,s=0;for(this[t+n]=255&e;--n>=0&&(a*=256);)e<0&&0===s&&0!==this[t+n+1]&&(s=1),this[t+n]=(e/a>>0)-s&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=J((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=J((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return O(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return O(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,i){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);const n=i-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,i):Uint8Array.prototype.set.call(e,this.subarray(r,i),t),n},l.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){const t=e.charCodeAt(0);("utf8"===i&&t<128||"latin1"===i)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let n;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(n=t;n<r;++n)this[n]=e;else{const a=l.isBuffer(e)?e:l.from(e,i),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<r-t;++n)this[n+t]=a[n%s]}return this};const z={};function U(e,t,r){z[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function j(e){let t="",r=e.length;const i="-"===e[0]?1:0;for(;r>=i+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function V(e,t,r,i,n,a){if(e>r||e<t){const i="bigint"==typeof t?"n":"";let n;throw n=a>3?0===t||t===BigInt(0)?`>= 0${i} and < 2${i} ** ${8*(a+1)}${i}`:`>= -(2${i} ** ${8*(a+1)-1}${i}) and < 2 ** ${8*(a+1)-1}${i}`:`>= ${t}${i} and <= ${r}${i}`,new z.ERR_OUT_OF_RANGE("value",n,e)}!function(e,t,r){Q(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||q(t,e.length-(r+1))}(i,n,a)}function Q(e,t){if("number"!=typeof e)throw new z.ERR_INVALID_ARG_TYPE(t,"number",e)}function q(e,t,r){if(Math.floor(e)!==e)throw Q(e,r),new z.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new z.ERR_BUFFER_OUT_OF_BOUNDS;throw new z.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,r){let i=`The value of "${e}" is out of range.`,n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=j(String(r)):"bigint"==typeof r&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=j(n)),n+="n"),i+=` It must be ${t}. Received ${n}`,i}),RangeError);const X=/[^+/0-9A-Za-z-_]/g;function W(e,t){let r;t=t||1/0;const i=e.length;let n=null;const a=[];for(let s=0;s<i;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&a.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&a.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function H(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,r,i){let n;for(n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}function $(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const K=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const i=16*r;for(let n=0;n<16;++n)t[i+n]=e[r]+e[n]}return t}();function J(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},2238:e=>{var t;window,t=function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./src/index.js")}({"./node_modules/@assemblyscript/loader/index.js":function(e,t,r){"use strict";r.r(t),r.d(t,"instantiate",(function(){return h})),r.d(t,"instantiateSync",(function(){return d})),r.d(t,"instantiateStreaming",(function(){return f})),r.d(t,"demangle",(function(){return m}));const i="undefined"!=typeof BigUint64Array,n=Symbol(),a=new TextDecoder("utf-16le");function s(e,t){const r=new Uint32Array(e)[t+-4>>>2]>>>1,i=new Uint16Array(e,t,r);return r<=32?String.fromCharCode.apply(String,i):a.decode(i)}function o(e){const t={};function r(e,t){return e?s(e.buffer,t):"<yet unknown>"}const i=e.env=e.env||{};return i.abort=i.abort||function(e,n,a,s){const o=t.memory||i.memory;throw Error(`abort: ${r(o,e)} at ${r(o,n)}:${a}:${s}`)},i.trace=i.trace||function(e,n,...a){const s=t.memory||i.memory;console.log(`trace: ${r(s,e)}${n?" ":""}${a.slice(0,n).join(", ")}`)},i.seed=i.seed||Date.now,e.Math=e.Math||Math,e.Date=e.Date||Date,t}function l(e,t){const r=t.exports,n=r.memory,a=r.table,o=r.__new,l=r.__retain,c=r.__rtti_base||-1;function u(e){const t=function(e){const t=new Uint32Array(n.buffer);if((e>>>=0)>=t[c>>>2])throw Error(`invalid id: ${e}`);return t[(c+4>>>2)+2*e]}(e);if(!(7&t))throw Error(`not an array: ${e}, flags=${t}`);return t}function h(e){const t=new Uint32Array(n.buffer);if((e>>>=0)>=t[c>>>2])throw Error(`invalid id: ${e}`);return t[(c+4>>>2)+2*e+1]}function d(e){return 31-Math.clz32(e>>>6&31)}function f(e,t,r){const i=n.buffer;if(r)switch(e){case 2:return new Float32Array(i);case 3:return new Float64Array(i)}else switch(e){case 0:return new(t?Int8Array:Uint8Array)(i);case 1:return new(t?Int16Array:Uint16Array)(i);case 2:return new(t?Int32Array:Uint32Array)(i);case 3:return new(t?BigInt64Array:BigUint64Array)(i)}throw Error(`unsupported align: ${e}`)}function p(e){const t=new Uint32Array(n.buffer),r=u(t[e+-8>>>2]),i=d(r);let a=4&r?e:t[e+4>>>2];const s=2&r?t[e+12>>>2]:t[a+-4>>>2]>>>i;return f(i,2048&r,4096&r).subarray(a>>>=i,a+s)}function g(e,t,r){return new e(A(e,t,r))}function A(e,t,r){const i=n.buffer,a=new Uint32Array(i),s=a[r+4>>>2];return new e(i,s,a[s+-4>>>2]>>>t)}function b(t,r,i){e[`__get${r}`]=g.bind(null,t,i),e[`__get${r}View`]=A.bind(null,t,i)}return e.__newString=function(e){if(null==e)return 0;const t=e.length,r=o(t<<1,1),i=new Uint16Array(n.buffer);for(var a=0,s=r>>>1;a<t;++a)i[s+a]=e.charCodeAt(a);return r},e.__getString=function(e){if(!e)return null;const t=n.buffer;if(1!==new Uint32Array(t)[e+-8>>>2])throw Error(`not a string: ${e}`);return s(t,e)},e.__newArray=function(e,t){const r=u(e),i=d(r),a=t.length,s=o(a<<i,4&r?e:0);let c;if(4&r)c=s;else{const t=o(2&r?16:12,e),u=new Uint32Array(n.buffer);u[t+0>>>2]=l(s),u[t+4>>>2]=s,u[t+8>>>2]=a<<i,2&r&&(u[t+12>>>2]=a),c=t}const h=f(i,2048&r,4096&r);if(16384&r)for(let e=0;e<a;++e)h[(s>>>i)+e]=l(t[e]);else h.set(t,s>>>i);return c},e.__getArrayView=p,e.__getArray=function(e){const t=p(e),r=t.length,i=new Array(r);for(let e=0;e<r;e++)i[e]=t[e];return i},e.__getArrayBuffer=function(e){const t=n.buffer,r=new Uint32Array(t)[e+-4>>>2];return t.slice(e,e+r)},[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array].forEach((e=>{b(e,e.name,31-Math.clz32(e.BYTES_PER_ELEMENT))})),i&&[BigUint64Array,BigInt64Array].forEach((e=>{b(e,e.name.slice(3),3)})),e.__instanceof=function(e,t){const r=new Uint32Array(n.buffer);let i=r[e+-8>>>2];if(i<=r[c>>>2])do{if(i==t)return!0;i=h(i)}while(i);return!1},e.memory=e.memory||n,e.table=e.table||a,m(r,e)}function c(e){return"undefined"!=typeof Response&&e instanceof Response}function u(e){return e instanceof WebAssembly.Module}async function h(e,t={}){if(c(e=await e))return f(e,t);const r=u(e)?e:await WebAssembly.compile(e),i=o(t),n=await WebAssembly.instantiate(r,t);return{module:r,instance:n,exports:l(i,n)}}function d(e,t={}){const r=u(e)?e:new WebAssembly.Module(e),i=o(t),n=new WebAssembly.Instance(r,t);return{module:r,instance:n,exports:l(i,n)}}async function f(e,t={}){if(!WebAssembly.instantiateStreaming)return h(c(e=await e)?e.arrayBuffer():e,t);const r=o(t),i=await WebAssembly.instantiateStreaming(e,t),n=l(r,i.instance);return{...i,exports:n}}function m(e,t={}){const r=e.__argumentsLength?t=>{e.__argumentsLength.value=t}:e.__setArgumentsLength||e.__setargc||(()=>{});for(let i in e){if(!Object.prototype.hasOwnProperty.call(e,i))continue;const a=e[i];let s=i.split("."),o=t;for(;s.length>1;){let e=s.shift();Object.prototype.hasOwnProperty.call(o,e)||(o[e]={}),o=o[e]}let l=s[0],c=l.indexOf("#");if(c>=0){const t=l.substring(0,c),s=o[t];if(void 0===s||!s.prototype){const e=function(...t){return e.wrap(e.prototype.constructor(0,...t))};e.prototype={valueOf(){return this[n]}},e.wrap=function(t){return Object.create(e.prototype,{[n]:{value:t,writable:!1}})},s&&Object.getOwnPropertyNames(s).forEach((t=>Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t)))),o[t]=e}if(l=l.substring(c+1),o=o[t].prototype,/^(get|set):/.test(l)){if(!Object.prototype.hasOwnProperty.call(o,l=l.substring(4))){let t=e[i.replace("set:","get:")],r=e[i.replace("get:","set:")];Object.defineProperty(o,l,{get(){return t(this[n])},set(e){r(this[n],e)},enumerable:!0})}}else"constructor"===l?(o[l]=(...e)=>(r(e.length),a(...e))).original=a:(o[l]=function(...e){return r(e.length),a(this[n],...e)}).original=a}else/^(get|set):/.test(l)?Object.prototype.hasOwnProperty.call(o,l=l.substring(4))||Object.defineProperty(o,l,{get:e[i.replace("set:","get:")],set:e[i.replace("get:","set:")],enumerable:!0}):"function"==typeof a&&a!==r?(o[l]=(...e)=>(r(e.length),a(...e))).original=a:o[l]=a}return t}t.default={instantiate:h,instantiateSync:d,instantiateStreaming:f,demangle:m}},"./node_modules/@babel/runtime/helpers/defineProperty.js":function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},"./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js":function(e,t,r){"use strict";{const e=(e,t)=>{var r="function"==typeof t,i="function"==typeof t,n="function"==typeof t;Object.defineProperty(Math,e,{configurable:r,enumerable:n,writable:i,value:t})};e("DEG_PER_RAD",Math.PI/180),e("RAD_PER_DEG",180/Math.PI);const t=new Float32Array(1);e("scale",(function(e,t,r,i,n){return 0===arguments.length||Number.isNaN(e)||Number.isNaN(t)||Number.isNaN(r)||Number.isNaN(i)||Number.isNaN(n)?NaN:e===1/0||e===-1/0?e:(e-t)*(n-i)/(r-t)+i})),e("fscale",(function(e,r,i,n,a){return t[0]=Math.scale(e,r,i,n,a),t[0]})),e("clamp",(function(e,t,r){return Math.min(r,Math.max(t,e))})),e("radians",(function(e){return e*Math.DEG_PER_RAD})),e("degrees",(function(e){return e*Math.RAD_PER_DEG}))}},"./node_modules/eel-wasm/dist/build/parser.js":function(e,t,r){(function(e,i){var n=function(){var e=function(e,t,r,i){for(r=r||{},i=e.length;i--;r[e[i]]=t);return r},t=[1,18],r=[1,7],i=[1,19],n=[1,20],a=[1,14],s=[1,15],o=[1,16],l=[1,33],c=[1,31],u=[1,23],h=[1,22],d=[1,24],f=[1,25],m=[1,26],p=[1,27],g=[1,28],A=[1,29],b=[1,30],v=[5,8,15,18,20,28,29,32,33,34,35,36,37,38],y=[5,15,18],w=[5,12,15,17,18,24,25,28,29,30],E=[1,57],_=[5,8,12,15,17,18,24,25,28,29,30],T=[15,18],S=[5,8,15,18,28,29,38],x=[5,8,15,18,28,29,32,33,38],k=[5,8,15,18,28,29,32,33,34,37,38],I=[5,8,15,18,28,29,32,33,34,35,36,37,38],C=[5,8,15,18],P=[5,8,15,18,20,22,28,29,32,33,34,35,36,37,38],M={trace:function(){},yy:{},symbols_:{error:2,SCRIPT:3,expression:4,EOF:5,expressionsOptionalTrailingSemi:6,separator:7,";":8,expressions:9,EXPRESSION_BLOCK:10,IDENTIFIER:11,IDENTIFIER_TOKEN:12,argument:13,arguments:14,",":15,FUNCTION_CALL:16,"(":17,")":18,LOGICAL_EXPRESSION:19,LOGICAL_OPERATOR_TOKEN:20,ASSIGNMENT:21,ASSIGNMENT_OPERATOR_TOKEN:22,number:23,DIGITS_TOKEN:24,".":25,NUMBER_LITERAL:26,UNARY_EXPRESSION:27,"-":28,"+":29,"!":30,BINARY_EXPRESSION:31,"*":32,"/":33,"%":34,"&":35,"|":36,"^":37,COMPARISON_TOKEN:38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:";",12:"IDENTIFIER_TOKEN",15:",",17:"(",18:")",20:"LOGICAL_OPERATOR_TOKEN",22:"ASSIGNMENT_OPERATOR_TOKEN",24:"DIGITS_TOKEN",25:".",28:"-",29:"+",30:"!",32:"*",33:"/",34:"%",35:"&",36:"|",37:"^",38:"COMPARISON_TOKEN"},productions_:[0,[3,2],[3,2],[3,1],[7,1],[7,2],[9,2],[9,3],[6,1],[6,2],[10,1],[11,1],[13,1],[13,1],[14,1],[14,3],[16,3],[16,4],[19,3],[21,3],[21,3],[23,1],[23,2],[23,3],[23,2],[23,1],[26,1],[27,2],[27,2],[27,2],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[4,1],[4,1],[4,3],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3]],performAction:function(e,t,r,i,n,a,s){var o=a.length-1;switch(n){case 1:return{type:"SCRIPT",body:[a[o-1]],loc:this._$};case 2:return{type:"SCRIPT",body:a[o-1],loc:this._$};case 3:return{type:"SCRIPT",body:[],loc:this._$};case 6:this.$=[a[o-1]];break;case 7:this.$=a[o-2].concat([a[o-1]]);break;case 8:this.$=a[o];break;case 9:this.$=a[o-1].concat([a[o]]);break;case 10:this.$={type:"EXPRESSION_BLOCK",body:a[o],loc:this._$};break;case 11:this.$={type:"IDENTIFIER",value:a[o].toLowerCase(),loc:this._$};break;case 14:this.$=[a[o]];break;case 15:this.$=a[o-2].concat([a[o]]);break;case 16:this.$={type:"CALL_EXPRESSION",callee:a[o-2],arguments:[],loc:this._$};break;case 17:this.$={type:"CALL_EXPRESSION",callee:a[o-3],arguments:a[o-1],loc:this._$};break;case 18:this.$={type:"LOGICAL_EXPRESSION",left:a[o-2],right:a[o],operator:a[o-1],loc:this._$};break;case 19:case 20:this.$={type:"ASSIGNMENT_EXPRESSION",left:a[o-2],operator:a[o-1],right:a[o],loc:this._$};break;case 21:this.$=Number(a[o]);break;case 22:this.$=Number(a[o-1]);break;case 23:this.$=Number(a[o-2]+a[o-1]+a[o]);break;case 24:this.$=Number("0"+a[o-1]+a[o]);break;case 25:this.$=0;break;case 26:this.$={type:"NUMBER_LITERAL",value:a[o],loc:this._$};break;case 27:case 28:case 29:this.$={type:"UNARY_EXPRESSION",value:a[o],operator:a[o-1],loc:this._$};break;case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:this.$={type:"BINARY_EXPRESSION",left:a[o-2],right:a[o],operator:a[o-1],loc:this._$};break;case 41:case 47:this.$=a[o-1]}},table:[{3:1,4:2,5:[1,4],6:3,9:13,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{1:[3]},{5:[1,21],7:32,8:l,20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b},{5:[1,34]},{1:[2,3]},e(v,[2,39]),e(v,[2,40]),{4:35,6:37,9:13,10:36,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},e(v,[2,42]),e(v,[2,43]),e(v,[2,44],{22:[1,38]}),e(v,[2,45],{17:[1,40],22:[1,39]}),e(v,[2,46]),e(y,[2,8],{31:5,27:6,26:8,21:9,16:10,11:11,19:12,23:17,4:41,12:t,17:r,24:i,25:n,28:a,29:s,30:o}),{4:42,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:43,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:44,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},e(v,[2,26]),e([5,8,15,17,18,20,22,28,29,32,33,34,35,36,37,38],[2,11]),e(v,[2,21],{25:[1,45]}),e(v,[2,25],{24:[1,46]}),{1:[2,1]},{4:47,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:48,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:49,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:50,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:51,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:52,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:53,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:54,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:55,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:56,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},e(w,[2,6],{8:E}),e(_,[2,4]),{1:[2,2]},{7:32,8:l,18:[1,58],20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b},{18:[1,59]},e(T,[2,10]),{4:60,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:61,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},{4:65,6:37,9:13,10:66,11:11,12:t,13:64,14:63,16:10,17:r,18:[1,62],19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},e(y,[2,9],{7:67,8:l,20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b}),e(S,[2,27],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(S,[2,28],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(S,[2,29],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(v,[2,22],{24:[1,68]}),e(v,[2,24]),e(S,[2,30],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(S,[2,31],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(x,[2,32],{20:c,34:m,35:p,36:g,37:A}),e(x,[2,33],{20:c,34:m,35:p,36:g,37:A}),e(k,[2,34],{20:c,35:p,36:g}),e(I,[2,35],{20:c}),e(I,[2,36],{20:c}),e(k,[2,37],{20:c,35:p,36:g}),e(C,[2,38],{20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b}),e(v,[2,18]),e(_,[2,5]),e(v,[2,41]),e(v,[2,47]),e(C,[2,20],{20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b}),e(C,[2,19],{20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b}),e(P,[2,16]),{15:[1,70],18:[1,69]},e(T,[2,14]),e(T,[2,12],{7:32,8:l,20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b}),e(T,[2,13]),e(w,[2,7],{8:E}),e(v,[2,23]),e(P,[2,17]),{4:65,6:37,9:13,10:66,11:11,12:t,13:71,16:10,17:r,19:12,21:9,23:17,24:i,25:n,26:8,27:6,28:a,29:s,30:o,31:5},e(T,[2,15])],defaultActions:{4:[2,3],21:[2,1],34:[2,2]},parseError:function(e,t){if(!t.recoverable){var r=new Error(e);throw r.hash=t,r}this.trace(e)},parse:function(e){var t=this,r=[0],i=[null],n=[],a=this.table,s="",o=0,l=0,c=0,u=2,h=1,d=n.slice.call(arguments,1),f=Object.create(this.lexer),m={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(m.yy[p]=this.yy[p]);f.setInput(e,m.yy),m.yy.lexer=f,m.yy.parser=this,void 0===f.yylloc&&(f.yylloc={});var g=f.yylloc;n.push(g);var A=f.options&&f.options.ranges;"function"==typeof m.yy.parseError?this.parseError=m.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var b,v,y,w,E,_,T,S,x,k=function(){var e;return"number"!=typeof(e=f.lex()||h)&&(e=t.symbols_[e]||e),e},I={};;){if(y=r[r.length-1],this.defaultActions[y]?w=this.defaultActions[y]:(null==b&&(b=k()),w=a[y]&&a[y][b]),void 0===w||!w.length||!w[0]){var C="";for(_ in x=[],a[y])this.terminals_[_]&&_>u&&x.push("'"+this.terminals_[_]+"'");C=f.showPosition?"Parse error on line "+(o+1)+":\n"+f.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[b]||b)+"'":"Parse error on line "+(o+1)+": Unexpected "+(b==h?"end of input":"'"+(this.terminals_[b]||b)+"'"),this.parseError(C,{text:f.match,token:this.terminals_[b]||b,line:f.yylineno,loc:g,expected:x})}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+b);switch(w[0]){case 1:r.push(b),i.push(f.yytext),n.push(f.yylloc),r.push(w[1]),b=null,v?(b=v,v=null):(l=f.yyleng,s=f.yytext,o=f.yylineno,g=f.yylloc,c>0&&c--);break;case 2:if(T=this.productions_[w[1]][1],I.$=i[i.length-T],I._$={first_line:n[n.length-(T||1)].first_line,last_line:n[n.length-1].last_line,first_column:n[n.length-(T||1)].first_column,last_column:n[n.length-1].last_column},A&&(I._$.range=[n[n.length-(T||1)].range[0],n[n.length-1].range[1]]),void 0!==(E=this.performAction.apply(I,[s,l,o,m.yy,w[1],i,n].concat(d))))return E;T&&(r=r.slice(0,-1*T*2),i=i.slice(0,-1*T),n=n.slice(0,-1*T)),r.push(this.productions_[w[1]][0]),i.push(I.$),n.push(I._$),S=a[r[r.length-2]][r[r.length-1]],r.push(S);break;case 3:return!0}}return!0}},R={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===i.length?this.yylloc.first_column:0)+i[i.length-r.length].length-r[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var r,i,n;if(this.options.backtrack_lexer&&(n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(n.yylloc.range=this.yylloc.range.slice(0))),(i=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var a in n)this[a]=n[a];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,r,i;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),a=0;a<n.length;a++)if((r=this._input.match(this.rules[n[a]]))&&(!t||r[0].length>t[0].length)){if(t=r,i=a,this.options.backtrack_lexer){if(!1!==(e=this.test_match(r,n[a])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,n[i]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){return this.next()||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,r,i){switch(r){case 0:break;case 1:return 24;case 2:return 38;case 3:return 22;case 4:return 20;case 5:return 12;case 6:return 5;case 7:return t.yytext[0]}},rules:[/^(?:\s+)/,/^(?:[0-9]+)/,/^(?:(==|!=|<=|>=|<|>))/,/^(?:[+\-*/%]?=)/,/^(?:(\&\&)|\|\|)/,/^(?:[a-zA-Z_][a-zA-Z0-9._]*)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7],inclusive:!0}}};function B(){this.yy={}}return M.lexer=R,B.prototype=M,M.Parser=B,new B}();t.parser=n,t.Parser=n.Parser,t.parse=function(){return n.parse.apply(n,arguments)},t.main=()=>{},r.c[r.s]===e&&t.main(i.argv.slice(1))}).call(this,r("./node_modules/webpack/buildin/module.js")(e),r("./node_modules/process/browser.js"))},"./node_modules/eel-wasm/dist/src/astUtils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={ASSIGNMENT_EXPRESSION:[{type:"NODE",key:"right"}],SCRIPT:[{type:"ARRAY",key:"body"}],EXPRESSION_BLOCK:[{type:"ARRAY",key:"body"}],UNARY_EXPRESSION:[{type:"NODE",key:"value"}],NUMBER_LITERAL:[],IDENTIFIER:[],CALL_EXPRESSION:[{type:"ARRAY",key:"arguments"},{type:"NODE",key:"callee"}],BINARY_EXPRESSION:[{type:"NODE",key:"left"},{type:"NODE",key:"right"}],LOGICAL_EXPRESSION:[{type:"NODE",key:"left"},{type:"NODE",key:"right"}]};t.mapAst=function e(t,r){const n=i[t.type];let a=t;if(null==n)throw new Error(`Unknown children definition for ${t.type}`);return n.forEach((i=>{if("NODE"===i.type){const n=t[i.key],s=e(n,r);s!==n&&(a=Object.assign(Object.assign({},a),{[i.key]:s}))}else if("ARRAY"===i.type){const n=t[i.key],s=n.map((t=>e(t,r))),o=n.some(((e,t)=>e!==s[t]));o&&(a=Object.assign(Object.assign({},a),{[i.key]:s}))}})),r(a)}},"./node_modules/eel-wasm/dist/src/compiler.js":function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const a=r("./node_modules/eel-wasm/dist/src/parser.js"),s=r("./node_modules/eel-wasm/dist/src/emitter.js"),o=r("./node_modules/eel-wasm/dist/src/encoding.js"),l=i(r("./node_modules/eel-wasm/dist/src/shims.js")),c=n(r("./node_modules/eel-wasm/dist/src/utils.js")),u=r("./node_modules/eel-wasm/dist/src/wasmFunctions.js"),h=r("./node_modules/eel-wasm/dist/src/constants.js");t.compileModule=function({pools:e,functions:t,eelVersion:r=2,preParsed:i=!1}){if(Object.keys(e).includes("shims"))throw new Error('You may not name a pool "shims". "shims" is reserved for injected JavaScript functions.');const n=[];Object.entries(e).forEach((([e,t])=>{t.forEach((t=>{n.push([e,t])}))}));const d=new c.ScopedIdMap;n.forEach((([e,t])=>{d.get(e,t)}));const f=Object.entries(l.default).map((([e,t])=>({args:new Array(t.length).fill(null).map((e=>o.VAL_TYPE.f64)),returns:[o.VAL_TYPE.f64],name:e}))),m=[],p=[];Object.entries(t).forEach((([t,{pool:n,code:l}])=>{if(null==e[n]){const r=Object.keys(e);if(0===r.length)throw new Error(`The function "${t}" was declared as using a variable pool named "${n}" but no pools were defined.`);throw new Error(`The function "${t}" was declared as using a variable pool named "${n}" which is not among the variable pools defined. The defined variable pools are: ${c.formatList(r)}.`)}const h=i?l:a.parse(l);if("string"==typeof h)throw new Error("Got passed unparsed code without setting the preParsed flag");if("SCRIPT"!==h.type)throw new Error("Invalid AST");if(0===h.body.length)return;const g=[],A={resolveVar:e=>/^reg\d\d$/.test(e)?d.get(null,e):d.get(n,e),resolveLocal:e=>(g.push(e),g.length-1),resolveFunc:e=>{const t=f.findIndex((t=>t.name===e));if(-1!==t){const i=o.op.call(t);return"rand"===e&&1===r?[...i,o.op.f64_floor]:i}if(null==u.localFuncMap[e])return null;let i=m.indexOf(e);return-1===i&&(m.push(e),i=m.length-1),o.op.call(i+f.length)},rawSource:l},b=s.emit(h,A);p.push({binary:b,exportName:t,args:[],returns:[],localVariables:g})}));const g=m.map((e=>{const t=u.localFuncMap[e];if(null==t)throw new Error(`Undefined local function "${e}"`);return t})),A=e=>[...e.args,"|",...e.returns].join("-"),b=[],v=new Map;function y(e){const t=A(e),r=v.get(t);if(null==r)throw new Error(`Failed to get a type index for key ${t}`);return r}[...f,...g,...p].forEach((e=>{const t=A(e);v.has(t)||(b.push([o.FUNCTION_TYPE,...o.encodeFlatVector(e.args),...o.encodeFlatVector(e.returns)]),v.set(t,b.length-1))}));const w=[...n.map((([e,t])=>[...o.encodeString(e),...o.encodeString(t),o.GLOBAL_TYPE,o.VAL_TYPE.f64,o.MUTABILITY.var])),...f.map(((e,t)=>{const r=y(e);return[...o.encodeString("shims"),...o.encodeString(e.name),o.TYPE_IDX,...o.unsignedLEB128(r)]}))],E=[...g,...p].map((e=>{const t=y(e);return o.unsignedLEB128(t)})),_=[[1,...o.unsignedLEB128(h.WASM_MEMORY_SIZE),...o.unsignedLEB128(h.WASM_MEMORY_SIZE)]],T=d.size()-n.length,S=c.times(T,(()=>[o.VAL_TYPE.f64,o.MUTABILITY.var,...o.op.f64_const(0),o.op.end])),x=[...p].map(((e,t)=>{const r=t+f.length+g.length;return[...o.encodeString(e.exportName),o.EXPORT_TYPE.FUNC,...o.unsignedLEB128(r)]})),k=[...g,...p].map((e=>{var t;const r=(null!==(t=e.localVariables)&&void 0!==t?t:[]).map((e=>[...o.unsignedLEB128(1),e]));return o.encodeFlatVector([...o.encodeNestedVector(r),...e.binary,o.op.end])}));return new Uint8Array([...o.MAGIC,...o.WASM_VERSION,...o.encodeSection(o.SECTION.TYPE,b),...o.encodeSection(o.SECTION.IMPORT,w),...o.encodeSection(o.SECTION.FUNC,E),...o.encodeSection(o.SECTION.MEMORY,_),...o.encodeSection(o.SECTION.GLOBAL,S),...o.encodeSection(o.SECTION.EXPORT,x),...o.encodeSection(o.SECTION.CODE,k)])}},"./node_modules/eel-wasm/dist/src/constants.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_LOOP_COUNT=1048576,t.BUFFER_SIZE=8388608,t.WASM_MEMORY_SIZE=Math.ceil(8*t.BUFFER_SIZE*2/65536)},"./node_modules/eel-wasm/dist/src/emitter.js":function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r("./node_modules/eel-wasm/dist/src/encoding.js"),a=i(r("./node_modules/eel-wasm/dist/src/shims.js")),s=r("./node_modules/eel-wasm/dist/src/errorUtils.js"),o=r("./node_modules/eel-wasm/dist/src/wasmFunctions.js"),l=r("./node_modules/eel-wasm/dist/src/utils.js"),c=r("./node_modules/eel-wasm/dist/src/constants.js");function u(e,t){var r,i,f;switch(e.type){case"SCRIPT":{const r=e.body.map(((e,r)=>[...u(e,t),n.op.drop]));return l.flatten(r)}case"EXPRESSION_BLOCK":return h(e.body,t);case"BINARY_EXPRESSION":{const r=u(e.left,t),i=u(e.right,t),a={"+":[n.op.f64_add],"-":[n.op.f64_sub],"*":[n.op.f64_mul],"/":t.resolveFunc("div"),"%":t.resolveFunc("mod"),"|":t.resolveFunc("bitwiseOr"),"&":t.resolveFunc("bitwiseAnd"),"^":t.resolveFunc("pow"),"==":[n.op.f64_sub,...n.IS_ZEROISH,n.op.f64_convert_i32_s],"!=":[n.op.f64_sub,...n.IS_NOT_ZEROISH,n.op.f64_convert_i32_s],"<":[n.op.f64_lt,n.op.f64_convert_i32_s],">":[n.op.f64_gt,n.op.f64_convert_i32_s],"<=":[n.op.f64_le,n.op.f64_convert_i32_s],">=":[n.op.f64_ge,n.op.f64_convert_i32_s]}[e.operator];if(null==a)throw s.createCompilerError(`Unknown binary expression operator ${e.operator}`,e.loc,t.rawSource);return[...r,...i,...a]}case"CALL_EXPRESSION":{const i=e.callee.value,f=e.arguments,m=r=>{if(f.length<r)throw s.createUserError(`Too few arguments passed to \`${i}()\`. Expected ${r} but only got ${f.length}.`,e.loc,t.rawSource);if(f.length>r)throw s.createUserError(`Too many arguments passed to \`${i}()\`. Expected ${r} but got ${f.length}.`,f[r].loc,t.rawSource)};switch(i){case"exec2":return m(2),h(e.arguments,t);case"exec3":return m(3),h(e.arguments,t);case"if":m(3);const[a,o,l]=e.arguments;return function(e,t,r,i){return[...u(e,i),...n.IS_NOT_ZEROISH,...n.op.if(n.BLOCK.f64),...u(t,i),n.op.else,...u(r,i),n.op.end]}(a,o,l,t);case"while":return m(1),function(e,t){const r=u(e,t),i=t.resolveLocal(n.VAL_TYPE.i32);return[...n.op.i32_const(0),...n.op.local_set(i),...n.op.loop(n.BLOCK.void),...n.op.local_get(i),...n.op.i32_const(1),n.op.i32_add,...n.op.local_tee(i),...n.op.i32_const(c.MAX_LOOP_COUNT),n.op.i32_lt_u,...r,...n.IS_NOT_ZEROISH,n.op.i32_and,...n.op.br_if(0),n.op.end,...n.op.f64_const(0)]}(e.arguments[0],t);case"loop":return m(2),function(e,t,r){const i=u(t,r),a=r.resolveLocal(n.VAL_TYPE.i32);return[...n.op.block(n.BLOCK.void),...u(e,r),n.op.i32_trunc_f64_s,...n.op.local_tee(a),...n.op.i32_const(0),n.op.i32_le_s,...n.op.br_if(1),...n.op.loop(n.BLOCK.void),...i,n.op.drop,...n.op.local_get(a),...n.op.i32_const(1),n.op.i32_sub,...n.op.local_tee(a),...n.op.i32_const(0),n.op.i32_ne,...n.op.br_if(0),n.op.end,n.op.end,...n.op.f64_const(0)]}(e.arguments[0],e.arguments[1],t);case"megabuf":case"gmegabuf":m(1);const f=t.resolveLocal(n.VAL_TYPE.i32);return[...u(e.arguments[0],t),...null!==(r=t.resolveFunc("_getBufferIndex"))&&void 0!==r?r:[],...n.op.local_tee(f),...n.op.i32_const(-1),n.op.i32_ne,...n.op.if(n.BLOCK.f64),...n.op.local_get(f),...n.op.f64_load(3,d(i)),n.op.else,...n.op.f64_const(0),n.op.end];case"assign":m(2);const p=e.arguments[0];if("IDENTIFIER"!=p.type)throw s.createUserError("Expected the first argument of `assign()` to be an identifier.",p.loc,t.rawSource);const g=t.resolveVar(p.value);return[...u(e.arguments[1],t),...n.op.global_set(g),...n.op.global_get(g)]}const p=l.flatten(e.arguments.map((e=>u(e,t))));switch(i){case"abs":return m(1),[...p,n.op.f64_abs];case"sqrt":return m(1),[...p,n.op.f64_abs,n.op.f64_sqrt];case"int":case"floor":return m(1),[...p,n.op.f64_floor];case"min":return m(2),[...p,n.op.f64_min];case"max":return m(2),[...p,n.op.f64_max];case"above":return m(2),[...p,n.op.f64_gt,n.op.f64_convert_i32_s];case"below":return m(2),[...p,n.op.f64_lt,n.op.f64_convert_i32_s];case"equal":return m(2),[...p,n.op.f64_sub,...n.IS_ZEROISH,n.op.f64_convert_i32_s];case"bnot":return m(1),[...p,...n.IS_ZEROISH,n.op.f64_convert_i32_s];case"ceil":return m(1),[...p,n.op.f64_ceil]}const g=t.resolveFunc(i);if(null==g||i.startsWith("_"))throw s.createUserError(`"${i}" is not defined.`,e.callee.loc,t.rawSource);if(null!=a.default[i])m(a.default[i].length);else{if(null==o.localFuncMap[i])throw s.createCompilerError(`Missing arity information for the function \`${i}()\``,e.callee.loc,t.rawSource);m(o.localFuncMap[i].args.length)}return[...p,...g]}case"ASSIGNMENT_EXPRESSION":{const{left:r}=e,a=u(e.right,t),o=function(e,t){const r={"+=":[n.op.f64_add],"-=":[n.op.f64_sub],"*=":[n.op.f64_mul],"/=":[n.op.f64_div],"%=":t.resolveFunc("mod"),"=":null}[e.operator];if(void 0===r)throw s.createCompilerError(`Unknown assignment operator "${e.operator}"`,e.loc,t.rawSource);return r}(e,t);if("IDENTIFIER"===r.type){const e=t.resolveVar(r.value),i=n.op.global_get(e),s=n.op.global_set(e);return null===o?[...a,...s,...i]:[...i,...a,...o,...s,...i]}if("CALL_EXPRESSION"!==r.type)throw s.createCompilerError(`Unexpected left hand side type for assignment: ${r.type}`,e.loc,t.rawSource);const l=t.resolveLocal(n.VAL_TYPE.i32);if(1!==r.arguments.length)throw s.createUserError(`Expected 1 argument when assinging to a buffer but got ${r.arguments.length}.`,0===r.arguments.length?r.loc:r.arguments[1].loc,t.rawSource);const c=r.callee.value;if("gmegabuf"!==c&&"megabuf"!==c)throw s.createUserError("The only function calls which may be assigned to are `gmegabuf()` and `megabuf()`.",r.callee.loc,t.rawSource);const h=d(c);if(null===o){const e=t.resolveLocal(n.VAL_TYPE.i32),s=t.resolveLocal(n.VAL_TYPE.f64);return[...a,...n.op.local_set(s),...u(r.arguments[0],t),...null!==(i=t.resolveFunc("_getBufferIndex"))&&void 0!==i?i:[],...n.op.local_tee(e),...n.op.i32_const(0),n.op.i32_lt_s,...n.op.if(n.BLOCK.f64),...n.op.f64_const(0),n.op.else,...n.op.local_get(e),...n.op.local_tee(l),...n.op.local_get(s),...n.op.f64_store(3,h),...n.op.local_get(s),n.op.end]}const m=t.resolveLocal(n.VAL_TYPE.i32),p=t.resolveLocal(n.VAL_TYPE.i32),g=t.resolveLocal(n.VAL_TYPE.f64),A=t.resolveLocal(n.VAL_TYPE.f64);return[...a,...n.op.local_set(g),...u(r.arguments[0],t),...null!==(f=t.resolveFunc("_getBufferIndex"))&&void 0!==f?f:[],...n.op.local_tee(m),...n.op.i32_const(-1),n.op.i32_ne,...n.op.local_tee(p),...n.op.if(n.BLOCK.f64),...n.op.local_get(m),...n.op.f64_load(3,h),n.op.else,...n.op.f64_const(0),n.op.end,...n.op.local_get(g),...o,...n.op.local_tee(A),...n.op.local_get(p),...n.op.if(n.BLOCK.void),...n.op.local_get(m),...n.op.local_get(A),...n.op.f64_store(3,h),n.op.end]}case"LOGICAL_EXPRESSION":{const r=u(e.left,t),i=u(e.right,t),a={"&&":{comparison:n.IS_ZEROISH,shortCircutValue:0},"||":{comparison:n.IS_NOT_ZEROISH,shortCircutValue:1}}[e.operator];if(null==a)throw s.createCompilerError(`Unknown logical expression operator ${e.operator}`,e.loc,t.rawSource);const{comparison:o,shortCircutValue:l}=a;return[...r,...o,...n.op.if(n.BLOCK.f64),...n.op.f64_const(l),n.op.else,...i,...n.IS_NOT_ZEROISH,n.op.f64_convert_i32_s,n.op.end]}case"UNARY_EXPRESSION":{const r=u(e.value,t),i={"-":[n.op.f64_neg],"+":[],"!":[...n.IS_ZEROISH,n.op.f64_convert_i32_s]}[e.operator];if(null==i)throw s.createCompilerError(`Unknown logical unary operator ${e.operator}`,e.loc,t.rawSource);return[...r,...i]}case"IDENTIFIER":const m=e.value;return n.op.global_get(t.resolveVar(m));case"NUMBER_LITERAL":return n.op.f64_const(e.value);default:throw s.createCompilerError(`Unknown AST node type ${e.type}`,e.loc,t.rawSource)}}function h(e,t){const r=e.map(((e,r)=>u(e,t)));return l.flatten(l.arrayJoin(r,[n.op.drop]))}function d(e){switch(e){case"gmegabuf":return 8*c.BUFFER_SIZE;case"megabuf":return 0}}t.emit=u},"./node_modules/eel-wasm/dist/src/encoding.js":function(e,t,r){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const n=i(r("./node_modules/eel-wasm/dist/src/ieee754.js")),a=r("./node_modules/eel-wasm/dist/src/utils.js");function s(e){const t=new Uint8Array(8);return n.write(t,e),t}function o(e){const t=[];do{let r=127&e;0!=(e>>>=7)&&(r|=128),t.push(r)}while(0!==e);return t}function l(e){let t=[],r=0,i=Math.ceil(Math.log2(Math.abs(e))),n=e<0,a=!0;for(;a;)r=127&e,e>>=7,n&&(e|=-(1<<i-7)),0==e&&0==(64&r)||-1==e&&64==(64&r)?a=!1:r|=128,t.push(r);return t}t.MAGIC=[0,97,115,109],t.WASM_VERSION=[1,0,0,0],t.EPSILON=1e-5,t.SECTION={TYPE:1,IMPORT:2,FUNC:3,MEMORY:5,GLOBAL:6,EXPORT:7,CODE:10},t.EXPORT_TYPE={FUNC:0,TABLE:1,MEMORY:2,GLOBAL:3},t.op={block:e=>[2,e],loop:e=>[3,e],if:e=>[4,e],else:5,end:11,br_if:e=>[13,...o(e)],call:e=>[16,...o(e)],drop:26,select:27,local_get:e=>[32,...o(e)],local_set:e=>[33,...o(e)],local_tee:e=>[34,...o(e)],global_get:e=>[35,...o(e)],global_set:e=>[36,...o(e)],f64_load:(e,t)=>[43,...o(e),...o(t)],f64_store:(e,t)=>[57,...o(e),...o(t)],i32_const:e=>[65,...l(e)],f64_const:e=>[68,...s(e)],i32_eqz:69,i32_ne:71,i32_lt_s:72,i32_lt_u:73,i32_gt_s:74,i32_le_s:76,i32_le_u:77,i32_ge_s:78,f64_eq:97,f64_ne:98,f64_lt:99,f64_gt:100,f64_le:101,f64_ge:102,i32_add:106,i32_sub:107,i32_mul:108,i32_rem_s:111,i32_and:113,i32_or:114,i64_rem_s:129,i64_and:131,i64_or:132,f64_abs:153,f64_neg:154,f64_ceil:155,f64_floor:156,f64_sqrt:159,f64_add:160,f64_sub:161,f64_mul:162,f64_div:163,f64_min:164,f64_max:165,i32_trunc_f64_s:170,i32_trunc_f64_u:171,i64_trunc_s_f64:176,f64_convert_i64_s:185,f64_convert_i32_s:183},t.VAL_TYPE={i32:127,i64:126,f32:125,f64:124},t.MUTABILITY={const:0,var:1},t.BLOCK={void:64,i32:127,i64:126,f32:125,f64:124},t.FUNCTION_TYPE=96,t.MEMORY_IDX=2,t.GLOBAL_TYPE=3,t.TYPE_IDX=0,t.IS_ZEROISH=[t.op.f64_abs,...t.op.f64_const(t.EPSILON),t.op.f64_lt],t.IS_NOT_ZEROISH=[t.op.f64_abs,...t.op.f64_const(t.EPSILON),t.op.f64_gt],t.encodef64=s,t.encodeString=e=>[e.length].concat(e.split("").map((e=>e.charCodeAt(0)))),t.unsignedLEB128=o,t.signedLEB128=l,t.encodeFlatVector=e=>o(e.length).concat(e),t.encodeNestedVector=e=>o(e.length).concat(a.flatten(e)),t.encodeSection=function(e,r){if(0===r.length)return[];const i=t.encodeFlatVector(t.encodeNestedVector(r));return i.unshift(e),i}},"./node_modules/eel-wasm/dist/src/envParser.js":function(e,t,r){let i=r("./node_modules/eel-wasm/dist/build/parser.js");e.exports={parse:i.parse}},"./node_modules/eel-wasm/dist/src/errorUtils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r("./node_modules/eel-wasm/dist/src/utils.js");function n(e,t,r=1){const n=Math.max(e.first_line-1-r,0),a=e.last_line+r,s=t.split("\n").slice(n,a).map(((t,r)=>{const i=r+n+1;return`${i>=e.first_line&&i<=e.last_line?">":" "} ${i} | ${t}`}));if(e.first_line===e.last_line){const t=i.repeat(e.first_column," "),r=i.repeat(e.last_column-e.first_column,"^"),a=e.first_line-n;s.splice(a,0,`    | ${t}${r}`)}return s.join("\n")}t.printLoc=n;class a extends Error{constructor(e,t,r){super(e),this.sourceContext=n(t,r),this.loc=t}}class s extends a{}t.createUserError=function(e,t,r){return new s(e,t,r)},t.createCompilerError=function(e,t,r){return new a(e,t,r)}},"./node_modules/eel-wasm/dist/src/ieee754.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.write=function(e,t){let r=52;var i,n,a,s=64-r-1,o=(1<<s)-1,l=o>>1,c=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,u=0,h=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(n=isNaN(t)?1:0,i=o):(i=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-i))<1&&(i--,a*=2),(t+=i+l>=1?c/a:c*Math.pow(2,1-l))*a>=2&&(i++,a/=2),i+l>=o?(n=0,i=o):i+l>=1?(n=(t*a-1)*Math.pow(2,r),i+=l):(n=t*Math.pow(2,l-1)*Math.pow(2,r),i=0));r>=8;e[0+u]=255&n,u+=1,n/=256,r-=8);for(i=i<<r|n,s+=r;s>0;e[0+u]=255&i,u+=1,i/=256,s-=8);e[0+u-1]|=128*h}},"./node_modules/eel-wasm/dist/src/index.js":function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r("./node_modules/eel-wasm/dist/src/parser.js");t.parse=n.parse;const a=r("./node_modules/eel-wasm/dist/src/compiler.js");t.compileModule=a.compileModule;const s=i(r("./node_modules/eel-wasm/dist/src/shims.js"));t.shims=s.default;const o=r("./node_modules/eel-wasm/dist/src/loader.js");t.loadModule=o.loadModule},"./node_modules/eel-wasm/dist/src/loader.js":function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(r("./node_modules/eel-wasm/dist/src/shims.js")),a=r("./node_modules/eel-wasm/dist/src/compiler.js");t.loadModule=async function({pools:e,functions:t,eelVersion:r=2}){let i={};Object.entries(e).forEach((([e,t])=>{i[e]=new Set(Object.keys(t))}));const s=a.compileModule({pools:i,functions:t,eelVersion:r}),o=await WebAssembly.compile(s);var l=Object.assign(Object.assign({},e),{shims:n.default});return await WebAssembly.instantiate(o,l)}},"./node_modules/eel-wasm/dist/src/parser.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r("./node_modules/eel-wasm/dist/src/preProcessor.js"),n=r("./node_modules/eel-wasm/dist/src/envParser.js"),a=r("./node_modules/eel-wasm/dist/src/astUtils.js"),s=r("./node_modules/eel-wasm/dist/src/errorUtils.js");function o(e,t){const r=i.getLoc(t,e.first_column),n=i.getLoc(t,e.last_column);return{first_column:r.column,last_column:n.column,first_line:r.line,last_line:n.line}}t.parse=function(e){const[t,r]=i.preProcess(e);try{const i=n.parse(t);return a.mapAst(i,(t=>{if(1!==t.loc.first_line||1!=t.loc.last_line)throw s.createCompilerError("Unexpected multiline",t.loc,e);return Object.assign(Object.assign({},t),{loc:o(t.loc,r)})}))}catch(t){if(null==t.hash)throw t;throw s.createUserError(`Parse Error: ${t.message.split("\n")[3]}`,o(t.hash.loc,r),e)}}},"./node_modules/eel-wasm/dist/src/preProcessor.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLoc=function(e,t){let r={destCol:1,srcCol:1,srcLine:1};e.forEach((e=>{e.destCol>t||(r=e)}));const i=t-r.destCol;return{column:r.srcCol+i,line:r.srcLine}},t.preProcess=function(e){const t=[];let r=1,i="",n=0,a=!1,s=!1,o=!1;for(let l=0;l<e.length;l++){const c=e[l];if(o){const e=i.length+1,a=l-n+1;t.push({destCol:e,srcCol:a,srcLine:r}),o=!1}"\n"===c?(a=!1,r++,n=l+1,o=!0):"\r"===c&&"\n"===e[l+1]?(l++,a=!1,r++,n=l+1,o=!0):s&&"*"===c&&"/"===e[l+1]?(s=!1,l++,o=!0):"\\"===c&&"\\"===e[l+1]||"/"===c&&"/"===e[l+1]?(a=!0,l++):"/"===c&&"*"===e[l+1]?(s=!0,l++):a||s||(i+=c)}return[i,t]}},"./node_modules/eel-wasm/dist/src/shims.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,atan2:Math.atan2,rand:e=>Math.random()*e,pow:Math.pow,log:Math.log,log10:Math.log10,exp:Math.exp,sigmoid:function(e,t){const r=1+Math.exp(-e*t);return Math.abs(r)>1e-5?1/r:0}};t.default=i},"./node_modules/eel-wasm/dist/src/utils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayJoin=function(e,t){const r=[];for(let i=0;i<e.length;i++)r.push(e[i]),i===e.length-1||r.push(t);return r},t.flatten=function(e){return[].concat.apply([],e)},t.times=function(e,t){return new Array(e).fill(null).map(((e,r)=>t(r)))},t.repeat=function(e,t){return new Array(e).fill(t).join("")},t.ScopedIdMap=class{constructor(){this._map=new Map}get(e,t){const r=null==e?t:`${e}::${t}`;return this._map.has(r)||this._map.set(r,this._map.size),this._map.get(r)}size(){return this._map.size}},t.formatList=function(e){if(0===e.length)throw new Error("Cannot format an empty list");if(1===e.length)return e[0];const t=e.map((e=>`"${e}"`)),r=t.pop();return t.join(", ")+` and ${r}`}},"./node_modules/eel-wasm/dist/src/wasmFunctions.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r("./node_modules/eel-wasm/dist/src/encoding.js"),n=r("./node_modules/eel-wasm/dist/src/constants.js");t.localFuncMap={sqr:{args:[i.VAL_TYPE.f64],returns:[i.VAL_TYPE.f64],binary:[...i.op.local_get(0),...i.op.local_get(0),i.op.f64_mul]},bor:{args:[i.VAL_TYPE.f64,i.VAL_TYPE.f64],returns:[i.VAL_TYPE.f64],binary:[...i.op.local_get(0),...i.IS_NOT_ZEROISH,...i.op.local_get(1),...i.IS_NOT_ZEROISH,i.op.i32_or,...i.op.i32_const(0),i.op.i32_ne,i.op.f64_convert_i32_s]},band:{args:[i.VAL_TYPE.f64,i.VAL_TYPE.f64],returns:[i.VAL_TYPE.f64],binary:[...i.op.local_get(0),...i.IS_NOT_ZEROISH,...i.op.local_get(1),...i.IS_NOT_ZEROISH,i.op.i32_and,...i.op.i32_const(0),i.op.i32_ne,i.op.f64_convert_i32_s]},sign:{args:[i.VAL_TYPE.f64],returns:[i.VAL_TYPE.f64],binary:[...i.op.f64_const(0),...i.op.local_get(0),i.op.f64_lt,...i.op.local_get(0),...i.op.f64_const(0),i.op.f64_lt,i.op.i32_sub,i.op.f64_convert_i32_s]},mod:{args:[i.VAL_TYPE.f64,i.VAL_TYPE.f64],returns:[i.VAL_TYPE.f64],localVariables:[i.VAL_TYPE.i32],binary:[...i.op.local_get(1),i.op.i32_trunc_f64_s,...i.op.local_tee(2),...i.op.i32_const(0),i.op.i32_ne,...i.op.if(i.BLOCK.f64),...i.op.local_get(0),i.op.i32_trunc_f64_s,...i.op.local_get(2),i.op.i32_rem_s,i.op.f64_convert_i32_s,i.op.else,...i.op.f64_const(0),i.op.end]},bitwiseOr:{args:[i.VAL_TYPE.f64,i.VAL_TYPE.f64],returns:[i.VAL_TYPE.f64],binary:[...i.op.local_get(0),i.op.i64_trunc_s_f64,...i.op.local_get(1),i.op.i64_trunc_s_f64,i.op.i64_or,i.op.f64_convert_i64_s]},bitwiseAnd:{args:[i.VAL_TYPE.f64,i.VAL_TYPE.f64],returns:[i.VAL_TYPE.f64],binary:[...i.op.local_get(0),i.op.i64_trunc_s_f64,...i.op.local_get(1),i.op.i64_trunc_s_f64,i.op.i64_and,i.op.f64_convert_i64_s]},div:{args:[i.VAL_TYPE.f64,i.VAL_TYPE.f64],returns:[i.VAL_TYPE.f64],localVariables:[i.VAL_TYPE.i32],binary:[...i.op.local_get(1),...i.op.f64_const(0),i.op.f64_ne,...i.op.if(i.BLOCK.f64),...i.op.local_get(0),...i.op.local_get(1),i.op.f64_div,i.op.else,...i.op.f64_const(0),i.op.end]},_getBufferIndex:{args:[i.VAL_TYPE.f64],returns:[i.VAL_TYPE.i32],localVariables:[i.VAL_TYPE.f64,i.VAL_TYPE.i32],binary:[...i.op.f64_const(i.EPSILON),...i.op.local_get(0),i.op.f64_add,...i.op.local_tee(1),i.op.i32_trunc_f64_s,...i.op.local_set(2),...i.op.i32_const(-1),...i.op.local_get(2),...i.op.i32_const(8),i.op.i32_mul,...i.op.local_get(2),...i.op.i32_const(0),i.op.i32_lt_s,...i.op.local_get(2),...i.op.i32_const(n.BUFFER_SIZE-1),i.op.i32_gt_s,i.op.i32_or,i.op.select]}}},"./node_modules/process/browser.js":function(e,t){var r,i,n=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&f())}function f(){if(!u){var e=o(d);u=!0;for(var t=c.length;t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new m(e,t)),1!==c.length||u||o(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},"./node_modules/webpack/buildin/module.js":function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},"./src/assemblyscript/presetFunctions.ts":function(e,t){e.exports=()=>"AGFzbQEAAAABPQpgAABgAXwBfGACfHwBfGACf38AYAR/f39/AGAJf39/f3x8fHx8AGADf399AGABfwF/YAJ/fwF/YAF+AX8CuBWMAQNlbnYFYWJvcnQABAhwaXhlbEVxcwtwZXJQaXhlbEVxcwAADHBpeGVsVmFyUG9vbAR3YXJwA3wBDHBpeGVsVmFyUG9vbAR6b29tA3wBDHBpeGVsVmFyUG9vbAd6b29tZXhwA3wBDHBpeGVsVmFyUG9vbAJjeAN8AQxwaXhlbFZhclBvb2wCY3kDfAEMcGl4ZWxWYXJQb29sAnN4A3wBDHBpeGVsVmFyUG9vbAJzeQN8AQxwaXhlbFZhclBvb2wCZHgDfAEMcGl4ZWxWYXJQb29sAmR5A3wBDHBpeGVsVmFyUG9vbANyb3QDfAEMcGl4ZWxWYXJQb29sA3JhZAN8AQxwaXhlbFZhclBvb2wDYW5nA3wBDHBpeGVsVmFyUG9vbAF4A3wBDHBpeGVsVmFyUG9vbAF5A3wBCHFWYXJQb29sAnExA3wBCHFWYXJQb29sAnEyA3wBCHFWYXJQb29sAnEzA3wBCHFWYXJQb29sAnE0A3wBCHFWYXJQb29sAnE1A3wBCHFWYXJQb29sAnE2A3wBCHFWYXJQb29sAnE3A3wBCHFWYXJQb29sAnE4A3wBCHFWYXJQb29sAnE5A3wBCHFWYXJQb29sA3ExMAN8AQhxVmFyUG9vbANxMTEDfAEIcVZhclBvb2wDcTEyA3wBCHFWYXJQb29sA3ExMwN8AQhxVmFyUG9vbANxMTQDfAEIcVZhclBvb2wDcTE1A3wBCHFWYXJQb29sA3ExNgN8AQhxVmFyUG9vbANxMTcDfAEIcVZhclBvb2wDcTE4A3wBCHFWYXJQb29sA3ExOQN8AQhxVmFyUG9vbANxMjADfAEIcVZhclBvb2wDcTIxA3wBCHFWYXJQb29sA3EyMgN8AQhxVmFyUG9vbANxMjMDfAEIcVZhclBvb2wDcTI0A3wBCHFWYXJQb29sA3EyNQN8AQhxVmFyUG9vbANxMjYDfAEIcVZhclBvb2wDcTI3A3wBCHFWYXJQb29sA3EyOAN8AQhxVmFyUG9vbANxMjkDfAEIcVZhclBvb2wDcTMwA3wBCHFWYXJQb29sA3EzMQN8AQhxVmFyUG9vbANxMzIDfAEIdFZhclBvb2wCdDEDfAEIdFZhclBvb2wCdDIDfAEIdFZhclBvb2wCdDMDfAEIdFZhclBvb2wCdDQDfAEIdFZhclBvb2wCdDUDfAEIdFZhclBvb2wCdDYDfAEIdFZhclBvb2wCdDcDfAEIdFZhclBvb2wCdDgDfAEKc2hhcGVQb29sMAN4XzADfAEKc2hhcGVQb29sMAN5XzADfAEKc2hhcGVQb29sMAVyYWRfMAN8AQpzaGFwZVBvb2wwBWFuZ18wA3wBCnNoYXBlUG9vbDADcl8wA3wBCnNoYXBlUG9vbDADZ18wA3wBCnNoYXBlUG9vbDADYl8wA3wBCnNoYXBlUG9vbDADYV8wA3wBCnNoYXBlUG9vbDAEcjJfMAN8AQpzaGFwZVBvb2wwBGcyXzADfAEKc2hhcGVQb29sMARiMl8wA3wBCnNoYXBlUG9vbDAEYTJfMAN8AQpzaGFwZVBvb2wwCmJvcmRlcl9yXzADfAEKc2hhcGVQb29sMApib3JkZXJfZ18wA3wBCnNoYXBlUG9vbDAKYm9yZGVyX2JfMAN8AQpzaGFwZVBvb2wwCmJvcmRlcl9hXzADfAEKc2hhcGVQb29sMA50aGlja291dGxpbmVfMAN8AQpzaGFwZVBvb2wwCnRleHR1cmVkXzADfAEKc2hhcGVQb29sMAp0ZXhfem9vbV8wA3wBCnNoYXBlUG9vbDAJdGV4X2FuZ18wA3wBCnNoYXBlUG9vbDAKYWRkaXRpdmVfMAN8AQpzaGFwZVBvb2wxA3hfMQN8AQpzaGFwZVBvb2wxA3lfMQN8AQpzaGFwZVBvb2wxBXJhZF8xA3wBCnNoYXBlUG9vbDEFYW5nXzEDfAEKc2hhcGVQb29sMQNyXzEDfAEKc2hhcGVQb29sMQNnXzEDfAEKc2hhcGVQb29sMQNiXzEDfAEKc2hhcGVQb29sMQNhXzEDfAEKc2hhcGVQb29sMQRyMl8xA3wBCnNoYXBlUG9vbDEEZzJfMQN8AQpzaGFwZVBvb2wxBGIyXzEDfAEKc2hhcGVQb29sMQRhMl8xA3wBCnNoYXBlUG9vbDEKYm9yZGVyX3JfMQN8AQpzaGFwZVBvb2wxCmJvcmRlcl9nXzEDfAEKc2hhcGVQb29sMQpib3JkZXJfYl8xA3wBCnNoYXBlUG9vbDEKYm9yZGVyX2FfMQN8AQpzaGFwZVBvb2wxDnRoaWNrb3V0bGluZV8xA3wBCnNoYXBlUG9vbDEKdGV4dHVyZWRfMQN8AQpzaGFwZVBvb2wxCnRleF96b29tXzEDfAEKc2hhcGVQb29sMQl0ZXhfYW5nXzEDfAEKc2hhcGVQb29sMQphZGRpdGl2ZV8xA3wBCnNoYXBlUG9vbDIDeF8yA3wBCnNoYXBlUG9vbDIDeV8yA3wBCnNoYXBlUG9vbDIFcmFkXzIDfAEKc2hhcGVQb29sMgVhbmdfMgN8AQpzaGFwZVBvb2wyA3JfMgN8AQpzaGFwZVBvb2wyA2dfMgN8AQpzaGFwZVBvb2wyA2JfMgN8AQpzaGFwZVBvb2wyA2FfMgN8AQpzaGFwZVBvb2wyBHIyXzIDfAEKc2hhcGVQb29sMgRnMl8yA3wBCnNoYXBlUG9vbDIEYjJfMgN8AQpzaGFwZVBvb2wyBGEyXzIDfAEKc2hhcGVQb29sMgpib3JkZXJfcl8yA3wBCnNoYXBlUG9vbDIKYm9yZGVyX2dfMgN8AQpzaGFwZVBvb2wyCmJvcmRlcl9iXzIDfAEKc2hhcGVQb29sMgpib3JkZXJfYV8yA3wBCnNoYXBlUG9vbDIOdGhpY2tvdXRsaW5lXzIDfAEKc2hhcGVQb29sMgp0ZXh0dXJlZF8yA3wBCnNoYXBlUG9vbDIKdGV4X3pvb21fMgN8AQpzaGFwZVBvb2wyCXRleF9hbmdfMgN8AQpzaGFwZVBvb2wyCmFkZGl0aXZlXzIDfAEKc2hhcGVQb29sMwN4XzMDfAEKc2hhcGVQb29sMwN5XzMDfAEKc2hhcGVQb29sMwVyYWRfMwN8AQpzaGFwZVBvb2wzBWFuZ18zA3wBCnNoYXBlUG9vbDMDcl8zA3wBCnNoYXBlUG9vbDMDZ18zA3wBCnNoYXBlUG9vbDMDYl8zA3wBCnNoYXBlUG9vbDMDYV8zA3wBCnNoYXBlUG9vbDMEcjJfMwN8AQpzaGFwZVBvb2wzBGcyXzMDfAEKc2hhcGVQb29sMwRiMl8zA3wBCnNoYXBlUG9vbDMEYTJfMwN8AQpzaGFwZVBvb2wzCmJvcmRlcl9yXzMDfAEKc2hhcGVQb29sMwpib3JkZXJfZ18zA3wBCnNoYXBlUG9vbDMKYm9yZGVyX2JfMwN8AQpzaGFwZVBvb2wzCmJvcmRlcl9hXzMDfAEKc2hhcGVQb29sMw50aGlja291dGxpbmVfMwN8AQpzaGFwZVBvb2wzCnRleHR1cmVkXzMDfAEKc2hhcGVQb29sMwp0ZXhfem9vbV8zA3wBCnNoYXBlUG9vbDMJdGV4X2FuZ18zA3wBCnNoYXBlUG9vbDMKYWRkaXRpdmVfMwN8AQMZGAgDBwkBAQICAQYFAAAAAAAAAAAAAAAAAAUDAQABBuwMigF8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt/AUEAC3wBRAAAAAAAAAAAC3wBRAAAAAAAAAAAC34BQgALB9kBDwZtZW1vcnkCABJjcmVhdGVGbG9hdDMyQXJyYXkABBFydW5QaXhlbEVxdWF0aW9ucwAMBnNhdmVRcwANCXJlc3RvcmVRcwAOBnNhdmVUcwAPCXJlc3RvcmVUcwAQC3NoYXBlMF9zYXZlABEOc2hhcGUwX3Jlc3RvcmUAEgtzaGFwZTFfc2F2ZQATDnNoYXBlMV9yZXN0b3JlABQLc2hhcGUyX3NhdmUAFQ5zaGFwZTJfcmVzdG9yZQAWC3NoYXBlM19zYXZlABcOc2hhcGUzX3Jlc3RvcmUAGAgBGQraQRi0AQEGfyAAQez///8DSwRAAAsgAEEQaiICQfz///8DSwRAAAsjkAIhBiOQAkEEaiIEIAJBE2pBcHFBBGsiB2oiAj8AIgVBEHRBD2pBcHEiA0sEQCAFIAIgA2tB//8DakGAgHxxQRB2IgMgAyAFSBtAAEEASARAIANAAEEASARAAAsLCyACJJACIAYgBzYCACAEQQRrIgJBADYCBCACQQA2AgggAiABNgIMIAIgADYCECAEQRBqC7sCAQF/AkAgAUUNACAAQQA6AAAgACABakEEayICQQA6AAMgAUECTQ0AIABBADoAASAAQQA6AAIgAkEAOgACIAJBADoAASABQQZNDQAgAEEAOgADIAJBADoAACABQQhNDQAgAEEAIABrQQNxIgJqIgBBADYCACAAIAEgAmtBfHEiAmpBHGsiAUEANgIYIAJBCE0NACAAQQA2AgQgAEEANgIIIAFBADYCECABQQA2AhQgAkEYTQ0AIABBADYCDCAAQQA2AhAgAEEANgIUIABBADYCGCABQQA2AgAgAUEANgIEIAFBADYCCCABQQA2AgwgACAAQQRxQRhqIgFqIQAgAiABayEBA0AgAUEgTwRAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCABQSBrIQEgAEEgaiEADAELCwsLdwECfwJ/QQxBAxACIgFFBEBBDEECEAIhAQsgAQtBADYCACABQQA2AgQgAUEANgIIIABB/////wBLBEBBoAhB0AhBEkE5EAAACyAAQQJ0IgBBABACIgIgABADIAEoAgAaIAEgAjYCACABIAI2AgQgASAANgIIIAELuwQDAX8KfgF8IABC////////////AINCNIhClQh9IgVCBoenQQN0QYAJaiIBKQMAIQcgASkDCCEEIAEpAxAhAiAFQj+DIgVCAFIEQAJ+IAcgBYYgBELAACAFfSIDiIQhByAEIAWGIAIgA4iEIQQgAiAFhiABKQMYIAOIhAshAgsgAEL/////////B4NCgICAgICAgAiEIgVC/////w+DIgMgBEIgiCIIfiAEQv////8PgyIGIAN+IglCIIh8IQQgBiAFQiCIIgZ+IARC/////w+DfCEDIAYgCH4gBEIgiHwgA0IgiHwkkwIgBUIghyACQiCIfiIEIAlC/////w+DIANCIIZ8fCECIAIgBFStI5MCIAUgB358fCIIQgKGIAJCPoiEIgdCP4ciBUIBhyAHhSIDeSEEIAMgBIYgBSACQgKGhSIGQsAAIAR9iIQiAkL/////D4MhAyACQiCIIglCtISjiwJ+IANCorW/yAx+IANCtISjiwJ+IgpCIIh8IgtC/////w+DfCEDIAlCorW/yAx+IAtCIIh8IANCIIh8JJMCIApC/////w+DIANCIIZ8IgMgArpEhBtwUcyYOD+iIAYgBIa6RBgtRFT7ITk/oqCxIgJUrSOTAiIGQguIfLokkQIgAiAGQjWGIANCC4iEfLpEAAAAAAAA8DuiJJICI5ECQoCAgICAgIDYPCAEQjSGfSAAIAeFQoCAgICAgICAgH+DhL8iDKIkkQIjkgIgDKIkkgIgCEI+hyAFfacLlQYDAn8BfgR8IAC9IgNCIIinIgFBH3YhAiABQf////8HcSIBQfvDpP8DTQRAIAFBnsGa8gNJBEBEAAAAAAAA8D8PC0QAAAAAAADwPyAAIACiIgVEAAAAAAAA4D+iIgahIgREAAAAAAAA8D8gBKEgBqEgBSAFIAUgBUSQFcsZoAH6PqJEd1HBFmzBVr+gokRMVVVVVVWlP6CiIAUgBaIiBiAGoiAFIAVE1DiIvun6qL2iRMSxtL2e7iE+oKJErVKcgE9+kr6goqCiIABEAAAAAAAAAACioaCgDwsgAUGAgMD/B08EQCAAIAChDwsCfyADQiCIp0H/////B3EiAUH7w+SJBEkEQAJ8IAFBFHYiAiAAIABEg8jJbTBf5D+iniIFRAAAQFT7Ifk/oqEiACAFRDFjYhphtNA9oiIGoSIEvUIgiKdBFHZB/w9xa0EQSwRAAnwgBURzcAMuihmjO6IgACAAIAVEAABgGmG00D2iIgahIgChIAahoSEGIAIgACAGoSIEvUIgiKdBFHZB/w9xa0ExSwR8IAVEwUkgJZqDezmiIAAgACAFRAAAAC6KGaM7oiIGoSIAoSAGoaEhBiAAIAahBSAECwshBAsgBAskkQIgACAEoSAGoSSSAiAFqgwBC0EAIAMQBSIBayABIAIbCyECI5ECIQUjkgIhBiACQQFxBHwgBSAFoiIAIAWiIQQgBSAAIAZEAAAAAAAA4D+iIAQgACAARH3+sVfjHcc+okTVYcEZoAEqv6CiRKb4EBEREYE/oCAAIAAgAKKiIABEfNXPWjrZ5T2iROucK4rm5Vq+oKKgoqGiIAahIARESVVVVVVVxb+ioaEFRAAAAAAAAPA/IAUgBaIiAEQAAAAAAADgP6IiBKEiB0QAAAAAAADwPyAHoSAEoSAAIAAgACAARJAVyxmgAfo+okR3UcEWbMFWv6CiRExVVVVVVaU/oKIgACAAoiIEIASiIAAgAETUOIi+6fqovaJExLG0vZ7uIT6gokStUpyAT36SvqCioKIgBSAGoqGgoAsiAJogACACQQFqQQJxGwu8BAICfwN8IAAhAyAAvUIgiKdB/////wdxIgFBgIDAoARPBEAgACAAYgRAIAAPC0QYLURU+yH5PyADpg8LIAFBgIDw/gNJBEAgAUGAgIDyA0kEQCAADwtBfyECBSAAmSEAIAFBgIDM/wNJBHwgAUGAgJj/A0kEfCAAIACgRAAAAAAAAPA/oSAARAAAAAAAAABAoKMFQQEhAiAARAAAAAAAAPA/oSAARAAAAAAAAPA/oKMLBSABQYCAjoAESQR8QQIhAiAARAAAAAAAAPg/oSAARAAAAAAAAPg/okQAAAAAAADwP6CjBUEDIQJEAAAAAAAA8L8gAKMLCyEACyAAIACiIgUgBaIhBCAAIAUgBCAEIAQgBCAERBHaIuM6rZA/okTrDXYkS3upP6CiRFE90KBmDbE/oKJEbiBMxc1Ftz+gokT/gwCSJEnCP6CiRA1VVVVVVdU/oKIgBCAEIAQgBCAERC9saixEtKK/okSa/d5SLd6tv6CiRG2adK/ysLO/oKJEcRYj/sZxvL+gokTE65iZmZnJv6CioKIhBCACQQBIBEAgACAEoQ8LAkACQAJAAkACQAJAIAIOBAABAgMEC0RPu2EFZ6zdPyAEROJlLyJ/K3o8oSAAoaEhAAwEC0QYLURU+yHpPyAERAdcFDMmpoE8oSAAoaEhAAwDC0Sb9oHSC3PvPyAERL3L8HqIB3A8oSAAoaEhAAwCC0QYLURU+yH5PyAERAdcFDMmppE8oSAAoaEhAAwBCwALIAAgA6YLvgMCBX8BfkEBIAAgAGIgASABYhsEQCABIACgDwsgAL0iB0IgiKchBCAHpyEDIAG9IgenIgYgB0IgiKciBUGAgMD/A2tyRQRAIAAQBw8LIAVBHnZBAnEgBEEfdnIhAiAFQf////8HcSEFIARB/////wdxIgQgA3JFBEACQAJAAkACQCACRQ0AAkAgAkEBaw4DAQIDAAsMAwsgAA8LRBgtRFT7IQlADwtEGC1EVPshCcAPCwsCQCAFIAZyRQ0AIAVBgIDA/wdGBEBE0iEzf3zZAkBEGC1EVPsh6T8gAkECcRtEGC1EVPshCUBEAAAAAAAAAAAgAkECcRsgBEGAgMD/B0YbIgCaIAAgAkEBcRsPC0EBIARBgIDA/wdGIAQgBUGAgIAgaksbDQAgBSAEQYCAgCBqS0EAIAJBAnEbBHxEAAAAAAAAAAAFIAAgAaOZEAcLIQACQAJAAkACQCACIgMEQCADQQFrDgMBAgMECyAADwsgAJoPC0QYLURU+yEJQCAARAdcFDMmpqE8oaEPCyAARAdcFDMmpqE8oUQYLURU+yEJQKEPCwALRBgtRFT7Ifm/RBgtRFT7Ifk/IAJBAXEbC4ESAwl/AX4IfAJAAkACQAJAIAGZRAAAAAAAAABAZQRAIAFEAAAAAAAAAEBhDQEgAUQAAAAAAADgP2EEQCAAn5lEAAAAAAAA8H8gAEQAAAAAAADw/2IbDwsgAUQAAAAAAADwv2ENAiABRAAAAAAAAPA/YQRAIAAPCyABRAAAAAAAAAAAYQRARAAAAAAAAPA/DwsLIAC9IgunIQcgC0IgiKciBkH/////B3EhBCABvSILQiCIpyIDQf////8HcSIFIAunIghyRQRARAAAAAAAAPA/DwtBASAIQQAgBUGAgMD/B0YbQQEgBUGAgMD/B0tBASAHQQAgBEGAgMD/B0YbIARBgIDA/wdKGxsbBEAgACABoA8LIAZBAEgEfyAFQYCAgJoETwR/QQIFIAVBgIDA/wNPBH9BAiAIIAUgBUEUdkH/B2siAkEUSiIJGyIKQTRBFCAJGyACayICdiIJQQFxa0EAIAogCSACdEYbBUEACwsFQQALIQIgCEUEQCAFQYCAwP8HRgRAIAcgBEGAgMD/A2tyBEAgBEGAgMD/A04EQCABRAAAAAAAAAAAIANBAE4bDwVEAAAAAAAAAAAgAZogA0EAThsPCwAFRAAAAAAAAPh/DwsACyAFQYCAwP8DRgRAIANBAE4EQCAADwsMAwsgA0GAgICABEYNASADQYCAgP8DRgRAIAZBAE4EQCAAnw8LCwsgAJkhDCAHRQRAQQEgBEGAgMD/A0YgBEGAgMD/B0ZBASAEGxsEQEQAAAAAAADwPyAMoyAMIANBAEgbIQAgBkEASAR8IAIgBEGAgMD/A2tyBHwgAJogACACQQFGGwUgACAAoSIAIACjCwUgAAsPCwsgBkEASAR8IAJFBEAgACAAoSIAIACjDwtEAAAAAAAA8L9EAAAAAAAA8D8gAkEBRhsFRAAAAAAAAPA/CyEOIAVBgICAjwRLBHwgBUGAgMCfBEsEQCAEQf//v/8DTARARAAAAAAAAPB/RAAAAAAAAAAAIANBAEgbDwsgBEGAgMD/A04EQEQAAAAAAADwf0QAAAAAAAAAACADQQBKGw8LCyAEQf//v/8DSARAIA5EnHUAiDzkN36iRJx1AIg85Dd+oiAORFnz+MIfbqUBokRZ8/jCH26lAaIgA0EASBsPCyAEQYCAwP8DSgRAIA5EnHUAiDzkN36iRJx1AIg85Dd+oiAORFnz+MIfbqUBokRZ8/jCH26lAaIgA0EAShsPCyAMRAAAAAAAAPA/oSIARAAAAGBHFfc/oiIMIABERN9d+AuuVD6iIAAgAKJEAAAAAAAA4D8gAERVVVVVVVXVPyAARAAAAAAAANA/oqGioaJE/oIrZUcV9z+ioSINoL1CgICAgHCDvyEAIA0gACAMoaEFIARBgIDAAEgEfyAMRAAAAAAAAEBDoiIMvUIgiKchBEFLBUEACyAEQRR1Qf8Ha2ohAyAEQf//P3EiAkGAgMD/A3IhBCACQY6xDkwEf0EABSACQfrsLkgEf0EBBSADQQFqIQMgBEGAgEBqIQRBAAsLIQIgDL1C/////w+DIASsQiCGhL8iD0QAAAAAAAD4P0QAAAAAAADwPyACGyIQoSISRAAAAAAAAPA/IA8gEKCjIhOiIg29QoCAgIBwg78iDCAMoiERIAwgEUQAAAAAAAAIQKAgDSANoiIAIACiIAAgACAAIAAgAETvTkVKKH7KP6JEZdvJk0qGzT+gokQBQR2pYHTRP6CiRE0mj1FVVdU/oKJE/6tv27Zt2z+gokQDMzMzMzPjP6CiIBMgEiAMIARBAXVBgICAgAJyQYCAIGogAkESdGqsQiCGvyIAoqEgDCAPIAAgEKGhoqGiIg8gDCANoKKgIgygvUKAgICAcIO/IgCiIhAgDyAAoiAMIABEAAAAAAAACEChIBGhoSANoqAiDKC9QoCAgIBwg78iAEQAAADgCcfuP6IiDSAARPUBWxTgLz6+oiAMIAAgEKGhRP0DOtwJx+4/oqBEBtDPQ+v9TD5EAAAAAAAAAAAgAhugIgygRAAAAEADuOI/RAAAAAAAAAAAIAIbIg+gIAO3IhCgvUKAgICAcIO/IQAgDCAAIBChIA+hIA2hoQshDCABIAG9QoCAgIBwg78iDaEgAKIgASAMoqAiASANIACiIgCgIgy9IgunIQMgC0IgiKciAkGAgMCEBE4EQCADIAJBgIDAhARrciABRP6CK2VHFZc8oCAMIAChZHINAwUgAkH/////B3FBgJjDhARPQQAgAyACQYCYw4R8a3IgASAMIAChZXIbDQQLIAJB/////wdxIgRBFHZB/wdrIQVBACEDIAECfCAEQYCAgP8DSgRAAnwgAkGAgMAAIAVBAWp1aiIEQf////8HcUEUdkH/B2shBUEAIARB//8/cUGAgMAAckEUIAVrdSIDayADIAJBAEgbIQMgACAEQf//PyAFdUF/c3GsQiCGv6ELIQALIAALoL1CgICAgHCDvyIMRAAAAABDLuY/oiINIAEgDCAAoaFE7zn6/kIu5j+iIAxEOWyoDGFcIL6ioCIMoCIAIACiIQEgDkQAAAAAAADwPyAAIAAgASABIAEgASABRNCkvnJpN2Y+okTxa9LFQb27vqCiRCzeJa9qVhE/oKJEk72+FmzBZr+gokQ+VVVVVVXFP6CioSIBoiABRAAAAAAAAABAoaMgDCAAIA2hoSIBIAAgAaKgoSAAoaEiAL1CIIinIANBFHRqIgJBFHVBAEwEfCADIgJB/wdKBHwgAEQAAAAAAADgf6IhACACQf8HayICQf8HSgR8IAJB/wdrIgJB/wcgAkH/B0gbIQIgAEQAAAAAAADgf6IFIAALBSACQYJ4SAR8IABEAAAAAAAAYAOiIQAgAkHJB2oiAkGCeEgEfCACQckHaiICQYJ4IAJBgnhKGyECIABEAAAAAAAAYAOiBSAACwUgAAsLIAKsQv8HfEI0hr+iBSAAvUL/////D4MgAqxCIIaEvwuiDwsgACAAog8LRAAAAAAAAPA/IACjDwsgDkScdQCIPOQ3fqJEnHUAiDzkN36iDwsgDkRZ8/jCH26lAaJEWfP4wh9upQGiC9QFAwJ/AX4EfCAAvSIDQiCIpyIBQR92IQIgAUH/////B3EiAUH7w6T/A00EQCABQYCAwPIDSQRAIAAPCyAAIAAgAKIiBSAAoiAFIAUgBUR9/rFX4x3HPqJE1WHBGaABKr+gokSm+BARERGBP6AgBSAFIAWioiAFRHzVz1o62eU9okTrnCuK5uVavqCioKJESVVVVVVVxb+goqAPCyABQYCAwP8HTwRAIAAgAKEPCwJ/IANCIIinQf////8HcSIBQfvD5IkESQRAAnwgAUEUdiICIAAgAESDyMltMF/kP6KeIgVEAABAVPsh+T+ioSIAIAVEMWNiGmG00D2iIgahIgS9QiCIp0EUdkH/D3FrQRBLBEACfCAFRHNwAy6KGaM7oiAAIAAgBUQAAGAaYbTQPaIiBqEiAKEgBqGhIQYgAiAAIAahIgS9QiCIp0EUdkH/D3FrQTFLBHwgBUTBSSAlmoN7OaIgACAAIAVEAAAALooZozuiIgahIgChIAahoSEGIAAgBqEFIAQLCyEECyAECySRAiAAIAShIAahJJICIAWqDAELQQAgAxAFIgFrIAEgAhsLIQIjkQIhBSOSAiEGIAJBAXEEfEQAAAAAAADwPyAFIAWiIgBEAAAAAAAA4D+iIgShIgdEAAAAAAAA8D8gB6EgBKEgACAAIAAgAESQFcsZoAH6PqJEd1HBFmzBVr+gokRMVVVVVVWlP6CiIAAgAKIiBCAEoiAAIABE1DiIvun6qL2iRMSxtL2e7iE+oKJErVKcgE9+kr6goqCiIAUgBqKhoKAFIAUgBaIiACAFoiEEIAUgACAGRAAAAAAAAOA/oiAEIAAgAER9/rFX4x3HPqJE1WHBGaABKr+gokSm+BARERGBP6AgACAAIACioiAARHzVz1o62eU9okTrnCuK5uVavqCioKKhoiAGoSAERElVVVVVVcW/oqGhCyIAmiAAIAJBAnEbCxIAIAAoAgQgAUECdGogAjgCAAuTCAIFfwl8IAJBAWohDCADQQFqIQ1EAAAAAAAA8D8gBqMhECAEIAWiIgVEz/dT46Wb9j+iRAAAAAAAACRAoBAGRAAAAAAAABBAokRcj8L1KFwnQKAhFCAFRAIrhxbZzvE/okQAAAAAAAAcQKAQBkQAAAAAAAAIQKJECtejcD2KIUCgIRIgBUTufD81XrrzP6JEAAAAAAAACECgEAZEAAAAAAAACECiRBSuR+F6FCVAoCETIAVEQmDl0CLb7T+iRAAAAAAAABRAoBAGRAAAAAAAABBAokR7FK5H4fomQKAhFSMAJIoBIwEkiwEjAiSMASMDJI0BIwQkjgEjBSSPASMGJJABIwckkQEjCCSSASMJJJMBA0AgCiANSARAQQAhCQNAIAkgDEgEQCAJtyACt6MiBCAEoEQAAAAAAADwP6EiBiAGoiAHoiAHoiAKtyADt6MiBCAEoEQAAAAAAADwP6EiDyAPoiAIoiAIoqCfJAogAQRAIAm3IAK3RAAAAAAAAOA/omFBACAKtyADt0QAAAAAAADgP6JhGwRARAAAAAAAAAAAJAsFIA8gCKIgBiAHohAIIgREAAAAAAAAAABjBHwgBEQYLURU+yEZQKAFIAQLJAsLIAZEAAAAAAAA4D+iIAeiRAAAAAAAAOA/oCQMIA9EAAAAAAAA4L+iIAiiRAAAAAAAAOA/oCQNI4oBJAAjiwEkASOMASQCI40BJAMjjgEkBCOPASQFI5ABJAYjkQEkByOSASQII5MBJAkQAQsgBkQAAAAAAADgP6IgB6JEAAAAAAAA8D8jASMCIwoiBCAEoEQAAAAAAADwP6EQCRAJoyIOokQAAAAAAADgP6AjA6EjBaMjA6AhBCAPRAAAAAAAAOC/oiAIoiAOokQAAAAAAADgP6AjBKEjBqMjBKAhDiMARAAAAAAAAAAAYgRAAnwgBCMARHnpJjEIrGw/oiAFRB1aZDvfT9U/oiAQIAYgFKIiESAPIBWiIhahoqAQCqKgIQQgDiMARHnpJjEIrGw/oiAFRAAAAAAAANg/oiAQIAYgE6IgDyASoqCioRAGoqAhDiAEIwBEeekmMQisbD+iIAVEf2q8dJMY6D+iIBAgBiASoiAPIBOioaKhEAaioCEEIA4jAER56SYxCKxsP6IgBURmZmZmZmbqP6IgECARIBagoqAQCqKgCyEOCyAEIwOhIQQgDiMEoSEGIwkQBiEPIAQjCRAKIg6iIAYgD6KgIwSgIwihRAAAAAAAAOA/oSAIo0QAAAAAAADgP6AhESAAIAsgBCAPoiAGIA6ioSMDoCMHoUQAAAAAAADgP6EgB6NEAAAAAAAA4D+gthALIAAgC0EBaiARthALIAtBAmohCyAJQQFqIQkMAQsLIApBAWohCgwBCwsLogEAIw4klAEjDySVASMQJJYBIxEklwEjEiSYASMTJJkBIxQkmgEjFSSbASMWJJwBIxcknQEjGCSeASMZJJ8BIxokoAEjGyShASMcJKIBIx0kowEjHiSkASMfJKUBIyAkpgEjISSnASMiJKgBIyMkqQEjJCSqASMlJKsBIyYkrAEjJyStASMoJK4BIykkrwEjKiSwASMrJLEBIywksgEjLSSzAQuiAQAjlAEkDiOVASQPI5YBJBAjlwEkESOYASQSI5kBJBMjmgEkFCObASQVI5wBJBYjnQEkFyOeASQYI58BJBkjoAEkGiOhASQbI6IBJBwjowEkHSOkASQeI6UBJB8jpgEkICOnASQhI6gBJCIjqQEkIyOqASQkI6sBJCUjrAEkJiOtASQnI64BJCgjrwEkKSOwASQqI7EBJCsjsgEkLCOzASQtCyoAIy4ktAEjLyS1ASMwJLYBIzEktwEjMiS4ASMzJLkBIzQkugEjNSS7AQsqACO0ASQuI7UBJC8jtgEkMCO3ASQxI7gBJDIjuQEkMyO6ASQ0I7sBJDULawAjNiS8ASM3JL0BIzgkvgEjOSS/ASM6JMABIzskwQEjPCTCASM9JMMBIz4kxAEjPyTFASNAJMYBI0EkxwEjQiTIASNDJMkBI0QkygEjRSTLASNGJMwBI0ckzQEjSCTOASNJJM8BI0ok0AELawAjvAEkNiO9ASQ3I74BJDgjvwEkOSPAASQ6I8EBJDsjwgEkPCPDASQ9I8QBJD4jxQEkPyPGASRAI8cBJEEjyAEkQiPJASRDI8oBJEQjywEkRSPMASRGI80BJEcjzgEkSCPPASRJI9ABJEoLawAjSyTRASNMJNIBI00k0wEjTiTUASNPJNUBI1Ak1gEjUSTXASNSJNgBI1Mk2QEjVCTaASNVJNsBI1Yk3AEjVyTdASNYJN4BI1kk3wEjWiTgASNbJOEBI1wk4gEjXSTjASNeJOQBI18k5QELawAj0QEkSyPSASRMI9MBJE0j1AEkTiPVASRPI9YBJFAj1wEkUSPYASRSI9kBJFMj2gEkVCPbASRVI9wBJFYj3QEkVyPeASRYI98BJFkj4AEkWiPhASRbI+IBJFwj4wEkXSPkASReI+UBJF8LawAjYCTmASNhJOcBI2Ik6AEjYyTpASNkJOoBI2Uk6wEjZiTsASNnJO0BI2gk7gEjaSTvASNqJPABI2sk8QEjbCTyASNtJPMBI24k9AEjbyT1ASNwJPYBI3Ek9wEjciT4ASNzJPkBI3Qk+gELawAj5gEkYCPnASRhI+gBJGIj6QEkYyPqASRkI+sBJGUj7AEkZiPtASRnI+4BJGgj7wEkaSPwASRqI/EBJGsj8gEkbCPzASRtI/QBJG4j9QEkbyP2ASRwI/cBJHEj+AEkciP5ASRzI/oBJHQLdQAjdST7ASN2JPwBI3ck/QEjeCT+ASN5JP8BI3okgAIjeySBAiN8JIICI30kgwIjfiSEAiN/JIUCI4ABJIYCI4EBJIcCI4IBJIgCI4MBJIkCI4QBJIoCI4UBJIsCI4YBJIwCI4cBJI0CI4gBJI4CI4kBJI8CC3UAI/sBJHUj/AEkdiP9ASR3I/4BJHgj/wEkeSOAAiR6I4ECJHsjggIkfCODAiR9I4QCJH4jhQIkfyOGAiSAASOHAiSBASOIAiSCASOJAiSDASOKAiSEASOLAiSFASOMAiSGASONAiSHASOOAiSIASOPAiSJAQsIAEHMCiSQAgsLvAIDAEGMCAsvLAAAAAEAAAAAAAAAAQAAABwAAABJAG4AdgBhAGwAaQBkACAAbABlAG4AZwB0AGgAQbwICzk8AAAAAQAAAAAAAAABAAAAJgAAAH4AbABpAGIALwBhAHIAcgBhAHkAYgB1AGYAZgBlAHIALgB0AHMAQYAJC8ABboP5ogAAAADRVyf8KRVETpmVYtvA3TT1q2NR/kGQQzw6biS3YcW73uouSQbg0k1CHOsd/hyS0Qn1NYLoPqcpsSZwnOmERLsuOdaROUF+X7SLX4Sc9DlTg/+X+B87KPm9ixEv7w+YBd7PfjZtH20KWmY/Rk+3Ccsnx7ondS3qX573OQc9e/Hl67Ff+2vqklKKRjADVghdjR8gvM/wq2t7/GGR46kdNvSaX4WZZQgb5l6A2P+NQGigFFcVBgYxJ3NN"},"./src/audio/audioLevels.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));class i{constructor(e){let t;this.audio=e,t=this.audio.audioContext?this.audio.audioContext.sampleRate:44100;const r=t/this.audio.fftSize,i=Math.clamp(Math.round(20/r)-1,0,this.audio.numSamps-1),n=Math.clamp(Math.round(320/r)-1,0,this.audio.numSamps-1),a=Math.clamp(Math.round(2800/r)-1,0,this.audio.numSamps-1),s=Math.clamp(Math.round(11025/r)-1,0,this.audio.numSamps-1);this.starts=[i,n,a],this.stops=[n,a,s],this.val=new Float32Array(3),this.imm=new Float32Array(3),this.att=new Float32Array(3),this.avg=new Float32Array(3),this.longAvg=new Float32Array(3),this.att.fill(1),this.avg.fill(1),this.longAvg.fill(1)}get bass(){return this.val[0]}get bass_att(){return this.att[0]}get mid(){return this.val[1]}get mid_att(){return this.att[1]}get treb(){return this.val[2]}get treb_att(){return this.att[2]}static isFiniteNumber(e){return Number.isFinite(e)&&!Number.isNaN(e)}static adjustRateToFPS(e,t,r){return e**(t/r)}updateAudioLevels(e,t){if(this.audio.freqArray.length>0){let r=e;!i.isFiniteNumber(r)||r<15?r=15:r>144&&(r=144),this.imm.fill(0);for(let e=0;e<3;e++)for(let t=this.starts[e];t<this.stops[e];t++)this.imm[e]+=this.audio.freqArray[t];for(let e=0;e<3;e++){let n;n=this.imm[e]>this.avg[e]?.2:.5,n=i.adjustRateToFPS(n,30,r),this.avg[e]=this.avg[e]*n+this.imm[e]*(1-n),n=t<50?.9:.992,n=i.adjustRateToFPS(n,30,r),this.longAvg[e]=this.longAvg[e]*n+this.imm[e]*(1-n),this.longAvg[e]<.001?(this.val[e]=1,this.att[e]=1):(this.val[e]=this.imm[e]/this.longAvg[e],this.att[e]=this.avg[e]/this.longAvg[e])}}}}},"./src/audio/audioProcessor.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/audio/fft.js");class n{constructor(e){this.numSamps=512,this.fftSize=2*this.numSamps,this.fft=new i.default(this.fftSize,512,!0),e&&(this.audioContext=e,this.audible=e.createDelay(),this.analyser=e.createAnalyser(),this.analyser.smoothingTimeConstant=0,this.analyser.fftSize=this.fftSize,this.audible.connect(this.analyser),this.analyserL=e.createAnalyser(),this.analyserL.smoothingTimeConstant=0,this.analyserL.fftSize=this.fftSize,this.analyserR=e.createAnalyser(),this.analyserR.smoothingTimeConstant=0,this.analyserR.fftSize=this.fftSize,this.splitter=e.createChannelSplitter(2),this.audible.connect(this.splitter),this.splitter.connect(this.analyserL,0),this.splitter.connect(this.analyserR,1)),this.timeByteArray=new Uint8Array(this.fftSize),this.timeByteArrayL=new Uint8Array(this.fftSize),this.timeByteArrayR=new Uint8Array(this.fftSize),this.timeArray=new Int8Array(this.fftSize),this.timeByteArraySignedL=new Int8Array(this.fftSize),this.timeByteArraySignedR=new Int8Array(this.fftSize),this.tempTimeArrayL=new Int8Array(this.fftSize),this.tempTimeArrayR=new Int8Array(this.fftSize),this.timeArrayL=new Int8Array(this.numSamps),this.timeArrayR=new Int8Array(this.numSamps)}sampleAudio(){this.analyser.getByteTimeDomainData(this.timeByteArray),this.analyserL.getByteTimeDomainData(this.timeByteArrayL),this.analyserR.getByteTimeDomainData(this.timeByteArrayR),this.processAudio()}updateAudio(e,t,r){this.timeByteArray.set(e),this.timeByteArrayL.set(t),this.timeByteArrayR.set(r),this.processAudio()}processAudio(){for(let e=0,t=0,r=0;e<this.fftSize;e++)this.timeArray[e]=this.timeByteArray[e]-128,this.timeByteArraySignedL[e]=this.timeByteArrayL[e]-128,this.timeByteArraySignedR[e]=this.timeByteArrayR[e]-128,this.tempTimeArrayL[e]=.5*(this.timeByteArraySignedL[e]+this.timeByteArraySignedL[r]),this.tempTimeArrayR[e]=.5*(this.timeByteArraySignedR[e]+this.timeByteArraySignedR[r]),e%2==0&&(this.timeArrayL[t]=this.tempTimeArrayL[e],this.timeArrayR[t]=this.tempTimeArrayR[e],t+=1),r=e;this.freqArray=this.fft.timeToFrequencyDomain(this.timeArray),this.freqArrayL=this.fft.timeToFrequencyDomain(this.timeByteArraySignedL),this.freqArrayR=this.fft.timeToFrequencyDomain(this.timeByteArraySignedR)}connectAudio(e){e.connect(this.audible)}disconnectAudio(e){e.disconnect(this.audible)}}},"./src/audio/fft.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));class i{constructor(e,t,r=!1){this.samplesIn=e,this.samplesOut=t,this.equalize=r,this.NFREQ=2*t,this.equalize&&this.initEqualizeTable(),this.initBitRevTable(),this.initCosSinTable()}initEqualizeTable(){this.equalizeArr=new Float32Array(this.samplesOut);const e=1/this.samplesOut;for(let t=0;t<this.samplesOut;t++)this.equalizeArr[t]=-.02*Math.log((this.samplesOut-t)*e)}initBitRevTable(){this.bitrevtable=new Uint16Array(this.NFREQ);for(let e=0;e<this.NFREQ;e++)this.bitrevtable[e]=e;let e=0;for(let t=0;t<this.NFREQ;t++){if(e>t){const r=this.bitrevtable[t];this.bitrevtable[t]=this.bitrevtable[e],this.bitrevtable[e]=r}let r=this.NFREQ>>1;for(;r>=1&&e>=r;)e-=r,r>>=1;e+=r}}initCosSinTable(){let e=2,t=0;for(;e<=this.NFREQ;)t+=1,e<<=1;this.cossintable=[new Float32Array(t),new Float32Array(t)],e=2;let r=0;for(;e<=this.NFREQ;){const t=-2*Math.PI/e;this.cossintable[0][r]=Math.cos(t),this.cossintable[1][r]=Math.sin(t),r+=1,e<<=1}}timeToFrequencyDomain(e){const t=new Float32Array(this.NFREQ),r=new Float32Array(this.NFREQ);for(let i=0;i<this.NFREQ;i++){const n=this.bitrevtable[i];n<this.samplesIn?t[i]=e[n]:t[i]=0,r[i]=0}let i=2,n=0;for(;i<=this.NFREQ;){const e=this.cossintable[0][n],a=this.cossintable[1][n];let s=1,o=0;const l=i>>1;for(let n=0;n<l;n++){for(let e=n;e<this.NFREQ;e+=i){const i=e+l,n=s*t[i]-o*r[i],a=s*r[i]+o*t[i];t[i]=t[e]-n,r[i]=r[e]-a,t[e]+=n,r[e]+=a}const c=s;s=c*e-o*a,o=o*e+c*a}i<<=1,n+=1}const a=new Float32Array(this.samplesOut);if(this.equalize)for(let e=0;e<this.samplesOut;e++)a[e]=this.equalizeArr[e]*Math.sqrt(t[e]*t[e]+r[e]*r[e]);else for(let e=0;e<this.samplesOut;e++)a[e]=Math.sqrt(t[e]*t[e]+r[e]*r[e]);return a}}},"./src/blankPreset.js":function(e,t,r){var i;void 0===(i=function(){return{baseVals:{gammaadj:1.25,wave_g:.5,mv_x:12,warpscale:1,brighten:0,mv_y:9,wave_scale:1,echo_alpha:0,additivewave:0,sx:1,sy:1,warp:.01,red_blue:0,wave_mode:0,wave_brighten:0,wrap:0,zoomexp:1,fshader:0,wave_r:.5,echo_zoom:1,wave_smoothing:.75,warpanimspeed:1,wave_dots:0,wave_x:.5,wave_y:.5,zoom:1,solarize:0,modwavealphabyvolume:0,dx:0,cx:.5,dy:0,darken_center:0,cy:.5,invert:0,bmotionvectorson:0,rot:0,modwavealphaend:.95,wave_mystery:-.2,decay:.9,wave_a:1,wave_b:.5,rating:5,modwavealphastart:.75,darken:0,echo_orient:0,ib_r:.5,ib_g:.5,ib_b:.5,ib_a:0,ib_size:0,ob_r:.5,ob_g:.5,ob_b:.5,ob_a:0,ob_size:0,mv_dx:0,mv_dy:0,mv_a:0,mv_r:.5,mv_g:.5,mv_b:.5,mv_l:0},init_eqs:function(){return{}},frame_eqs:function(e){return e.rkeys=["warp"],e.zoom=1.01+.02*e.treb_att,e.warp=.15+.25*e.bass_att,e},pixel_eqs:function(e){return e.warp=e.warp+.15*e.rad,e},waves:[{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""}],shapes:[{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}}],warp:"shader_body {\nret = texture2D(sampler_main, uv).rgb;\nret -= 0.004;\n}\n",comp:"shader_body {\nret = texture2D(sampler_main, uv).rgb;\nret *= hue_shader;\n}\n"}}.apply(t,[]))||(e.exports=i)},"./src/equations/presetEquationRunner.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/utils.js");class n{constructor(e,t,r){this.preset=e,this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=i.default.range(1,33).map((e=>`q${e}`)),this.ts=i.default.range(1,9).map((e=>`t${e}`)),this.regs=i.default.range(100).map((e=>e<10?`reg0${e}`:`reg${e}`)),this.initializeEquations(t)}initializeEquations(e){this.runVertEQs=""!==this.preset.pixel_eqs,this.mdVSQInit=null,this.mdVSRegs=null,this.mdVSFrame=null,this.mdVSUserKeys=null,this.mdVSFrameMap=null,this.mdVSShapes=null,this.mdVSUserKeysShapes=null,this.mdVSFrameMapShapes=null,this.mdVSWaves=null,this.mdVSUserKeysWaves=null,this.mdVSFrameMapWaves=null,this.mdVSQAfterFrame=null,this.gmegabuf=new Array(1048576).fill(0);const t={frame:e.frame,time:e.time,fps:e.fps,bass:e.bass,bass_att:e.bass_att,mid:e.mid,mid_att:e.mid_att,treb:e.treb,treb_att:e.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY,gmegabuf:this.gmegabuf};this.mdVS=Object.assign({},this.preset.baseVals,t),this.mdVS.megabuf=new Array(1048576).fill(0),this.mdVS.rand_start=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.mdVS.rand_preset=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]);const r=this.qs.concat(this.regs,Object.keys(this.mdVS)),n=this.preset.init_eqs(i.default.cloneVars(this.mdVS));this.mdVSQInit=i.default.pick(n,this.qs),this.mdVSRegs=i.default.pick(n,this.regs);const a=i.default.pick(n,Object.keys(i.default.omit(n,r)));if(a.megabuf=n.megabuf,a.gmegabuf=n.gmegabuf,this.mdVSFrame=this.preset.frame_eqs(Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSRegs,a)),this.mdVSUserKeys=Object.keys(i.default.omit(this.mdVSFrame,r)),this.mdVSFrameMap=i.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=i.default.pick(this.mdVSFrame,this.qs),this.mdVSRegs=i.default.pick(this.mdVSFrame,this.regs),this.mdVSWaves=[],this.mdVSTWaveInits=[],this.mdVSUserKeysWaves=[],this.mdVSFrameMapWaves=[],this.preset.waves&&this.preset.waves.length>0)for(let e=0;e<this.preset.waves.length;e++){const r=this.preset.waves[e],n=r.baseVals;if(0!==n.enabled){let a=Object.assign({},n,t);const s=this.qs.concat(this.ts,this.regs,Object.keys(a));Object.assign(a,this.mdVSQAfterFrame,this.mdVSRegs),a.megabuf=new Array(1048576).fill(0),r.init_eqs&&(a=r.init_eqs(a),this.mdVSRegs=i.default.pick(a,this.regs),Object.assign(a,n)),this.mdVSWaves.push(a),this.mdVSTWaveInits.push(i.default.pick(a,this.ts)),this.mdVSUserKeysWaves.push(Object.keys(i.default.omit(a,s))),this.mdVSFrameMapWaves.push(i.default.pick(a,this.mdVSUserKeysWaves[e]))}else this.mdVSWaves.push({}),this.mdVSTWaveInits.push({}),this.mdVSUserKeysWaves.push([]),this.mdVSFrameMapWaves.push({})}if(this.mdVSShapes=[],this.mdVSTShapeInits=[],this.mdVSUserKeysShapes=[],this.mdVSFrameMapShapes=[],this.preset.shapes&&this.preset.shapes.length>0)for(let e=0;e<this.preset.shapes.length;e++){const r=this.preset.shapes[e],n=r.baseVals;if(0!==n.enabled){let a=Object.assign({},n,t);const s=this.qs.concat(this.ts,this.regs,Object.keys(a));Object.assign(a,this.mdVSQAfterFrame,this.mdVSRegs),a.megabuf=new Array(1048576).fill(0),r.init_eqs&&(a=r.init_eqs(a),this.mdVSRegs=i.default.pick(a,this.regs),Object.assign(a,n)),this.mdVSShapes.push(a),this.mdVSTShapeInits.push(i.default.pick(a,this.ts)),this.mdVSUserKeysShapes.push(Object.keys(i.default.omit(a,s))),this.mdVSFrameMapShapes.push(i.default.pick(a,this.mdVSUserKeysShapes[e]))}else this.mdVSShapes.push({}),this.mdVSTShapeInits.push({}),this.mdVSUserKeysShapes.push([]),this.mdVSFrameMapShapes.push({})}}updatePreset(e,t){this.preset=e,this.initializeEquations(t)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}runFrameEquations(e){return this.mdVSFrame=Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSFrameMap,e),this.mdVSFrame=this.preset.frame_eqs(this.mdVSFrame),this.mdVSFrameMap=i.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=i.default.pick(this.mdVSFrame,this.qs),this.mdVSFrame}runPixelEquations(e){return this.preset.pixel_eqs(e)}runShapeFrameEquations(e,t){return this.preset.shapes[e].frame_eqs(t)}runWaveFrameEquations(e,t){return this.preset.waves[e].frame_eqs(t)}runWavePointEquations(e,t){return this.preset.waves[e].point_eqs(t)}}},"./src/equations/presetEquationRunnerWASM.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/utils.js");class n{constructor(e,t,r){this.preset=e,this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=i.default.range(1,33).map((e=>`q${e}`)),this.ts=i.default.range(1,9).map((e=>`t${e}`)),this.regs=i.default.range(100).map((e=>e<10?`reg0${e}`:`reg${e}`)),this.globalKeys=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy"],this.frameKeys=["decay","wave_a","wave_r","wave_g","wave_b","wave_x","wave_y","wave_scale","wave_smoothing","wave_mode","old_wave_mode","wave_mystery","ob_size","ob_r","ob_g","ob_b","ob_a","ib_size","ib_r","ib_g","ib_b","ib_a","mv_x","mv_y","mv_dx","mv_dy","mv_l","mv_r","mv_g","mv_b","mv_a","echo_zoom","echo_alpha","echo_orient","wave_dots","wave_thick","additivewave","wave_brighten","modwavealphabyvolume","modwavealphastart","modwavealphaend","darken_center","gammaadj","warp","warpanimspeed","warpscale","zoom","zoomexp","rot","cx","cy","dx","dy","sx","sy","fshader","wrap","invert","brighten","darken","solarize","bmotionvectorson","b1n","b2n","b3n","b1x","b2x","b3x","b1ed"],this.waveFrameKeys=["samples","sep","scaling","spectrum","smoothing","r","g","b","a"],this.waveFrameInputKeys=["samples","r","g","b","a"],this.initializeEquations(t)}getQVars(e){return i.default.pickWasm(this.preset.globalPools[e],this.qs)}getTVars(e){return i.default.pickWasm(this.preset.globalPools[e],this.ts)}initializeEquations(e){this.runVertEQs=!!this.preset.pixel_eqs,this.mdVSQInit=null,this.mdVSQAfterFrame=null;const t={frame:e.frame,time:e.time,fps:e.fps,bass:e.bass,bass_att:e.bass_att,mid:e.mid,mid_att:e.mid_att,treb:e.treb,treb_att:e.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY};if(this.mdVS=Object.assign({},this.preset.baseVals,t),i.default.setWasm(this.preset.globalPools.perFrame,this.mdVS,Object.keys(this.mdVS)),this.rand_start=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.rand_preset=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.preset.init_eqs(),this.mdVSQInit=this.getQVars("perFrame"),this.preset.frame_eqs(),this.mdVSQAfterFrame=this.getQVars("perFrame"),this.mdVSTWaveInits=[],this.preset.waves&&this.preset.waves.length>0)for(let e=0;e<this.preset.waves.length;e++){const t=this.preset.waves[e],r=t.baseVals;0!==r.enabled?(i.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],r,Object.keys(r)),t.init_eqs&&(t.init_eqs(),i.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],r,Object.keys(r))),this.mdVSTWaveInits.push(this.getTVars(`wavePerFrame${e}`))):this.mdVSTWaveInits.push({})}if(this.mdVSTShapeInits=[],this.preset.shapes&&this.preset.shapes.length>0)for(let e=0;e<this.preset.shapes.length;e++){const t=this.preset.shapes[e],r=t.baseVals;0!==r.enabled?(i.default.setWasm(this.preset.globalPools[`shapePerFrame${e}`],r,Object.keys(r)),t.init_eqs&&(t.init_eqs(),i.default.setWasm(this.preset.globalPools[`shapePerFrame${e}`],r,Object.keys(r))),this.mdVSTShapeInits.push(this.getTVars(`shapePerFrame${e}`))):this.mdVSTShapeInits.push({})}}updatePreset(e,t){this.preset=e,this.initializeEquations(t)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}runFrameEquations(e){i.default.setWasm(this.preset.globalPools.perFrame,this.mdVS,this.frameKeys),i.default.setWasm(this.preset.globalPools.perFrame,this.mdVSQInit,this.qs),i.default.setWasm(this.preset.globalPools.perFrame,e,this.globalKeys),this.preset.frame_eqs(),this.preset.save_qs(),this.mdVSQAfterFrame=this.getQVars("perFrame");const t=i.default.pickWasm(this.preset.globalPools.perFrame,[...this.frameKeys,...this.globalKeys]);return t.rand_preset=this.rand_preset,t.rand_start=this.rand_start,t}runWaveFrameEquations(e,t){const r=this.preset.waves[e].baseVals;return i.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],r,this.waveFrameInputKeys),i.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],this.mdVSQAfterFrame,this.qs),i.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],this.mdVSTWaveInits[e],this.ts),i.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],t,this.globalKeys),this.preset.waves[e].frame_eqs(),i.default.pickWasm(this.preset.globalPools[`wavePerFrame${e}`],this.waveFrameKeys)}}},"./src/image/imageTextures.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));class i{constructor(e){this.gl=e,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.samplers={},this.clouds2Image=new Image,this.clouds2Image.onload=()=>{this.samplers.clouds2=this.gl.createTexture(),this.bindTexture(this.samplers.clouds2,this.clouds2Image,128,128)},this.clouds2Image.src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4RP+RXhpZgAASUkqAAgAAAAJAA8BAgAGAAAAegAAABABAgAVAAAAgAAAABIBAwABAAAAAQAAABoBBQABAAAAoAAAABsBBQABAAAAqAAAACgBAwABAAAAAgAAADIBAgAUAAAAsAAAABMCAwABAAAAAQAAAGmHBAABAAAAxAAAAGYFAABDYW5vbgBDYW5vbiBQb3dlclNob3QgUzExMAAAAAAAAAAAAAAAAEgAAAABAAAASAAAAAEAAAAyMDAyOjAxOjE5IDE3OjMzOjIwABsAmoIFAAEAAABWAwAAnYIFAAEAAABeAwAAAJAHAAQAAAAwMjEwA5ACABQAAAAOAgAABJACABQAAAAiAgAAAZEHAAQAAAABAgMAApEFAAEAAAA+AwAAAZIKAAEAAABGAwAAApIFAAEAAABOAwAABJIKAAEAAABmAwAABZIFAAEAAABuAwAABpIFAAEAAAB2AwAAB5IDAAEAAAAFAAAACZIDAAEAAAAAAAAACpIFAAEAAAB+AwAAfJIHAJoBAACGAwAAhpIHAAgBAAA2AgAAAKAHAAQAAAAwMTAwAaADAAEAAAABAAAAAqAEAAEAAACAAAAAA6AEAAEAAACAAAAABaAEAAEAAAAwBQAADqIFAAEAAAAgBQAAD6IFAAEAAAAoBQAAEKIDAAEAAAACAAAAF6IDAAEAAAACAAAAAKMHAAEAAAADAAAAAAAAADIwMDI6MDE6MTkgMTc6MzM6MjAAMjAwMjowMToxOSAxNzozMzoyMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAACoBAAAgAAAAuAAAACAAAAABAAAAgAIAAEgAAAAKAAAA/////wMAAACK+AIAAAABAL8BAADoAwAArQAAACAAAAAMAAEAAwAmAAAAHAQAAAIAAwAEAAAAaAQAAAMAAwAEAAAAcAQAAAQAAwAaAAAAeAQAAAAAAwAGAAAArAQAAAAAAwAEAAAAuAQAAAYAAgAgAAAAwAQAAAcAAgAYAAAA4AQAAAgABAABAAAAkc4UAAkAAgAgAAAA+AQAABAABAABAAAAAAAJAQ0AAwAEAAAAGAUAAAAAAABMAAIAAAAFAAAAAAAAAAQAAAABAAAAAQAAAAAAAAAAAAAAAwABAAEwAAD/////WgGtACAAYgC4AP//AAAAAAAAAAAAAP//SABABkAGAgCtANMAngAAAAAAAAAAADQAAACPAEYBtQAqAfT/AgABAAEAAAAAAAAAAAAEMAAAAAAAAAAAvwEAALgAJwEAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAElNRzpQb3dlclNob3QgUzExMCBKUEVHAAAAAAAAAAAARmlybXdhcmUgVmVyc2lvbiAxLjAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAMgAuQC5AABqGADOAAAAgE8SAJsAAAAEAAEAAgAEAAAAUjk4AAIABwAEAAAAMDEwMAEQAwABAAAAQAYAAAIQAwABAAAAsAQAAAAAAAAGAAMBAwABAAAABgAAABoBBQABAAAAtAUAABsBBQABAAAAvAUAACgBAwABAAAAAgAAAAECBAABAAAA9AUAAAICBAABAAAAuA0AAAAAAAC0AAAAAQAAALQAAAABAAAAaM5qp6ps7vXbS52etpVdo/tuYZ2wtrDFXnrx1HK+braKpineV1+3VFWVteo72Poc/9j/2wCEAAkGBggGBQkIBwgKCQkLDRYPDQwMDRwTFRAWIR0jIiEcIB8kKTQsJCcxJx4fLT0tMTY3Ojo6Iio/RD44QjM3OTYBCQkJDAoMFAwMFA8KCgoPGhoKChoaTxoaGhoaT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT//AABEIAHgAoAMBIQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AOdCcU4R11HMSLHTxFTAXy6PLxQIUJTglIDo9KtbWzjScNvnK/gtao1FkycjaO1ebWvOWvyR307RjZfM5zXoraacTW3DtkyD1PrWathui39q66cmoK+60OacU5O2xA8ZQlT2qBkrdfmYsiZMUwpxVCImXNRMntTERlaaRg0CN5Y8iniOszUlWOniOgQhj5o2UwDZS7KBFmAuoCnIAq69wUjIHPHWuaok5HTBtIqrbzXCMyAEDqCarPvGV6Yqlbb+Xch337kBTOd1RNHxgCrc+xKgNWAPxyD2qCWMAY7g81UJ83yJlGxCy4qJlzWqMyMpTClAjoxCUbDCniP2rK5qOVKkEdMA8ummPmgA2Vd0m1S4vMTIXjUEtjtUzdotrdLQcFeSXQfcQqJ2y/GaZL5fkhE5Y9TXPFt2Zu7K6IUinVWVW+XvjvSNCsceScsa0k1067kRT69NisY8mnC2YoWA4qL2KtcglyjcVVdd78daqnK3zImr/IheFgTkdKiZK6ou6MJKxGyUwrTJOxmjaS2WYqwjLHbnp9KBaeeB5MbZxzXLGVlfotzpcdbdXsQiKniOtSBfLppjoTE0NMdPiYxElSRmiSurAnZiSMTzmmKSDmpUdCpS1NvT0TUoHEjpGQcYC8n3qM6MJdxgYuF46VyyfI2ui6nQlzJPq+hDPo0qcKNz/wB0U54Es7co/wAzkcgdAamU01ZbtjUWnrsjDn+dzxiqpjYHK1aZDHJGQmM9ahe2zk+lbU5WZlOOhWZKjKV1nOddYTPLpptjztbcB2NTBXibaSUOOma4IWt+h2y3/Uj8rmlEdbJmLQpTjpTNlNCYnl00x1RI0x00x4oARd6tmPIPtW1o+uf2fGd+GORlcdffNZVaaqRt1NKc+R36HQxWsWoqbmGQ/MMkg4rL1bSdi5UV5fM4ys9LHfZNXXU599Lkd+FNMbSzGPmHNb85lyFaS32HgUx8pGcqK2g72M5aGY8fPSomSvRRwndafZfYtRCzL8rHFaPiPTTHKlxHGEjKhTj1ryKU/wB4uzR6dSPuPujF2YIzTxHxXamtuxyNPfuIY+KYY6okDHg4pHQIMsQKLhYhV0dtq8mr6aQ8loZRy390DNZVKqgr92aQpczKcd8+nXefLHAwVI6028nt7mTzIY/KJ5IB4qI3UuZO6fxIuSTjy21WzLmjXs9rKFidgM/dzxXTJeRECC5ZN5XPWscVTTlePxM0oS0s9kUriaIEiIKAPzrFup/3uBzmopU3fUqc0isTEQWftVWZ0dPlWuqNNr0RhKafqzOlh6mq7x12RZytHqssMcwSfy0wwyDuxRq2oCew8gxjdx1HT3rx6Uby9GenUdkc/wCSpPzdaV4WVeFJru226nLv8iFVc/eXFKYsCqi7omSIjHzS3EKSRZBJbHNOWwRMp4WjO/O0Z4NWUubuGParnafSsXFS0ZonYRo/Pwzcmk8gL0FbQgkjOUncfFK9sSU4JpkkzO+7Jz9atRV7mbk7WHpczAcOT9aUqzgu3Ud6lxSd1oylJvRkMgDZJJzVSTK9KqKJbIGJqJlzWiViG7nfW1/ZK8XJUDqT0q9q08V2sRiL5HAG35SD3Bryaalzps9KduWyKt1pjWoXzG2uRnkcCs+8ee2YKJUbIzx0Iq/bXemiRPs7IY15Ey7m+TA5BrPuNUDIyCMDnhs81rz3SsZ8tmXbFDe2DTKVzHwyk8n6Vl3944Zo04A7jvT9pp5oOTX1Mp5GVsnmtG21aEQKkikFRj604SFKJOmpWrHAYr9RUjMGXKcg9xW0WmYyTREwNN281qZkqphQRwacCMYPHvUPUpCPGhXORmqU0fNEXqEkV2j9qjKVoQa+GAALE47VPDezRYUOdo7V5CkelY0pb+eayOJt4PG1uSKxpEkQkkmp0T9StX8hnm5GCM1GUBzVXsIj+deFYge1NMTueuapyJURr2jMvTmqclq4PK4ohMJRIhGwNadgLolUjDMvcVtz217GfLc2PsuSQQdw7Uw2pU/MCK6FU6eWhg4afmWLeKFkZJcg9mFRzac8MSyMRhumKnns7PZvQOS6utLblaRMLyR9KhkhVVBDZzV21TFeysVXWoiK1MjttV8O/YWyXVgegFZRsTu4FeHdp2e63PWSvqupZtrbadpHFPnst4xgVDlqUkUX03ax7VEbNd3ByapSbFYDYKw4PPpTv7LdT0wRVq703J0XkBtlU7Sy7qje1yMMtJpoaaZWbTCZOB+FdVo+n/ZrRXaEh/pwacptxEo2ZZfRBLmQNskY8g1lXmm3VsS4IZaaxDvZ9NifZK35mUZbp7odD6jGK3jcotogmgUrWsp3tZ2sTGO+nqZr3Flco6JEEdc7eetLDoElxEH81Vz0FbQrOEby9530MZUlJ+7ppqOOgRxDMrqcdumaqz6Xa55YJnphqaxE5PRadgdGKWr17nd+cl4VFzGHAq0NEspRuRNp9K5vYxm3e6b2ZvzuK027CroNsPvLz6iql7oICFkOQO1RPCuMbp3a3Q41ruzWj2MG604xZJrInQoSVHPrXPB3NZEYlm6bM0gup0+SQttPXmt42W25DuRTW7ht6qXX1qxZSSSttZcqPWrjJPfXuiWrbGgFiADHBxW9p1z5dv8AvW3J2B7VbUeXuQnK/kM+0SyTt5GSg/ic8VUv7xpodrDn26Gs5wj0+LqXGT67dDFWLEhfkGo5nklyrE4qlC9vwJcrFRbJVl3GtO1njhTqQR61u4StYyU1civ7sSLtAJ981kSLnPJrelHlRhVlzM7yLTdTtJuu9Qe3NdBbGUorMFJxz2NcFPnUrWO2XK4lsdKCARg13bmBSurCGU4aMtn0qjJ4Xt3YnP0GK4pYbmk+X3bGyq2WvvFKTw5IpIRAR61Fc+Gttvvfn1GOlYeynHVq1uprzxfzKcCW1mdroXU8YIqQR2KA7AxPUgDGKiz3TKutjPnjic74jtB9TzT4p58Bc7yOm6tItrfoQ0mWEubtZf367l7DtUqq1w24gKg6kDpW0FFrm7Gc207dynKqqzAoOehFVmhLdFJ/CumKtuYN9gGnzuPlibmoXs5VJBXkH1qlVjtdEezlvYimtJEXLow/CqErIDWkZp7WZEotbnrsTkjrmphz1rGDutdToloxaK0EMkU9VGSKRDIQd4A9MVm+ZS0+F7selvPoNDuHw3T2oJWUlWH50r3Vn1HtqjG1LSmVS6DdzxxWQ+nTSTcghjXBKPs3Z/I6IvmV/vK7aWYptsp2jua0LG3tllLQZkK8dO9C95227g9FfcmuFnnUrtyF9BUthHhfLkjO0n14zXToo2WhiruV2JqFtFGNyxoSPUVztzrdzBJhdoVewFZJ8zs3dLY0a5dVu9yCTxLKUPyDd2NZE+tXDyF84J74rSMEiJSbKFxqFxMpDyuQe2azpN3dj+dbRlbYzkr7nvCJkYxsP95eDUqxyA584t7EVnTi+j5fLoaSa66+ZOM45orqMgooAYwqNhis5DQ0yMBio2Zm7ZrNu+5VrDNizPsdFI9CKjNrDCuEiCZ6kcVlKEd7fMtSe34DY2jV8YKknvzTLqUQcs+PwqJuyuVHU5TWtVeaX5coq/dGaxpLxpUw4zjvRFKwSepAF85SUGcdRVeaJh/DiqvZ2JsZ86sDz0qBo2xu/hq0yLHvy9KeK2pkvcdRWogpM0AIaYwqJAhNq1FcPKoHlIHHesZNqPu6vsWtXrou5HuK5YLzjjNZ1/c3YiIUZX+8vauec36LqbRivV9DNivriYlWOdo6HmrxleWIBgDx3HSpaugvZmDqFuWYgwKSPQVlsjxIym3BUgjmoXa+xT7lSOzd3PkAq3YZpby8vVASeNendBzWukt+nUz22Jo7S2v4A3lFGxzg1Rm0l4m+UMVPqKlSa03Q2k9T/9n4qqwQ2C6FUcJKhVwpbQ1vCsihOUlK0km1lS0VoSE2qiF4TrpDJE0aZJK5EgBF7pQGeoyWHrHyLxlrwklpeaZbWWmyFkkIa43/2P/bAEMAAgEBAQEBAgEBAQICAgICBAMCAgICBQQEAwQGBQYGBgUGBgYHCQgGBwkHBgYICwgJCgoKCgoGCAsMCwoMCQoKCv/bAEMBAgICAgICBQMDBQoHBgcKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCv/AABEIAIAAgAMBIgACEQEDEQH/xAAeAAACAwEAAwEBAAAAAAAAAAAGBwQFCAMBAgkACv/EADcQAAEDAwMDAgUDAgYCAwAAAAECAwQFBhEAEiEHMUETUQgiMmFxFIGRFaEjQlKxwdEW8ReCov/EABsBAAICAwEAAAAAAAAAAAAAAAUGAwQBAgcA/8QAMREAAgEDAwMCBQMDBQAAAAAAAQIDAAQRBRIhMUFRE3EiYYGRwaHR4QYU8BUjMnKx/9oADAMBAAIRAxEAPwDNEamJCR8v9tT4dJ3Zwn+2rSHStzaVBvOrSDShnBTpvDYpbIBqsi0QKRn0+QO2uwpJQQCjRFEpR8D+2uj1LIXjb/bWwfmtNvFDqaWE/LsHfXZFNB/y6uVU75uUjj7a6NwMfMEfjWd3Fa0f/DB0mtK7KpIum8KgUxqQ+0pmE2EqMlzOQFA/5MgZ/J1q2L1glUxsPtIbbitNpW80EgbwSO+PGsWWjUqhRZy/0Tqkh1OFgH78aaKLzm0i28SnlLddYwk+wGdJH9QafJd3QLtkdh4802aNeRwWxCjBHU+aA/iosex//ktysdPnN8SpAOymM/M1IUo7/wD6k8jS8uTpxPthCJL3yuJSFKGOwPY50wavS7gnU3+vro7i4QXkyA3naoc86FrhnVGqpQl1SvTI5QVZzycHR6zkmiiSMvkLwSevtQe7WJ5HcLyeRS/q0BHqLc9NIKjyB50Pz6cEkkj+2j2qUlDRWfrJSQEgdjqqRbKKkVMJe2uBO5KSngn20SW9t1OC1DjaTsMhaBKhBCWt23A841QVGnBaiQ3n86O67TGWigR1bsg7hjkHPnVFNiJSgpIyc8DRBDxVRhjigmVAAP041CcaW2rcgYI9tE82n5PCedVkqAUkgJ1uQDUXfFaZplIUMsqb2kHke2rGNSylf0g8+2j2rWvRZtbjvxXY7EV14tuymdxzknCiD9hnge+oU+110+WtoLS4hKylDiBwoe/+2gkVysgB80akhZCQao4lMCk528jXRykKJ3bfxq8jUopABT31KXSRn6NS7sVFjihNVM+Y5T24zr1FPIVt26I3aUoEkA9+2uCqaUuDKdShs1oQM0bVvpPAtizaDUKLKVIVUYaZcxTrQSpl4jBQPOE/7k6rK1QUU213PUmJVLeWG4zTSgoff8Ht/Op1239WbjjNqqMgKDLKW0hCQkAJAHYceNC8aprVNbW+nKErG7nxnnGlyG3vJcvIckHP8f4KNyz20QCxjqP4rlFq98KoZs5ptxmKuQQ4kZBK/PPtjx21U3NbopREMhKlgfOQex9taAhdK3uofT7/AMo6eUh2PBElXqOyn0bFKT9XJOQRuHccg6BKn0RvByUUyqI+pxbZWnCchSQcZyOMZxzqs97E5IwFweR3z86nS0dFByWyOD2x8qULduuOOfIwVcZOBquqaEUV9t1EMBQz3HjTz6c9OpUibLl1aKGIsMelIekfKncoHAB8nj9tK/qfDpiqu9Hp3KWyQCR3++q7XStcel4FSiAiLf5pTVmEhcl1aOQok8e+h2bTVBZJGD99HAYnQZKxCYSXHRt3LQFAZ+x17XBbjT0VpLURKNqcFwJ5Ufvpms9VUuEfvQC609gpZaWMqAcnjzxqslQwBx+2jGr0ZyI6WHmsKx/OqaXTu4KfxjxpgBDDNBDuU1t2HUKReHSW0yqB6D9NEhh+Q0jIWvcFBC/bgkhX3I8al1mQ5ULdj0gUeKw2zIW6hbKDuJICeSSf9I0c/Bn0Pi3xcL1o1iSmP6chKz6qcjaPlPB78Ej99D9etp63K1OtySfUMSU4zuAwCUqIz++Nc70q8huB6SHLJz9yaeNQt3hbe3Rhj7AUJMUc8fJru5S0+n9HI99EcOkFxO5ScY9hr2k0hIbPy+PbTCX3UEA2mg1ym7gfl51Hk0rCdwbOilVLUkkFGvC6SVEkI/IOrAkAqBlNBbkJQQQnODxqK7TFIPKNGTtFZS4d+AAMnOvU2dPqEN6bAhuuMxwPWdbbJSjPbJ8aw9xFEMk4FeSOSQ4UZqNY/V26LLpj1qR5CjT5K8uhP1oJKclJJ4+ka2DZLVgdROlbVDtKII9wohsKeDxG8Mn/AD4BI2naPPdWsxdOennSm511K27kulcCqlgKpUpxQ9FSwPpV7A++ovTq+Lw6IdUGJcSWmQuG56DjbUrc082T9IUONvn/AI0rana2msB1tjtlX4vG79x2/wDaYLO4udM2mcZjbjzinj1f6PXNEtfDtIYjts8+nETj1FEY3qz3JwNZJvGw566u4n0FbiTu419Ird6o2r18oaWnIiYr8mKlT0dXdteSCArGCMAY/wCNKq8ehtl2tMcl1LY8+SpSGkjsOcE/9aRrbULm0maKZfiHamiW1huI1dDxWGHOmU9tkPyIpSM5STqGKHBTIEea2VJB5GtFXzCob812AkIbUjgADHGgWo9OY7Sf1jrjYDhJQpRxxpktbidjlxig08MSjC81nbqPSKe3Wj/Twop9IbwrsFew0HzaeE8lPfTav+22WqissELUSd2DxjQRVKQGx8qPyddMsJA1qgz2pDvEK3LH519dunnRiPZfXiDc8OoxUU1x8IdUy6NqwrIBx3wSM6B/jNsG2aZ1fdlW5LbWJ0Rtx5pAyW1425J7HIAOmjYxrN8yqTb9UoEanKXT0h+ey8lTrxGcKScZRn2PnzpWdXKVKYvqo0559+U7EfLSJMiOW3HAnspSTnx57Ec65F/TyYuid3IGDjx710nV2zAo28Z/X2pVU+2JMJrZIVk9xrg6xDkLWww8lS0n5kA8jRo7NtiAwpF0SVNEK+YIQdwGq9u16ImOzWqO8l1qWne24MHI/wCD9jpvhugGEakEDrzS/Lb7gXYYJ+VCS6c5HUHkJ+dJyCR2OudJpEya86zGirce27m/TTnGOSSPbV7dM2FRkw0uOMqEuQWfkeSVIUMd0jkdxqM4HqK8qR6oZ9MEOlRxgeQdXBcJIp2HmqZt3jcFhxShvufX6ZWQuS84SlZJaSOMZ9tMzpz8RVmUmy5do120UuNPJBSyklG5eACSR3yB2++ll1F6rW69WZKItHTIUUFDD7rpGxefqwO478atrNtyFeVoR6o84gPeotC1NEDJB4PbQie3W/X02PGc9aKRTf2R3gVUXJRH59xuVSgRzGZcXuQ2CcIB8DXWHClMOIdlLKlA5yfHPfRk1bbkOElp9e5aBtzjwO2qmpNMxspTjPuPGjVnZpGB5FCLq7eQkY4o+HXyRYtowaBY4ALMlt5ySpeVhSQNwPH0nAI9hka6TPiakXWt2Rcqn23HUkrDaApJXwMjz7/zpRyWSpzcPOplOghLaHZLSi2VYCgNYk0PT2G5kyx79+awurXoOA3HjtVjWqgqq1FdVUVqbWCGyDhQOPOhK6KnV3VoVJdWG0AhAHkaNJUQrpbcVLSAVnd6iOVHuMaFrnp0tpKv1BJUgYIOpLeKFTtA6cVFNNKRknrzQLV5sV1agWjz/mPfQjVYSFLUWxx4zorqsBwun5cA6qJEEkH7edGIY1iHw0NkdpDzWvLB+KW9rXr0OpN1x55tbXpTQtsbkoOAQkqBwQBweccadHTfrT0wrFz1K5ruuWfOcl00x4s2SylTsde0JCl+OEgpBHP2GsvVG0ajCfUw7CIKDjKRqw6eyKjb9cbdMcPNKc2vMujhSc9jri6Tw+myrhdwwSPFdSaNyyk84OaPut/WO1oTkuzG6PFmul8LYrDBO5SMHIVu5UVcfg9u+l1Gvup0+lLRb0v/AA8ENtvEkNk8naNEd4dNl1J1+tNx0oU4srS0Owz4GfGltMo1VgTDGfWpKEqzwO+orW8WIARtgit5oC+d65BoaqIqqpSprkle71crKlHg50fdVevFq31ZdPt+NbyoU+PT249RloUNstaCT6pAAwo55P2Gh1+lSnt7CmS5nJScarUWstThbciFWOT8vYaIJqWcFjyPzVVrME4A4oErdLE1tamV5JOQfY6pqZeN22Sp1mkVd5lLowtKF8HTjh2HBfaSEIBJByPbQ/cnRhLzS5cTJOSSlQ7a2ttYEUmCaxNp5kTIFD1rfEHekScluoTjKaUseo2/yQnzg+NNinTqPdba36FN9cJA9RJGFJJ5wRpNW/02nTa81SGYpLrrwQkbfJONao6f/C3UunPTxd5Sn1LefdQlUb0+R3IP8aY7bW0jnRC3/LigdxpfqRMwHSl2/RH23Ni2SD7EauaRa1RlUaRLjxS4iMAp7YeQCcZx5AP8Z0aVyg0RgNvSZxafWfodSBzjjj+PxrzRK43aFX/Rwq9CccqLKmlNMvhRJIKcKT7j799GG1ZJIvhI3ePahY0x1k+LO3zS+juvtOBpvCcqHJAONV931CVP+R2GhWVY3oRjb/Gn51R6ET0Uin1i0LUHomIgyW2RvWF4PJH1DPck+4xxxpS3ZR61Zlddi16gNtnaU+m4nKT9xrW3vYL0BoSN3jIzxWJbSazOJQdv1xSlrFLbSokg5OqWRBSXDuIH50dVKmVCrOLMOEpz8J7aoa9Z1w0Vaf6tRZLBcA9NLjJG7PI/9aPRyDAVjzQhkJOQOK+lfxU/DzTVXM2enFkf4D6C4+7FbKxu85OcD8AaTUH4erjaeLrNGcSsKwpBbP8AbWtOiV5zKnVG00SptyUrOFpS8FA/YjPGnW3QrdrITOcpLaXQQTubwQR7++uKLok12zehIBz0I4x8iD+mK6h/qKQKokQnjrnmsCu9MJ8ajpZqNLWktpwoKTpe3TZtDZlrUI+1e3JCm+M6+md1dN7VuuCqPPpTW8NkNrQkAg447ayz1t6Ff0FMh5qlrKjnZhPnGhGqaZe6RIDL8St0I/Pir9nfW98pAGCOx/FZFbpkB2oKQ5BbbU2rAUrhK/tqxj2pa8qQp+tPMw1hISyMEpd57HGcHnPtgak3h0/uKbP/AEkeI6CFH6UEYOqef0lvNcb1XZDoWk7kJUrnOtreSHgsRXnVyOBXpd67Jst8xKdHMtfqAKLY+VQ8lKh3/OuUe2oVxRjPpAzv5LDn1t/Y++ulF6e1y9YZtp9paKgw5hlwpJ9XOePznU/p70tvqgXO8K3EfZEMFBTggLXgkDH7dtEi9hM2w4WqoFzGu5cmudk9B4NWvmImcoRGluBTkoJ4SnI5/OtnMdO2rdZgVKt1mNJgtsJERQQPTkYCRtxyO2SSeTu1nqk3TETV4dKVFTGUtwpkGQsJSnHPCjxp41S9alWbWVY1syI7UVhLf6mXJeAbYHOTvP8AqHAAz286llsrV1TEmfwKhW5uFZspj8mqjq58PfTe6KC7Vo8KNGU2hS1ORlggr5OMDkcax3UulMFfUVuO5MUhppe5DxPbHOONa2u2NVKBSlMUCVNkMuR0plPvpAaWvn6M4OPzpL1C3pcOovOymwXSFbVBOdufI/71pY288UpEDllPT81m5nieMGVQDUTqj1OrNm2221bF3PrdRGLLxaePJ5899DvTLqJROq9VpznVGC++mG2WnGwCQ8rOAT5z7/jXpUbcW+46mpI3kqyk9+NelvvtWe4h2nx0ZQ4CpJT3HnTFp2n3CpvHXnnoaDXt/AW2k8ccdRTerNsdGbepiq7SbPZSQz6qmxFUSkHt4IHP99KK7OtdlxnltsUKS4VEpfadOAMdsfcHVldvVKtVOkriQ3VRy4r/ABdijhQHYY8aUldil1TinkBSl87jotpmj78tdkk/9iaGX+rCMhbYAD2FfTe1PgzqHT+7UXJatwF6M1IC22ivDm0HI5Hn99Puh0+RTssKqLzzeMpTJBKk/bJ1CtaWzMbJizUOBBIWE5BB/BAP76vmySnn++hul6faxH14iefnkfT5e+aLXl1O/wDtv2+VedVdx04TlMtoajFS1FCvXZ3ZSe+PY41aaj1GK7LjlEd703ByheOx0VuohNAVxmqcTbJAaD698P3TisQZDDVDbZfeOQ+ngpP/AFoJY+Du3xUkzKrLalsDOWcFOD+f402Y9MqzVLdaqNS9V8kltxJIIGOBqPGl1OBGcDzO9RPClL57HQKXR9JkZXaDZx24+4HFEEvrxAVWTPv+M1k7qf03c6UXG5Kt+2W3S0slmSpsgd+/PfA/31VT+rw5XV7Tgxqi9HLzsh5IWXMA4wk8Jz/61qfqf0ypfUSkqnMtgzWo69iSTySOBrOVT+Fy8H6k2xVqTIbS4fmf2ZShOlG+0xrOUqyZU9CBnj+KN214J1BBwR1FI+5axbN0SRL9L0pTqgXGkNYQhWPA0QWv0pvrqJRAqgz5amow/wAJv1fkGMnsfHJ0Vv8ASGj9La+5Vbzt+XLisglpLUc7XecABXj8nTHoTFTdsaIbcguUlh0BSWW1J3ZcAyFecD/nWbRTI/pxnbjz+1YuJPTTe4z7UtbWoF2XPOYtepy1L/TIUpwOOhKUJQMq559j/Oqu+qXW4tYcRS6bMQzKQENMrQcqTjgcDkeR9tN+2enl4Wncypj8OO+AMu5SpaCnIzyPOrvrrU6bS7f/AFKKm1FfWgpSoqSTvxnA9iNMM+orZlSoDADH17mg8Nm90DklST+nYVmdfQq/6q4hX9CDKXRu3PvISEjPcjOf7Z1X3T0BlW/SHKtU7jhD0nQhxDIUoJ9yTjxnwNBV/dYep9r3K8+xXpYCuEoWtQBTnjH2Ol31P+IPqddDCI8utO7UIx6bR2p/cDv++rKanqbspVlA9v3qBtPsVBDBif8APFMWtWPSqdTnahIuultpwfSbmv8ApKUARhQye2Of20lbs6o2bDkriqrsJWxW0rbVuSr99ANzXLXZ29dSlur+XlS3CdLyvRW1rWsOg55I76MWupyoT6jbvpihtxp8LD4Bj61/RJHoRq8ZmNWFvJWyrcxIjultxP7juNXdEoJouRFqT7rSvqTJXuOffOvaIT6YBJOBxnU9ogpwBjVbTrSDAkxyMc9/5q7NcSOSvbxXtr9r9r920ZqrXhYBSQdQJjQIJx+dTVup7ajSNqknPtqCcAx1lTg5qllPvxcltwj8agSnqpIQSEuqB7nB51dqYjlRLo75BP2xquu+ZckWnoNqw0StqgH2lOYUUeQPzoHM/pRM7E4HYDJ+1EEw7hRxnueB96rabFcqrkmPJa9UNoBLK+x+bng9+NU9woj0+Utb1vtObAMteiR6ae+5I8du+plWqFah0t5VKbEV1xW4uuIO5IA4Bz986z71mvbqpRbmTUaqX429sNhyO4r03BnIWOfIxn8aA3N9CsigDnyen3olFayFDk0665W4Eq1v69HlyC00raWmlBSkKzwSPtwceQdYw+L3rDWLhqggJQ41FiI2RcnBWc/MtQAABJ8eO2tAWXcl2/p3WX3S4pwpVuWySl3I/wD1pQ9erfrM2c+0i3I8sFBcQtMTkI7c7e3PvoZNcPHcCQjj371aiCPGUB5rLNfviqyKYiTU2VrbQdiXHBnIz21CqNq1WpwUzaPDMhtxsLCmkZwD747aOLwgXNHt522avZjQiLWHEEp+dsDcBt9uSM/jVFRLZ6vWBSZF2dNHZSIzzKm5jbRStSRzwUkHgZznHfVxLkyLxgH9DVdo1j6nIpK31QaoylfqMEEDCgBoHl0OU7HVUm2VpS3wpvGc8d9ak6WVGL1IdnW51Ht6NMmuO+ozMGGHMEYKSBhJAPIOO5OfGqC//h1doNVcnUOnThGUopKS0HAoc9iO/wDHjUqak0bGNxz+lQtbK3xrX//Z",this.emptyImage=new Image,this.emptyImage.onload=()=>{this.samplers.empty=this.gl.createTexture(),this.bindTexture(this.samplers.empty,this.emptyImage,1,1)},this.emptyImage.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="}bindTexture(e,t,r,i){if(this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,r,i,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}}loadExtraImages(e){Object.keys(e).forEach((t=>{const{data:r,width:i,height:n}=e[t];if(!this.samplers[t]){const e=new Image;e.onload=()=>{this.samplers[t]=this.gl.createTexture(),this.bindTexture(this.samplers[t],e,i,n)},e.src=r}}))}getTexture(e){return this.samplers[e]||this.samplers.clouds2}}},"./src/index.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n})),r("./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js"),r("./src/presetBase.js");var i=r("./src/visualizer.js");class n{static createVisualizer(e,t,r){return new i.default(e,t,r)}}},"./src/noise/noise.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));class i{constructor(e){this.gl=e,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.noiseTexLQ=this.gl.createTexture(),this.noiseTexLQLite=this.gl.createTexture(),this.noiseTexMQ=this.gl.createTexture(),this.noiseTexHQ=this.gl.createTexture(),this.noiseTexVolLQ=this.gl.createTexture(),this.noiseTexVolHQ=this.gl.createTexture(),this.nTexArrLQ=i.createNoiseTex(256,1),this.nTexArrLQLite=i.createNoiseTex(32,1),this.nTexArrMQ=i.createNoiseTex(256,4),this.nTexArrHQ=i.createNoiseTex(256,8),this.nTexArrVolLQ=i.createNoiseVolTex(32,1),this.nTexArrVolHQ=i.createNoiseVolTex(32,4),this.bindTexture(this.noiseTexLQ,this.nTexArrLQ,256,256),this.bindTexture(this.noiseTexLQLite,this.nTexArrLQLite,32,32),this.bindTexture(this.noiseTexMQ,this.nTexArrMQ,256,256),this.bindTexture(this.noiseTexHQ,this.nTexArrHQ,256,256),this.bindTexture3D(this.noiseTexVolLQ,this.nTexArrVolLQ,32,32,32),this.bindTexture3D(this.noiseTexVolHQ,this.nTexArrVolHQ,32,32,32),this.noiseTexPointLQ=this.gl.createSampler(),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_WRAP_T,e.REPEAT)}bindTexture(e,t,r,i){if(this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,r,i,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}}bindTexture3D(e,t,r,i,n){if(this.gl.bindTexture(this.gl.TEXTURE_3D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage3D(this.gl.TEXTURE_3D,0,this.gl.RGBA,r,i,n,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_3D),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_3D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}}static fCubicInterpolate(e,t,r,i,n){const a=n*n,s=i-r-e+t;return s*(n*a)+(e-t-s)*a+(r-e)*n+t}static dwCubicInterpolate(e,t,r,n,a){const s=[];for(let o=0;o<4;o++){let l=i.fCubicInterpolate(e[o]/255,t[o]/255,r[o]/255,n[o]/255,a);l=Math.clamp(l,0,1),s[o]=255*l}return s}static createNoiseVolTex(e,t){const r=e*e*e,n=new Uint8Array(4*r),a=t>1?216:256,s=.5*a;for(let e=0;e<r;e++)n[4*e+0]=Math.floor(Math.random()*a+s),n[4*e+1]=Math.floor(Math.random()*a+s),n[4*e+2]=Math.floor(Math.random()*a+s),n[4*e+3]=Math.floor(Math.random()*a+s);const o=e*e,l=e;if(t>1){for(let r=0;r<e;r+=t)for(let a=0;a<e;a+=t)for(let s=0;s<e;s++)if(s%t!=0){const c=Math.floor(s/t)*t+e,u=r*o+a*l,h=[],d=[],f=[],m=[];for(let r=0;r<4;r++)h[r]=n[4*u+(c-t)%e*4+r],d[r]=n[4*u+c%e*4+r],f[r]=n[4*u+(c+t)%e*4+r],m[r]=n[4*u+(c+2*t)%e*4+r];const p=s%t/t,g=i.dwCubicInterpolate(h,d,f,m,p);for(let e=0;e<4;e++)n[r*o*4+a*l*4+(4*s+e)]=g[e]}for(let r=0;r<e;r+=t)for(let a=0;a<e;a++)for(let s=0;s<e;s++)if(s%t!=0){const c=Math.floor(s/t)*t+e,u=r*o,h=[],d=[],f=[],m=[];for(let r=0;r<4;r++){const i=4*a+4*u+r;h[r]=n[(c-t)%e*l*4+i],d[r]=n[c%e*l*4+i],f[r]=n[(c+t)%e*l*4+i],m[r]=n[(c+2*t)%e*l*4+i]}const p=s%t/t,g=i.dwCubicInterpolate(h,d,f,m,p);for(let e=0;e<4;e++)n[s*l*4+(4*a+4*u+e)]=g[e]}for(let r=0;r<e;r++)for(let a=0;a<e;a++)for(let s=0;s<e;s++)if(s%t!=0){const c=a*l,u=Math.floor(s/t)*t+e,h=[],d=[],f=[],m=[];for(let i=0;i<4;i++){const a=4*r+4*c+i;h[i]=n[(u-t)%e*o*4+a],d[i]=n[u%e*o*4+a],f[i]=n[(u+t)%e*o*4+a],m[i]=n[(u+2*t)%e*o*4+a]}const p=a%t/t,g=i.dwCubicInterpolate(h,d,f,m,p);for(let e=0;e<4;e++)n[s*o*4+(4*r+4*c+e)]=g[e]}}return n}static createNoiseTex(e,t){const r=e*e,n=new Uint8Array(4*r),a=t>1?216:256,s=.5*a;for(let e=0;e<r;e++)n[4*e+0]=Math.floor(Math.random()*a+s),n[4*e+1]=Math.floor(Math.random()*a+s),n[4*e+2]=Math.floor(Math.random()*a+s),n[4*e+3]=Math.floor(Math.random()*a+s);if(t>1){for(let r=0;r<e;r+=t)for(let a=0;a<e;a++)if(a%t!=0){const s=Math.floor(a/t)*t+e,o=r*e,l=[],c=[],u=[],h=[];for(let r=0;r<4;r++)l[r]=n[4*o+(s-t)%e*4+r],c[r]=n[4*o+s%e*4+r],u[r]=n[4*o+(s+t)%e*4+r],h[r]=n[4*o+(s+2*t)%e*4+r];const d=a%t/t,f=i.dwCubicInterpolate(l,c,u,h,d);for(let t=0;t<4;t++)n[r*e*4+4*a+t]=f[t]}for(let r=0;r<e;r++)for(let a=0;a<e;a++)if(a%t!=0){const s=Math.floor(a/t)*t+e,o=[],l=[],c=[],u=[];for(let i=0;i<4;i++)o[i]=n[(s-t)%e*e*4+4*r+i],l[i]=n[s%e*e*4+4*r+i],c[i]=n[(s+t)%e*e*4+4*r+i],u[i]=n[(s+2*t)%e*e*4+4*r+i];const h=a%t/t,d=i.dwCubicInterpolate(o,l,c,u,h);for(let t=0;t<4;t++)n[a*e*4+4*r+t]=d[t]}}return n}}},"./src/presetBase.js":function(e,t){var r=1e-5;window.sqr=function(e){return e*e},window.sqrt=function(e){return Math.sqrt(Math.abs(e))},window.log10=function(e){return Math.log(e)*Math.LOG10E},window.sign=function(e){return e>0?1:e<0?-1:0},window.rand=function(e){var t=Math.floor(e);return t<1?Math.random():Math.random()*t},window.randint=function(e){return Math.floor(rand(e))},window.bnot=function(e){return Math.abs(e)<r?1:0},window.pow=function(e,t){var r,i=Math.pow(e,t);return r=i,!isFinite(r)||isNaN(r)?0:i},window.div=function(e,t){return 0===t?0:e/t},window.mod=function(e,t){return 0===t?0:Math.floor(e)%Math.floor(t)},window.bitor=function(e,t){return Math.floor(e)|Math.floor(t)},window.bitand=function(e,t){return Math.floor(e)&Math.floor(t)},window.sigmoid=function(e,t){var i=1+Math.exp(-e*t);return Math.abs(i)>r?1/i:0},window.bor=function(e,t){return Math.abs(e)>r||Math.abs(t)>r?1:0},window.band=function(e,t){return Math.abs(e)>r&&Math.abs(t)>r?1:0},window.equal=function(e,t){return Math.abs(e-t)<r?1:0},window.above=function(e,t){return e>t?1:0},window.below=function(e,t){return e<t?1:0},window.ifcond=function(e,t,i){return Math.abs(e)>r?t:i},window.memcpy=function(e,t,r,i){let n=t,a=r,s=i;return a<0&&(s+=a,n-=a,a=0),n<0&&(s+=n,a-=n,n=0),s>0&&e.copyWithin(n,a,s),t}},"./src/rendering/blendPattern.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));class i{constructor(e){this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.vertInfoA=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.vertInfoC=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.createBlendPattern()}static resizeMatrixValues(e,t,r,i,n){const a=new Float32Array((i+1)*(n+1));let s=0;for(let o=0;o<n+1;o++)for(let l=0;l<i+1;l++){let c=l/n,u=o/i;c*=t+1,u*=r+1,c=Math.clamp(c,0,t-1),u=Math.clamp(u,0,r-1);const h=Math.floor(c),d=Math.floor(u),f=c-h,m=u-d,p=e[d*(t+1)+h],g=e[d*(t+1)+(h+1)],A=e[(d+1)*(t+1)+h],b=e[(d+1)*(t+1)+(h+1)];a[s]=p*(1-f)*(1-m)+g*f*(1-m)+A*(1-f)*m+b*f*m,s+=1}return a}updateGlobals(e){const t=this.mesh_width,r=this.mesh_height;this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.mesh_width===t&&this.mesh_height===r||(this.vertInfoA=i.resizeMatrixValues(this.vertInfoA,t,r,this.mesh_width,this.mesh_height),this.vertInfoC=i.resizeMatrixValues(this.vertInfoC,t,r,this.mesh_width,this.mesh_height))}genPlasma(e,t,r,i,n){const a=Math.floor((e+t)/2),s=Math.floor((r+i)/2);let o=this.vertInfoC[r*(this.mesh_width+1)+e],l=this.vertInfoC[r*(this.mesh_width+1)+t],c=this.vertInfoC[i*(this.mesh_width+1)+e],u=this.vertInfoC[i*(this.mesh_width+1)+t];i-r>=2&&(0===e&&(this.vertInfoC[s*(this.mesh_width+1)+e]=.5*(o+c)+(2*Math.random()-1)*n*this.aspecty),this.vertInfoC[s*(this.mesh_width+1)+t]=.5*(l+u)+(2*Math.random()-1)*n*this.aspecty),t-e>=2&&(0===r&&(this.vertInfoC[r*(this.mesh_width+1)+a]=.5*(o+l)+(2*Math.random()-1)*n*this.aspectx),this.vertInfoC[i*(this.mesh_width+1)+a]=.5*(c+u)+(2*Math.random()-1)*n*this.aspectx),i-r>=2&&t-e>=2&&(o=this.vertInfoC[s*(this.mesh_width+1)+e],l=this.vertInfoC[s*(this.mesh_width+1)+t],c=this.vertInfoC[r*(this.mesh_width+1)+a],u=this.vertInfoC[i*(this.mesh_width+1)+a],this.vertInfoC[s*(this.mesh_width+1)+a]=.25*(c+u+o+l)+(2*Math.random()-1)*n,this.genPlasma(e,a,r,s,.5*n),this.genPlasma(a,t,r,s,.5*n),this.genPlasma(e,a,s,i,.5*n),this.genPlasma(a,t,s,i,.5*n))}createBlendPattern(){const e=1+Math.floor(3*Math.random());if(0===e){let e=0;for(let t=0;t<=this.mesh_height;t++)for(let t=0;t<=this.mesh_width;t++)this.vertInfoA[e]=1,this.vertInfoC[e]=0,e+=1}else if(1===e){const e=6.28*Math.random(),t=Math.cos(e),r=Math.sin(e),i=.1+.2*Math.random(),n=1/i;let a=0;for(let e=0;e<=this.mesh_height;e++){const s=e/this.mesh_height*this.aspecty;for(let e=0;e<=this.mesh_width;e++){let o=(e/this.mesh_width*this.aspectx-.5)*t+(s-.5)*r+.5;o=(o-.5)/Math.sqrt(2)+.5,this.vertInfoA[a]=n*(1+i),this.vertInfoC[a]=n*o-n,a+=1}}}else if(2===e){const e=.12+.13*Math.random(),t=1/e;this.vertInfoC[0]=Math.random(),this.vertInfoC[this.mesh_width]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)+this.mesh_width]=Math.random(),this.genPlasma(0,this.mesh_width,0,this.mesh_height,.25);let r=this.vertInfoC[0],i=this.vertInfoC[0],n=0;for(let e=0;e<=this.mesh_height;e++)for(let e=0;e<=this.mesh_width;e++)r>this.vertInfoC[n]&&(r=this.vertInfoC[n]),i<this.vertInfoC[n]&&(i=this.vertInfoC[n]),n+=1;const a=1/(i-r);n=0;for(let i=0;i<=this.mesh_height;i++)for(let i=0;i<=this.mesh_width;i++){const i=(this.vertInfoC[n]-r)*a;this.vertInfoA[n]=t*(1+e),this.vertInfoC[n]=t*i-t,n+=1}}else if(3===e){const e=.02+.14*Math.random()+.34*Math.random(),t=1/e,r=2*Math.floor(2*Math.random())-1;let i=0;for(let n=0;n<=this.mesh_height;n++){const a=(n/this.mesh_height-.5)*this.aspecty;for(let n=0;n<=this.mesh_width;n++){const s=(n/this.mesh_width-.5)*this.aspectx;let o=1.41421*Math.sqrt(s*s+a*a);-1===r&&(o=1-o),this.vertInfoA[i]=t*(1+e),this.vertInfoC[i]=t*o-t,i+=1}}}}}},"./src/rendering/motionVectors/motionVectors.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/rendering/shaders/shaderUtils.js");class n{constructor(e,t){this.gl=e,this.maxX=64,this.maxY=48,this.positions=new Float32Array(this.maxX*this.maxY*2*3),this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.positionVertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      void main(void) {\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 u_color;\n      void main(void) {\n        fragColor = u_color;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}getMotionDir(e,t,r){const i=Math.floor(r*this.mesh_height),n=r*this.mesh_height-i,a=Math.floor(t*this.mesh_width),s=t*this.mesh_width-a,o=a+1,l=i+1,c=this.mesh_width+1;let u,h;return u=e[2*(i*c+a)+0]*(1-s)*(1-n),h=e[2*(i*c+a)+1]*(1-s)*(1-n),u+=e[2*(i*c+o)+0]*s*(1-n),h+=e[2*(i*c+o)+1]*s*(1-n),u+=e[2*(l*c+a)+0]*(1-s)*n,h+=e[2*(l*c+a)+1]*(1-s)*n,u+=e[2*(l*c+o)+0]*s*n,h+=e[2*(l*c+o)+1]*s*n,[u,1-h]}generateMotionVectors(e,t){const r=0===e.bmotionvectorson?0:e.mv_a;let i=Math.floor(e.mv_x),n=Math.floor(e.mv_y);if(r>.001&&i>0&&n>0){let a=e.mv_x-i,s=e.mv_y-n;i>this.maxX&&(i=this.maxX,a=0),n>this.maxY&&(n=this.maxY,s=0);const o=e.mv_dx,l=e.mv_dy,c=e.mv_l,u=1/this.texsizeX;this.numVecVerts=0;for(let e=0;e<n;e++){let r=(e+.25)/(n+s+.25-1);if(r-=l,r>1e-4&&r<.9999)for(let e=0;e<i;e++){let n=(e+.25)/(i+a+.25-1);if(n+=o,n>1e-4&&n<.9999){const e=this.getMotionDir(t,n,r);let i=e[0],a=e[1],s=i-n,o=a-r;s*=c,o*=c;let l=Math.sqrt(s*s+o*o);l<u&&l>1e-8?(l=u/l,s*=l,o*=l):(s=u,s=u),i=n+s,a=r+o;const h=2*n-1,d=2*r-1,f=2*i-1,m=2*a-1;this.positions[3*this.numVecVerts+0]=h,this.positions[3*this.numVecVerts+1]=d,this.positions[3*this.numVecVerts+2]=0,this.positions[3*(this.numVecVerts+1)+0]=f,this.positions[3*(this.numVecVerts+1)+1]=m,this.positions[3*(this.numVecVerts+1)+2]=0,this.numVecVerts+=2}}}if(this.numVecVerts>0)return this.color=[e.mv_r,e.mv_g,e.mv_b,r],!0}return!1}drawMotionVectors(e,t){this.generateMotionVectors(e,t)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color),this.gl.lineWidth(1),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.LINES,0,this.numVecVerts))}}},"./src/rendering/renderer.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return T}));var i=r("./src/audio/audioLevels.js"),n=r("./src/blankPreset.js"),a=r.n(n),s=r("./src/equations/presetEquationRunner.js"),o=r("./src/equations/presetEquationRunnerWASM.js"),l=r("./src/rendering/waves/basicWaveform.js"),c=r("./src/rendering/waves/customWaveform.js"),u=r("./src/rendering/shapes/customShape.js"),h=r("./src/rendering/sprites/border.js"),d=r("./src/rendering/sprites/darkenCenter.js"),f=r("./src/rendering/motionVectors/motionVectors.js"),m=r("./src/rendering/shaders/warp.js"),p=r("./src/rendering/shaders/comp.js"),g=r("./src/rendering/shaders/output.js"),A=r("./src/rendering/shaders/resample.js"),b=r("./src/rendering/shaders/blur/blur.js"),v=r("./src/noise/noise.js"),y=r("./src/image/imageTextures.js"),w=r("./src/rendering/text/titleText.js"),E=r("./src/rendering/blendPattern.js"),_=r("./src/utils.js");class T{constructor(e,t,r){this.gl=e,this.audio=t,this.frameNum=0,this.fps=30,this.time=0,this.presetTime=0,this.lastTime=performance.now(),this.timeHist=[0],this.timeHistMax=120,this.blending=!1,this.blendStartTime=0,this.blendProgress=0,this.blendDuration=0,this.width=r.width||1200,this.height=r.height||900,this.mesh_width=r.meshWidth||48,this.mesh_height=r.meshHeight||36,this.pixelRatio=r.pixelRatio||window.devicePixelRatio||1,this.textureRatio=r.textureRatio||1,this.outputFXAA=r.outputFXAA||!1,this.texsizeX=this.width*this.pixelRatio*this.textureRatio,this.texsizeY=this.height*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=_.default.range(1,33).map((e=>`q${e}`)),this.ts=_.default.range(1,9).map((e=>`t${e}`)),this.regs=_.default.range(0,100).map((e=>e<10?`reg0${e}`:`reg${e}`)),this.blurRatios=[[.5,.25],[.125,.125],[.0625,.0625]],this.audioLevels=new i.default(this.audio),this.prevFrameBuffer=this.gl.createFramebuffer(),this.targetFrameBuffer=this.gl.createFramebuffer(),this.prevTexture=this.gl.createTexture(),this.targetTexture=this.gl.createTexture(),this.compFrameBuffer=this.gl.createFramebuffer(),this.compTexture=this.gl.createTexture(),this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.targetFrameBuffer,this.targetTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture);const n={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.noise=new v.default(e),this.image=new y.default(e),this.warpShader=new m.default(e,this.noise,this.image,n),this.compShader=new p.default(e,this.noise,this.image,n),this.outputShader=new g.default(e,n),this.prevWarpShader=new m.default(e,this.noise,this.image,n),this.prevCompShader=new p.default(e,this.noise,this.image,n),this.numBlurPasses=0,this.blurShader1=new b.default(0,this.blurRatios,e,n),this.blurShader2=new b.default(1,this.blurRatios,e,n),this.blurShader3=new b.default(2,this.blurRatios,e,n),this.blurTexture1=this.blurShader1.blurVerticalTexture,this.blurTexture2=this.blurShader2.blurVerticalTexture,this.blurTexture3=this.blurShader3.blurVerticalTexture,this.basicWaveform=new l.default(e,n),this.customWaveforms=_.default.range(4).map((t=>new c.default(t,e,n))),this.customShapes=_.default.range(4).map((t=>new u.default(t,e,n))),this.prevCustomWaveforms=_.default.range(4).map((t=>new c.default(t,e,n))),this.prevCustomShapes=_.default.range(4).map((t=>new u.default(t,e,n))),this.darkenCenter=new d.default(e,n),this.innerBorder=new h.default(e,n),this.outerBorder=new h.default(e,n),this.motionVectors=new f.default(e,n),this.titleText=new w.default(e,n),this.blendPattern=new E.default(n),this.resampleShader=new A.default(e),this.supertext={startTime:-1},this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4),this.gl.clearColor(0,0,0,1),this.blankPreset=a.a;const o={frame:0,time:0,fps:45,bass:1,bass_att:1,mid:1,mid_att:1,treb:1,treb_att:1};this.preset=a.a,this.prevPreset=this.preset,this.presetEquationRunner=new s.default(this.preset,o,n),this.prevPresetEquationRunner=new s.default(this.prevPreset,o,n),this.preset.useWASM||(this.regVars=this.presetEquationRunner.mdVSRegs)}static getHighestBlur(e){return/sampler_blur3/.test(e)?3:/sampler_blur2/.test(e)?2:/sampler_blur1/.test(e)?1:0}loadPreset(e,t){this.blendPattern.createBlendPattern(),this.blending=!0,this.blendStartTime=this.time,this.blendDuration=t,this.blendProgress=0,this.prevPresetEquationRunner=this.presetEquationRunner,this.prevPreset=this.preset,this.preset=e,this.presetTime=this.time;const r={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att},i={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};e.useWASM?(this.preset.globalPools.perFrame.old_wave_mode.value=this.prevPreset.baseVals.wave_mode,this.preset.baseVals.old_wave_mode=this.prevPreset.baseVals.wave_mode,this.presetEquationRunner=new o.default(this.preset,r,i),this.preset.pixel_eqs_initialize_array&&this.preset.pixel_eqs_initialize_array(this.mesh_width,this.mesh_height)):(this.preset.baseVals.old_wave_mode=this.prevPreset.baseVals.wave_mode,this.presetEquationRunner=new s.default(this.preset,r,i),this.regVars=this.presetEquationRunner.mdVSRegs);const n=this.prevWarpShader;this.prevWarpShader=this.warpShader,this.warpShader=n;const a=this.prevCompShader;this.prevCompShader=this.compShader,this.compShader=a;const l=this.preset.warp.trim(),c=this.preset.comp.trim();this.warpShader.updateShader(l),this.compShader.updateShader(c),0===l.length?this.numBlurPasses=0:this.numBlurPasses=T.getHighestBlur(l),0!==c.length&&(this.numBlurPasses=Math.max(this.numBlurPasses,T.getHighestBlur(c)))}loadExtraImages(e){this.image.loadExtraImages(e)}setRendererSize(e,t,r){const i=this.texsizeX,n=this.texsizeY;if(this.width=e,this.height=t,this.mesh_width=r.meshWidth||this.mesh_width,this.mesh_height=r.meshHeight||this.mesh_height,this.pixelRatio=r.pixelRatio||this.pixelRatio,this.textureRatio=r.textureRatio||this.textureRatio,this.texsizeX=e*this.pixelRatio*this.textureRatio,this.texsizeY=t*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.texsizeX!==i||this.texsizeY!==n){const e=this.gl.createTexture();this.bindFrameBufferTexture(this.targetFrameBuffer,e),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.resampleShader.renderQuadTexture(this.targetTexture),this.targetTexture=e,this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture)}this.updateGlobals(),this.frameNum>0&&this.renderToScreen()}setInternalMeshSize(e,t){this.mesh_width=e,this.mesh_height=t,this.updateGlobals()}setOutputAA(e){this.outputFXAA=e}updateGlobals(){const e={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.presetEquationRunner.updateGlobals(e),this.prevPresetEquationRunner.updateGlobals(e),this.warpShader.updateGlobals(e),this.prevWarpShader.updateGlobals(e),this.compShader.updateGlobals(e),this.prevCompShader.updateGlobals(e),this.outputShader.updateGlobals(e),this.blurShader1.updateGlobals(e),this.blurShader2.updateGlobals(e),this.blurShader3.updateGlobals(e),this.basicWaveform.updateGlobals(e),this.customWaveforms.forEach((t=>t.updateGlobals(e))),this.customShapes.forEach((t=>t.updateGlobals(e))),this.prevCustomWaveforms.forEach((t=>t.updateGlobals(e))),this.prevCustomShapes.forEach((t=>t.updateGlobals(e))),this.darkenCenter.updateGlobals(e),this.innerBorder.updateGlobals(e),this.outerBorder.updateGlobals(e),this.motionVectors.updateGlobals(e),this.titleText.updateGlobals(e),this.blendPattern.updateGlobals(e),this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4),this.preset.pixel_eqs_initialize_array&&this.preset.pixel_eqs_initialize_array(this.mesh_width,this.mesh_height)}calcTimeAndFPS(e){let t;if(e)t=e;else{const e=performance.now();t=(e-this.lastTime)/1e3,(t>1||t<0||this.frame<2)&&(t=1/30),this.lastTime=e}this.time+=1/this.fps,this.blending&&(this.blendProgress=(this.time-this.blendStartTime)/this.blendDuration,this.blendProgress>1&&(this.blending=!1));const r=this.timeHist[this.timeHist.length-1]+t;this.timeHist.push(r),this.timeHist.length>this.timeHistMax&&this.timeHist.shift();const i=this.timeHist.length/(r-this.timeHist[0]);if(Math.abs(i-this.fps)>3&&this.frame>this.timeHistMax)this.fps=i;else{const e=.93;this.fps=e*this.fps+(1-e)*i}}runPixelEquations(e,t,r,i){const n=this.mesh_width,a=this.mesh_height,s=n+1,o=a+1,l=this.time*t.warpanimspeed,c=1/t.warpscale,u=11.68+4*Math.cos(1.413*l+10),h=8.77+3*Math.cos(1.113*l+7),d=10.54+3*Math.cos(1.233*l+3),f=11.49+4*Math.cos(.933*l+5),m=0/this.texsizeX,p=0/this.texsizeY,g=this.aspectx,A=this.aspecty;let b=0,v=0;if(e.preset.useWASM){const n=e.preset.globalPools.perVertex;if(_.default.setWasm(n,r,e.globalKeys),_.default.setWasm(n,e.mdVSQAfterFrame,e.qs),n.zoom.value=t.zoom,n.zoomexp.value=t.zoomexp,n.rot.value=t.rot,n.warp.value=t.warp,n.cx.value=t.cx,n.cy.value=t.cy,n.dx.value=t.dx,n.dy.value=t.dy,n.sx.value=t.sx,n.sy.value=t.sy,e.preset.pixel_eqs_wasm(e.runVertEQs,this.mesh_width,this.mesh_height,this.time,t.warpanimspeed,t.warpscale,this.aspectx,this.aspecty),i){const t=e.preset.pixel_eqs_get_array();let r=0,i=0;for(let e=0;e<o;e++)for(let e=0;e<s;e++){const e=t[r],n=t[r+1];let a=this.blendPattern.vertInfoA[r/2]*this.blendProgress+this.blendPattern.vertInfoC[r/2];a=Math.clamp(a,0,1),this.warpUVs[r]=this.warpUVs[r]*a+e*(1-a),this.warpUVs[r+1]=this.warpUVs[r+1]*a+n*(1-a),this.warpColor[i+0]=1,this.warpColor[i+1]=1,this.warpColor[i+2]=1,this.warpColor[i+3]=a,r+=2,i+=4}}else this.warpUVs=e.preset.pixel_eqs_get_array(),this.warpColor.fill(1)}else{let r=_.default.cloneVars(t),y=r.warp,w=r.zoom,E=r.zoomexp,T=r.cx,S=r.cy,x=r.sx,k=r.sy,I=r.dx,C=r.dy,P=r.rot;for(let M=0;M<o;M++)for(let o=0;o<s;o++){const s=o/n*2-1,R=M/a*2-1,B=Math.sqrt(s*s*g*g+R*R*A*A);if(e.runVertEQs){let i;i=M===a/2&&o===n/2?0:_.default.atan2(R*A,s*g),r.x=.5*s*g+.5,r.y=-.5*R*A+.5,r.rad=B,r.ang=i,r.zoom=t.zoom,r.zoomexp=t.zoomexp,r.rot=t.rot,r.warp=t.warp,r.cx=t.cx,r.cy=t.cy,r.dx=t.dx,r.dy=t.dy,r.sx=t.sx,r.sy=t.sy,r=e.runPixelEquations(r),y=r.warp,w=r.zoom,E=r.zoomexp,T=r.cx,S=r.cy,x=r.sx,k=r.sy,I=r.dx,C=r.dy,P=r.rot}const L=1/w**(E**(2*B-1));let D=.5*s*g*L+.5,N=.5*-R*A*L+.5;D=(D-T)/x+T,N=(N-S)/k+S,0!==y&&(D+=.0035*y*Math.sin(.333*l+c*(s*u-R*f)),N+=.0035*y*Math.cos(.375*l-c*(s*d+R*h)),D+=.0035*y*Math.cos(.753*l-c*(s*h-R*d)),N+=.0035*y*Math.sin(.825*l+c*(s*u+R*f)));const F=D-T,O=N-S,z=Math.cos(P),U=Math.sin(P);if(D=F*z-O*U+T,N=F*U+O*z+S,D-=I,N-=C,D=(D-.5)/g+.5,N=(N-.5)/A+.5,D+=m,N+=p,i){let e=this.blendPattern.vertInfoA[b/2]*this.blendProgress+this.blendPattern.vertInfoC[b/2];e=Math.clamp(e,0,1),this.warpUVs[b]=this.warpUVs[b]*e+D*(1-e),this.warpUVs[b+1]=this.warpUVs[b+1]*e+N*(1-e),this.warpColor[v+0]=1,this.warpColor[v+1]=1,this.warpColor[v+2]=1,this.warpColor[v+3]=e}else this.warpUVs[b]=D,this.warpUVs[b+1]=N,this.warpColor[v+0]=1,this.warpColor[v+1]=1,this.warpColor[v+2]=1,this.warpColor[v+3]=1;b+=2,v+=4}this.mdVSVertex=r}}static mixFrameEquations(e,t,r){const i=.5-.5*Math.cos(e*Math.PI),n=1-i,a=.5,s=_.default.cloneVars(t);return s.decay=i*t.decay+n*r.decay,s.wave_a=i*t.wave_a+n*r.wave_a,s.wave_r=i*t.wave_r+n*r.wave_r,s.wave_g=i*t.wave_g+n*r.wave_g,s.wave_b=i*t.wave_b+n*r.wave_b,s.wave_x=i*t.wave_x+n*r.wave_x,s.wave_y=i*t.wave_y+n*r.wave_y,s.wave_mystery=i*t.wave_mystery+n*r.wave_mystery,s.ob_size=i*t.ob_size+n*r.ob_size,s.ob_r=i*t.ob_r+n*r.ob_r,s.ob_g=i*t.ob_g+n*r.ob_g,s.ob_b=i*t.ob_b+n*r.ob_b,s.ob_a=i*t.ob_a+n*r.ob_a,s.ib_size=i*t.ib_size+n*r.ib_size,s.ib_r=i*t.ib_r+n*r.ib_r,s.ib_g=i*t.ib_g+n*r.ib_g,s.ib_b=i*t.ib_b+n*r.ib_b,s.ib_a=i*t.ib_a+n*r.ib_a,s.mv_x=i*t.mv_x+n*r.mv_x,s.mv_y=i*t.mv_y+n*r.mv_y,s.mv_dx=i*t.mv_dx+n*r.mv_dx,s.mv_dy=i*t.mv_dy+n*r.mv_dy,s.mv_l=i*t.mv_l+n*r.mv_l,s.mv_r=i*t.mv_r+n*r.mv_r,s.mv_g=i*t.mv_g+n*r.mv_g,s.mv_b=i*t.mv_b+n*r.mv_b,s.mv_a=i*t.mv_a+n*r.mv_a,s.echo_zoom=i*t.echo_zoom+n*r.echo_zoom,s.echo_alpha=i*t.echo_alpha+n*r.echo_alpha,s.echo_orient=i*t.echo_orient+n*r.echo_orient,s.wave_dots=i<a?r.wave_dots:t.wave_dots,s.wave_thick=i<a?r.wave_thick:t.wave_thick,s.additivewave=i<a?r.additivewave:t.additivewave,s.wave_brighten=i<a?r.wave_brighten:t.wave_brighten,s.darken_center=i<a?r.darken_center:t.darken_center,s.gammaadj=i<a?r.gammaadj:t.gammaadj,s.wrap=i<a?r.wrap:t.wrap,s.invert=i<a?r.invert:t.invert,s.brighten=i<a?r.brighten:t.brighten,s.darken=i<a?r.darken:t.darken,s.solarize=i<a?r.brighten:t.solarize,s.b1n=i*t.b1n+n*r.b1n,s.b2n=i*t.b2n+n*r.b2n,s.b3n=i*t.b3n+n*r.b3n,s.b1x=i*t.b1x+n*r.b1x,s.b2x=i*t.b2x+n*r.b2x,s.b3x=i*t.b3x+n*r.b3x,s.b1ed=i*t.b1ed+n*r.b1ed,s}static getBlurValues(e){let t=e.b1n,r=e.b2n,i=e.b3n,n=e.b1x,a=e.b2x,s=e.b3x;if(n-t<.1){const e=.5*(t+n);t=e-.05,n=e-.05}if(a=Math.min(n,a),r=Math.max(t,r),a-r<.1){const e=.5*(r+a);r=e-.05,a=e-.05}if(s=Math.min(a,s),i=Math.max(r,i),s-i<.1){const e=.5*(i+s);i=e-.05,s=e-.05}return{blurMins:[t,r,i],blurMaxs:[n,a,s]}}bindFrambufferAndSetViewport(e,t,r){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.viewport(0,0,t,r)}bindFrameBufferTexture(e,t){if(this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(this.texsizeX*this.texsizeY*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,t,0)}render({audioLevels:e,elapsedTime:t}={}){this.calcTimeAndFPS(t),this.frameNum+=1,e?this.audio.updateAudio(e.timeByteArray,e.timeByteArrayL,e.timeByteArrayR):this.audio.sampleAudio(),this.audioLevels.updateAudioLevels(this.fps,this.frameNum);const r={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY},i=Object.assign({},r);this.prevPreset.useWASM||(i.gmegabuf=this.prevPresetEquationRunner.gmegabuf),this.preset.useWASM||(r.gmegabuf=this.presetEquationRunner.gmegabuf,Object.assign(r,this.regVars));const n=this.presetEquationRunner.runFrameEquations(r);let a;this.runPixelEquations(this.presetEquationRunner,n,r,!1),this.preset.useWASM||(Object.assign(this.regVars,_.default.pick(this.mdVSVertex,this.regs)),Object.assign(r,this.regVars)),this.blending?(this.prevMDVSFrame=this.prevPresetEquationRunner.runFrameEquations(i),this.runPixelEquations(this.prevPresetEquationRunner,this.prevMDVSFrame,i,!0),a=T.mixFrameEquations(this.blendProgress,n,this.prevMDVSFrame)):a=n;const s=this.targetTexture;this.targetTexture=this.prevTexture,this.prevTexture=s;const o=this.targetFrameBuffer;this.targetFrameBuffer=this.prevFrameBuffer,this.prevFrameBuffer=o,this.gl.bindTexture(this.gl.TEXTURE_2D,this.prevTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const{blurMins:l,blurMaxs:c}=T.getBlurValues(a);this.blending?(this.prevWarpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,l,c,this.prevMDVSFrame,this.prevPresetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor),this.warpShader.renderQuadTexture(!0,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,l,c,a,this.presetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor)):this.warpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,l,c,n,this.presetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor),this.numBlurPasses>0&&(this.blurShader1.renderBlurTexture(this.targetTexture,n,l,c),this.numBlurPasses>1&&(this.blurShader2.renderBlurTexture(this.blurTexture1,n,l,c),this.numBlurPasses>2&&this.blurShader3.renderBlurTexture(this.blurTexture2,n,l,c)),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY)),this.motionVectors.drawMotionVectors(a,this.warpUVs),this.preset.shapes&&this.preset.shapes.length>0&&this.customShapes.forEach(((e,t)=>{e.drawCustomShape(this.blending?this.blendProgress:1,r,this.presetEquationRunner,this.preset.shapes[t],this.prevTexture)})),this.preset.waves&&this.preset.waves.length>0&&this.customWaveforms.forEach(((e,t)=>{e.drawCustomWaveform(this.blending?this.blendProgress:1,this.audio.timeArrayL,this.audio.timeArrayR,this.audio.freqArrayL,this.audio.freqArrayR,r,this.presetEquationRunner,this.preset.waves[t])})),this.blending&&(this.prevPreset.shapes&&this.prevPreset.shapes.length>0&&this.prevCustomShapes.forEach(((e,t)=>{e.drawCustomShape(1-this.blendProgress,i,this.prevPresetEquationRunner,this.prevPreset.shapes[t],this.prevTexture)})),this.prevPreset.waves&&this.prevPreset.waves.length>0&&this.prevCustomWaveforms.forEach(((e,t)=>{e.drawCustomWaveform(1-this.blendProgress,this.audio.timeArrayL,this.audio.timeArrayR,this.audio.freqArrayL,this.audio.freqArrayR,i,this.prevPresetEquationRunner,this.prevPreset.waves[t])}))),this.basicWaveform.drawBasicWaveform(this.blending,this.blendProgress,this.audio.timeArrayL,this.audio.timeArrayR,a),this.darkenCenter.drawDarkenCenter(a);const u=[a.ob_r,a.ob_g,a.ob_b,a.ob_a];this.outerBorder.drawBorder(u,a.ob_size,0);const h=[a.ib_r,a.ib_g,a.ib_b,a.ib_a];if(this.innerBorder.drawBorder(h,a.ib_size,a.ob_size),this.supertext.startTime>=0){const e=(this.time-this.supertext.startTime)/this.supertext.duration;e>=1&&this.titleText.renderTitle(e,!0,r)}this.globalVars=r,this.mdVSFrame=n,this.mdVSFrameMixed=a,this.renderToScreen()}renderToScreen(){this.outputFXAA?this.bindFrambufferAndSetViewport(this.compFrameBuffer,this.texsizeX,this.texsizeY):this.bindFrambufferAndSetViewport(null,this.width,this.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const{blurMins:e,blurMaxs:t}=T.getBlurValues(this.mdVSFrameMixed);if(this.blending?(this.prevCompShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,e,t,this.prevMDVSFrame,this.prevPresetEquationRunner.mdVSQAfterFrame,this.warpColor),this.compShader.renderQuadTexture(!0,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,e,t,this.mdVSFrameMixed,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor)):this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,e,t,this.mdVSFrame,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor),this.supertext.startTime>=0){const e=(this.time-this.supertext.startTime)/this.supertext.duration;this.titleText.renderTitle(e,!1,this.globalVars),e>=1&&(this.supertext.startTime=-1)}this.outputFXAA&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.compTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(null,this.width,this.height),this.outputShader.renderQuadTexture(this.compTexture))}launchSongTitleAnim(e){this.supertext={startTime:this.time,duration:1.7},this.titleText.generateTitleTexture(e)}toDataURL(){const e=new Uint8Array(this.texsizeX*this.texsizeY*4),t=this.gl.createFramebuffer(),r=this.gl.createTexture();this.bindFrameBufferTexture(t,r);const{blurMins:i,blurMaxs:n}=T.getBlurValues(this.mdVSFrameMixed);this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,i,n,this.mdVSFrame,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),Array.from({length:this.texsizeY},((t,r)=>e.slice(r*this.texsizeX*4,(r+1)*this.texsizeX*4))).forEach(((t,r)=>e.set(t,(this.texsizeY-r-1)*this.texsizeX*4)));const a=document.createElement("canvas");a.width=this.texsizeX,a.height=this.texsizeY;const s=a.getContext("2d"),o=s.createImageData(this.texsizeX,this.texsizeY);return o.data.set(e),s.putImageData(o,0,0),this.gl.deleteTexture(r),this.gl.deleteFramebuffer(t),a.toDataURL()}warpBufferToDataURL(){const e=new Uint8Array(this.texsizeX*this.texsizeY*4);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.targetFrameBuffer),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);const t=document.createElement("canvas");t.width=this.texsizeX,t.height=this.texsizeY;const r=t.getContext("2d"),i=r.createImageData(this.texsizeX,this.texsizeY);return i.data.set(e),r.putImageData(i,0,0),t.toDataURL()}}},"./src/rendering/shaders/blur/blur.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var i=r("./src/rendering/shaders/blur/blurVertical.js"),n=r("./src/rendering/shaders/blur/blurHorizontal.js");class a{constructor(e,t,r,a={}){this.blurLevel=e,this.blurRatios=t,this.gl=r,this.texsizeX=a.texsizeX,this.texsizeY=a.texsizeY,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.blurHorizontalFrameBuffer=this.gl.createFramebuffer(),this.blurVerticalFrameBuffer=this.gl.createFramebuffer(),this.blurHorizontalTexture=this.gl.createTexture(),this.blurVerticalTexture=this.gl.createTexture(),this.setupFrameBufferTextures(),this.blurHorizontal=new n.default(r,this.blurLevel,a),this.blurVertical=new i.default(r,this.blurLevel,a)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.setupFrameBufferTextures()}getTextureSize(e){let t=Math.max(this.texsizeX*e,16);t=16*Math.floor((t+3)/16);let r=Math.max(this.texsizeY*e,16);return r=4*Math.floor((r+3)/4),[t,r]}setupFrameBufferTextures(){const e=this.blurLevel>0?this.blurRatios[this.blurLevel-1]:[1,1],t=this.blurRatios[this.blurLevel],r=this.getTextureSize(e[1]),i=this.getTextureSize(t[0]);this.bindFrameBufferTexture(this.blurHorizontalFrameBuffer,this.blurHorizontalTexture,i);const n=i,a=this.getTextureSize(t[1]);this.bindFrameBufferTexture(this.blurVerticalFrameBuffer,this.blurVerticalTexture,a),this.horizontalTexsizes=[r,i],this.verticalTexsizes=[n,a]}bindFrambufferAndSetViewport(e,t){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.viewport(0,0,t[0],t[1])}bindFrameBufferTexture(e,t,r){if(this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,r[0],r[1],0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(r[0]*r[1]*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,t,0)}renderBlurTexture(e,t,r,i){this.bindFrambufferAndSetViewport(this.blurHorizontalFrameBuffer,this.horizontalTexsizes[1]),this.blurHorizontal.renderQuadTexture(e,t,r,i,this.horizontalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurHorizontalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.blurVerticalFrameBuffer,this.verticalTexsizes[1]),this.blurVertical.renderQuadTexture(this.blurHorizontalTexture,t,this.verticalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurVerticalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D)}}},"./src/rendering/shaders/blur/blurHorizontal.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/rendering/shaders/shaderUtils.js");class n{constructor(e,t){this.gl=e,this.blurLevel=t;const r=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],n=r[0]+r[1],a=r[2]+r[3],s=r[4]+r[5],o=r[6]+r[7],l=0+2*r[1]/n,c=2+2*r[3]/a,u=4+2*r[5]/s,h=6+2*r[7]/o;this.ws=new Float32Array([n,a,s,o]),this.ds=new Float32Array([l,c,u,h]),this.wDiv=.5/(n+a+s+o),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      out vec2 uv;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        uv = aPos * halfmad + halfmad;\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n       uniform vec4 texsize;\n       uniform float scale;\n       uniform float bias;\n       uniform vec4 ws;\n       uniform vec4 ds;\n       uniform float wdiv;\n\n       void main(void) {\n         float w1 = ws[0];\n         float w2 = ws[1];\n         float w3 = ws[2];\n         float w4 = ws[3];\n         float d1 = ds[0];\n         float d2 = ds[1];\n         float d3 = ds[2];\n         float d4 = ds[3];\n\n         vec2 uv2 = uv.xy;\n\n         vec3 blur =\n           ( texture(uTexture, uv2 + vec2( d1 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d1 * texsize.z,0.0) ).xyz) * w1 +\n           ( texture(uTexture, uv2 + vec2( d2 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d2 * texsize.z,0.0) ).xyz) * w2 +\n           ( texture(uTexture, uv2 + vec2( d3 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d3 * texsize.z,0.0) ).xyz) * w3 +\n           ( texture(uTexture, uv2 + vec2( d4 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d4 * texsize.z,0.0) ).xyz) * w4;\n\n         blur.xyz *= wdiv;\n         blur.xyz = blur.xyz * scale + bias;\n\n         fragColor = vec4(blur, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.scaleLoc=this.gl.getUniformLocation(this.shaderProgram,"scale"),this.biasLoc=this.gl.getUniformLocation(this.shaderProgram,"bias"),this.wsLoc=this.gl.getUniformLocation(this.shaderProgram,"ws"),this.dsLocation=this.gl.getUniformLocation(this.shaderProgram,"ds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}getScaleAndBias(e,t){const r=[1,1,1],i=[0,0,0];let n,a;return r[0]=1/(t[0]-e[0]),i[0]=-e[0]*r[0],n=(e[1]-e[0])/(t[0]-e[0]),a=(t[1]-e[0])/(t[0]-e[0]),r[1]=1/(a-n),i[1]=-n*r[1],n=(e[2]-e[1])/(t[1]-e[1]),a=(t[2]-e[1])/(t[1]-e[1]),r[2]=1/(a-n),i[2]=-n*r[2],{scale:r[this.blurLevel],bias:i[this.blurLevel]}}renderQuadTexture(e,t,r,i,n){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(this.textureLoc,0);const{scale:a,bias:s}=this.getScaleAndBias(r,i);this.gl.uniform4fv(this.texsizeLocation,[n[0],n[1],1/n[0],1/n[1]]),this.gl.uniform1f(this.scaleLoc,a),this.gl.uniform1f(this.biasLoc,s),this.gl.uniform4fv(this.wsLoc,this.ws),this.gl.uniform4fv(this.dsLocation,this.ds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/blur/blurVertical.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/rendering/shaders/shaderUtils.js");class n{constructor(e,t){this.gl=e,this.blurLevel=t;const r=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],n=r[0]+r[1]+r[2]+r[3],a=r[4]+r[5]+r[6]+r[7],s=0+(r[2]+r[3])/n*2,o=2+(r[6]+r[7])/a*2;this.wds=new Float32Array([n,a,s,o]),this.wDiv=1/(2*(n+a)),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      out vec2 uv;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        uv = aPos * halfmad + halfmad;\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n       uniform vec4 texsize;\n       uniform float ed1;\n       uniform float ed2;\n       uniform float ed3;\n       uniform vec4 wds;\n       uniform float wdiv;\n\n       void main(void) {\n         float w1 = wds[0];\n         float w2 = wds[1];\n         float d1 = wds[2];\n         float d2 = wds[3];\n\n         vec2 uv2 = uv.xy;\n\n         vec3 blur =\n           ( texture(uTexture, uv2 + vec2(0.0, d1 * texsize.w) ).xyz\n           + texture(uTexture, uv2 + vec2(0.0,-d1 * texsize.w) ).xyz) * w1 +\n           ( texture(uTexture, uv2 + vec2(0.0, d2 * texsize.w) ).xyz\n           + texture(uTexture, uv2 + vec2(0.0,-d2 * texsize.w) ).xyz) * w2;\n\n         blur.xyz *= wdiv;\n\n         float t = min(min(uv.x, uv.y), 1.0 - max(uv.x, uv.y));\n         t = sqrt(t);\n         t = ed1 + ed2 * clamp(t * ed3, 0.0, 1.0);\n         blur.xyz *= t;\n\n         fragColor = vec4(blur, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.ed1Loc=this.gl.getUniformLocation(this.shaderProgram,"ed1"),this.ed2Loc=this.gl.getUniformLocation(this.shaderProgram,"ed2"),this.ed3Loc=this.gl.getUniformLocation(this.shaderProgram,"ed3"),this.wdsLocation=this.gl.getUniformLocation(this.shaderProgram,"wds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}renderQuadTexture(e,t,r){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(this.textureLoc,0);const i=0===this.blurLevel?t.b1ed:0;this.gl.uniform4fv(this.texsizeLocation,[r[0],r[1],1/r[0],1/r[1]]),this.gl.uniform1f(this.ed1Loc,1-i),this.gl.uniform1f(this.ed2Loc,i),this.gl.uniform1f(this.ed3Loc,5),this.gl.uniform4fv(this.wdsLocation,this.wds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/comp.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/rendering/shaders/shaderUtils.js");class n{constructor(e,t,r,n={}){this.gl=e,this.noise=t,this.image=r,this.mesh_width=n.mesh_width,this.mesh_height=n.mesh_height,this.texsizeX=n.texsizeX,this.texsizeY=n.texsizeY,this.aspectx=n.aspectx,this.aspecty=n.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.compWidth=32,this.compHeight=24,this.buildPositions(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.compColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),e.samplerParameteri(this.mainSampler,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}buildPositions(){const e=this.compWidth,t=this.compHeight,r=e+1,i=t+1,n=2/e,a=2/t,s=[];for(let e=0;e<i;e++){const t=e*a-1;for(let e=0;e<r;e++){const r=e*n-1;s.push(r,-t,0)}}const o=[];for(let i=0;i<t;i++)for(let t=0;t<e;t++){const e=t+r*i,n=t+r*(i+1),a=t+1+r*(i+1),s=t+1+r*i;o.push(e,n,s),o.push(n,a,s)}this.vertices=new Float32Array(s),this.indices=new Uint16Array(o)}updateGlobals(e){this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}createShader(e=""){let t,r;if(0===e.length)t="float orient_horiz = mod(echo_orientation, 2.0);\n                        float orient_x = (orient_horiz != 0.0) ? -1.0 : 1.0;\n                        float orient_y = (echo_orientation >= 2.0) ? -1.0 : 1.0;\n                        vec2 uv_echo = ((uv - 0.5) *\n                                        (1.0 / echo_zoom) *\n                                        vec2(orient_x, orient_y)) + 0.5;\n\n                        ret = mix(texture(sampler_main, uv).rgb,\n                                  texture(sampler_main, uv_echo).rgb,\n                                  echo_alpha);\n\n                        ret *= gammaAdj;\n\n                        if(fShader >= 1.0) {\n                          ret *= hue_shader;\n                        } else if(fShader > 0.001) {\n                          ret *= (1.0 - fShader) + (fShader * hue_shader);\n                        }\n\n                        if(brighten != 0) ret = sqrt(ret);\n                        if(darken != 0) ret = ret*ret;\n                        if(solarize != 0) ret = ret * (1.0 - ret) * 4.0;\n                        if(invert != 0) ret = 1.0 - ret;",r="";else{const n=i.default.getShaderParts(e);r=n[0],t=n[1]}t=t.replace(/texture2D/g,"texture"),t=t.replace(/texture3D/g,"texture"),this.userTextures=i.default.getUserSamplers(r),this.shaderProgram=this.gl.createProgram();const n=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(n,"\n      #version 300 es\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      in vec4 aCompColor;\n      out vec2 vUv;\n      out vec4 vColor;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        vUv = aPos * halfmad + halfmad;\n        vColor = aCompColor;\n      }\n      ".trim()),this.gl.compileShader(n);const a=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(a,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      precision mediump sampler3D;\n\n      vec3 lum(vec3 v){\n          return vec3(dot(v, vec3(0.32,0.49,0.29)));\n      }\n\n      in vec2 vUv;\n      in vec4 vColor;\n      out vec4 fragColor;\n      uniform sampler2D sampler_main;\n      uniform sampler2D sampler_fw_main;\n      uniform sampler2D sampler_fc_main;\n      uniform sampler2D sampler_pw_main;\n      uniform sampler2D sampler_pc_main;\n      uniform sampler2D sampler_blur1;\n      uniform sampler2D sampler_blur2;\n      uniform sampler2D sampler_blur3;\n      uniform sampler2D sampler_noise_lq;\n      uniform sampler2D sampler_noise_lq_lite;\n      uniform sampler2D sampler_noise_mq;\n      uniform sampler2D sampler_noise_hq;\n      uniform sampler2D sampler_pw_noise_lq;\n      uniform sampler3D sampler_noisevol_lq;\n      uniform sampler3D sampler_noisevol_hq;\n\n      uniform float time;\n      uniform float gammaAdj;\n      uniform float echo_zoom;\n      uniform float echo_alpha;\n      uniform float echo_orientation;\n      uniform int invert;\n      uniform int brighten;\n      uniform int darken;\n      uniform int solarize;\n      uniform vec2 resolution;\n      uniform vec4 aspect;\n      uniform vec4 texsize;\n      uniform vec4 texsize_noise_lq;\n      uniform vec4 texsize_noise_mq;\n      uniform vec4 texsize_noise_hq;\n      uniform vec4 texsize_noise_lq_lite;\n      uniform vec4 texsize_noisevol_lq;\n      uniform vec4 texsize_noisevol_hq;\n\n      uniform float bass;\n      uniform float mid;\n      uniform float treb;\n      uniform float vol;\n      uniform float bass_att;\n      uniform float mid_att;\n      uniform float treb_att;\n      uniform float vol_att;\n\n      uniform float frame;\n      uniform float fps;\n\n      uniform vec4 _qa;\n      uniform vec4 _qb;\n      uniform vec4 _qc;\n      uniform vec4 _qd;\n      uniform vec4 _qe;\n      uniform vec4 _qf;\n      uniform vec4 _qg;\n      uniform vec4 _qh;\n\n      #define q1 _qa.x\n      #define q2 _qa.y\n      #define q3 _qa.z\n      #define q4 _qa.w\n      #define q5 _qb.x\n      #define q6 _qb.y\n      #define q7 _qb.z\n      #define q8 _qb.w\n      #define q9 _qc.x\n      #define q10 _qc.y\n      #define q11 _qc.z\n      #define q12 _qc.w\n      #define q13 _qd.x\n      #define q14 _qd.y\n      #define q15 _qd.z\n      #define q16 _qd.w\n      #define q17 _qe.x\n      #define q18 _qe.y\n      #define q19 _qe.z\n      #define q20 _qe.w\n      #define q21 _qf.x\n      #define q22 _qf.y\n      #define q23 _qf.z\n      #define q24 _qf.w\n      #define q25 _qg.x\n      #define q26 _qg.y\n      #define q27 _qg.z\n      #define q28 _qg.w\n      #define q29 _qh.x\n      #define q30 _qh.y\n      #define q31 _qh.z\n      #define q32 _qh.w\n\n      uniform vec4 slow_roam_cos;\n      uniform vec4 roam_cos;\n      uniform vec4 slow_roam_sin;\n      uniform vec4 roam_sin;\n\n      uniform float blur1_min;\n      uniform float blur1_max;\n      uniform float blur2_min;\n      uniform float blur2_max;\n      uniform float blur3_min;\n      uniform float blur3_max;\n\n      uniform float scale1;\n      uniform float scale2;\n      uniform float scale3;\n      uniform float bias1;\n      uniform float bias2;\n      uniform float bias3;\n\n      uniform vec4 rand_frame;\n      uniform vec4 rand_preset;\n\n      uniform float fShader;\n\n      float PI = ${Math.PI};\n\n      ${r}\n\n      void main(void) {\n        vec3 ret;\n        vec2 uv = vUv;\n        vec2 uv_orig = vUv;\n        uv.y = 1.0 - uv.y;\n        uv_orig.y = 1.0 - uv_orig.y;\n        float rad = length(uv - 0.5);\n        float ang = atan(uv.x - 0.5, uv.y - 0.5);\n        vec3 hue_shader = vColor.rgb;\n\n        ${t}\n\n        fragColor = vec4(ret, vColor.a);\n      }\n      `.trim()),this.gl.compileShader(a),this.gl.attachShader(this.shaderProgram,n),this.gl.attachShader(this.shaderProgram,a),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.compColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aCompColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.gammaAdjLoc=this.gl.getUniformLocation(this.shaderProgram,"gammaAdj"),this.echoZoomLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_zoom"),this.echoAlphaLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_alpha"),this.echoOrientationLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_orientation"),this.invertLoc=this.gl.getUniformLocation(this.shaderProgram,"invert"),this.brightenLoc=this.gl.getUniformLocation(this.shaderProgram,"brighten"),this.darkenLoc=this.gl.getUniformLocation(this.shaderProgram,"darken"),this.solarizeLoc=this.gl.getUniformLocation(this.shaderProgram,"solarize"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.fShaderLoc=this.gl.getUniformLocation(this.shaderProgram,"fShader"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];t.textureLoc=this.gl.getUniformLocation(this.shaderProgram,`sampler_${t.sampler}`)}}updateShader(e){this.createShader(e)}bindBlurVals(e,t){const r=e[0],i=e[1],n=e[2],a=t[0],s=t[1],o=t[2],l=a-r,c=r,u=s-i,h=i,d=o-n,f=n;this.gl.uniform1f(this.blur1MinLoc,r),this.gl.uniform1f(this.blur1MaxLoc,a),this.gl.uniform1f(this.blur2MinLoc,i),this.gl.uniform1f(this.blur2MaxLoc,s),this.gl.uniform1f(this.blur3MinLoc,n),this.gl.uniform1f(this.blur3MaxLoc,o),this.gl.uniform1f(this.scale1Loc,l),this.gl.uniform1f(this.scale2Loc,u),this.gl.uniform1f(this.scale3Loc,d),this.gl.uniform1f(this.bias1Loc,c),this.gl.uniform1f(this.bias2Loc,h),this.gl.uniform1f(this.bias3Loc,f)}static generateHueBase(e){const t=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1]);for(let r=0;r<4;r++){t[3*r+0]=.6+.3*Math.sin(30*e.time*.0143+3+21*r+e.rand_start[3]),t[3*r+1]=.6+.3*Math.sin(30*e.time*.0107+1+13*r+e.rand_start[1]),t[3*r+2]=.6+.3*Math.sin(30*e.time*.0129+6+9*r+e.rand_start[2]);const i=Math.max(t[3*r],t[3*r+1],t[3*r+2]);for(let e=0;e<3;e++)t[3*r+e]=t[3*r+e]/i,t[3*r+e]=.5+.5*t[3*r+e]}return t}generateCompColors(e,t,r){const i=n.generateHueBase(t),a=this.compWidth+1,s=this.compHeight+1,o=new Float32Array(a*s*4);let l=0;for(let t=0;t<s;t++)for(let n=0;n<a;n++){let a=n/this.compWidth,s=t/this.compHeight;const c=[1,1,1];for(let e=0;e<3;e++)c[e]=i[0+e]*a*s+i[3+e]*(1-a)*s+i[6+e]*a*(1-s)+i[9+e]*(1-a)*(1-s);let u=1;if(e){a*=this.mesh_width+1,s*=this.mesh_height+1,a=Math.clamp(a,0,this.mesh_width-1),s=Math.clamp(s,0,this.mesh_height-1);const e=Math.floor(a),t=Math.floor(s),i=a-e,n=s-t;u=r[4*(t*(this.mesh_width+1)+e)+3]*(1-i)*(1-n)+r[4*(t*(this.mesh_width+1)+(e+1))+3]*i*(1-n)+r[4*((t+1)*(this.mesh_width+1)+e)+3]*(1-i)*n+r[4*((t+1)*(this.mesh_width+1)+(e+1))+3]*i*n}o[l+0]=c[0],o[l+1]=c[1],o[l+2]=c[2],o[l+3]=u,l+=4}return o}renderQuadTexture(e,t,r,i,n,a,s,o,l,c){const u=this.generateCompColors(e,o,c);this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.compColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,u,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.compColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.compColorLocation);const h=0!==o.wrap?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,h),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,h),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,n),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];this.gl.activeTexture(this.gl.TEXTURE15+e),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(t.sampler)),this.gl.uniform1i(t.textureLoc,15+e)}this.gl.uniform1f(this.timeLoc,o.time),this.gl.uniform1f(this.gammaAdjLoc,o.gammaadj),this.gl.uniform1f(this.echoZoomLoc,o.echo_zoom),this.gl.uniform1f(this.echoAlphaLoc,o.echo_alpha),this.gl.uniform1f(this.echoOrientationLoc,o.echo_orient),this.gl.uniform1i(this.invertLoc,o.invert),this.gl.uniform1i(this.brightenLoc,o.brighten),this.gl.uniform1i(this.darkenLoc,o.darken),this.gl.uniform1i(this.solarizeLoc,o.solarize),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,o.bass),this.gl.uniform1f(this.midLoc,o.mid),this.gl.uniform1f(this.trebLoc,o.treb),this.gl.uniform1f(this.volLoc,(o.bass+o.mid+o.treb)/3),this.gl.uniform1f(this.bassAttLoc,o.bass_att),this.gl.uniform1f(this.midAttLoc,o.mid_att),this.gl.uniform1f(this.trebAttLoc,o.treb_att),this.gl.uniform1f(this.volAttLoc,(o.bass_att+o.mid_att+o.treb_att)/3),this.gl.uniform1f(this.frameLoc,o.frame),this.gl.uniform1f(this.fpsLoc,o.fps),this.gl.uniform4fv(this.randPresetLoc,o.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform1f(this.fShaderLoc,o.fshader),this.gl.uniform4fv(this.qaLoc,new Float32Array([l.q1||0,l.q2||0,l.q3||0,l.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([l.q5||0,l.q6||0,l.q7||0,l.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([l.q9||0,l.q10||0,l.q11||0,l.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([l.q13||0,l.q14||0,l.q15||0,l.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([l.q17||0,l.q18||0,l.q19||0,l.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([l.q21||0,l.q22||0,l.q23||0,l.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([l.q25||0,l.q26||0,l.q27||0,l.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([l.q29||0,l.q30||0,l.q31||0,l.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(.005*o.time),.5+.5*Math.cos(.008*o.time),.5+.5*Math.cos(.013*o.time),.5+.5*Math.cos(.022*o.time)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(.3*o.time),.5+.5*Math.cos(1.3*o.time),.5+.5*Math.cos(5*o.time),.5+.5*Math.cos(20*o.time)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(.005*o.time),.5+.5*Math.sin(.008*o.time),.5+.5*Math.sin(.013*o.time),.5+.5*Math.sin(.022*o.time)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(.3*o.time),.5+.5*Math.sin(1.3*o.time),.5+.5*Math.sin(5*o.time),.5+.5*Math.sin(20*o.time)]),this.bindBlurVals(a,s),e?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),e||this.gl.enable(this.gl.BLEND)}}},"./src/rendering/shaders/output.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/rendering/shaders/shaderUtils.js");class n{constructor(e,t){this.gl=e,this.textureRatio=t.textureRatio,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.useFXAA()?this.createFXAAShader():this.createShader()}useFXAA(){return this.textureRatio<=1}updateGlobals(e){this.textureRatio=e.textureRatio,this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.gl.deleteProgram(this.shaderProgram),this.useFXAA()?this.createFXAAShader():this.createShader()}createFXAAShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       out vec2 v_rgbM;\n       out vec2 v_rgbNW;\n       out vec2 v_rgbNE;\n       out vec2 v_rgbSW;\n       out vec2 v_rgbSE;\n       uniform vec4 texsize;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n\n         v_rgbM = aPos * halfmad + halfmad;\n         v_rgbNW = v_rgbM + (vec2(-1.0, -1.0) * texsize.zx);\n         v_rgbNE = v_rgbM + (vec2(1.0, -1.0) * texsize.zx);\n         v_rgbSW = v_rgbM + (vec2(-1.0, 1.0) * texsize.zx);\n         v_rgbSE = v_rgbM + (vec2(1.0, 1.0) * texsize.zx);\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 v_rgbM;\n       in vec2 v_rgbNW;\n       in vec2 v_rgbNE;\n       in vec2 v_rgbSW;\n       in vec2 v_rgbSE;\n       out vec4 fragColor;\n       uniform vec4 texsize;\n       uniform sampler2D uTexture;\n\n       #ifndef FXAA_REDUCE_MIN\n         #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n       #endif\n       #ifndef FXAA_REDUCE_MUL\n         #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n       #endif\n       #ifndef FXAA_SPAN_MAX\n         #define FXAA_SPAN_MAX     8.0\n       #endif\n\n       void main(void) {\n         vec4 color;\n         vec3 rgbNW = textureLod(uTexture, v_rgbNW, 0.0).xyz;\n         vec3 rgbNE = textureLod(uTexture, v_rgbNE, 0.0).xyz;\n         vec3 rgbSW = textureLod(uTexture, v_rgbSW, 0.0).xyz;\n         vec3 rgbSE = textureLod(uTexture, v_rgbSE, 0.0).xyz;\n         vec3 rgbM  = textureLod(uTexture, v_rgbM, 0.0).xyz;\n         vec3 luma = vec3(0.299, 0.587, 0.114);\n         float lumaNW = dot(rgbNW, luma);\n         float lumaNE = dot(rgbNE, luma);\n         float lumaSW = dot(rgbSW, luma);\n         float lumaSE = dot(rgbSE, luma);\n         float lumaM  = dot(rgbM,  luma);\n         float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n         float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n         mediump vec2 dir;\n         dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n         dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n         float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                               (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n         float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n         dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n                   max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                   dir * rcpDirMin)) * texsize.zw;\n\n         vec3 rgbA = 0.5 * (\n             textureLod(uTexture, v_rgbM + dir * (1.0 / 3.0 - 0.5), 0.0).xyz +\n             textureLod(uTexture, v_rgbM + dir * (2.0 / 3.0 - 0.5), 0.0).xyz);\n         vec3 rgbB = rgbA * 0.5 + 0.25 * (\n             textureLod(uTexture, v_rgbM + dir * -0.5, 0.0).xyz +\n             textureLod(uTexture, v_rgbM + dir * 0.5, 0.0).xyz);\n\n         float lumaB = dot(rgbB, luma);\n         if ((lumaB < lumaMin) || (lumaB > lumaMax))\n           color = vec4(rgbA, 1.0);\n         else\n           color = vec4(rgbB, 1.0);\n\n         fragColor = color;\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize")}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       out vec2 uv;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n         uv = aPos * halfmad + halfmad;\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n\n       void main(void) {\n         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}renderQuadTexture(e){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(this.textureLoc,0),this.useFXAA()&&this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/resample.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/rendering/shaders/shaderUtils.js");class n{constructor(e){this.gl=e,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       out vec2 uv;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n         uv = aPos * halfmad + halfmad;\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n\n       void main(void) {\n         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}renderQuadTexture(e){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.uniform1i(this.textureLoc,0),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/shaderUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));const i=/uniform sampler2D sampler_(?:.+?);/g,n=/uniform sampler2D sampler_(.+?);/;class a{static getShaderParts(e){const t=e.indexOf("shader_body");if(e&&t>-1){const r=e.substring(0,t),i=e.substring(t),n=i.indexOf("{"),a=i.lastIndexOf("}");return[r,i.substring(n+1,a)]}return["",e]}static getFragmentFloatPrecision(e){return e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0?"highp":e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}static getUserSamplers(e){const t=[],r=e.match(i);if(r&&r.length>0)for(let e=0;e<r.length;e++){const i=r[e].match(n);if(i&&i.length>0){const e=i[1];t.push({sampler:e})}}return t}}},"./src/rendering/shaders/warp.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/rendering/shaders/shaderUtils.js");class n{constructor(e,t,r,n={}){this.gl=e,this.noise=t,this.image=r,this.texsizeX=n.texsizeX,this.texsizeY=n.texsizeY,this.mesh_width=n.mesh_width,this.mesh_height=n.mesh_height,this.aspectx=n.aspectx,this.aspecty=n.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.warpUvVertexBuf=this.gl.createBuffer(),this.warpColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),e.samplerParameteri(this.mainSampler,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}buildPositions(){const e=this.mesh_width,t=this.mesh_height,r=e+1,i=t+1,n=2/e,a=2/t,s=[];for(let e=0;e<i;e++){const t=e*a-1;for(let e=0;e<r;e++){const r=e*n-1;s.push(r,-t,0)}}const o=[];for(let i=0;i<t;i++)for(let t=0;t<e;t++){const e=t+r*i,n=t+r*(i+1),a=t+1+r*(i+1),s=t+1+r*i;o.push(e,n,s),o.push(n,a,s)}this.vertices=new Float32Array(s),this.indices=new Uint16Array(o)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}createShader(e=""){let t,r;if(0===e.length)t="ret = texture(sampler_main, uv).rgb * decay;",r="";else{const n=i.default.getShaderParts(e);r=n[0],t=n[1]}t=t.replace(/texture2D/g,"texture"),t=t.replace(/texture3D/g,"texture"),this.userTextures=i.default.getUserSamplers(r),this.shaderProgram=this.gl.createProgram();const n=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(n,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      in vec2 aWarpUv;\n      in vec4 aWarpColor;\n      out vec2 uv;\n      out vec2 uv_orig;\n      out vec4 vColor;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        uv_orig = aPos * halfmad + halfmad;\n        uv = aWarpUv;\n        vColor = aWarpColor;\n      }\n      `.trim()),this.gl.compileShader(n);const a=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(a,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      precision mediump sampler3D;\n\n      in vec2 uv;\n      in vec2 uv_orig;\n      in vec4 vColor;\n      out vec4 fragColor;\n      uniform sampler2D sampler_main;\n      uniform sampler2D sampler_fw_main;\n      uniform sampler2D sampler_fc_main;\n      uniform sampler2D sampler_pw_main;\n      uniform sampler2D sampler_pc_main;\n      uniform sampler2D sampler_blur1;\n      uniform sampler2D sampler_blur2;\n      uniform sampler2D sampler_blur3;\n      uniform sampler2D sampler_noise_lq;\n      uniform sampler2D sampler_noise_lq_lite;\n      uniform sampler2D sampler_noise_mq;\n      uniform sampler2D sampler_noise_hq;\n      uniform sampler2D sampler_pw_noise_lq;\n      uniform sampler3D sampler_noisevol_lq;\n      uniform sampler3D sampler_noisevol_hq;\n      uniform float time;\n      uniform float decay;\n      uniform vec2 resolution;\n      uniform vec4 aspect;\n      uniform vec4 texsize;\n      uniform vec4 texsize_noise_lq;\n      uniform vec4 texsize_noise_mq;\n      uniform vec4 texsize_noise_hq;\n      uniform vec4 texsize_noise_lq_lite;\n      uniform vec4 texsize_noisevol_lq;\n      uniform vec4 texsize_noisevol_hq;\n\n      uniform float bass;\n      uniform float mid;\n      uniform float treb;\n      uniform float vol;\n      uniform float bass_att;\n      uniform float mid_att;\n      uniform float treb_att;\n      uniform float vol_att;\n\n      uniform float frame;\n      uniform float fps;\n\n      uniform vec4 _qa;\n      uniform vec4 _qb;\n      uniform vec4 _qc;\n      uniform vec4 _qd;\n      uniform vec4 _qe;\n      uniform vec4 _qf;\n      uniform vec4 _qg;\n      uniform vec4 _qh;\n\n      #define q1 _qa.x\n      #define q2 _qa.y\n      #define q3 _qa.z\n      #define q4 _qa.w\n      #define q5 _qb.x\n      #define q6 _qb.y\n      #define q7 _qb.z\n      #define q8 _qb.w\n      #define q9 _qc.x\n      #define q10 _qc.y\n      #define q11 _qc.z\n      #define q12 _qc.w\n      #define q13 _qd.x\n      #define q14 _qd.y\n      #define q15 _qd.z\n      #define q16 _qd.w\n      #define q17 _qe.x\n      #define q18 _qe.y\n      #define q19 _qe.z\n      #define q20 _qe.w\n      #define q21 _qf.x\n      #define q22 _qf.y\n      #define q23 _qf.z\n      #define q24 _qf.w\n      #define q25 _qg.x\n      #define q26 _qg.y\n      #define q27 _qg.z\n      #define q28 _qg.w\n      #define q29 _qh.x\n      #define q30 _qh.y\n      #define q31 _qh.z\n      #define q32 _qh.w\n\n      uniform vec4 slow_roam_cos;\n      uniform vec4 roam_cos;\n      uniform vec4 slow_roam_sin;\n      uniform vec4 roam_sin;\n\n      uniform float blur1_min;\n      uniform float blur1_max;\n      uniform float blur2_min;\n      uniform float blur2_max;\n      uniform float blur3_min;\n      uniform float blur3_max;\n\n      uniform float scale1;\n      uniform float scale2;\n      uniform float scale3;\n      uniform float bias1;\n      uniform float bias2;\n      uniform float bias3;\n\n      uniform vec4 rand_frame;\n      uniform vec4 rand_preset;\n\n      float PI = ${Math.PI};\n\n      ${r}\n\n      void main(void) {\n        vec3 ret;\n        float rad = length(uv_orig - 0.5);\n        float ang = atan(uv_orig.x - 0.5, uv_orig.y - 0.5);\n\n        ${t}\n\n        fragColor = vec4(ret, 1.0) * vColor;\n      }\n      `.trim()),this.gl.compileShader(a),this.gl.attachShader(this.shaderProgram,n),this.gl.attachShader(this.shaderProgram,a),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.warpUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpUv"),this.warpColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.decayLoc=this.gl.getUniformLocation(this.shaderProgram,"decay"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];t.textureLoc=this.gl.getUniformLocation(this.shaderProgram,`sampler_${t.sampler}`)}}updateShader(e){this.createShader(e)}bindBlurVals(e,t){const r=e[0],i=e[1],n=e[2],a=t[0],s=t[1],o=t[2],l=a-r,c=r,u=s-i,h=i,d=o-n,f=n;this.gl.uniform1f(this.blur1MinLoc,r),this.gl.uniform1f(this.blur1MaxLoc,a),this.gl.uniform1f(this.blur2MinLoc,i),this.gl.uniform1f(this.blur2MaxLoc,s),this.gl.uniform1f(this.blur3MinLoc,n),this.gl.uniform1f(this.blur3MaxLoc,o),this.gl.uniform1f(this.scale1Loc,l),this.gl.uniform1f(this.scale2Loc,u),this.gl.uniform1f(this.scale3Loc,d),this.gl.uniform1f(this.bias1Loc,c),this.gl.uniform1f(this.bias2Loc,h),this.gl.uniform1f(this.bias3Loc,f)}renderQuadTexture(e,t,r,i,n,a,s,o,l,c,u){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpUvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,c,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,u,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpColorLocation);const h=0!==o.wrap?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,h),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,h),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,n),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];this.gl.activeTexture(this.gl.TEXTURE15+e),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(t.sampler)),this.gl.uniform1i(t.textureLoc,15+e)}this.gl.uniform1f(this.decayLoc,o.decay),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,[this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY]),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,o.bass),this.gl.uniform1f(this.midLoc,o.mid),this.gl.uniform1f(this.trebLoc,o.treb),this.gl.uniform1f(this.volLoc,(o.bass+o.mid+o.treb)/3),this.gl.uniform1f(this.bassAttLoc,o.bass_att),this.gl.uniform1f(this.midAttLoc,o.mid_att),this.gl.uniform1f(this.trebAttLoc,o.treb_att),this.gl.uniform1f(this.volAttLoc,(o.bass_att+o.mid_att+o.treb_att)/3),this.gl.uniform1f(this.timeLoc,o.time),this.gl.uniform1f(this.frameLoc,o.frame),this.gl.uniform1f(this.fpsLoc,o.fps),this.gl.uniform4fv(this.randPresetLoc,o.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform4fv(this.qaLoc,new Float32Array([l.q1||0,l.q2||0,l.q3||0,l.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([l.q5||0,l.q6||0,l.q7||0,l.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([l.q9||0,l.q10||0,l.q11||0,l.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([l.q13||0,l.q14||0,l.q15||0,l.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([l.q17||0,l.q18||0,l.q19||0,l.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([l.q21||0,l.q22||0,l.q23||0,l.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([l.q25||0,l.q26||0,l.q27||0,l.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([l.q29||0,l.q30||0,l.q31||0,l.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(.005*o.time),.5+.5*Math.cos(.008*o.time),.5+.5*Math.cos(.013*o.time),.5+.5*Math.cos(.022*o.time)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(.3*o.time),.5+.5*Math.cos(1.3*o.time),.5+.5*Math.cos(5*o.time),.5+.5*Math.cos(20*o.time)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(.005*o.time),.5+.5*Math.sin(.008*o.time),.5+.5*Math.sin(.013*o.time),.5+.5*Math.sin(.022*o.time)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(.3*o.time),.5+.5*Math.sin(1.3*o.time),.5+.5*Math.sin(5*o.time),.5+.5*Math.sin(20*o.time)]),this.bindBlurVals(a,s),e?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),e||this.gl.enable(this.gl.BLEND)}}},"./src/rendering/shapes/customShape.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var i=r("./src/utils.js"),n=r("./src/rendering/shaders/shaderUtils.js");class a{constructor(e,t,r){this.index=e,this.gl=t,this.positions=new Float32Array(309),this.colors=new Float32Array(412),this.uvs=new Float32Array(206),this.borderPositions=new Float32Array(306),this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.uvVertexBuf=this.gl.createBuffer(),this.borderPositionVertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.createBorderShader(),this.mainSampler=this.gl.createSampler(),t.samplerParameteri(this.mainSampler,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_T,t.REPEAT)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      in vec4 aColor;\n      in vec2 aUv;\n      out vec4 vColor;\n      out vec2 vUv;\n      void main(void) {\n        vColor = aColor;\n        vUv = aUv;\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      uniform sampler2D uTexture;\n      uniform float uTextured;\n      in vec4 vColor;\n      in vec2 vUv;\n      out vec4 fragColor;\n      void main(void) {\n        if (uTextured != 0.0) {\n          fragColor = texture(uTexture, vUv) * vColor;\n        } else {\n          fragColor = vColor;\n        }\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.aUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.texturedLoc=this.gl.getUniformLocation(this.shaderProgram,"uTextured"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}createBorderShader(){this.borderShaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aBorderPos;\n      uniform vec2 thickOffset;\n      void main(void) {\n        gl_Position = vec4(aBorderPos +\n                            vec3(thickOffset, 0.0), 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 uBorderColor;\n      void main(void) {\n        fragColor = uBorderColor;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.borderShaderProgram,e),this.gl.attachShader(this.borderShaderProgram,t),this.gl.linkProgram(this.borderShaderProgram),this.aBorderPosLoc=this.gl.getAttribLocation(this.borderShaderProgram,"aBorderPos"),this.uBorderColorLoc=this.gl.getUniformLocation(this.borderShaderProgram,"uBorderColor"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}drawCustomShape(e,t,r,n,a){if(0!==n.baseVals.enabled)if(r.preset.useWASM){this.setupShapeBuffers(r.preset.globalPools.perFrame.wrap.value);const n=r.preset.shapes[this.index].baseVals,s=r.preset.globalPools[`shapePerFrame${this.index}`];i.default.setWasm(s,t,r.globalKeys),r.preset.shapes[this.index].frame_eqs||r.preset.restore_qs(),i.default.setWasm(s,r.mdVSTShapeInits[this.index],r.ts),r.preset.save_ts(),s.x.value=n.x,s.y.value=n.y,s.rad.value=n.rad,s.ang.value=n.ang,s.r.value=n.r,s.g.value=n.g,s.b.value=n.b,s.a.value=n.a,s.r2.value=n.r2,s.g2.value=n.g2,s.b2.value=n.b2,s.a2.value=n.a2,s.border_r.value=n.border_r,s.border_g.value=n.border_g,s.border_b.value=n.border_b,s.border_a.value=n.border_a,s.thickoutline.value=n.thickoutline,s.textured.value=n.textured,s.tex_zoom.value=n.tex_zoom,s.tex_ang.value=n.tex_ang,s.additive.value=n.additive,r.preset.shapes[this.index].frame_eqs_save();const o=Math.clamp(n.num_inst,1,1024);for(let t=0;t<o;t++){s.instance.value=t,r.preset.shapes[this.index].frame_eqs&&(r.preset.shapes[this.index].frame_eqs_restore(),r.preset.restore_qs(),r.preset.restore_ts(),r.preset.shapes[this.index].frame_eqs());let i=s.sides.value;i=Math.clamp(i,3,100),i=Math.floor(i);const n=s.rad.value,o=s.ang.value,l=2*s.x.value-1,c=-2*s.y.value+1,u=s.r.value,h=s.g.value,d=s.b.value,f=s.a.value,m=s.r2.value,p=s.g2.value,g=s.b2.value,A=s.a2.value,b=s.border_r.value,v=s.border_g.value,y=s.border_b.value,w=s.border_a.value;this.borderColor=[b,v,y,w*e];const E=s.thickoutline.value,_=s.textured.value,T=s.tex_zoom.value,S=s.tex_ang.value,x=s.additive.value,k=this.borderColor[3]>0,I=Math.abs(_)>=1,C=Math.abs(E)>=1,P=Math.abs(x)>=1;this.positions[0]=l,this.positions[1]=c,this.positions[2]=0,this.colors[0]=u,this.colors[1]=h,this.colors[2]=d,this.colors[3]=f*e,I&&(this.uvs[0]=.5,this.uvs[1]=.5);const M=.25*Math.PI;for(let t=1;t<=i+1;t++){const r=(t-1)/i*2*Math.PI,a=r+o+M;if(this.positions[3*t+0]=l+n*Math.cos(a)*this.aspecty,this.positions[3*t+1]=c+n*Math.sin(a),this.positions[3*t+2]=0,this.colors[4*t+0]=m,this.colors[4*t+1]=p,this.colors[4*t+2]=g,this.colors[4*t+3]=A*e,I){const e=r+S+M;this.uvs[2*t+0]=.5+.5*Math.cos(e)/T*this.aspecty,this.uvs[2*t+1]=.5+.5*Math.sin(e)/T}k&&(this.borderPositions[3*(t-1)+0]=this.positions[3*t+0],this.borderPositions[3*(t-1)+1]=this.positions[3*t+1],this.borderPositions[3*(t-1)+2]=this.positions[3*t+2])}this.drawCustomShapeInstance(a,i,I,k,C,P)}}else{this.setupShapeBuffers(r.mdVSFrame.wrap);let n=Object.assign({},r.mdVSShapes[this.index],r.mdVSFrameMapShapes[this.index],t);""===r.preset.shapes[this.index].frame_eqs_str&&(n=Object.assign(n,r.mdVSQAfterFrame,r.mdVSTShapeInits[this.index]));const s=r.preset.shapes[this.index].baseVals,o=Math.clamp(s.num_inst,1,1024);for(let t=0;t<o;t++){let i;n.instance=t,n.x=s.x,n.y=s.y,n.rad=s.rad,n.ang=s.ang,n.r=s.r,n.g=s.g,n.b=s.b,n.a=s.a,n.r2=s.r2,n.g2=s.g2,n.b2=s.b2,n.a2=s.a2,n.border_r=s.border_r,n.border_g=s.border_g,n.border_b=s.border_b,n.border_a=s.border_a,n.thickoutline=s.thickoutline,n.textured=s.textured,n.tex_zoom=s.tex_zoom,n.tex_ang=s.tex_ang,n.additive=s.additive,""!==r.preset.shapes[this.index].frame_eqs_str?(n=Object.assign(n,r.mdVSQAfterFrame,r.mdVSTShapeInits[this.index]),i=r.runShapeFrameEquations(this.index,n)):i=n;let o=i.sides;o=Math.clamp(o,3,100),o=Math.floor(o);const l=i.rad,c=i.ang,u=2*i.x-1,h=-2*i.y+1,d=i.r,f=i.g,m=i.b,p=i.a,g=i.r2,A=i.g2,b=i.b2,v=i.a2,y=i.border_r,w=i.border_g,E=i.border_b,_=i.border_a;this.borderColor=[y,w,E,_*e];const T=i.thickoutline,S=i.textured,x=i.tex_zoom,k=i.tex_ang,I=i.additive,C=this.borderColor[3]>0,P=Math.abs(S)>=1,M=Math.abs(T)>=1,R=Math.abs(I)>=1;this.positions[0]=u,this.positions[1]=h,this.positions[2]=0,this.colors[0]=d,this.colors[1]=f,this.colors[2]=m,this.colors[3]=p*e,P&&(this.uvs[0]=.5,this.uvs[1]=.5);const B=.25*Math.PI;for(let t=1;t<=o+1;t++){const r=(t-1)/o*2*Math.PI,i=r+c+B;if(this.positions[3*t+0]=u+l*Math.cos(i)*this.aspecty,this.positions[3*t+1]=h+l*Math.sin(i),this.positions[3*t+2]=0,this.colors[4*t+0]=g,this.colors[4*t+1]=A,this.colors[4*t+2]=b,this.colors[4*t+3]=v*e,P){const e=r+k+B;this.uvs[2*t+0]=.5+.5*Math.cos(e)/x*this.aspecty,this.uvs[2*t+1]=.5+.5*Math.sin(e)/x}C&&(this.borderPositions[3*(t-1)+0]=this.positions[3*t+0],this.borderPositions[3*(t-1)+1]=this.positions[3*t+1],this.borderPositions[3*(t-1)+2]=this.positions[3*t+2])}this.mdVSShapeFrame=i,this.drawCustomShapeInstance(a,o,P,C,M,R)}const l=r.mdVSUserKeysShapes[this.index],c=i.default.pick(this.mdVSShapeFrame,l);r.mdVSFrameMapShapes[this.index]=c}}setupShapeBuffers(e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.uvs,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.borderPositions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc);const t=0!==e?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,t),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,t)}drawCustomShapeInstance(e,t,r,i,n,a){if(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.positions,0,3*(t+2)),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.colors,0,4*(t+2)),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),r&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.uvs,0,2*(t+2)),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation)),this.gl.uniform1f(this.texturedLoc,r?1:0),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),a?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,t+2),i){this.gl.useProgram(this.borderShaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.borderPositions,0,3*(t+1)),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc),this.gl.uniform4fv(this.uBorderColorLoc,this.borderColor);const e=n?4:1;for(let r=0;r<e;r++){const e=2;0===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===r?this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,0]):2===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,e/this.texsizeY]):3===r&&this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,e/this.texsizeY]),this.gl.drawArrays(this.gl.LINE_STRIP,0,t+1)}}}}},"./src/rendering/sprites/border.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/rendering/shaders/shaderUtils.js");class n{constructor(e,t={}){this.gl=e,this.positions=new Float32Array(72),this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}updateGlobals(e){this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      void main(void) {\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 u_color;\n      void main(void) {\n        fragColor = u_color;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}addTriangle(e,t,r,i){this.positions[e+0]=t[0],this.positions[e+1]=t[1],this.positions[e+2]=t[2],this.positions[e+3]=r[0],this.positions[e+4]=r[1],this.positions[e+5]=r[2],this.positions[e+6]=i[0],this.positions[e+7]=i[1],this.positions[e+8]=i[2]}generateBorder(e,t,r){if(t>0&&e[3]>0){const e=2,i=2,n=e/2,a=i/2,s=r/2,o=t/2+s,l=s*e,c=s*i,u=o*e,h=o*i;let d=[-n+l,-a+h,0],f=[-n+l,a-h,0],m=[-n+u,a-h,0],p=[-n+u,-a+h,0];return this.addTriangle(0,p,f,d),this.addTriangle(9,p,m,f),d=[n-l,-a+h,0],f=[n-l,a-h,0],m=[n-u,a-h,0],p=[n-u,-a+h,0],this.addTriangle(18,d,f,p),this.addTriangle(27,f,m,p),d=[-n+l,-a+c,0],f=[-n+l,h-a,0],m=[n-l,h-a,0],p=[n-l,-a+c,0],this.addTriangle(36,p,f,d),this.addTriangle(45,p,m,f),d=[-n+l,a-c,0],f=[-n+l,a-h,0],m=[n-l,a-h,0],p=[n-l,a-c,0],this.addTriangle(54,d,f,p),this.addTriangle(63,f,m,p),!0}return!1}drawBorder(e,t,r){this.generateBorder(e,t,r)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,e),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLES,0,this.positions.length/3))}}},"./src/rendering/sprites/darkenCenter.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/rendering/shaders/shaderUtils.js");class n{constructor(e,t){this.gl=e,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions(),this.colors=new Float32Array([0,0,0,3/32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(e){this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions()}generatePositions(){this.positions=new Float32Array([0,0,0,-.05*this.aspecty,0,0,0,-.05,0,.05*this.aspecty,0,0,0,.05,0,-.05*this.aspecty,0,0])}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      in vec4 aColor;\n      out vec4 vColor;\n      void main(void) {\n        vColor = aColor;\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      in vec4 vColor;\n      out vec4 fragColor;\n      void main(void) {\n        fragColor = vColor;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor")}drawDarkenCenter(e){0!==e.darken_center&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,this.positions.length/3))}}},"./src/rendering/text/titleText.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));var i=r("./src/rendering/shaders/shaderUtils.js");class n{constructor(e,t={}){this.gl=e,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.textTexture=this.gl.createTexture(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.vertexBuf=this.gl.createBuffer(),this.canvas=document.createElement("canvas"),this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY,this.context2D=this.canvas.getContext("2d"),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader()}generateTitleTexture(e){this.context2D.clearRect(0,0,this.texsizeX,this.texsizeY),this.fontSize=Math.floor(this.texsizeX/256*16),this.fontSize=Math.max(this.fontSize,6),this.context2D.font=`italic ${this.fontSize}px Times New Roman`;let t=e,r=this.context2D.measureText(t).width;if(r>this.texsizeX){const e=this.texsizeX/r*.91;t=`${t.substring(0,Math.floor(t.length*e))}...`,r=this.context2D.measureText(t).width}this.context2D.fillStyle="#FFFFFF",this.context2D.fillText(t,(this.texsizeX-r)/2,this.texsizeY/2);const i=new Uint8Array(this.context2D.getImageData(0,0,this.texsizeX,this.texsizeY).data.buffer);this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY}buildPositions(){const e=[];for(let t=0;t<8;t++){const r=.2857142857142857*t-1;for(let t=0;t<16;t++){const i=.13333333333333333*t-1;e.push(i,-r,0)}}const t=[];for(let e=0;e<7;e++)for(let r=0;r<15;r++){const i=r+16*e,n=r+16*(e+1),a=r+1+16*(e+1),s=r+1+16*e;t.push(i,n,s),t.push(n,a,s)}this.vertices=new Float32Array(e),this.indices=new Uint16Array(t)}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       in vec2 aUv;\n       out vec2 uv_orig;\n       out vec2 uv;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n         uv_orig = aPos * halfmad + halfmad;\n         uv = aUv;\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv_orig;\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n       uniform float textColor;\n\n       void main(void) {\n         fragColor = texture(uTexture, uv) * vec4(textColor);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.uvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.textColorLoc=this.gl.getUniformLocation(this.shaderProgram,"textColor")}generateUvs(e,t,r){const i=[];for(let r=0;r<8;r++)for(let n=0;n<16;n++){const a=n/15*2-1;let s=2*(.75*(r/7-.5)+.5)-1;e>=1&&(s+=1/this.texsizeY),i.push(a,t?s:-s)}const n=Math.max(0,1-1.5*e)**1.8*1.3;for(let e=0;e<8;e++)for(let t=0;t<16;t++){const a=16*e+t;i[a]+=.07*n*Math.sin(.31*r.time+.39*i[a]-1.94*i[a+1]),i[a]+=.044*n*Math.sin(.81*r.time-1.91*i[a]+.27*i[a+1]),i[a]+=.061*n*Math.sin(1.31*r.time+.61*i[a]+.74*i[a+1]),i[a+1]+=.061*n*Math.sin(.37*r.time+1.83*i[a]+.69*i[a+1]),i[a+1]+=.07*n*Math.sin(.67*r.time+.42*i[a]-1.39*i[a+1]),i[a+1]+=.087*n*Math.sin(1.07*r.time+3.55*i[a]+.89*i[a+1])}const a=1.01/(e**.21+.01);for(let e=0;e<i.length/2;e++)i[2*e]*=a,i[2*e+1]*=a*this.invAspecty,i[2*e]=(i[2*e]+1)/2,i[2*e+1]=(i[2*e+1]+1)/2;return new Float32Array(i)}renderTitle(e,t,r){this.gl.useProgram(this.shaderProgram);const i=this.generateUvs(e,t,r);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,i,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.uvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.uvLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.uniform1i(this.textureLoc,0),this.gl.uniform1f(this.textColorLoc,e**.3),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0)}}},"./src/rendering/waves/basicWaveform.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var i=r("./src/rendering/shaders/shaderUtils.js"),n=r("./src/rendering/waves/waveUtils.js");class a{constructor(e,t={}){this.gl=e,this.positions=new Float32Array(1536),this.positions2=new Float32Array(1536),this.oldPositions=new Float32Array(1536),this.oldPositions2=new Float32Array(1536),this.smoothedPositions=new Float32Array(3069),this.smoothedPositions2=new Float32Array(3069),this.color=[0,0,0,1],this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      uniform vec2 thickOffset;\n      void main(void) {\n        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 u_color;\n      void main(void) {\n        fragColor = u_color;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}static processWaveform(e,t){const r=[],i=t.wave_scale/128,n=t.wave_smoothing,a=i*(1-n);r.push(e[0]*i);for(let t=1;t<e.length;t++)r.push(e[t]*a+r[t-1]*n);return r}generateWaveform(e,t,r,i,s){let o=s.wave_a;const l=(s.bass+s.mid+s.treb)/3;if(l>-.01&&o>.001&&r.length>0){const c=a.processWaveform(r,s),u=a.processWaveform(i,s),h=Math.floor(s.wave_mode)%8,d=Math.floor(s.old_wave_mode)%8,f=2*s.wave_x-1,m=2*s.wave_y-1;this.numVert=0,this.oldNumVert=0;const p=e&&h!==d?2:1;for(let e=0;e<p;e++){const t=0===e?h:d;let r,i,n,a=s.wave_mystery;if(0!==t&&1!==t&&4!==t||!(a<-1||a>1)||(a=.5*a+.5,a-=Math.floor(a),a=Math.abs(a),a=2*a-1),0===e?(i=this.positions,n=this.positions2):(i=this.oldPositions,n=this.oldPositions2),o=s.wave_a,0===t){if(s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=Math.floor(c.length/2)+1;const e=1/(r-1),t=Math.floor((c.length-r)/2);for(let n=0;n<r-1;n++){let o=.5+.4*u[n+t]+a;const l=n*e*2*Math.PI+.2*s.time;if(n<r/10){let e=n/(.1*r);e=.5-.5*Math.cos(e*Math.PI),o=(1-e)*(.5+.4*u[n+r+t]+a)+o*e}i[3*n+0]=o*Math.cos(l)*this.aspecty+f,i[3*n+1]=o*Math.sin(l)*this.aspectx+m,i[3*n+2]=0}i[3*(r-1)+0]=i[0],i[3*(r-1)+1]=i[1],i[3*(r-1)+2]=0}else if(1===t){if(o*=1.25,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=Math.floor(c.length/2);for(let e=0;e<r;e++){const t=.53+.43*u[e]+a,r=.5*c[e+32]*Math.PI+2.3*s.time;i[3*e+0]=t*Math.cos(r)*this.aspecty+f,i[3*e+1]=t*Math.sin(r)*this.aspectx+m,i[3*e+2]=0}}else if(2===t){if(this.texsizeX<1024?o*=.09:this.texsizeX>=1024&&this.texsizeX<2048?o*=.11:o*=.13,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=c.length;for(let e=0;e<c.length;e++)i[3*e+0]=u[e]*this.aspecty+f,i[3*e+1]=c[(e+32)%c.length]*this.aspectx+m,i[3*e+2]=0}else if(3===t){if(this.texsizeX<1024?o*=.15:this.texsizeX>=1024&&this.texsizeX<2048?o*=.22:o*=.33,o*=1.3,o*=s.treb*s.treb,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=c.length;for(let e=0;e<c.length;e++)i[3*e+0]=u[e]*this.aspecty+f,i[3*e+1]=c[(e+32)%c.length]*this.aspectx+m,i[3*e+2]=0}else if(4===t){if(s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=c.length,r>this.texsizeX/3&&(r=Math.floor(this.texsizeX/3));const e=1/r,t=Math.floor((c.length-r)/2),n=.45+.5*(.5*a+.5),h=1-n;for(let a=0;a<r;a++){let r=2*a*e+(f-1)+.44*u[(a+25+t)%c.length],s=.47*c[a+t]+m;a>1&&(r=r*h+n*(2*i[3*(a-1)+0]-i[3*(a-2)+0]),s=s*h+n*(2*i[3*(a-1)+1]-i[3*(a-2)+1])),i[3*a+0]=r,i[3*a+1]=s,i[3*a+2]=0}}else if(5===t){if(this.texsizeX<1024?o*=.09:this.texsizeX>=1024&&this.texsizeX<2048?o*=.11:o*=.13,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1);const e=Math.cos(.3*s.time),t=Math.sin(.3*s.time);r=c.length;for(let r=0;r<c.length;r++){const n=(r+32)%c.length,a=u[r]*c[n]+c[r]*u[n],s=u[r]*u[r]-c[n]*c[n];i[3*r+0]=(a*e-s*t)*(this.aspecty+f),i[3*r+1]=(a*t+s*e)*(this.aspectx+m),i[3*r+2]=0}}else if(6===t||7===t){if(s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=Math.floor(c.length/2),r>this.texsizeX/3&&(r=Math.floor(this.texsizeX/3));const e=Math.floor((c.length-r)/2),h=.5*Math.PI*a;let d=Math.cos(h),p=Math.sin(h);const g=[f*Math.cos(h+.5*Math.PI)-3*d,f*Math.cos(h+.5*Math.PI)+3*d],A=[f*Math.sin(h+.5*Math.PI)-3*p,f*Math.sin(h+.5*Math.PI)+3*p];for(let e=0;e<2;e++)for(let t=0;t<4;t++){let r,i=!1;switch(t){case 0:g[e]>1.1&&(r=(1.1-g[1-e])/(g[e]-g[1-e]),i=!0);break;case 1:g[e]<-1.1&&(r=(-1.1-g[1-e])/(g[e]-g[1-e]),i=!0);break;case 2:A[e]>1.1&&(r=(1.1-A[1-e])/(A[e]-A[1-e]),i=!0);break;case 3:A[e]<-1.1&&(r=(-1.1-A[1-e])/(A[e]-A[1-e]),i=!0)}if(i){const t=g[e]-g[1-e],i=A[e]-A[1-e];g[e]=g[1-e]+t*r,A[e]=A[1-e]+i*r}}d=(g[1]-g[0])/r,p=(A[1]-A[0])/r;const b=Math.atan2(p,d),v=Math.cos(b+.5*Math.PI),y=Math.sin(b+.5*Math.PI);if(6===t)for(let t=0;t<r;t++){const r=c[t+e];i[3*t+0]=g[0]+d*t+.25*v*r,i[3*t+1]=A[0]+p*t+.25*y*r,i[3*t+2]=0}else if(7===t){const t=(.5*m+.5)**2;for(let n=0;n<r;n++){const r=c[n+e];i[3*n+0]=g[0]+d*n+v*(.25*r+t),i[3*n+1]=A[0]+p*n+y*(.25*r+t),i[3*n+2]=0}for(let i=0;i<r;i++){const r=u[i+e];n[3*i+0]=g[0]+d*i+v*(.25*r-t),n[3*i+1]=A[0]+p*i+y*(.25*r-t),n[3*i+2]=0}}}0===e?(this.positions=i,this.positions2=n,this.numVert=r,this.alpha=o):(this.oldPositions=i,this.oldPositions2=n,this.oldNumVert=r,this.oldAlpha=o)}const g=.5-.5*Math.cos(t*Math.PI),A=1-g;this.oldNumVert>0&&(o=g*this.alpha+A*this.oldAlpha);let b=Math.clamp(s.wave_r,0,1),v=Math.clamp(s.wave_g,0,1),y=Math.clamp(s.wave_b,0,1);if(0!==s.wave_brighten){const e=Math.max(b,v,y);e>.01&&(b/=e,v/=e,y/=e)}if(this.color=[b,v,y,o],this.oldNumVert>0)if(7===h){const e=(this.oldNumVert-1)/(2*this.numVert);for(let t=0;t<this.numVert;t++){const r=t*e,i=Math.floor(r),n=r-i,a=this.oldPositions[3*i+0]*(1-n)+this.oldPositions[3*(i+1)+0]*n,s=this.oldPositions[3*i+1]*(1-n)+this.oldPositions[3*(i+1)+1]*n;this.positions[3*t+0]=this.positions[3*t+0]*g+a*A,this.positions[3*t+1]=this.positions[3*t+1]*g+s*A,this.positions[3*t+2]=0}for(let t=0;t<this.numVert;t++){const r=(t+this.numVert)*e,i=Math.floor(r),n=r-i,a=this.oldPositions[3*i+0]*(1-n)+this.oldPositions[3*(i+1)+0]*n,s=this.oldPositions[3*i+1]*(1-n)+this.oldPositions[3*(i+1)+1]*n;this.positions2[3*t+0]=this.positions2[3*t+0]*g+a*A,this.positions2[3*t+1]=this.positions2[3*t+1]*g+s*A,this.positions2[3*t+2]=0}}else if(7===d){const e=this.numVert/2,t=(this.oldNumVert-1)/e;for(let r=0;r<e;r++){const e=r*t,i=Math.floor(e),n=e-i,a=this.oldPositions[3*i+0]*(1-n)+this.oldPositions[3*(i+1)+0]*n,s=this.oldPositions[3*i+1]*(1-n)+this.oldPositions[3*(i+1)+1]*n;this.positions[3*r+0]=this.positions[3*r+0]*g+a*A,this.positions[3*r+1]=this.positions[3*r+1]*g+s*A,this.positions[3*r+2]=0}for(let r=0;r<e;r++){const i=r*t,n=Math.floor(i),a=i-n,s=this.oldPositions2[3*n+0]*(1-a)+this.oldPositions2[3*(n+1)+0]*a,o=this.oldPositions2[3*n+1]*(1-a)+this.oldPositions2[3*(n+1)+1]*a;this.positions2[3*r+0]=this.positions[3*(r+e)+0]*g+s*A,this.positions2[3*r+1]=this.positions[3*(r+e)+1]*g+o*A,this.positions2[3*r+2]=0}}else{const e=(this.oldNumVert-1)/this.numVert;for(let t=0;t<this.numVert;t++){const r=t*e,i=Math.floor(r),n=r-i,a=this.oldPositions[3*i+0]*(1-n)+this.oldPositions[3*(i+1)+0]*n,s=this.oldPositions[3*i+1]*(1-n)+this.oldPositions[3*(i+1)+1]*n;this.positions[3*t+0]=this.positions[3*t+0]*g+a*A,this.positions[3*t+1]=this.positions[3*t+1]*g+s*A,this.positions[3*t+2]=0}}for(let e=0;e<this.numVert;e++)this.positions[3*e+1]=-this.positions[3*e+1];if(this.smoothedNumVert=2*this.numVert-1,n.default.smoothWave(this.positions,this.smoothedPositions,this.numVert),7===h||7===d){for(let e=0;e<this.numVert;e++)this.positions2[3*e+1]=-this.positions2[3*e+1];n.default.smoothWave(this.positions2,this.smoothedPositions2,this.numVert)}return!0}return!1}drawBasicWaveform(e,t,r,i,n){if(this.generateWaveform(e,t,r,i,n)){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color);let e=1;0===n.wave_thick&&0===n.wave_dots||(e=4),0!==n.additivewave?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const t=0!==n.wave_dots?this.gl.POINTS:this.gl.LINE_STRIP;for(let r=0;r<e;r++){const e=2;0===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===r?this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,0]):2===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,e/this.texsizeY]):3===r&&this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,e/this.texsizeY]),this.gl.drawArrays(t,0,this.smoothedNumVert)}if(7==Math.floor(n.wave_mode)%8){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions2,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc);for(let r=0;r<e;r++){const e=2;0===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===r?this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,0]):2===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,e/this.texsizeY]):3===r&&this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,e/this.texsizeY]),this.gl.drawArrays(t,0,this.smoothedNumVert)}}}}}},"./src/rendering/waves/customWaveform.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return s}));var i=r("./src/utils.js"),n=r("./src/rendering/shaders/shaderUtils.js"),a=r("./src/rendering/waves/waveUtils.js");class s{constructor(e,t,r){this.index=e,this.gl=t;this.pointsData=[new Float32Array(512),new Float32Array(512)],this.positions=new Float32Array(1536),this.colors=new Float32Array(2048),this.smoothedPositions=new Float32Array(3069),this.smoothedColors=new Float32Array(4092),this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      uniform float uSize;\n      uniform vec2 thickOffset;\n      in vec3 aPos;\n      in vec4 aColor;\n      out vec4 vColor;\n      void main(void) {\n        vColor = aColor;\n        gl_PointSize = uSize;\n        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      in vec4 vColor;\n      out vec4 fragColor;\n      void main(void) {\n        fragColor = vColor;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.sizeLoc=this.gl.getUniformLocation(this.shaderProgram,"uSize"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}generateWaveform(e,t,r,n,s,o,l,c){if(0!==l.baseVals.enabled&&e.length>0){let u;if(o.preset.useWASM)u=o.runWaveFrameEquations(this.index,s);else{const e=Object.assign({},o.mdVSWaves[this.index],o.mdVSFrameMapWaves[this.index],o.mdVSQAfterFrame,o.mdVSTWaveInits[this.index],s);u=o.runWaveFrameEquations(this.index,e)}const h=512;Object.prototype.hasOwnProperty.call(u,"samples")?this.samples=u.samples:this.samples=h,this.samples>h&&(this.samples=h),this.samples=Math.floor(this.samples);const d=o.preset.waves[this.index].baseVals,f=Math.floor(u.sep),m=u.scaling,p=u.spectrum,g=u.smoothing,A=d.usedots,b=u.r,v=u.g,y=u.b,w=u.a,E=o.preset.baseVals.wave_scale;if(this.samples-=f,this.samples>=2||0!==A&&this.samples>=1){const s=0!==p,_=(s?.15:.004)*m*E,T=s?r:e,S=s?n:t,x=s?0:Math.floor((h-this.samples)/2-f/2),k=s?0:Math.floor((h-this.samples)/2+f/2),I=s?(h-f)/this.samples:1,C=(.98*g)**.5,P=1-C;this.pointsData[0][0]=T[x],this.pointsData[1][0]=S[k];for(let e=1;e<this.samples;e++){const t=T[Math.floor(e*I+x)],r=S[Math.floor(e*I+k)];this.pointsData[0][e]=t*P+this.pointsData[0][e-1]*C,this.pointsData[1][e]=r*P+this.pointsData[1][e-1]*C}for(let e=this.samples-2;e>=0;e--)this.pointsData[0][e]=this.pointsData[0][e]*P+this.pointsData[0][e+1]*C,this.pointsData[1][e]=this.pointsData[1][e]*P+this.pointsData[1][e+1]*C;for(let e=0;e<this.samples;e++)this.pointsData[0][e]*=_,this.pointsData[1][e]*=_;if(o.preset.useWASM){const e=o.preset.globalPools[`wavePerFrame${this.index}`];for(let t=0;t<this.samples;t++){const r=this.pointsData[0][t],i=this.pointsData[1][t];e.sample.value=t/(this.samples-1),e.value1.value=r,e.value2.value=i,e.x.value=.5+r,e.y.value=.5+i,e.r.value=b,e.g.value=v,e.b.value=y,e.a.value=w,l.point_eqs&&o.preset.waves[this.index].point_eqs();const n=(2*e.x.value-1)*this.invAspectx,a=(-2*e.y.value+1)*this.invAspecty,s=e.r.value,u=e.g.value,h=e.b.value,d=e.a.value;this.positions[3*t+0]=n,this.positions[3*t+1]=a,this.positions[3*t+2]=0,this.colors[4*t+0]=s,this.colors[4*t+1]=u,this.colors[4*t+2]=h,this.colors[4*t+3]=d*c}}else for(let e=0;e<this.samples;e++){const t=this.pointsData[0][e],r=this.pointsData[1][e];u.sample=e/(this.samples-1),u.value1=t,u.value2=r,u.x=.5+t,u.y=.5+r,u.r=b,u.g=v,u.b=y,u.a=w,""!==l.point_eqs&&(u=o.runWavePointEquations(this.index,u));const i=(2*u.x-1)*this.invAspectx,n=(-2*u.y+1)*this.invAspecty,a=u.r,s=u.g,h=u.b,d=u.a;this.positions[3*e+0]=i,this.positions[3*e+1]=n,this.positions[3*e+2]=0,this.colors[4*e+0]=a,this.colors[4*e+1]=s,this.colors[4*e+2]=h,this.colors[4*e+3]=d*c}if(o.preset.useWASM)u.usedots=A,u.thick=d.thick,u.additive=d.additive;else{const e=o.mdVSUserKeysWaves[this.index],t=i.default.pick(u,e);o.mdVSFrameMapWaves[this.index]=t}return this.mdVSWaveFrame=u,0===A&&a.default.smoothWaveAndColor(this.positions,this.colors,this.smoothedPositions,this.smoothedColors,this.samples),!0}}return!1}drawCustomWaveform(e,t,r,i,n,a,s,o){if(o&&this.generateWaveform(t,r,i,n,a,s,o,e)){this.gl.useProgram(this.shaderProgram);const e=0!==this.mdVSWaveFrame.usedots,t=0!==this.mdVSWaveFrame.thick,r=0!==this.mdVSWaveFrame.additive;let i,n,a;e?(i=this.positions,n=this.colors,a=this.samples):(i=this.smoothedPositions,n=this.smoothedColors,a=2*this.samples-1),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,i,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation);let s=1;e?t?this.gl.uniform1f(this.sizeLoc,2+(this.texsizeX>=1024?1:0)):this.gl.uniform1f(this.sizeLoc,1+(this.texsizeX>=1024?1:0)):(this.gl.uniform1f(this.sizeLoc,1),t&&(s=4)),r?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const o=e?this.gl.POINTS:this.gl.LINE_STRIP;for(let e=0;e<s;e++){const t=2;0===e?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===e?this.gl.uniform2fv(this.thickOffsetLoc,[t/this.texsizeX,0]):2===e?this.gl.uniform2fv(this.thickOffsetLoc,[0,t/this.texsizeY]):3===e&&this.gl.uniform2fv(this.thickOffsetLoc,[t/this.texsizeX,t/this.texsizeY]),this.gl.drawArrays(o,0,a)}}}}},"./src/rendering/waves/waveUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));class i{static smoothWave(e,t,r,i=!1){let n,a=0,s=0,o=1;for(let l=0;l<r-1;l++){n=o,o=Math.min(r-1,l+2);for(let r=0;r<3;r++)t[3*a+r]=e[3*l+r];if(i)for(let r=0;r<3;r++)t[3*(a+1)+r]=.5*(-.15*e[3*s+r]+1.15*e[3*l+r]+1.15*e[3*n+r]+-.15*e[3*o+r]);else{for(let r=0;r<2;r++)t[3*(a+1)+r]=.5*(-.15*e[3*s+r]+1.15*e[3*l+r]+1.15*e[3*n+r]+-.15*e[3*o+r]);t[3*(a+1)+2]=0}s=l,a+=2}for(let i=0;i<3;i++)t[3*a+i]=e[3*(r-1)+i]}static smoothWaveAndColor(e,t,r,i,n,a=!1){let s,o=0,l=0,c=1;for(let u=0;u<n-1;u++){s=c,c=Math.min(n-1,u+2);for(let t=0;t<3;t++)r[3*o+t]=e[3*u+t];if(a)for(let t=0;t<3;t++)r[3*(o+1)+t]=.5*(-.15*e[3*l+t]+1.15*e[3*u+t]+1.15*e[3*s+t]+-.15*e[3*c+t]);else{for(let t=0;t<2;t++)r[3*(o+1)+t]=.5*(-.15*e[3*l+t]+1.15*e[3*u+t]+1.15*e[3*s+t]+-.15*e[3*c+t]);r[3*(o+1)+2]=0}for(let e=0;e<4;e++)i[4*o+e]=t[4*u+e],i[4*(o+1)+e]=t[4*u+e];l=u,o+=2}for(let t=0;t<3;t++)r[3*o+t]=e[3*(n-1)+t];for(let e=0;e<4;e++)i[4*o+e]=t[4*(n-1)+e]}}},"./src/utils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));class i{static atan2(e,t){let r=Math.atan2(e,t);return r<0&&(r+=2*Math.PI),r}static cloneVars(e){return Object.assign({},e)}static range(e,t){return void 0===t?[...Array(e).keys()]:Array.from({length:t-e},((t,r)=>r+e))}static pick(e,t){const r={};for(let i=0;i<t.length;i++){const n=t[i];r[n]=e[n]||0}return r}static omit(e,t){const r=Object.assign({},e);for(let e=0;e<t.length;e++)delete r[t[e]];return r}static setWasm(e,t,r){for(let i=0;i<r.length;i++){const n=r[i];e[n].value=t[n]}}static pickWasm(e,t){const r={};for(let i=0;i<t.length;i++){const n=t[i];r[n]=e[n].value}return r}}},"./src/visualizer.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return m}));var i=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),n=r.n(i),a=r("./node_modules/eel-wasm/dist/src/index.js"),s=r("./node_modules/@assemblyscript/loader/index.js"),o=r("./src/audio/audioProcessor.js"),l=r("./src/rendering/renderer.js"),c=r("./src/utils.js"),u=r("./src/assemblyscript/presetFunctions.ts"),h=r.n(u);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){n()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class m{constructor(e,t,r){this.opts=r,this.audio=new o.default(e);const i=r.width||1200,n=r.height||900;this.internalCanvas=document.createElement("canvas"),this.internalCanvas.width=i,this.internalCanvas.height=n,this.gl=this.internalCanvas.getContext("webgl2",{alpha:!1,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1}),this.outputGl=t.getContext("2d"),this.baseValsDefaults={decay:.98,gammaadj:2,echo_zoom:2,echo_alpha:0,echo_orient:0,red_blue:0,brighten:0,darken:0,wrap:1,darken_center:0,solarize:0,invert:0,bmotionvectorson:1,fshader:0,b1n:0,b2n:0,b3n:0,b1x:1,b2x:1,b3x:1,b1ed:.25,wave_mode:0,additivewave:0,wave_dots:0,wave_thick:0,wave_a:.8,wave_scale:1,wave_smoothing:.75,wave_mystery:0,modwavealphabyvolume:0,modwavealphastart:.75,modwavealphaend:.95,wave_r:1,wave_g:1,wave_b:1,wave_x:.5,wave_y:.5,wave_brighten:1,mv_x:12,mv_y:9,mv_dx:0,mv_dy:0,mv_l:.9,mv_r:1,mv_g:1,mv_b:1,mv_a:1,warpanimspeed:1,warpscale:1,zoomexp:1,zoom:1,rot:0,cx:.5,cy:.5,dx:0,dy:0,warp:1,sx:1,sy:1,ob_size:.01,ob_r:0,ob_g:0,ob_b:0,ob_a:0,ib_size:.01,ib_r:.25,ib_g:.25,ib_b:.25,ib_a:0},this.shapeBaseValsDefaults={enabled:0,sides:4,additive:0,thickoutline:0,textured:0,num_inst:1,tex_zoom:1,tex_ang:0,x:.5,y:.5,rad:.1,ang:0,r:1,g:0,b:0,a:1,r2:0,g2:1,b2:0,a2:0,border_r:1,border_g:1,border_b:1,border_a:.1},this.waveBaseValsDefaults={enabled:0,samples:512,sep:0,scaling:1,smoothing:.5,r:1,g:1,b:1,a:1,spectrum:0,usedots:0,thick:0,additive:0},this.qs=c.default.range(1,33).map((e=>`q${e}`)),this.ts=c.default.range(1,9).map((e=>`t${e}`)),this.globalPerFrameVars=["old_wave_mode","frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset"],this.globalPerPixelVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","x","y","rad","ang"],this.globalShapeVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","instance"],this.shapeBaseVars=["x","y","rad","ang","r","g","b","a","r2","g2","b2","a2","border_r","border_g","border_b","border_a","thickoutline","textured","tex_zoom","tex_ang","additive"],this.globalWaveVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","x","y","sample","value1","value2"],this.renderer=new l.default(this.gl,this.audio,r)}loseGLContext(){this.gl.getExtension("WEBGL_lose_context").loseContext(),this.outputGl=null}connectAudio(e){this.audioNode=e,this.audio.connectAudio(e)}disconnectAudio(e){this.audio.disconnectAudio(e)}static overrideDefaultVars(e,t){const r={};return Object.keys(e).forEach((i=>{Object.prototype.hasOwnProperty.call(t,i)?r[i]=t[i]:r[i]=e[i]})),r}createQVars(){const e={};return this.qs.forEach((t=>{e[t]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),e}createTVars(){const e={};return this.ts.forEach((t=>{e[t]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),e}createPerFramePool(e){const t={};return Object.keys(this.baseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalPerFrameVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}createPerPixelPool(e){const t={};return Object.keys(this.baseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalPerPixelVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}createCustomShapePerFramePool(e){const t={};return Object.keys(this.shapeBaseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalShapeVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}createCustomWavePerFramePool(e){const t={};return Object.keys(this.waveBaseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalWaveVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}static makeShapeResetPool(e,t,r){return t.reduce(((t,i)=>f(f({},t),{},{[`${i}_${r}`]:e[i]})),{})}static base64ToArrayBuffer(e){for(var t=window.atob(e),r=t.length,i=new Uint8Array(r),n=0;n<r;n++)i[n]=t.charCodeAt(n);return i.buffer}async loadPreset(e,t=0){const r=JSON.parse(JSON.stringify(e));r.baseVals=m.overrideDefaultVars(this.baseValsDefaults,r.baseVals);for(let e=0;e<r.shapes.length;e++)r.shapes[e].baseVals=m.overrideDefaultVars(this.shapeBaseValsDefaults,r.shapes[e].baseVals);for(let e=0;e<r.waves.length;e++)r.waves[e].baseVals=m.overrideDefaultVars(this.waveBaseValsDefaults,r.waves[e].baseVals);const i=r.useJS&&!this.opts.onlyUseWASM;Object.prototype.hasOwnProperty.call(r,"init_eqs_eel")&&!i?(r.useWASM=!0,await this.loadWASMPreset(r,t)):this.opts.onlyUseWASM?console.warn("Tried to load a preset that doesn't support WASM with onlyUseWASM on"):Object.prototype.hasOwnProperty.call(r,"init_eqs_str")?this.loadJSPreset(r,t):console.warn("Tried to load a JS preset that doesn't have converted strings")}async loadWASMPreset(e,t){const r=this.createQVars(),i=this.createTVars(),n={perFrame:f(f({},r),this.createPerFramePool(e.baseVals)),perVertex:f(f({},r),this.createPerPixelPool(e.baseVals))},o={presetInit:{pool:"perFrame",code:e.init_eqs_eel},perFrame:{pool:"perFrame",code:e.frame_eqs_eel}};""!==e.pixel_eqs_eel&&(o.perPixel={pool:"perVertex",code:e.pixel_eqs_eel});for(let t=0;t<e.shapes.length;t++)n[`shapePerFrame${t}`]=f(f(f({},r),i),this.createCustomShapePerFramePool(e.shapes[t].baseVals)),0!==e.shapes[t].baseVals.enabled&&(o[`shapes_${t}_init_eqs`]={pool:`shapePerFrame${t}`,code:e.shapes[t].init_eqs_eel},o[`shapes_${t}_frame_eqs`]={pool:`shapePerFrame${t}`,code:e.shapes[t].frame_eqs_eel});for(let t=0;t<e.waves.length;t++)0!==e.waves[t].baseVals.enabled&&(n[`wavePerFrame${t}`]=f(f(f({},r),i),this.createCustomWavePerFramePool(e.waves[t].baseVals)),o[`waves_${t}_init_eqs`]={pool:`wavePerFrame${t}`,code:e.waves[t].init_eqs_eel},o[`waves_${t}_frame_eqs`]={pool:`wavePerFrame${t}`,code:e.waves[t].frame_eqs_eel},e.waves[t].point_eqs_eel&&""!==e.waves[t].point_eqs_eel&&(o[`waves_${t}_point_eqs`]={pool:`wavePerFrame${t}`,code:e.waves[t].point_eqs_eel}));const l=await Object(a.loadModule)({pools:n,functions:o,eelVersion:e.version||2}),c=e=>e||(()=>{}),u=await s.default.instantiate(m.base64ToArrayBuffer(h()()),{pixelEqs:{perPixelEqs:c(l.exports.perPixel)},pixelVarPool:{warp:n.perVertex.warp,zoom:n.perVertex.zoom,zoomexp:n.perVertex.zoomexp,cx:n.perVertex.cx,cy:n.perVertex.cy,sx:n.perVertex.sx,sy:n.perVertex.sy,dx:n.perVertex.dx,dy:n.perVertex.dy,rot:n.perVertex.rot,x:n.perVertex.x,y:n.perVertex.y,ang:n.perVertex.ang,rad:n.perVertex.rad},qVarPool:r,tVarPool:i,shapePool0:m.makeShapeResetPool(n.shapePerFrame0,this.shapeBaseVars,0),shapePool1:m.makeShapeResetPool(n.shapePerFrame1,this.shapeBaseVars,1),shapePool2:m.makeShapeResetPool(n.shapePerFrame2,this.shapeBaseVars,2),shapePool3:m.makeShapeResetPool(n.shapePerFrame3,this.shapeBaseVars,3),console:{logi:e=>{console.log("logi: "+e)},logf:e=>{console.log("logf: "+e)}},env:{abort:()=>{}}});e.globalPools=n,e.init_eqs=c(l.exports.presetInit),e.frame_eqs=c(l.exports.perFrame),e.save_qs=u.exports.saveQs,e.restore_qs=u.exports.restoreQs,e.save_ts=u.exports.saveTs,e.restore_ts=u.exports.restoreTs,l.exports.perPixel&&(e.pixel_eqs=l.exports.perPixel),e.pixel_eqs_initialize_array=(t,r)=>{const i=u.exports.createFloat32Array((t+1)*(r+1)*2);e.pixel_eqs_array=i},e.pixel_eqs_get_array=()=>u.exports.__getFloat32ArrayView(e.pixel_eqs_array),e.pixel_eqs_wasm=(...t)=>u.exports.runPixelEquations(e.pixel_eqs_array,...t);for(let t=0;t<e.shapes.length;t++)0!==e.shapes[t].baseVals.enabled&&(e.shapes[t].init_eqs=c(l.exports[`shapes_${t}_init_eqs`]),e.shapes[t].frame_eqs=l.exports[`shapes_${t}_frame_eqs`],e.shapes[t].frame_eqs_save=()=>u.exports[`shape${t}_save`](),e.shapes[t].frame_eqs_restore=()=>u.exports[`shape${t}_restore`]());for(let t=0;t<e.waves.length;t++)if(0!==e.waves[t].baseVals.enabled){const r={init_eqs:c(l.exports[`waves_${t}_init_eqs`]),frame_eqs:c(l.exports[`waves_${t}_frame_eqs`])};e.waves[t].point_eqs_eel&&""!==e.waves[t].point_eqs_eel?r.point_eqs=l.exports[`waves_${t}_point_eqs`]:r.point_eqs="",e.waves[t]=Object.assign({},e.waves[t],r)}this.renderer.loadPreset(e,t)}loadJSPreset(e,t){if("function"!=typeof e.init_eqs){e.init_eqs=new Function("a",`${e.init_eqs_str} return a;`),e.frame_eqs=new Function("a",`${e.frame_eqs_str} return a;`),e.pixel_eqs_str&&""!==e.pixel_eqs_str?e.pixel_eqs=new Function("a",`${e.pixel_eqs_str} return a;`):e.pixel_eqs="";for(let t=0;t<e.shapes.length;t++)0!==e.shapes[t].baseVals.enabled&&(e.shapes[t]=Object.assign({},e.shapes[t],{init_eqs:new Function("a",`${e.shapes[t].init_eqs_str} return a;`),frame_eqs:new Function("a",`${e.shapes[t].frame_eqs_str} return a;`)}));for(let t=0;t<e.waves.length;t++)if(0!==e.waves[t].baseVals.enabled){const r={init_eqs:new Function("a",`${e.waves[t].init_eqs_str} return a;`),frame_eqs:new Function("a",`${e.waves[t].frame_eqs_str} return a;`)};e.waves[t].point_eqs_str&&""!==e.waves[t].point_eqs_str?r.point_eqs=new Function("a",`${e.waves[t].point_eqs_str} return a;`):r.point_eqs="",e.waves[t]=Object.assign({},e.waves[t],r)}}this.renderer.loadPreset(e,t)}loadExtraImages(e){this.renderer.loadExtraImages(e)}setRendererSize(e,t,r={}){this.internalCanvas.width=e,this.internalCanvas.height=t,this.renderer.setRendererSize(e,t,r)}setInternalMeshSize(e,t){this.renderer.setInternalMeshSize(e,t)}setOutputAA(e){this.renderer.setOutputAA(e)}setCanvas(e){this.outputGl=e.getContext("2d")}render(e){const t=this.renderer.render(e);return this.outputGl&&this.outputGl.drawImage(this.internalCanvas,0,0),t}launchSongTitleAnim(e){this.renderer.launchSongTitleAnim(e)}toDataURL(){return this.renderer.toDataURL()}warpBufferToDataURL(){return this.renderer.warpBufferToDataURL()}}}})},e.exports=t()},487:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=t},7811:(e,t)=>{"use strict";var r=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,i=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,n=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,a=/\\([\u000b\u0020-\u00ff])/g,s=/([\\"])/g,o=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;function l(e){var t=String(e);if(n.test(t))return t;if(t.length>0&&!i.test(t))throw new TypeError("invalid parameter value");return'"'+t.replace(s,"\\$1")+'"'}function c(e){this.parameters=Object.create(null),this.type=e}t.format=function(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var t=e.parameters,r=e.type;if(!r||!o.test(r))throw new TypeError("invalid type");var i=r;if(t&&"object"==typeof t)for(var a,s=Object.keys(t).sort(),c=0;c<s.length;c++){if(a=s[c],!n.test(a))throw new TypeError("invalid parameter name");i+="; "+a+"="+l(t[a])}return i},t.parse=function(e){if(!e)throw new TypeError("argument string is required");var t="object"==typeof e?function(e){var t;if("function"==typeof e.getHeader?t=e.getHeader("content-type"):"object"==typeof e.headers&&(t=e.headers&&e.headers["content-type"]),"string"!=typeof t)throw new TypeError("content-type header is missing from object");return t}(e):e;if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var i=t.indexOf(";"),n=-1!==i?t.substr(0,i).trim():t.trim();if(!o.test(n))throw new TypeError("invalid media type");var s=new c(n.toLowerCase());if(-1!==i){var l,u,h;for(r.lastIndex=i;u=r.exec(t);){if(u.index!==i)throw new TypeError("invalid parameter format");i+=u[0].length,l=u[1].toLowerCase(),'"'===(h=u[2])[0]&&(h=h.substr(1,h.length-2).replace(a,"$1")),s.parameters[l]=h}if(i!==t.length)throw new TypeError("invalid parameter format")}return s}},1012:e=>{var t,r;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,i=0;r<e.length;r++,i+=8)t[i>>>5]|=e[r]<<24-i%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var r=[],i=0;i<e.length;i+=3)for(var n=e[i]<<16|e[i+1]<<8|e[i+2],a=0;a<4;a++)8*i+6*a<=8*e.length?r.push(t.charAt(n>>>6*(3-a)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],i=0,n=0;i<e.length;n=++i%4)0!=n&&r.push((t.indexOf(e.charAt(i-1))&Math.pow(2,-2*n+8)-1)<<2*n|t.indexOf(e.charAt(i))>>>6-2*n);return r}},e.exports=r},1227:(e,t,r)=>{var i=r(4155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let i=0,n=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(i++,"%c"===e&&(n=i))})),t.splice(n,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(2447)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},2447:(e,t,r)=>{e.exports=function(e){function t(e){let r,n,a,s=null;function o(...e){if(!o.enabled)return;const i=o,n=Number(new Date),a=n-(r||n);i.diff=a,i.prev=r,i.curr=n,r=n,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,n)=>{if("%%"===r)return"%";s++;const a=t.formatters[n];if("function"==typeof a){const t=e[s];r=a.call(i,t),e.splice(s,1),s--}return r})),t.formatArgs.call(i,e),(i.log||t.log).apply(i,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=i,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(n!==t.namespaces&&(n=t.namespaces,a=t.enabled(e)),a),set:e=>{s=e}}),"function"==typeof t.init&&t.init(o),o}function i(e,r){const i=t(this.namespace+(void 0===r?":":r)+e);return i.log=this.log,i}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const i=("string"==typeof e?e:"").split(/[\s,]+/),n=i.length;for(r=0;r<n;r++)i[r]&&("-"===(e=i[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,i;for(r=0,i=t.skips.length;r<i;r++)if(t.skips[r].test(e))return!1;for(r=0,i=t.names.length;r<i;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(7824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},7187:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(r,i){function n(r){e.removeListener(t,a),i(r)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",n),r([].slice.call(arguments))}p(e,t,a,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&p(e,"error",t,{once:!0})}(e,n)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function o(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function c(e,t,r,i){var n,a,s,c;if(o(r),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]),void 0===s)s=a[t]=r,++e._eventsCount;else if("function"==typeof s?s=a[t]=i?[r,s]:[s,r]:i?s.unshift(r):s.push(r),(n=l(e))>0&&s.length>n&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,c=u,console&&console.warn&&console.warn(c)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=u.bind(i);return n.listener=r,i.wrapFn=n,n}function d(e,t,r){var i=e._events;if(void 0===i)return[];var n=i[t];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):m(n,n.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function m(e,t){for(var r=new Array(t),i=0;i<t;++i)r[i]=e[i];return r}function p(e,t,r,i){if("function"==typeof e.on)i.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function n(a){i.once&&e.removeEventListener(t,n),r(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,a=this._events;if(void 0!==a)n=n&&void 0===a.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var l=a[e];if(void 0===l)return!1;if("function"==typeof l)i(l,this,t);else{var c=l.length,u=m(l,c);for(r=0;r<c;++r)i(u[r],this,t)}return!0},a.prototype.addListener=function(e,t){return c(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return c(this,e,t,!0)},a.prototype.once=function(e,t){return o(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,i,n,a,s;if(o(t),void 0===(i=this._events))return this;if(void 0===(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(n=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){s=r[a].listener,n=a;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,a=Object.keys(r);for(i=0;i<a.length;++i)"removeListener"!==(n=a[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return d(this,e,!0)},a.prototype.rawListeners=function(e){return d(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},1:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var Buffer=__webpack_require__(8764).Buffer;const Token=__webpack_require__(3416),strtok3=__webpack_require__(5849),{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=__webpack_require__(6188),supported=__webpack_require__(9898),minimumBytes=4100;async function fromStream(e){const t=await strtok3.fromStream(e);try{return await fromTokenizer(t)}finally{await t.close()}}async function fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||Buffer.isBuffer(e)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof e}\``);const t=e instanceof Buffer?e:Buffer.from(e);if(t&&t.length>1)return fromTokenizer(strtok3.fromBuffer(t))}function _check(e,t,r){r={offset:0,...r};for(const[i,n]of t.entries())if(r.mask){if(n!==(r.mask[i]&e[i+r.offset]))return!1}else if(n!==e[i+r.offset])return!1;return!0}async function fromTokenizer(e){try{return _fromTokenizer(e)}catch(e){if(!(e instanceof strtok3.EndOfStreamError))throw e}}async function _fromTokenizer(e){let t=Buffer.alloc(minimumBytes);const r=(e,r)=>_check(t,e,r),i=(e,t)=>r(stringToBytes(e),t);if(e.fileInfo.size||(e.fileInfo.size=Number.MAX_SAFE_INTEGER),await e.peekBuffer(t,{length:12,mayBeLess:!0}),r([66,77]))return{ext:"bmp",mime:"image/bmp"};if(r([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(r([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(r([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(r([37,33]))return await e.peekBuffer(t,{length:24,mayBeLess:!0}),i("PS-Adobe-",{offset:2})&&i(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(r([31,160])||r([31,157]))return{ext:"Z",mime:"application/x-compress"};if(r([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(r([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(r([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(r([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(i("ID3")){await e.ignore(6);const n=await e.readToken(uint32SyncSafeToken);return e.position+n>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(n),fromTokenizer(e))}if(i("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===t[0]||70===t[0])&&r([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(r([71,73,70]))return{ext:"gif",mime:"image/gif"};if(i("FLIF"))return{ext:"flif",mime:"image/flif"};if(i("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(i("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(i("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(i("FORM"))return{ext:"aif",mime:"audio/aiff"};if(i("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(r([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(t,{length:30});const a={compressedSize:t.readUInt32LE(18),uncompressedSize:t.readUInt32LE(22),filenameLength:t.readUInt16LE(26),extraFieldLength:t.readUInt16LE(28)};if(a.filename=await e.readToken(new Token.StringType(a.filenameLength,"utf-8")),await e.ignore(a.extraFieldLength),"META-INF/mozilla.rsa"===a.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(a.filename.endsWith(".rels")||a.filename.endsWith(".xml"))switch(a.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}if(a.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(a.filename.startsWith("3D/")&&a.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===a.filename&&a.compressedSize===a.uncompressedSize)switch(await e.readToken(new Token.StringType(a.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}if(0===a.compressedSize){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(t,{mayBeLess:!0}),s=t.indexOf("504B0304",0,"hex"),await e.ignore(s>=0?s:t.length)}else await e.ignore(a.compressedSize)}}catch(o){if(!(o instanceof strtok3.EndOfStreamError))throw o}return{ext:"zip",mime:"application/zip"}}if(i("OggS")){await e.ignore(28);const l=Buffer.alloc(8);return await e.readBuffer(l),_check(l,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(l,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(l,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(l,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(l,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(l,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(r([80,75])&&(3===t[2]||5===t[2]||7===t[2])&&(4===t[3]||6===t[3]||8===t[3]))return{ext:"zip",mime:"application/zip"};if(i("ftyp",{offset:4})&&0!=(96&t[8])){const c=t.toString("binary",8,12).replace("\0"," ").trim();switch(c){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return c.startsWith("3g")?c.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(i("MThd"))return{ext:"mid",mime:"audio/midi"};if(i("wOFF")&&(r([0,1,0,0],{offset:4})||i("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(i("wOF2")&&(r([0,1,0,0],{offset:4})||i("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(r([212,195,178,161])||r([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(i("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(i("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(i("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(r([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(i("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(i("%PDF")){await e.ignore(1350);const u=10485760,h=Buffer.alloc(Math.min(u,e.fileInfo.size));return await e.readBuffer(h,{mayBeLess:!0}),h.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(r([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(r([73,73,42,0]))return i("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:r([28,0,254,0],{offset:8})||r([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:r([8,0,0,0],{offset:4})&&(r([45,0,254,0],{offset:8})||r([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(t=Buffer.alloc(24),await e.peekBuffer(t),(r([16,251,134,1],{offset:4})||r([8,0,0,0],{offset:4}))&&r([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(r([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(i("MAC "))return{ext:"ape",mime:"audio/ape"};if(r([26,69,223,163])){async function d(){const t=await e.peekNumber(Token.UINT8);let r=128,i=0;for(;0==(t&r)&&0!==r;)++i,r>>=1;const n=Buffer.alloc(i+1);return await e.readBuffer(n),n}async function f(){const e=await d(),t=await d();t[0]^=128>>t.length-1;const r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}async function m(t,r){for(;r>0;){const t=await f();if(17026===t.id)return e.readToken(new Token.StringType(t.len,"utf-8"));await e.ignore(t.len),--r}}const p=await f();switch(await m(0,p.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(r([82,73,70,70])){if(r([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(r([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(r([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(i("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(r([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(i("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(i("MSCF")||i("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(r([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(r([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(r([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(r([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(i("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(i("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(r([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(i("IMPM"))return{ext:"it",mime:"audio/x-it"};if(i("-lh0-",{offset:2})||i("-lh1-",{offset:2})||i("-lh2-",{offset:2})||i("-lh3-",{offset:2})||i("-lh4-",{offset:2})||i("-lh5-",{offset:2})||i("-lh6-",{offset:2})||i("-lh7-",{offset:2})||i("-lzs-",{offset:2})||i("-lz4-",{offset:2})||i("-lz5-",{offset:2})||i("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(r([0,0,1,186])){if(r([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(r([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(i("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(r([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(i("<?xml "))return{ext:"xml",mime:"application/xml"};if(r([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(r([82,97,114,33,26,7])&&(0===t[6]||1===t[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(i("solid "))return{ext:"stl",mime:"model/stl"};if(i("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(i("!<arch>"))return await e.ignore(8),"debian-binary"===await e.readToken(new Token.StringType(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(r([137,80,78,71,13,10,26,10])){async function g(){return{length:await e.readToken(Token.INT32_BE),type:await e.readToken(new Token.StringType(4,"binary"))}}await e.ignore(8);do{const A=await g();if(A.length<0)return;switch(A.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(A.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(r([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(r([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(r([102,114,101,101],{offset:4})||r([109,100,97,116],{offset:4})||r([109,111,111,118],{offset:4})||r([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(r([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(i("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(r([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(r([48,38,178,117,142,102,207,17,166,217])){async function b(){const t=Buffer.alloc(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(Token.UINT64_LE))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const v=await b();let y=v.size-24;if(_check(v.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const w=Buffer.alloc(16);if(y-=await e.readBuffer(w),_check(w,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(w,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(y)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(r([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((r([126,16,4])||r([126,24,4]))&&r([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(r([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(r([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(r([255,10])||r([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(r([0,0,1,186])||r([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(r([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(r([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(r([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(r([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(t,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),i("BEGIN:")){if(i("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(i("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(i("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(i("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(i("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(r([4,0,0,0])&&t.length>=16){const E=t.readUInt32LE(12);if(E>12&&t.length>=E+16)try{const _=t.slice(16,E+16).toString();if(JSON.parse(_).files)return{ext:"asar",mime:"application/x-asar"}}catch(T){}}if(r([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(i("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(r([71],{offset:4})&&(r([71],{offset:192})||r([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(r([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(r([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(r([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(r([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(r([76,80],{offset:34})&&(r([0,0,1],{offset:8})||r([1,0,2],{offset:8})||r([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(r([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(t,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(t))return{ext:"tar",mime:"application/x-tar"};if(r([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(i("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(t.length>=2&&r([255,224],{offset:0,mask:[255,224]})){if(r([16],{offset:1,mask:[22]}))return r([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(r([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(r([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}const stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",(async()=>{const e=new stream.PassThrough;let t;t=stream.pipeline?stream.pipeline(readableStream,e,(()=>{})):readableStream.pipe(e);const r=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const t=await fromBuffer(r);e.fileType=t}catch(e){reject(e)}resolve(t)}))})),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get:()=>new Set(supported.extensions)}),Object.defineProperty(fileType,"mimeTypes",{get:()=>new Set(supported.mimeTypes)}),module.exports=fileType},9898:e=>{"use strict";e.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}},6188:(e,t)=>{"use strict";t.stringToBytes=e=>[...e].map((e=>e.charCodeAt(0))),t.tarHeaderChecksumMatches=(e,t=0)=>{const r=parseInt(e.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(r))return!1;let i=256;for(let r=t;r<t+148;r++)i+=e[r];for(let r=t+156;r<t+512;r++)i+=e[r];return r===i},t.uint32SyncSafeToken={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4}},6998:function(e){e.exports=function(e,t){if(null==t&&(t={fuzzy:!0}),/youtu\.?be/.test(e)){var r,i=[/youtu\.be\/([^#\&\?]{11})/,/\?v=([^#\&\?]{11})/,/\&v=([^#\&\?]{11})/,/embed\/([^#\&\?]{11})/,/\/v\/([^#\&\?]{11})/];for(r=0;r<i.length;++r)if(i[r].test(e))return i[r].exec(e)[1];if(t.fuzzy){var n=e.split(/[\/\&\?=#\.\s]/g);for(r=0;r<n.length;++r)if(/^[^#\&\?]{11}$/.test(n[r]))return n[r]}}return null}},645:(e,t)=>{t.read=function(e,t,r,i,n){var a,s,o=8*n-i-1,l=(1<<o)-1,c=l>>1,u=-7,h=r?n-1:0,d=r?-1:1,f=e[t+h];for(h+=d,a=f&(1<<-u)-1,f>>=-u,u+=o;u>0;a=256*a+e[t+h],h+=d,u-=8);for(s=a&(1<<-u)-1,a>>=-u,u+=i;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===a)a=1-c;else{if(a===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,i),a-=c}return(f?-1:1)*s*Math.pow(2,a-i)},t.write=function(e,t,r,i,n,a){var s,o,l,c=8*a-n-1,u=(1<<c)-1,h=u>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:a-1,m=i?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(o=0,s=u):s+h>=1?(o=(t*l-1)*Math.pow(2,n),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,n),s=0));n>=8;e[r+f]=255&o,f+=m,o/=256,n-=8);for(s=s<<n|o,c+=n;c>0;e[r+f]=255&s,f+=m,s/=256,c-=8);e[r+f-m]|=128*p}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},8738:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},9090:e=>{function t(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function r(e,t){e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,e))}}e.exports=function(e,i,n){var a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("script");"function"==typeof i&&(n=i,i={}),i=i||{},n=n||function(){},s.type=i.type||"text/javascript",s.charset=i.charset||"utf8",s.async=!("async"in i)||!!i.async,s.src=e,i.attrs&&function(e,t){for(var r in t)e.setAttribute(r,t[r])}(s,i.attrs),i.text&&(s.text=""+i.text),("onload"in s?t:r)(s,n),s.onload||t(s,n),a.appendChild(s)}},2568:(e,t,r)=>{var i,n,a,s,o;i=r(1012),n=r(487).utf8,a=r(8738),s=r(487).bin,(o=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?s.stringToBytes(e):n.stringToBytes(e):a(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var r=i.bytesToWords(e),l=8*e.length,c=1732584193,u=-271733879,h=-1732584194,d=271733878,f=0;f<r.length;f++)r[f]=16711935&(r[f]<<8|r[f]>>>24)|4278255360&(r[f]<<24|r[f]>>>8);r[l>>>5]|=128<<l%32,r[14+(l+64>>>9<<4)]=l;var m=o._ff,p=o._gg,g=o._hh,A=o._ii;for(f=0;f<r.length;f+=16){var b=c,v=u,y=h,w=d;c=m(c,u,h,d,r[f+0],7,-680876936),d=m(d,c,u,h,r[f+1],12,-389564586),h=m(h,d,c,u,r[f+2],17,606105819),u=m(u,h,d,c,r[f+3],22,-1044525330),c=m(c,u,h,d,r[f+4],7,-176418897),d=m(d,c,u,h,r[f+5],12,1200080426),h=m(h,d,c,u,r[f+6],17,-1473231341),u=m(u,h,d,c,r[f+7],22,-45705983),c=m(c,u,h,d,r[f+8],7,1770035416),d=m(d,c,u,h,r[f+9],12,-1958414417),h=m(h,d,c,u,r[f+10],17,-42063),u=m(u,h,d,c,r[f+11],22,-1990404162),c=m(c,u,h,d,r[f+12],7,1804603682),d=m(d,c,u,h,r[f+13],12,-40341101),h=m(h,d,c,u,r[f+14],17,-1502002290),c=p(c,u=m(u,h,d,c,r[f+15],22,1236535329),h,d,r[f+1],5,-165796510),d=p(d,c,u,h,r[f+6],9,-1069501632),h=p(h,d,c,u,r[f+11],14,643717713),u=p(u,h,d,c,r[f+0],20,-373897302),c=p(c,u,h,d,r[f+5],5,-701558691),d=p(d,c,u,h,r[f+10],9,38016083),h=p(h,d,c,u,r[f+15],14,-660478335),u=p(u,h,d,c,r[f+4],20,-405537848),c=p(c,u,h,d,r[f+9],5,568446438),d=p(d,c,u,h,r[f+14],9,-1019803690),h=p(h,d,c,u,r[f+3],14,-187363961),u=p(u,h,d,c,r[f+8],20,1163531501),c=p(c,u,h,d,r[f+13],5,-1444681467),d=p(d,c,u,h,r[f+2],9,-51403784),h=p(h,d,c,u,r[f+7],14,1735328473),c=g(c,u=p(u,h,d,c,r[f+12],20,-1926607734),h,d,r[f+5],4,-378558),d=g(d,c,u,h,r[f+8],11,-2022574463),h=g(h,d,c,u,r[f+11],16,1839030562),u=g(u,h,d,c,r[f+14],23,-35309556),c=g(c,u,h,d,r[f+1],4,-1530992060),d=g(d,c,u,h,r[f+4],11,1272893353),h=g(h,d,c,u,r[f+7],16,-155497632),u=g(u,h,d,c,r[f+10],23,-1094730640),c=g(c,u,h,d,r[f+13],4,681279174),d=g(d,c,u,h,r[f+0],11,-358537222),h=g(h,d,c,u,r[f+3],16,-722521979),u=g(u,h,d,c,r[f+6],23,76029189),c=g(c,u,h,d,r[f+9],4,-640364487),d=g(d,c,u,h,r[f+12],11,-421815835),h=g(h,d,c,u,r[f+15],16,530742520),c=A(c,u=g(u,h,d,c,r[f+2],23,-995338651),h,d,r[f+0],6,-198630844),d=A(d,c,u,h,r[f+7],10,1126891415),h=A(h,d,c,u,r[f+14],15,-1416354905),u=A(u,h,d,c,r[f+5],21,-57434055),c=A(c,u,h,d,r[f+12],6,1700485571),d=A(d,c,u,h,r[f+3],10,-1894986606),h=A(h,d,c,u,r[f+10],15,-1051523),u=A(u,h,d,c,r[f+1],21,-2054922799),c=A(c,u,h,d,r[f+8],6,1873313359),d=A(d,c,u,h,r[f+15],10,-30611744),h=A(h,d,c,u,r[f+6],15,-1560198380),u=A(u,h,d,c,r[f+13],21,1309151649),c=A(c,u,h,d,r[f+4],6,-145523070),d=A(d,c,u,h,r[f+11],10,-1120210379),h=A(h,d,c,u,r[f+2],15,718787259),u=A(u,h,d,c,r[f+9],21,-343485551),c=c+b>>>0,u=u+v>>>0,h=h+y>>>0,d=d+w>>>0}return i.endian([c,u,h,d])})._ff=function(e,t,r,i,n,a,s){var o=e+(t&r|~t&i)+(n>>>0)+s;return(o<<a|o>>>32-a)+t},o._gg=function(e,t,r,i,n,a,s){var o=e+(t&i|r&~i)+(n>>>0)+s;return(o<<a|o>>>32-a)+t},o._hh=function(e,t,r,i,n,a,s){var o=e+(t^r^i)+(n>>>0)+s;return(o<<a|o>>>32-a)+t},o._ii=function(e,t,r,i,n,a,s){var o=e+(r^(t|~i))+(n>>>0)+s;return(o<<a|o>>>32-a)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var r=i.wordsToBytes(o(e,t));return t&&t.asBytes?r:t&&t.asString?s.bytesToString(r):i.bytesToHex(r)}},2577:(e,t)=>{"use strict";var r=/^[A-Za-z0-9][A-Za-z0-9!#$&^_.-]{0,126}$/,i=/^[A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126}$/,n=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/;function a(e,t,r){this.type=e,this.subtype=t,this.suffix=r}t.format=function(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var t=e.subtype,n=e.suffix,a=e.type;if(!a||!i.test(a))throw new TypeError("invalid type");if(!t||!r.test(t))throw new TypeError("invalid subtype");var s=a+"/"+t;if(n){if(!i.test(n))throw new TypeError("invalid suffix");s+="+"+n}return s},t.parse=function(e){if(!e)throw new TypeError("argument string is required");if("string"!=typeof e)throw new TypeError("argument string is required to be a string");var t=n.exec(e.toLowerCase());if(!t)throw new TypeError("invalid media type");var r,i=t[1],s=t[2],o=s.lastIndexOf("+");return-1!==o&&(r=s.substr(o+1),s=s.substr(0,o)),new a(i,s,r)},t.test=function(e){if(!e)throw new TypeError("argument string is required");if("string"!=typeof e)throw new TypeError("argument string is required to be a string");return n.test(e.toLowerCase())}},7824:e=>{var t=1e3,r=60*t,i=60*r,n=24*i;function a(e,t,r,i){var n=t>=1.5*r;return Math.round(e/r)+" "+i+(n?"s":"")}e.exports=function(e,s){s=s||{};var o,l,c=typeof e;if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*n;case"hours":case"hour":case"hrs":case"hr":case"h":return s*i;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===c&&isFinite(e))return s.long?(o=e,(l=Math.abs(o))>=n?a(o,l,n,"day"):l>=i?a(o,l,i,"hour"):l>=r?a(o,l,r,"minute"):l>=t?a(o,l,t,"second"):o+" ms"):function(e){var a=Math.abs(e);return a>=n?Math.round(e/n)+"d":a>=i?Math.round(e/i)+"h":a>=r?Math.round(e/r)+"m":a>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},2463:(e,t,r)=>{"use strict";t.Aj=t.De=void 0;const i=r(1227),n=r(523),a=r(8090);i("music-metadata-browser:main");r(523);t.De=n.parseStream,t.Aj=async function(e,r){const i={mimeType:e.type,size:e.size};return e instanceof File&&(i.path=e.name),async function(e,r,i){const n=new a.ReadableWebToNodeStream(e),s=await(0,t.De)(n,"string"==typeof r?{mimeType:r}:r,i);return await n.close(),s}(e.stream?e.stream():function(e){const t=new FileReader;return new ReadableStream({start(r){t.onloadend=e=>{let t=e.target.result;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),r.enqueue(t),r.close()},t.onerror=e=>{r.close()},t.onabort=e=>{r.close()},t.readAsArrayBuffer(e)}})}(e),{mimeType:e.type,size:e.size},r)}},3275:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ParserFactory=t.parseHttpContentType=void 0;const n=r(1),a=r(7811),s=r(2577),o=r(1227),l=r(7584),c=r(5410),u=r(6742),h=r(1004),d=r(498),f=r(8841),m=r(60),p=r(9606),g=r(1915),A=r(2682),b=r(5870),v=r(1533),y=r(6789),w=r(78),E=(0,o.default)("music-metadata:parser:factory");function _(e){const t=a.parse(e),r=s.parse(t.type);return{type:r.type,subtype:r.subtype,suffix:r.suffix,parameters:t.parameters}}t.parseHttpContentType=_;class T{static async parseOnContentType(e,t){const{mimeType:r,path:i,url:n}=await e.fileInfo,a=T.getParserIdForMimeType(r)||T.getParserIdForExtension(i)||T.getParserIdForExtension(n);return a||E("No parser found for MIME-type / extension: "+r),this.parse(e,a,t)}static async parse(e,t,r){if(!t){E("Guess parser on content...");const r=i.alloc(4100);if(await e.peekBuffer(r,{mayBeLess:!0}),e.fileInfo.path&&(t=this.getParserIdForExtension(e.fileInfo.path)),!t){const e=await n.fromBuffer(r);if(!e)throw new Error("Failed to determine audio format");if(E(`Guessed file type is mime=${e.mime}, extension=${e.ext}`),!(t=T.getParserIdForMimeType(e.mime)))throw new Error("Guessed MIME-type not supported: "+e.mime)}}return async function(e,t,r={}){const i=await T.loadParser(t),n=new l.MetadataCollector(r);return await i.init(n,e,r).parse(),n.toCommonMetadata()}(e,t,r)}static getParserIdForExtension(e){if(e)switch(this.getExtension(e).toLocaleLowerCase()||e){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}static async loadParser(e){switch(e){case"aiff":return new c.AIFFParser;case"adts":case"mpeg":return new m.MpegParser;case"apev2":return new u.APEv2Parser;case"asf":return new h.AsfParser;case"dsf":return new v.DsfParser;case"dsdiff":return new y.DsdiffParser;case"flac":return new d.FlacParser;case"mp4":return new f.MP4Parser;case"musepack":return new p.default;case"ogg":return new g.OggParser;case"riff":return new A.WaveParser;case"wavpack":return new b.WavPackParser;case"matroska":return new w.MatroskaParser;default:throw new Error(`Unknown parser type: ${e}`)}}static getExtension(e){const t=e.lastIndexOf(".");return-1===t?"":e.slice(t)}static getParserIdForMimeType(e){let t;try{t=_(e)}catch(t){return void E(`Invalid HTTP Content-Type header value: ${e}`)}const r=0===t.subtype.indexOf("x-")?t.subtype.substring(2):t.subtype;switch(t.type){case"audio":switch(r){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(r){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(r){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}}}}t.ParserFactory=T},5410:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AIFFParser=void 0;const i=r(3416),n=r(1227),a=r(5849),s=r(8928),o=r(8049),l=r(7805),c=r(1162),u=r(4633),h=(0,n.default)("music-metadata:parser:aiff"),d={NONE:"not compressed\tPCM\tApple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float\tApple Computer",alaw:"ALaw 2:1\t8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1\t8-bit ITU-T G.711 µ-law\tApple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32\tIEEE 32-bit float "};class f extends l.BasicParser{async parse(){if("FORM"!==(await this.tokenizer.readToken(u.Header)).chunkID)throw new Error("Invalid Chunk-ID, expected 'FORM'");const e=await this.tokenizer.readToken(o.FourCcToken);switch(e){case"AIFF":this.metadata.setFormat("container",e),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw Error("Unsupported AIFF type: "+e)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=u.Header.len;){h("Reading AIFF chunk at offset="+this.tokenizer.position);const e=await this.tokenizer.readToken(u.Header);h(`Chunk id=${e.chunkID}`);const t=2*Math.round(e.chunkSize/2),r=await this.readData(e);await this.tokenizer.ignore(t-r)}}catch(e){if(!(e instanceof a.EndOfStreamError))throw e;h("End-of-stream")}}async readData(e){var t;switch(e.chunkID){case"COMM":const r=await this.tokenizer.readToken(new c.Common(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",r.sampleSize),this.metadata.setFormat("sampleRate",r.sampleRate),this.metadata.setFormat("numberOfChannels",r.numChannels),this.metadata.setFormat("numberOfSamples",r.numSampleFrames),this.metadata.setFormat("duration",r.numSampleFrames/r.sampleRate),this.metadata.setFormat("codec",null!==(t=r.compressionName)&&void 0!==t?t:d[r.compressionType]),e.chunkSize;case"ID3 ":const n=await this.tokenizer.readToken(new i.Uint8ArrayType(e.chunkSize)),o=a.fromBuffer(n);return await(new s.ID3v2Parser).parse(this.metadata,o,this.options),e.chunkSize;case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;default:return 0}}}t.AIFFParser=f},1162:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Common=void 0;const i=r(3416),n=r(8049);t.Common=class{constructor(e,t){this.isAifc=t;const r=t?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,t){const r=e.readUInt16BE(t+8)-16398,a=e.readUInt16BE(t+8+2),s={numChannels:e.readUInt16BE(t),numSampleFrames:e.readUInt32BE(t+2),sampleSize:e.readUInt16BE(t+6),sampleRate:r<0?a>>Math.abs(r):a<<r};if(this.isAifc){if(s.compressionType=n.FourCcToken.get(e,t+18),this.len>22){const r=e.readInt8(t+22);if(r>0){if(23+r+(r+1)%2!==this.len)throw new Error("Illegal pstring length");s.compressionName=new i.StringType(r,"binary").get(e,t+23)}else s.compressionName=void 0}}else s.compressionName="PCM";return s}}},6742:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.APEv2Parser=void 0;const n=r(1227),a=r(5849),s=r(3416),o=r(3769),l=r(7805),c=r(876),u=(0,n.default)("music-metadata:parser:APEv2"),h="APEv2",d="APETAGEX";class f extends l.BasicParser{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,t,r){const i=new f;return i.init(e,t,r),i.tryParseApeHeader()}static calculateDuration(e){let t=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return t+=e.finalFrameBlocks,t/e.sampleRate}static async findApeFooterOffset(e,t){const r=i.alloc(c.TagFooter.len);await e.randomRead(r,0,c.TagFooter.len,t-c.TagFooter.len);const n=c.TagFooter.get(r,0);if("APETAGEX"===n.ID)return u(`APE footer header at offset=${t}`),{footer:n,offset:t-n.size}}static parseTagFooter(e,t,r){const i=c.TagFooter.get(t,t.length-c.TagFooter.len);if(i.ID!==d)throw new Error("Unexpected APEv2 Footer ID preamble value.");a.fromBuffer(t);const n=new f;return n.init(e,a.fromBuffer(t),r),n.parseTags(i)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<c.TagFooter.len)return void u("No APEv2 header found, end-of-file reached");const e=await this.tokenizer.peekToken(c.TagFooter);if(e.ID===d)return await this.tokenizer.ignore(c.TagFooter.len),this.parseTags(e);if(u(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const e=this.tokenizer.fileInfo.size-this.tokenizer.position,t=i.alloc(e);return await this.tokenizer.readBuffer(t),f.parseTagFooter(this.metadata,t,this.options)}}async parse(){const e=await this.tokenizer.readToken(c.DescriptorParser);if("MAC "!==e.ID)throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const t=e.descriptorBytes-c.DescriptorParser.len,r=await(t>0?this.parseDescriptorExpansion(t):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const t=i.alloc(256);let r=e.size-c.TagFooter.len;u(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let n=0;n<e.fields;n++){if(r<c.TagItemHeader.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-n} items remaining, but no more tag data to read.`);break}const a=await this.tokenizer.readToken(c.TagItemHeader);r-=c.TagItemHeader.len+a.size,await this.tokenizer.peekBuffer(t,{length:Math.min(t.length,r)});let l=o.findZero(t,0,t.length);const d=await this.tokenizer.readToken(new s.StringType(l,"ascii"));switch(await this.tokenizer.ignore(1),r-=d.length+1,a.flags.dataType){case c.DataType.text_utf8:{const e=(await this.tokenizer.readToken(new s.StringType(a.size,"utf8"))).split(/\x00/g);for(const t of e)this.metadata.addTag(h,d,t);break}case c.DataType.binary:if(this.options.skipCovers)await this.tokenizer.ignore(a.size);else{const e=i.alloc(a.size);await this.tokenizer.readBuffer(e),l=o.findZero(e,0,e.length);const t=e.toString("utf8",0,l),r=i.from(e.slice(l+1));this.metadata.addTag(h,d,{description:t,data:r})}break;case c.DataType.external_info:u(`Ignore external info ${d}`),await this.tokenizer.ignore(a.size);break;case c.DataType.reserved:u(`Ignore external info ${d}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${d}"`),await this.tokenizer.ignore(a.size)}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(c.Header);return this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",f.calculateDuration(e)),{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}t.APEv2Parser=f},8414:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APEv2TagMapper=void 0;const i=r(4132),n={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class a extends i.CaseInsensitiveTagMap{constructor(){super(["APEv2"],n)}}t.APEv2TagMapper=a},876:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBitSet=t.parseTagFlags=t.TagField=t.TagItemHeader=t.TagFooter=t.Header=t.DescriptorParser=t.DataType=void 0;const i=r(3416),n=r(8049);var a;function s(e){return{containsHeader:o(e,31),containsFooter:o(e,30),isHeader:o(e,31),readOnly:o(e,0),dataType:(6&e)>>1}}function o(e,t){return 0!=(e&1<<t)}(a=t.DataType||(t.DataType={}))[a.text_utf8=0]="text_utf8",a[a.binary=1]="binary",a[a.external_info=2]="external_info",a[a.reserved=3]="reserved",t.DescriptorParser={len:52,get:(e,t)=>({ID:n.FourCcToken.get(e,t),version:i.UINT32_LE.get(e,t+4)/1e3,descriptorBytes:i.UINT32_LE.get(e,t+8),headerBytes:i.UINT32_LE.get(e,t+12),seekTableBytes:i.UINT32_LE.get(e,t+16),headerDataBytes:i.UINT32_LE.get(e,t+20),apeFrameDataBytes:i.UINT32_LE.get(e,t+24),apeFrameDataBytesHigh:i.UINT32_LE.get(e,t+28),terminatingDataBytes:i.UINT32_LE.get(e,t+32),fileMD5:new i.Uint8ArrayType(16).get(e,t+36)})},t.Header={len:24,get:(e,t)=>({compressionLevel:i.UINT16_LE.get(e,t),formatFlags:i.UINT16_LE.get(e,t+2),blocksPerFrame:i.UINT32_LE.get(e,t+4),finalFrameBlocks:i.UINT32_LE.get(e,t+8),totalFrames:i.UINT32_LE.get(e,t+12),bitsPerSample:i.UINT16_LE.get(e,t+16),channel:i.UINT16_LE.get(e,t+18),sampleRate:i.UINT32_LE.get(e,t+20)})},t.TagFooter={len:32,get:(e,t)=>({ID:new i.StringType(8,"ascii").get(e,t),version:i.UINT32_LE.get(e,t+8),size:i.UINT32_LE.get(e,t+12),fields:i.UINT32_LE.get(e,t+16),flags:s(i.UINT32_LE.get(e,t+20))})},t.TagItemHeader={len:8,get:(e,t)=>({size:i.UINT32_LE.get(e,t),flags:s(i.UINT32_LE.get(e,t+4))})},t.TagField=e=>new i.Uint8ArrayType(e.size-t.TagFooter.len),t.parseTagFlags=s,t.isBitSet=o},5174:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.WmPictureToken=t.MetadataLibraryObjectState=t.MetadataObjectState=t.ExtendedStreamPropertiesObjectState=t.ExtendedContentDescriptionObjectState=t.ContentDescriptionObjectState=t.readCodecEntries=t.HeaderExtensionObject=t.StreamPropertiesObject=t.FilePropertiesObject=t.IgnoreObjectState=t.State=t.HeaderObjectToken=t.TopLevelHeaderObjectToken=t.DataType=void 0;const n=r(3769),a=r(3416),s=r(8054),o=r(2252),l=r(8281);var c;(c=t.DataType||(t.DataType={}))[c.UnicodeString=0]="UnicodeString",c[c.ByteArray=1]="ByteArray",c[c.Bool=2]="Bool",c[c.DWord=3]="DWord",c[c.QWord=4]="QWord",c[c.Word=5]="Word",t.TopLevelHeaderObjectToken={len:30,get:(e,t)=>({objectId:s.default.fromBin(new a.BufferType(16).get(e,t)),objectSize:Number(a.UINT64_LE.get(e,t+16)),numberOfHeaderObjects:a.UINT32_LE.get(e,t+24)})},t.HeaderObjectToken={len:24,get:(e,t)=>({objectId:s.default.fromBin(new a.BufferType(16).get(e,t)),objectSize:Number(a.UINT64_LE.get(e,t+16))})};class u{constructor(e){this.len=Number(e.objectSize)-t.HeaderObjectToken.len}postProcessTag(e,t,r,i){if("WM/Picture"===t)e.push({id:t,value:_.fromBuffer(i)});else{const n=o.AsfUtil.getParserForAttr(r);if(!n)throw new Error("unexpected value headerType: "+r);e.push({id:t,value:n(i)})}}}t.State=u,t.IgnoreObjectState=class extends u{constructor(e){super(e)}get(e,t){return null}};class h extends u{constructor(e){super(e)}get(e,t){return{fileId:s.default.fromBin(e,t),fileSize:a.UINT64_LE.get(e,t+16),creationDate:a.UINT64_LE.get(e,t+24),dataPacketsCount:a.UINT64_LE.get(e,t+32),playDuration:a.UINT64_LE.get(e,t+40),sendDuration:a.UINT64_LE.get(e,t+48),preroll:a.UINT64_LE.get(e,t+56),flags:{broadcast:n.getBit(e,t+64,24),seekable:n.getBit(e,t+64,25)},minimumDataPacketSize:a.UINT32_LE.get(e,t+68),maximumDataPacketSize:a.UINT32_LE.get(e,t+72),maximumBitrate:a.UINT32_LE.get(e,t+76)}}}t.FilePropertiesObject=h,h.guid=s.default.FilePropertiesObject;class d extends u{constructor(e){super(e)}get(e,t){return{streamType:s.default.decodeMediaType(s.default.fromBin(e,t)),errorCorrectionType:s.default.fromBin(e,t+8)}}}t.StreamPropertiesObject=d,d.guid=s.default.StreamPropertiesObject;class f{constructor(){this.len=22}get(e,t){return{reserved1:s.default.fromBin(e,t),reserved2:e.readUInt16LE(t+16),extensionDataSize:e.readUInt32LE(t+18)}}}t.HeaderExtensionObject=f,f.guid=s.default.HeaderExtensionObject;const m={len:20,get:(e,t)=>({entryCount:e.readUInt16LE(t+16)})};async function p(e){const t=await e.readNumber(a.UINT16_LE);return(await e.readToken(new a.StringType(2*t,"utf16le"))).replace("\0","")}async function g(e){const t=await e.readNumber(a.UINT16_LE),r=i.alloc(t);return await e.readBuffer(r),r}async function A(e){const t=await e.readNumber(a.UINT16_LE);return{type:{videoCodec:1==(1&t),audioCodec:2==(2&t)},codecName:await p(e),description:await p(e),information:await g(e)}}t.readCodecEntries=async function(e){const t=await e.readToken(m),r=[];for(let i=0;i<t.entryCount;++i)r.push(await A(e));return r};class b extends u{constructor(e){super(e)}get(e,t){const r=[];let i=t+10;for(let n=0;n<b.contentDescTags.length;++n){const a=e.readUInt16LE(t+2*n);if(a>0){const t=b.contentDescTags[n],s=i+a;r.push({id:t,value:o.AsfUtil.parseUnicodeAttr(e.slice(i,s))}),i=s}}return r}}t.ContentDescriptionObjectState=b,b.guid=s.default.ContentDescriptionObject,b.contentDescTags=["Title","Author","Copyright","Description","Rating"];class v extends u{constructor(e){super(e)}get(e,t){const r=[],i=e.readUInt16LE(t);let n=t+2;for(let t=0;t<i;t+=1){const t=e.readUInt16LE(n);n+=2;const i=o.AsfUtil.parseUnicodeAttr(e.slice(n,n+t));n+=t;const a=e.readUInt16LE(n);n+=2;const s=e.readUInt16LE(n);n+=2;const l=e.slice(n,n+s);n+=s,this.postProcessTag(r,i,a,l)}return r}}t.ExtendedContentDescriptionObjectState=v,v.guid=s.default.ExtendedContentDescriptionObject;class y extends u{constructor(e){super(e)}get(e,t){return{startTime:a.UINT64_LE.get(e,t),endTime:a.UINT64_LE.get(e,t+8),dataBitrate:e.readInt32LE(t+12),bufferSize:e.readInt32LE(t+16),initialBufferFullness:e.readInt32LE(t+20),alternateDataBitrate:e.readInt32LE(t+24),alternateBufferSize:e.readInt32LE(t+28),alternateInitialBufferFullness:e.readInt32LE(t+32),maximumObjectSize:e.readInt32LE(t+36),flags:{reliableFlag:n.getBit(e,t+40,0),seekableFlag:n.getBit(e,t+40,1),resendLiveCleanpointsFlag:n.getBit(e,t+40,2)},streamNumber:e.readInt16LE(t+42),streamLanguageId:e.readInt16LE(t+44),averageTimePerFrame:e.readInt32LE(t+52),streamNameCount:e.readInt32LE(t+54),payloadExtensionSystems:e.readInt32LE(t+56),streamNames:[],streamPropertiesObject:null}}}t.ExtendedStreamPropertiesObjectState=y,y.guid=s.default.ExtendedStreamPropertiesObject;class w extends u{constructor(e){super(e)}get(e,t){const r=[],n=i.from(e),a=n.readUInt16LE(t);let s=t+2;for(let e=0;e<a;e+=1){s+=4;const e=n.readUInt16LE(s);s+=2;const t=n.readUInt16LE(s);s+=2;const i=n.readUInt32LE(s);s+=4;const a=o.AsfUtil.parseUnicodeAttr(n.slice(s,s+e));s+=e;const l=n.slice(s,s+i);s+=i,this.postProcessTag(r,a,t,l)}return r}}t.MetadataObjectState=w,w.guid=s.default.MetadataObject;class E extends w{constructor(e){super(e)}}t.MetadataLibraryObjectState=E,E.guid=s.default.MetadataLibraryObject;class _{constructor(e){this.len=e}static fromBase64(e){return this.fromBuffer(i.from(e,"base64"))}static fromBuffer(e){return new _(e.length).get(e,0)}get(e,t){const r=e.readUInt8(t++),i=e.readInt32LE(t);let n=5;for(;0!==e.readUInt16BE(n);)n+=2;const a=e.slice(5,n).toString("utf16le");for(;0!==e.readUInt16BE(n);)n+=2;const s=e.slice(5,n).toString("utf16le");return{type:l.AttachedPictureType[r],format:a,description:s,size:i,data:e.slice(n+4)}}}t.WmPictureToken=_},1004:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsfParser=void 0;const i=r(1227),n=r(6032),a=r(8054),s=r(5174),o=r(7805),l=(0,i.default)("music-metadata:parser:ASF");class c extends o.BasicParser{async parse(){const e=await this.tokenizer.readToken(s.TopLevelHeaderObjectToken);if(!e.objectId.equals(a.default.HeaderObject))throw new Error("expected asf header; but was not found; got: "+e.objectId.str);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(e){l("Error while parsing ASF: %s",e)}}async parseObjectHeader(e){let t;do{const e=await this.tokenizer.readToken(s.HeaderObjectToken);switch(l("header GUID=%s",e.objectId.str),e.objectId.str){case s.FilePropertiesObject.guid.str:const r=await this.tokenizer.readToken(new s.FilePropertiesObject(e));this.metadata.setFormat("duration",Number(r.playDuration/BigInt(1e3))/1e4-Number(r.preroll)/1e3),this.metadata.setFormat("bitrate",r.maximumBitrate);break;case s.StreamPropertiesObject.guid.str:const i=await this.tokenizer.readToken(new s.StreamPropertiesObject(e));this.metadata.setFormat("container","ASF/"+i.streamType);break;case s.HeaderExtensionObject.guid.str:const o=await this.tokenizer.readToken(new s.HeaderExtensionObject);await this.parseExtensionObject(o.extensionDataSize);break;case s.ContentDescriptionObjectState.guid.str:t=await this.tokenizer.readToken(new s.ContentDescriptionObjectState(e)),this.addTags(t);break;case s.ExtendedContentDescriptionObjectState.guid.str:t=await this.tokenizer.readToken(new s.ExtendedContentDescriptionObjectState(e)),this.addTags(t);break;case a.default.CodecListObject.str:const c=await s.readCodecEntries(this.tokenizer);c.forEach((e=>{this.metadata.addStreamInfo({type:e.type.videoCodec?n.TrackType.video:n.TrackType.audio,codecName:e.codecName})}));const u=c.filter((e=>e.type.audioCodec)).map((e=>e.codecName)).join("/");this.metadata.setFormat("codec",u);break;case a.default.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(e.objectSize-s.HeaderObjectToken.len);break;case a.default.PaddingObject.str:l("Padding: %s bytes",e.objectSize-s.HeaderObjectToken.len),await this.tokenizer.ignore(e.objectSize-s.HeaderObjectToken.len);break;default:this.metadata.addWarning("Ignore ASF-Object-GUID: "+e.objectId.str),l("Ignore ASF-Object-GUID: %s",e.objectId.str),await this.tokenizer.readToken(new s.IgnoreObjectState(e))}}while(--e)}addTags(e){e.forEach((e=>{this.metadata.addTag("asf",e.id,e.value)}))}async parseExtensionObject(e){do{const t=await this.tokenizer.readToken(s.HeaderObjectToken),r=t.objectSize-s.HeaderObjectToken.len;switch(t.objectId.str){case s.ExtendedStreamPropertiesObjectState.guid.str:await this.tokenizer.readToken(new s.ExtendedStreamPropertiesObjectState(t));break;case s.MetadataObjectState.guid.str:const e=await this.tokenizer.readToken(new s.MetadataObjectState(t));this.addTags(e);break;case s.MetadataLibraryObjectState.guid.str:const i=await this.tokenizer.readToken(new s.MetadataLibraryObjectState(t));this.addTags(i);break;case a.default.PaddingObject.str:await this.tokenizer.ignore(r);break;case a.default.CompatibilityObject.str:this.tokenizer.ignore(r);break;case a.default.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning("Ignore ASF-Object-GUID: "+t.objectId.str),await this.tokenizer.readToken(new s.IgnoreObjectState(t))}e-=t.objectSize}while(e>0)}}t.AsfParser=c},9004:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsfTagMapper=void 0;const i=r(9918),n={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class a extends i.CommonTagMapper{static toRating(e){return{rating:parseFloat(e+1)/5}}constructor(){super(["asf"],n)}postMap(e){if("WM/SharedUserRating"===e.id){const t=e.id.split(":");e.value=a.toRating(e.value),e.id=t[0]}}}t.AsfTagMapper=a},2252:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AsfUtil=void 0;const n=r(3416),a=r(3769);class s{static getParserForAttr(e){return s.attributeParsers[e]}static parseUnicodeAttr(e){return a.stripNulls(a.decodeString(e,"utf16le"))}static parseByteArrayAttr(e){return i.from(e)}static parseBoolAttr(e,t=0){return 1===s.parseWordAttr(e,t)}static parseDWordAttr(e,t=0){return e.readUInt32LE(t)}static parseQWordAttr(e,t=0){return n.UINT64_LE.get(e,t)}static parseWordAttr(e,t=0){return e.readUInt16LE(t)}}t.AsfUtil=s,s.attributeParsers=[s.parseUnicodeAttr,s.parseByteArrayAttr,s.parseBoolAttr,s.parseDWordAttr,s.parseQWordAttr,s.parseWordAttr,s.parseByteArrayAttr]},8054:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this.str=e}static fromBin(e,t=0){return new n(this.decode(e,t))}static decode(e,t=0){return(e.readUInt32LE(t).toString(16)+"-"+e.readUInt16LE(t+4).toString(16)+"-"+e.readUInt16LE(t+6).toString(16)+"-"+e.readUInt16BE(t+8).toString(16)+"-"+e.slice(t+10,t+16).toString("hex")).toUpperCase()}static decodeMediaType(e){switch(e.str){case n.AudioMedia.str:return"audio";case n.VideoMedia.str:return"video";case n.CommandMedia.str:return"command";case n.Degradable_JPEG_Media.str:return"degradable-jpeg";case n.FileTransferMedia.str:return"file-transfer";case n.BinaryMedia.str:return"binary"}}static encode(e){const t=i.alloc(16);return t.writeUInt32LE(parseInt(e.slice(0,8),16),0),t.writeUInt16LE(parseInt(e.slice(9,13),16),4),t.writeUInt16LE(parseInt(e.slice(14,18),16),6),i.from(e.slice(19,23),"hex").copy(t,8),i.from(e.slice(24),"hex").copy(t,10),t}equals(e){return this.str===e.str}toBin(){return n.encode(this.str)}}t.default=n,n.HeaderObject=new n("75B22630-668E-11CF-A6D9-00AA0062CE6C"),n.DataObject=new n("75B22636-668E-11CF-A6D9-00AA0062CE6C"),n.SimpleIndexObject=new n("33000890-E5B1-11CF-89F4-00A0C90349CB"),n.IndexObject=new n("D6E229D3-35DA-11D1-9034-00A0C90349BE"),n.MediaObjectIndexObject=new n("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C"),n.TimecodeIndexObject=new n("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C"),n.FilePropertiesObject=new n("8CABDCA1-A947-11CF-8EE4-00C00C205365"),n.StreamPropertiesObject=new n("B7DC0791-A9B7-11CF-8EE6-00C00C205365"),n.HeaderExtensionObject=new n("5FBF03B5-A92E-11CF-8EE3-00C00C205365"),n.CodecListObject=new n("86D15240-311D-11D0-A3A4-00A0C90348F6"),n.ScriptCommandObject=new n("1EFB1A30-0B62-11D0-A39B-00A0C90348F6"),n.MarkerObject=new n("F487CD01-A951-11CF-8EE6-00C00C205365"),n.BitrateMutualExclusionObject=new n("D6E229DC-35DA-11D1-9034-00A0C90349BE"),n.ErrorCorrectionObject=new n("75B22635-668E-11CF-A6D9-00AA0062CE6C"),n.ContentDescriptionObject=new n("75B22633-668E-11CF-A6D9-00AA0062CE6C"),n.ExtendedContentDescriptionObject=new n("D2D0A440-E307-11D2-97F0-00A0C95EA850"),n.ContentBrandingObject=new n("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E"),n.StreamBitratePropertiesObject=new n("7BF875CE-468D-11D1-8D82-006097C9A2B2"),n.ContentEncryptionObject=new n("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E"),n.ExtendedContentEncryptionObject=new n("298AE614-2622-4C17-B935-DAE07EE9289C"),n.DigitalSignatureObject=new n("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E"),n.PaddingObject=new n("1806D474-CADF-4509-A4BA-9AABCB96AAE8"),n.ExtendedStreamPropertiesObject=new n("14E6A5CB-C672-4332-8399-A96952065B5A"),n.AdvancedMutualExclusionObject=new n("A08649CF-4775-4670-8A16-6E35357566CD"),n.GroupMutualExclusionObject=new n("D1465A40-5A79-4338-B71B-E36B8FD6C249"),n.StreamPrioritizationObject=new n("D4FED15B-88D3-454F-81F0-ED5C45999E24"),n.BandwidthSharingObject=new n("A69609E6-517B-11D2-B6AF-00C04FD908E9"),n.LanguageListObject=new n("7C4346A9-EFE0-4BFC-B229-393EDE415C85"),n.MetadataObject=new n("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA"),n.MetadataLibraryObject=new n("44231C94-9498-49D1-A141-1D134E457054"),n.IndexParametersObject=new n("D6E229DF-35DA-11D1-9034-00A0C90349BE"),n.MediaObjectIndexParametersObject=new n("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7"),n.TimecodeIndexParametersObject=new n("F55E496D-9797-4B5D-8C8B-604DFE9BFB24"),n.CompatibilityObject=new n("26F18B5D-4584-47EC-9F5F-0E651F0452C9"),n.AdvancedContentEncryptionObject=new n("43058533-6981-49E6-9B74-AD12CB86D58C"),n.AudioMedia=new n("F8699E40-5B4D-11CF-A8FD-00805F5C442B"),n.VideoMedia=new n("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B"),n.CommandMedia=new n("59DACFC0-59E6-11D0-A3AC-00A0C90348F6"),n.JFIF_Media=new n("B61BE100-5B4E-11CF-A8FD-00805F5C442B"),n.Degradable_JPEG_Media=new n("35907DE0-E415-11CF-A917-00805F5C442B"),n.FileTransferMedia=new n("91BD222C-F21C-497A-8B6D-5AA86BFC0185"),n.BinaryMedia=new n("3AFB65E2-47EF-40F2-AC2C-70A90D71D343"),n.ASF_Index_Placeholder_Object=new n("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2")},7805:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BasicParser=void 0,t.BasicParser=class{init(e,t,r){return this.metadata=e,this.tokenizer=t,this.options=r,this}}},4132:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CaseInsensitiveTagMap=void 0;const i=r(9918);class n extends i.CommonTagMapper{constructor(e,t){const r={};for(const e of Object.keys(t))r[e.toUpperCase()]=t[e];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}t.CaseInsensitiveTagMap=n},6592:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombinedTagMapper=void 0;const i=r(2939),n=r(4005),a=r(9004),s=r(7183),o=r(8414),l=r(7852),c=r(9860),u=r(5756),h=r(5481);t.CombinedTagMapper=class{constructor(){this.tagMappers={},[new i.ID3v1TagMapper,new s.ID3v22TagMapper,new n.ID3v24TagMapper,new l.MP4TagMapper,new l.MP4TagMapper,new c.VorbisTagMapper,new o.APEv2TagMapper,new a.AsfTagMapper,new u.RiffInfoTagMapper,new h.MatroskaTagMapper].forEach((e=>{this.registerTagMapper(e)}))}mapTag(e,t,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(t,r);throw new Error("No generic tag mapper defined for tag-format: "+e)}registerTagMapper(e){for(const t of e.tagTypes)this.tagMappers[t]=e}}},8049:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.FourCcToken=void 0;const n=r(3769),a=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/;t.FourCcToken={len:4,get:(e,r)=>{const i=e.toString("binary",r,r+t.FourCcToken.len);if(!i.match(a))throw new Error(`FourCC contains invalid characters: ${n.a2hex(i)} "${i}"`);return i},put:(e,t,r)=>{const n=i.from(r,"binary");if(4!==n.length)throw new Error("Invalid length");return n.copy(e,t)}}},9918:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommonTagMapper=void 0;class r{constructor(e,t){this.tagTypes=e,this.tagMap=t}static toIntOrNull(e){const t=parseInt(e,10);return isNaN(t)?null:t}static normalizeTrack(e){const t=e.toString().split("/");return{no:parseInt(t[0],10)||null,of:parseInt(t[1],10)||null}}mapGenericTag(e,t){e={id:e.id,value:e.value},this.postMap(e,t);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,t){}}t.CommonTagMapper=r,r.maxRatingScore=1},103:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUnique=t.isSingleton=t.commonTags=void 0,t.commonTags={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}},t.isSingleton=function(e){return t.commonTags.hasOwnProperty(e)&&!t.commonTags[e].multiple},t.isUnique=function(e){return!t.commonTags[e].multiple||t.commonTags[e].unique}},7584:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.joinArtists=t.MetadataCollector=void 0;const i=r(6032),n=r(1227),a=r(103),s=r(6592),o=r(9918),l=r(3769),c=r(1),u=(0,n.default)("music-metadata:collector"),h=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","ID3v1"];function d(e){return e.length>2?e.slice(0,e.length-1).join(", ")+" & "+e[e.length-1]:e.join(" & ")}t.MetadataCollector=class{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new s.CombinedTagMapper;let t=1;for(const e of h)this.originPriority[e]=t++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){u(`streamInfo: type=${i.TrackType[e.type]}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,t){u(`format: ${e} = ${t}`),this.format[e]=t,this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:t}})}addTag(e,t,r){u(`tag ${e}.${t} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:t,value:r}),this.toCommon(e,t,r)}addWarning(e){this.quality.warnings.push({message:e})}postMap(e,t){switch(t.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:t.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:t.value});break;case"artists":if(!(this.common.artist&&this.commonOrigin.artist!==this.originPriority.artificial||this.common.artists&&-1!==this.common.artists.indexOf(t.value))){const e={id:"artist",value:d((this.common.artists||[]).concat([t.value]))};this.setGenericTag("artificial",e)}break;case"picture":return void this.postFixPicture(t.value).then((r=>{null!==r&&(t.value=r,this.setGenericTag(e,t))}));case"totaltracks":return void(this.common.track.of=o.CommonTagMapper.toIntOrNull(t.value));case"totaldiscs":return void(this.common.disk.of=o.CommonTagMapper.toIntOrNull(t.value));case"movementTotal":return void(this.common.movementIndex.of=o.CommonTagMapper.toIntOrNull(t.value));case"track":case"disk":case"movementIndex":const r=this.common[t.id].of;return this.common[t.id]=o.CommonTagMapper.normalizeTrack(t.value),void(this.common[t.id].of=null!=r?r:this.common[t.id].of);case"bpm":case"year":case"originalyear":t.value=parseInt(t.value,10);break;case"date":const i=parseInt(t.value.substr(0,4),10);isNaN(i)||(this.common.year=i);break;case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":t.value="string"==typeof t.value?parseInt(t.value,10):t.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":t.value=(0,l.toRatio)(t.value);break;case"replaygain_track_minmax":t.value=t.value.split(",").map((e=>parseInt(e,10)));break;case"replaygain_undo":const n=t.value.split(",").map((e=>parseInt(e,10)));t.value={leftChannel:n[0],rightChannel:n[1]};break;case"gapless":case"compilation":case"podcast":case"showMovement":t.value="1"===t.value||1===t.value;break;case"isrc":if(this.common[t.id]&&-1!==this.common[t.id].indexOf(t.value))return}null!==t.value&&this.setGenericTag(e,t)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const t=await c.fromBuffer(e.data);if(!t)return null;e.format=t.mime}return e.format=e.format.toLocaleLowerCase(),"image/jpg"===e.format&&(e.format="image/jpeg"),e}return this.addWarning("Empty picture tag found"),null}toCommon(e,t,r){const i={id:t,value:r},n=this.tagMapper.mapTag(e,i,this);n&&this.postMap(e,n)}setGenericTag(e,t){u(`common.${t.id} = ${t.value}`);const r=this.commonOrigin[t.id]||1e3,i=this.originPriority[e];if((0,a.isSingleton)(t.id)){if(!(i<=r))return u(`Ignore native tag (singleton): ${e}.${t.id} = ${t.value}`);this.common[t.id]=t.value,this.commonOrigin[t.id]=i}else if(i===r)(0,a.isUnique)(t.id)&&-1!==this.common[t.id].indexOf(t.value)?u(`Ignore duplicate value: ${e}.${t.id} = ${t.value}`):this.common[t.id].push(t.value);else{if(!(i<r))return u(`Ignore native tag (list): ${e}.${t.id} = ${t.value}`);this.common[t.id]=[t.value],this.commonOrigin[t.id]=i}this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:t.id,value:t.value}})}},t.joinArtists=d},9461:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RandomUint8ArrayReader=void 0,t.RandomUint8ArrayReader=class{constructor(e){this.uint8Array=e,this.fileSize=e.length}async randomRead(e,t,r,i){return e.set(this.uint8Array.subarray(i,i+r),t),r}}},3769:(e,t,r)=>{"use strict";var i=r(8764).Buffer;function n(e,t,r,i){const a=r%8;let s=e[t+~~(r/8)];s&=255>>a;const o=8-a,l=i-o;return l<0?s>>=8-a-i:l>0&&(s<<=l,s|=n(e,t,r+o,l)),s}function a(e){return 10*Math.log10(e)}function s(e){return Math.pow(10,e/10)}Object.defineProperty(t,"__esModule",{value:!0}),t.toRatio=t.dbToRatio=t.ratioToDb=t.a2hex=t.isBitSet=t.getBitAllignedNumber=t.stripNulls=t.decodeString=t.trimRightNull=t.findZero=t.getBit=void 0,t.getBit=function(e,t,r){return 0!=(e[t]&1<<r)},t.findZero=function(e,t,r,i){let n=t;if("utf16le"===i){for(;0!==e[n]||0!==e[n+1];){if(n>=r)return r;n+=2}return n}for(;0!==e[n];){if(n>=r)return r;n++}return n},t.trimRightNull=function(e){const t=e.indexOf("\0");return-1===t?e:e.substr(0,t)},t.decodeString=function e(t,r){if(255===t[0]&&254===t[1])return e(t.subarray(2),r);if("utf16le"===r&&254===t[0]&&255===t[1]){if(0!=(1&t.length))throw new Error("Expected even number of octets for 16-bit unicode string");return e(function(e){const t=e.length;if(0!=(1&t))throw new Error("Buffer length must be even");for(let r=0;r<t;r+=2){const t=e[r];e[r]=e[r+1],e[r+1]=t}return e}(t),r)}return i.from(t).toString(r)},t.stripNulls=function(e){return(e=e.replace(/^\x00+/g,"")).replace(/\x00+$/g,"")},t.getBitAllignedNumber=n,t.isBitSet=function(e,t,r){return 1===n(e,t,r,1)},t.a2hex=function(e){const t=[];for(let r=0,i=e.length;r<i;r++){const i=Number(e.charCodeAt(r)).toString(16);t.push(1===i.length?"0"+i:i)}return t.join(" ")},t.ratioToDb=a,t.dbToRatio=s,t.toRatio=function(e){const t=e.split(" ").map((e=>e.trim().toLowerCase()));if(t.length>=1){const e=parseFloat(t[0]);return 2===t.length&&"db"===t[1]?{dB:e,ratio:s(e)}:{dB:a(e),ratio:e}}}},523:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanAppendingHeaders=t.selectCover=t.ratingToStars=t.orderTags=t.parseFromTokenizer=t.parseBuffer=t.parseStream=void 0;const i=r(5849),n=r(3275),a=r(9461),s=r(6742),o=r(2282),l=r(9941);function c(e,t){return n.ParserFactory.parseOnContentType(e,t)}async function u(e,t={}){let r=e.fileSize;await(0,o.hasID3v1Header)(e)&&(r-=128,r-=await(0,l.getLyricsHeaderLength)(e)),t.apeHeader=await s.APEv2Parser.findApeFooterOffset(e,r)}t.parseStream=function(e,t,r={}){return c(i.fromStream(e,"string"==typeof t?{mimeType:t}:t),r)},t.parseBuffer=async function(e,t,r={}){const n=new a.RandomUint8ArrayReader(e);return await u(n,r),c(i.fromBuffer(e,"string"==typeof t?{mimeType:t}:t),r)},t.parseFromTokenizer=c,t.orderTags=function(e){const t={};for(const r of e)(t[r.id]=t[r.id]||[]).push(r.value);return t},t.ratingToStars=function(e){return void 0===e?0:1+Math.round(4*e)},t.selectCover=function(e){return e?e.reduce(((e,t)=>t.name&&t.name.toLowerCase()in["front","cover","cover (front)"]?t:e)):null},t.scanAppendingHeaders=u},6789:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DsdiffParser=void 0;const i=r(3416),n=r(1227),a=r(5849),s=r(8049),o=r(7805),l=r(8928),c=r(9187),u=(0,n.default)("music-metadata:parser:aiff");class h extends o.BasicParser{async parse(){const e=await this.tokenizer.readToken(c.ChunkHeader64);if("FRM8"!==e.chunkID)throw new Error("Unexpected chunk-ID");const t=(await this.tokenizer.readToken(s.FourCcToken)).trim();if("DSD"===t)return this.metadata.setFormat("container",`DSDIFF/${t}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(s.FourCcToken.len));throw Error(`Unsupported DSDIFF type: ${t}`)}async readFmt8Chunks(e){for(;e>=c.ChunkHeader64.len;){const t=await this.tokenizer.readToken(c.ChunkHeader64);u(`Chunk id=${t.chunkID}`),await this.readData(t),e-=BigInt(c.ChunkHeader64.len)+t.chunkSize}}async readData(e){u(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const t=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":const t=await this.tokenizer.readToken(i.UINT32_LE);u(`DSDIFF version=${t}`);break;case"PROP":if("SND "!==await this.tokenizer.readToken(s.FourCcToken))throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(s.FourCcToken.len));break;case"ID3":const r=await this.tokenizer.readToken(new i.Uint8ArrayType(Number(e.chunkSize))),n=a.fromBuffer(r);await(new l.ID3v2Parser).parse(this.metadata,n,this.options);break;default:u(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break;case"DSD":this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate)}const r=e.chunkSize-BigInt(this.tokenizer.position-t);r>0&&(u(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(u(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const t=await this.tokenizer.readToken(c.ChunkHeader64);u(`Sound-property-chunk[ID=${t.chunkID}, size=${t.chunkSize}]`);const r=this.tokenizer.position;switch(t.chunkID.trim()){case"FS":const e=await this.tokenizer.readToken(i.UINT32_BE);this.metadata.setFormat("sampleRate",e);break;case"CHNL":const r=await this.tokenizer.readToken(i.UINT16_BE);this.metadata.setFormat("numberOfChannels",r),await this.handleChannelChunks(t.chunkSize-BigInt(i.UINT16_BE.len));break;case"CMPR":const n=(await this.tokenizer.readToken(s.FourCcToken)).trim(),a=await this.tokenizer.readToken(i.UINT8),o=await this.tokenizer.readToken(new i.StringType(a,"ascii"));"DSD"===n&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${n} (${o})`);break;case"ABSS":const l=await this.tokenizer.readToken(i.UINT16_BE),c=await this.tokenizer.readToken(i.UINT8),h=await this.tokenizer.readToken(i.UINT8),d=await this.tokenizer.readToken(i.UINT32_BE);u(`ABSS ${l}:${c}:${h}.${d}`);break;case"LSCO":const f=await this.tokenizer.readToken(i.UINT16_BE);u(`LSCO lsConfig=${f}`);break;default:u(`Unknown sound-property-chunk[ID=${t.chunkID}, size=${t.chunkSize}]`),await this.tokenizer.ignore(Number(t.chunkSize))}const n=t.chunkSize-BigInt(this.tokenizer.position-r);n>0&&(u(`After Parsing sound-property-chunk ${t.chunkSize}, remaining ${n} bytes`),await this.tokenizer.ignore(Number(n))),e-=BigInt(c.ChunkHeader64.len)+t.chunkSize,u(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const e=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",e)}}async handleChannelChunks(e){u(`Parsing channel-chunks, remainingSize=${e}`);const t=[];for(;e>=s.FourCcToken.len;){const r=await this.tokenizer.readToken(s.FourCcToken);u(`Channel[ID=${r}]`),t.push(r),e-=BigInt(s.FourCcToken.len)}return u(`Channels: ${t.join(", ")}`),t}}t.DsdiffParser=h},9187:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChunkHeader64=void 0;const i=r(3416),n=r(8049);t.ChunkHeader64={len:12,get:(e,t)=>({chunkID:n.FourCcToken.get(e,t),chunkSize:i.INT64_BE.get(e,t+4)})}},4101:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormatChunk=t.ChannelType=t.DsdChunk=t.ChunkHeader=void 0;const i=r(3416),n=r(8049);var a;t.ChunkHeader={len:12,get:(e,t)=>({id:n.FourCcToken.get(e,t),size:i.UINT64_LE.get(e,t+4)})},t.DsdChunk={len:16,get:(e,t)=>({fileSize:i.INT64_LE.get(e,t),metadataPointer:i.INT64_LE.get(e,t+8)})},(a=t.ChannelType||(t.ChannelType={}))[a.mono=1]="mono",a[a.stereo=2]="stereo",a[a.channels=3]="channels",a[a.quad=4]="quad",a[a["4 channels"]=5]="4 channels",a[a["5 channels"]=6]="5 channels",a[a["5.1 channels"]=7]="5.1 channels",t.FormatChunk={len:40,get:(e,t)=>({formatVersion:i.INT32_LE.get(e,t),formatID:i.INT32_LE.get(e,t+4),channelType:i.INT32_LE.get(e,t+8),channelNum:i.INT32_LE.get(e,t+12),samplingFrequency:i.INT32_LE.get(e,t+16),bitsPerSample:i.INT32_LE.get(e,t+20),sampleCount:i.INT64_LE.get(e,t+24),blockSizePerChannel:i.INT32_LE.get(e,t+32)})}},1533:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DsfParser=void 0;const i=r(1227),n=r(5159),a=r(4101),s=r(8928),o=(0,i.default)("music-metadata:parser:DSF");class l extends n.AbstractID3Parser{async postId3v2Parse(){const e=this.tokenizer.position,t=await this.tokenizer.readToken(a.ChunkHeader);if("DSD "!==t.id)throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(a.DsdChunk);if(r.metadataPointer!==BigInt(0))return o(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-t.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),(new s.ID3v2Parser).parse(this.metadata,this.tokenizer,this.options);o("No ID3v2 tag present")}async parseChunks(e){for(;e>=a.ChunkHeader.len;){const t=await this.tokenizer.readToken(a.ChunkHeader);if(o(`Parsing chunk name=${t.id} size=${t.size}`),"fmt "===t.id){const e=await this.tokenizer.readToken(a.FormatChunk);this.metadata.setFormat("numberOfChannels",e.channelNum),this.metadata.setFormat("sampleRate",e.samplingFrequency),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("numberOfSamples",e.sampleCount),this.metadata.setFormat("duration",Number(e.sampleCount)/e.samplingFrequency);const t=e.bitsPerSample*e.samplingFrequency*e.channelNum;return void this.metadata.setFormat("bitrate",t)}this.tokenizer.ignore(Number(t.size)-a.ChunkHeader.len),e-=t.size}}}t.DsfParser=l},498:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlacParser=void 0;const i=r(3416),n=r(1227),a=r(3769),s=r(2127),o=r(5159),l=r(8049),c=r(4210),u=r(441),h=(0,n.default)("music-metadata:parser:FLAC");var d;!function(e){e[e.STREAMINFO=0]="STREAMINFO",e[e.PADDING=1]="PADDING",e[e.APPLICATION=2]="APPLICATION",e[e.SEEKTABLE=3]="SEEKTABLE",e[e.VORBIS_COMMENT=4]="VORBIS_COMMENT",e[e.CUESHEET=5]="CUESHEET",e[e.PICTURE=6]="PICTURE"}(d||(d={}));class f extends o.AbstractID3Parser{constructor(){super(...arguments),this.padding=0}init(e,t,r){return super.init(e,t,r),this.vorbisParser=new c.VorbisParser(e,r),this}async postId3v2Parse(){if("fLaC"!==(await this.tokenizer.readToken(l.FourCcToken)).toString())throw new Error("Invalid FLAC preamble");let e;do{e=await this.tokenizer.readToken(m.BlockHeader),await this.parseDataBlock(e)}while(!e.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const e=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}parseDataBlock(e){switch(h(`blockHeader type=${e.type}, length=${e.length}`),e.type){case d.STREAMINFO:return this.parseBlockStreamInfo(e.length);case d.PADDING:this.padding+=e.length;break;case d.APPLICATION:case d.SEEKTABLE:break;case d.VORBIS_COMMENT:return this.parseComment(e.length);case d.CUESHEET:break;case d.PICTURE:return this.parsePicture(e.length).then();default:this.metadata.addWarning("Unknown block type: "+e.type)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==m.BlockStreamInfo.len)throw new Error("Unexpected block-stream-info length");const t=await this.tokenizer.readToken(m.BlockStreamInfo);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",t.channels),this.metadata.setFormat("bitsPerSample",t.bitsPerSample),this.metadata.setFormat("sampleRate",t.sampleRate),t.totalSamples>0&&this.metadata.setFormat("duration",t.totalSamples/t.sampleRate)}async parseComment(e){const t=await this.tokenizer.readToken(new i.Uint8ArrayType(e)),r=new u.VorbisDecoder(t,0);r.readStringUtf8();const n=r.readInt32();for(let e=0;e<n;e++){const e=r.parseUserComment();this.vorbisParser.addTag(e.key,e.value)}}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);{const t=await this.tokenizer.readToken(new s.VorbisPictureToken(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",t)}}}t.FlacParser=f;class m{}m.BlockHeader={len:4,get:(e,t)=>({lastBlock:a.getBit(e,t,7),type:a.getBitAllignedNumber(e,t,1,7),length:i.UINT24_BE.get(e,t+1)})},m.BlockStreamInfo={len:34,get:(e,t)=>({minimumBlockSize:i.UINT16_BE.get(e,t),maximumBlockSize:i.UINT16_BE.get(e,t+2)/1e3,minimumFrameSize:i.UINT24_BE.get(e,t+4),maximumFrameSize:i.UINT24_BE.get(e,t+7),sampleRate:i.UINT24_BE.get(e,t+10)>>4,channels:a.getBitAllignedNumber(e,t+12,4,3)+1,bitsPerSample:a.getBitAllignedNumber(e,t+12,7,5)+1,totalSamples:a.getBitAllignedNumber(e,t+13,4,36),fileMD5:new i.Uint8ArrayType(16).get(e,t+18)})}},2282:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.hasID3v1Header=t.ID3v1Parser=t.Genres=void 0;const n=r(1227),a=r(3416),s=r(3769),o=r(7805),l=r(6742),c=(0,n.default)("music-metadata:parser:ID3v1");t.Genres=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"];const u={len:128,get:(e,t)=>{const r=new h(3).get(e,t);return"TAG"===r?{header:r,title:new h(30).get(e,t+3),artist:new h(30).get(e,t+33),album:new h(30).get(e,t+63),year:new h(4).get(e,t+93),comment:new h(28).get(e,t+97),zeroByte:a.UINT8.get(e,t+127),track:a.UINT8.get(e,t+126),genre:a.UINT8.get(e,t+127)}:null}};class h extends a.StringType{constructor(e){super(e,"binary")}get(e,t){let r=super.get(e,t);return r=s.trimRightNull(r),r=r.trim(),r.length>0?r:void 0}}class d extends o.BasicParser{static getGenre(e){if(e<t.Genres.length)return t.Genres[e]}async parse(){if(!this.tokenizer.fileInfo.size)return void c("Skip checking for ID3v1 because the file-size is unknown");if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const e=new l.APEv2Parser;e.init(this.metadata,this.tokenizer,this.options),await e.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-u.len;if(this.tokenizer.position>e)return void c("Already consumed the last 128 bytes");const t=await this.tokenizer.readToken(u,e);if(t){c("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-u.len);for(const e of["title","artist","album","comment","track","year"])t[e]&&""!==t[e]&&this.addTag(e,t[e]);const e=d.getGenre(t.genre);e&&this.addTag("genre",e)}else c("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-u.len)}addTag(e,t){this.metadata.addTag("ID3v1",e,t)}}t.ID3v1Parser=d,t.hasID3v1Header=async function(e){if(e.fileSize>=128){const t=i.alloc(3);return await e.randomRead(t,0,t.length,e.fileSize-128),"TAG"===t.toString("binary")}return!1}},2939:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v1TagMapper=void 0;const i=r(9918),n={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class a extends i.CommonTagMapper{constructor(){super(["ID3v1"],n)}}t.ID3v1TagMapper=a},5159:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractID3Parser=void 0;const i=r(5849),n=r(1227),a=r(8281),s=r(8928),o=r(2282),l=r(7805),c=(0,n.default)("music-metadata:parser:ID3");class u extends l.BasicParser{constructor(){super(...arguments),this.id3parser=new s.ID3v2Parser}static async startsWithID3v2Header(e){return"ID3"===(await e.peekToken(a.ID3v2Header)).fileIdentifier}async parse(){try{await this.parseID3v2()}catch(e){if(!(e instanceof i.EndOfStreamError))throw e;c("End-of-stream")}}finalize(){}async parseID3v2(){if(await this.tryReadId3v2Headers(),c("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny())this.finalize();else{const e=new o.ID3v1Parser;await e.init(this.metadata,this.tokenizer,this.options).parse(),this.finalize()}}async tryReadId3v2Headers(){if("ID3"===(await this.tokenizer.peekToken(a.ID3v2Header)).fileIdentifier)return c("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}t.AbstractID3Parser=u},907:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.FrameParser=t.parseGenre=void 0;const n=r(1227),a=r(3416),s=r(3769),o=r(8281),l=r(2282),c=(0,n.default)("music-metadata:id3v2:frame-parser"),u="latin1";function h(e){const t=[];let r,i="";for(const n of e)if("string"==typeof r)if("("===n&&""===r)i+="(",r=void 0;else if(")"===n){""!==i&&(t.push(i),i="");const e=d(r);e&&t.push(e),r=void 0}else r+=n;else"("===n?r="":i+=n;return i&&(0===t.length&&i.match(/^\d*$/)&&(i=l.Genres[i]),t.push(i)),t}function d(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?l.Genres[e]:void 0}t.parseGenre=h;class f{constructor(e,t){this.major=e,this.warningCollector=t}readData(e,t,r){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${t}`);const{encoding:n,bom:l}=o.TextEncodingToken.get(e,0),d=e.length;let m=0,p=[];const g=f.getNullTerminatorLength(n);let A;const b={};switch(c(`Parsing tag type=${t}, encoding=${n}, bom=${l}`),"TXXX"!==t&&"T"===t[0]?"T*":t){case"T*":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":let l;try{l=s.decodeString(e.slice(1),n).replace(/\x00+$/,"")}catch(e){this.warningCollector.addWarning(`id3v2.${this.major} type=${t} header has invalid string value: ${e.message}`)}switch(t){case"TMCL":case"TIPL":case"IPLS":p=this.splitValue(t,l),p=f.functionList(p);break;case"TRK":case"TRCK":case"TPOS":p=l;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":p=this.splitValue(t,l);break;case"TCO":case"TCON":p=this.splitValue(t,l).map((e=>h(e))).reduce(((e,t)=>e.concat(t)),[]);break;case"PCS":case"PCST":p=this.major>=4?this.splitValue(t,l):[l],p=Array.isArray(p)&&""===p[0]?1:0;break;default:p=this.major>=4?this.splitValue(t,l):[l]}break;case"TXXX":p=f.readIdentifierAndData(e,m+1,d,n),p={description:p.id,text:this.splitValue(t,s.decodeString(p.data,n).replace(/\x00+$/,""))};break;case"PIC":case"APIC":if(r){const t={};switch(m+=1,this.major){case 2:t.format=s.decodeString(e.slice(m,m+3),"latin1"),m+=3;break;case 3:case 4:A=s.findZero(e,m,d,u),t.format=s.decodeString(e.slice(m,A),u),m=A+1;break;default:throw new Error("Warning: unexpected major versionIndex: "+this.major)}t.format=f.fixPictureMimeType(t.format),t.type=o.AttachedPictureType[e[m]],m+=1,A=s.findZero(e,m,d,n),t.description=s.decodeString(e.slice(m,A),n),m=A+g,t.data=i.from(e.slice(m,d)),p=t}break;case"CNT":case"PCNT":p=a.UINT32_BE.get(e,0);break;case"SYLT":for(m+=7,p=[];m<d;){const t=e.slice(m,m=s.findZero(e,m,d,n));m+=5,p.push(s.decodeString(t,n))}break;case"ULT":case"USLT":case"COM":case"COMM":m+=1,b.language=s.decodeString(e.slice(m,m+3),u),m+=3,A=s.findZero(e,m,d,n),b.description=s.decodeString(e.slice(m,A),n),m=A+g,b.text=s.decodeString(e.slice(m,d),n).replace(/\x00+$/,""),p=[b];break;case"UFID":p=f.readIdentifierAndData(e,m,d,u),p={owner_identifier:p.id,identifier:p.data};break;case"PRIV":p=f.readIdentifierAndData(e,m,d,u),p={owner_identifier:p.id,data:p.data};break;case"POPM":A=s.findZero(e,m,d,u);const v=s.decodeString(e.slice(m,A),u);m=A+1;const y=d-m;p={email:v,rating:a.UINT8.get(e,m),counter:y>=5?a.UINT32_BE.get(e,m+1):void 0};break;case"GEOB":{A=s.findZero(e,m+1,d,n);const t=s.decodeString(e.slice(m+1,A),u);m=A+1,A=s.findZero(e,m,d-m,n);const r=s.decodeString(e.slice(m,A),u);m=A+1,A=s.findZero(e,m,d-m,n),p={type:t,filename:r,description:s.decodeString(e.slice(m,A),u),data:e.slice(m+1,d)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":p=s.decodeString(e.slice(m,A),u);break;case"WXXX":{A=s.findZero(e,m+1,d,n);const t=s.decodeString(e.slice(m+1,A),n);m=A+("utf16le"===n?2:1),p={description:t,url:s.decodeString(e.slice(m,d),u)};break}case"WFD":case"WFED":p=s.decodeString(e.slice(m+1,s.findZero(e,m+1,d,n)),n);break;case"MCDI":p=e.slice(0,d);break;default:c("Warning: unsupported id3v2-tag-type: "+t)}return p}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const t={};for(let r=0;r+1<e.length;r+=2){const i=e[r+1].split(",");t[e[r]]=t.hasOwnProperty(e[r])?t[e[r]].concat(i):i}return t}splitValue(e,t){let r;return this.major<4?(r=t.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=t.split(/\//g)):r=t.split(/\x00/g),f.trimArray(r)}static trimArray(e){return e.map((e=>e.replace(/\x00+$/,"").trim()))}static readIdentifierAndData(e,t,r,i){const n=s.findZero(e,t,r,i),a=s.decodeString(e.slice(t,n),i);return t=n+f.getNullTerminatorLength(i),{id:a,data:e.slice(t,r)}}static getNullTerminatorLength(e){return"utf16le"===e?2:1}}t.FrameParser=f},7183:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v22TagMapper=t.id3v22TagMap=void 0;const i=r(4132);t.id3v22TagMap={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website","COM:iTunPGAP":"gapless",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class n extends i.CaseInsensitiveTagMap{constructor(){super(["ID3v2.2"],t.id3v22TagMap)}}t.ID3v22TagMapper=n},4005:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v24TagMapper=void 0;const i=r(9918),n=r(4132),a=r(3769),s={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer","USLT:description":"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"date",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl"};class o extends n.CaseInsensitiveTagMap{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*i.CommonTagMapper.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],s)}postMap(e,t){switch(e.id){case"UFID":"http://musicbrainz.org"===e.value.owner_identifier&&(e.id+=":"+e.value.owner_identifier,e.value=a.decodeString(e.value.identifier,"latin1"));break;case"PRIV":switch(e.value.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=":"+e.value.owner_identifier,e.value=4===e.value.data.length?e.value.data.readUInt32LE(0):null,null===e.value&&t.addWarning("Failed to parse PRIV:PeakValue");break;default:t.addWarning(`Unknown PRIV owner-identifier: ${e.value.owner_identifier}`)}break;case"COMM":e.value=e.value?e.value.text:null;break;case"POPM":e.value=o.toRating(e.value)}}}t.ID3v24TagMapper=o},8928:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v2Parser=void 0;const n=r(3416),a=r(3769),s=r(907),o=r(8281);class l{static removeUnsyncBytes(e){let t=0,r=0;for(;t<e.length-1;)t!==r&&(e[r]=e[t]),t+=255===e[t]&&0===e[t+1]?2:1,r++;return t<e.length&&(e[r++]=e[t]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:a.getBit(e,0,6),file_alter_preservation:a.getBit(e,0,5),read_only:a.getBit(e,0,4)},format:{grouping_identity:a.getBit(e,1,7),compression:a.getBit(e,1,3),encryption:a.getBit(e,1,2),unsynchronisation:a.getBit(e,1,1),data_length_indicator:a.getBit(e,1,0)}}}static readFrameData(e,t,r,i,n){const a=new s.FrameParser(r,n);switch(r){case 2:return a.readData(e,t.id,i);case 3:case 4:return t.flags.format.unsynchronisation&&(e=l.removeUnsyncBytes(e)),t.flags.format.data_length_indicator&&(e=e.slice(4,e.length)),a.readData(e,t.id,i);default:throw new Error("Unexpected majorVer: "+r)}}static makeDescriptionTagName(e,t){return e+(t?":"+t:"")}async parse(e,t,r){this.tokenizer=t,this.metadata=e,this.options=r;const i=await this.tokenizer.readToken(o.ID3v2Header);if("ID3"!==i.fileIdentifier)throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=i,this.headerType="ID3v2."+i.version.major,i.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(i.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(o.ExtendedHeader),t=e.size-o.ExtendedHeader.len;return t>0?this.parseExtendedHeaderData(t,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,t){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-t)}async parseId3Data(e){const t=await this.tokenizer.readToken(new n.Uint8ArrayType(e));for(const e of this.parseMetadata(t))if("TXXX"===e.id){if(e.value)for(const t of e.value.text)this.addTag(l.makeDescriptionTagName(e.id,e.value.description),t)}else if("COM"===e.id)for(const t of e.value)this.addTag(l.makeDescriptionTagName(e.id,t.description),t.text);else if("COMM"===e.id)for(const t of e.value)this.addTag(l.makeDescriptionTagName(e.id,t.description),t);else if(Array.isArray(e.value))for(const t of e.value)this.addTag(e.id,t);else this.addTag(e.id,e.value)}addTag(e,t){this.metadata.addTag(this.headerType,e,t)}parseMetadata(e){let t=0;const r=[];for(;t!==e.length;){const i=l.getFrameHeaderLength(this.id3Header.version.major);if(t+i>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const n=e.slice(t,t+=i),a=this.readFrameHeader(n,this.id3Header.version.major),s=e.slice(t,t+=a.length),o=l.readFrameData(s,a,this.id3Header.version.major,!this.options.skipCovers,this.metadata);o&&r.push({id:a.id,value:o})}return r}readFrameHeader(e,t){let r;switch(t){case 2:r={id:i.from(e.slice(0,3)).toString("ascii"),length:n.UINT24_BE.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:i.from(e.slice(0,4)).toString("ascii"),length:(4===t?o.UINT32SYNCSAFE:n.UINT32_BE).get(e,4),flags:l.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error("Unexpected majorVer: "+t)}return r}}t.ID3v2Parser=l},8281:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextEncodingToken=t.ExtendedHeader=t.ID3v2Header=t.UINT32SYNCSAFE=t.AttachedPictureType=void 0;const i=r(3416),n=r(3769);var a;(a=t.AttachedPictureType||(t.AttachedPictureType={}))[a.Other=0]="Other",a[a["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",a[a["Other file icon"]=2]="Other file icon",a[a["Cover (front)"]=3]="Cover (front)",a[a["Cover (back)"]=4]="Cover (back)",a[a["Leaflet page"]=5]="Leaflet page",a[a["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",a[a["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",a[a["Artist/performer"]=8]="Artist/performer",a[a.Conductor=9]="Conductor",a[a["Band/Orchestra"]=10]="Band/Orchestra",a[a.Composer=11]="Composer",a[a["Lyricist/text writer"]=12]="Lyricist/text writer",a[a["Recording Location"]=13]="Recording Location",a[a["During recording"]=14]="During recording",a[a["During performance"]=15]="During performance",a[a["Movie/video screen capture"]=16]="Movie/video screen capture",a[a["A bright coloured fish"]=17]="A bright coloured fish",a[a.Illustration=18]="Illustration",a[a["Band/artist logotype"]=19]="Band/artist logotype",a[a["Publisher/Studio logotype"]=20]="Publisher/Studio logotype",t.UINT32SYNCSAFE={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4},t.ID3v2Header={len:10,get:(e,r)=>({fileIdentifier:new i.StringType(3,"ascii").get(e,r),version:{major:i.INT8.get(e,r+3),revision:i.INT8.get(e,r+4)},flags:{unsynchronisation:n.getBit(e,r+5,7),isExtendedHeader:n.getBit(e,r+5,6),expIndicator:n.getBit(e,r+5,5),footer:n.getBit(e,r+5,4)},size:t.UINT32SYNCSAFE.get(e,r+6)})},t.ExtendedHeader={len:10,get:(e,t)=>({size:i.UINT32_BE.get(e,t),extendedFlags:i.UINT16_BE.get(e,t+4),sizeOfPadding:i.UINT32_BE.get(e,t+6),crcDataPresent:n.getBit(e,t+4,31)})},t.TextEncodingToken={len:1,get:(e,t)=>{switch(e[t]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf16le",bom:!0};case 2:return{encoding:"utf16le",bom:!1};default:return{encoding:"utf8",bom:!1}}}}},4633:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const i=r(3416),n=r(8049);t.Header={len:8,get:(e,t)=>({chunkID:n.FourCcToken.get(e,t),chunkSize:Number(BigInt(i.UINT32_BE.get(e,t+4)))})}},9941:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.getLyricsHeaderLength=t.endTag2=void 0,t.endTag2="LYRICS200",t.getLyricsHeaderLength=async function(e){if(e.fileSize>=143){const r=i.alloc(15);await e.randomRead(r,0,r.length,e.fileSize-143);const n=r.toString("binary");if(n.substr(6)===t.endTag2)return parseInt(n.substr(0,6),10)+15}return 0}},3121:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elements=void 0;const i=r(8591);t.elements={440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:i.DataType.uint},17143:{name:"ebmlReadVersion",value:i.DataType.uint},17138:{name:"ebmlMaxIDWidth",value:i.DataType.uint},17139:{name:"ebmlMaxSizeWidth",value:i.DataType.uint},17026:{name:"docType",value:i.DataType.string},17031:{name:"docTypeVersion",value:i.DataType.uint},17029:{name:"docTypeReadVersion",value:i.DataType.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",container:{21419:{name:"seekId",value:i.DataType.binary},21420:{name:"seekPosition",value:i.DataType.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:i.DataType.uid},29572:{name:"filename",value:i.DataType.string},3979555:{name:"prevUID",value:i.DataType.uid},3965867:{name:"prevFilename",value:i.DataType.string},4110627:{name:"nextUID",value:i.DataType.uid},4096955:{name:"nextFilename",value:i.DataType.string},2807729:{name:"timecodeScale",value:i.DataType.uint},17545:{name:"duration",value:i.DataType.float},17505:{name:"dateUTC",value:i.DataType.uint},31657:{name:"title",value:i.DataType.string},19840:{name:"muxingApp",value:i.DataType.string},22337:{name:"writingApp",value:i.DataType.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:i.DataType.uid},163:{name:"unknown",value:i.DataType.binary},167:{name:"position",value:i.DataType.uid},171:{name:"prevSize",value:i.DataType.uid}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:i.DataType.uint},29637:{name:"uid",value:i.DataType.uid},131:{name:"trackType",value:i.DataType.uint},185:{name:"flagEnabled",value:i.DataType.bool},136:{name:"flagDefault",value:i.DataType.bool},21930:{name:"flagForced",value:i.DataType.bool},156:{name:"flagLacing",value:i.DataType.bool},28135:{name:"minCache",value:i.DataType.uint},28136:{name:"maxCache",value:i.DataType.uint},2352003:{name:"defaultDuration",value:i.DataType.uint},2306383:{name:"timecodeScale",value:i.DataType.float},21358:{name:"name",value:i.DataType.string},2274716:{name:"language",value:i.DataType.string},134:{name:"codecID",value:i.DataType.string},25506:{name:"codecPrivate",value:i.DataType.binary},2459272:{name:"codecName",value:i.DataType.string},3839639:{name:"codecSettings",value:i.DataType.string},3883072:{name:"codecInfoUrl",value:i.DataType.string},2536e3:{name:"codecDownloadUrl",value:i.DataType.string},170:{name:"codecDecodeAll",value:i.DataType.bool},28587:{name:"trackOverlay",value:i.DataType.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:i.DataType.bool},21432:{name:"stereoMode",value:i.DataType.uint},176:{name:"pixelWidth",value:i.DataType.uint},186:{name:"pixelHeight",value:i.DataType.uint},21680:{name:"displayWidth",value:i.DataType.uint},21690:{name:"displayHeight",value:i.DataType.uint},21683:{name:"aspectRatioType",value:i.DataType.uint},3061028:{name:"colourSpace",value:i.DataType.uint},3126563:{name:"gammaValue",value:i.DataType.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:i.DataType.float},30901:{name:"outputSamplingFrequency",value:i.DataType.float},159:{name:"channels",value:i.DataType.uint},148:{name:"channels",value:i.DataType.uint},32123:{name:"channelPositions",value:i.DataType.binary},25188:{name:"bitDepth",value:i.DataType.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:i.DataType.uint},20530:{name:"scope",value:i.DataType.bool},20531:{name:"type",value:i.DataType.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:i.DataType.uint},16981:{name:"contentCompSettings",value:i.DataType.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:i.DataType.uint},18402:{name:"contentEncKeyID",value:i.DataType.binary},18403:{name:"contentSignature ",value:i.DataType.binary},18404:{name:"ContentSigKeyID  ",value:i.DataType.binary},18405:{name:"contentSigAlgo ",value:i.DataType.uint},18406:{name:"contentSigHashAlgo ",value:i.DataType.uint}}},25188:{name:"bitDepth",value:i.DataType.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:i.DataType.uid},183:{name:"positions",container:{247:{name:"track",value:i.DataType.uint},241:{name:"clusterPosition",value:i.DataType.uint},21368:{name:"blockNumber",value:i.DataType.uint},234:{name:"codecState",value:i.DataType.uint},219:{name:"reference",container:{150:{name:"time",value:i.DataType.uint},151:{name:"cluster",value:i.DataType.uint},21343:{name:"number",value:i.DataType.uint},235:{name:"codecState",value:i.DataType.uint}}},240:{name:"relativePosition",value:i.DataType.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:i.DataType.string},18030:{name:"name",value:i.DataType.string},18016:{name:"mimeType",value:i.DataType.string},18012:{name:"data",value:i.DataType.binary},18094:{name:"uid",value:i.DataType.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:i.DataType.uid},145:{name:"timeStart",value:i.DataType.uint},146:{name:"timeEnd",value:i.DataType.uid},152:{name:"hidden",value:i.DataType.bool},17816:{name:"enabled",value:i.DataType.uid},143:{name:"track",container:{137:{name:"trackNumber",value:i.DataType.uid},128:{name:"display",container:{133:{name:"string",value:i.DataType.string},17276:{name:"language ",value:i.DataType.string},17278:{name:"country ",value:i.DataType.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:i.DataType.uid},25540:{name:"tagChapterUID",value:i.DataType.uint},25542:{name:"tagAttachmentUID",value:i.DataType.uid},25546:{name:"targetType",value:i.DataType.string},26826:{name:"targetTypeValue",value:i.DataType.uint},25545:{name:"tagEditionUID",value:i.DataType.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:i.DataType.string},17543:{name:"string",value:i.DataType.string},17541:{name:"binary",value:i.DataType.binary},17530:{name:"language",value:i.DataType.string},17531:{name:"languageIETF",value:i.DataType.string},17540:{name:"default",value:i.DataType.bool}}}}}}}}}}},78:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MatroskaParser=void 0;const n=r(3416),a=r(1227),s=r(7805),o=r(8591),l=r(3121),c=(0,a.default)("music-metadata:parser:matroska");class u extends s.BasicParser{constructor(){super(),this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(o.DataType.uint,(e=>this.readUint(e))),this.parserMap.set(o.DataType.string,(e=>this.readString(e))),this.parserMap.set(o.DataType.binary,(e=>this.readBuffer(e))),this.parserMap.set(o.DataType.uid,(async e=>1===await this.readUint(e))),this.parserMap.set(o.DataType.bool,(e=>this.readFlag(e))),this.parserMap.set(o.DataType.float,(e=>this.readFloat(e)))}init(e,t,r){return super.init(e,t,r),this}async parse(){const e=await this.parseContainer(l.elements,this.tokenizer.fileInfo.size,[]);if(this.metadata.setFormat("container",`EBML/${e.ebml.docType}`),e.segment){const t=e.segment.info;if(t){const e=t.timecodeScale?t.timecodeScale:1e6,r=t.duration*e/1e9;this.addTag("segment:title",t.title),this.metadata.setFormat("duration",r)}const r=e.segment.tracks;if(r&&r.entries){r.entries.forEach((e=>{const t={codecName:e.codecID.replace("A_","").replace("V_",""),codecSettings:e.codecSettings,flagDefault:e.flagDefault,flagLacing:e.flagLacing,flagEnabled:e.flagEnabled,language:e.language,name:e.name,type:e.trackType,audio:e.audio,video:e.video};this.metadata.addStreamInfo(t)}));const t=r.entries.filter((e=>e.trackType===o.TrackType.audio.valueOf())).reduce(((e,t)=>e?!e.flagDefault&&t.flagDefault||t.trackNumber&&t.trackNumber<e.trackNumber?t:e:t),null);t&&(this.metadata.setFormat("codec",t.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",t.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",t.audio.channels)),e.segment.tags&&e.segment.tags.tag.forEach((e=>{const t=e.target,r=(null==t?void 0:t.targetTypeValue)?o.TargetType[t.targetTypeValue]:(null==t?void 0:t.targetType)?t.targetType:"track";e.simpleTags.forEach((e=>{const t=e.string?e.string:e.binary;this.addTag(`${r}:${e.name}`,t)}))})),e.segment.attachments&&e.segment.attachments.attachedFiles.filter((e=>e.mimeType.startsWith("image/"))).map((e=>({data:e.data,format:e.mimeType,description:e.description,name:e.name}))).forEach((e=>{this.addTag("picture",e)}))}}}async parseContainer(e,t,r){const i={};for(;this.tokenizer.position<t;){let t;try{t=await this.readElement()}catch(e){if("End-Of-Stream"===e.message)break;throw e}const n=e[t.id];if(n)if(c(`Element: name=${n.name}, container=${!!n.container}`),n.container){const e=await this.parseContainer(n.container,t.len>=0?this.tokenizer.position+t.len:-1,r.concat([n.name]));n.multiple?(i[n.name]||(i[n.name]=[]),i[n.name].push(e)):i[n.name]=e}else i[n.name]=await this.parserMap.get(n.value)(t);else 236===t.id?(this.padding+=t.len,await this.tokenizer.ignore(t.len)):(c(`parseEbml: path=${r.join("/")}, unknown element: id=${t.id.toString(16)}`),this.padding+=t.len,await this.tokenizer.ignore(t.len))}return i}async readVintData(e){const t=await this.tokenizer.peekNumber(n.UINT8);let r=128,a=1;for(;0==(t&r);){if(a>e)throw new Error("VINT value exceeding maximum size");++a,r>>=1}const s=i.alloc(a);return await this.tokenizer.readBuffer(s),s}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),t=await this.readVintData(this.ebmlMaxSizeLength);t[0]^=128>>t.length-1;const r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}isMaxValue(e){if(e.length===this.ebmlMaxSizeLength){for(let t=1;t<this.ebmlMaxSizeLength;++t)if(255!==e[t])return!1;return!0}return!1}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(n.Float32_BE);case 8:case 10:return this.tokenizer.readNumber(n.Float64_BE);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return 1===await this.readUint(e)}async readUint(e){const t=await this.readBuffer(e),r=Math.min(6,e.len);return t.readUIntBE(e.len-r,r)}async readString(e){return(await this.tokenizer.readToken(new n.StringType(e.len,"utf-8"))).replace(/\00.*$/g,"")}async readBuffer(e){const t=i.alloc(e.len);return await this.tokenizer.readBuffer(t),t}addTag(e,t){this.metadata.addTag("matroska",e,t)}}t.MatroskaParser=u},5481:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MatroskaTagMapper=void 0;const i=r(4132),n={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class a extends i.CaseInsensitiveTagMap{constructor(){super(["matroska"],n)}}t.MatroskaTagMapper=a},8591:(e,t)=>{"use strict";var r,i,n;Object.defineProperty(t,"__esModule",{value:!0}),t.TrackType=t.TargetType=t.DataType=void 0,(n=t.DataType||(t.DataType={}))[n.string=0]="string",n[n.uint=1]="uint",n[n.uid=2]="uid",n[n.bool=3]="bool",n[n.binary=4]="binary",n[n.float=5]="float",(i=t.TargetType||(t.TargetType={}))[i.shot=10]="shot",i[i.scene=20]="scene",i[i.track=30]="track",i[i.part=40]="part",i[i.album=50]="album",i[i.edition=60]="edition",i[i.collection=70]="collection",(r=t.TrackType||(t.TrackType={}))[r.video=1]="video",r[r.audio=2]="audio",r[r.complex=3]="complex",r[r.logo=4]="logo",r[r.subtitle=17]="subtitle",r[r.button=18]="button",r[r.control=32]="control"},9134:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Atom=void 0;const i=r(1227),n=r(1060),a=(0,i.default)("music-metadata:parser:MP4:Atom");class s{constructor(e,t,r){this.header=e,this.extended=t,this.parent=r,this.children=[],this.atomPath=(this.parent?this.parent.atomPath+".":"")+this.header.name}static async readAtom(e,t,r,i){const o=e.position,l=await e.readToken(n.Header);l.length===BigInt(1)&&(l.length=await e.readToken(n.ExtendedSize));const c=new s(l,l.length===BigInt(1),r),u=c.getPayloadLength(i);return a(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${o}, len=${c.header.length}`),await c.readData(e,t,u),c}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,t,r){for(;r>0;){const i=await s.readAtom(e,t,this,r);this.children.push(i),r-=i.header.length===BigInt(0)?r:Number(i.header.length)}}async readData(e,t,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,t,this.getPayloadLength(r));case"meta":return await e.ignore(4),this.readAtoms(e,t,this.getPayloadLength(r)-4);default:return t(this,r)}}}t.Atom=s},1060:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ChapterText=t.StcoAtom=t.StszAtom=t.StscAtom=t.SampleToChunkToken=t.SttsAtom=t.TimeToSampleToken=t.SoundSampleDescriptionV0=t.SoundSampleDescriptionVersion=t.StsdAtom=t.TrackHeaderAtom=t.NameAtom=t.DataAtom=t.MvhdAtom=t.MdhdAtom=t.FixedLengthAtom=t.mhdr=t.tkhd=t.ftyp=t.ExtendedSize=t.Header=void 0;const n=r(3416),a=r(1227),s=r(8049),o=(0,a.default)("music-metadata:parser:MP4:atom");t.Header={len:8,get:(e,t)=>{const r=n.UINT32_BE.get(e,t);if(r<0)throw new Error("Invalid atom header length");return{length:BigInt(r),name:new n.StringType(4,"binary").get(e,t+4)}},put:(e,t,r)=>(n.UINT32_BE.put(e,t,Number(r.length)),s.FourCcToken.put(e,t+4,r.name))},t.ExtendedSize=n.UINT64_BE,t.ftyp={len:4,get:(e,t)=>({type:new n.StringType(4,"ascii").get(e,t)})},t.tkhd={len:4,get:(e,t)=>({type:new n.StringType(4,"ascii").get(e,t)})},t.mhdr={len:8,get:(e,t)=>({version:n.UINT8.get(e,t),flags:n.UINT24_BE.get(e,t+1),nextItemID:n.UINT32_BE.get(e,t+4)})};class l{constructor(e,t,r){if(this.len=e,e<t)throw new Error(`Atom ${r} expected to be ${t}, but specifies ${e} bytes long.`);e>t&&o(`Warning: atom ${r} expected to be ${t}, but was actually ${e} bytes long.`)}}t.FixedLengthAtom=l;const c=(e,t)=>{const r=n.UINT32_BE.get(e,t)-2082844800;return new Date(1e3*r)};t.MdhdAtom=class extends l{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,t){return{version:n.UINT8.get(e,t+0),flags:n.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),timeScale:n.UINT32_BE.get(e,t+12),duration:n.UINT32_BE.get(e,t+16),language:n.UINT16_BE.get(e,t+20),quality:n.UINT16_BE.get(e,t+22)}}},t.MvhdAtom=class extends l{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,t){return{version:n.UINT8.get(e,t),flags:n.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),timeScale:n.UINT32_BE.get(e,t+12),duration:n.UINT32_BE.get(e,t+16),preferredRate:n.UINT32_BE.get(e,t+20),preferredVolume:n.UINT16_BE.get(e,t+24),previewTime:n.UINT32_BE.get(e,t+72),previewDuration:n.UINT32_BE.get(e,t+76),posterTime:n.UINT32_BE.get(e,t+80),selectionTime:n.UINT32_BE.get(e,t+84),selectionDuration:n.UINT32_BE.get(e,t+88),currentTime:n.UINT32_BE.get(e,t+92),nextTrackID:n.UINT32_BE.get(e,t+96)}}},t.DataAtom=class{constructor(e){this.len=e}get(e,t){return{type:{set:n.UINT8.get(e,t+0),type:n.UINT24_BE.get(e,t+1)},locale:n.UINT24_BE.get(e,t+4),value:i.from(new n.Uint8ArrayType(this.len-8).get(e,t+8))}}},t.NameAtom=class{constructor(e){this.len=e}get(e,t){return{version:n.UINT8.get(e,t),flags:n.UINT24_BE.get(e,t+1),name:new n.StringType(this.len-4,"utf-8").get(e,t+4)}}},t.TrackHeaderAtom=class{constructor(e){this.len=e}get(e,t){return{version:n.UINT8.get(e,t),flags:n.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),trackId:n.UINT32_BE.get(e,t+12),duration:n.UINT32_BE.get(e,t+20),layer:n.UINT16_BE.get(e,t+24),alternateGroup:n.UINT16_BE.get(e,t+26),volume:n.UINT16_BE.get(e,t+28)}}};class u{constructor(e){this.len=e}get(e,t){return{dataFormat:s.FourCcToken.get(e,t),dataReferenceIndex:n.UINT16_BE.get(e,t+10),description:new n.Uint8ArrayType(this.len-12).get(e,t+12)}}}t.StsdAtom=class{constructor(e){this.len=e}get(e,t){const r=((e,t)=>({version:n.UINT8.get(e,t),flags:n.UINT24_BE.get(e,t+1),numberOfEntries:n.UINT32_BE.get(e,t+4)}))(e,t);t+=8;const i=[];for(let a=0;a<r.numberOfEntries;++a){const r=n.UINT32_BE.get(e,t);t+=n.UINT32_BE.len,i.push(new u(r).get(e,t)),t+=r}return{header:r,table:i}}},t.SoundSampleDescriptionVersion={len:8,get:(e,t)=>({version:n.INT16_BE.get(e,t),revision:n.INT16_BE.get(e,t+2),vendor:n.INT32_BE.get(e,t+4)})},t.SoundSampleDescriptionV0={len:12,get:(e,t)=>({numAudioChannels:n.INT16_BE.get(e,t+0),sampleSize:n.INT16_BE.get(e,t+2),compressionId:n.INT16_BE.get(e,t+4),packetSize:n.INT16_BE.get(e,t+6),sampleRate:n.UINT16_BE.get(e,t+8)+n.UINT16_BE.get(e,t+10)/1e4})};class h{constructor(e,t){this.len=e,this.token=t}get(e,t){const r=n.INT32_BE.get(e,t+4);return{version:n.INT8.get(e,t+0),flags:n.INT24_BE.get(e,t+1),numberOfEntries:r,entries:d(e,this.token,t+8,this.len-8,r)}}}function d(e,t,r,i,n){if(o(`remainingLen=${i}, numberOfEntries=${n} * token-len=${t.len}`),0===i)return[];if(i!==n*t.len)throw new Error("mismatch number-of-entries with remaining atom-length");const a=[];for(let i=0;i<n;++i)a.push(t.get(e,r)),r+=t.len;return a}t.TimeToSampleToken={len:8,get:(e,t)=>({count:n.INT32_BE.get(e,t+0),duration:n.INT32_BE.get(e,t+4)})},t.SttsAtom=class extends h{constructor(e){super(e,t.TimeToSampleToken),this.len=e}},t.SampleToChunkToken={len:12,get:(e,t)=>({firstChunk:n.INT32_BE.get(e,t),samplesPerChunk:n.INT32_BE.get(e,t+4),sampleDescriptionId:n.INT32_BE.get(e,t+8)})},t.StscAtom=class extends h{constructor(e){super(e,t.SampleToChunkToken),this.len=e}},t.StszAtom=class{constructor(e){this.len=e}get(e,t){const r=n.INT32_BE.get(e,t+8);return{version:n.INT8.get(e,t),flags:n.INT24_BE.get(e,t+1),sampleSize:n.INT32_BE.get(e,t+4),numberOfEntries:r,entries:d(e,n.INT32_BE,t+12,this.len-12,r)}}},t.StcoAtom=class extends h{constructor(e){super(e,n.INT32_BE),this.len=e}},t.ChapterText=class{constructor(e){this.len=e}get(e,t){const r=n.INT16_BE.get(e,t+0);return new n.StringType(r,"utf-8").get(e,t+2)}}},8841:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MP4Parser=void 0;const n=r(1227),a=r(3416),s=r(7805),o=r(2282),l=r(6032),c=r(9134),u=r(1060),h=(0,n.default)("music-metadata:parser:MP4"),d={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function f(e,t,r){return r.indexOf(e)===t}class m extends s.BasicParser{constructor(){super(...arguments),this.atomParsers={mvhd:async e=>{const t=await this.tokenizer.readToken(new u.MvhdAtom(e));this.metadata.setFormat("creationTime",t.creationTime),this.metadata.setFormat("modificationTime",t.modificationTime)},mdhd:async e=>{const t=await this.tokenizer.readToken(new u.MdhdAtom(e)),r=this.getTrackDescription();r.creationTime=t.creationTime,r.modificationTime=t.modificationTime,r.timeScale=t.timeScale,r.duration=t.duration},chap:async e=>{const t=this.getTrackDescription(),r=[];for(;e>=a.UINT32_BE.len;)r.push(await this.tokenizer.readNumber(a.UINT32_BE)),e-=a.UINT32_BE.len;t.chapterList=r},tkhd:async e=>{const t=await this.tokenizer.readToken(new u.TrackHeaderAtom(e));this.tracks.push(t)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const t=this.tracks.filter((e=>e.chapterList));if(1===t.length){const r=t[0].chapterList,i=this.tracks.filter((e=>-1!==r.indexOf(e.trackId)));if(1===i.length)return this.parseChapterTrack(i[0],t[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const t=[];for(;e>0;){const r=await this.tokenizer.readToken(u.ftyp);e-=u.ftyp.len;const i=r.type.replace(/\W/g,"");i.length>0&&t.push(i)}h(`ftyp: ${t.join("/")}`);const r=t.filter(f).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const t=await this.tokenizer.readToken(new u.StsdAtom(e));this.getTrackDescription().soundSampleDescription=t.table.map((e=>this.parseSoundSampleDescription(e)))},stsc:async e=>{const t=await this.tokenizer.readToken(new u.StscAtom(e));this.getTrackDescription().sampleToChunkTable=t.entries},stts:async e=>{const t=await this.tokenizer.readToken(new u.SttsAtom(e));this.getTrackDescription().timeToSampleTable=t.entries},stsz:async e=>{const t=await this.tokenizer.readToken(new u.StszAtom(e)),r=this.getTrackDescription();r.sampleSize=t.sampleSize,r.sampleSizeTable=t.entries},stco:async e=>{const t=await this.tokenizer.readToken(new u.StcoAtom(e));this.getTrackDescription().chunkOffsetTable=t.entries},date:async e=>{const t=await this.tokenizer.readToken(new a.StringType(e,"utf-8"));this.addTag("date",t)}}}static read_BE_Integer(e,t){const r=(t?"INT":"UINT")+8*e.length+(e.length>1?"_BE":""),i=a[r];if(!i)throw new Error('Token for integer type not found: "'+r+'"');return Number(i.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size;for(;!this.tokenizer.fileInfo.size||e>0;){try{if("\0\0\0\0"===(await this.tokenizer.peekToken(u.Header)).name){const e=`Error at offset=${this.tokenizer.position}: box.id=0`;h(e),this.addWarning(e);break}}catch(e){const t=`Error at offset=${this.tokenizer.position}: ${e.message}`;h(t),this.addWarning(t);break}const t=await c.Atom.readAtom(this.tokenizer,((e,t)=>this.handleAtom(e,t)),null,e);e-=t.header.length===BigInt(0)?e:Number(t.header.length)}const t=[];this.tracks.forEach((e=>{const r=[];e.soundSampleDescription.forEach((e=>{const t={},i=d[e.dataFormat];if(i?(r.push(i.format),t.codecName=i.format):t.codecName=`<${e.dataFormat}>`,e.description){const{description:r}=e;r.sampleRate>0&&(t.type=l.TrackType.audio,t.audio={samplingFrequency:r.sampleRate,bitDepth:r.sampleSize,channels:r.numAudioChannels})}this.metadata.addStreamInfo(t)})),r.length>=1&&t.push(r.join("/"))})),t.length>0&&this.metadata.setFormat("codec",t.filter(f).join("+"));const r=this.tracks.filter((e=>e.soundSampleDescription.length>=1&&e.soundSampleDescription[0].description&&e.soundSampleDescription[0].description.numAudioChannels>0));if(r.length>=1){const e=r[0],t=e.duration/e.timeScale;this.metadata.setFormat("duration",t);const i=e.soundSampleDescription[0];i.description&&(this.metadata.setFormat("sampleRate",i.description.sampleRate),this.metadata.setFormat("bitsPerSample",i.description.sampleSize),this.metadata.setFormat("numberOfChannels",i.description.numAudioChannels));const n=d[i.dataFormat];n&&this.metadata.setFormat("lossless",!n.lossy),this.calculateBitRate()}}async handleAtom(e,t){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](t);h(`No parser for atom path=${e.atomPath}, payload-len=${t}, ignoring atom`),await this.tokenizer.ignore(t)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}addTag(e,t){this.metadata.addTag("iTunes",e,t)}addWarning(e){h("Warning: "+e),this.metadata.addWarning(e)}parseMetadataItemData(e){let t=e.header.name;return e.readAtoms(this.tokenizer,(async(e,r)=>{const i=e.getPayloadLength(r);switch(e.header.name){case"data":return this.parseValueAtom(t,e);case"name":const r=await this.tokenizer.readToken(new u.NameAtom(i));t+=":"+r.name;break;case"mean":const n=await this.tokenizer.readToken(new u.NameAtom(i));t+=":"+n.name;break;default:const s=await this.tokenizer.readToken(new a.BufferType(i));this.addWarning("Unsupported meta-item: "+t+"["+e.header.name+"] => value="+s.toString("hex")+" ascii="+s.toString("ascii"))}}),e.getPayloadLength(0))}async parseValueAtom(e,t){const r=await this.tokenizer.readToken(new u.DataAtom(Number(t.header.length)-u.Header.len));if(0!==r.type.set)throw new Error("Unsupported type-set != 0: "+r.type.set);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":const t=a.UINT8.get(r.value,3),i=a.UINT8.get(r.value,5);this.addTag(e,t+"/"+i);break;case"gnre":const n=a.UINT8.get(r.value,1),s=o.Genres[n-1];this.addTag(e,s)}break;case 1:case 18:this.addTag(e,r.value.toString("utf-8"));break;case 13:if(this.options.skipCovers)break;this.addTag(e,{format:"image/jpeg",data:i.from(r.value)});break;case 14:if(this.options.skipCovers)break;this.addTag(e,{format:"image/png",data:i.from(r.value)});break;case 21:this.addTag(e,m.read_BE_Integer(r.value,!0));break;case 22:this.addTag(e,m.read_BE_Integer(r.value,!1));break;case 65:this.addTag(e,r.value.readInt8(0));break;case 66:this.addTag(e,r.value.readInt16BE(0));break;case 67:this.addTag(e,r.value.readInt32BE(0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const t={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const i=u.SoundSampleDescriptionVersion.get(e.description,r);return r+=u.SoundSampleDescriptionVersion.len,0===i.version||1===i.version?t.description=u.SoundSampleDescriptionV0.get(e.description,r):h(`Warning: sound-sample-description ${i} not implemented`),t}async parseChapterTrack(e,t,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const i=[];for(let n=0;n<e.chunkOffsetTable.length&&r>0;++n){const a=e.chunkOffsetTable[n]-this.tokenizer.position,s=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[n];if((r-=a+s)<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(a);const o=await this.tokenizer.readToken(new u.ChapterText(s));h(`Chapter ${n+1}: ${o}`);const l={title:o,sampleOffset:this.findSampleOffset(t,this.tokenizer.position)};h(`Chapter title=${l.title}, offset=${l.sampleOffset}/${this.tracks[0].duration}`),i.push(l)}this.metadata.setFormat("chapters",i),await this.tokenizer.ignore(r)}findSampleOffset(e,t){let r=0;e.timeToSampleTable.forEach((e=>{r+=e.count*e.duration})),h(`Total duration=${r}`);let i=0;for(;i<e.chunkOffsetTable.length&&e.chunkOffsetTable[i]<t;)++i;return this.getChunkDuration(i+1,e)}getChunkDuration(e,t){let r=0,i=t.timeToSampleTable[r].count,n=t.timeToSampleTable[r].duration,a=1,s=this.getSamplesPerChunk(a,t.sampleToChunkTable),o=0;for(;a<e;){const e=Math.min(i,s);o+=e*n,i-=e,s-=e,0===s?(++a,s=this.getSamplesPerChunk(a,t.sampleToChunkTable)):(++r,i=t.timeToSampleTable[r].count,n=t.timeToSampleTable[r].duration)}return o}getSamplesPerChunk(e,t){for(let r=0;r<t.length-1;++r)if(e>=t[r].firstChunk&&e<t[r+1].firstChunk)return t[r].samplesPerChunk;return t[t.length-1].samplesPerChunk}}t.MP4Parser=m},7852:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MP4TagMapper=t.tagType=void 0;const i=r(4132),n={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik"};t.tagType="iTunes";class a extends i.CaseInsensitiveTagMap{constructor(){super([t.tagType],n)}}t.MP4TagMapper=a},5261:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedLameHeader=void 0;const i=r(3416),n=r(3769),a=r(6118);t.ExtendedLameHeader={len:27,get:(e,t)=>{const r=i.UINT32_BE.get(e,t+2);return{revision:n.getBitAllignedNumber(e,t,0,4),vbr_method:n.getBitAllignedNumber(e,t,4,4),lowpass_filter:100*i.UINT8.get(e,t+1),track_peak:0===r?void 0:r/Math.pow(2,23),track_gain:a.ReplayGain.get(e,6),album_gain:a.ReplayGain.get(e,8),music_length:i.UINT32_BE.get(e,t+20),music_crc:i.UINT8.get(e,t+24),header_crc:i.UINT16_BE.get(e,t+24)}}}},60:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MpegParser=void 0;const n=r(3416),a=r(5849),s=r(1227),o=r(3769),l=r(5159),c=r(3566),u=(0,s.default)("music-metadata:parser:mpeg"),h={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,void 0,void 0,-1]},d=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class f{constructor(e,t){this.versionIndex=o.getBitAllignedNumber(e,t+1,3,2),this.layer=f.LayerDescription[o.getBitAllignedNumber(e,t+1,5,2)],this.versionIndex>1&&0===this.layer?this.parseAdtsHeader(e,t):this.parseMpegHeader(e,t),this.isProtectedByCRC=!o.isBitSet(e,t+1,7)}calcDuration(e){return e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return f.samplesInFrameTable[1===this.version?0:1][this.layer]}calculateSideInfoLength(){if(3!==this.layer)return 2;if(3===this.channelModeIndex){if(1===this.version)return 17;if(2===this.version||2.5===this.version)return 9}else{if(1===this.version)return 32;if(2===this.version||2.5===this.version)return 17}}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,t){this.container="MPEG",this.bitrateIndex=o.getBitAllignedNumber(e,t+2,0,4),this.sampRateFreqIndex=o.getBitAllignedNumber(e,t+2,4,2),this.padding=o.isBitSet(e,t+2,6),this.privateBit=o.isBitSet(e,t+2,7),this.channelModeIndex=o.getBitAllignedNumber(e,t+3,0,2),this.modeExtension=o.getBitAllignedNumber(e,t+3,2,2),this.isCopyrighted=o.isBitSet(e,t+3,4),this.isOriginalMedia=o.isBitSet(e,t+3,5),this.emphasis=o.getBitAllignedNumber(e,t+3,7,2),this.version=f.VersionID[this.versionIndex],this.channelMode=f.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=1e3*r,this.samplingRate=this.calcSamplingRate(),null==this.samplingRate)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,t){u("layer=0 => ADTS"),this.version=2===this.versionIndex?4:2,this.container="ADTS/MPEG-"+this.version;const r=o.getBitAllignedNumber(e,t+2,0,2);this.codec="AAC",this.codecProfile=h.AudioObjectTypes[r],u(`MPEG-4 audio-codec=${this.codec}`);const i=o.getBitAllignedNumber(e,t+2,2,4);this.samplingRate=h.SamplingFrequencies[i],u(`sampling-rate=${this.samplingRate}`);const n=o.getBitAllignedNumber(e,t+2,7,3);this.mp4ChannelConfig=d[n],u(`channel-config=${this.mp4ChannelConfig.join("+")}`),this.frameLength=o.getBitAllignedNumber(e,t+3,6,2)<<11}calcBitrate(){if(0===this.bitrateIndex||15===this.bitrateIndex)return;const e=`${Math.floor(this.version)}${this.layer}`;return f.bitrate_index[this.bitrateIndex][e]}calcSamplingRate(){return 3===this.sampRateFreqIndex?null:f.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}f.SyncByte1=255,f.SyncByte2=224,f.VersionID=[2.5,null,2,1],f.LayerDescription=[0,3,2,1],f.ChannelMode=["stereo","joint_stereo","dual_channel","mono"],f.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}},f.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}},f.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];class m extends l.AbstractID3Parser{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.calculateEofDuration=!1,this.buf_frame_header=i.alloc(4),this.syncPeek={buf:i.alloc(1024),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(!(e instanceof a.EndOfStreamError))throw e;if(u("End-of-stream"),this.calculateEofDuration){const e=this.frameCount*this.samplesPerFrame;this.metadata.setFormat("numberOfSamples",e);const t=e/this.metadata.format.sampleRate;u(`Calculate duration at EOF: ${t} sec.`,t),this.metadata.setFormat("duration",t)}}}finalize(){const e=this.metadata.format,t=this.metadata.native.hasOwnProperty("ID3v1");if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0);e.codecProfile&&"V"===e.codecProfile[0]&&this.metadata.setFormat("bitrate",8*r/e.duration)}else if(this.tokenizer.fileInfo.size&&"CBR"===e.codecProfile){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0),i=Math.round(r/this.frame_size)*this.samplesPerFrame;this.metadata.setFormat("numberOfSamples",i);const n=i/e.sampleRate;u("Calculate CBR duration based on file size: %s",n),this.metadata.setFormat("duration",n)}}async sync(){let e=!1;for(;;){let t=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:1024,mayBeLess:!0}),this.syncPeek.len<=163)throw new a.EndOfStreamError;for(;;){if(e&&224==(224&this.syncPeek.buf[t]))return this.buf_frame_header[0]=f.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[t],await this.tokenizer.ignore(t),u(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(u(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),void(this.syncFrameCount=this.frameCount);if(e=!1,t=this.syncPeek.buf.indexOf(f.SyncByte1,t),-1===t){if(this.syncPeek.len<this.syncPeek.buf.length)throw new a.EndOfStreamError;await this.tokenizer.ignore(this.syncPeek.len);break}++t,e=!0}}}async parseCommonMpegHeader(){let e;0===this.frameCount&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});try{t=this.buf_frame_header,e=new f(t,0)}catch(e){return await this.tokenizer.ignore(1),this.metadata.addWarning("Parse error: "+e.message),!1}var t;return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version>=2&&0===e.layer?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels","mono"===e.channelMode?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<2e5&&u("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const t=e.calcSlotSize();if(null===t)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();u(`samples_per_frame=${r}`);const i=r/8*e.bitrate/e.samplingRate+(e.padding?t:0);if(this.frame_size=Math.floor(i),this.audioFrameHeader=e,this.bitrates.push(e.bitrate),1===this.frameCount)return this.offset=4,await this.skipSideInformation(),!1;if(3===this.frameCount){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&4===this.frameCount&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const t=i.alloc(3);await this.tokenizer.readBuffer(t),e.frameLength+=o.getBitAllignedNumber(t,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024;const r=e.samplingRate/this.samplesPerFrame,n=8*(0===this.frameCount?0:this.totalDataLength/this.frameCount)*r+.5;if(this.metadata.setFormat("bitrate",n),u(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${n}`),await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),3===this.frameCount){if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),!this.options.duration)return!0;this.calculateEofDuration=!0}return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(n.INT16_BE),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){const e=this.audioFrameHeader.calculateSideInfoLength();await this.tokenizer.readToken(new n.Uint8ArrayType(e)),this.offset+=e,await this.readXtraInfoHeader()}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(c.InfoTagHeaderTag);switch(this.offset+=c.InfoTagHeaderTag.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":const e=(t=(await this.readXingInfoHeader()).vbrScale,"V"+Math.floor((100-t)/10));return this.metadata.setFormat("codecProfile",e),null;case"Xtra":break;case"LAME":const r=await this.tokenizer.readToken(c.LameEncoderVersion);if(this.frame_size>=this.offset+c.LameEncoderVersion.len)return this.offset+=c.LameEncoderVersion.len,this.metadata.setFormat("tool","LAME "+r),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header")}var t;const r=this.frame_size-this.offset;return r<0?this.metadata.addWarning("Frame "+this.frameCount+"corrupt: negative frameDataLeft"):await this.skipFrameData(r),null}async readXingInfoHeader(){const e=this.tokenizer.position,t=await(0,c.readXingHeader)(this.tokenizer);if(this.offset+=this.tokenizer.position-e,t.lame&&(this.metadata.setFormat("tool","LAME "+o.stripNulls(t.lame.version)),t.lame.extended&&(this.metadata.setFormat("trackPeakLevel",t.lame.extended.track_peak),t.lame.extended.track_gain&&this.metadata.setFormat("trackGain",t.lame.extended.track_gain.adjustment),t.lame.extended.album_gain&&this.metadata.setFormat("albumGain",t.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",t.lame.extended.music_length/1e3))),t.streamSize){const e=this.audioFrameHeader.calcDuration(t.numFrames);return this.metadata.setFormat("duration",e),u("Get duration from Xing header: %s",this.metadata.format.duration),t}const r=this.frame_size-this.offset;return await this.skipFrameData(r),t}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const t=e[0];return e.every((e=>e===t))}}t.MpegParser=m},6118:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReplayGain=void 0;const i=r(3769);var n,a;!function(e){e[e.not_set=0]="not_set",e[e.radio=1]="radio",e[e.audiophile=2]="audiophile"}(n||(n={})),function(e){e[e.unspecified=0]="unspecified",e[e.engineer=1]="engineer",e[e.user=2]="user",e[e.automatic=3]="automatic",e[e.rms_average=4]="rms_average"}(a||(a={})),t.ReplayGain={len:2,get:(e,t)=>{const r=i.getBitAllignedNumber(e,t,0,3),n=i.getBitAllignedNumber(e,t,6,1),a=i.getBitAllignedNumber(e,t,7,9)/10;if(r>0)return{type:i.getBitAllignedNumber(e,t,0,3),origin:i.getBitAllignedNumber(e,t,3,3),adjustment:n?-a:a}}}},3566:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.readXingHeader=t.XingHeaderFlags=t.LameEncoderVersion=t.InfoTagHeaderTag=void 0;const n=r(3416),a=r(3769),s=r(5261);t.InfoTagHeaderTag=new n.StringType(4,"ascii"),t.LameEncoderVersion=new n.StringType(6,"ascii"),t.XingHeaderFlags={len:4,get:(e,t)=>({frames:a.isBitSet(e,t,31),bytes:a.isBitSet(e,t,30),toc:a.isBitSet(e,t,29),vbrScale:a.isBitSet(e,t,28)})},t.readXingHeader=async function(e){const r=await e.readToken(t.XingHeaderFlags),a={};if(r.frames&&(a.numFrames=await e.readToken(n.UINT32_BE)),r.bytes&&(a.streamSize=await e.readToken(n.UINT32_BE)),r.toc&&(a.toc=i.alloc(100),await e.readBuffer(a.toc)),r.vbrScale&&(a.vbrScale=await e.readToken(n.UINT32_BE)),"LAME"===await e.peekToken(new n.StringType(4,"ascii"))&&(await e.ignore(4),a.lame={version:await e.readToken(new n.StringType(5,"ascii"))},a.lame.version.match(/\d+.\d+/g))){const t=a.lame.version.match(/\d+.\d+/g)[0].split(".").map((e=>parseInt(e,10)));t[0]>=3&&t[1]>=90&&(a.lame.extended=await e.readToken(s.ExtendedLameHeader))}return a}},9606:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(1227),n=r(3416),a=r(5159),s=r(5170),o=r(3928),l=(0,i.default)("music-metadata:parser:musepack");class c extends a.AbstractID3Parser{async postId3v2Parse(){let e;switch(await this.tokenizer.peekToken(new n.StringType(3,"binary"))){case"MP+":l("Musepack stream-version 7"),e=new o.MpcSv7Parser;break;case"MPC":l("Musepack stream-version 8"),e=new s.MpcSv8Parser;break;default:throw new Error("Invalid Musepack signature prefix")}return e.init(this.metadata,this.tokenizer,this.options),e.parse()}}t.default=c},2812:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BitReader=void 0;const i=r(3416);t.BitReader=class{constructor(e){this.tokenizer=e,this.pos=0,this.dword=void 0}async read(e){for(;void 0===this.dword;)this.dword=await this.tokenizer.readToken(i.UINT32_LE);let t=this.dword;return this.pos+=e,this.pos<32?(t>>>=32-this.pos,t&(1<<e)-1):(this.pos-=32,0===this.pos?(this.dword=void 0,t&(1<<e)-1):(this.dword=await this.tokenizer.readToken(i.UINT32_LE),this.pos&&(t<<=this.pos,t|=this.dword>>>32-this.pos),t&(1<<e)-1))}async ignore(e){if(this.pos>0){const t=32-this.pos;this.dword=void 0,e-=t,this.pos=0}const t=e%32,r=(e-t)/32;return await this.tokenizer.ignore(4*r),this.read(t)}}},3928:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MpcSv7Parser=void 0;const i=r(1227),n=r(7805),a=r(6742),s=r(2812),o=r(8153),l=(0,i.default)("music-metadata:parser:musepack");class c extends n.BasicParser{constructor(){super(...arguments),this.audioLength=0}async parse(){const e=await this.tokenizer.readToken(o.Header);if("MP+"!==e.signature)throw new Error("Unexpected magic number");l(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const t=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",t),this.duration=t/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new s.BitReader(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),l(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const e=await this.bitreader.read(20);this.audioLength+=20+e,await this.bitreader.ignore(e)}const t=await this.bitreader.read(11);this.audioLength+=t,this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}t.MpcSv7Parser=c},8153:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const n=r(3416),a=r(3769);t.Header={len:24,get:(e,t)=>{const r={signature:i.from(e).toString("latin1",t,t+3),streamMinorVersion:a.getBitAllignedNumber(e,t+3,0,4),streamMajorVersion:a.getBitAllignedNumber(e,t+3,4,4),frameCount:n.UINT32_LE.get(e,t+4),maxLevel:n.UINT16_LE.get(e,t+8),sampleFrequency:[44100,48e3,37800,32e3][a.getBitAllignedNumber(e,t+10,0,2)],link:a.getBitAllignedNumber(e,t+10,2,2),profile:a.getBitAllignedNumber(e,t+10,4,4),maxBand:a.getBitAllignedNumber(e,t+11,0,6),intensityStereo:a.isBitSet(e,t+11,6),midSideStereo:a.isBitSet(e,t+11,7),titlePeak:n.UINT16_LE.get(e,t+12),titleGain:n.UINT16_LE.get(e,t+14),albumPeak:n.UINT16_LE.get(e,t+16),albumGain:n.UINT16_LE.get(e,t+18),lastFrameLength:n.UINT32_LE.get(e,t+20)>>>20&2047,trueGapless:a.isBitSet(e,t+23,0)};return r.lastFrameLength=r.trueGapless?n.UINT32_LE.get(e,20)>>>20&2047:0,r}}},5170:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MpcSv8Parser=void 0;const i=r(1227),n=r(7805),a=r(6742),s=r(8049),o=r(8850),l=(0,i.default)("music-metadata:parser:musepack");class c extends n.BasicParser{constructor(){super(...arguments),this.audioLength=0}async parse(){if("MPCK"!==await this.tokenizer.readToken(s.FourCcToken))throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new o.StreamReader(this.tokenizer);for(;;){const t=await e.readPacketHeader();switch(l(`packet-header key=${t.key}, payloadLength=${t.payloadLength}`),t.key){case"SH":const r=await e.readStreamHeader(t.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break;case"AP":this.audioLength+=t.payloadLength,await this.tokenizer.ignore(t.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(t.payloadLength);break;case"SE":return this.metadata.setFormat("bitrate",8*this.audioLength/this.metadata.format.duration),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${t.key}`)}}}}t.MpcSv8Parser=c},8850:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=void 0;const i=r(3416),n=r(1227),a=r(3769),s=(0,n.default)("music-metadata:parser:musepack:sv8"),o=new i.StringType(2,"binary"),l={len:5,get:(e,t)=>({crc:i.UINT32_LE.get(e,t),streamVersion:i.UINT8.get(e,t+4)})},c={len:2,get:(e,t)=>({sampleFrequency:[44100,48e3,37800,32e3][a.getBitAllignedNumber(e,t,0,3)],maxUsedBands:a.getBitAllignedNumber(e,t,3,5),channelCount:a.getBitAllignedNumber(e,t+1,0,4)+1,msUsed:a.isBitSet(e,t+1,4),audioBlockFrames:a.getBitAllignedNumber(e,t+1,5,3)})};t.StreamReader=class{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(o),t=await this.readVariableSizeField();return{key:e,payloadLength:t.value-2-t.len}}async readStreamHeader(e){const t={};s(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(l);e-=l.len,Object.assign(t,r),s(`SH.streamVersion = ${r.streamVersion}`);const i=await this.readVariableSizeField();e-=i.len,t.sampleCount=i.value;const n=await this.readVariableSizeField();e-=n.len,t.beginningOfSilence=n.value;const a=await this.tokenizer.readToken(c);return e-=c.len,Object.assign(t,a),await this.tokenizer.ignore(e),t}async readVariableSizeField(e=1,t=0){let r=await this.tokenizer.readNumber(i.UINT8);return 0==(128&r)?{len:e,value:t+r}:(r&=127,r+=t,this.readVariableSizeField(e+1,r<<7))}}},1915:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.OggParser=t.SegmentTable=void 0;const n=r(3416),a=r(5849),s=r(1227),o=r(3769),l=r(8049),c=r(7805),u=r(4210),h=r(1272),d=r(573),f=r(2630),m=(0,s.default)("music-metadata:parser:ogg");class p{constructor(e){this.len=e.page_segments}static sum(e,t,r){let i=0;for(let n=t;n<t+r;++n)i+=e[n];return i}get(e,t){return{totalPageSize:p.sum(e,t,this.len)}}}t.SegmentTable=p;class g extends c.BasicParser{async parse(){m("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(g.Header),"OggS"!==e.capturePattern)throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,m("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const t=await this.tokenizer.readToken(new p(e));m("totalPageSize=%s",t.totalPageSize);const r=await this.tokenizer.readToken(new n.Uint8ArrayType(t.totalPageSize));if(m("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const e=new n.StringType(7,"ascii").get(i.from(r),0);switch(e){case"vorbis":m("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new u.VorbisParser(this.metadata,this.options);break;case"OpusHea":m("Set page consumer to Ogg/Opus"),this.pageConsumer=new h.OpusParser(this.metadata,this.options,this.tokenizer);break;case"Speex  ":m("Set page consumer to Ogg/Speex"),this.pageConsumer=new d.SpeexParser(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":m("Set page consumer to Ogg/Theora"),this.pageConsumer=new f.TheoraParser(this.metadata,this.options,this.tokenizer);break;default:throw new Error("gg audio-codec not recognized (id="+e+")")}}this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof a.EndOfStreamError)this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),m("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header);else{if(!e.message.startsWith("FourCC"))throw e;this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),this.pageConsumer.flush())}}}}t.OggParser=g,g.Header={len:27,get:(e,t)=>({capturePattern:l.FourCcToken.get(e,t),version:n.UINT8.get(e,t+4),headerType:{continued:o.getBit(e,t+5,0),firstPage:o.getBit(e,t+5,1),lastPage:o.getBit(e,t+5,2)},absoluteGranulePosition:Number(n.UINT64_LE.get(e,t+6)),streamSerialNumber:n.UINT32_LE.get(e,t+14),pageSequenceNo:n.UINT32_LE.get(e,t+18),pageChecksum:n.UINT32_LE.get(e,t+22),page_segments:n.UINT8.get(e,t+26)})}},5044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdHeader=void 0;const i=r(3416);t.IdHeader=class{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,t){return{magicSignature:new i.StringType(8,"ascii").get(e,t+0),version:e.readUInt8(t+8),channelCount:e.readUInt8(t+9),preSkip:e.readInt16LE(t+10),inputSampleRate:e.readInt32LE(t+12),outputGain:e.readInt16LE(t+16),channelMapping:e.readUInt8(t+18)}}}},1272:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpusParser=void 0;const i=r(3416),n=r(4210),a=r(5044);class s extends n.VorbisParser{constructor(e,t,r){super(e,t),this.tokenizer=r,this.lastPos=-1}parseFirstPage(e,t){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new a.IdHeader(t.length).get(t,0),"OpusHead"!==this.idHeader.magicSignature)throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}parseFullPage(e){"OpusTags"===new i.StringType(8,"ascii").get(e,0)&&(this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length)}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const t=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",t),this.metadata.setFormat("duration",t/48e3),-1!==this.lastPos&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const e=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}}}t.OpusParser=s},6666:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const i=r(3416),n=r(3769);t.Header={len:80,get:(e,t)=>({speex:new i.StringType(8,"ascii").get(e,t+0),version:n.trimRightNull(new i.StringType(20,"ascii").get(e,t+8)),version_id:e.readInt32LE(t+28),header_size:e.readInt32LE(t+32),rate:e.readInt32LE(t+36),mode:e.readInt32LE(t+40),mode_bitstream_version:e.readInt32LE(t+44),nb_channels:e.readInt32LE(t+48),bitrate:e.readInt32LE(t+52),frame_size:e.readInt32LE(t+56),vbr:e.readInt32LE(t+60),frames_per_packet:e.readInt32LE(t+64),extra_headers:e.readInt32LE(t+68),reserved1:e.readInt32LE(t+72),reserved2:e.readInt32LE(t+76)})}},573:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpeexParser=void 0;const i=r(1227),n=r(4210),a=r(6666),s=(0,i.default)("music-metadata:parser:ogg:speex");class o extends n.VorbisParser{constructor(e,t,r){super(e,t),this.tokenizer=r}parseFirstPage(e,t){s("First Ogg/Speex page");const r=a.Header.get(t,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),-1!==r.bitrate&&this.metadata.setFormat("bitrate",r.bitrate)}}t.SpeexParser=o},5177:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentificationHeader=void 0;const i=r(3416);t.IdentificationHeader={len:42,get:(e,t)=>({id:new i.StringType(7,"ascii").get(e,t),vmaj:e.readUInt8(t+7),vmin:e.readUInt8(t+8),vrev:e.readUInt8(t+9),vmbw:e.readUInt16BE(t+10),vmbh:e.readUInt16BE(t+17),nombr:i.UINT24_BE.get(e,t+37),nqual:e.readUInt8(t+40)})}},2630:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TheoraParser=void 0;const i=r(1227),n=r(5177),a=(0,i.default)("music-metadata:parser:ogg:theora");t.TheoraParser=class{constructor(e,t,r){this.metadata=e,this.tokenizer=r}parsePage(e,t){e.headerType.firstPage&&this.parseFirstPage(e,t)}flush(){a("flush")}calculateDuration(e){a("duration calculation not implemented")}parseFirstPage(e,t){a("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=n.IdentificationHeader.get(t,0);this.metadata.setFormat("bitrate",r.nombr)}}},2127:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.IdentificationHeader=t.CommonHeader=t.VorbisPictureToken=void 0;const n=r(3416),a=r(8281);class s{constructor(e){this.len=e}static fromBase64(e){return this.fromBuffer(i.from(e,"base64"))}static fromBuffer(e){return new s(e.length).get(e,0)}get(e,t){const r=a.AttachedPictureType[n.UINT32_BE.get(e,t)],s=n.UINT32_BE.get(e,t+=4),o=e.toString("utf-8",t+=4,t+s),l=n.UINT32_BE.get(e,t+=s),c=e.toString("utf-8",t+=4,t+l),u=n.UINT32_BE.get(e,t+=l),h=n.UINT32_BE.get(e,t+=4),d=n.UINT32_BE.get(e,t+=4),f=n.UINT32_BE.get(e,t+=4),m=n.UINT32_BE.get(e,t+=4);return{type:r,format:o,description:c,width:u,height:h,colour_depth:d,indexed_color:f,data:i.from(e.slice(t+=4,t+m))}}}t.VorbisPictureToken=s,t.CommonHeader={len:7,get:(e,t)=>({packetType:e.readUInt8(t),vorbis:new n.StringType(6,"ascii").get(e,t+1)})},t.IdentificationHeader={len:23,get:(e,t)=>{const r=new DataView(e.buffer,e.byteOffset);return{version:r.getUint32(t+0,!0),channelMode:r.getUint8(t+4),sampleRate:r.getUint32(t+5,!0),bitrateMax:r.getUint32(t+9,!0),bitrateNominal:r.getUint32(t+13,!0),bitrateMin:r.getUint32(t+17,!0)}}}},441:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisDecoder=void 0;const n=r(3416);t.VorbisDecoder=class{constructor(e,t){this.data=e,this.offset=t}readInt32(){const e=n.UINT32_LE.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),t=i.from(this.data).toString("utf-8",this.offset,this.offset+e);return this.offset+=e,t}parseUserComment(){const e=this.offset,t=this.readStringUtf8(),r=t.indexOf("=");return{key:t.slice(0,r).toUpperCase(),value:t.slice(r+1),len:this.offset-e}}}},4210:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisParser=void 0;const n=r(3416),a=r(1227),s=r(441),o=r(2127),l=(0,a.default)("music-metadata:parser:ogg:vorbis1");t.VorbisParser=class{constructor(e,t){this.metadata=e,this.options=t,this.pageSegments=[]}parsePage(e,t){if(e.headerType.firstPage)this.parseFirstPage(e,t);else{if(e.headerType.continued){if(0===this.pageSegments.length)throw new Error("Cannot continue on previous page");this.pageSegments.push(t)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const e=i.concat(this.pageSegments);this.parseFullPage(e)}this.pageSegments=e.headerType.lastPage?[]:[t]}}e.headerType.lastPage&&this.calculateDuration(e)}flush(){this.parseFullPage(i.concat(this.pageSegments))}parseUserComment(e,t){const r=new s.VorbisDecoder(e,t).parseUserComment();return this.addTag(r.key,r.value),r.len}addTag(e,t){if("METADATA_BLOCK_PICTURE"===e&&"string"==typeof t){if(this.options.skipCovers)return void l("Ignore picture");t=o.VorbisPictureToken.fromBase64(t),l(`Push picture: id=${e}, format=${t.format}`)}else l(`Push tag: id=${e}, value=${t}`);this.metadata.addTag("vorbis",e,t)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate))}parseFirstPage(e,t){this.metadata.setFormat("codec","Vorbis I"),l("Parse first page");const r=o.CommonHeader.get(t,0);if("vorbis"!==r.vorbis)throw new Error("Metadata does not look like Vorbis");if(1!==r.packetType)throw new Error("First Ogg page should be type 1: the identification header");{const e=o.IdentificationHeader.get(t,o.CommonHeader.len);this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("bitrate",e.bitrateNominal),this.metadata.setFormat("numberOfChannels",e.channelMode),l("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",e.sampleRate,e.bitrateNominal,e.channelMode)}}parseFullPage(e){const t=o.CommonHeader.get(e,0);if(l("Parse full page: type=%s, byteLength=%s",t.packetType,e.byteLength),3===t.packetType)return this.parseUserCommentList(e,o.CommonHeader.len)}parseUserCommentList(e,t){const r=n.UINT32_LE.get(e,t);t+=4,t+=r;let i=n.UINT32_LE.get(e,t);for(t+=4;i-- >0;)t+=this.parseUserComment(e,t)}}},9860:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisTagMapper=void 0;const i=r(9918),n={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class a extends i.CommonTagMapper{static toRating(e,t){return{source:e?e.toLowerCase():e,rating:parseFloat(t)*i.CommonTagMapper.maxRatingScore}}constructor(){super(["vorbis"],n)}postMap(e){if(0===e.id.indexOf("RATING:")){const t=e.id.split(":");e.value=a.toRating(t[1],e.value),e.id=t[0]}}}t.VorbisTagMapper=a},3211:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListInfoTagValue=t.Header=void 0;const i=r(3416);t.Header={len:8,get:(e,t)=>({chunkID:e.toString("binary",t,t+4),chunkSize:i.UINT32_LE.get(e,4)})},t.ListInfoTagValue=class{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=1&this.len}get(e,t){return new i.StringType(this.tagHeader.chunkSize,"ascii").get(e,t)}}},5756:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RiffInfoTagMapper=t.riffInfoTagMap=void 0;const i=r(9918);t.riffInfoTagMap={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class n extends i.CommonTagMapper{constructor(){super(["exif"],t.riffInfoTagMap)}}t.RiffInfoTagMapper=n},6032:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackType=void 0;var i=r(8591);Object.defineProperty(t,"TrackType",{enumerable:!0,get:function(){return i.TrackType}})},8053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BroadcastAudioExtensionChunk=void 0;const i=r(3416),n=r(3769);t.BroadcastAudioExtensionChunk={len:420,get:(e,t)=>({description:(0,n.stripNulls)(new i.StringType(256,"ascii").get(e,t)).trim(),originator:(0,n.stripNulls)(new i.StringType(32,"ascii").get(e,t+256)).trim(),originatorReference:(0,n.stripNulls)(new i.StringType(32,"ascii").get(e,t+288)).trim(),originationDate:(0,n.stripNulls)(new i.StringType(10,"ascii").get(e,t+320)).trim(),originationTime:(0,n.stripNulls)(new i.StringType(8,"ascii").get(e,t+330)).trim(),timeReferenceLow:i.UINT32_LE.get(e,t+338),timeReferenceHigh:i.UINT32_LE.get(e,t+342),version:i.UINT16_LE.get(e,t+346),umid:new i.Uint8ArrayType(64).get(e,t+348),loudnessValue:i.UINT16_LE.get(e,t+412),maxTruePeakLevel:i.UINT16_LE.get(e,t+414),maxMomentaryLoudness:i.UINT16_LE.get(e,t+416),maxShortTermLoudness:i.UINT16_LE.get(e,t+418)})}},9975:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.FactChunk=t.Format=t.WaveFormat=void 0,(r=t.WaveFormat||(t.WaveFormat={}))[r.PCM=1]="PCM",r[r.ADPCM=2]="ADPCM",r[r.IEEE_FLOAT=3]="IEEE_FLOAT",r[r.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",r[r.MPEG_LOAS=5634]="MPEG_LOAS",r[r.RAW_AAC1=255]="RAW_AAC1",r[r.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",r[r.DVM=8192]="DVM",r[r.RAW_SPORT=576]="RAW_SPORT",r[r.ESST_AC3=577]="ESST_AC3",r[r.DRM=9]="DRM",r[r.DTS2=8193]="DTS2",r[r.MPEG=80]="MPEG",t.Format=class{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,t){return{wFormatTag:e.readUInt16LE(t),nChannels:e.readUInt16LE(t+2),nSamplesPerSec:e.readUInt32LE(t+4),nAvgBytesPerSec:e.readUInt32LE(t+8),nBlockAlign:e.readUInt16LE(t+12),wBitsPerSample:e.readUInt16LE(t+14)}}},t.FactChunk=class{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,t){return{dwSampleLength:e.readUInt32LE(t)}}}},2682:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WaveParser=void 0;const i=r(5849),n=r(3416),a=r(1227),s=r(3211),o=r(9975),l=r(8928),c=r(3769),u=r(8049),h=r(7805),d=r(8053),f=(0,a.default)("music-metadata:parser:RIFF");class m extends h.BasicParser{async parse(){const e=await this.tokenizer.readToken(s.Header);if(f(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),"RIFF"===e.chunkID)return this.parseRiffChunk(e.chunkSize).catch((e=>{if(!(e instanceof i.EndOfStreamError))throw e}))}async parseRiffChunk(e){const t=await this.tokenizer.readToken(u.FourCcToken);if(this.metadata.setFormat("container",t),"WAVE"===t)return this.readWaveChunk(e-u.FourCcToken.len);throw new Error(`Unsupported RIFF format: RIFF/${t}`)}async readWaveChunk(e){for(;e>=s.Header.len;){const t=await this.tokenizer.readToken(s.Header);switch(e-=s.Header.len+t.chunkSize,t.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=t,f(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${t.chunkID}`),t.chunkID){case"LIST":await this.parseListTag(t);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new o.FactChunk(t));break;case"fmt ":const e=await this.tokenizer.readToken(new o.Format(t));let r=o.WaveFormat[e.wFormatTag];r||(f("WAVE/non-PCM format="+e.wFormatTag),r="non-PCM ("+e.wFormatTag+")"),this.metadata.setFormat("codec",r),this.metadata.setFormat("bitsPerSample",e.wBitsPerSample),this.metadata.setFormat("sampleRate",e.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",e.nChannels),this.metadata.setFormat("bitrate",e.nBlockAlign*e.nSamplesPerSec*8),this.blockAlign=e.nBlockAlign;break;case"id3 ":case"ID3 ":const a=await this.tokenizer.readToken(new n.Uint8ArrayType(t.chunkSize)),s=i.fromBuffer(a);await(new l.ID3v2Parser).parse(this.metadata,s,this.options);break;case"data":!1!==this.metadata.format.lossless&&this.metadata.setFormat("lossless",!0);let c=t.chunkSize;if(this.tokenizer.fileInfo.size){const e=this.tokenizer.fileInfo.size-this.tokenizer.position;e<c&&(this.metadata.addWarning("data chunk length exceeding file length"),c=e)}const u=this.fact?this.fact.dwSampleLength:4294967295===c?void 0:c/this.blockAlign;u&&(this.metadata.setFormat("numberOfSamples",u),this.metadata.setFormat("duration",u/this.metadata.format.sampleRate)),this.metadata.setFormat("bitrate",this.metadata.format.numberOfChannels*this.blockAlign*this.metadata.format.sampleRate),await this.tokenizer.ignore(t.chunkSize);break;case"bext":const h=await this.tokenizer.readToken(d.BroadcastAudioExtensionChunk);Object.keys(h).forEach((e=>{this.metadata.addTag("exif","bext."+e,h[e])}));const m=t.chunkSize-d.BroadcastAudioExtensionChunk.len;await this.tokenizer.ignore(m);break;case"\0\0\0\0":f(`Ignore padding chunk: RIFF/${t.chunkID} of ${t.chunkSize} bytes`),this.metadata.addWarning("Ignore chunk: RIFF/"+t.chunkID),await this.tokenizer.ignore(t.chunkSize);break;default:f(`Ignore chunk: RIFF/${t.chunkID} of ${t.chunkSize} bytes`),this.metadata.addWarning("Ignore chunk: RIFF/"+t.chunkID),await this.tokenizer.ignore(t.chunkSize)}this.header.chunkSize%2==1&&(f("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const t=await this.tokenizer.readToken(new n.StringType(4,"binary"));return f("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,t),"INFO"===t?this.parseRiffInfoTags(e.chunkSize-4):(this.metadata.addWarning("Ignore chunk: RIFF/WAVE/LIST/"+t),f("Ignoring chunkID=RIFF/WAVE/LIST/"+t),this.tokenizer.ignore(e.chunkSize-4).then())}async parseRiffInfoTags(e){for(;e>=8;){const t=await this.tokenizer.readToken(s.Header),r=new s.ListInfoTagValue(t),i=await this.tokenizer.readToken(r);this.addTag(t.chunkID,c.stripNulls(i)),e-=8+r.len}if(0!==e)throw Error("Illegal remaining size: "+e)}addTag(e,t){this.metadata.addTag("exif",e,t)}}t.WaveParser=m},5870:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.WavPackParser=void 0;const n=r(3416),a=r(6742),s=r(8049),o=r(7805),l=r(2989),c=(0,r(1227).default)("music-metadata:parser:WavPack");class u extends o.BasicParser{async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if("wvpk"!==await this.tokenizer.peekToken(s.FourCcToken))break;const e=await this.tokenizer.readToken(l.WavPack.BlockHeaderToken);if("wvpk"!==e.BlockID)throw new Error("Invalid WavPack Block-ID");c(`WavPack header blockIndex=${e.blockIndex}, len=${l.WavPack.BlockHeaderToken.len}`),0!==e.blockIndex||this.metadata.format.container||(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!e.flags.isHybrid),this.metadata.setFormat("bitsPerSample",e.flags.bitsPerSample),e.flags.isDSD||(this.metadata.setFormat("sampleRate",e.flags.samplingRate),this.metadata.setFormat("duration",e.totalSamples/e.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",e.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",e.totalSamples),this.metadata.setFormat("codec",e.flags.isDSD?"DSD":"PCM"));const t=e.blockSize-(l.WavPack.BlockHeaderToken.len-8);await(0===e.blockIndex?this.parseMetadataSubBlock(e,t):this.tokenizer.ignore(t)),e.blockSamples>0&&(this.audioDataSize+=e.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=l.WavPack.BlockHeaderToken.len);this.metadata.setFormat("bitrate",8*this.audioDataSize/this.metadata.format.duration)}async parseMetadataSubBlock(e,t){for(;t>l.WavPack.MetadataIdToken.len;){const r=await this.tokenizer.readToken(l.WavPack.MetadataIdToken),a=await this.tokenizer.readNumber(r.largeBlock?n.UINT24_LE:n.UINT8),s=i.alloc(2*a-(r.isOddSize?1:0));switch(await this.tokenizer.readBuffer(s),c(`Metadata Sub-Blocks functionId=0x${r.functionId.toString(16)}, id.largeBlock=${r.largeBlock},data-size=${s.length}`),r.functionId){case 0:break;case 14:c("ID_DSD_BLOCK");const t=1<<s.readUInt8(0),i=e.flags.samplingRate*t*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",i),this.metadata.setFormat("duration",e.totalSamples/i);break;case 36:c("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",s);break;case 47:c(`ID_BLOCK_CHECKSUM: checksum=${s.toString("hex")}`);break;default:c(`Ignore unsupported meta-sub-block-id functionId=0x${r.functionId.toString(16)}`)}t-=l.WavPack.MetadataIdToken.len+(r.largeBlock?n.UINT24_LE.len:n.UINT8.len)+2*a,c(`remainingLength=${t}`),r.isOddSize&&this.tokenizer.ignore(1)}if(0!==t)throw new Error("metadata-sub-block should fit it remaining length")}}t.WavPackParser=u},2989:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WavPack=void 0;const i=r(3416),n=r(8049),a=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1];class s{static isBitSet(e,t){return 1===s.getBitAllignedNumber(e,t,1)}static getBitAllignedNumber(e,t,r){return e>>>t&4294967295>>>32-r}}t.WavPack=s,s.BlockHeaderToken={len:32,get:(e,t)=>{const r=i.UINT32_LE.get(e,t+24),o={BlockID:n.FourCcToken.get(e,t),blockSize:i.UINT32_LE.get(e,t+4),version:i.UINT16_LE.get(e,t+8),totalSamples:i.UINT32_LE.get(e,t+12),blockIndex:i.UINT32_LE.get(e,t+16),blockSamples:i.UINT32_LE.get(e,t+20),flags:{bitsPerSample:8*(1+s.getBitAllignedNumber(r,0,2)),isMono:s.isBitSet(r,2),isHybrid:s.isBitSet(r,3),isJointStereo:s.isBitSet(r,4),crossChannel:s.isBitSet(r,5),hybridNoiseShaping:s.isBitSet(r,6),floatingPoint:s.isBitSet(r,7),samplingRate:a[s.getBitAllignedNumber(r,23,4)],isDSD:s.isBitSet(r,31)},crc:new i.Uint8ArrayType(4).get(e,t+28)};return o.flags.isDSD&&(o.totalSamples*=8),o}},s.MetadataIdToken={len:1,get:(e,t)=>({functionId:s.getBitAllignedNumber(e[t],0,6),isOptional:s.isBitSet(e[t],5),isOddSize:s.isBitSet(e[t],6),largeBlock:s.isBitSet(e[t],7)})}},8985:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0,t.Deferred=class{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}},7279:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndOfStreamError=t.defaultMessages=void 0,t.defaultMessages="End-Of-Stream";class r extends Error{constructor(){super(t.defaultMessages)}}t.EndOfStreamError=r},6654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=t.EndOfStreamError=void 0;const i=r(7279),n=r(8985);var a=r(7279);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return a.EndOfStreamError}}),t.StreamReader=class{constructor(e){if(this.s=e,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!e.read||!e.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",(()=>this.reject(new i.EndOfStreamError))),this.s.once("error",(e=>this.reject(e))),this.s.once("close",(()=>this.reject(new Error("Stream closed"))))}async peek(e,t,r){const i=await this.read(e,t,r);return this.peekQueue.push(e.subarray(t,t+i)),i}async read(e,t,r){if(0===r)return 0;if(0===this.peekQueue.length&&this.endOfStream)throw new i.EndOfStreamError;let n=r,a=0;for(;this.peekQueue.length>0&&n>0;){const r=this.peekQueue.pop();if(!r)throw new Error("peekData should be defined");const i=Math.min(r.length,n);e.set(r.subarray(0,i),t+a),a+=i,n-=i,i<r.length&&this.peekQueue.push(r.subarray(i))}for(;n>0&&!this.endOfStream;){const r=Math.min(n,1048576),i=await this.readFromStream(e,t+a,r);if(a+=i,i<r)break;n-=i}return a}async readFromStream(e,t,r){const i=this.s.read(r);if(i)return e.set(i,t),i.length;{const i={buffer:e,offset:t,length:r,deferred:new n.Deferred};return this.deferred=i.deferred,this.s.once("readable",(()=>{this.readDeferred(i)})),i.deferred.promise}}readDeferred(e){const t=this.s.read(e.length);t?(e.buffer.set(t,e.offset),e.deferred.resolve(t.length),this.deferred=null):this.s.once("readable",(()=>{this.readDeferred(e)}))}reject(e){this.endOfStream=!0,this.deferred&&(this.deferred.reject(e),this.deferred=null)}}},5167:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=t.EndOfStreamError=void 0;var i=r(7279);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return i.EndOfStreamError}});var n=r(6654);Object.defineProperty(t,"StreamReader",{enumerable:!0,get:function(){return n.StreamReader}})},4155:e=>{var t,r,i=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:n}catch(e){t=n}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var o,l=[],c=!1,u=-1;function h(){c&&o&&(c=!1,o.length?l=o.concat(l):u=-1,l.length&&d())}function d(){if(!c){var e=s(h);c=!0;for(var t=l.length;t;){for(o=l,l=[];++u<t;)o&&o[u].run();u=-1,t=l.length}o=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new f(e,t)),1!==l.length||c||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},4448:(e,t,r)=>{"use strict";var i=r(7294),n=r(3840);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function p(e,t,r,i,n,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var A=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function v(e,t,r,i){var n=g.hasOwnProperty(t)?g[t]:null;(null!==n?0!==n.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,i){if(null==t||function(e,t,r,i){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,i))return!0;if(i)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,n,i)&&(r=null),i||null===n?function(e){return!!h.call(m,e)||!h.call(f,e)&&(d.test(e)?m[e]=!0:(f[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=null===r?3!==n.type&&"":r:(t=n.attributeName,i=n.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(n=n.type)||4===n&&!0===r?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(A,b);g[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(A,b);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(A,b);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var y=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),E=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),k=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var B=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function D(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=L&&e[L]||e["@@iterator"])?e:null}var N,F=Object.assign;function O(e){if(void 0===N)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var z=!1;function U(e,t){if(!e||z)return"";z=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var i=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){i=e}e.call(t.prototype)}else{try{throw Error()}catch(e){i=e}e()}}catch(t){if(t&&i&&"string"==typeof t.stack){for(var n=t.stack.split("\n"),a=i.stack.split("\n"),s=n.length-1,o=a.length-1;1<=s&&0<=o&&n[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(n[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||n[s]!==a[o]){var l="\n"+n[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?O(e):""}function j(e){switch(e.tag){case 5:return O(e.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return U(e.type,!1);case 11:return U(e.type.render,!1);case 1:return U(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case _:return"Fragment";case E:return"Portal";case S:return"Profiler";case T:return"StrictMode";case C:return"Suspense";case P:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case x:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case M:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return V(e(t))}catch(e){}}return null}function Q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function X(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=X(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var n=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){i=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function H(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=X(e)?e.checked?"true":"false":e.value),(e=i)!==r&&(t.setValue(e),!0)}function G(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var r=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Y(e,t){var r=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;r=q(null!=t.value?t.value:r),e._wrapperState={initialChecked:i,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function K(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function J(e,t){K(e,t);var r=q(t.value),i=t.type;if(null!=r)"number"===i?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&G(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,i){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&i&&(e[r].defaultSelected=!0)}else{for(r=""+q(r),t=null,n=0;n<e.length;n++){if(e[n].value===r)return e[n].selected=!0,void(i&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ne(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(a(92));if(te(r)){if(1<r.length)throw Error(a(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:q(r)}}function ae(e,t){var r=q(t.value),i=q(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=i&&(e.defaultValue=""+i)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function pe(e,t,r){return null==t||"boolean"==typeof t||""===t?"":r||"number"!=typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var i=0===r.indexOf("--"),n=pe(r,t[r],i);"float"===r&&(r="cssFloat"),i?e.setProperty(r,n):e[r]=n}}Object.keys(fe).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var Ae=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(Ae[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,_e=null,Te=null;function Se(e){if(e=vn(e)){if("function"!=typeof Ee)throw Error(a(280));var t=e.stateNode;t&&(t=wn(t),Ee(e.stateNode,e.type,t))}}function xe(e){_e?Te?Te.push(e):Te=[e]:_e=e}function ke(){if(_e){var e=_e,t=Te;if(Te=_e=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ie(e,t){return e(t)}function Ce(){}var Pe=!1;function Me(e,t,r){if(Pe)return e(t,r);Pe=!0;try{return Ie(e,t,r)}finally{Pe=!1,(null!==_e||null!==Te)&&(Ce(),ke())}}function Re(e,t){var r=e.stateNode;if(null===r)return null;var i=wn(r);if(null===i)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(r&&"function"!=typeof r)throw Error(a(231,t,typeof r));return r}var Be=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Be=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ue){Be=!1}function De(e,t,r,i,n,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(e){this.onError(e)}}var Ne=!1,Fe=null,Oe=!1,ze=null,Ue={onError:function(e){Ne=!0,Fe=e}};function je(e,t,r,i,n,a,s,o,l){Ne=!1,Fe=null,De.apply(Ue,arguments)}function Ve(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function Qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function qe(e){if(Ve(e)!==e)throw Error(a(188))}function Xe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(a(188));return t!==e?null:e}for(var r=e,i=t;;){var n=r.return;if(null===n)break;var s=n.alternate;if(null===s){if(null!==(i=n.return)){r=i;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===r)return qe(n),e;if(s===i)return qe(n),t;s=s.sibling}throw Error(a(188))}if(r.return!==i.return)r=n,i=s;else{for(var o=!1,l=n.child;l;){if(l===r){o=!0,r=n,i=s;break}if(l===i){o=!0,i=n,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,i=n;break}if(l===i){o=!0,i=s,r=n;break}l=l.sibling}if(!o)throw Error(a(189))}}if(r.alternate!==i)throw Error(a(190))}if(3!==r.tag)throw Error(a(188));return r.stateNode.current===r?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var He=n.unstable_scheduleCallback,Ge=n.unstable_cancelCallback,$e=n.unstable_shouldYield,Ye=n.unstable_requestPaint,Ke=n.unstable_now,Je=n.unstable_getCurrentPriorityLevel,Ze=n.unstable_ImmediatePriority,et=n.unstable_UserBlockingPriority,tt=n.unstable_NormalPriority,rt=n.unstable_LowPriority,it=n.unstable_IdlePriority,nt=null,at=null,st=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2,ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var r=e.pendingLanes;if(0===r)return 0;var i=0,n=e.suspendedLanes,a=e.pingedLanes,s=268435455&r;if(0!==s){var o=s&~n;0!==o?i=ht(o):0!=(a&=s)&&(i=ht(a))}else 0!=(s=r&~n)?i=ht(s):0!==a&&(i=ht(a));if(0===i)return 0;if(0!==t&&t!==i&&0==(t&n)&&((n=i&-i)>=(a=t&-t)||16===n&&0!=(4194240&a)))return t;if(0!=(4&i)&&(i|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)n=1<<(r=31-st(t)),i|=e[r],t&=~n;return i}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0==(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function At(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=r}function bt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-st(r),n=1<<i;n&t|e[i]&t&&(e[i]|=t),r&=~n}}var vt=0;function yt(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var wt,Et,_t,Tt,St,xt=!1,kt=[],It=null,Ct=null,Pt=null,Mt=new Map,Rt=new Map,Bt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Mt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Nt(e,t,r,i,n,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:a,targetContainers:[n]},null!==t&&null!==(t=vn(t))&&Et(t),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n),e)}function Ft(e){var t=bn(e.target);if(null!==t){var r=Ve(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=Qe(r)))return e.blockedOn=t,void St(e.priority,(function(){_t(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ot(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=vn(r))&&Et(t),e.blockedOn=r,!1;var i=new(r=e.nativeEvent).constructor(r.type,r);ye=i,r.target.dispatchEvent(i),ye=null,t.shift()}return!0}function zt(e,t,r){Ot(e)&&r.delete(t)}function Ut(){xt=!1,null!==It&&Ot(It)&&(It=null),null!==Ct&&Ot(Ct)&&(Ct=null),null!==Pt&&Ot(Pt)&&(Pt=null),Mt.forEach(zt),Rt.forEach(zt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,xt||(xt=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Ut)))}function Vt(e){function t(t){return jt(t,e)}if(0<kt.length){jt(kt[0],e);for(var r=1;r<kt.length;r++){var i=kt[r];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==It&&jt(It,e),null!==Ct&&jt(Ct,e),null!==Pt&&jt(Pt,e),Mt.forEach(t),Rt.forEach(t),r=0;r<Bt.length;r++)(i=Bt[r]).blockedOn===e&&(i.blockedOn=null);for(;0<Bt.length&&null===(r=Bt[0]).blockedOn;)Ft(r),null===r.blockedOn&&Bt.shift()}var Qt=y.ReactCurrentBatchConfig,qt=!0;function Xt(e,t,r,i){var n=vt,a=Qt.transition;Qt.transition=null;try{vt=1,Ht(e,t,r,i)}finally{vt=n,Qt.transition=a}}function Wt(e,t,r,i){var n=vt,a=Qt.transition;Qt.transition=null;try{vt=4,Ht(e,t,r,i)}finally{vt=n,Qt.transition=a}}function Ht(e,t,r,i){if(qt){var n=$t(e,t,r,i);if(null===n)Qi(e,t,i,Gt,r),Dt(e,i);else if(function(e,t,r,i,n){switch(t){case"focusin":return It=Nt(It,e,t,r,i,n),!0;case"dragenter":return Ct=Nt(Ct,e,t,r,i,n),!0;case"mouseover":return Pt=Nt(Pt,e,t,r,i,n),!0;case"pointerover":var a=n.pointerId;return Mt.set(a,Nt(Mt.get(a)||null,e,t,r,i,n)),!0;case"gotpointercapture":return a=n.pointerId,Rt.set(a,Nt(Rt.get(a)||null,e,t,r,i,n)),!0}return!1}(n,e,t,r,i))i.stopPropagation();else if(Dt(e,i),4&t&&-1<Lt.indexOf(e)){for(;null!==n;){var a=vn(n);if(null!==a&&wt(a),null===(a=$t(e,t,r,i))&&Qi(e,t,i,Gt,r),a===n)break;n=a}null!==n&&i.stopPropagation()}else Qi(e,t,i,null,r)}}var Gt=null;function $t(e,t,r,i){if(Gt=null,null!==(e=bn(e=we(i))))if(null===(t=Ve(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=Qe(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Kt=null,Jt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Jt,i=r.length,n="value"in Kt?Kt.value:Kt.textContent,a=n.length;for(e=0;e<i&&r[e]===n[e];e++);var s=i-e;for(t=1;t<=s&&r[i-t]===n[a-t];t++);return Zt=n.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function ir(){return!1}function nr(e){function t(t,r,i,n,a){for(var s in this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=n,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(n):n[s]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?rr:ir,this.isPropagationStopped=ir,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ar,sr,or,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=nr(lr),ur=F({},lr,{view:0,detail:0}),hr=nr(ur),dr=F({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==or&&(or&&"mousemove"===e.type?(ar=e.screenX-or.screenX,sr=e.screenY-or.screenY):sr=ar=0,or=e),ar)},movementY:function(e){return"movementY"in e?e.movementY:sr}}),fr=nr(dr),mr=nr(F({},dr,{dataTransfer:0})),pr=nr(F({},ur,{relatedTarget:0})),gr=nr(F({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),Ar=F({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),br=nr(Ar),vr=nr(F({},lr,{data:0})),yr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Er={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _r(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Er[e])&&!!t[e]}function Tr(){return _r}var Sr=F({},ur,{key:function(e){if(e.key){var t=yr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),xr=nr(Sr),kr=nr(F({},dr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ir=nr(F({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tr})),Cr=nr(F({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pr=F({},dr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mr=nr(Pr),Rr=[9,13,27,32],Br=u&&"CompositionEvent"in window,Lr=null;u&&"documentMode"in document&&(Lr=document.documentMode);var Dr=u&&"TextEvent"in window&&!Lr,Nr=u&&(!Br||Lr&&8<Lr&&11>=Lr),Fr=String.fromCharCode(32),Or=!1;function zr(e,t){switch(e){case"keyup":return-1!==Rr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ur(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var jr=!1,Vr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vr[e.type]:"textarea"===t}function qr(e,t,r,i){xe(i),0<(t=Xi(t,"onChange")).length&&(r=new cr("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var Xr=null,Wr=null;function Hr(e){Fi(e,0)}function Gr(e){if(H(yn(e)))return e}function $r(e,t){if("change"===e)return t}var Yr=!1;if(u){var Kr;if(u){var Jr="oninput"in document;if(!Jr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Jr="function"==typeof Zr.oninput}Kr=Jr}else Kr=!1;Yr=Kr&&(!document.documentMode||9<document.documentMode)}function ei(){Xr&&(Xr.detachEvent("onpropertychange",ti),Wr=Xr=null)}function ti(e){if("value"===e.propertyName&&Gr(Wr)){var t=[];qr(t,Wr,e,we(e)),Me(Hr,t)}}function ri(e,t,r){"focusin"===e?(ei(),Wr=r,(Xr=t).attachEvent("onpropertychange",ti)):"focusout"===e&&ei()}function ii(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gr(Wr)}function ni(e,t){if("click"===e)return Gr(t)}function ai(e,t){if("input"===e||"change"===e)return Gr(t)}var si="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function oi(e,t){if(si(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var n=r[i];if(!h.call(t,n)||!si(e[n],t[n]))return!1}return!0}function li(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ci(e,t){var r,i=li(e);for(e=0;i;){if(3===i.nodeType){if(r=e+i.textContent.length,e<=t&&r>=t)return{node:i,offset:t-e};e=r}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=li(i)}}function ui(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ui(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hi(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var r="string"==typeof t.contentWindow.location.href}catch(e){r=!1}if(!r)break;t=G((e=t.contentWindow).document)}return t}function di(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fi(e){var t=hi(),r=e.focusedElem,i=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&ui(r.ownerDocument.documentElement,r)){if(null!==i&&di(r))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var n=r.textContent.length,a=Math.min(i.start,n);i=void 0===i.end?a:Math.min(i.end,n),!e.extend&&a>i&&(n=i,i=a,a=n),n=ci(r,a);var s=ci(r,i);n&&s&&(1!==e.rangeCount||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(n.node,n.offset),e.removeAllRanges(),a>i?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,pi=null,gi=null,Ai=null,bi=!1;function vi(e,t,r){var i=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;bi||null==pi||pi!==G(i)||(i="selectionStart"in(i=pi)&&di(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},Ai&&oi(Ai,i)||(Ai=i,0<(i=Xi(gi,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=pi)))}function yi(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var wi={animationend:yi("Animation","AnimationEnd"),animationiteration:yi("Animation","AnimationIteration"),animationstart:yi("Animation","AnimationStart"),transitionend:yi("Transition","TransitionEnd")},Ei={},_i={};function Ti(e){if(Ei[e])return Ei[e];if(!wi[e])return e;var t,r=wi[e];for(t in r)if(r.hasOwnProperty(t)&&t in _i)return Ei[e]=r[t];return e}u&&(_i=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);var Si=Ti("animationend"),xi=Ti("animationiteration"),ki=Ti("animationstart"),Ii=Ti("transitionend"),Ci=new Map,Pi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mi(e,t){Ci.set(e,t),l(t,[e])}for(var Ri=0;Ri<Pi.length;Ri++){var Bi=Pi[Ri];Mi(Bi.toLowerCase(),"on"+(Bi[0].toUpperCase()+Bi.slice(1)))}Mi(Si,"onAnimationEnd"),Mi(xi,"onAnimationIteration"),Mi(ki,"onAnimationStart"),Mi("dblclick","onDoubleClick"),Mi("focusin","onFocus"),Mi("focusout","onBlur"),Mi(Ii,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Li="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Di=new Set("cancel close invalid load scroll toggle".split(" ").concat(Li));function Ni(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,i,n,s,o,l,c){if(je.apply(this,arguments),Ne){if(!Ne)throw Error(a(198));var u=Fe;Ne=!1,Fe=null,Oe||(Oe=!0,ze=u)}}(i,t,void 0,e),e.currentTarget=null}function Fi(e,t){t=0!=(4&t);for(var r=0;r<e.length;r++){var i=e[r],n=i.event;i=i.listeners;e:{var a=void 0;if(t)for(var s=i.length-1;0<=s;s--){var o=i[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&n.isPropagationStopped())break e;Ni(n,o,c),a=l}else for(s=0;s<i.length;s++){if(l=(o=i[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&n.isPropagationStopped())break e;Ni(n,o,c),a=l}}}if(Oe)throw e=ze,Oe=!1,ze=null,e}function Oi(e,t){var r=t[pn];void 0===r&&(r=t[pn]=new Set);var i=e+"__bubble";r.has(i)||(Vi(t,e,2,!1),r.add(i))}function zi(e,t,r){var i=0;t&&(i|=4),Vi(r,e,i,t)}var Ui="_reactListening"+Math.random().toString(36).slice(2);function ji(e){if(!e[Ui]){e[Ui]=!0,s.forEach((function(t){"selectionchange"!==t&&(Di.has(t)||zi(t,!1,e),zi(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ui]||(t[Ui]=!0,zi("selectionchange",!1,t))}}function Vi(e,t,r,i){switch(Yt(t)){case 1:var n=Xt;break;case 4:n=Wt;break;default:n=Ht}r=n.bind(null,t,r,e),n=void 0,!Be||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(n=!0),i?void 0!==n?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):void 0!==n?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function Qi(e,t,r,i,n){var a=i;if(0==(1&t)&&0==(2&t)&&null!==i)e:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var o=i.stateNode.containerInfo;if(o===n||8===o.nodeType&&o.parentNode===n)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===n||8===l.nodeType&&l.parentNode===n))return;s=s.return}for(;null!==o;){if(null===(s=bn(o)))return;if(5===(l=s.tag)||6===l){i=a=s;continue e}o=o.parentNode}}i=i.return}Me((function(){var i=a,n=we(r),s=[];e:{var o=Ci.get(e);if(void 0!==o){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=xr;break;case"focusin":c="focus",l=pr;break;case"focusout":c="blur",l=pr;break;case"beforeblur":case"afterblur":l=pr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ir;break;case Si:case xi:case ki:l=gr;break;case Ii:l=Cr;break;case"scroll":l=hr;break;case"wheel":l=Mr;break;case"copy":case"cut":case"paste":l=br;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=kr}var u=0!=(4&t),h=!u&&"scroll"===e,d=u?null!==o?o+"Capture":null:o;u=[];for(var f,m=i;null!==m;){var p=(f=m).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==d&&null!=(p=Re(m,d))&&u.push(qi(m,p,f))),h)break;m=m.return}0<u.length&&(o=new l(o,c,null,r,n),s.push({event:o,listeners:u}))}}if(0==(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===ye||!(c=r.relatedTarget||r.fromElement)||!bn(c)&&!c[mn])&&(l||o)&&(o=n.window===n?n:(o=n.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(c=(c=r.relatedTarget||r.toElement)?bn(c):null)&&(c!==(h=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=fr,p="onMouseLeave",d="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=kr,p="onPointerLeave",d="onPointerEnter",m="pointer"),h=null==l?o:yn(l),f=null==c?o:yn(c),(o=new u(p,m+"leave",l,r,n)).target=h,o.relatedTarget=f,p=null,bn(n)===i&&((u=new u(d,m+"enter",c,r,n)).target=f,u.relatedTarget=h,p=u),h=p,l&&c)e:{for(d=c,m=0,f=u=l;f;f=Wi(f))m++;for(f=0,p=d;p;p=Wi(p))f++;for(;0<m-f;)u=Wi(u),m--;for(;0<f-m;)d=Wi(d),f--;for(;m--;){if(u===d||null!==d&&u===d.alternate)break e;u=Wi(u),d=Wi(d)}u=null}else u=null;null!==l&&Hi(s,o,l,u,!1),null!==c&&null!==h&&Hi(s,h,c,u,!0)}if("select"===(l=(o=i?yn(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=$r;else if(Qr(o))if(Yr)g=ai;else{g=ii;var A=ri}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ni);switch(g&&(g=g(e,i))?qr(s,g,r,n):(A&&A(e,o,i),"focusout"===e&&(A=o._wrapperState)&&A.controlled&&"number"===o.type&&ee(o,"number",o.value)),A=i?yn(i):window,e){case"focusin":(Qr(A)||"true"===A.contentEditable)&&(pi=A,gi=i,Ai=null);break;case"focusout":Ai=gi=pi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,vi(s,r,n);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":vi(s,r,n)}var b;if(Br)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else jr?zr(e,r)&&(v="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(v="onCompositionStart");v&&(Nr&&"ko"!==r.locale&&(jr||"onCompositionStart"!==v?"onCompositionEnd"===v&&jr&&(b=er()):(Jt="value"in(Kt=n)?Kt.value:Kt.textContent,jr=!0)),0<(A=Xi(i,v)).length&&(v=new vr(v,e,null,r,n),s.push({event:v,listeners:A}),(b||null!==(b=Ur(r)))&&(v.data=b))),(b=Dr?function(e,t){switch(e){case"compositionend":return Ur(t);case"keypress":return 32!==t.which?null:(Or=!0,Fr);case"textInput":return(e=t.data)===Fr&&Or?null:e;default:return null}}(e,r):function(e,t){if(jr)return"compositionend"===e||!Br&&zr(e,t)?(e=er(),Zt=Jt=Kt=null,jr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nr&&"ko"!==t.locale?null:t.data}}(e,r))&&0<(i=Xi(i,"onBeforeInput")).length&&(n=new vr("onBeforeInput","beforeinput",null,r,n),s.push({event:n,listeners:i}),n.data=b)}Fi(s,t)}))}function qi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Xi(e,t){for(var r=t+"Capture",i=[];null!==e;){var n=e,a=n.stateNode;5===n.tag&&null!==a&&(n=a,null!=(a=Re(e,r))&&i.unshift(qi(e,a,n)),null!=(a=Re(e,t))&&i.push(qi(e,a,n))),e=e.return}return i}function Wi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Hi(e,t,r,i,n){for(var a=t._reactName,s=[];null!==r&&r!==i;){var o=r,l=o.alternate,c=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==c&&(o=c,n?null!=(l=Re(r,a))&&s.unshift(qi(r,l,o)):n||null!=(l=Re(r,a))&&s.push(qi(r,l,o))),r=r.return}0!==s.length&&e.push({event:t,listeners:s})}var Gi=/\r\n?/g,$i=/\u0000|\uFFFD/g;function Yi(e){return("string"==typeof e?e:""+e).replace(Gi,"\n").replace($i,"")}function Ki(e,t,r){if(t=Yi(t),Yi(e)!==t&&r)throw Error(a(425))}function Ji(){}var Zi=null,en=null;function tn(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rn="function"==typeof setTimeout?setTimeout:void 0,nn="function"==typeof clearTimeout?clearTimeout:void 0,an="function"==typeof Promise?Promise:void 0,sn="function"==typeof queueMicrotask?queueMicrotask:void 0!==an?function(e){return an.resolve(null).then(e).catch(on)}:rn;function on(e){setTimeout((function(){throw e}))}function ln(e,t){var r=t,i=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&8===n.nodeType)if("/$"===(r=n.data)){if(0===i)return e.removeChild(n),void Vt(t);i--}else"$"!==r&&"$?"!==r&&"$!"!==r||i++;r=n}while(r);Vt(t)}function cn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function un(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var hn=Math.random().toString(36).slice(2),dn="__reactFiber$"+hn,fn="__reactProps$"+hn,mn="__reactContainer$"+hn,pn="__reactEvents$"+hn,gn="__reactListeners$"+hn,An="__reactHandles$"+hn;function bn(e){var t=e[dn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[mn]||r[dn]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=un(e);null!==e;){if(r=e[dn])return r;e=un(e)}return t}r=(e=r).parentNode}return null}function vn(e){return!(e=e[dn]||e[mn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function yn(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function wn(e){return e[fn]||null}var En=[],_n=-1;function Tn(e){return{current:e}}function Sn(e){0>_n||(e.current=En[_n],En[_n]=null,_n--)}function xn(e,t){_n++,En[_n]=e.current,e.current=t}var kn={},In=Tn(kn),Cn=Tn(!1),Pn=kn;function Mn(e,t){var r=e.type.contextTypes;if(!r)return kn;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var n,a={};for(n in r)a[n]=t[n];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Rn(e){return null!=e.childContextTypes}function Bn(){Sn(Cn),Sn(In)}function Ln(e,t,r){if(In.current!==kn)throw Error(a(168));xn(In,t),xn(Cn,r)}function Dn(e,t,r){var i=e.stateNode;if(t=t.childContextTypes,"function"!=typeof i.getChildContext)return r;for(var n in i=i.getChildContext())if(!(n in t))throw Error(a(108,Q(e)||"Unknown",n));return F({},r,i)}function Nn(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||kn,Pn=In.current,xn(In,e),xn(Cn,Cn.current),!0}function Fn(e,t,r){var i=e.stateNode;if(!i)throw Error(a(169));r?(e=Dn(e,t,Pn),i.__reactInternalMemoizedMergedChildContext=e,Sn(Cn),Sn(In),xn(In,e)):Sn(Cn),xn(Cn,r)}var On=null,zn=!1,Un=!1;function jn(e){null===On?On=[e]:On.push(e)}function Vn(){if(!Un&&null!==On){Un=!0;var e=0,t=vt;try{var r=On;for(vt=1;e<r.length;e++){var i=r[e];do{i=i(!0)}while(null!==i)}On=null,zn=!1}catch(t){throw null!==On&&(On=On.slice(e+1)),He(Ze,Vn),t}finally{vt=t,Un=!1}}return null}var Qn=[],qn=0,Xn=null,Wn=0,Hn=[],Gn=0,$n=null,Yn=1,Kn="";function Jn(e,t){Qn[qn++]=Wn,Qn[qn++]=Xn,Xn=e,Wn=t}function Zn(e,t,r){Hn[Gn++]=Yn,Hn[Gn++]=Kn,Hn[Gn++]=$n,$n=e;var i=Yn;e=Kn;var n=32-st(i)-1;i&=~(1<<n),r+=1;var a=32-st(t)+n;if(30<a){var s=n-n%5;a=(i&(1<<s)-1).toString(32),i>>=s,n-=s,Yn=1<<32-st(t)+n|r<<n|i,Kn=a+e}else Yn=1<<a|r<<n|i,Kn=e}function ea(e){null!==e.return&&(Jn(e,1),Zn(e,1,0))}function ta(e){for(;e===Xn;)Xn=Qn[--qn],Qn[qn]=null,Wn=Qn[--qn],Qn[qn]=null;for(;e===$n;)$n=Hn[--Gn],Hn[Gn]=null,Kn=Hn[--Gn],Hn[Gn]=null,Yn=Hn[--Gn],Hn[Gn]=null}var ra=null,ia=null,na=!1,aa=null;function sa(e,t){var r=Mc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function oa(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ra=e,ia=cn(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ra=e,ia=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==$n?{id:Yn,overflow:Kn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Mc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ra=e,ia=null,!0);default:return!1}}function la(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function ca(e){if(na){var t=ia;if(t){var r=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=cn(r.nextSibling);var i=ra;t&&oa(e,t)?sa(i,r):(e.flags=-4097&e.flags|2,na=!1,ra=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,na=!1,ra=e}}}function ua(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ra=e}function ha(e){if(e!==ra)return!1;if(!na)return ua(e),na=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!tn(e.type,e.memoizedProps)),t&&(t=ia)){if(la(e))throw da(),Error(a(418));for(;t;)sa(e,t),t=cn(t.nextSibling)}if(ua(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){ia=cn(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}ia=null}}else ia=ra?cn(e.stateNode.nextSibling):null;return!0}function da(){for(var e=ia;e;)e=cn(e.nextSibling)}function fa(){ia=ra=null,na=!1}function ma(e){null===aa?aa=[e]:aa.push(e)}var pa=y.ReactCurrentBatchConfig;function ga(e,t){if(e&&e.defaultProps){for(var r in t=F({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var Aa=Tn(null),ba=null,va=null,ya=null;function wa(){ya=va=ba=null}function Ea(e){var t=Aa.current;Sn(Aa),e._currentValue=t}function _a(e,t,r){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function Ta(e,t){ba=e,ya=va=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(yo=!0),e.firstContext=null)}function Sa(e){var t=e._currentValue;if(ya!==e)if(e={context:e,memoizedValue:t,next:null},null===va){if(null===ba)throw Error(a(308));va=e,ba.dependencies={lanes:0,firstContext:e}}else va=va.next=e;return t}var xa=null;function ka(e){null===xa?xa=[e]:xa.push(e)}function Ia(e,t,r,i){var n=t.interleaved;return null===n?(r.next=r,ka(t)):(r.next=n.next,n.next=r),t.interleaved=r,Ca(e,i)}function Ca(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Pa=!1;function Ma(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ra(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ba(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function La(e,t,r){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!=(2&Il)){var n=i.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),i.pending=t,Ca(e,r)}return null===(n=i.interleaved)?(t.next=t,ka(i)):(t.next=n.next,n.next=t),i.interleaved=t,Ca(e,r)}function Da(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&r))){var i=t.lanes;r|=i&=e.pendingLanes,t.lanes=r,bt(e,r)}}function Na(e,t){var r=e.updateQueue,i=e.alternate;if(null!==i&&r===(i=i.updateQueue)){var n=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===a?n=a=s:a=a.next=s,r=r.next}while(null!==r);null===a?n=a=t:a=a.next=t}else n=a=t;return r={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:a,shared:i.shared,effects:i.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Fa(e,t,r,i){var n=e.updateQueue;Pa=!1;var a=n.firstBaseUpdate,s=n.lastBaseUpdate,o=n.shared.pending;if(null!==o){n.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var u=e.alternate;null!==u&&(o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l)}if(null!==a){var h=n.baseState;for(s=0,u=c=l=null,o=a;;){var d=o.lane,f=o.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(d=t,f=r,p.tag){case 1:if("function"==typeof(m=p.payload)){h=m.call(f,h,d);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(d="function"==typeof(m=p.payload)?m.call(f,h,d):m))break e;h=F({},h,d);break e;case 2:Pa=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(d=n.effects)?n.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,s|=d;if(null===(o=o.next)){if(null===(o=n.shared.pending))break;o=(d=o).next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}if(null===u&&(l=h),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=u,null!==(t=n.shared.interleaved)){n=t;do{s|=n.lane,n=n.next}while(n!==t)}else null===a&&(n.shared.lanes=0);Nl|=s,e.lanes=s,e.memoizedState=h}}function Oa(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],n=i.callback;if(null!==n){if(i.callback=null,i=r,"function"!=typeof n)throw Error(a(191,n));n.call(i)}}}var za=(new i.Component).refs;function Ua(e,t,r,i){r=null==(r=r(i,t=e.memoizedState))?t:F({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var ja={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=ec(),n=tc(e),a=Ba(i,n);a.payload=t,null!=r&&(a.callback=r),null!==(t=La(e,a,n))&&(rc(t,e,n,i),Da(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=ec(),n=tc(e),a=Ba(i,n);a.tag=1,a.payload=t,null!=r&&(a.callback=r),null!==(t=La(e,a,n))&&(rc(t,e,n,i),Da(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ec(),i=tc(e),n=Ba(r,i);n.tag=2,null!=t&&(n.callback=t),null!==(t=La(e,n,i))&&(rc(t,e,i,r),Da(t,e,i))}};function Va(e,t,r,i,n,a,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,a,s):!(t.prototype&&t.prototype.isPureReactComponent&&oi(r,i)&&oi(n,a))}function Qa(e,t,r){var i=!1,n=kn,a=t.contextType;return"object"==typeof a&&null!==a?a=Sa(a):(n=Rn(t)?Pn:In.current,a=(i=null!=(i=t.contextTypes))?Mn(e,n):kn),t=new t(r,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ja,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=a),t}function qa(e,t,r,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&ja.enqueueReplaceState(t,t.state,null)}function Xa(e,t,r,i){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs=za,Ma(e);var a=t.contextType;"object"==typeof a&&null!==a?n.context=Sa(a):(a=Rn(t)?Pn:In.current,n.context=Mn(e,a)),n.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(Ua(e,t,a,r),n.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof n.getSnapshotBeforeUpdate||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||(t=n.state,"function"==typeof n.componentWillMount&&n.componentWillMount(),"function"==typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),t!==n.state&&ja.enqueueReplaceState(n,n.state,null),Fa(e,r,n,i),n.state=e.memoizedState),"function"==typeof n.componentDidMount&&(e.flags|=4194308)}function Wa(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(a(309));var i=r.stateNode}if(!i)throw Error(a(147,e));var n=i,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=n.refs;t===za&&(t=n.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!=typeof e)throw Error(a(284));if(!r._owner)throw Error(a(290,e))}return e}function Ha(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ga(e){return(0,e._init)(e._payload)}function $a(e){function t(t,r){if(e){var i=t.deletions;null===i?(t.deletions=[r],t.flags|=16):i.push(r)}}function r(r,i){if(!e)return null;for(;null!==i;)t(r,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function n(e,t){return(e=Bc(e,t)).index=0,e.sibling=null,e}function s(t,r,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<r?(t.flags|=2,r):i:(t.flags|=2,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,i){return null===t||6!==t.tag?((t=Fc(r,e.mode,i)).return=e,t):((t=n(t,r)).return=e,t)}function c(e,t,r,i){var a=r.type;return a===_?h(e,t,r.props.children,i,r.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===R&&Ga(a)===t.type)?((i=n(t,r.props)).ref=Wa(e,t,r),i.return=e,i):((i=Lc(r.type,r.key,r.props,null,e.mode,i)).ref=Wa(e,t,r),i.return=e,i)}function u(e,t,r,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Oc(r,e.mode,i)).return=e,t):((t=n(t,r.children||[])).return=e,t)}function h(e,t,r,i,a){return null===t||7!==t.tag?((t=Dc(r,e.mode,i,a)).return=e,t):((t=n(t,r)).return=e,t)}function d(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Fc(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case w:return(r=Lc(t.type,t.key,t.props,null,e.mode,r)).ref=Wa(e,null,t),r.return=e,r;case E:return(t=Oc(t,e.mode,r)).return=e,t;case R:return d(e,(0,t._init)(t._payload),r)}if(te(t)||D(t))return(t=Dc(t,e.mode,r,null)).return=e,t;Ha(e,t)}return null}function f(e,t,r,i){var n=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r)return null!==n?null:l(e,t,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===n?c(e,t,r,i):null;case E:return r.key===n?u(e,t,r,i):null;case R:return f(e,t,(n=r._init)(r._payload),i)}if(te(r)||D(r))return null!==n?null:h(e,t,r,i,null);Ha(e,r)}return null}function m(e,t,r,i,n){if("string"==typeof i&&""!==i||"number"==typeof i)return l(t,e=e.get(r)||null,""+i,n);if("object"==typeof i&&null!==i){switch(i.$$typeof){case w:return c(t,e=e.get(null===i.key?r:i.key)||null,i,n);case E:return u(t,e=e.get(null===i.key?r:i.key)||null,i,n);case R:return m(e,t,r,(0,i._init)(i._payload),n)}if(te(i)||D(i))return h(t,e=e.get(r)||null,i,n,null);Ha(t,i)}return null}function p(n,a,o,l){for(var c=null,u=null,h=a,p=a=0,g=null;null!==h&&p<o.length;p++){h.index>p?(g=h,h=null):g=h.sibling;var A=f(n,h,o[p],l);if(null===A){null===h&&(h=g);break}e&&h&&null===A.alternate&&t(n,h),a=s(A,a,p),null===u?c=A:u.sibling=A,u=A,h=g}if(p===o.length)return r(n,h),na&&Jn(n,p),c;if(null===h){for(;p<o.length;p++)null!==(h=d(n,o[p],l))&&(a=s(h,a,p),null===u?c=h:u.sibling=h,u=h);return na&&Jn(n,p),c}for(h=i(n,h);p<o.length;p++)null!==(g=m(h,n,p,o[p],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?p:g.key),a=s(g,a,p),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(n,e)})),na&&Jn(n,p),c}function g(n,o,l,c){var u=D(l);if("function"!=typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var h=u=null,p=o,g=o=0,A=null,b=l.next();null!==p&&!b.done;g++,b=l.next()){p.index>g?(A=p,p=null):A=p.sibling;var v=f(n,p,b.value,c);if(null===v){null===p&&(p=A);break}e&&p&&null===v.alternate&&t(n,p),o=s(v,o,g),null===h?u=v:h.sibling=v,h=v,p=A}if(b.done)return r(n,p),na&&Jn(n,g),u;if(null===p){for(;!b.done;g++,b=l.next())null!==(b=d(n,b.value,c))&&(o=s(b,o,g),null===h?u=b:h.sibling=b,h=b);return na&&Jn(n,g),u}for(p=i(n,p);!b.done;g++,b=l.next())null!==(b=m(p,n,g,b.value,c))&&(e&&null!==b.alternate&&p.delete(null===b.key?g:b.key),o=s(b,o,g),null===h?u=b:h.sibling=b,h=b);return e&&p.forEach((function(e){return t(n,e)})),na&&Jn(n,g),u}return function e(i,a,s,l){if("object"==typeof s&&null!==s&&s.type===_&&null===s.key&&(s=s.props.children),"object"==typeof s&&null!==s){switch(s.$$typeof){case w:e:{for(var c=s.key,u=a;null!==u;){if(u.key===c){if((c=s.type)===_){if(7===u.tag){r(i,u.sibling),(a=n(u,s.props.children)).return=i,i=a;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===R&&Ga(c)===u.type){r(i,u.sibling),(a=n(u,s.props)).ref=Wa(i,u,s),a.return=i,i=a;break e}r(i,u);break}t(i,u),u=u.sibling}s.type===_?((a=Dc(s.props.children,i.mode,l,s.key)).return=i,i=a):((l=Lc(s.type,s.key,s.props,null,i.mode,l)).ref=Wa(i,a,s),l.return=i,i=l)}return o(i);case E:e:{for(u=s.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){r(i,a.sibling),(a=n(a,s.children||[])).return=i,i=a;break e}r(i,a);break}t(i,a),a=a.sibling}(a=Oc(s,i.mode,l)).return=i,i=a}return o(i);case R:return e(i,a,(u=s._init)(s._payload),l)}if(te(s))return p(i,a,s,l);if(D(s))return g(i,a,s,l);Ha(i,s)}return"string"==typeof s&&""!==s||"number"==typeof s?(s=""+s,null!==a&&6===a.tag?(r(i,a.sibling),(a=n(a,s)).return=i,i=a):(r(i,a),(a=Fc(s,i.mode,l)).return=i,i=a),o(i)):r(i,a)}}var Ya=$a(!0),Ka=$a(!1),Ja={},Za=Tn(Ja),es=Tn(Ja),ts=Tn(Ja);function rs(e){if(e===Ja)throw Error(a(174));return e}function is(e,t){switch(xn(ts,t),xn(es,e),xn(Za,Ja),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sn(Za),xn(Za,t)}function ns(){Sn(Za),Sn(es),Sn(ts)}function as(e){rs(ts.current);var t=rs(Za.current),r=le(t,e.type);t!==r&&(xn(es,e),xn(Za,r))}function ss(e){es.current===e&&(Sn(Za),Sn(es))}var os=Tn(0);function ls(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var cs=[];function us(){for(var e=0;e<cs.length;e++)cs[e]._workInProgressVersionPrimary=null;cs.length=0}var hs=y.ReactCurrentDispatcher,ds=y.ReactCurrentBatchConfig,fs=0,ms=null,ps=null,gs=null,As=!1,bs=!1,vs=0,ys=0;function ws(){throw Error(a(321))}function Es(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!si(e[r],t[r]))return!1;return!0}function _s(e,t,r,i,n,s){if(fs=s,ms=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hs.current=null===e||null===e.memoizedState?so:oo,e=r(i,n),bs){s=0;do{if(bs=!1,vs=0,25<=s)throw Error(a(301));s+=1,gs=ps=null,t.updateQueue=null,hs.current=lo,e=r(i,n)}while(bs)}if(hs.current=ao,t=null!==ps&&null!==ps.next,fs=0,gs=ps=ms=null,As=!1,t)throw Error(a(300));return e}function Ts(){var e=0!==vs;return vs=0,e}function Ss(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===gs?ms.memoizedState=gs=e:gs=gs.next=e,gs}function xs(){if(null===ps){var e=ms.alternate;e=null!==e?e.memoizedState:null}else e=ps.next;var t=null===gs?ms.memoizedState:gs.next;if(null!==t)gs=t,ps=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ps=e).memoizedState,baseState:ps.baseState,baseQueue:ps.baseQueue,queue:ps.queue,next:null},null===gs?ms.memoizedState=gs=e:gs=gs.next=e}return gs}function ks(e,t){return"function"==typeof t?t(e):t}function Is(e){var t=xs(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var i=ps,n=i.baseQueue,s=r.pending;if(null!==s){if(null!==n){var o=n.next;n.next=s.next,s.next=o}i.baseQueue=n=s,r.pending=null}if(null!==n){s=n.next,i=i.baseState;var l=o=null,c=null,u=s;do{var h=u.lane;if((fs&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,o=i):c=c.next=d,ms.lanes|=h,Nl|=h}u=u.next}while(null!==u&&u!==s);null===c?o=i:c.next=l,si(i,t.memoizedState)||(yo=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=c,r.lastRenderedState=i}if(null!==(e=r.interleaved)){n=e;do{s=n.lane,ms.lanes|=s,Nl|=s,n=n.next}while(n!==e)}else null===n&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Cs(e){var t=xs(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var i=r.dispatch,n=r.pending,s=t.memoizedState;if(null!==n){r.pending=null;var o=n=n.next;do{s=e(s,o.action),o=o.next}while(o!==n);si(s,t.memoizedState)||(yo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,i]}function Ps(){}function Ms(e,t){var r=ms,i=xs(),n=t(),s=!si(i.memoizedState,n);if(s&&(i.memoizedState=n,yo=!0),i=i.queue,Qs(Ls.bind(null,r,i,e),[e]),i.getSnapshot!==t||s||null!==gs&&1&gs.memoizedState.tag){if(r.flags|=2048,Os(9,Bs.bind(null,r,i,n,t),void 0,null),null===Cl)throw Error(a(349));0!=(30&fs)||Rs(r,t,n)}return n}function Rs(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Bs(e,t,r,i){t.value=r,t.getSnapshot=i,Ds(t)&&Ns(e)}function Ls(e,t,r){return r((function(){Ds(t)&&Ns(e)}))}function Ds(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!si(e,r)}catch(e){return!0}}function Ns(e){var t=Ca(e,1);null!==t&&rc(t,e,1,-1)}function Fs(e){var t=Ss();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ks,lastRenderedState:e},t.queue=e,e=e.dispatch=to.bind(null,ms,e),[t.memoizedState,e]}function Os(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e),e}function zs(){return xs().memoizedState}function Us(e,t,r,i){var n=Ss();ms.flags|=e,n.memoizedState=Os(1|t,r,void 0,void 0===i?null:i)}function js(e,t,r,i){var n=xs();i=void 0===i?null:i;var a=void 0;if(null!==ps){var s=ps.memoizedState;if(a=s.destroy,null!==i&&Es(i,s.deps))return void(n.memoizedState=Os(t,r,a,i))}ms.flags|=e,n.memoizedState=Os(1|t,r,a,i)}function Vs(e,t){return Us(8390656,8,e,t)}function Qs(e,t){return js(2048,8,e,t)}function qs(e,t){return js(4,2,e,t)}function Xs(e,t){return js(4,4,e,t)}function Ws(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Hs(e,t,r){return r=null!=r?r.concat([e]):null,js(4,4,Ws.bind(null,t,e),r)}function Gs(){}function $s(e,t){var r=xs();t=void 0===t?null:t;var i=r.memoizedState;return null!==i&&null!==t&&Es(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function Ys(e,t){var r=xs();t=void 0===t?null:t;var i=r.memoizedState;return null!==i&&null!==t&&Es(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function Ks(e,t,r){return 0==(21&fs)?(e.baseState&&(e.baseState=!1,yo=!0),e.memoizedState=r):(si(r,t)||(r=pt(),ms.lanes|=r,Nl|=r,e.baseState=!0),t)}function Js(e,t){var r=vt;vt=0!==r&&4>r?r:4,e(!0);var i=ds.transition;ds.transition={};try{e(!1),t()}finally{vt=r,ds.transition=i}}function Zs(){return xs().memoizedState}function eo(e,t,r){var i=tc(e);r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},ro(e)?io(t,r):null!==(r=Ia(e,t,r,i))&&(rc(r,e,i,ec()),no(r,t,i))}function to(e,t,r){var i=tc(e),n={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(ro(e))io(t,n);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,r);if(n.hasEagerState=!0,n.eagerState=o,si(o,s)){var l=t.interleaved;return null===l?(n.next=n,ka(t)):(n.next=l.next,l.next=n),void(t.interleaved=n)}}catch(e){}null!==(r=Ia(e,t,n,i))&&(rc(r,e,i,n=ec()),no(r,t,i))}}function ro(e){var t=e.alternate;return e===ms||null!==t&&t===ms}function io(e,t){bs=As=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function no(e,t,r){if(0!=(4194240&r)){var i=t.lanes;r|=i&=e.pendingLanes,t.lanes=r,bt(e,r)}}var ao={readContext:Sa,useCallback:ws,useContext:ws,useEffect:ws,useImperativeHandle:ws,useInsertionEffect:ws,useLayoutEffect:ws,useMemo:ws,useReducer:ws,useRef:ws,useState:ws,useDebugValue:ws,useDeferredValue:ws,useTransition:ws,useMutableSource:ws,useSyncExternalStore:ws,useId:ws,unstable_isNewReconciler:!1},so={readContext:Sa,useCallback:function(e,t){return Ss().memoizedState=[e,void 0===t?null:t],e},useContext:Sa,useEffect:Vs,useImperativeHandle:function(e,t,r){return r=null!=r?r.concat([e]):null,Us(4194308,4,Ws.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Us(4194308,4,e,t)},useInsertionEffect:function(e,t){return Us(4,2,e,t)},useMemo:function(e,t){var r=Ss();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=Ss();return t=void 0!==r?r(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=eo.bind(null,ms,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Ss().memoizedState=e},useState:Fs,useDebugValue:Gs,useDeferredValue:function(e){return Ss().memoizedState=e},useTransition:function(){var e=Fs(!1),t=e[0];return e=Js.bind(null,e[1]),Ss().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=ms,n=Ss();if(na){if(void 0===r)throw Error(a(407));r=r()}else{if(r=t(),null===Cl)throw Error(a(349));0!=(30&fs)||Rs(i,t,r)}n.memoizedState=r;var s={value:r,getSnapshot:t};return n.queue=s,Vs(Ls.bind(null,i,s,e),[e]),i.flags|=2048,Os(9,Bs.bind(null,i,s,r,t),void 0,null),r},useId:function(){var e=Ss(),t=Cl.identifierPrefix;if(na){var r=Kn;t=":"+t+"R"+(r=(Yn&~(1<<32-st(Yn)-1)).toString(32)+r),0<(r=vs++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=ys++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oo={readContext:Sa,useCallback:$s,useContext:Sa,useEffect:Qs,useImperativeHandle:Hs,useInsertionEffect:qs,useLayoutEffect:Xs,useMemo:Ys,useReducer:Is,useRef:zs,useState:function(){return Is(ks)},useDebugValue:Gs,useDeferredValue:function(e){return Ks(xs(),ps.memoizedState,e)},useTransition:function(){return[Is(ks)[0],xs().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Ms,useId:Zs,unstable_isNewReconciler:!1},lo={readContext:Sa,useCallback:$s,useContext:Sa,useEffect:Qs,useImperativeHandle:Hs,useInsertionEffect:qs,useLayoutEffect:Xs,useMemo:Ys,useReducer:Cs,useRef:zs,useState:function(){return Cs(ks)},useDebugValue:Gs,useDeferredValue:function(e){var t=xs();return null===ps?t.memoizedState=e:Ks(t,ps.memoizedState,e)},useTransition:function(){return[Cs(ks)[0],xs().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Ms,useId:Zs,unstable_isNewReconciler:!1};function co(e,t){try{var r="",i=t;do{r+=j(i),i=i.return}while(i);var n=r}catch(e){n="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:n,digest:null}}function uo(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var fo="function"==typeof WeakMap?WeakMap:Map;function mo(e,t,r){(r=Ba(-1,r)).tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){ql||(ql=!0,Xl=i),ho(0,t)},r}function po(e,t,r){(r=Ba(-1,r)).tag=3;var i=e.type.getDerivedStateFromError;if("function"==typeof i){var n=t.value;r.payload=function(){return i(n)},r.callback=function(){ho(0,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(r.callback=function(){ho(0,t),"function"!=typeof i&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function go(e,t,r){var i=e.pingCache;if(null===i){i=e.pingCache=new fo;var n=new Set;i.set(t,n)}else void 0===(n=i.get(t))&&(n=new Set,i.set(t,n));n.has(r)||(n.add(r),e=Sc.bind(null,e,t,r),t.then(e,e))}function Ao(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bo(e,t,r,i,n){return 0==(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Ba(-1,1)).tag=2,La(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=n,e)}var vo=y.ReactCurrentOwner,yo=!1;function wo(e,t,r,i){t.child=null===e?Ka(t,null,r,i):Ya(t,e.child,r,i)}function Eo(e,t,r,i,n){r=r.render;var a=t.ref;return Ta(t,n),i=_s(e,t,r,i,a,n),r=Ts(),null===e||yo?(na&&r&&ea(t),t.flags|=1,wo(e,t,i,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,qo(e,t,n))}function _o(e,t,r,i,n){if(null===e){var a=r.type;return"function"!=typeof a||Rc(a)||void 0!==a.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Lc(r.type,null,i,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,To(e,t,a,i,n))}if(a=e.child,0==(e.lanes&n)){var s=a.memoizedProps;if((r=null!==(r=r.compare)?r:oi)(s,i)&&e.ref===t.ref)return qo(e,t,n)}return t.flags|=1,(e=Bc(a,i)).ref=t.ref,e.return=t,t.child=e}function To(e,t,r,i,n){if(null!==e){var a=e.memoizedProps;if(oi(a,i)&&e.ref===t.ref){if(yo=!1,t.pendingProps=i=a,0==(e.lanes&n))return t.lanes=e.lanes,qo(e,t,n);0!=(131072&e.flags)&&(yo=!0)}}return ko(e,t,r,i,n)}function So(e,t,r){var i=t.pendingProps,n=i.children,a=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},xn(Bl,Rl),Rl|=r;else{if(0==(1073741824&r))return e=null!==a?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,xn(Bl,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==a?a.baseLanes:r,xn(Bl,Rl),Rl|=i}else null!==a?(i=a.baseLanes|r,t.memoizedState=null):i=r,xn(Bl,Rl),Rl|=i;return wo(e,t,n,r),t.child}function xo(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ko(e,t,r,i,n){var a=Rn(r)?Pn:In.current;return a=Mn(t,a),Ta(t,n),r=_s(e,t,r,i,a,n),i=Ts(),null===e||yo?(na&&i&&ea(t),t.flags|=1,wo(e,t,r,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,qo(e,t,n))}function Io(e,t,r,i,n){if(Rn(r)){var a=!0;Nn(t)}else a=!1;if(Ta(t,n),null===t.stateNode)Qo(e,t),Qa(t,r,i),Xa(t,r,i,n),i=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=r.contextType;c="object"==typeof c&&null!==c?Sa(c):Mn(t,c=Rn(r)?Pn:In.current);var u=r.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;h||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==i||l!==c)&&qa(t,s,i,c),Pa=!1;var d=t.memoizedState;s.state=d,Fa(t,i,s,n),l=t.memoizedState,o!==i||d!==l||Cn.current||Pa?("function"==typeof u&&(Ua(t,r,u,i),l=t.memoizedState),(o=Pa||Va(t,r,o,i,d,l,c))?(h||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),s.props=i,s.state=l,s.context=c,i=o):("function"==typeof s.componentDidMount&&(t.flags|=4194308),i=!1)}else{s=t.stateNode,Ra(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ga(t.type,o),s.props=c,h=t.pendingProps,d=s.context,l="object"==typeof(l=r.contextType)&&null!==l?Sa(l):Mn(t,l=Rn(r)?Pn:In.current);var f=r.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==h||d!==l)&&qa(t,s,i,l),Pa=!1,d=t.memoizedState,s.state=d,Fa(t,i,s,n);var m=t.memoizedState;o!==h||d!==m||Cn.current||Pa?("function"==typeof f&&(Ua(t,r,f,i),m=t.memoizedState),(c=Pa||Va(t,r,c,i,d,m,l)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(i,m,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,m,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=m),s.props=i,s.state=m,s.context=l,i=c):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return Co(e,t,r,i,a,n)}function Co(e,t,r,i,n,a){xo(e,t);var s=0!=(128&t.flags);if(!i&&!s)return n&&Fn(t,r,!1),qo(e,t,a);i=t.stateNode,vo.current=t;var o=s&&"function"!=typeof r.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&s?(t.child=Ya(t,e.child,null,a),t.child=Ya(t,null,o,a)):wo(e,t,o,a),t.memoizedState=i.state,n&&Fn(t,r,!0),t.child}function Po(e){var t=e.stateNode;t.pendingContext?Ln(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ln(0,t.context,!1),is(e,t.containerInfo)}function Mo(e,t,r,i,n){return fa(),ma(n),t.flags|=256,wo(e,t,r,i),t.child}var Ro,Bo,Lo,Do={dehydrated:null,treeContext:null,retryLane:0};function No(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,r){var i,n=t.pendingProps,s=os.current,o=!1,l=0!=(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!=(2&s)),i?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),xn(os,1&s),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=n.children,e=n.fallback,o?(n=t.mode,o=t.child,l={mode:"hidden",children:l},0==(1&n)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Nc(l,n,0,null),e=Dc(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=No(r),t.memoizedState=Do,e):Oo(t,l));if(null!==(s=e.memoizedState)&&null!==(i=s.dehydrated))return function(e,t,r,i,n,s,o){if(r)return 256&t.flags?(t.flags&=-257,zo(e,t,o,i=uo(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=i.fallback,n=t.mode,i=Nc({mode:"visible",children:i.children},n,0,null),(s=Dc(s,n,o,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,0!=(1&t.mode)&&Ya(t,e.child,null,o),t.child.memoizedState=No(o),t.memoizedState=Do,s);if(0==(1&t.mode))return zo(e,t,o,null);if("$!"===n.data){if(i=n.nextSibling&&n.nextSibling.dataset)var l=i.dgst;return i=l,zo(e,t,o,i=uo(s=Error(a(419)),i,void 0))}if(l=0!=(o&e.childLanes),yo||l){if(null!==(i=Cl)){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}0!==(n=0!=(n&(i.suspendedLanes|o))?0:n)&&n!==s.retryLane&&(s.retryLane=n,Ca(e,n),rc(i,e,n,-1))}return pc(),zo(e,t,o,i=uo(Error(a(421))))}return"$?"===n.data?(t.flags|=128,t.child=e.child,t=kc.bind(null,e),n._reactRetry=t,null):(e=s.treeContext,ia=cn(n.nextSibling),ra=t,na=!0,aa=null,null!==e&&(Hn[Gn++]=Yn,Hn[Gn++]=Kn,Hn[Gn++]=$n,Yn=e.id,Kn=e.overflow,$n=t),(t=Oo(t,i.children)).flags|=4096,t)}(e,t,l,n,i,s,r);if(o){o=n.fallback,l=t.mode,i=(s=e.child).sibling;var c={mode:"hidden",children:n.children};return 0==(1&l)&&t.child!==s?((n=t.child).childLanes=0,n.pendingProps=c,t.deletions=null):(n=Bc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==i?o=Bc(i,o):(o=Dc(o,l,r,null)).flags|=2,o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,l=null===(l=e.child.memoizedState)?No(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~r,t.memoizedState=Do,n}return e=(o=e.child).sibling,n=Bc(o,{mode:"visible",children:n.children}),0==(1&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Oo(e,t){return(t=Nc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zo(e,t,r,i){return null!==i&&ma(i),Ya(t,e.child,null,r),(e=Oo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Uo(e,t,r){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),_a(e.return,t,r)}function jo(e,t,r,i,n){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:n}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=r,a.tailMode=n)}function Vo(e,t,r){var i=t.pendingProps,n=i.revealOrder,a=i.tail;if(wo(e,t,i.children,r),0!=(2&(i=os.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Uo(e,r,t);else if(19===e.tag)Uo(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(xn(os,i),0==(1&t.mode))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;null!==r;)null!==(e=r.alternate)&&null===ls(e)&&(n=r),r=r.sibling;null===(r=n)?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),jo(t,!1,n,r,a);break;case"backwards":for(r=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===ls(e)){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}jo(t,!0,r,null,a);break;case"together":jo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Qo(e,t){0==(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Nl|=t.lanes,0==(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(r=Bc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Bc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Xo(e,t){if(!na)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;null!==r;)null!==r.alternate&&(i=r),r=r.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Wo(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,i=0;if(t)for(var n=e.child;null!==n;)r|=n.lanes|n.childLanes,i|=14680064&n.subtreeFlags,i|=14680064&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function Ho(e,t,r){var i=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wo(t),null;case 1:case 17:return Rn(t.type)&&Bn(),Wo(t),null;case 3:return i=t.stateNode,ns(),Sn(Cn),Sn(In),us(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==aa&&(sc(aa),aa=null))),Wo(t),null;case 5:ss(t);var n=rs(ts.current);if(r=t.type,null!==e&&null!=t.stateNode)Bo(e,t,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(a(166));return Wo(t),null}if(e=rs(Za.current),ha(t)){i=t.stateNode,r=t.type;var s=t.memoizedProps;switch(i[dn]=t,i[fn]=s,e=0!=(1&t.mode),r){case"dialog":Oi("cancel",i),Oi("close",i);break;case"iframe":case"object":case"embed":Oi("load",i);break;case"video":case"audio":for(n=0;n<Li.length;n++)Oi(Li[n],i);break;case"source":Oi("error",i);break;case"img":case"image":case"link":Oi("error",i),Oi("load",i);break;case"details":Oi("toggle",i);break;case"input":Y(i,s),Oi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Oi("invalid",i);break;case"textarea":ne(i,s),Oi("invalid",i)}for(var l in be(r,s),n=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"==typeof c?i.textContent!==c&&(!0!==s.suppressHydrationWarning&&Ki(i.textContent,c,e),n=["children",c]):"number"==typeof c&&i.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Ki(i.textContent,c,e),n=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Oi("scroll",i)}switch(r){case"input":W(i),Z(i,s,!0);break;case"textarea":W(i),se(i);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(i.onclick=Ji)}i=n,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===n.nodeType?n:n.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof i.is?e=l.createElement(r,{is:i.is}):(e=l.createElement(r),"select"===r&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,r),e[dn]=t,e[fn]=i,Ro(e,t),t.stateNode=e;e:{switch(l=ve(r,i),r){case"dialog":Oi("cancel",e),Oi("close",e),n=i;break;case"iframe":case"object":case"embed":Oi("load",e),n=i;break;case"video":case"audio":for(n=0;n<Li.length;n++)Oi(Li[n],e);n=i;break;case"source":Oi("error",e),n=i;break;case"img":case"image":case"link":Oi("error",e),Oi("load",e),n=i;break;case"details":Oi("toggle",e),n=i;break;case"input":Y(e,i),n=$(e,i),Oi("invalid",e);break;case"option":default:n=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},n=F({},i,{value:void 0}),Oi("invalid",e);break;case"textarea":ne(e,i),n=ie(e,i),Oi("invalid",e)}for(s in be(r,n),c=n)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===s?"string"==typeof u?("textarea"!==r||""!==u)&&de(e,u):"number"==typeof u&&de(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Oi("scroll",e):null!=u&&v(e,s,u,l))}switch(r){case"input":W(e),Z(e,i,!1);break;case"textarea":W(e),se(e);break;case"option":null!=i.value&&e.setAttribute("value",""+q(i.value));break;case"select":e.multiple=!!i.multiple,null!=(s=i.value)?re(e,!!i.multiple,s,!1):null!=i.defaultValue&&re(e,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof n.onClick&&(e.onclick=Ji)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wo(t),null;case 6:if(e&&null!=t.stateNode)Lo(0,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(a(166));if(r=rs(ts.current),rs(Za.current),ha(t)){if(i=t.stateNode,r=t.memoizedProps,i[dn]=t,(s=i.nodeValue!==r)&&null!==(e=ra))switch(e.tag){case 3:Ki(i.nodeValue,r,0!=(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ki(i.nodeValue,r,0!=(1&e.mode))}s&&(t.flags|=4)}else(i=(9===r.nodeType?r:r.ownerDocument).createTextNode(i))[dn]=t,t.stateNode=i}return Wo(t),null;case 13:if(Sn(os),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(na&&null!==ia&&0!=(1&t.mode)&&0==(128&t.flags))da(),fa(),t.flags|=98560,s=!1;else if(s=ha(t),null!==i&&null!==i.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[dn]=t}else fa(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wo(t),s=!1}else null!==aa&&(sc(aa),aa=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!=(128&t.flags)?(t.lanes=r,t):((i=null!==i)!=(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&os.current)?0===Ll&&(Ll=3):pc())),null!==t.updateQueue&&(t.flags|=4),Wo(t),null);case 4:return ns(),null===e&&ji(t.stateNode.containerInfo),Wo(t),null;case 10:return Ea(t.type._context),Wo(t),null;case 19:if(Sn(os),null===(s=t.memoizedState))return Wo(t),null;if(i=0!=(128&t.flags),null===(l=s.rendering))if(i)Xo(s,!1);else{if(0!==Ll||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ls(e))){for(t.flags|=128,Xo(s,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;null!==r;)e=i,(s=r).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return xn(os,1&os.current|2),t.child}e=e.sibling}null!==s.tail&&Ke()>Vl&&(t.flags|=128,i=!0,Xo(s,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ls(l))){if(t.flags|=128,i=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Xo(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!na)return Wo(t),null}else 2*Ke()-s.renderingStartTime>Vl&&1073741824!==r&&(t.flags|=128,i=!0,Xo(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=s.last)?r.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ke(),t.sibling=null,r=os.current,xn(os,i?1&r|2:1&r),t):(Wo(t),null);case 22:case 23:return hc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!=(1&t.mode)?0!=(1073741824&Rl)&&(Wo(t),6&t.subtreeFlags&&(t.flags|=8192)):Wo(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Go(e,t){switch(ta(t),t.tag){case 1:return Rn(t.type)&&Bn(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ns(),Sn(Cn),Sn(In),us(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ss(t),null;case 13:if(Sn(os),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sn(os),null;case 4:return ns(),null;case 10:return Ea(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ro=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Bo=function(e,t,r,i){var n=e.memoizedProps;if(n!==i){e=t.stateNode,rs(Za.current);var a,s=null;switch(r){case"input":n=$(e,n),i=$(e,i),s=[];break;case"select":n=F({},n,{value:void 0}),i=F({},i,{value:void 0}),s=[];break;case"textarea":n=ie(e,n),i=ie(e,i),s=[];break;default:"function"!=typeof n.onClick&&"function"==typeof i.onClick&&(e.onclick=Ji)}for(u in be(r,i),r=null,n)if(!i.hasOwnProperty(u)&&n.hasOwnProperty(u)&&null!=n[u])if("style"===u){var l=n[u];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=n?n[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(s||(s=[]),s.push(u,r)),r=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Oi("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Lo=function(e,t,r,i){r!==i&&(t.flags|=4)};var $o=!1,Yo=!1,Ko="function"==typeof WeakSet?WeakSet:Set,Jo=null;function Zo(e,t){var r=e.ref;if(null!==r)if("function"==typeof r)try{r(null)}catch(r){Tc(e,t,r)}else r.current=null}function el(e,t,r){try{r()}catch(r){Tc(e,t,r)}}var tl=!1;function rl(e,t,r){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var n=i=i.next;do{if((n.tag&e)===e){var a=n.destroy;n.destroy=void 0,void 0!==a&&el(t,r,a)}n=n.next}while(n!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var i=r.create;r.destroy=i()}r=r.next}while(r!==t)}}function nl(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"==typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[dn],delete t[fn],delete t[pn],delete t[gn],delete t[An]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,r){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!=(r=r._reactRootContainer)||null!==t.onclick||(t.onclick=Ji));else if(4!==i&&null!==(e=e.child))for(ll(e,t,r),e=e.sibling;null!==e;)ll(e,t,r),e=e.sibling}function cl(e,t,r){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==i&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}var ul=null,hl=!1;function dl(e,t,r){for(r=r.child;null!==r;)fl(e,t,r),r=r.sibling}function fl(e,t,r){if(at&&"function"==typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(nt,r)}catch(e){}switch(r.tag){case 5:Yo||Zo(r,t);case 6:var i=ul,n=hl;ul=null,dl(e,t,r),hl=n,null!==(ul=i)&&(hl?(e=ul,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):ul.removeChild(r.stateNode));break;case 18:null!==ul&&(hl?(e=ul,r=r.stateNode,8===e.nodeType?ln(e.parentNode,r):1===e.nodeType&&ln(e,r),Vt(e)):ln(ul,r.stateNode));break;case 4:i=ul,n=hl,ul=r.stateNode.containerInfo,hl=!0,dl(e,t,r),ul=i,hl=n;break;case 0:case 11:case 14:case 15:if(!Yo&&null!==(i=r.updateQueue)&&null!==(i=i.lastEffect)){n=i=i.next;do{var a=n,s=a.destroy;a=a.tag,void 0!==s&&(0!=(2&a)||0!=(4&a))&&el(r,t,s),n=n.next}while(n!==i)}dl(e,t,r);break;case 1:if(!Yo&&(Zo(r,t),"function"==typeof(i=r.stateNode).componentWillUnmount))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(e){Tc(r,t,e)}dl(e,t,r);break;case 21:dl(e,t,r);break;case 22:1&r.mode?(Yo=(i=Yo)||null!==r.memoizedState,dl(e,t,r),Yo=i):dl(e,t,r);break;default:dl(e,t,r)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Ko),t.forEach((function(t){var i=Ic.bind(null,e,t);r.has(t)||(r.add(t),t.then(i,i))}))}}function pl(e,t){var r=t.deletions;if(null!==r)for(var i=0;i<r.length;i++){var n=r[i];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));fl(s,o,n),ul=null,hl=!1;var c=n.alternate;null!==c&&(c.return=null),n.return=null}catch(e){Tc(n,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),Al(e),4&i){try{rl(3,e,e.return),il(3,e)}catch(t){Tc(e,e.return,t)}try{rl(5,e,e.return)}catch(t){Tc(e,e.return,t)}}break;case 1:pl(t,e),Al(e),512&i&&null!==r&&Zo(r,r.return);break;case 5:if(pl(t,e),Al(e),512&i&&null!==r&&Zo(r,r.return),32&e.flags){var n=e.stateNode;try{de(n,"")}catch(t){Tc(e,e.return,t)}}if(4&i&&null!=(n=e.stateNode)){var s=e.memoizedProps,o=null!==r?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&K(n,s),ve(l,o);var u=ve(l,s);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];"style"===h?ge(n,d):"dangerouslySetInnerHTML"===h?he(n,d):"children"===h?de(n,d):v(n,h,d,u)}switch(l){case"input":J(n,s);break;case"textarea":ae(n,s);break;case"select":var f=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var m=s.value;null!=m?re(n,!!s.multiple,m,!1):f!==!!s.multiple&&(null!=s.defaultValue?re(n,!!s.multiple,s.defaultValue,!0):re(n,!!s.multiple,s.multiple?[]:"",!1))}n[fn]=s}catch(t){Tc(e,e.return,t)}}break;case 6:if(pl(t,e),Al(e),4&i){if(null===e.stateNode)throw Error(a(162));n=e.stateNode,s=e.memoizedProps;try{n.nodeValue=s}catch(t){Tc(e,e.return,t)}}break;case 3:if(pl(t,e),Al(e),4&i&&null!==r&&r.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(t){Tc(e,e.return,t)}break;case 4:default:pl(t,e),Al(e);break;case 13:pl(t,e),Al(e),8192&(n=e.child).flags&&(s=null!==n.memoizedState,n.stateNode.isHidden=s,!s||null!==n.alternate&&null!==n.alternate.memoizedState||(jl=Ke())),4&i&&ml(e);break;case 22:if(h=null!==r&&null!==r.memoizedState,1&e.mode?(Yo=(u=Yo)||h,pl(t,e),Yo=u):pl(t,e),Al(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!=(1&e.mode))for(Jo=e,h=e.child;null!==h;){for(d=Jo=h;null!==Jo;){switch(m=(f=Jo).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:Zo(f,f.return);var p=f.stateNode;if("function"==typeof p.componentWillUnmount){i=f,r=f.return;try{t=i,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(e){Tc(i,r,e)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){wl(d);continue}}null!==m?(m.return=f,Jo=m):wl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{n=d.stateNode,u?"function"==typeof(s=n.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=d.stateNode,o=null!=(c=d.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",o))}catch(t){Tc(e,e.return,t)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(t){Tc(e,e.return,t)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:pl(t,e),Al(e),4&i&&ml(e);case 21:}}function Al(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(sl(r)){var i=r;break e}r=r.return}throw Error(a(160))}switch(i.tag){case 5:var n=i.stateNode;32&i.flags&&(de(n,""),i.flags&=-33),cl(e,ol(e),n);break;case 3:case 4:var s=i.stateNode.containerInfo;ll(e,ol(e),s);break;default:throw Error(a(161))}}catch(t){Tc(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,r){Jo=e,vl(e,t,r)}function vl(e,t,r){for(var i=0!=(1&e.mode);null!==Jo;){var n=Jo,a=n.child;if(22===n.tag&&i){var s=null!==n.memoizedState||$o;if(!s){var o=n.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=$o;var c=Yo;if($o=s,(Yo=l)&&!c)for(Jo=n;null!==Jo;)l=(s=Jo).child,22===s.tag&&null!==s.memoizedState?El(n):null!==l?(l.return=s,Jo=l):El(n);for(;null!==a;)Jo=a,vl(a,t,r),a=a.sibling;Jo=n,$o=o,Yo=c}yl(e)}else 0!=(8772&n.subtreeFlags)&&null!==a?(a.return=n,Jo=a):yl(e)}}function yl(e){for(;null!==Jo;){var t=Jo;if(0!=(8772&t.flags)){var r=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Yo)if(null===r)i.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:ga(t.type,r.memoizedProps);i.componentDidUpdate(n,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Oa(t,s,i);break;case 3:var o=t.updateQueue;if(null!==o){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Oa(t,o,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Vt(d)}}}break;default:throw Error(a(163))}Yo||512&t.flags&&nl(t)}catch(e){Tc(t,t.return,e)}}if(t===e){Jo=null;break}if(null!==(r=t.sibling)){r.return=t.return,Jo=r;break}Jo=t.return}}function wl(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Jo=r;break}Jo=t.return}}function El(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{il(4,t)}catch(e){Tc(t,r,e)}break;case 1:var i=t.stateNode;if("function"==typeof i.componentDidMount){var n=t.return;try{i.componentDidMount()}catch(e){Tc(t,n,e)}}var a=t.return;try{nl(t)}catch(e){Tc(t,a,e)}break;case 5:var s=t.return;try{nl(t)}catch(e){Tc(t,s,e)}}}catch(e){Tc(t,t.return,e)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var _l,Tl=Math.ceil,Sl=y.ReactCurrentDispatcher,xl=y.ReactCurrentOwner,kl=y.ReactCurrentBatchConfig,Il=0,Cl=null,Pl=null,Ml=0,Rl=0,Bl=Tn(0),Ll=0,Dl=null,Nl=0,Fl=0,Ol=0,zl=null,Ul=null,jl=0,Vl=1/0,Ql=null,ql=!1,Xl=null,Wl=null,Hl=!1,Gl=null,$l=0,Yl=0,Kl=null,Jl=-1,Zl=0;function ec(){return 0!=(6&Il)?Ke():-1!==Jl?Jl:Jl=Ke()}function tc(e){return 0==(1&e.mode)?1:0!=(2&Il)&&0!==Ml?Ml&-Ml:null!==pa.transition?(0===Zl&&(Zl=pt()),Zl):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,r,i){if(50<Yl)throw Yl=0,Kl=null,Error(a(185));At(e,r,i),0!=(2&Il)&&e===Cl||(e===Cl&&(0==(2&Il)&&(Fl|=r),4===Ll&&oc(e,Ml)),ic(e,i),1===r&&0===Il&&0==(1&t.mode)&&(Vl=Ke()+500,zn&&Vn()))}function ic(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,n=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-st(a),o=1<<s,l=n[s];-1===l?0!=(o&r)&&0==(o&i)||(n[s]=ft(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var i=dt(e,e===Cl?Ml:0);if(0===i)null!==r&&Ge(r),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=r&&Ge(r),1===t)0===e.tag?function(e){zn=!0,jn(e)}(lc.bind(null,e)):jn(lc.bind(null,e)),sn((function(){0==(6&Il)&&Vn()})),r=null;else{switch(yt(i)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=it}r=Cc(r,nc.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function nc(e,t){if(Jl=-1,Zl=0,0!=(6&Il))throw Error(a(327));var r=e.callbackNode;if(Ec()&&e.callbackNode!==r)return null;var i=dt(e,e===Cl?Ml:0);if(0===i)return null;if(0!=(30&i)||0!=(i&e.expiredLanes)||t)t=gc(e,i);else{t=i;var n=Il;Il|=2;var s=mc();for(Cl===e&&Ml===t||(Ql=null,Vl=Ke()+500,dc(e,t));;)try{bc();break}catch(t){fc(e,t)}wa(),Sl.current=s,Il=n,null!==Pl?t=0:(Cl=null,Ml=0,t=Ll)}if(0!==t){if(2===t&&0!==(n=mt(e))&&(i=n,t=ac(e,n)),1===t)throw r=Dl,dc(e,0),oc(e,i),ic(e,Ke()),r;if(6===t)oc(e,i);else{if(n=e.current.alternate,0==(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var i=0;i<r.length;i++){var n=r[i],a=n.getSnapshot;n=n.value;try{if(!si(a(),n))return!1}catch(e){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(n)&&(2===(t=gc(e,i))&&0!==(s=mt(e))&&(i=s,t=ac(e,s)),1===t))throw r=Dl,dc(e,0),oc(e,i),ic(e,Ke()),r;switch(e.finishedWork=n,e.finishedLanes=i,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,Ul,Ql);break;case 3:if(oc(e,i),(130023424&i)===i&&10<(t=jl+500-Ke())){if(0!==dt(e,0))break;if(((n=e.suspendedLanes)&i)!==i){ec(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=rn(wc.bind(null,e,Ul,Ql),t);break}wc(e,Ul,Ql);break;case 4:if(oc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,n=-1;0<i;){var o=31-st(i);s=1<<o,(o=t[o])>n&&(n=o),i&=~s}if(i=n,10<(i=(120>(i=Ke()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Tl(i/1960))-i)){e.timeoutHandle=rn(wc.bind(null,e,Ul,Ql),i);break}wc(e,Ul,Ql);break;default:throw Error(a(329))}}}return ic(e,Ke()),e.callbackNode===r?nc.bind(null,e):null}function ac(e,t){var r=zl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ul,Ul=r,null!==t&&sc(t)),e}function sc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function oc(e,t){for(t&=~Ol,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-st(t),i=1<<r;e[r]=-1,t&=~i}}function lc(e){if(0!=(6&Il))throw Error(a(327));Ec();var t=dt(e,0);if(0==(1&t))return ic(e,Ke()),null;var r=gc(e,t);if(0!==e.tag&&2===r){var i=mt(e);0!==i&&(t=i,r=ac(e,i))}if(1===r)throw r=Dl,dc(e,0),oc(e,t),ic(e,Ke()),r;if(6===r)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Ul,Ql),ic(e,Ke()),null}function cc(e,t){var r=Il;Il|=1;try{return e(t)}finally{0===(Il=r)&&(Vl=Ke()+500,zn&&Vn())}}function uc(e){null!==Gl&&0===Gl.tag&&0==(6&Il)&&Ec();var t=Il;Il|=1;var r=kl.transition,i=vt;try{if(kl.transition=null,vt=1,e)return e()}finally{vt=i,kl.transition=r,0==(6&(Il=t))&&Vn()}}function hc(){Rl=Bl.current,Sn(Bl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,nn(r)),null!==Pl)for(r=Pl.return;null!==r;){var i=r;switch(ta(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&Bn();break;case 3:ns(),Sn(Cn),Sn(In),us();break;case 5:ss(i);break;case 4:ns();break;case 13:case 19:Sn(os);break;case 10:Ea(i.type._context);break;case 22:case 23:hc()}r=r.return}if(Cl=e,Pl=e=Bc(e.current,null),Ml=Rl=t,Ll=0,Dl=null,Ol=Fl=Nl=0,Ul=zl=null,null!==xa){for(t=0;t<xa.length;t++)if(null!==(i=(r=xa[t]).interleaved)){r.interleaved=null;var n=i.next,a=r.pending;if(null!==a){var s=a.next;a.next=n,i.next=s}r.pending=i}xa=null}return e}function fc(e,t){for(;;){var r=Pl;try{if(wa(),hs.current=ao,As){for(var i=ms.memoizedState;null!==i;){var n=i.queue;null!==n&&(n.pending=null),i=i.next}As=!1}if(fs=0,gs=ps=ms=null,bs=!1,vs=0,xl.current=null,null===r||null===r.return){Ll=1,Dl=t,Pl=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=Ml,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,h=l,d=h.tag;if(0==(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=Ao(o);if(null!==m){m.flags&=-257,bo(m,o,l,0,t),1&m.mode&&go(s,u,t),c=u;var p=(t=m).updateQueue;if(null===p){var g=new Set;g.add(c),t.updateQueue=g}else p.add(c);break e}if(0==(1&t)){go(s,u,t),pc();break e}c=Error(a(426))}else if(na&&1&l.mode){var A=Ao(o);if(null!==A){0==(65536&A.flags)&&(A.flags|=256),bo(A,o,l,0,t),ma(co(c,l));break e}}s=c=co(c,l),4!==Ll&&(Ll=2),null===zl?zl=[s]:zl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Na(s,mo(0,c,t));break e;case 1:l=c;var b=s.type,v=s.stateNode;if(0==(128&s.flags)&&("function"==typeof b.getDerivedStateFromError||null!==v&&"function"==typeof v.componentDidCatch&&(null===Wl||!Wl.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t,Na(s,po(s,l,t));break e}}s=s.return}while(null!==s)}yc(r)}catch(e){t=e,Pl===r&&null!==r&&(Pl=r=r.return);continue}break}}function mc(){var e=Sl.current;return Sl.current=ao,null===e?ao:e}function pc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Cl||0==(268435455&Nl)&&0==(268435455&Fl)||oc(Cl,Ml)}function gc(e,t){var r=Il;Il|=2;var i=mc();for(Cl===e&&Ml===t||(Ql=null,dc(e,t));;)try{Ac();break}catch(t){fc(e,t)}if(wa(),Il=r,Sl.current=i,null!==Pl)throw Error(a(261));return Cl=null,Ml=0,Ll}function Ac(){for(;null!==Pl;)vc(Pl)}function bc(){for(;null!==Pl&&!$e();)vc(Pl)}function vc(e){var t=_l(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?yc(e):Pl=t,xl.current=null}function yc(e){var t=e;do{var r=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(r=Ho(r,t,Rl)))return void(Pl=r)}else{if(null!==(r=Go(r,t)))return r.flags&=32767,void(Pl=r);if(null===e)return Ll=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Ll&&(Ll=5)}function wc(e,t,r){var i=vt,n=kl.transition;try{kl.transition=null,vt=1,function(e,t,r,i){do{Ec()}while(null!==Gl);if(0!=(6&Il))throw Error(a(327));r=e.finishedWork;var n=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-st(r),a=1<<n;t[n]=0,i[n]=-1,e[n]=-1,r&=~a}}(e,s),e===Cl&&(Pl=Cl=null,Ml=0),0==(2064&r.subtreeFlags)&&0==(2064&r.flags)||Hl||(Hl=!0,Cc(tt,(function(){return Ec(),null}))),s=0!=(15990&r.flags),0!=(15990&r.subtreeFlags)||s){s=kl.transition,kl.transition=null;var o=vt;vt=1;var l=Il;Il|=4,xl.current=null,function(e,t){if(Zi=qt,di(e=hi())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(i&&0!==i.rangeCount){r=i.anchorNode;var n=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{r.nodeType,s.nodeType}catch(e){r=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var m;d!==r||0!==n&&3!==d.nodeType||(l=o+n),d!==s||0!==i&&3!==d.nodeType||(c=o+i),3===d.nodeType&&(o+=d.nodeValue.length),null!==(m=d.firstChild);)f=d,d=m;for(;;){if(d===e)break t;if(f===r&&++u===n&&(l=o),f===s&&++h===i&&(c=o),null!==(m=d.nextSibling))break;f=(d=f).parentNode}d=m}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(en={focusedElem:e,selectionRange:r},qt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var p=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,A=p.memoizedState,b=t.stateNode,v=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:ga(t.type,g),A);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(a(163))}}catch(e){Tc(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}p=tl,tl=!1}(e,r),gl(r,e),fi(en),qt=!!Zi,en=Zi=null,e.current=r,bl(r,e,n),Ye(),Il=l,vt=o,kl.transition=s}else e.current=r;if(Hl&&(Hl=!1,Gl=e,$l=n),0===(s=e.pendingLanes)&&(Wl=null),function(e){if(at&&"function"==typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(nt,e,void 0,128==(128&e.current.flags))}catch(e){}}(r.stateNode),ic(e,Ke()),null!==t)for(i=e.onRecoverableError,r=0;r<t.length;r++)i((n=t[r]).value,{componentStack:n.stack,digest:n.digest});if(ql)throw ql=!1,e=Xl,Xl=null,e;0!=(1&$l)&&0!==e.tag&&Ec(),0!=(1&(s=e.pendingLanes))?e===Kl?Yl++:(Yl=0,Kl=e):Yl=0,Vn()}(e,t,r,i)}finally{kl.transition=n,vt=i}return null}function Ec(){if(null!==Gl){var e=yt($l),t=kl.transition,r=vt;try{if(kl.transition=null,vt=16>e?16:e,null===Gl)var i=!1;else{if(e=Gl,Gl=null,$l=0,0!=(6&Il))throw Error(a(331));var n=Il;for(Il|=4,Jo=e.current;null!==Jo;){var s=Jo,o=s.child;if(0!=(16&Jo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Jo=u;null!==Jo;){var h=Jo;switch(h.tag){case 0:case 11:case 15:rl(8,h,s)}var d=h.child;if(null!==d)d.return=h,Jo=d;else for(;null!==Jo;){var f=(h=Jo).sibling,m=h.return;if(al(h),h===u){Jo=null;break}if(null!==f){f.return=m,Jo=f;break}Jo=m}}}var p=s.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var A=g.sibling;g.sibling=null,g=A}while(null!==g)}}Jo=s}}if(0!=(2064&s.subtreeFlags)&&null!==o)o.return=s,Jo=o;else e:for(;null!==Jo;){if(0!=(2048&(s=Jo).flags))switch(s.tag){case 0:case 11:case 15:rl(9,s,s.return)}var b=s.sibling;if(null!==b){b.return=s.return,Jo=b;break e}Jo=s.return}}var v=e.current;for(Jo=v;null!==Jo;){var y=(o=Jo).child;if(0!=(2064&o.subtreeFlags)&&null!==y)y.return=o,Jo=y;else e:for(o=v;null!==Jo;){if(0!=(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(e){Tc(l,l.return,e)}if(l===o){Jo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Jo=w;break e}Jo=l.return}}if(Il=n,Vn(),at&&"function"==typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(nt,e)}catch(e){}i=!0}return i}finally{vt=r,kl.transition=t}}return!1}function _c(e,t,r){e=La(e,t=mo(0,t=co(r,t),1),1),t=ec(),null!==e&&(At(e,1,t),ic(e,t))}function Tc(e,t,r){if(3===e.tag)_c(e,e,r);else for(;null!==t;){if(3===t.tag){_c(t,e,r);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Wl||!Wl.has(i))){t=La(t,e=po(t,e=co(r,e),1),1),e=ec(),null!==t&&(At(t,1,e),ic(t,e));break}}t=t.return}}function Sc(e,t,r){var i=e.pingCache;null!==i&&i.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&r,Cl===e&&(Ml&r)===r&&(4===Ll||3===Ll&&(130023424&Ml)===Ml&&500>Ke()-jl?dc(e,0):Ol|=r),ic(e,t)}function xc(e,t){0===t&&(0==(1&e.mode)?t=1:(t=ut,0==(130023424&(ut<<=1))&&(ut=4194304)));var r=ec();null!==(e=Ca(e,t))&&(At(e,t,r),ic(e,r))}function kc(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),xc(e,r)}function Ic(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,n=e.memoizedState;null!==n&&(r=n.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(a(314))}null!==i&&i.delete(t),xc(e,r)}function Cc(e,t){return He(e,t)}function Pc(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(e,t,r,i){return new Pc(e,t,r,i)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Bc(e,t){var r=e.alternate;return null===r?((r=Mc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Lc(e,t,r,i,n,s){var o=2;if(i=e,"function"==typeof e)Rc(e)&&(o=1);else if("string"==typeof e)o=5;else e:switch(e){case _:return Dc(r.children,n,s,t);case T:o=8,n|=8;break;case S:return(e=Mc(12,r,t,2|n)).elementType=S,e.lanes=s,e;case C:return(e=Mc(13,r,t,n)).elementType=C,e.lanes=s,e;case P:return(e=Mc(19,r,t,n)).elementType=P,e.lanes=s,e;case B:return Nc(r,n,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case x:o=10;break e;case k:o=9;break e;case I:o=11;break e;case M:o=14;break e;case R:o=16,i=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Mc(o,r,t,n)).elementType=e,t.type=i,t.lanes=s,t}function Dc(e,t,r,i){return(e=Mc(7,e,i,t)).lanes=r,e}function Nc(e,t,r,i){return(e=Mc(22,e,i,t)).elementType=B,e.lanes=r,e.stateNode={isHidden:!1},e}function Fc(e,t,r){return(e=Mc(6,e,null,t)).lanes=r,e}function Oc(e,t,r){return(t=Mc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,r,i,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Uc(e,t,r,i,n,a,s,o,l){return e=new zc(e,t,r,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Mc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ma(a),e}function jc(e,t,r){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==i?null:""+i,children:e,containerInfo:t,implementation:r}}function Vc(e){if(!e)return kn;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var r=e.type;if(Rn(r))return Dn(e,r,t)}return t}function Qc(e,t,r,i,n,a,s,o,l){return(e=Uc(r,i,!0,e,0,a,0,o,l)).context=Vc(null),r=e.current,(a=Ba(i=ec(),n=tc(r))).callback=null!=t?t:null,La(r,a,n),e.current.lanes=n,At(e,n,i),ic(e,i),e}function qc(e,t,r,i){var n=t.current,a=ec(),s=tc(n);return r=Vc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Ba(a,s)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=La(n,t,s))&&(rc(e,n,s,a),Da(e,n,s)),s}function Xc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Hc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}_l=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Cn.current)yo=!0;else{if(0==(e.lanes&r)&&0==(128&t.flags))return yo=!1,function(e,t,r){switch(t.tag){case 3:Po(t),fa();break;case 5:as(t);break;case 1:Rn(t.type)&&Nn(t);break;case 4:is(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,n=t.memoizedProps.value;xn(Aa,i._currentValue),i._currentValue=n;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(xn(os,1&os.current),t.flags|=128,null):0!=(r&t.child.childLanes)?Fo(e,t,r):(xn(os,1&os.current),null!==(e=qo(e,t,r))?e.sibling:null);xn(os,1&os.current);break;case 19:if(i=0!=(r&t.childLanes),0!=(128&e.flags)){if(i)return Vo(e,t,r);t.flags|=128}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),xn(os,os.current),i)break;return null;case 22:case 23:return t.lanes=0,So(e,t,r)}return qo(e,t,r)}(e,t,r);yo=0!=(131072&e.flags)}else yo=!1,na&&0!=(1048576&t.flags)&&Zn(t,Wn,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Qo(e,t),e=t.pendingProps;var n=Mn(t,In.current);Ta(t,r),n=_s(null,t,i,e,n,r);var s=Ts();return t.flags|=1,"object"==typeof n&&null!==n&&"function"==typeof n.render&&void 0===n.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rn(i)?(s=!0,Nn(t)):s=!1,t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,Ma(t),n.updater=ja,t.stateNode=n,n._reactInternals=t,Xa(t,i,e,r),t=Co(null,t,i,!0,s,r)):(t.tag=0,na&&s&&ea(t),wo(null,t,n,r),t=t.child),t;case 16:i=t.elementType;e:{switch(Qo(e,t),e=t.pendingProps,i=(n=i._init)(i._payload),t.type=i,n=t.tag=function(e){if("function"==typeof e)return Rc(e)?1:0;if(null!=e){if((e=e.$$typeof)===I)return 11;if(e===M)return 14}return 2}(i),e=ga(i,e),n){case 0:t=ko(null,t,i,e,r);break e;case 1:t=Io(null,t,i,e,r);break e;case 11:t=Eo(null,t,i,e,r);break e;case 14:t=_o(null,t,i,ga(i.type,e),r);break e}throw Error(a(306,i,""))}return t;case 0:return i=t.type,n=t.pendingProps,ko(e,t,i,n=t.elementType===i?n:ga(i,n),r);case 1:return i=t.type,n=t.pendingProps,Io(e,t,i,n=t.elementType===i?n:ga(i,n),r);case 3:e:{if(Po(t),null===e)throw Error(a(387));i=t.pendingProps,n=(s=t.memoizedState).element,Ra(e,t),Fa(t,i,null,r);var o=t.memoizedState;if(i=o.element,s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Mo(e,t,i,r,n=co(Error(a(423)),t));break e}if(i!==n){t=Mo(e,t,i,r,n=co(Error(a(424)),t));break e}for(ia=cn(t.stateNode.containerInfo.firstChild),ra=t,na=!0,aa=null,r=Ka(t,null,i,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(fa(),i===n){t=qo(e,t,r);break e}wo(e,t,i,r)}t=t.child}return t;case 5:return as(t),null===e&&ca(t),i=t.type,n=t.pendingProps,s=null!==e?e.memoizedProps:null,o=n.children,tn(i,n)?o=null:null!==s&&tn(i,s)&&(t.flags|=32),xo(e,t),wo(e,t,o,r),t.child;case 6:return null===e&&ca(t),null;case 13:return Fo(e,t,r);case 4:return is(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Ya(t,null,i,r):wo(e,t,i,r),t.child;case 11:return i=t.type,n=t.pendingProps,Eo(e,t,i,n=t.elementType===i?n:ga(i,n),r);case 7:return wo(e,t,t.pendingProps,r),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(i=t.type._context,n=t.pendingProps,s=t.memoizedProps,o=n.value,xn(Aa,i._currentValue),i._currentValue=o,null!==s)if(si(s.value,o)){if(s.children===n.children&&!Cn.current){t=qo(e,t,r);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===s.tag){(c=Ba(-1,r&-r)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=r,null!==(c=s.alternate)&&(c.lanes|=r),_a(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=r,null!==(l=o.alternate)&&(l.lanes|=r),_a(o,r,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}wo(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,i=t.pendingProps.children,Ta(t,r),i=i(n=Sa(n)),t.flags|=1,wo(e,t,i,r),t.child;case 14:return n=ga(i=t.type,t.pendingProps),_o(e,t,i,n=ga(i.type,n),r);case 15:return To(e,t,t.type,t.pendingProps,r);case 17:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:ga(i,n),Qo(e,t),t.tag=1,Rn(i)?(e=!0,Nn(t)):e=!1,Ta(t,r),Qa(t,i,n),Xa(t,i,n,r),Co(null,t,i,!0,e,r);case 19:return Vo(e,t,r);case 22:return So(e,t,r)}throw Error(a(156,t.tag))};var Gc="function"==typeof reportError?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,r,i,n){var a=r._reactRootContainer;if(a){var s=a;if("function"==typeof n){var o=n;n=function(){var e=Xc(s);o.call(e)}}qc(t,s,e,n)}else s=function(e,t,r,i,n){if(n){if("function"==typeof i){var a=i;i=function(){var e=Xc(s);a.call(e)}}var s=Qc(t,i,e,0,null,!1,0,"",Zc);return e._reactRootContainer=s,e[mn]=s.current,ji(8===e.nodeType?e.parentNode:e),uc(),s}for(;n=e.lastChild;)e.removeChild(n);if("function"==typeof i){var o=i;i=function(){var e=Xc(l);o.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[mn]=l.current,ji(8===e.nodeType?e.parentNode:e),uc((function(){qc(t,l,r,i)})),l}(r,t,e,n,i);return Xc(s)}Yc.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));qc(e,t,null,null)},Yc.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){qc(null,e,null,null)})),t[mn]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Bt.length&&0!==t&&t<Bt[r].priority;r++);Bt.splice(r,0,e),0===r&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ht(t.pendingLanes);0!==r&&(bt(t,1|r),ic(t,Ke()),0==(6&Il)&&(Vl=Ke()+500,Vn()))}break;case 13:uc((function(){var t=Ca(e,1);if(null!==t){var r=ec();rc(t,e,1,r)}})),Hc(e,1)}},Et=function(e){if(13===e.tag){var t=Ca(e,134217728);null!==t&&rc(t,e,134217728,ec()),Hc(e,134217728)}},_t=function(e){if(13===e.tag){var t=tc(e),r=Ca(e,t);null!==r&&rc(r,e,t,ec()),Hc(e,t)}},Tt=function(){return vt},St=function(e,t){var r=vt;try{return vt=e,t()}finally{vt=r}},Ee=function(e,t,r){switch(t){case"input":if(J(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var n=wn(i);if(!n)throw Error(a(90));H(i),J(i,n)}}}break;case"textarea":ae(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ie=cc,Ce=uc;var tu={usingClientEntryPoint:!1,Events:[vn,yn,wn,xe,ke,cc]},ru={findFiberByHostInstance:bn,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},iu={bundleType:ru.bundleType,version:ru.version,rendererPackageName:ru.rendererPackageName,rendererConfig:ru.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Xe(e))?null:e.stateNode},findFiberByHostInstance:ru.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{nt=nu.inject(iu),at=nu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(a(200));return jc(e,t,null,r)},t.createRoot=function(e,t){if(!Kc(e))throw Error(a(299));var r=!1,i="",n=Gc;return null!=t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(n=t.onRecoverableError)),t=Uc(e,1,!1,null,0,r,0,i,n),e[mn]=t.current,ji(8===e.nodeType?e.parentNode:e),new $c(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return null===(e=Xe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,r){if(!Jc(t))throw Error(a(200));return eu(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Kc(e))throw Error(a(405));var i=null!=r&&r.hydratedSources||null,n=!1,s="",o=Gc;if(null!=r&&(!0===r.unstable_strictMode&&(n=!0),void 0!==r.identifierPrefix&&(s=r.identifierPrefix),void 0!==r.onRecoverableError&&(o=r.onRecoverableError)),t=Qc(t,null,e,1,null!=r?r:null,n,0,s,o),e[mn]=t.current,ji(e),i)for(e=0;e<i.length;e++)n=(n=(r=i[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new Yc(t)},t.render=function(e,t,r){if(!Jc(t))throw Error(a(200));return eu(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[mn]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!Jc(r))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return eu(e,t,r,!1,i)},t.version="18.2.0-next-9e3b772b8-20220608"},745:(e,t,r)=>{"use strict";var i=r(3935);t.s=i.createRoot,i.hydrateRoot},3935:(e,t,r)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=r(4448)},2408:(e,t)=>{"use strict";var r=Symbol.for("react.element"),i=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator,m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function A(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}function b(){}function v(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}A.prototype.isReactComponent={},A.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},A.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=A.prototype;var y=v.prototype=new b;y.constructor=v,p(y,A.prototype),y.isPureReactComponent=!0;var w=Array.isArray,E=Object.prototype.hasOwnProperty,_={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,i){var n,a={},s=null,o=null;if(null!=t)for(n in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)E.call(t,n)&&!T.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(1===l)a.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps)void 0===a[n]&&(a[n]=l[n]);return{$$typeof:r,type:e,key:s,ref:o,props:a,_owner:_.current}}function x(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var k=/\/+/g;function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,n,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case i:l=!0}}if(l)return s=s(l=e),e=""===a?"."+I(l,0):a,w(s)?(n="",null!=e&&(n=e.replace(k,"$&/")+"/"),C(s,t,n,"",(function(e){return e}))):null!=s&&(x(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+e)),t.push(s)),1;if(l=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var u=a+I(o=e[c],c);l+=C(o,t,n,u,s)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,n,u=a+I(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,r){if(null==e)return e;var i=[],n=0;return C(e,i,"","",(function(e){return t.call(r,e,n++)})),i}function M(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},B={transition:null},L={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:B,ReactCurrentOwner:_};t.Children={map:P,forEach:function(e,t,r){P(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=A,t.Fragment=n,t.Profiler=s,t.PureComponent=v,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.cloneElement=function(e,t,i){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=p({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=_.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!T.hasOwnProperty(c)&&(n[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)n.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:r,type:e.type,key:a,ref:s,props:n,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=B.transition;B.transition={};try{e()}finally{B.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,r){return R.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,r){return R.current.useReducer(e,t,r)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return R.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return R.current.useTransition()},t.version="18.2.0"},7294:(e,t,r)=>{"use strict";e.exports=r(2408)},8090:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableWebToNodeStream=void 0;const i=r(5507);class n extends i.Readable{constructor(e){super(),this.bytesRead=0,this.released=!1,this.reader=e.getReader()}async _read(){if(this.released)return void this.push(null);this.pendingRead=this.reader.read();const e=await this.pendingRead;delete this.pendingRead,e.done||this.released?this.push(null):(this.bytesRead+=e.value.length,this.push(e.value))}async waitForReadToComplete(){this.pendingRead&&await this.pendingRead}async close(){await this.syncAndRelease()}async syncAndRelease(){this.released=!0,await this.waitForReadToComplete(),await this.reader.releaseLock()}}t.ReadableWebToNodeStream=n},1281:e=>{"use strict";var t={};function r(e,r,i){i||(i=Error);var n=function(e){var t,i;function n(t,i,n){return e.call(this,function(e,t,i){return"string"==typeof r?r:r(e,t,i)}(t,i,n))||this}return i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n}(i);n.prototype.name=i.name,n.prototype.code=e,t[e]=n}function i(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}r("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),r("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,a,s,o,l;if("string"==typeof t&&(a="not ",t.substr(0,a.length)===a)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(n," ").concat(i(t,"type"));else{var c=("number"!=typeof l&&(l=0),l+".".length>(o=e).length||-1===o.indexOf(".",l)?"argument":"property");s='The "'.concat(e,'" ').concat(c," ").concat(n," ").concat(i(t,"type"))}return s+". Received type ".concat(typeof r)}),TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},6201:(e,t,r)=>{"use strict";var i=r(4155),n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=u;var a=r(2460),s=r(1103);r(5717)(u,a);for(var o=n(s.prototype),l=0;l<o.length;l++){var c=o[l];u.prototype[c]||(u.prototype[c]=s.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);a.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||i.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},4404:(e,t,r)=>{"use strict";e.exports=n;var i=r(7749);function n(e){if(!(this instanceof n))return new n(e);i.call(this,e)}r(5717)(n,i),n.prototype._transform=function(e,t,r){r(null,e)}},2460:(e,t,r)=>{"use strict";var i,n=r(4155);e.exports=S,S.ReadableState=T,r(7187).EventEmitter;var a,s=function(e,t){return e.listeners(t).length},o=r(8114),l=r(8764).Buffer,c=r.g.Uint8Array||function(){},u=r(3838);a=u&&u.debuglog?u.debuglog("stream"):function(){};var h,d,f,m=r(597),p=r(358),g=r(5267).getHighWaterMark,A=r(1281).q,b=A.ERR_INVALID_ARG_TYPE,v=A.ERR_STREAM_PUSH_AFTER_EOF,y=A.ERR_METHOD_NOT_IMPLEMENTED,w=A.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(5717)(S,o);var E=p.errorOrDestroy,_=["error","close","destroy","pause","resume"];function T(e,t,n){i=i||r(6201),e=e||{},"boolean"!=typeof n&&(n=t instanceof i),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",n),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(2553).s),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function S(e){if(i=i||r(6201),!(this instanceof S))return new S(e);var t=this instanceof i;this._readableState=new T(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function x(e,t,r,i,n){a("readableAddChunk",t);var s,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(a("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?P(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}}(e,o);else if(n||(s=function(e,t){var r,i;return i=t,l.isBuffer(i)||i instanceof c||"string"==typeof t||void 0===t||e.objectMode||(r=new b("chunk",["string","Buffer","Uint8Array"],t)),r}(o,t)),s)E(e,s);else if(o.objectMode||t&&t.length>0)if("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),i)o.endEmitted?E(e,new w):k(e,o,t,!0);else if(o.ended)E(e,new v);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?k(e,o,t,!1):R(e,o)):k(e,o,t,!1)}else i||(o.reading=!1,R(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function k(e,t,r,i){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&P(e)),R(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=p.destroy,S.prototype._undestroy=p.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var r,i=this._readableState;return i.objectMode?r=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=l.from(e,t),t=""),r=!0),x(this,e,t,!1,r)},S.prototype.unshift=function(e){return x(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){h||(h=r(2553).s);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var i=this._readableState.buffer.head,n="";null!==i;)n+=t.write(i.data),i=i.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var I=1073741824;function C(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=I?e=I:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function P(e){var t=e._readableState;a("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(a("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(M,e))}function M(e){var t=e._readableState;a("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,F(e)}function R(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(B,e,t))}function B(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(a("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){a("readable nexttick read 0"),e.read(0)}function N(e,t){a("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),F(e),t.flowing&&!t.reading&&e.read(0)}function F(e){var t=e._readableState;for(a("flow",t.flowing);t.flowing&&null!==e.read(););}function O(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function z(e){var t=e._readableState;a("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(U,t,e))}function U(e,t){if(a("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function j(e,t){for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}S.prototype.read=function(e){a("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return a("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?z(this):P(this),null;if(0===(e=C(e,t))&&t.ended)return 0===t.length&&z(this),null;var i,n=t.needReadable;return a("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&a("length less than watermark",n=!0),t.ended||t.reading?a("reading or ended",n=!1):n&&(a("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=C(r,t))),null===(i=e>0?O(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&z(this)),null!==i&&this.emit("data",i),i},S.prototype._read=function(e){E(this,new y("_read()"))},S.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,a("pipe count=%d opts=%j",i.pipesCount,t);var o=t&&!1===t.end||e===n.stdout||e===n.stderr?p:l;function l(){a("onend"),e.end()}i.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",(function t(n,s){a("onunpipe"),n===r&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,a("cleanup"),e.removeListener("close",f),e.removeListener("finish",m),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",t),r.removeListener("end",l),r.removeListener("end",p),r.removeListener("data",h),u=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}));var c=function(e){return function(){var t=e._readableState;a("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,F(e))}}(r);e.on("drain",c);var u=!1;function h(t){a("ondata");var n=e.write(t);a("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==j(i.pipes,e))&&!u&&(a("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(t){a("onerror",t),p(),e.removeListener("error",d),0===s(e,"error")&&E(e,t)}function f(){e.removeListener("finish",m),p()}function m(){a("onfinish"),e.removeListener("close",f),p()}function p(){a("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events.error?Array.isArray(e._events.error)?e._events.error.unshift(r):e._events.error=[r,e._events.error]:e.on(t,r)}(e,"error",d),e.once("close",f),e.once("finish",m),e.emit("pipe",r),i.flowing||(a("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<n;a++)i[a].emit("unpipe",this,{hasUnpiped:!1});return this}var s=j(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},S.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,a("on readable",i.length,i.reading),i.length?P(this):i.reading||n.nextTick(D,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(L,this),r},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(L,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(a("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(N,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,r=this._readableState,i=!1;for(var n in e.on("end",(function(){if(a("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(n){a("wrapped data"),r.decoder&&(n=r.decoder.write(n)),r.objectMode&&null==n||(r.objectMode||n&&n.length)&&(t.push(n)||(i=!0,e.pause()))})),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var s=0;s<_.length;s++)e.on(_[s],this.emit.bind(this,_[s]));return this._read=function(t){a("wrapped _read",t),i&&(i=!1,e.resume())},this},"function"==typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=r(6913)),d(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=O,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(S.from=function(e,t){return void 0===f&&(f=r(2887)),f(S,e,t)})},7749:(e,t,r)=>{"use strict";e.exports=u;var i=r(1281).q,n=i.ERR_METHOD_NOT_IMPLEMENTED,a=i.ERR_MULTIPLE_CALLBACK,s=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=i.ERR_TRANSFORM_WITH_LENGTH_0,l=r(6201);function c(e,t){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(null===i)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),i(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);l.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,r){d(e,t,r)}))}function d(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new o;if(e._transformState.transforming)throw new s;return e.push(null)}r(5717)(u,l),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,r){r(new n("_transform()"))},u.prototype._write=function(e,t,r){var i=this._transformState;if(i.writecb=r,i.writechunk=e,i.writeencoding=t,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}},1103:(e,t,r)=>{"use strict";var i,n=r(4155);function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(undefined),i=i.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=S,S.WritableState=T;var s,o={deprecate:r(4927)},l=r(8114),c=r(8764).Buffer,u=r.g.Uint8Array||function(){},h=r(358),d=r(5267).getHighWaterMark,f=r(1281).q,m=f.ERR_INVALID_ARG_TYPE,p=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,A=f.ERR_STREAM_CANNOT_PIPE,b=f.ERR_STREAM_DESTROYED,v=f.ERR_STREAM_NULL_VALUES,y=f.ERR_STREAM_WRITE_AFTER_END,w=f.ERR_UNKNOWN_ENCODING,E=h.errorOrDestroy;function _(){}function T(e,t,s){i=i||r(6201),e=e||{},"boolean"!=typeof s&&(s=t instanceof i),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,a=r.writecb;if("function"!=typeof a)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,a){--t.pendingcb,r?(n.nextTick(a,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,E(e,i)):(a(i),e._writableState.errorEmitted=!0,E(e,i),M(e,t))}(e,r,i,t,a);else{var s=C(r)||e.destroyed;s||r.corked||r.bufferProcessing||!r.bufferedRequest||I(e,r),i?n.nextTick(k,e,r,s,a):k(e,r,s,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function S(e){var t=this instanceof(i=i||r(6201));if(!t&&!s.call(S,this))return new S(e);this._writableState=new T(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),l.call(this)}function x(e,t,r,i,n,a,s){t.writelen=i,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new b("write")):r?e._writev(n,t.onwrite):e._write(n,a,t.onwrite),t.sync=!1}function k(e,t,r,i){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),M(e,t)}function I(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),s=t.corkedRequestsFree;s.entry=r;for(var o=0,l=!0;r;)n[o]=r,r.isBuf||(l=!1),r=r.next,o+=1;n.allBuffers=l,x(e,t,!0,t.length,n,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,h=r.callback;if(x(e,t,!1,t.objectMode?1:c.length,c,u,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function C(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function P(e,t){e._final((function(r){t.pendingcb--,r&&E(e,r),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=C(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(P,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}r(5717)(S,l),T.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(T.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!s.call(this,e)||this===S&&e&&e._writableState instanceof T}})):s=function(e){return e instanceof this},S.prototype.pipe=function(){E(this,new A)},S.prototype.write=function(e,t,r){var i,a=this._writableState,s=!1,o=!a.objectMode&&(i=e,c.isBuffer(i)||i instanceof u);return o&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=a.defaultEncoding),"function"!=typeof r&&(r=_),a.ending?function(e,t){var r=new y;E(e,r),n.nextTick(t,r)}(this,r):(o||function(e,t,r,i){var a;return null===r?a=new v:"string"==typeof r||t.objectMode||(a=new m("chunk",["string","Buffer"],r)),!a||(E(e,a),n.nextTick(i,a),!1)}(this,a,e,r))&&(a.pendingcb++,s=function(e,t,r,i,n,a){if(!r){var s=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,r)),t}(t,i,n);i!==s&&(r=!0,n="buffer",i=s)}var o=t.objectMode?1:i.length;t.length+=o;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:a,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else x(e,t,!1,o,i,n,a);return l}(this,a,o,e,t,r)),s},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||I(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new p("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var i=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=h.destroy,S.prototype._undestroy=h.undestroy,S.prototype._destroy=function(e,t){t(e)}},6913:(e,t,r)=>{"use strict";var i,n=r(4155);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=r(2880),o=Symbol("lastResolve"),l=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),h=Symbol("lastPromise"),d=Symbol("handlePromise"),f=Symbol("stream");function m(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[h]=null,e[o]=null,e[l]=null,t(m(r,!1)))}}function g(e){n.nextTick(p,e)}var A=Object.getPrototypeOf((function(){})),b=Object.setPrototypeOf((a(i={get stream(){return this[f]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(m(void 0,!0));if(this[f].destroyed)return new Promise((function(t,r){n.nextTick((function(){e[c]?r(e[c]):t(m(void 0,!0))}))}));var r,i=this[h];if(i)r=new Promise(function(e,t){return function(r,i){e.then((function(){t[u]?r(m(void 0,!0)):t[d](r,i)}),i)}}(i,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(m(a,!1));r=new Promise(this[d])}return this[h]=r,r}},Symbol.asyncIterator,(function(){return this})),a(i,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(m(void 0,!0))}))}))})),i),A);e.exports=function(e){var t,r=Object.create(b,(a(t={},f,{value:e,writable:!0}),a(t,o,{value:null,writable:!0}),a(t,l,{value:null,writable:!0}),a(t,c,{value:null,writable:!0}),a(t,u,{value:e._readableState.endEmitted,writable:!0}),a(t,d,{value:function(e,t){var i=r[f].read();i?(r[h]=null,r[o]=null,r[l]=null,e(m(i,!1))):(r[o]=e,r[l]=t)},writable:!0}),t));return r[h]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[l];return null!==t&&(r[h]=null,r[o]=null,r[l]=null,t(e)),void(r[c]=e)}var i=r[o];null!==i&&(r[h]=null,r[o]=null,r[l]=null,i(m(void 0,!0))),r[u]=!0})),e.on("readable",g.bind(null,r)),r}},597:(e,t,r)=>{"use strict";function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=r(8764).Buffer,o=r(9283).inspect,l=o&&o.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r;return t=e,r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,r,i,n=s.allocUnsafe(e>>>0),a=this.head,o=0;a;)t=a.data,r=n,i=o,s.prototype.copy.call(t,r,i),o+=a.data.length,a=a.next;return n}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,i=t.data;for(e-=i.length;t=t.next;){var n=t.data,a=e>n.length?n.length:e;if(a===n.length?i+=n:i+=n.slice(0,e),0==(e-=a)){a===n.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=n.slice(a));break}++r}return this.length-=r,i}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),r=this.head,i=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var n=r.data,a=e>n.length?n.length:e;if(n.copy(t,t.length-e,0,a),0==(e-=a)){a===n.length?(++i,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=n.slice(a));break}++i}return this.length-=i,t}},{key:l,value:function(e,t){return o(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],r&&a(t.prototype,r),e}()},358:(e,t,r)=>{"use strict";var i=r(4155);function n(e,t){s(e,t),a(e)}function a(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function s(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,o=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return o||l?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(s,this,e)):i.nextTick(s,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?r._writableState?r._writableState.errorEmitted?i.nextTick(a,r):(r._writableState.errorEmitted=!0,i.nextTick(n,r,e)):i.nextTick(n,r,e):t?(i.nextTick(a,r),t(e)):i.nextTick(a,r)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,i=e._writableState;r&&r.autoDestroy||i&&i.autoDestroy?e.destroy(t):e.emit("error",t)}}},2880:(e,t,r)=>{"use strict";var i=r(1281).q.ERR_STREAM_PREMATURE_CLOSE;function n(){}e.exports=function e(t,r,a){if("function"==typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];e.apply(this,i)}}}(a||n);var s=r.readable||!1!==r.readable&&t.readable,o=r.writable||!1!==r.writable&&t.writable,l=function(){t.writable||u()},c=t._writableState&&t._writableState.finished,u=function(){o=!1,c=!0,s||a.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){s=!1,h=!0,o||a.call(t)},f=function(e){a.call(t,e)},m=function(){var e;return s&&!h?(t._readableState&&t._readableState.ended||(e=new i),a.call(t,e)):o&&!c?(t._writableState&&t._writableState.ended||(e=new i),a.call(t,e)):void 0},p=function(){t.req.on("finish",u)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",u),t.on("abort",m),t.req?p():t.on("request",p)):o&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",d),t.on("finish",u),!1!==r.error&&t.on("error",f),t.on("close",m),function(){t.removeListener("complete",u),t.removeListener("abort",m),t.removeListener("request",p),t.req&&t.req.removeListener("finish",u),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",u),t.removeListener("end",d),t.removeListener("error",f),t.removeListener("close",m)}}},2887:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},677:(e,t,r)=>{"use strict";var i,n=r(1281).q,a=n.ERR_MISSING_ARGS,s=n.ERR_STREAM_DESTROYED;function o(e){if(e)throw e}function l(e,t,n,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var o=!1;e.on("close",(function(){o=!0})),void 0===i&&(i=r(2880)),i(e,{readable:t,writable:n},(function(e){if(e)return a(e);o=!0,a()}));var l=!1;return function(t){if(!o&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void a(t||new s("pipe"))}}function c(e){e()}function u(e,t){return e.pipe(t)}function h(e){return e.length?"function"!=typeof e[e.length-1]?o:e.pop():o}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i,n=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var s=t.map((function(e,r){var a=r<t.length-1;return l(e,a,r>0,(function(e){i||(i=e),e&&s.forEach(c),a||(s.forEach(c),n(i))}))}));return t.reduce(u)}},5267:(e,t,r)=>{"use strict";var i=r(1281).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,n){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,n,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new i(n?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},8114:(e,t,r)=>{e.exports=r(7187).EventEmitter},5507:(e,t,r)=>{(t=e.exports=r(2460)).Stream=t,t.Readable=t,t.Writable=r(1103),t.Duplex=r(6201),t.Transform=r(7749),t.PassThrough=r(4404),t.finished=r(2880),t.pipeline=r(677)},9509:(e,t,r)=>{var i=r(8764),n=i.Buffer;function a(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=i:(a(i,t),t.Buffer=s),s.prototype=Object.create(n.prototype),a(n,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},53:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var i=r-1>>>1,n=e[i];if(!(0<a(n,t)))break e;e[i]=t,e[r]=n,r=i}}function i(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var i=0,n=e.length,s=n>>>1;i<s;){var o=2*(i+1)-1,l=e[o],c=o+1,u=e[c];if(0>a(l,r))c<n&&0>a(u,l)?(e[i]=u,e[c]=r,i=c):(e[i]=l,e[o]=r,i=o);else{if(!(c<n&&0>a(u,r)))break e;e[i]=u,e[c]=r,i=c}}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,m=!1,p=!1,g=!1,A="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function y(e){for(var t=i(u);null!==t;){if(null===t.callback)n(u);else{if(!(t.startTime<=e))break;n(u),t.sortIndex=t.expirationTime,r(c,t)}t=i(u)}}function w(e){if(g=!1,y(e),!p)if(null!==i(c))p=!0,B(E);else{var t=i(u);null!==t&&L(w,t.startTime-e)}}function E(e,r){p=!1,g&&(g=!1,b(x),x=-1),m=!0;var a=f;try{for(y(r),d=i(c);null!==d&&(!(d.expirationTime>r)||e&&!C());){var s=d.callback;if("function"==typeof s){d.callback=null,f=d.priorityLevel;var o=s(d.expirationTime<=r);r=t.unstable_now(),"function"==typeof o?d.callback=o:d===i(c)&&n(c),y(r)}else n(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&L(w,h.startTime-r),l=!1}return l}finally{d=null,f=a,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,T=!1,S=null,x=-1,k=5,I=-1;function C(){return!(t.unstable_now()-I<k)}function P(){if(null!==S){var e=t.unstable_now();I=e;var r=!0;try{r=S(!0,e)}finally{r?_():(T=!1,S=null)}}else T=!1}if("function"==typeof v)_=function(){v(P)};else if("undefined"!=typeof MessageChannel){var M=new MessageChannel,R=M.port2;M.port1.onmessage=P,_=function(){R.postMessage(null)}}else _=function(){A(P,0)};function B(e){S=e,T||(T=!0,_())}function L(e,r){x=A((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||m||(p=!0,B(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,n,a){var s=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?s+a:s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:n,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,r(u,e),null===i(c)&&e===i(u)&&(g?(b(x),x=-1):g=!0,L(w,a-s))):(e.sortIndex=o,r(c,e),p||m||(p=!0,B(E))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},3840:(e,t,r)=>{"use strict";e.exports=r(53)},3988:e=>{"use strict";var t;t=function(){var e={},t={};return e.on=function(e,r){var i={name:e,handler:r};return t[e]=t[e]||[],t[e].unshift(i),i},e.off=function(e){var r=t[e.name].indexOf(e);-1!==r&&t[e.name].splice(r,1)},e.trigger=function(e,r){var i,n=t[e];if(n)for(i=n.length;i--;)n[i].handler(r)},e},e.exports=t},5754:e=>{"use strict";var t,r,i,n,a,s,o,l,c=(t="https://api.spotify.com/v1",r=null,i=null,n=function(e,t){return e.abort=t,e},a=function(){var e=Array.prototype.slice.call(arguments),t=e[0],r=e.slice(1);return t=t||{},r.forEach((function(e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})),t},s=function(e,t){var a=new XMLHttpRequest,s=function(i,n){var s=e.type||"GET";if(a.open(s,function(e,t){var r="";for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];r+=encodeURIComponent(i)+"="+encodeURIComponent(n)+"&"}return r.length>0&&(e=e+"?"+(r=r.substring(0,r.length-1))),e}(e.url,e.params)),r&&a.setRequestHeader("Authorization","Bearer "+r),a.onreadystatechange=function(){if(4===a.readyState){var e=null;try{e=a.responseText?JSON.parse(a.responseText):""}catch(e){console.error(e)}a.status>=200&&a.status<300?function(e){i&&i(e),t&&t(null,e)}(e):(n&&n(a),t&&t(a,null))}},"GET"===s)a.send(null);else{var o=null;e.postData&&("image/jpeg"===e.contentType?(o=e.postData,a.setRequestHeader("Content-Type",e.contentType)):(o=JSON.stringify(e.postData),a.setRequestHeader("Content-Type","application/json"))),a.send(o)}};return t?(s(),null):function(e,t){var r;if(null!==i){var s=i.defer();e((function(e){s.resolve(e)}),(function(e){s.reject(e)})),r=s.promise}else window.Promise&&(r=new window.Promise(e));return r?new n(r,(function(){a.abort()})):null}(s)},o=function(e,t,r,i){var n={},o=null;return"object"==typeof t?(n=t,o=r):"function"==typeof t&&(o=t),"GET"!==(e.type||"GET")&&e.postData&&!i?e.postData=a(e.postData,n):e.params=a(e.params,n),s(e,o)},((l=function(){}).prototype={constructor:c}).getGeneric=function(e,t){return o({url:e},t)},l.prototype.getMe=function(e,r){return o({url:t+"/me"},e,r)},l.prototype.getMySavedTracks=function(e,r){return o({url:t+"/me/tracks"},e,r)},l.prototype.addToMySavedTracks=function(e,r,i){return o({url:t+"/me/tracks",type:"PUT",postData:e},r,i)},l.prototype.removeFromMySavedTracks=function(e,r,i){return o({url:t+"/me/tracks",type:"DELETE",postData:e},r,i)},l.prototype.containsMySavedTracks=function(e,r,i){var n={url:t+"/me/tracks/contains",params:{ids:e.join(",")}};return o(n,r,i)},l.prototype.getMySavedAlbums=function(e,r){return o({url:t+"/me/albums"},e,r)},l.prototype.addToMySavedAlbums=function(e,r,i){return o({url:t+"/me/albums",type:"PUT",postData:e},r,i)},l.prototype.removeFromMySavedAlbums=function(e,r,i){return o({url:t+"/me/albums",type:"DELETE",postData:e},r,i)},l.prototype.containsMySavedAlbums=function(e,r,i){var n={url:t+"/me/albums/contains",params:{ids:e.join(",")}};return o(n,r,i)},l.prototype.getMyTopArtists=function(e,r){return o({url:t+"/me/top/artists"},e,r)},l.prototype.getMyTopTracks=function(e,r){return o({url:t+"/me/top/tracks"},e,r)},l.prototype.getMyRecentlyPlayedTracks=function(e,r){return o({url:t+"/me/player/recently-played"},e,r)},l.prototype.followUsers=function(e,r){var i={url:t+"/me/following/",type:"PUT",params:{ids:e.join(","),type:"user"}};return o(i,r)},l.prototype.followArtists=function(e,r){var i={url:t+"/me/following/",type:"PUT",params:{ids:e.join(","),type:"artist"}};return o(i,r)},l.prototype.followPlaylist=function(e,r,i){return o({url:t+"/playlists/"+e+"/followers",type:"PUT",postData:{}},r,i)},l.prototype.unfollowUsers=function(e,r){var i={url:t+"/me/following/",type:"DELETE",params:{ids:e.join(","),type:"user"}};return o(i,r)},l.prototype.unfollowArtists=function(e,r){var i={url:t+"/me/following/",type:"DELETE",params:{ids:e.join(","),type:"artist"}};return o(i,r)},l.prototype.unfollowPlaylist=function(e,r){return o({url:t+"/playlists/"+e+"/followers",type:"DELETE"},r)},l.prototype.isFollowingUsers=function(e,r){var i={url:t+"/me/following/contains",type:"GET",params:{ids:e.join(","),type:"user"}};return o(i,r)},l.prototype.isFollowingArtists=function(e,r){var i={url:t+"/me/following/contains",type:"GET",params:{ids:e.join(","),type:"artist"}};return o(i,r)},l.prototype.areFollowingPlaylist=function(e,r,i){var n={url:t+"/playlists/"+e+"/followers/contains",type:"GET",params:{ids:r.join(",")}};return o(n,i)},l.prototype.getFollowedArtists=function(e,r){return o({url:t+"/me/following",type:"GET",params:{type:"artist"}},e,r)},l.prototype.getUser=function(e,r,i){var n={url:t+"/users/"+encodeURIComponent(e)};return o(n,r,i)},l.prototype.getUserPlaylists=function(e,r,i){var n;return"string"==typeof e?n={url:t+"/users/"+encodeURIComponent(e)+"/playlists"}:(n={url:t+"/me/playlists"},i=r,r=e),o(n,r,i)},l.prototype.getPlaylist=function(e,r,i){return o({url:t+"/playlists/"+e},r,i)},l.prototype.getPlaylistTracks=function(e,r,i){return o({url:t+"/playlists/"+e+"/tracks"},r,i)},l.prototype.getPlaylistCoverImage=function(e,r){return o({url:t+"/playlists/"+e+"/images"},r)},l.prototype.createPlaylist=function(e,r,i){var n={url:t+"/users/"+encodeURIComponent(e)+"/playlists",type:"POST",postData:r};return o(n,r,i)},l.prototype.changePlaylistDetails=function(e,r,i){return o({url:t+"/playlists/"+e,type:"PUT",postData:r},r,i)},l.prototype.addTracksToPlaylist=function(e,r,i,n){return o({url:t+"/playlists/"+e+"/tracks",type:"POST",postData:{uris:r}},i,n,!0)},l.prototype.replaceTracksInPlaylist=function(e,r,i){return o({url:t+"/playlists/"+e+"/tracks",type:"PUT",postData:{uris:r}},{},i)},l.prototype.reorderTracksInPlaylist=function(e,r,i,n,a){return o({url:t+"/playlists/"+e+"/tracks",type:"PUT",postData:{range_start:r,insert_before:i}},n,a)},l.prototype.removeTracksFromPlaylist=function(e,r,i){var n=r.map((function(e){return"string"==typeof e?{uri:e}:e}));return o({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{tracks:n}},{},i)},l.prototype.removeTracksFromPlaylistWithSnapshotId=function(e,r,i,n){var a=r.map((function(e){return"string"==typeof e?{uri:e}:e}));return o({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{tracks:a,snapshot_id:i}},{},n)},l.prototype.removeTracksFromPlaylistInPositions=function(e,r,i,n){return o({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{positions:r,snapshot_id:i}},{},n)},l.prototype.uploadCustomPlaylistCoverImage=function(e,r,i){var n={url:t+"/playlists/"+e+"/images",type:"PUT",postData:r.replace(/^data:image\/jpeg;base64,/,""),contentType:"image/jpeg"};return o(n,{},i)},l.prototype.getAlbum=function(e,r,i){return o({url:t+"/albums/"+e},r,i)},l.prototype.getAlbumTracks=function(e,r,i){return o({url:t+"/albums/"+e+"/tracks"},r,i)},l.prototype.getAlbums=function(e,r,i){var n={url:t+"/albums/",params:{ids:e.join(",")}};return o(n,r,i)},l.prototype.getTrack=function(e,r,i){var n={};return n.url=t+"/tracks/"+e,o(n,r,i)},l.prototype.getTracks=function(e,r,i){var n={url:t+"/tracks/",params:{ids:e.join(",")}};return o(n,r,i)},l.prototype.getArtist=function(e,r,i){return o({url:t+"/artists/"+e},r,i)},l.prototype.getArtists=function(e,r,i){var n={url:t+"/artists/",params:{ids:e.join(",")}};return o(n,r,i)},l.prototype.getArtistAlbums=function(e,r,i){return o({url:t+"/artists/"+e+"/albums"},r,i)},l.prototype.getArtistTopTracks=function(e,r,i,n){return o({url:t+"/artists/"+e+"/top-tracks",params:{country:r}},i,n)},l.prototype.getArtistRelatedArtists=function(e,r,i){return o({url:t+"/artists/"+e+"/related-artists"},r,i)},l.prototype.getFeaturedPlaylists=function(e,r){return o({url:t+"/browse/featured-playlists"},e,r)},l.prototype.getNewReleases=function(e,r){return o({url:t+"/browse/new-releases"},e,r)},l.prototype.getCategories=function(e,r){return o({url:t+"/browse/categories"},e,r)},l.prototype.getCategory=function(e,r,i){return o({url:t+"/browse/categories/"+e},r,i)},l.prototype.getCategoryPlaylists=function(e,r,i){return o({url:t+"/browse/categories/"+e+"/playlists"},r,i)},l.prototype.search=function(e,r,i,n){var a={url:t+"/search/",params:{q:e,type:r.join(",")}};return o(a,i,n)},l.prototype.searchAlbums=function(e,t,r){return this.search(e,["album"],t,r)},l.prototype.searchArtists=function(e,t,r){return this.search(e,["artist"],t,r)},l.prototype.searchTracks=function(e,t,r){return this.search(e,["track"],t,r)},l.prototype.searchPlaylists=function(e,t,r){return this.search(e,["playlist"],t,r)},l.prototype.searchShows=function(e,t,r){return this.search(e,["show"],t,r)},l.prototype.searchEpisodes=function(e,t,r){return this.search(e,["episode"],t,r)},l.prototype.getAudioFeaturesForTrack=function(e,r){var i={};return i.url=t+"/audio-features/"+e,o(i,{},r)},l.prototype.getAudioFeaturesForTracks=function(e,r){return o({url:t+"/audio-features",params:{ids:e}},{},r)},l.prototype.getAudioAnalysisForTrack=function(e,r){var i={};return i.url=t+"/audio-analysis/"+e,o(i,{},r)},l.prototype.getRecommendations=function(e,r){return o({url:t+"/recommendations"},e,r)},l.prototype.getAvailableGenreSeeds=function(e){return o({url:t+"/recommendations/available-genre-seeds"},{},e)},l.prototype.getMyDevices=function(e){return o({url:t+"/me/player/devices"},{},e)},l.prototype.getMyCurrentPlaybackState=function(e,r){return o({url:t+"/me/player"},e,r)},l.prototype.getMyCurrentPlayingTrack=function(e,r){return o({url:t+"/me/player/currently-playing"},e,r)},l.prototype.transferMyPlayback=function(e,r,i){var n=r||{};return n.device_ids=e,o({type:"PUT",url:t+"/me/player",postData:n},r,i)},l.prototype.play=function(e,r){var i="device_id"in(e=e||{})?{device_id:e.device_id}:null,n={};return["context_uri","uris","offset","position_ms"].forEach((function(t){t in e&&(n[t]=e[t])})),o({type:"PUT",url:t+"/me/player/play",params:i,postData:n},"function"==typeof e?e:{},r)},l.prototype.queue=function(e,r,i){var n="device_id"in(r=r||{})?{uri:e,device_id:r.device_id}:{uri:e};return o({type:"POST",url:t+"/me/player/queue",params:n},r,i)},l.prototype.pause=function(e,r){var i="device_id"in(e=e||{})?{device_id:e.device_id}:null;return o({type:"PUT",url:t+"/me/player/pause",params:i},e,r)},l.prototype.skipToNext=function(e,r){var i="device_id"in(e=e||{})?{device_id:e.device_id}:null;return o({type:"POST",url:t+"/me/player/next",params:i},e,r)},l.prototype.skipToPrevious=function(e,r){var i="device_id"in(e=e||{})?{device_id:e.device_id}:null;return o({type:"POST",url:t+"/me/player/previous",params:i},e,r)},l.prototype.seek=function(e,r,i){var n={position_ms:e};return"device_id"in(r=r||{})&&(n.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/seek",params:n},r,i)},l.prototype.setRepeat=function(e,r,i){var n={state:e};return"device_id"in(r=r||{})&&(n.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/repeat",params:n},r,i)},l.prototype.setVolume=function(e,r,i){var n={volume_percent:e};return"device_id"in(r=r||{})&&(n.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/volume",params:n},r,i)},l.prototype.setShuffle=function(e,r,i){var n={state:e};return"device_id"in(r=r||{})&&(n.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/shuffle",params:n},r,i)},l.prototype.getShow=function(e,r,i){var n={};return n.url=t+"/shows/"+e,o(n,r,i)},l.prototype.getShows=function(e,r,i){var n={url:t+"/shows/",params:{ids:e.join(",")}};return o(n,r,i)},l.prototype.getMySavedShows=function(e,r){return o({url:t+"/me/shows"},e,r)},l.prototype.addToMySavedShows=function(e,r,i){return o({url:t+"/me/shows",type:"PUT",postData:e},r,i)},l.prototype.removeFromMySavedShows=function(e,r,i){return o({url:t+"/me/shows",type:"DELETE",postData:e},r,i)},l.prototype.containsMySavedShows=function(e,r,i){var n={url:t+"/me/shows/contains",params:{ids:e.join(",")}};return o(n,r,i)},l.prototype.getShowEpisodes=function(e,r,i){return o({url:t+"/shows/"+e+"/episodes"},r,i)},l.prototype.getEpisode=function(e,r,i){var n={};return n.url=t+"/episodes/"+e,o(n,r,i)},l.prototype.getEpisodes=function(e,r,i){var n={url:t+"/episodes/",params:{ids:e.join(",")}};return o(n,r,i)},l.prototype.getAccessToken=function(){return r},l.prototype.setAccessToken=function(e){r=e},l.prototype.setPromiseImplementation=function(e){var t=!1;try{var r=new e((function(e){e()}));"function"==typeof r.then&&"function"==typeof r.catch&&(t=!0)}catch(e){console.error(e)}if(!t)throw new Error("Unsupported implementation of Promises/A+");i=e},l);"object"==typeof e.exports&&(e.exports=c)},2553:(e,t,r)=>{"use strict";var i=r(9509).Buffer,n=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===n||!n(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=u,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function u(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.s=a,a.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},a.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var n=s(t[i]);return n>=0?(n>0&&(e.lastNeed=n-1),n):--i<r||-2===n?0:(n=s(t[i]))>=0?(n>0&&(e.lastNeed=n-2),n):--i<r||-2===n?0:(n=s(t[i]))>=0?(n>0&&(2===n?n=0:e.lastNeed=n-3),n):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},842:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractTokenizer=void 0;const n=r(5167);t.AbstractTokenizer=class{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=e||{}}async readToken(e,t=this.position){const r=i.alloc(e.len);if(await this.readBuffer(r,{position:t})<e.len)throw new n.EndOfStreamError;return e.get(r,0)}async peekToken(e,t=this.position){const r=i.alloc(e.len);if(await this.peekBuffer(r,{position:t})<e.len)throw new n.EndOfStreamError;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new n.EndOfStreamError;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new n.EndOfStreamError;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){const t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){}normalizeOptions(e,t){if(t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return t?{mayBeLess:!0===t.mayBeLess,offset:t.offset?t.offset:0,length:t.length?t.length:e.length-(t.offset?t.offset:0),position:t.position?t.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}},778:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferTokenizer=void 0;const i=r(5167),n=r(842);class a extends n.AbstractTokenizer{constructor(e,t){super(t),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,t){if(t&&t.position){if(t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=t.position}const r=await this.peekBuffer(e,t);return this.position+=r,r}async peekBuffer(e,t){const r=this.normalizeOptions(e,t),n=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&n<r.length)throw new i.EndOfStreamError;return e.set(this.uint8Array.subarray(r.position,r.position+n),r.offset),n}async close(){}}t.BufferTokenizer=a},599:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadStreamTokenizer=void 0;const i=r(842),n=r(5167);class a extends i.AbstractTokenizer{constructor(e,t){super(t),this.streamReader=new n.StreamReader(e)}async getFileInfo(){return this.fileInfo}async readBuffer(e,t){const r=this.normalizeOptions(e,t),i=r.position-this.position;if(i>0)return await this.ignore(i),this.readBuffer(e,t);if(i<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(0===r.length)return 0;const a=await this.streamReader.read(e,r.offset,r.length);if(this.position+=a,(!t||!t.mayBeLess)&&a<r.length)throw new n.EndOfStreamError;return a}async peekBuffer(e,t){const r=this.normalizeOptions(e,t);let i=0;if(r.position){const t=r.position-this.position;if(t>0){const n=new Uint8Array(r.length+t);return i=await this.peekBuffer(n,{mayBeLess:r.mayBeLess}),e.set(n.subarray(t),r.offset),i-t}if(t<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{i=await this.streamReader.peek(e,r.offset,r.length)}catch(e){if(t&&t.mayBeLess&&e instanceof n.EndOfStreamError)return 0;throw e}if(!r.mayBeLess&&i<r.length)throw new n.EndOfStreamError}return i}async ignore(e){const t=Math.min(256e3,e),r=new Uint8Array(t);let i=0;for(;i<e;){const n=e-i,a=await this.readBuffer(r,{length:Math.min(t,n)});if(a<0)return a;i+=a}return i}}t.ReadStreamTokenizer=a},5849:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromBuffer=t.fromStream=t.EndOfStreamError=void 0;const i=r(599),n=r(778);var a=r(5167);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return a.EndOfStreamError}}),t.fromStream=function(e,t){return t=t||{},new i.ReadStreamTokenizer(e,t)},t.fromBuffer=function(e,t){return new n.BufferTokenizer(e,t)}},3416:(e,t,r)=>{"use strict";var i=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AnsiStringType=t.StringType=t.BufferType=t.Uint8ArrayType=t.IgnoreType=t.Float80_LE=t.Float80_BE=t.Float64_LE=t.Float64_BE=t.Float32_LE=t.Float32_BE=t.Float16_LE=t.Float16_BE=t.INT64_BE=t.UINT64_BE=t.INT64_LE=t.UINT64_LE=t.INT32_LE=t.INT32_BE=t.INT24_BE=t.INT24_LE=t.INT16_LE=t.INT16_BE=t.INT8=t.UINT32_BE=t.UINT32_LE=t.UINT24_BE=t.UINT24_LE=t.UINT16_BE=t.UINT16_LE=t.UINT8=void 0;const n=r(645);function a(e){return new DataView(e.buffer,e.byteOffset)}t.UINT8={len:1,get:(e,t)=>a(e).getUint8(t),put:(e,t,r)=>(a(e).setUint8(t,r),t+1)},t.UINT16_LE={len:2,get:(e,t)=>a(e).getUint16(t,!0),put:(e,t,r)=>(a(e).setUint16(t,r,!0),t+2)},t.UINT16_BE={len:2,get:(e,t)=>a(e).getUint16(t),put:(e,t,r)=>(a(e).setUint16(t,r),t+2)},t.UINT24_LE={len:3,get(e,t){const r=a(e);return r.getUint8(t)+(r.getUint16(t+1,!0)<<8)},put(e,t,r){const i=a(e);return i.setUint8(t,255&r),i.setUint16(t+1,r>>8,!0),t+3}},t.UINT24_BE={len:3,get(e,t){const r=a(e);return(r.getUint16(t)<<8)+r.getUint8(t+2)},put(e,t,r){const i=a(e);return i.setUint16(t,r>>8),i.setUint8(t+2,255&r),t+3}},t.UINT32_LE={len:4,get:(e,t)=>a(e).getUint32(t,!0),put:(e,t,r)=>(a(e).setUint32(t,r,!0),t+4)},t.UINT32_BE={len:4,get:(e,t)=>a(e).getUint32(t),put:(e,t,r)=>(a(e).setUint32(t,r),t+4)},t.INT8={len:1,get:(e,t)=>a(e).getInt8(t),put:(e,t,r)=>(a(e).setInt8(t,r),t+1)},t.INT16_BE={len:2,get:(e,t)=>a(e).getInt16(t),put:(e,t,r)=>(a(e).setInt16(t,r),t+2)},t.INT16_LE={len:2,get:(e,t)=>a(e).getInt16(t,!0),put:(e,t,r)=>(a(e).setInt16(t,r,!0),t+2)},t.INT24_LE={len:3,get(e,r){const i=t.UINT24_LE.get(e,r);return i>8388607?i-16777216:i},put(e,t,r){const i=a(e);return i.setUint8(t,255&r),i.setUint16(t+1,r>>8,!0),t+3}},t.INT24_BE={len:3,get(e,r){const i=t.UINT24_BE.get(e,r);return i>8388607?i-16777216:i},put(e,t,r){const i=a(e);return i.setUint16(t,r>>8),i.setUint8(t+2,255&r),t+3}},t.INT32_BE={len:4,get:(e,t)=>a(e).getInt32(t),put:(e,t,r)=>(a(e).setInt32(t,r),t+4)},t.INT32_LE={len:4,get:(e,t)=>a(e).getInt32(t,!0),put:(e,t,r)=>(a(e).setInt32(t,r,!0),t+4)},t.UINT64_LE={len:8,get:(e,t)=>a(e).getBigUint64(t,!0),put:(e,t,r)=>(a(e).setBigUint64(t,r,!0),t+8)},t.INT64_LE={len:8,get:(e,t)=>a(e).getBigInt64(t,!0),put:(e,t,r)=>(a(e).setBigInt64(t,r,!0),t+8)},t.UINT64_BE={len:8,get:(e,t)=>a(e).getBigUint64(t),put:(e,t,r)=>(a(e).setBigUint64(t,r),t+8)},t.INT64_BE={len:8,get:(e,t)=>a(e).getBigInt64(t),put:(e,t,r)=>(a(e).setBigInt64(t,r),t+8)},t.Float16_BE={len:2,get(e,t){return n.read(e,t,!1,10,this.len)},put(e,t,r){return n.write(e,r,t,!1,10,this.len),t+this.len}},t.Float16_LE={len:2,get(e,t){return n.read(e,t,!0,10,this.len)},put(e,t,r){return n.write(e,r,t,!0,10,this.len),t+this.len}},t.Float32_BE={len:4,get:(e,t)=>a(e).getFloat32(t),put:(e,t,r)=>(a(e).setFloat32(t,r),t+4)},t.Float32_LE={len:4,get:(e,t)=>a(e).getFloat32(t,!0),put:(e,t,r)=>(a(e).setFloat32(t,r,!0),t+4)},t.Float64_BE={len:8,get:(e,t)=>a(e).getFloat64(t),put:(e,t,r)=>(a(e).setFloat64(t,r),t+8)},t.Float64_LE={len:8,get:(e,t)=>a(e).getFloat64(t,!0),put:(e,t,r)=>(a(e).setFloat64(t,r,!0),t+8)},t.Float80_BE={len:10,get(e,t){return n.read(e,t,!1,63,this.len)},put(e,t,r){return n.write(e,r,t,!1,63,this.len),t+this.len}},t.Float80_LE={len:10,get(e,t){return n.read(e,t,!0,63,this.len)},put(e,t,r){return n.write(e,r,t,!0,63,this.len),t+this.len}},t.IgnoreType=class{constructor(e){this.len=e}get(e,t){}},t.Uint8ArrayType=class{constructor(e){this.len=e}get(e,t){return e.subarray(t,t+this.len)}},t.BufferType=class{constructor(e){this.len=e}get(e,t){return i.from(e.subarray(t,t+this.len))}},t.StringType=class{constructor(e,t){this.len=e,this.encoding=t}get(e,t){return i.from(e).toString(this.encoding,t,t+this.len)}};class s{constructor(e){this.len=e}static decode(e,t,r){let i="";for(let n=t;n<r;++n)i+=s.codePointToString(s.singleByteDecoder(e[n]));return i}static inRange(e,t,r){return t<=e&&e<=r}static codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}static singleByteDecoder(e){if(s.inRange(e,0,127))return e;const t=s.windows1252[e-128];if(null===t)throw Error("invaliding encoding");return t}get(e,t=0){return s.decode(e,t,t+this.len)}}t.AnsiStringType=s,s.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},4927:(e,t,r)=>{function i(e){try{if(!r.g.localStorage)return!1}catch(e){return!1}var t=r.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(i("noDeprecation"))return e;var r=!1;return function(){if(!r){if(i("throwDeprecation"))throw new Error(t);i("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}},6006:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,n=(i=r(2275))&&i.__esModule?i:{default:i};t.default={pauseVideo:{acceptableStates:[n.default.ENDED,n.default.PAUSED],stateChangeRequired:!1},playVideo:{acceptableStates:[n.default.ENDED,n.default.PLAYING],stateChangeRequired:!1},seekTo:{acceptableStates:[n.default.ENDED,n.default.PLAYING,n.default.PAUSED],stateChangeRequired:!0,timeout:3e3}},e.exports=t.default},9125:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(r(9215)),n=o(r(8255)),a=o(r(5279)),s=o(r(6006));function o(e){return e&&e.__esModule?e:{default:e}}var l=(0,i.default)("youtube-player"),c={proxyEvents:function(e){var t={},r=function(r){var i="on"+r.slice(0,1).toUpperCase()+r.slice(1);t[i]=function(t){l('event "%s"',i,t),e.trigger(r,t)}},i=!0,n=!1,s=void 0;try{for(var o,c=a.default[Symbol.iterator]();!(i=(o=c.next()).done);i=!0)r(o.value)}catch(e){n=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(n)throw s}}return t},promisifyPlayer:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={},i=function(i){t&&s.default[i]?r[i]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.then((function(e){var t=s.default[i],n=e.getPlayerState(),a=e[i].apply(e,r);return t.stateChangeRequired||Array.isArray(t.acceptableStates)&&-1===t.acceptableStates.indexOf(n)?new Promise((function(r){e.addEventListener("onStateChange",(function i(){var n=e.getPlayerState(),a=void 0;"number"==typeof t.timeout&&(a=setTimeout((function(){e.removeEventListener("onStateChange",i),r()}),t.timeout)),Array.isArray(t.acceptableStates)&&-1!==t.acceptableStates.indexOf(n)&&(e.removeEventListener("onStateChange",i),clearTimeout(a),r())}))})).then((function(){return a})):a}))}:r[i]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.then((function(e){return e[i].apply(e,r)}))}},a=!0,o=!1,l=void 0;try{for(var c,u=n.default[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var h=c.value;i(h)}}catch(e){o=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(o)throw l}}return r}};t.default=c,e.exports=t.default},2275:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={BUFFERING:3,ENDED:0,PAUSED:2,PLAYING:1,UNSTARTED:-1,VIDEO_CUED:5},e.exports=t.default},5279:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["ready","stateChange","playbackQualityChange","playbackRateChange","error","apiChange","volumeChange"],e.exports=t.default},8255:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["cueVideoById","loadVideoById","cueVideoByUrl","loadVideoByUrl","playVideo","pauseVideo","stopVideo","getVideoLoadedFraction","cuePlaylist","loadPlaylist","nextVideo","previousVideo","playVideoAt","setShuffle","setLoop","getPlaylist","getPlaylistIndex","setOption","mute","unMute","isMuted","setVolume","getVolume","seekTo","getPlayerState","getPlaybackRate","setPlaybackRate","getAvailablePlaybackRates","getPlaybackQuality","setPlaybackQuality","getAvailableQualityLevels","getCurrentTime","getDuration","removeEventListener","getVideoUrl","getVideoEmbedCode","getOptions","getOption","addEventListener","destroy","setSize","getIframe"],e.exports=t.default},1062:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=o(r(3988)),a=o(r(5900)),s=o(r(9125));function o(e){return e&&e.__esModule?e:{default:e}}var l=void 0;t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,n.default)();if(l||(l=(0,a.default)(o)),t.events)throw new Error("Event handlers cannot be overwritten.");if("string"==typeof e&&!document.getElementById(e))throw new Error('Element "'+e+'" does not exist.');t.events=s.default.proxyEvents(o);var c=new Promise((function(r){"object"===(void 0===e?"undefined":i(e))&&e.playVideo instanceof Function?r(e):l.then((function(i){var n=new i.Player(e,t);return o.on("ready",(function(){r(n)})),null}))})),u=s.default.promisifyPlayer(c,r);return u.on=o.on,u.off=o.off,u},e.exports=t.default},5900:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,n=(i=r(9090))&&i.__esModule?i:{default:i};t.default=function(e){return new Promise((function(t){if(window.YT&&window.YT.Player&&window.YT.Player instanceof Function)t(window.YT);else{var r="http:"===window.location.protocol?"http:":"https:";(0,n.default)(r+"//www.youtube.com/iframe_api",(function(t){t&&e.trigger("error",t)}));var i=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=function(){i&&i(),t(window.YT)}}}))},e.exports=t.default},9215:(e,t,r)=>{var i=r(4155);function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG),e}(t=e.exports=r(5046)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var i="color: "+this.color;e.splice(1,0,i,"color: inherit");var n=0,a=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(a=n))})),e.splice(a,0,i)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())},5046:(e,t,r)=>{var i;function n(e){function r(){if(r.enabled){var e=r,n=+new Date,a=n-(i||n);e.diff=a,e.prev=i,e.curr=n,i=n;for(var s=new Array(arguments.length),o=0;o<s.length;o++)s[o]=arguments[o];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var l=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(r,i){if("%%"===r)return r;l++;var n=t.formatters[i];if("function"==typeof n){var a=s[l];r=n.call(e,a),s.splice(l,1),l--}return r})),t.formatArgs.call(e,s);var c=r.log||t.log||console.log.bind(console);c.apply(e,s)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,i=0;for(r in e)i=(i<<5)-i+e.charCodeAt(r),i|=0;return t.colors[Math.abs(i)%t.colors.length]}(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length,n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,i;for(r=0,i=t.skips.length;r<i;r++)if(t.skips[r].test(e))return!1;for(r=0,i=t.names.length;r<i;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(4680),t.names=[],t.skips=[],t.formatters={}},4680:e=>{var t=1e3,r=60*t,i=60*r,n=24*i;function a(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,s){s=s||{};var o,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*n;case"hours":case"hour":case"hrs":case"hr":case"h":return s*i;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===l&&!1===isNaN(e))return s.long?a(o=e,n,"day")||a(o,i,"hour")||a(o,r,"minute")||a(o,t,"second")||o+" ms":function(e){return e>=n?Math.round(e/n)+"d":e>=i?Math.round(e/i)+"h":e>=r?Math.round(e/r)+"m":e>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},9283:()=>{},3838:()=>{}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(7294),t=__webpack_require__(745);class r{constructor(e,t=localStorage){this.storage=t,this.id=`ampcast/${e}`}getItem(e){return this.storage.getItem(`${this.id}/${e}`)}setItem(e,t){this.storage.setItem(`${this.id}/${e}`,null!=t?t:"")}removeItem(e){this.storage.removeItem(`${this.id}/${e}`)}clear(){const e=[];for(let t=0;t<this.storage.length;t++){const r=this.storage.key(t);(null==r?void 0:r.startsWith(`${this.id}/`))&&e.push(r)}e.forEach((e=>this.storage.removeItem(e)))}}const i=new r("layout"),n={get(e,t=0){const r=i.getItem(e);return Number(r)||t},set(e,t){i.setItem(e,String(Number(t)||0))}};function a(t,r){const i=(0,e.useRef)(r);(0,e.useEffect)((()=>{i.current=r}),[r]),(0,e.useLayoutEffect)((()=>{const e=t.current;if(e){const t=new ResizeObserver((()=>i.current()));return t.observe(e),()=>t.disconnect()}}),[t])}const s=document.createElement("div");function o(){const t=(0,e.useRef)(s),[r,i]=(0,e.useState)(0);return(0,e.useEffect)((()=>{s.parentElement||(document.body.append(s),i(l()))}),[]),a(t,(0,e.useCallback)((()=>i(l())),[])),r}function l(){return parseInt(getComputedStyle(s).fontSize,10)||16}function c({vertical:t,primary:r,size:i,children:n}){const a={};return r||(t?a.height=`${i}px`:a.width=`${i}px`),e.createElement("div",{className:"layout-pane layout-pane-"+(r?"primary":"secondary"),style:a},n)}function u({id:t,arrange:r="columns",primaryIndex:i=0,children:s}){const l=(0,e.useRef)(null),[u,h]=(0,e.useState)({width:0,height:0}),[d,f]=(0,e.useState)(0),[m,p]=(0,e.useState)(0),[g,A]=(0,e.useState)(0),[b,v]=(0,e.useState)((()=>t?n.get(t):0)),[y,w]=(0,e.useState)(-1),[E,_]=(0,e.useState)(0),T=-1!==y,S=o(),x="rows"===r;(0,e.useEffect)((()=>{t&&n.set(t,b)}),[t,b]),(0,e.useLayoutEffect)((()=>{var e;if(S>0){const t=l.current,r=x?"minHeight":"minWidth",i=t.querySelector(":scope > .layout-pane-primary");if(i){i.style[r]="";const e=parseInt(getComputedStyle(i)[r],10);i.style[r]="unset",f(e||80)}const n=t.querySelector(":scope > .layout-pane-secondary");if(n){n.style[r]="";const i=parseInt(getComputedStyle(n)[r],10);n.style[r]="unset",p(i||80);const a=x?"offsetHeight":"offsetWidth",s=t.querySelector(":scope > .layout-splitter");A(null!==(e=null==s?void 0:s[a])&&void 0!==e?e:4)}}}),[x,S]),(0,e.useLayoutEffect)((()=>{const e=x?u.height:u.width;if(e>0){const t=e-g-b;t<d?v(Math.max(b-(d-t),0)):b<m&&v(Math.min(e-g-d,m))}}),[x,u,d,m,g,b]);const k=(0,e.useCallback)((e=>{if(0===e.button){const t=x?e.screenY:e.screenX;w(t),_(b),e.preventDefault()}}),[x,b]),I=(0,e.useCallback)((e=>{const t=(x?e.screenY:e.screenX)-y;v(0===i?E-t:E+t)}),[x,i,y,E]),C=(0,e.useCallback)((()=>{w(-1),_(0)}),[]);return(0,e.useEffect)((()=>{if(T)return document.documentElement.style.cursor=x?"ns-resize":"ew-resize",document.body.classList.add("dragging"),document.addEventListener("mouseup",C),document.addEventListener("mousemove",I),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",C),document.removeEventListener("mousemove",I)}}),[x,T,I,C]),a(l,(0,e.useCallback)((()=>{const e=l.current;h({width:e.clientWidth,height:e.clientHeight})}),[])),e.createElement("div",{className:`splitter splitter-${r}`,id:t,ref:l},e.Children.toArray(s).slice(0,2).map(((t,r)=>{const n=r===i,a=n?0:b,s=[];return 1===r&&s.push(e.createElement("div",{className:"layout-splitter "+(T?"active":""),role:"separator",onMouseDown:k,key:"splitter"})),s.push(e.createElement(c,{vertical:x,primary:n,size:a,key:r},t)),s})))}s.style.cssText="\n    position: absolute;\n    pointer-events: none;\n    visibility: hidden;\n    font-size: 1rem;\n    width: 1rem;\n    height: 1rem;\n";var h=function(e,t){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},h(e,t)};function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function f(e,t){var r,i,n,a,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){s.label=a[1];break}if(6===a[0]&&s.label<n[1]){s.label=n[1],n=a;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(a);break}n[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return s}function g(e,t,r){if(r||2===arguments.length)for(var i,n=0,a=t.length;n<a;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function A(e){return this instanceof A?(this.v=e,this):new A(e)}function b(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),a=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){n[e]&&(i[e]=function(t){return new Promise((function(r,i){a.push([e,t,r,i])>1||o(e,t)}))})}function o(e,t){try{(r=n[e](t)).value instanceof A?Promise.resolve(r.value.v).then(l,c):u(a[0][2],r)}catch(e){u(a[0][3],e)}var r}function l(e){o("next",e)}function c(e){o("throw",e)}function u(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}}function v(e){return"function"==typeof e}function y(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Object.create,Object.create;var w=y((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function E(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var _=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,r,i,n;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var s=m(a),o=s.next();!o.done;o=s.next())o.value.remove(this)}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else a.remove(this);var l=this.initialTeardown;if(v(l))try{l()}catch(e){n=e instanceof w?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var u=m(c),h=u.next();!h.done;h=u.next()){var d=h.value;try{x(d)}catch(e){n=null!=n?n:[],e instanceof w?n=g(g([],p(n)),p(e.errors)):n.push(e)}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}if(n)throw new w(n)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)x(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&E(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&E(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}(),T=_.EMPTY;function S(e){return e instanceof _||e&&"closed"in e&&v(e.remove)&&v(e.add)&&v(e.unsubscribe)}function x(e){v(e)?e():e.unsubscribe()}var k=null,I=null,C=void 0,P=!1,M=!1,R={setTimeout:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=R.delegate;return(null==n?void 0:n.setTimeout)?n.setTimeout.apply(n,g([e,t],p(r))):setTimeout.apply(void 0,g([e,t],p(r)))},clearTimeout:function(e){var t=R.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function B(e){R.setTimeout((function(){if(!k)throw e;k(e)}))}function L(){}var D=N("C",void 0,void 0);function N(e,t,r){return{kind:e,value:t,error:r}}var F=null;function O(e){if(P){var t=!F;if(t&&(F={errorThrown:!1,error:null}),e(),t){var r=F,i=r.errorThrown,n=r.error;if(F=null,i)throw n}}else e()}var z=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,S(t)&&t.add(r)):r.destination=W,r}return d(t,e),t.create=function(e,t,r){return new Q(e,t,r)},t.prototype.next=function(e){this.isStopped?X(function(e){return N("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?X(N("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?X(D,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(_),U=Function.prototype.bind;function j(e,t){return U.call(e,t)}var V=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){q(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){q(e)}else q(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){q(e)}},e}(),Q=function(e){function t(t,r,i){var n,a,s=e.call(this)||this;return v(t)||!t?n={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=i?i:void 0}:s&&M?((a=Object.create(t)).unsubscribe=function(){return s.unsubscribe()},n={next:t.next&&j(t.next,a),error:t.error&&j(t.error,a),complete:t.complete&&j(t.complete,a)}):n=t,s.destination=new V(n),s}return d(t,e),t}(z);function q(e){var t;P?(t=e,P&&F&&(F.errorThrown=!0,F.error=t)):B(e)}function X(e,t){var r=I;r&&R.setTimeout((function(){return r(e,t)}))}var W={closed:!0,next:L,error:function(e){throw e},complete:L},H="function"==typeof Symbol&&Symbol.observable||"@@observable";function G(e){return e}function $(e){return 0===e.length?G:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Y=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var i,n=this,a=(i=e)&&i instanceof z||function(e){return e&&v(e.next)&&v(e.error)&&v(e.complete)}(i)&&S(i)?e:new Q(e,t,r);return O((function(){var e=n,t=e.operator,r=e.source;a.add(t?t.call(a,r):r?n._subscribe(a):n._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=K(t))((function(t,i){var n=new Q({next:function(t){try{e(t)}catch(e){i(e),n.unsubscribe()}},error:i,complete:t});r.subscribe(n)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[H]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return $(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=K(e))((function(e,r){var i;t.subscribe((function(e){return i=e}),(function(e){return r(e)}),(function(){return e(i)}))}))},e.create=function(t){return new e(t)},e}();function K(e){var t;return null!==(t=null!=e?e:C)&&void 0!==t?t:Promise}var J=y((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),Z=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return d(t,e),t.prototype.lift=function(e){var t=new ee(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new J},t.prototype.next=function(e){var t=this;O((function(){var r,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var n=m(t.currentObservers),a=n.next();!a.done;a=n.next())a.value.next(e)}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}}}))},t.prototype.error=function(e){var t=this;O((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}}))},t.prototype.complete=function(){var e=this;O((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=this,i=r.hasError,n=r.isStopped,a=r.observers;return i||n?T:(this.currentObservers=null,a.push(e),new _((function(){t.currentObservers=null,E(a,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,r=t.hasError,i=t.thrownError,n=t.isStopped;r?e.error(i):n&&e.complete()},t.prototype.asObservable=function(){var e=new Y;return e.source=this,e},t.create=function(e,t){return new ee(e,t)},t}(Y),ee=function(e){function t(t,r){var i=e.call(this)||this;return i.destination=t,i.source=r,i}return d(t,e),t.prototype.next=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)},t.prototype.error=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:T},t}(Z),te=function(e){function t(t){var r=e.call(this)||this;return r._value=t,r}return d(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},t.prototype.getValue=function(){var e=this,t=e.hasError,r=e.thrownError,i=e._value;if(t)throw r;return this._throwIfClosed(),i},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Z);const re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1H\nAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=";class ie{constructor(e="",t=!1,r=window.console){const i=e?` ${e}:`:"",n=(e,t)=>e&&t?`${e}/${t}`:t||e,a=(...t)=>{e.startsWith(ie.only)&&r.log(...t)};this.log=(...e)=>a(`##${i}`,...e),this.warn=(...e)=>a(`###${i}`,...e),this.error=t=>{e.startsWith(ie.only)&&(a(`####${i} ERROR`),r.error(t))},t&&(this.next=this.log,this.complete=()=>this.log("***complete***")),this.id=i=>new ie(n(e,i),t,r),this.all=t=>new ie(n(e,t),!0,r),this.only=()=>(ie.only=e,this)}}ie.only="";var ne=__webpack_require__(4155),ae=function(e,t,r){if(r||2===arguments.length)for(var i,n=0,a=t.length;n<a;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},se=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},oe=function(e,t,r,i){this.name=e,this.version=t,this.os=r,this.bot=i,this.type="bot-device"},le=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},ce=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ue=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],he=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function de(e){var t=function(e){return""!==e&&ue.reduce((function(t,r){var i=r[0],n=r[1];if(t)return t;var a=n.exec(e);return!!a&&[i,a]}),!1)}(e);if(!t)return null;var r=t[0],i=t[1];if("searchbot"===r)return new le;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<3&&(n=ae(ae([],n,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-n.length),!0)):n=[];var a=n.join("."),s=function(e){for(var t=0,r=he.length;t<r;t++){var i=he[t],n=i[0];if(i[1].exec(e))return n}return null}(e),o=ce.exec(e);return o&&o[1]?new oe(r,a,s,o[1]):new se(r,a,s)}const fe="undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}:"undefined"!=typeof navigator?de(navigator.userAgent):void 0!==ne&&ne.version?new function(e){this.version=e,this.type="node",this.name="node",this.os=ne.platform}(ne.version.slice(1)):null;const me=(null==fe?void 0:fe.name)||"unknown",pe=/^edge/.test(me)?"Microsoft Edge":me.replace(/^\w/,(e=>e.toUpperCase())),ge={name:me,displayName:pe,version:(null==fe?void 0:fe.version)||"0",os:(null==fe?void 0:fe.os)||"unknown"};function Ae(e){return null!=e}const be={};function ve(e){return t=this,r=void 0,n=function*(){if(!be[e])return new Promise(((t,r)=>{let i=document.querySelector(`script[src="${e}"]`);i||(i=document.createElement("script"),i.async=!0,i.src=e),i.addEventListener("load",(()=>{be[e]=!0,t()})),i.addEventListener("error",(()=>r(`Failed to load script: '${e}'`))),i.parentElement||document.head.appendChild(i)}))},new((i=void 0)||(i=Promise))((function(e,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,o)}l((n=n.apply(t,r||[])).next())}));var t,r,i,n}const ye={url:re,width:1,height:1};function we(e=[],t=360,r=1){if(0===e.length)return ye;e.sort(((e,t)=>t.width*t.height-e.width*e.height));const[i,n]=Ee(e,(e=>e.width<=t&&e.height<=t));return i.length>0?(i.sort(((e,t)=>{const i=e.width/e.height,n=Math.abs(i-r),a=t.width/t.height;return n-Math.abs(a-r)})),i[0]):n[n.length-1]||ye}function Ee(e,t){const r=[],i=[];for(const n of e)t(n)?r.push(n):i.push(n);return[r,i]}function _e(e){e.preventDefault()}function Te(e){e.stopPropagation()}function Se(e){return{itemType:e,src:"",title:""}}function xe(e,t,r=0){if(1===e.length)return e[0];const i=e[Math.floor(Math.random()*e.length)];return void 0!==t&&i===t&&r<3?xe(e,t,r++):i}var ke;!function(e){e[e.Media=0]="Media",e[e.Album=1]="Album",e[e.Artist=2]="Artist",e[e.Playlist=3]="Playlist"}(ke||(ke={}));const Ie=ke;function Ce(e){return e&&v(e.schedule)}function Pe(e){return e[e.length-1]}function Me(e){return v(Pe(e))?e.pop():void 0}function Re(e){return Ce(Pe(e))?e.pop():void 0}function Be(e,t){return"number"==typeof Pe(e)?e.pop():t}var Le=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function De(e){return v(null==e?void 0:e.then)}function Ne(e){return v(e[H])}function Fe(e){return Symbol.asyncIterator&&v(null==e?void 0:e[Symbol.asyncIterator])}function Oe(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var ze="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ue(e){return v(null==e?void 0:e[ze])}function je(e){return b(this,arguments,(function(){var t,r,i;return f(this,(function(n){switch(n.label){case 0:t=e.getReader(),n.label=1;case 1:n.trys.push([1,,9,10]),n.label=2;case 2:return[4,A(t.read())];case 3:return r=n.sent(),i=r.value,r.done?[4,A(void 0)]:[3,5];case 4:return[2,n.sent()];case 5:return[4,A(i)];case 6:return[4,n.sent()];case 7:return n.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function Ve(e){return v(null==e?void 0:e.getReader)}function Qe(e){if(e instanceof Y)return e;if(null!=e){if(Ne(e))return n=e,new Y((function(e){var t=n[H]();if(v(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(Le(e))return i=e,new Y((function(e){for(var t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()}));if(De(e))return r=e,new Y((function(e){r.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,B)}));if(Fe(e))return qe(e);if(Ue(e))return t=e,new Y((function(e){var r,i;try{for(var n=m(t),a=n.next();!a.done;a=n.next()){var s=a.value;if(e.next(s),e.closed)return}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}e.complete()}));if(Ve(e))return qe(je(e))}var t,r,i,n;throw Oe(e)}function qe(e){return new Y((function(t){(function(e,t){var r,i,n,a,s,o,l,c;return s=this,o=void 0,c=function(){var s,o;return f(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),r=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=m(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,n){!function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)}(i,n,(t=e[r](t)).done,t.value)}))}}}(e),l.label=1;case 1:return[4,r.next()];case 2:if((i=l.sent()).done)return[3,4];if(s=i.value,t.next(s),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),n={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),i&&!i.done&&(a=r.return)?[4,a.call(r)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(n)throw n.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((l=void 0)||(l=Promise))((function(e,t){function r(e){try{n(c.next(e))}catch(e){t(e)}}function i(e){try{n(c.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):(n=t.value,n instanceof l?n:new l((function(e){e(n)}))).then(r,i)}n((c=c.apply(s,o||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function Xe(e,t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=!1);var a=t.schedule((function(){r(),n?e.add(this.schedule(null,i)):this.unsubscribe()}),i);if(e.add(a),!n)return a}function We(e){return function(t){if(function(e){return v(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function He(e,t,r,i,n){return new Ge(e,t,r,i,n)}var Ge=function(e){function t(t,r,i,n,a,s){var o=e.call(this,t)||this;return o.onFinalize=a,o.shouldUnsubscribe=s,o._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,o._error=n?function(e){try{n(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,o._complete=i?function(){try{i()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,o}return d(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(z);function $e(e,t){return void 0===t&&(t=0),We((function(r,i){r.subscribe(He(i,(function(r){return Xe(i,e,(function(){return i.next(r)}),t)}),(function(){return Xe(i,e,(function(){return i.complete()}),t)}),(function(r){return Xe(i,e,(function(){return i.error(r)}),t)})))}))}function Ye(e,t){return void 0===t&&(t=0),We((function(r,i){i.add(e.schedule((function(){return r.subscribe(i)}),t))}))}function Ke(e,t){if(!e)throw new Error("Iterable cannot be null");return new Y((function(r){Xe(r,t,(function(){var i=e[Symbol.asyncIterator]();Xe(r,t,(function(){i.next().then((function(e){e.done?r.complete():r.next(e.value)}))}),0,!0)}))}))}function Je(e,t){return t?function(e,t){if(null!=e){if(Ne(e))return function(e,t){return Qe(e).pipe(Ye(t),$e(t))}(e,t);if(Le(e))return function(e,t){return new Y((function(r){var i=0;return t.schedule((function(){i===e.length?r.complete():(r.next(e[i++]),r.closed||this.schedule())}))}))}(e,t);if(De(e))return function(e,t){return Qe(e).pipe(Ye(t),$e(t))}(e,t);if(Fe(e))return Ke(e,t);if(Ue(e))return function(e,t){return new Y((function(r){var i;return Xe(r,t,(function(){i=e[ze](),Xe(r,t,(function(){var e,t,n;try{t=(e=i.next()).value,n=e.done}catch(e){return void r.error(e)}n?r.complete():r.next(t)}),0,!0)})),function(){return v(null==i?void 0:i.return)&&i.return()}}))}(e,t);if(Ve(e))return function(e,t){return Ke(je(e),t)}(e,t)}throw Oe(e)}(e,t):Qe(e)}function Ze(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Re(e);return Je(e,r)}var et=new Y((function(e){return e.complete()}));class tt{constructor(e=[]){this.items=e}get size(){return this.items.length}observeComplete(){return Ze(this.items)}observeItems(){return Ze(this.items)}observeSize(){return Ze(this.items.length)}observeMaxSize(){return Ze(this.items.length)}observeError(){return et}fetchAt(){}disconnect(){}}function rt(e,t){return void 0===t&&(t=G),e=null!=e?e:it,We((function(r,i){var n,a=!0;r.subscribe(He(i,(function(r){var s=t(r);!a&&e(n,s)||(a=!1,n=s,i.next(r))})))}))}function it(e,t){return e===t}function nt(e,t){return We((function(r,i){var n=0;r.subscribe(He(i,(function(r){i.next(e.call(t,r,n++))})))}))}const at="eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ijk3RjI2N1daRDkifQ.eyJpYXQiOjE2NTY3MDUwMjksImV4cCI6MTY3MjI1NzAyOSwiaXNzIjoiODM4Nk5ERlhMQiJ9.P6k3R2eCHfinKym779xE4i9Q2DUpb3k8p_cyhQkO9vIKe3qUKolpnIuJKLOstPw-OdAvuXZFsZMexhpbZyBztA".toString(),st="41bd731be5b78200d2bbaea2312b917b".toString(),ot="78aa93b641329f00e68cf1542356b8fc".toString(),lt="68c1c915728f4b9da193da1028692f0d".toString(),ct="AIzaSyD-cQaU5ntJBcCEBAbmK5pIXD4FQ19fdho".toString(),ut="364143070327-sgopc15lidje8uq4l16k1u8pqo2hpc4o.apps.googleusercontent.com".toString();var ht=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};console.log("module::appleAuth");const dt=new ie("appleAuth"),ft=new te("");function mt(){return ft.pipe(rt()).pipe(nt((e=>""!==e)),rt())}function pt(){return ht(this,void 0,void 0,(function*(){if(""===ft.getValue())try{const e=yield At(),t=yield e.authorize();dt.log("Access token successfully obtained."),ft.next(t)}catch(e){dt.log("Could not obtain access token."),dt.error(e)}}))}function gt(){return ht(this,void 0,void 0,(function*(){yield MusicKit.getInstance().unauthorize(),ft.next("")}))}function At(){return ht(this,void 0,void 0,(function*(){return window.MusicKit?MusicKit.getInstance():new Promise(((e,t)=>{ve("https://js-cdn.music.apple.com/musickit/v3/musickit.js").then(void 0,t),document.addEventListener("musickitloaded",(()=>{MusicKit.configure({developerToken:at,app:{name:"ampcast",build:"0.4.7"},sourceType:8,suppressErrorDialog:!0}).then(e,t)}))}))}))}const bt={observeIsLoggedIn:mt,login:pt,logout:gt};var vt;!function(){ht(this,void 0,void 0,(function*(){const e=yield At();if(e.isAuthorized){const t=yield e.authorize();dt.log("Access token successfully obtained."),ft.next(t)}}))}(),function(e){e[e.Audio=0]="Audio",e[e.Video=1]="Video"}(vt||(vt={}));const yt=vt;var wt=Array.isArray,Et=Object.getPrototypeOf,_t=Object.prototype,Tt=Object.keys;function St(e){if(1===e.length){var t=e[0];if(wt(t))return{args:t,keys:null};if((i=t)&&"object"==typeof i&&Et(i)===_t){var r=Tt(t);return{args:r.map((function(e){return t[e]})),keys:r}}}var i;return{args:e,keys:null}}var xt=Array.isArray;function kt(e){return nt((function(t){return function(e,t){return xt(t)?e.apply(void 0,g([],p(t))):e(t)}(e,t)}))}function It(e,t){return e.reduce((function(e,r,i){return e[r]=t[i],e}),{})}function Ct(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Re(e),i=Me(e),n=St(e),a=n.args,s=n.keys;if(0===a.length)return Je([],r);var o=new Y(Pt(a,r,s?function(e){return It(s,e)}:G));return i?o.pipe(kt(i)):o}function Pt(e,t,r){return void 0===r&&(r=G),function(i){Mt(t,(function(){for(var n=e.length,a=new Array(n),s=n,o=n,l=function(n){Mt(t,(function(){var l=Je(e[n],t),c=!1;l.subscribe(He(i,(function(e){a[n]=e,c||(c=!0,o--),o||i.next(r(a.slice()))}),(function(){--s||i.complete()})))}),i)},c=0;c<n;c++)l(c)}),i)}}function Mt(e,t,r){e?Xe(r,e,t):t()}function Rt(e,t,r){var i=v(e)||t||r?{next:e,error:t,complete:r}:e;return i?We((function(e,t){var r;null===(r=i.subscribe)||void 0===r||r.call(i);var n=!0;e.subscribe(He(t,(function(e){var r;null===(r=i.next)||void 0===r||r.call(i,e),t.next(e)}),(function(){var e;n=!1,null===(e=i.complete)||void 0===e||e.call(i),t.complete()}),(function(e){var r;n=!1,null===(r=i.error)||void 0===r||r.call(i,e),t.error(e)}),(function(){var e,t;n&&(null===(e=i.unsubscribe)||void 0===e||e.call(i)),null===(t=i.finalize)||void 0===t||t.call(i)})))})):G}function Bt(e,t,r){return void 0===r&&(r=1/0),v(t)?Bt((function(r,i){return nt((function(e,n){return t(r,e,i,n)}))(Qe(e(r,i)))}),r):("number"==typeof t&&(r=t),We((function(t,i){return function(e,t,r,i,n,a,s,o){var l=[],c=0,u=0,h=!1,d=function(){!h||l.length||c||t.complete()},f=function(e){return c<i?m(e):l.push(e)},m=function(e){c++;var n=!1;Qe(r(e,u++)).subscribe(He(t,(function(e){t.next(e)}),(function(){n=!0}),void 0,(function(){if(n)try{c--;for(;l.length&&c<i;)e=void 0,e=l.shift(),m(e);d()}catch(e){t.error(e)}var e})))};return e.subscribe(He(t,f,(function(){h=!0,d()}))),function(){}}(t,i,e,r)})))}function Lt(e){return We((function(t,r){var i,n=null,a=!1;n=t.subscribe(He(r,void 0,void 0,(function(s){i=Qe(e(s,Lt(e)(t))),n?(n.unsubscribe(),n=null,i.subscribe(r)):a=!0}))),a&&(n.unsubscribe(),n=null,i.subscribe(r))}))}function Dt(e){return We((function(t,r){Qe(e).subscribe(He(r,(function(){return r.complete()}),L)),!r.closed&&t.subscribe(r)}))}function Nt(e){return e<=0?function(){return et}:We((function(t,r){var i=0;t.subscribe(He(r,(function(t){++i<=e&&(r.next(t),e<=i&&r.complete())})))}))}function Ft(e,t){return We((function(r,i){var n=0;r.subscribe(He(i,(function(r){return e.call(t,r,n++)&&i.next(r)})))}))}function Ot(e,t){return We((function(r,i){var n=null,a=0,s=!1,o=function(){return s&&!n&&i.complete()};r.subscribe(He(i,(function(r){null==n||n.unsubscribe();var s=0,l=a++;Qe(e(r,l)).subscribe(n=He(i,(function(e){return i.next(t?t(r,e,l,s++):e)}),(function(){n=null,o()})))}),(function(){s=!0,o()})))}))}var zt={now:function(){return(zt.delegate||Date).now()},delegate:void 0},Ut=function(e){function t(t,r,i){void 0===t&&(t=1/0),void 0===r&&(r=1/0),void 0===i&&(i=zt);var n=e.call(this)||this;return n._bufferSize=t,n._windowTime=r,n._timestampProvider=i,n._buffer=[],n._infiniteTimeWindow=!0,n._infiniteTimeWindow=r===1/0,n._bufferSize=Math.max(1,t),n._windowTime=Math.max(1,r),n}return d(t,e),t.prototype.next=function(t){var r=this,i=r.isStopped,n=r._buffer,a=r._infiniteTimeWindow,s=r._timestampProvider,o=r._windowTime;i||(n.push(t),!a&&n.push(s.now()+o)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),r=this._infiniteTimeWindow,i=this._buffer.slice(),n=0;n<i.length&&!e.closed;n+=r?1:2)e.next(i[n]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,r=e._timestampProvider,i=e._buffer,n=e._infiniteTimeWindow,a=(n?1:2)*t;if(t<1/0&&a<i.length&&i.splice(0,i.length-a),!n){for(var s=r.now(),o=0,l=1;l<i.length&&i[l]<=s;l+=2)o=l;o&&i.splice(0,o+1)}},t}(Z);const jt=[],Vt=new ie("AbstractPager");let Qt=0;class qt{constructor(e){this.items$=new te(jt),this.size$=new Ut(1),this.maxSize$=new Ut(1),this.error$=new Ut(1),this.fetches$=new te({index:0,length:0}),this.disconnected=!1,this.config=Object.assign({},e),(null==e?void 0:e.maxSize)&&this.maxSize$.next(null==e?void 0:e.maxSize)}observeComplete(){return Ct([this.observeItems(),this.observeSize()]).pipe(Ft((([e,t])=>e.reduce((e=>e+1),0)===t)),nt((([e])=>e)),Nt(1))}observeItems(){return this.items$.pipe(Ft((e=>e!==jt)))}observeSize(){return this.size$.pipe(rt())}observeMaxSize(){return this.maxSize$.pipe(rt())}observeError(){return this.error$}disconnect(){this.disconnected||(this.disconnected=!0,this.subscriptions&&(this.subscriptions.unsubscribe(),Vt.log("Pager disconnected. connected pagers="+--Qt)),this.items.forEach((e=>{var t;return null===(t=e.pager)||void 0===t?void 0:t.disconnect()})),this.items$.complete(),this.size$.complete(),this.maxSize$.complete(),this.error$.complete())}fetchAt(e,t){if(this.disconnected)Vt.warn("disconnected");else{if(!this.subscriptions&&(this.createSubscriptions(),this.config.calculatePageSize)){const{minPageSize:e=10,maxPageSize:r=100}=this.config,i=10*Math.ceil(2*t/10);this.config.pageSize=Math.max(Math.min(i,r),e)}this.fetches$.next({index:e,length:t})}}get items(){return this.items$.getValue()}get maxSize(){var e,t;return null!==(t=null===(e=this.config)||void 0===e?void 0:e.maxSize)&&void 0!==t?t:1/0}createSubscriptions(){this.subscriptions||(Vt.log("Pager connected. connected pagers="+ ++Qt),this.subscriptions=new _,this.subscriptions.add(this.observeAdditions().pipe(Rt((e=>this.addPagerDecorations(e)))).subscribe(Vt)))}observeAdditions(){return this.items$.pipe(We((function(e,t){var r,i=!1;e.subscribe(He(t,(function(e){var n=r;r=e,i&&t.next([n,e]),i=!0})))})),nt((([e,t])=>t.filter((t=>!e.find((e=>e.src===t.src)))))))}addPagerDecorations(e){e.forEach((e=>{if(e.itemType===Ie.Playlist&&!e.trackCount&&e.pager){const t=e.src;this.subscriptions.add(e.pager.observeSize().pipe(Rt((e=>{const r=this.items.findIndex((e=>e.src===t));if(-1!==r){const t=this.items.slice(),i=t[r];t[r]=Object.assign(Object.assign({},i),{trackCount:e}),this.items$.next(t)}}))).subscribe(Vt))}}))}}const Xt=new ie("SequentialPager");class Wt extends qt{constructor(e,t){super(t),this.fetchNext=e,this.fetching$=new te(!1),this.emptyCount=0}createSubscriptions(){var e,t;this.subscriptions||(super.createSubscriptions(),this.subscriptions.add(this.observeShouldFetch().pipe(Rt((()=>this.fetching$.next(!0))),(e=()=>this.fetchNext(this.config.pageSize),v(t)?Bt(e,t,1):Bt(e,1)),Rt((e=>this.addPage(e))),Lt((e=>(Xt.error(e),this.error$.next(e),Ze(void 0)))),Rt((()=>this.fetching$.next(!1))),Dt(this.observeComplete()),Nt(100)).subscribe(Xt)))}observeShouldFetch(){const e=Ct([this.fetches$,this.items$]).pipe(nt((([{index:e,length:t},r])=>e+2*t>r.length)),Ft((e=>e)),nt((()=>{})),Nt(1));return this.fetching$.pipe(Ot((t=>t?et:e)))}addPage(e){const t=(e.items||[]).filter(Ae),r=this.items.concat(t).filter(((e,t,r)=>t===r.findIndex((t=>e.src===t.src))));r.length===this.items.length&&this.emptyCount++,r.length=Math.min(r.length,this.maxSize);const i=e.atEnd||r.length===this.maxSize||this.emptyCount>2?r.length:e.total;void 0!==i&&this.size$.next(i),this.items$.next(r)}}var Ht=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};class Gt{constructor(e,t,r){this.nextPageUrl=void 0,this.pager=new Wt((r=>Ht(this,void 0,void 0,(function*(){const i=yield this.fetchNext(this.nextPageUrl||e,r),n=t(i.data),a=this.createItems(n.items),s=n.total,o=!n.nextPageUrl;return this.nextPageUrl=n.nextPageUrl,{items:a,total:s,atEnd:o}}))),r)}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeMaxSize(){return this.pager.observeMaxSize()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}fetchNext(e,t){return Ht(this,void 0,void 0,(function*(){const r=MusicKit.getInstance();return t&&!/[?&]limit=/.test(e)&&(e=`${e}${e.includes("?")?"&":"?"}limit=${t}`),r.api.music(e)}))}createItems(e){return e.map((e=>this.createItem(e)))}createItem(e){switch(e.type){case"playlists":case"library-playlists":return this.createMediaPlaylist(e);case"artists":case"library-artists":return this.createMediaArtist(e);case"albums":case"library-albums":return this.createMediaAlbum(e);case"songs":case"library-songs":case"music-videos":return this.createMediaItem(e)}}createMediaPlaylist(e){const t=e.attributes,{id:r,kind:i}=t.playParams||{id:e.id,kind:"playlist"};return Object.assign(Object.assign({},Se(Ie.Playlist)),{src:`apple:${i}:${r}`,externalUrl:t.url,title:t.name,thumbnails:this.createThumbnails(e),apple:{href:e.href},owner:{name:t.curatorName||"",url:""},pager:this.createPager(`${e.href}?include=tracks`),unplayable:!t.playParams})}createMediaArtist(e){var t;const r=e.attributes;return Object.assign(Object.assign({},Se(Ie.Artist)),{src:`apple:artist:${e.id}`,externalUrl:r.url,title:r.name,thumbnails:this.createThumbnails(e),genre:r.genreNames.join(";"),apple:{href:e.href},pager:this.createPager((null===(t=e.relationships)||void 0===t?void 0:t.albums.href)||`/v1/catalog/{{storefrontId}}/artists/${e.id}/albums`)})}createMediaAlbum(e){const t=e.attributes,{id:r,kind:i}=t.playParams||{id:e.id,kind:"album"};return Object.assign(Object.assign({},Se(Ie.Album)),{src:`apple:${i}:${r}`,externalUrl:t.url,title:t.name,thumbnails:this.createThumbnails(e),artist:t.artistName,trackCount:t.trackCount,genre:t.genreNames.join(";"),year:new Date(t.releaseDate).getFullYear()||0,pager:this.createPager(e.href),apple:{href:e.href},unplayable:!t.playParams})}createMediaItem(e){const t=e.attributes,{id:r,kind:i}=t.playParams||{id:e.id,kind:"music-videos"===e.type?"musicVideo":"song"};return Object.assign(Object.assign({},Se(Ie.Media)),{mediaType:"musicVideo"===i?yt.Video:yt.Audio,src:`apple:${i}:${r}`,externalUrl:t.url,title:t.name,thumbnails:this.createThumbnails(e),artist:t.artistName,albumArtist:t.albumName?t.artistName:void 0,album:t.albumName,duration:t.durationInMillis/1e3,genre:t.genreNames.join(";"),disc:t.discNumber,track:t.trackNumber,year:new Date(t.releaseDate).getFullYear()||void 0,apple:{href:e.href},unplayable:!t.playParams})}createThumbnails(e){var t;const r=null===(t=e.attributes)||void 0===t?void 0:t.artwork;return r?[this.createThumbnail(r,60),this.createThumbnail(r,120),this.createThumbnail(r,240),this.createThumbnail(r,480)]:[]}createThumbnail(e,t){return{url:MusicKit.formatArtworkURL(e,t,t),width:t,height:t}}createPager(e,t){return new Gt(e,(e=>{var t,r,i;const n=(null===(r=null===(t=e.data[0])||void 0===t?void 0:t.relationships)||void 0===r?void 0:r.tracks)||e,a=n.data||[],s=n.next;return{items:a,total:null===(i=n.meta)||void 0===i?void 0:i.total,nextPageUrl:s}}),t)}}console.log("module::apple");const $t={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","Duration"]};function Yt(e,t="songs",r){if(e){const i="/v1/catalog/{{storefrontId}}/search",n=new URLSearchParams({term:e,types:t});return new Gt(`${i}?${n}`,(e=>{var r;const i=e.results[t]||{data:[]},n=i.next,a=null===(r=e.meta)||void 0===r?void 0:r.total;return{items:i.data,total:a,nextPageUrl:n}}),Object.assign({maxSize:250,pageSize:25},r))}return new tt}const Kt={id:"apple/video",title:"Music Video",icon:"video",itemType:Ie.Media,searchable:!0,layout:$t,search:e=>e?Yt(e,"music-videos",{maxSize:100}):new tt},Jt={id:"apple/recently-played",title:"Recently Played",icon:"clock",itemType:Ie.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search:()=>new Gt("/v1/me/recent/played/tracks",(e=>{var t;const r=e.data,i=e.next;return{items:r,total:null===(t=e.meta)||void 0===t?void 0:t.total,nextPageUrl:i}}),{pageSize:30})},Zt={id:"apple/liked-songs",title:"Liked Songs",icon:"heart",itemType:Ie.Media,layout:$t,search:()=>new Gt("/v1/me/library/songs",(e=>{var t;const r=e.data,i=e.next;return{items:r,total:null===(t=e.meta)||void 0===t?void 0:t.total,nextPageUrl:i}}))},er={id:"apple/liked-albums",title:"Liked Albums",icon:"heart",itemType:Ie.Album,search:()=>new Gt("/v1/me/library/albums",(e=>{var t;const r=e.data,i=e.next;return{items:r,total:null===(t=e.meta)||void 0===t?void 0:t.total,nextPageUrl:i}}))},tr={id:"apple/playlists",title:"Playlists",icon:"playlists",itemType:Ie.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","TrackCount"]},search:()=>new Gt("/v1/me/library/playlists",(e=>{var t;const r=e.data,i=e.next;return{items:r,total:null===(t=e.meta)||void 0===t?void 0:t.total,nextPageUrl:i}}))};function rr(e,t){return Object.assign(Object.assign({},t),{id:`apple/search/${e}`,icon:"",searchable:!0,search:t=>Yt(t,e)})}const ir={id:"apple",title:"Apple Music",icon:"apple",searches:[rr("songs",{title:"Songs",itemType:Ie.Media,layout:$t}),rr("albums",{title:"Albums",itemType:Ie.Album}),rr("artists",{title:"Artists",itemType:Ie.Artist}),rr("playlists",{title:"Playlists",itemType:Ie.Playlist})],sources:[Kt,Jt,Zt,er,tr],observeIsLoggedIn:mt,login:pt,logout:gt};var nr;!function(e){e[e.Pending=0]="Pending",e[e.Fulfilled=1]="Fulfilled",e[e.Rejected=2]="Rejected"}(nr||(nr={}));const ar=new ie("OffsetPager");class sr extends qt{constructor(e,t){super(t),this.fetch=e,this.fetchStates={},this.size=0}createSubscriptions(){this.subscriptions||(super.createSubscriptions(),this.subscriptions.add(this.fetches$.pipe(Ft((({index:e})=>this.isInRange(e))),nt((({index:e,length:t})=>this.getPageNumbersFromIndex(e,t))),Bt((e=>e)),Bt((e=>this.fetchPage(e))),Lt((e=>(ar.error(e),this.error$.next(e),Ze(void 0)))),Dt(this.observeComplete())).subscribe(ar)))}get pageSize(){return this.config.pageSize||20}fetchPage(e){return t=this,r=void 0,n=function*(){if(this.fetchStates[e]!==nr.Fulfilled&&this.fetchStates[e]!==nr.Pending){this.fetchStates[e]=nr.Pending;try{const t=yield this.fetch(e,this.pageSize);this.fetchStates[e]=nr.Fulfilled,this.insertPage(e,t)}catch(t){throw this.fetchStates[e]=nr.Rejected,t}}},new((i=void 0)||(i=Promise))((function(e,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,o)}l((n=n.apply(t,r||[])).next())}));var t,r,i,n}insertPage(e,t){const r=this.items.slice(),i=Math.min(t.total,this.maxSize),n=Math.ceil(i/this.pageSize),a=(e-1)*this.pageSize,s=e===n;if(r.length=s||t.items.length<this.pageSize?a:i,t.items.forEach(((e,t)=>r[t+a]=e)),r.length=Math.min(r.length,i),t.items.length===i)for(let e=0;e<=n;e++)this.fetchStates[e+1]=nr.Fulfilled;this.size=i,this.size$.next(i),this.items$.next(r)}getPageNumbersFromIndex(e,t){const r=this.size,i=Math.max(Math.ceil(this.pageSize/2),t),n=Math.max(e-i,0),a=Math.min(e+i+t-1,0===r?1/0:r-1),s=this.getPageNumberFromIndex(n),o=this.getPageNumberFromIndex(a);if(s===o)return[s];{const e=[];for(let t=s;t<=o;t++)e.push(t);return e}}getPageNumberFromIndex(e){return Math.floor(e/this.pageSize)+1}isInRange(e){return 0===this.size?e>=0:e>=0&&e<this.size}}let or=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"");const lr=new r("jellyfin"),cr={get host(){return lr.getItem("host")||""},set host(e){lr.setItem("host",e)},get device(){return"PC"},get deviceId(){let e=lr.getItem("deviceId");return e||(e=or(),lr.setItem("deviceId",e)),e},get token(){return lr.getItem("token")||""},set token(e){lr.setItem("token",e)},get userId(){return lr.getItem("userId")||""},set userId(e){lr.setItem("userId",e)},clear(){lr.removeItem("userId"),lr.removeItem("token")}};var ur=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};function hr(e,t){return ur(this,void 0,void 0,(function*(){const{device:r,deviceId:i,token:n}=cr;return t.headers=Object.assign(Object.assign({},t.headers),{"X-Emby-Authorization":`MediaBrowser Client="ampcast", Version="0.4.7", Device="${r}", DeviceId="${i}", Token="${n}"`}),window.fetch(`${cr.host}/${e}`,t)}))}console.log("module::jellyfinApi");const dr={get:function(e,t){return ur(this,void 0,void 0,(function*(){return hr(`${e}?${new URLSearchParams(t)}`,{method:"GET"})}))},post:function(e,t){return ur(this,void 0,void 0,(function*(){const r=JSON.stringify(t);return hr(e,{method:"POST",headers:{"Content-Type":"application/json"},body:r})}))},getPlayableUrlFromSrc:function(e){const{host:t,userId:r,token:i,deviceId:n}=cr;if(t&&r&&i&&n){const[,,a]=e.split(":");return`${t}/Audio/${a}/universal?${new URLSearchParams({MaxStreamingBitrate:"140000000",MaxSampleRate:"48000",TranscodingProtocol:"hls",TranscodingContainer:"ts",Container:"opus,webm|opus,mp3,aac,m4a|aac,m4b|aac,flac,webma,webm|webma,wav,ogg",AudioCodec:"aac",static:"true",UserId:r,api_key:i,DeviceId:n})}`}throw Error("Not logged in.")}},fr=dr;class mr{constructor(e,t={}){this.path=e,this.params=t,this.pageSize=mr.minPageSize,this.pager=new sr((e=>this.fetch(e)),{pageSize:this.pageSize})}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeMaxSize(){return this.pager.observeMaxSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}fetch(e){return t=this,r=void 0,n=function*(){const t=Object.assign(Object.assign({IncludeItemTypes:"Audio",Fields:"AudioInfo,Genres",Recursive:"true",ImageTypeLimit:"1",EnableImageTypes:"Primary"},this.params),{Limit:String(this.pageSize),StartIndex:String((e-1)*this.pageSize)}),r=yield fr.get(this.path,t);if(!r.ok)throw Error(`${r.status}: ${r.statusText}`);const{Items:i,TotalRecordCount:n}=yield r.json();return{items:i.map((e=>this.createItem(e))),total:n}},new((i=void 0)||(i=Promise))((function(e,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,o)}l((n=n.apply(t,r||[])).next())}));var t,r,i,n}createItem(e){switch(e.Type){case"MusicArtist":return this.createMediaArtist(e);case"MusicAlbum":return this.createMediaAlbum(e);case"Playlist":return this.createMediaPlaylist(e);default:return this.createMediaItemFromTrack(e)}}createMediaArtist(e){var t;return console.log("createMediaItemFromArtist",e),Object.assign(Object.assign({},Se(Ie.Artist)),{src:`jellyfin:album:${e.Id}`,title:e.Name||"",genre:null===(t=e.Genres)||void 0===t?void 0:t.join(";"),thumbnails:this.createThumbnails(e.Id),pager:this.createAlbumsPager(e)})}createMediaAlbum(e){var t,r,i;return console.log("createMediaItemFromAlbum",e),Object.assign(Object.assign({},Se(Ie.Album)),{src:`jellyfin:album:${e.Id}`,title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,playedOn:(null===(t=e.UserData)||void 0===t?void 0:t.LastPlayedDate)?new Date(e.UserData.LastPlayedDate).getTime():void 0,playCount:(null===(r=e.UserData)||void 0===r?void 0:r.PlayCount)||void 0,genre:null===(i=e.Genres)||void 0===i?void 0:i.join(";"),thumbnails:this.createThumbnails(e.Id),trackCount:e.ChildCount||void 0,pager:this.createAlbumPager(e),artist:e.AlbumArtist||void 0,year:e.ProductionYear||void 0})}createMediaPlaylist(e){var t,r,i;return Object.assign(Object.assign({},Se(Ie.Playlist)),{src:`jellyfin:playlist:${e.Id}`,title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,playedOn:(null===(t=e.UserData)||void 0===t?void 0:t.LastPlayedDate)?new Date(e.UserData.LastPlayedDate).getTime():void 0,playCount:(null===(r=e.UserData)||void 0===r?void 0:r.PlayCount)||void 0,genre:null===(i=e.Genres)||void 0===i?void 0:i.join(";"),thumbnails:this.createThumbnails(e.Id),trackCount:e.ChildCount||void 0,pager:this.createPlaylistPager(e)})}createMediaItemFromTrack(e){var t,r,i,n,a;const s=(null===(t=e.ImageTags)||void 0===t?void 0:t.Primary)?e.Id:e.AlbumId;return Object.assign(Object.assign({},Se(Ie.Media)),{mediaType:yt.Audio,src:`jellyfin:audio:${e.Id}`,title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,year:e.ProductionYear||void 0,playedOn:(null===(r=e.UserData)||void 0===r?void 0:r.LastPlayedDate)?new Date(e.UserData.LastPlayedDate).getTime():void 0,playCount:(null===(i=e.UserData)||void 0===i?void 0:i.PlayCount)||void 0,genre:null===(n=e.Genres)||void 0===n?void 0:n.join(";"),thumbnails:this.createThumbnails(s),artist:(null===(a=e.Artists)||void 0===a?void 0:a.join("/"))||e.AlbumArtist||void 0,albumArtist:e.AlbumArtist||void 0,album:e.Album||void 0,track:e.Album&&e.IndexNumber||0})}createThumbnails(e){return e?[this.createThumbnail(e,60),this.createThumbnail(e,120),this.createThumbnail(e,240),this.createThumbnail(e,480)]:void 0}createThumbnail(e,t,r=t){return{url:`${cr.host}/Items/${e}/Images/Primary?fillWidth=${t}&fillHeight=${r}`,width:t,height:r}}createAlbumPager(e){return new mr(`Users/${cr.userId}/Items`,{ParentId:e.Id,SortBy:"SortName",SortOrder:"Ascending"})}createAlbumsPager(e){return new mr(`Users/${cr.userId}/Items`,{AlbumArtistIds:e.Id,IncludeItemTypes:"MusicAlbum",SortOrder:"Descending"})}createPlaylistPager(e){return new mr(`Playlists/${e.Id}/Items`,{UserId:cr.userId,MediaType:"Audio",Fields:"ChildCount"})}}mr.minPageSize=100,mr.maxPageSize=1e3;var pr=__webpack_require__(3935),gr=window.CustomEvent;function Ar(e,t){var r="on"+t.type.toLowerCase();return"function"==typeof e[r]&&e[r](t),e.dispatchEvent(t)}function br(e){for(;e;){if("dialog"===e.localName)return e;e=e.parentElement?e.parentElement:e.parentNode?e.parentNode.host:null}return null}function vr(e){for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;e&&e.blur&&e!==document.body&&e.blur()}function yr(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1}function wr(e){return!(!e||!e.hasAttribute("method"))&&"dialog"===e.getAttribute("method").toLowerCase()}function Er(e){var t=["button","input","keygen","select","textarea"].map((function(e){return e+":not([disabled])"}));t.push('[tabindex]:not([disabled]):not([tabindex=""])');var r=e.querySelector(t.join(", "));if(!r&&"attachShadow"in Element.prototype)for(var i=e.querySelectorAll("*"),n=0;n<i.length&&!(i[n].tagName&&i[n].shadowRoot&&(r=Er(i[n].shadowRoot)));n++);return r}function _r(e){return e.isConnected||document.body.contains(e)}function Tr(e){if(e.submitter)return e.submitter;var t=e.target;if(!(t instanceof HTMLFormElement))return null;var r=kr.formSubmitter;if(!r){var i=e.target;r=("getRootNode"in i&&i.getRootNode()||document).activeElement}return r&&r.form===t?r:null}function Sr(e){if(!e.defaultPrevented){var t=e.target,r=kr.imagemapUseValue,i=Tr(e);null===r&&i&&(r=i.value);var n=br(t);n&&"dialog"===(i&&i.getAttribute("formmethod")||t.getAttribute("method"))&&(e.preventDefault(),null!=r?n.close(r):n.close())}}function xr(e){if(this.dialog_=e,this.replacedStyleTop_=!1,this.openAsModal_=!1,e.hasAttribute("role")||e.setAttribute("role","dialog"),e.show=this.show.bind(this),e.showModal=this.showModal.bind(this),e.close=this.close.bind(this),e.addEventListener("submit",Sr,!1),"returnValue"in e||(e.returnValue=""),"MutationObserver"in window)new MutationObserver(this.maybeHideModal.bind(this)).observe(e,{attributes:!0,attributeFilter:["open"]});else{var t,r=!1,i=function(){r?this.downgradeModal():this.maybeHideModal(),r=!1}.bind(this),n=function(n){if(n.target===e){var a="DOMNodeRemoved";r|=n.type.substr(0,a.length)===a,window.clearTimeout(t),t=window.setTimeout(i,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach((function(t){e.addEventListener(t,n)}))}Object.defineProperty(e,"open",{set:this.setOpen.bind(this),get:e.hasAttribute.bind(e,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("mouseup",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("mousedown",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("click",this.backdropMouseEvent_.bind(this))}gr&&"object"!=typeof gr||((gr=function(e,t){t=t||{};var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail||null),r}).prototype=window.Event.prototype),xr.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&_r(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),kr.dm.removeDialog(this))},setOpen:function(e){e?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropMouseEvent_:function(e){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var t=document.createElement("div");this.dialog_.insertBefore(t,this.dialog_.firstChild),t.tabIndex=-1,t.focus(),this.dialog_.removeChild(t)}var r=document.createEvent("MouseEvents");r.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),this.dialog_.dispatchEvent(r),e.stopPropagation()},focus_:function(){var e=this.dialog_.querySelector("[autofocus]:not([disabled])");!e&&this.dialog_.tabIndex>=0&&(e=this.dialog_),e||(e=Er(this.dialog_)),vr(document.activeElement),e&&e.focus()},updateZIndex:function(e,t){if(e<t)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=e,this.backdrop_.style.zIndex=t},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!_r(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!kr.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function(e){for(;e&&e!==document.body;){var t=window.getComputedStyle(e),r=function(e,r){return!(void 0===t[e]||t[e]===r)};if(t.opacity<1||r("zIndex","auto")||r("transform","none")||r("mixBlendMode","normal")||r("filter","none")||r("perspective","none")||"isolate"===t.isolation||"fixed"===t.position||"touch"===t.webkitOverflowScrolling)return!0;e=e.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,kr.needsCentering(this.dialog_)?(kr.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(e){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==e&&(this.dialog_.returnValue=e);var t=new gr("close",{bubbles:!1,cancelable:!1});Ar(this.dialog_,t)}};var kr={reposition:function(e){var t=document.body.scrollTop||document.documentElement.scrollTop,r=t+(window.innerHeight-e.offsetHeight)/2;e.style.top=Math.max(t,r)+"px"},isInlinePositionSetByStylesheet:function(e){for(var t=0;t<document.styleSheets.length;++t){var r=document.styleSheets[t],i=null;try{i=r.cssRules}catch(e){}if(i)for(var n=0;n<i.length;++n){var a=i[n],s=null;try{s=document.querySelectorAll(a.selectorText)}catch(e){}if(s&&yr(s,e)){var o=a.style.getPropertyValue("top"),l=a.style.getPropertyValue("bottom");if(o&&"auto"!==o||l&&"auto"!==l)return!0}}}return!1},needsCentering:function(e){return!("absolute"!==window.getComputedStyle(e).position||"auto"!==e.style.top&&""!==e.style.top||"auto"!==e.style.bottom&&""!==e.style.bottom||kr.isInlinePositionSetByStylesheet(e))},forceRegisterDialog:function(e){if((window.HTMLDialogElement||e.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",e),"dialog"!==e.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new xr(e)},registerDialog:function(e){e.showModal||kr.forceRegisterDialog(e)},DialogManager:function(){this.pendingDialogStack=[];var e=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(t){this.forwardTab_=void 0,t.stopPropagation(),e([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver((function(t){var r=[];t.forEach((function(e){for(var t,i=0;t=e.removedNodes[i];++i)t instanceof Element&&("dialog"===t.localName&&r.push(t),r=r.concat(t.querySelectorAll("dialog")))})),r.length&&e(r)})))}};if(kr.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},kr.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},kr.DialogManager.prototype.updateStacking=function(){for(var e,t=this.zIndexHigh_,r=0;e=this.pendingDialogStack[r];++r)e.updateZIndex(--t,--t),0===r&&(this.overlay.style.zIndex=--t);var i=this.pendingDialogStack[0];i?(i.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},kr.DialogManager.prototype.containedByTopDialog_=function(e){for(;e=br(e);){for(var t,r=0;t=this.pendingDialogStack[r];++r)if(t.dialog===e)return 0===r;e=e.parentElement}return!1},kr.DialogManager.prototype.handleFocus_=function(e){var t=e.composedPath?e.composedPath()[0]:e.target;if(!this.containedByTopDialog_(t)&&document.activeElement!==document.documentElement&&(e.preventDefault(),e.stopPropagation(),vr(t),void 0!==this.forwardTab_)){var r=this.pendingDialogStack[0];return r.dialog.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?r.focus_():t!==document.documentElement&&document.documentElement.focus()),!1}},kr.DialogManager.prototype.handleKey_=function(e){if(this.forwardTab_=void 0,27===e.keyCode){e.preventDefault(),e.stopPropagation();var t=new gr("cancel",{bubbles:!1,cancelable:!0}),r=this.pendingDialogStack[0];r&&Ar(r.dialog,t)&&r.dialog.close()}else 9===e.keyCode&&(this.forwardTab_=!e.shiftKey)},kr.DialogManager.prototype.checkDOM_=function(e){this.pendingDialogStack.slice().forEach((function(t){-1!==e.indexOf(t.dialog)?t.downgradeModal():t.maybeHideModal()}))},kr.DialogManager.prototype.pushDialog=function(e){var t=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=t||(1===this.pendingDialogStack.unshift(e)&&this.blockDocument(),this.updateStacking(),0))},kr.DialogManager.prototype.removeDialog=function(e){var t=this.pendingDialogStack.indexOf(e);-1!==t&&(this.pendingDialogStack.splice(t,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},kr.dm=new kr.DialogManager,kr.formSubmitter=null,kr.imagemapUseValue=null,void 0===window.HTMLDialogElement){var Ir=document.createElement("form");if(Ir.setAttribute("method","dialog"),"dialog"!==Ir.method){var Cr=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(Cr){var Pr=Cr.get;Cr.get=function(){return wr(this)?"dialog":Pr.call(this)};var Mr=Cr.set;Cr.set=function(e){return"string"==typeof e&&"dialog"===e.toLowerCase()?this.setAttribute("method",e):Mr.call(this,e)},Object.defineProperty(HTMLFormElement.prototype,"method",Cr)}}document.addEventListener("click",(function(e){if(kr.formSubmitter=null,kr.imagemapUseValue=null,!e.defaultPrevented){var t=e.target;if("composedPath"in e&&(t=e.composedPath().shift()||t),t&&wr(t.form)){if(!("submit"===t.type&&["button","input"].indexOf(t.localName)>-1)){if("input"!==t.localName||"image"!==t.type)return;kr.imagemapUseValue=e.offsetX+","+e.offsetY}br(t)&&(kr.formSubmitter=t)}}}),!1),document.addEventListener("submit",(function(e){var t=e.target;if(!br(t)){var r=Tr(e);"dialog"===(r&&r.getAttribute("formmethod")||t.getAttribute("method"))&&e.preventDefault()}}));var Rr=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!wr(this))return Rr.call(this);var e=br(this);e&&e.close()}}const Br=kr;const Lr=(0,e.forwardRef)((function(t,r){var{onKeyDown:i}=t,n=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["onKeyDown"]);const a=(0,e.useCallback)((e=>{" "===e.key&&e.stopPropagation(),null==i||i(e)}),[i]);return e.createElement("button",Object.assign({},n,{onKeyDown:a,ref:r}))}));function Dr({name:t,className:r=""}){switch(r=`icon icon-${t} ${r}`,t){case"play":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"}));case"pause":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"}));case"stop":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"}));case"volume":return e.createElement("svg",{className:r,viewBox:"0 0 16 16"},e.createElement("path",{className:"high medium",d:"M11.536 14.01A8.473 8.473 0 0 0 14.026 8a8.473 8.473 0 0 0-2.49-6.01l-.708.707A7.476 7.476 0 0 1 13.025 8c0 2.071-.84 3.946-2.197 5.303l.708.707z"}),e.createElement("path",{className:"medium",d:"M10.121 12.596A6.48 6.48 0 0 0 12.025 8a6.48 6.48 0 0 0-1.904-4.596l-.707.707A5.483 5.483 0 0 1 11.025 8a5.483 5.483 0 0 1-1.61 3.89l.706.706z"}),e.createElement("path",{d:"M8.707 11.182A4.486 4.486 0 0 0 10.025 8a4.486 4.486 0 0 0-1.318-3.182L8 5.525A3.489 3.489 0 0 1 9.025 8 3.49 3.49 0 0 1 8 10.475l.707.707zM6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06z"}));case"muted":return e.createElement("svg",{className:r,viewBox:"0 0 16 16"},e.createElement("path",{d:"M6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06zm7.137 2.096a.5.5 0 0 1 0 .708L12.207 8l1.647 1.646a.5.5 0 0 1-.708.708L11.5 8.707l-1.646 1.647a.5.5 0 0 1-.708-.708L10.793 8 9.146 6.354a.5.5 0 1 1 .708-.708L11.5 7.293l1.646-1.647a.5.5 0 0 1 .708 0z"}));case"prev":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z"}));case"next":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"}));case"info":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"}));case"settings":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}));case"locked":return e.createElement("svg",{className:r,viewBox:"0 0 448 512",transform:"scale(0.95)"},e.createElement("path",{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"}));case"unlocked":return e.createElement("svg",{className:r,viewBox:"0 0 576 512",transform:"scale(0.95)"},e.createElement("path",{d:"M423.5 0C339.5.3 272 69.5 272 153.5V224H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48h-48v-71.1c0-39.6 31.7-72.5 71.3-72.9 40-.4 72.7 32.1 72.7 72v80c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24v-80C576 68 507.5-.3 423.5 0z"}));case"left":return e.createElement("svg",{className:r,viewBox:"0 0 320 512"},e.createElement("path",{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"}));case"right":return e.createElement("svg",{className:r,viewBox:"0 0 320 512"},e.createElement("path",{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"}));case"saved":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}));case"unsaved":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM272 80v80H144V80h128zm122 352H54a6 6 0 0 1-6-6V86a6 6 0 0 1 6-6h42v104c0 13.255 10.745 24 24 24h176c13.255 0 24-10.745 24-24V83.882l78.243 78.243a6 6 0 0 1 1.757 4.243V426a6 6 0 0 1-6 6zM224 232c-48.523 0-88 39.477-88 88s39.477 88 88 88 88-39.477 88-88-39.477-88-88-88zm0 128c-22.056 0-40-17.944-40-40s17.944-40 40-40 40 17.944 40 40-17.944 40-40 40z"}));case"close":return e.createElement("svg",{className:r,viewBox:"0 0 64 64"},e.createElement("path",{d:"M 10.5,-0.5 C 12.1667,-0.5 13.8333,-0.5 15.5,-0.5C 20.7971,5.29805 26.2971,10.9647 32,16.5C 37.0314,10.303 42.5314,4.63636 48.5,-0.5C 49.8333,-0.5 51.1667,-0.5 52.5,-0.5C 55.8333,3.5 59.5,7.16667 63.5,10.5C 63.5,11.8333 63.5,13.1667 63.5,14.5C 57.7019,19.7971 52.0353,25.2971 46.5,31C 52.0353,36.7029 57.7019,42.2029 63.5,47.5C 63.5,49.1667 63.5,50.8333 63.5,52.5C 59.5,55.8333 55.8333,59.5 52.5,63.5C 50.8333,63.5 49.1667,63.5 47.5,63.5C 42.1604,57.8275 36.8271,52.1608 31.5,46.5C 25.479,51.8543 19.8123,57.521 14.5,63.5C 13.1667,63.5 11.8333,63.5 10.5,63.5C 7.16667,59.5 3.5,55.8333 -0.5,52.5C -0.5,50.8333 -0.5,49.1667 -0.5,47.5C 5.17254,42.1604 10.8392,36.8271 16.5,31.5C 10.8392,26.1729 5.17254,20.8396 -0.5,15.5C -0.5,13.8333 -0.5,12.1667 -0.5,10.5C 3.5,7.16667 7.16667,3.5 10.5,-0.5 Z"}));case"audio":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.941 97.941l-83.882-83.882A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v416c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48V131.882a48 48 0 0 0-14.059-33.941zM332.118 128H256V51.882L332.118 128zM48 464V48h160v104c0 13.255 10.745 24 24 24h104v288H48zm144-76.024c0 10.691-12.926 16.045-20.485 8.485L136 360.486h-28c-6.627 0-12-5.373-12-12v-56c0-6.627 5.373-12 12-12h28l35.515-36.947c7.56-7.56 20.485-2.206 20.485 8.485v135.952zm41.201-47.13c9.051-9.297 9.06-24.133.001-33.439-22.149-22.752 12.235-56.246 34.395-33.481 27.198 27.94 27.212 72.444.001 100.401-21.793 22.386-56.947-10.315-34.397-33.481z"}));case"video":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.941 97.941l-83.882-83.882A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v416c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48V131.882a48 48 0 0 0-14.059-33.941zM332.118 128H256V51.882L332.118 128zM48 464V48h160v104c0 13.255 10.745 24 24 24h104v288H48zm228.687-211.303L224 305.374V268c0-11.046-8.954-20-20-20H100c-11.046 0-20 8.954-20 20v104c0 11.046 8.954 20 20 20h104c11.046 0 20-8.954 20-20v-37.374l52.687 52.674C286.704 397.318 304 390.28 304 375.986V264.011c0-14.311-17.309-21.319-27.313-11.314z"}));case"note":return e.createElement("svg",{className:r,viewBox:"0 0 24 24",transform:"scale(1.25)"},e.createElement("path",{stroke:"none",d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"}));case"star":return e.createElement("svg",{className:r,viewBox:"0 0 576 512"},e.createElement("path",{d:"M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z"}));case"heart":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M458.4 64.3C400.6 15.7 311.3 23 256 79.3 200.7 23 111.4 15.6 53.6 64.3-21.6 127.6-10.6 230.8 43 285.5l175.4 178.7c10 10.2 23.4 15.9 37.6 15.9 14.3 0 27.6-5.6 37.6-15.8L469 285.6c53.5-54.7 64.7-157.9-10.6-221.3zm-23.6 187.5L259.4 430.5c-2.4 2.4-4.4 2.4-6.8 0L77.2 251.8c-36.5-37.2-43.9-107.6 7.3-150.7 38.9-32.7 98.9-27.8 136.5 10.5l35 35.7 35-35.7c37.8-38.5 97.8-43.2 136.5-10.6 51.1 43.1 43.5 113.9 7.3 150.8z"}));case"thumbs-up":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M466.27 286.69C475.04 271.84 480 256 480 236.85c0-44.015-37.218-85.58-85.82-85.58H357.7c4.92-12.81 8.85-28.13 8.85-46.54C366.55 31.936 328.86 0 271.28 0c-61.607 0-58.093 94.933-71.76 108.6-22.747 22.747-49.615 66.447-68.76 83.4H32c-17.673 0-32 14.327-32 32v240c0 17.673 14.327 32 32 32h64c14.893 0 27.408-10.174 30.978-23.95 44.509 1.001 75.06 39.94 177.802 39.94 7.22 0 15.22.01 22.22.01 77.117 0 111.986-39.423 112.94-95.33 13.319-18.425 20.299-43.122 17.34-66.99 9.854-18.452 13.664-40.343 8.99-62.99zm-61.75 53.83c12.56 21.13 1.26 49.41-13.94 57.57 7.7 48.78-17.608 65.9-53.12 65.9h-37.82c-71.639 0-118.029-37.82-171.64-37.82V240h10.92c28.36 0 67.98-70.89 94.54-97.46 28.36-28.36 18.91-75.63 37.82-94.54 47.27 0 47.27 32.98 47.27 56.73 0 39.17-28.36 56.72-28.36 94.54h103.99c21.11 0 37.73 18.91 37.82 37.82.09 18.9-12.82 37.81-22.27 37.81 13.489 14.555 16.371 45.236-5.21 65.62zM88 432c0 13.255-10.745 24-24 24s-24-10.745-24-24 10.745-24 24-24 24 10.745 24 24z"}));case"most-played":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48z"}),e.createElement("polygon",{points:"130,250 270,325 130,400",strokeWidth:"30",strokeLinejoin:"round"}));case"clock":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"}));case"recently-added":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48z"}),e.createElement("rect",{x:"177",y:"220",width:"40",height:"210",strokeWidth:"20",strokeLinejoin:"round"}),e.createElement("rect",{x:"87",y:"310",width:"210",height:"40",strokeWidth:"20",strokeLinejoin:"round"}));case"playlists":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M88 48C101.3 48 112 58.75 112 72V120C112 133.3 101.3 144 88 144H40C26.75 144 16 133.3 16 120V72C16 58.75 26.75 48 40 48H88zM480 64C497.7 64 512 78.33 512 96C512 113.7 497.7 128 480 128H192C174.3 128 160 113.7 160 96C160 78.33 174.3 64 192 64H480zM480 224C497.7 224 512 238.3 512 256C512 273.7 497.7 288 480 288H192C174.3 288 160 273.7 160 256C160 238.3 174.3 224 192 224H480zM480 384C497.7 384 512 398.3 512 416C512 433.7 497.7 448 480 448H192C174.3 448 160 433.7 160 416C160 398.3 174.3 384 192 384H480zM16 232C16 218.7 26.75 208 40 208H88C101.3 208 112 218.7 112 232V280C112 293.3 101.3 304 88 304H40C26.75 304 16 293.3 16 280V232zM88 368C101.3 368 112 378.7 112 392V440C112 453.3 101.3 464 88 464H40C26.75 464 16 453.3 16 440V392C16 378.7 26.75 368 40 368H88z"}));case"file":case"blob":return e.createElement("svg",{className:r,viewBox:"0 0 448 512",transform:"scale(0.875)"},e.createElement("path",{fill:"#00cccc",d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"}));case"apple":return e.createElement("svg",{className:r,viewBox:"0 0 24 24",transform:"scale(1.1) translate(0,-1)"},e.createElement("path",{fillRule:"nonzero",d:"M11.624 7.222c-.876 0-2.232-.996-3.66-.96-1.884.024-3.612 1.092-4.584 2.784-1.956 3.396-.504 8.412 1.404 11.172.936 1.344 2.04 2.856 3.504 2.808 1.404-.06 1.932-.912 3.636-.912 1.692 0 2.172.912 3.66.876 1.512-.024 2.472-1.368 3.396-2.724 1.068-1.56 1.512-3.072 1.536-3.156-.036-.012-2.94-1.128-2.976-4.488-.024-2.808 2.292-4.152 2.4-4.212-1.32-1.932-3.348-2.148-4.056-2.196-1.848-.144-3.396 1.008-4.26 1.008zm3.12-2.832c.78-.936 1.296-2.244 1.152-3.54-1.116.048-2.46.744-3.264 1.68-.72.828-1.344 2.16-1.176 3.432 1.236.096 2.508-.636 3.288-1.572z"}));case"plex":return e.createElement("svg",{className:r,viewBox:"0 0 122.88 122.88"},e.createElement("path",{className:"icon-plex-outer",d:"M18.43,0h86.02c10.18,0,18.43,8.25,18.43,18.43v86.02c0,10.18-8.25,18.43-18.43,18.43H18.43 C8.25,122.88,0,114.63,0,104.45l0-86.02C0,8.25,8.25,0,18.43,0L18.43,0z"}),e.createElement("polygon",{className:"icon-plex-inner",points:"61.44,16.8 35.52,16.8 61.44,61.44 35.52,106.08 61.44,106.08 87.36,61.44 61.44,16.8"}));case"jellyfin":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("defs",null,e.createElement("linearGradient",{id:"jellyfin-linear-gradient",gradientUnits:"userSpaceOnUse",x1:"110.25",y1:"213.3",x2:"496.14",y2:"436.09"},e.createElement("stop",{offset:"0",style:{stopColor:"#aa5cc3"}}),e.createElement("stop",{offset:"1",style:{stopColor:"#00a4dc"}}))),e.createElement("path",{d:"M256,201.6c-20.4,0-86.2,119.3-76.2,139.4s142.5,19.9,152.4,0S276.5,201.6,256,201.6z"}),e.createElement("path",{d:"M256,23.3c-61.6,0-259.8,359.4-229.6,420.1s429.3,60,459.2,0S317.6,23.3,256,23.3z M406.5,390.8c-19.6,39.3-281.1,39.8-300.9,0s110.1-275.3,150.4-275.3S426.1,351.4,406.5,390.8z"}));case"spotify":return e.createElement("svg",{className:r,viewBox:"0 0 168 168"},e.createElement("path",{stroke:"none",d:"m83.996 0.277c-46.249 0-83.743 37.493-83.743 83.742 0 46.251 37.494 83.741 83.743 83.741 46.254 0 83.744-37.49 83.744-83.741 0-46.246-37.49-83.738-83.745-83.738l0.001-0.004zm38.404 120.78c-1.5 2.46-4.72 3.24-7.18 1.73-19.662-12.01-44.414-14.73-73.564-8.07-2.809 0.64-5.609-1.12-6.249-3.93-0.643-2.81 1.11-5.61 3.926-6.25 31.9-7.291 59.263-4.15 81.337 9.34 2.46 1.51 3.24 4.72 1.73 7.18zm10.25-22.805c-1.89 3.075-5.91 4.045-8.98 2.155-22.51-13.839-56.823-17.846-83.448-9.764-3.453 1.043-7.1-0.903-8.148-4.35-1.04-3.453 0.907-7.093 4.354-8.143 30.413-9.228 68.222-4.758 94.072 11.127 3.07 1.89 4.04 5.91 2.15 8.976v-0.001zm0.88-23.744c-26.99-16.031-71.52-17.505-97.289-9.684-4.138 1.255-8.514-1.081-9.768-5.219-1.254-4.14 1.08-8.513 5.221-9.771 29.581-8.98 78.756-7.245 109.83 11.202 3.73 2.209 4.95 7.016 2.74 10.733-2.2 3.722-7.02 4.949-10.73 2.739z"}));case"lastfm":return e.createElement("svg",{className:r,viewBox:"0 0 455 455"},e.createElement("rect",{className:"icon-lastfm-inner",x:"5",y:"5",width:"445",height:"445"}),e.createElement("path",{className:"icon-lastfm-outer",fillRule:"evenodd",clipRule:"evenodd",d:"M0,0v455h455V0H0z M309.94,315.01c-62.425,0-84.085-28.145-95.625-63.145 L202.77,215.77c-8.65-26.33-18.75-46.915-50.505-46.915c-22.035,0-44.395,15.88-44.395,60.275c0,34.63,17.695,56.29,42.575,56.29 c28.145,0,46.915-20.94,46.915-20.94l11.565,31.385c0,0-19.495,19.125-60.275,19.125c-50.51,0-78.65-29.57-78.65-84.435 c0-56.99,28.14-90.565,81.19-90.565c47.99,0,72.165,17.325,87.305,64.235L250.41,240.3c8.65,26.35,23.805,45.47,60.25,45.47 c24.555,0,37.52-5.41,37.52-18.77c0-10.45-6.13-18.025-24.53-22.365l-24.53-5.76c-29.94-7.225-41.855-22.735-41.855-47.265 c0-39.335,31.755-51.6,64.215-51.6c36.82,0,59.18,13.34,62.07,45.82l-36.07,4.335c-1.445-15.53-10.82-22.015-28.145-22.015 c-15.88,0-25.625,7.21-25.625,19.475c0,10.84,4.685,17.325,20.565,20.94l23.085,5.055c31.035,7.21,47.64,22.365,47.64,51.585 C385,301.295,354.685,315.01,309.94,315.01z"}));case"youtube":return e.createElement("svg",{className:r,viewBox:"0 0 576 512",transform:"scale(1.125)"},e.createElement("rect",{className:"icon-youtube-inner",x:"144",y:"128",width:"288",height:"256"}),e.createElement("path",{className:"icon-youtube-outer",d:"M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"}))}}const Nr={left:0,top:0},Fr=(0,e.forwardRef)((function({title:t,className:r="",children:i,onClose:n,target:a="system"},s){const o=(0,e.useRef)(null),[l,c]=(0,e.useState)(Nr),[u,h]=(0,e.useState)(null),[d,f]=(0,e.useState)(Nr);(0,e.useImperativeHandle)(s,(()=>({close:e=>{o.current.open&&o.current.close(e)}}))),(0,e.useEffect)((()=>{const e=o.current;Br.registerDialog(e),e.showModal()}),[]);const m=(0,e.useCallback)((()=>{o.current.close()}),[]),p=(0,e.useCallback)((()=>{n(o.current.returnValue)}),[n]),g=(0,e.useCallback)((e=>{const t=e.target;"submit"===t.type&&"#cancel"===t.value&&(e.preventDefault(),o.current.close())}),[]),A=(0,e.useCallback)((e=>{e.preventDefault(),0===e.button&&h({left:e.screenX,top:e.screenY})}),[]),b=(0,e.useCallback)((e=>{f({left:e.screenX-u.left,top:e.screenY-u.top})}),[u]),v=(0,e.useCallback)((e=>{c({left:l.left+(e.screenX-u.left),top:l.top+(e.screenY-u.top)}),f(Nr),h(null)}),[l,u]);return(0,e.useEffect)((()=>{if(u)return document.documentElement.style.cursor="default",document.body.classList.add("dragging"),document.addEventListener("mouseup",v),document.addEventListener("mousemove",b),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",v),document.removeEventListener("mousemove",b)}}),[u,b,v]),pr.createPortal(e.createElement("dialog",{className:`dialog ${r}`,onClose:p,style:{transform:`translate(${l.left+d.left}px, ${l.top+d.top}px)`},ref:o},e.createElement("header",{className:"dialog-head",onMouseDown:A},e.createElement("h2",null,t),e.createElement(Lr,{onClick:m,onMouseDown:Te},e.createElement(Dr,{name:"close"}))),e.createElement("div",{className:"dialog-body",onClick:g},i)),document.getElementById(a))}));function Or(t,r){const[i,n]=(0,e.useState)(!1),a=(0,e.useCallback)((()=>n(!0)),[]),s=(0,e.useCallback)((()=>n(!1)),[]);return[i?e.createElement(t,{onClose:s,target:r}):null,a]}function zr(r){return i=this,n=void 0,s=function*(){return new Promise(((i,n)=>{const a=document.createElement("div"),s=(0,t.s)(a);try{const t=e=>{s.unmount(),a.remove(),i(e)};document.body.append(a),s.render(e.createElement(r,{onClose:t}))}catch(e){s.unmount(),a.remove(),n(e)}}))},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(r,o)}l((s=s.apply(i,n||[])).next())}));var i,n,a,s}const Ur=(0,e.forwardRef)((function(t,r){var{onKeyDown:i}=t,n=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["onKeyDown"]);const a=(0,e.useCallback)((e=>{" "===e.key&&e.stopPropagation(),null==i||i(e)}),[i]);return e.createElement("input",Object.assign({},n,{onKeyDown:a,ref:r}))}));var jr=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};function Vr(t){const r=(0,e.useRef)(null),i=(0,e.useRef)(null),n=(0,e.useRef)(null),a=(0,e.useRef)(null),s=(0,e.useCallback)((()=>jr(this,void 0,void 0,(function*(){try{const e=n.current.value,t=a.current.value;cr.host=i.current.value;const{device:s,deviceId:o}=cr,l=`MediaBrowser Client="ampcast", Version="0.4.7", Device="${s}", DeviceId="${o}"`,c=yield fetch(`${cr.host}/Users/AuthenticateByName`,{method:"POST",headers:{"Content-Type":"application/json","X-Emby-Authorization":l},body:JSON.stringify({Username:e,Pw:t})});if(!c.ok)throw Error(`${c.status}: ${c.statusText}`);const u=yield c.json(),h=u.User.Id,d=u.AccessToken;r.current.close(JSON.stringify({userId:h,token:d}))}catch(e){console.error(e)}}))),[]),o=(0,e.useCallback)((e=>jr(this,void 0,void 0,(function*(){"Enter"===e.key&&(e.preventDefault(),e.repeat||(yield s()))}))),[s]);return e.createElement(Fr,Object.assign({},t,{className:"jellyfin-login-dialog",title:"Login to Jellyfin",ref:r}),e.createElement("form",{method:"dialog",onKeyDown:o},e.createElement("p",null,e.createElement("label",{htmlFor:"jellyfin-host"},"Host:"),e.createElement(Ur,{type:"url",id:"jellyfin-host",defaultValue:cr.host,ref:i})),e.createElement("p",null,e.createElement("label",{htmlFor:"jellyfin-username"},"User:"),e.createElement(Ur,{type:"text",id:"jellyfin-username",autoFocus:!0,ref:n})),e.createElement("p",null,e.createElement("label",{htmlFor:"jellyfin-password"},"Password:"),e.createElement(Ur,{type:"password",id:"jellyfin-password",ref:a})),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel"},"Cancel"),e.createElement(Lr,{type:"button",onClick:s},"Login"))))}var Qr=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};console.log("module::jellyfinAuth");const qr=new ie("jellyfinAuth"),Xr=new te("");function Wr(e){e&&qr.log("Access token successfully obtained."),cr.token=e,Xr.next(e)}function Hr(e){return Ft((function(t,r){return e<=r}))}Wr(cr.token);var Gr=["addListener","removeListener"],$r=["addEventListener","removeEventListener"],Yr=["on","off"];function Kr(e,t,r,i){if(v(r)&&(i=r,r=void 0),i)return Kr(e,t,r).pipe(kt(i));var n=p(function(e){return v(e.addEventListener)&&v(e.removeEventListener)}(e)?$r.map((function(i){return function(n){return e[i](t,n,r)}})):function(e){return v(e.addListener)&&v(e.removeListener)}(e)?Gr.map(Jr(e,t)):function(e){return v(e.on)&&v(e.off)}(e)?Yr.map(Jr(e,t)):[],2),a=n[0],s=n[1];if(!a&&Le(e))return Bt((function(e){return Kr(e,t,r)}))(Qe(e));if(!a)throw new TypeError("Invalid event target");return new Y((function(e){var t=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.next(1<t.length?t:t[0])};return a(t),function(){return s(t)}}))}function Jr(e,t){return function(r){return function(i){return e[r](t,i)}}}function Zr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Me(e);return We((function(t,i){for(var n=e.length,a=new Array(n),s=e.map((function(){return!1})),o=!1,l=function(t){Qe(e[t]).subscribe(He(i,(function(e){a[t]=e,o||s[t]||(s[t]=!0,(o=s.every(G))&&(s=null))}),L))},c=0;c<n;c++)l(c);t.subscribe(He(i,(function(e){if(o){var t=g([e],p(a));i.next(r?r.apply(void 0,g([],p(t))):t)}})))}))}var ei=function(e){function t(t,r){return e.call(this)||this}return d(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(_),ti={setInterval:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=ti.delegate;return(null==n?void 0:n.setInterval)?n.setInterval.apply(n,g([e,t],p(r))):setInterval.apply(void 0,g([e,t],p(r)))},clearInterval:function(e){var t=ti.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},ri=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.scheduler=t,i.work=r,i.pending=!1,i}return d(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),ti.setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;ti.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r,i=!1;try{this.work(e)}catch(e){i=!0,r=e||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,i=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,E(i,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(ei),ii=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=zt.now,e}(),ni=function(e){function t(t,r){void 0===r&&(r=ii.now);var i=e.call(this,t,r)||this;return i.actions=[],i._active=!1,i._scheduled=void 0,i}return d(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},t}(ii),ai=new ni(ri),si=ai;function oi(e){return new Promise(((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)}))}function li(e,t){const r=indexedDB.open(e);r.onupgradeneeded=()=>r.result.createObjectStore(t);const i=oi(r);return(e,r)=>i.then((i=>r(i.transaction(t,e).objectStore(t))))}let ci;function ui(){return ci||(ci=li("keyval-store","keyval")),ci}function hi(e,t=ui()){return t("readonly",(t=>oi(t.get(e))))}function di(e,t,r=ui()){return r("readwrite",(r=>(r.put(t,e),oi(r.transaction))))}var fi=__webpack_require__(2463);const mi=new r("playlist"),pi={allowDuplicates:!0,showLineNumbers:!0,zeroPadLineNumbers:!0,showSourceIcons:!0},gi=new te(function(){try{const e=mi.getItem("settings");return e?JSON.parse(e):pi}catch(e){return console.error(e),pi}}()),Ai=function(){return gi},bi=function(){return gi.getValue()},vi=function(e){mi.setItem("settings",JSON.stringify(e)),gi.next(e)};var yi=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};console.log("module::playlist");const wi=li("ampcast/playlist","keyval"),Ei=[],_i=new te(Ei),Ti=new te("");function Si(){var e;return yi(this,void 0,void 0,(function*(){if(_i.getValue()===Ei){const t=null!==(e=yield hi("items",wi))&&void 0!==e?e:[];_i.next(t)}return _i.getValue()}))}function xi(e){return yi(this,void 0,void 0,(function*(){e=e.concat(),yield di("items",e,wi),_i.next(e),0!==e.length&&((yield ki())||Ii(e[0].id))}))}function ki(){return yi(this,void 0,void 0,(function*(){return Ti.getValue()}))}function Ii(e){return yi(this,void 0,void 0,(function*(){yield di("currently-playing-id",e,wi),Ti.next(e)}))}function Ci(e){return yi(this,void 0,void 0,(function*(){yield Ii(e.id)}))}function Pi(){return Ti.pipe(Zr(_i),nt((([e,t])=>{var r;return null!==(r=t.find((t=>t.id===e)))&&void 0!==r?r:null})),rt())}function Mi(e){return yi(this,void 0,void 0,(function*(){const t=yield ki();if(t){const r=yield Si(),i=r.findIndex((e=>e.id===t));if(-1!==i){const t=r[i+e];t&&(yield Ci(t))}}}))}function Ri(e,t){return yi(this,void 0,void 0,(function*(){const r=yield Si(),i=bi().allowDuplicates;let n=yield function(e){return yi(this,void 0,void 0,(function*(){let t=[];if(Array.isArray(e))if(Fi(e[0])){const r=yield Promise.all(e.map(Li));for(const e of r)t=t.concat(e)}else t=yield Promise.all(e.map(Di));else t=Fi(e)?yield Li(e):e instanceof FileList?yield Promise.all(Array.from(e).map(Ni)):[yield Di(e)];return t.filter(Ae)}))}(e);if(i||(n=n.filter((e=>-1===r.findIndex((t=>t.src===e.src))))),n.length>0){const e=n.map((e=>Object.assign(Object.assign({},e),{id:or()})));t>=0&&t<r.length?(r.splice(t,0,...e),yield xi(r)):yield xi(r.concat(e))}}))}function Bi(e){return yi(this,void 0,void 0,(function*(){const t=yield Si(),r=Array.isArray(e)?e:[e],i=t.filter((e=>!r.includes(e)));if(i.length!==t.length){const e=yield ki(),t=i.findIndex((t=>t.id===e));-1===t&&(yield Ii("")),yield xi(i)}}))}function Li(e){return yi(this,void 0,void 0,(function*(){return new Promise(((t,r)=>{const i=e.pager.observeItems(),n=e.pager.observeError();i.pipe(Dt(n),Nt(1)).subscribe(t),n.pipe(Dt(i),Nt(1)).subscribe(r),e.pager.fetchAt(0,1e3)}))}))}function Di(e){return yi(this,void 0,void 0,(function*(){return e instanceof File?/^(audio|video)/.test(e.type)?Ni(e):null:e}))}function Ni(e){var t,r,i,n;return yi(this,void 0,void 0,(function*(){let a;try{a=yield(0,fi.Aj)(e,{duration:!0,skipCovers:!0})}catch(t){console.log(`Error parsing file: ${e.name}`),console.log(`music-metadata says: ${t}`),a={format:{},common:{}}}const{common:s,format:o}=a,l=e.type.startsWith("video"),c=o.duration||(yield function(e){return yi(this,void 0,void 0,(function*(){return new Promise((t=>{const r=e.type.startsWith("video"),i=document.createElement(r?"video":"audio"),n=URL.createObjectURL(e),a=()=>{const e=i.error?0:i.duration;i.ondurationchange=null,i.onerror=null,i.src="",i.removeAttribute("src"),URL.revokeObjectURL(n),t(e)};i.ondurationchange=a,i.onerror=a,i.onended=a,i.muted=!0,i.src=n}))}))}(e)),u=(e=0)=>Math.floor(Number(e))||0;return Object.assign(Object.assign({},Se(Ie.Media)),{mediaType:l?yt.Video:yt.Audio,src:`blob:${or()}`,title:s.title||e.name.replace(/\.\w+$/,""),artist:s.artist||(null===(t=s.artists)||void 0===t?void 0:t.join(";"))||"",albumArtist:s.album&&s.albumartist||"",album:s.album||"",genre:(null===(r=s.genre)||void 0===r?void 0:r.join(";"))||"",duration:c?Number(c.toFixed(3)):0,track:u(null===(i=s.track)||void 0===i?void 0:i.no),disc:u(null===(n=s.disk)||void 0===n?void 0:n.no),bpm:u(s.bpm),year:u(s.year),mood:s.mood||"",rating:Number(s.rating)||0,blob:e})}))}function Fi(e){return"itemType"in e&&e.itemType===Ie.Album}const Oi={observe:function(){return _i},observeCurrentItem:Pi,observeCurrentIndex:function(){return Ti.pipe(Zr(_i),nt((([e,t])=>t.findIndex((t=>t.id===e)))),rt())},observeSize:function(){return _i.pipe(nt((e=>e.length)),rt())},getCurrentItem:function(){return yi(this,void 0,void 0,(function*(){const e=yield ki();return e&&(yield Si()).find((t=>t.id===e))||null}))},setCurrentItem:Ci,add:function(e){return yi(this,void 0,void 0,(function*(){yield Ri(e,-1)}))},clear:function(){return yi(this,void 0,void 0,(function*(){yield xi([])}))},insertAt:Ri,moveSelection:function(e,t){return yi(this,void 0,void 0,(function*(){const r=yield Si(),i=r[t];if(e.includes(i))return;const n=r.filter((t=>!e.includes(t))),a=n.indexOf(i);a>=0?(n.splice(a,0,...e),yield xi(n)):yield xi(n.concat(e))}))},next:function(){return yi(this,void 0,void 0,(function*(){yield Mi(1)}))},prev:function(){return yi(this,void 0,void 0,(function*(){yield Mi(-1)}))},remove:Bi,removeAt:function(e){return yi(this,void 0,void 0,(function*(){const t=yield function(e){var t;return yi(this,void 0,void 0,(function*(){const r=yield Si();return null!==(t=r[e])&&void 0!==t?t:null}))}(e);t&&(yield Bi(t))}))},shuffle:function(){return yi(this,void 0,void 0,(function*(){const e=yield Si();let t=e.length;for(;t>0;){const r=Math.floor(Math.random()*t);t--;const i=e[t];e[t]=e[r],e[r]=i}yield xi(e)}))}},zi=Oi;yi(void 0,void 0,void 0,(function*(){var e;yield Si();const t=null!==(e=yield hi("currently-playing-id",wi))&&void 0!==e?e:"";Ti.next(t)}));var Ui={leading:!0,trailing:!1};function ji(e,t,r){void 0===e&&(e=0),void 0===r&&(r=si);var i=-1;return null!=t&&(Ce(t)?r=t:i=t),new Y((function(t){var n,a=(n=e)instanceof Date&&!isNaN(n)?+e-r.now():e;a<0&&(a=0);var s=0;return r.schedule((function(){t.closed||(t.next(s++),0<=i?this.schedule(void 0,i):t.complete())}),a)}))}function Vi(e,t,r){void 0===t&&(t=ai),void 0===r&&(r=Ui);var i=ji(e,t);return function(e,t){return void 0===t&&(t=Ui),We((function(e,r){var n=t.leading,a=t.trailing,s=!1,o=null,l=null,c=!1,u=function(){null==l||l.unsubscribe(),l=null,a&&(f(),c&&r.complete())},h=function(){l=null,c&&r.complete()},d=function(e){return l=Qe(i).subscribe(He(r,u,h))},f=function(){if(s){s=!1;var e=o;o=null,r.next(e),!c&&d()}};e.subscribe(He(r,(function(e){s=!0,o=e,(!l||l.closed)&&(n?f():d())}),(function(){c=!0,(!(a&&s&&l)||l.closed)&&r.complete()})))}))}(0,r)}console.log("module::playback");const Qi=new te({currentItem:null,currentTime:0,startedAt:0,endedAt:0,duration:0,paused:!0});function qi(){return Qi}function Xi(){return qi().pipe(Ft((e=>0!==e.startedAt)),rt(((e,t)=>e.startedAt===t.startedAt)))}function Wi(){return qi().pipe(Ft((e=>0!==e.endedAt)),rt(((e,t)=>e.endedAt===t.endedAt)))}function Hi(){const e=Qi.getValue();e.startedAt&&(e.endedAt||Qi.next(Object.assign(Object.assign({},e),{endedAt:Date.now()})),Qi.next(Object.assign(Object.assign({},e),{startedAt:0,endedAt:0})))}Pi().subscribe((e=>{Hi(),Qi.next(Object.assign(Object.assign({},Qi.getValue()),{currentItem:e,currentTime:0,duration:(null==e?void 0:e.duration)||0,startedAt:0,endedAt:0}))}));const Gi={get paused(){return Qi.getValue().paused},observeState:qi,observePlaybackStart:Xi,observePlaybackEnd:Wi,observePlaybackProgress:function(e=1e4){return Xi().pipe(Ot((()=>qi().pipe(Vi(e,void 0,{trailing:!0}),Dt(Wi())))))},observeCurrentTime:function(){return qi().pipe(nt((e=>e.currentTime)),rt())},observeDuration:function(){return qi().pipe(nt((e=>e.duration)),rt())},observePaused:function(){return qi().pipe(nt((e=>e.paused)),rt())},getCurrentTime:function(){return Qi.getValue().currentTime},setCurrentTime:function(e){const t=Qi.getValue();(e=Math.max(Math.min(Math.floor(isFinite(e)?e:0),t.duration),0))!==t.currentTime&&Qi.next(Object.assign(Object.assign({},t),{currentTime:e}))},getDuration:function(){return Qi.getValue().duration},setDuration:function(e){const t=Qi.getValue();if((e=Math.max(Math.floor(isFinite(e)?e:0),0))!==t.duration){const r=Math.min(t.currentTime,e);Qi.next(Object.assign(Object.assign({},t),{duration:e,currentTime:r}))}},play:function(){const e=Qi.getValue();e.currentItem&&e.paused&&Qi.next(Object.assign(Object.assign({},e),{paused:!1}))},pause:function(){const e=Qi.getValue();e.paused||Qi.next(Object.assign(Object.assign({},e),{paused:!0}))},stop:function(){const e=Qi.getValue();if(!e.paused||0!==e.currentTime||0!==e.startedAt&&0===e.endedAt){const t=Object.assign(Object.assign({},e),{paused:!0,currentTime:0,endedAt:e.endedAt||(e.startedAt?Date.now():0)});Qi.next(t),e.startedAt&&Qi.next(Object.assign(Object.assign({},t),{startedAt:0,endedAt:0}))}},started:function(){const e=Qi.getValue();e.startedAt||Qi.next(Object.assign(Object.assign({},e),{startedAt:Date.now()}))},ended:Hi},$i=Gi;console.log("module::audio");const Yi=new AudioContext,Ki=new AnalyserNode(Yi,{fftSize:2048,smoothingTimeConstant:0});let Ji,Zi;Ki.connect(Yi.destination);const en=new te(Yi.createMediaElementSource(new Audio));function tn(){return en.pipe(rt())}function rn(e){return void 0===e&&(e=1/0),Bt(G,e)}function nn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Re(e),i=Be(e,1/0),n=e;return n.length?1===n.length?Qe(n[0]):rn(i)(Je(n,r)):et}Xi().subscribe((({currentItem:e})=>{if(e.src.startsWith("apple:")){if(!Zi){const e=document.querySelector("audio#apple-music-player");e&&(Zi=Yi.createMediaElementSource(e))}Zi&&en.next(Zi)}else{if(!Ji){const e=document.querySelector("audio.html5-audio");e&&(Ji=Yi.createMediaElementSource(e))}Ji&&en.next(Ji)}})),tn().pipe(Hr(1)).subscribe((e=>e.connect(Ki)));var an,sn,on=function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},ln=function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};class cn{constructor(e,t,r){this.players=e,this.selectPlayer=t,this.loadPlayer=r,this.player$=new te(null),this.error$=new Z,an.set(this,!1),sn.set(this,!1),e.forEach((e=>{e.autoplay=!1,e.muted=!0,e.hidden=!0}))}get hidden(){return on(this,an,"f")}set hidden(e){ln(this,an,e,"f"),this.currentPlayer&&(this.currentPlayer.hidden=e)}get autoplay(){return this.players[0].autoplay}set autoplay(e){this.players.forEach((t=>t.autoplay=e))}get loop(){return this.players[0].loop}set loop(e){this.players.forEach((t=>t.loop=e))}get muted(){return on(this,sn,"f")}set muted(e){ln(this,sn,e,"f"),this.currentPlayer&&(this.currentPlayer.muted=e)}get volume(){return this.players[0].volume}set volume(e){this.players.forEach((t=>t.volume=e))}observeCurrentTime(){return this.observeCurrentPlayer().pipe(Ot((e=>e?e.observeCurrentTime():Ze(0))),rt())}observeDuration(){return this.observeCurrentPlayer().pipe(Ot((e=>e?e.observeDuration():Ze(0))),rt())}observeEnded(){return this.observeCurrentPlayer().pipe(Ot((e=>e?e.observeEnded():et)))}observeError(){return this.observeCurrentPlayer().pipe(Ot((e=>e?nn(this.error$,e.observeError()):et)))}observePlaying(){return this.observeCurrentPlayer().pipe(Ot((e=>e?e.observePlaying():et)))}appendTo(e){this.players.forEach((t=>t.appendTo(e)))}load(e){const t=this.currentPlayer,r=this.selectPlayer(e);if(t&&t!==r&&(t.muted=!0,t.hidden=!0,t.stop()),this.player$.next(r),r)try{this.loadPlayer(r,e),r.muted=this.muted,r.hidden=this.hidden}catch(e){this.error$.next(e)}else this.error$.next(Error("No player found."))}play(){var e;this.autoplay=!0,null===(e=this.currentPlayer)||void 0===e||e.play()}pause(){this.autoplay=!1,this.players.forEach((e=>e.pause()))}stop(){this.autoplay=!1,this.players.forEach((e=>e.stop()))}seek(e){var t;null===(t=this.currentPlayer)||void 0===t||t.seek(e)}resize(e,t){e*t>0&&this.players.forEach((r=>r.resize(e,t)))}get currentPlayer(){return this.player$.getValue()}observeCurrentPlayer(){return this.player$.pipe(rt())}}function un(e){return We((function(t,r){var i=!1,n=0;t.subscribe(He(r,(function(t){return(i||(i=!e(t,n++)))&&r.next(t)})))}))}an=new WeakMap,sn=new WeakMap;var hn=__webpack_require__(1062),dn=__webpack_require__.n(hn),fn=__webpack_require__(6998),mn=__webpack_require__.n(fn),pn=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};console.log("module::youtubeAuth");const gn=new ie("youtubeAuth"),An="https://www.googleapis.com/auth/youtube.readonly",bn=["https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest"],vn=new te("");function yn(){return vn.getValue()}function wn(){return pn(this,void 0,void 0,(function*(){if(""===yn())try{const e=yield function(){return pn(this,void 0,void 0,(function*(){const e=yield En();return new Promise(((t,r)=>{e.initTokenClient({client_id:ut,scope:An,callback:e=>{e.error?r(e.error_description):(vn.next(e.access_token),t(e.access_token))}}).requestAccessToken()}))}))}();vn.next(e),gn.log("Access token successfully obtained.")}catch(e){gn.log("Could not obtain access token."),gn.error(e)}}))}function En(){var e,t;return pn(this,void 0,void 0,(function*(){return(null===(t=null===(e=window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.oauth2)||(yield ve("https://accounts.google.com/gsi/client")),google.accounts.oauth2}))}!function(){pn(this,void 0,void 0,(function*(){const e=(yield function(){return pn(this,void 0,void 0,(function*(){const e=yield function(){return pn(this,void 0,void 0,(function*(){return window.gapi||(yield ve("https://apis.google.com/js/api.js")),window.gapi}))}();return e.client?e.client:new Promise(((t,r)=>{e.load("client",{callback:()=>{const i={apiKey:ct,clientId:ut,discoveryDocs:bn,scope:An};e.client.init(i).then((()=>t(e.client)),r)},onerror:r})}))}))}()).getToken();e&&(gn.log("Access token successfully obtained."),vn.next(e.access_token)),gapi.load("client:auth2",(()=>{gapi.auth2.getAuthInstance().isSignedIn.listen((e=>{if(e){const e=gapi.client.getToken();vn.next((null==e?void 0:e.access_token)||"")}else vn.next("")}))}))}))}();var _n=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))},Tn=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r};const Sn=li("ampcast/youtube-cache","keyval");!function(){_n(this,void 0,void 0,(function*(){const e=yield function(e=ui()){return e("readonly",(t=>{if(t.getAll&&t.getAllKeys)return Promise.all([oi(t.getAllKeys()),oi(t.getAll())]).then((([e,t])=>e.map(((e,r)=>[e,t[r]]))));const r=[];return e("readonly",(e=>function(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},oi(e.transaction)}(e,(e=>r.push([e.key,e.value]))).then((()=>r))))}))}(Sn),t=[],r=Date.now();for(const[i,n]of e)r-n.cachedAt>6048e5&&t.push(i);t.length>0&&(yield function(e,t=ui()){return t("readwrite",(t=>(e.forEach((e=>t.delete(e))),oi(t.transaction))))}(t,Sn))}))}();class xn{constructor(e,t,r){this.defaultConfig={pageSize:xn.maxPageSize},this.nextPageToken=void 0,this.pageNumber=1,this.config=Object.assign(Object.assign({},this.defaultConfig),r),this.pager=new Wt((()=>_n(this,void 0,void 0,(function*(){return this.fetchPage(e,t)}))),this.config)}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeMaxSize(){return this.pager.observeMaxSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createItems({kind:e,items:t=[]},r){return _n(this,void 0,void 0,(function*(){switch(e){case"youtube#playlistListResponse":return t.map((e=>this.createMediaPlaylist(e)));case"youtube#playlistItemListResponse":{const e=t.map((e=>e.contentDetails.videoId));return(yield this.fetchVideos(e,r)).map((e=>this.createMediaItem(e)))}case"youtube#searchListResponse":{const e=t.map((e=>e.id.videoId));return(yield this.fetchVideos(e,r)).map((e=>this.createMediaItem(e)))}default:return t.map((e=>this.createMediaItem(e)))}}))}createMediaPlaylist(e){var t,r,i;return Object.assign(Object.assign({},Se(Ie.Playlist)),{src:`youtube:playlist:${e.id}`,externalUrl:`${kn}/playlist?list=${e.id}`,title:(null===(t=e.snippet)||void 0===t?void 0:t.title)||e.id,thumbnails:this.mapThumbnails(null===(r=e.snippet)||void 0===r?void 0:r.thumbnails),trackCount:null===(i=e.contentDetails)||void 0===i?void 0:i.itemCount,owner:this.createOwner(e.snippet),pager:this.createPlaylistPager(e.id)})}createMediaItem(e){var t,r,i,n,a;return Object.assign(Object.assign({},Se(Ie.Media)),{mediaType:yt.Video,src:`youtube:video:${e.id}`,externalUrl:`${kn}/watch?v=${e.id}`,title:(null===(t=e.snippet)||void 0===t?void 0:t.title)||e.id,duration:this.parseDuration(null===(r=e.contentDetails)||void 0===r?void 0:r.duration),thumbnails:this.mapThumbnails(null===(i=e.snippet)||void 0===i?void 0:i.thumbnails),owner:this.createOwner(e.snippet),globalRating:this.parseNumber(null===(n=e.statistics)||void 0===n?void 0:n.likeCount),globalPlayCount:this.parseNumber(null===(a=e.statistics)||void 0===a?void 0:a.viewCount)})}createOwner({channelId:e="",channelTitle:t=""}){return e?{name:t,url:`${kn}/channel/${e}`}:void 0}createPlaylistPager(e){return new xn("/playlistItems",{playlistId:e,part:"contentDetails",fields:"items(contentDetails(videoId))"})}mapThumbnails(e){if(e)return Object.keys(e).map((t=>e[t]))}parseDuration(e=""){const[,t=0,r=0,i=0]=/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/.exec(e)||[];return 60*Number(t)*60+60*Number(r)+Number(i)||0}fetchPage(e,t){return _n(this,void 0,void 0,(function*(){const r=this.createCacheKey(e,t,this.pageNumber),i=yield this.getFromCache(r),n=this.nextPageToken,a=yield this.fetch(e,Object.assign(Object.assign({},t),{fields:`etag,kind,pageInfo,nextPageToken,${t.fields||"items"}`,maxResults:String(this.config.pageSize),pageToken:n}),i),{pageInfo:s,nextPageToken:o}=a,l=Tn(a,["pageInfo","nextPageToken"]),c=yield this.createItems(l,r),u=null==s?void 0:s.totalResults,h=!o;return this.nextPageToken=o,this.pageNumber++,yield this.saveToCache(r,a),{items:c,total:u,atEnd:h}}))}fetchVideos(e,t){return _n(this,void 0,void 0,(function*(){const r=`${t}/videos`,i=yield this.getFromCache(r),n=yield this.fetch("/videos",{id:e.join(","),part:"contentDetails,snippet,statistics",fields:`etag,${xn.videoFields}`},i);return yield this.saveToCache(r,n),n.items||[]}))}fetch(e,t,r){return _n(this,void 0,void 0,(function*(){const i=(null==r?void 0:r.etag)?{"If-None-Match":r.etag}:void 0;return gapi.client.request({path:`https://www.googleapis.com/youtube/v3${e}`,params:t,headers:i}).then((e=>_n(this,void 0,void 0,(function*(){const{result:t,status:i,statusText:n}=e;if(t)return t;if(304===i&&r)return r;throw Error(n||`Error (${i})`)}))))}))}getFromCache(e){return _n(this,void 0,void 0,(function*(){const t=yield hi(e,Sn);return null!=t?t:null}))}saveToCache(e,t){return _n(this,void 0,void 0,(function*(){this.config.noCache||(yield di(e,Object.assign(Object.assign({},t),{cachedAt:Date.now()}),Sn))}))}createCacheKey(e,t,r){const{fields:i}=t,n=Tn(t,["fields"]);return`${e}?${new URLSearchParams(n)}#${r}`}parseNumber(e){if(null!=e&&!isNaN(Number(e)))return Number(e)}}xn.minPageSize=5,xn.maxPageSize=50,xn.videoFields="items(id,snippet(title,thumbnails,channelId,channelTitle),contentDetails(duration),statistics(viewCount,likeCount))",xn.playlistFields="items(id,snippet(title,thumbnails,channelId,channelTitle),contentDetails(itemCount))";console.log("module::youtube");const kn="https://www.youtube.com",In={view:"card",fields:["Thumbnail","Title","Duration","Owner"]};function Cn(e){return t=this,r=void 0,n=function*(){const t=`${kn}/watch?v=${e}`,r=yield fetch(`${kn}/oembed?url=${t}&format=json`);if(!r.ok)throw r;const i=yield r.json();return Object.assign(Object.assign({},Se(Ie.Media)),{mediaType:yt.Video,src:`youtube:video:${e}`,externalUrl:t,title:i.title,aspectRatio:i.width/i.height||16/9,duration:0,track:0,thumbnails:[{url:i.thumbnail_url,width:i.thumbnail_width,height:i.thumbnail_height}],owner:{name:i.author_name,url:i.author_url}})},new((i=void 0)||(i=Promise))((function(e,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,o)}l((n=n.apply(t,r||[])).next())}));var t,r,i,n}const Pn={id:"youtube",title:"YouTube",icon:"youtube",sources:[{id:"youtube/likes",title:"Likes",icon:"thumbs-up",itemType:Ie.Media,layout:In,search:()=>new xn("/videos",{myRating:"like",part:"snippet,contentDetails,statistics",fields:xn.videoFields})},{id:"youtube/playlists",title:"Playlists",icon:"playlists",itemType:Ie.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","TrackCount","Owner"]},secondaryLayout:In,search:()=>new xn("/playlists",{mine:"true",part:"snippet,contentDetails",fields:xn.playlistFields})}],searches:[{id:"youtube/search/video",title:"Video",icon:"",itemType:Ie.Media,layout:In,searchable:!0,search:e=>e?new xn("/search",{q:e,type:"video",videoCategoryId:"10",part:"id",fields:"items(id(videoId))"},{maxSize:xn.maxPageSize,noCache:!0}):new tt}],observeIsLoggedIn:function(){return vn.pipe(rt()).pipe(nt((e=>""!==e)),rt())},login:wn,logout:function(){return pn(this,void 0,void 0,(function*(){const e=yn();e&&(yield En()).revoke(e,(()=>vn.next("")))}))}};var Mn,Rn,Bn=function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},Ln=function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};const Dn=(e,t)=>e.width===t.width&&e.height===t.height,Nn=16/9,Fn={autohide:1,autoplay:0,controls:0,disablekb:1,enablejsapi:1,fs:0,iv_load_policy:3,modestbranding:1,rel:0,showinfo:0};var On;!function(e){e[e.UNSTARTED=-1]="UNSTARTED",e[e.ENDED=0]="ENDED",e[e.PLAYING=1]="PLAYING",e[e.PAUSED=2]="PAUSED",e[e.BUFFERING=3]="BUFFERING",e[e.CUED=5]="CUED"}(On||(On={}));class zn{constructor(e,{startTime:t=0}={}){this.player=null,this.src$=new te(""),this.size$=new te({width:0,height:0}),this.error$=new Z,this.ready$=new Z,this.state$=new te(On.UNSTARTED),this.autoplay=!1,this.loop=!1,Mn.set(this,!0),Rn.set(this,1);const r=this.element=document.createElement("div"),i=document.createElement("div"),n=document.createElement("div"),a=this.logger=new ie(`YouTubePlayer(${e})`);this.targetId=`youtube-iframe-${e}`,r.hidden=!0,r.className="youtube-video",i.className="youtube-video-wrapper",n.id=this.targetId,i.append(n),r.append(i),this.observeReady().pipe(Bt((()=>this.observeSrc())),un((e=>!e)),Rt((e=>{const r=this.player,[,i,n]=e.split(":");if(n)if("playlist"===i){const e={list:n,listType:i,startSeconds:t};this.autoplay?r.loadPlaylist(e):r.cuePlaylist(e)}else this.autoplay?r.loadVideoById(n,t):r.cueVideoById(n,t);else r.stopVideo()}))).subscribe(a),this.observeReady().pipe(Bt((()=>this.observeVideoSize())),Rt((({width:e,height:t})=>this.player.setSize(e,t)))).subscribe(a),this.observeState().pipe(Ft((e=>e===On.ENDED&&this.loop)),Rt((()=>this.player.seekTo(0,!0)))).subscribe(a),this.observeState().pipe(Ft((e=>e===On.PLAYING)),Rt((()=>this.element.style.visibility=""))).subscribe(a),this.observeError().subscribe(a.error)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e,e&&(this.element.style.visibility="hidden")}get muted(){return Bn(this,Mn,"f")}set muted(e){Bn(this,Mn,"f")!==e&&(Ln(this,Mn,e,"f"),this.player&&(e?this.player.mute():0!==this.volume&&this.player.unMute()))}get volume(){return Bn(this,Rn,"f")}set volume(e){Bn(this,Rn,"f")!==e&&(Ln(this,Rn,e,"f"),this.player&&(this.player.setVolume(100*e),0===e?this.player.mute():this.muted||this.player.unMute()))}observeCurrentTime(){return this.observeState().pipe(Ot((e=>{var t;return e===On.PLAYING?ji(250-Math.round(1e3*this.player.getCurrentTime())%250,250).pipe(nt((()=>this.player.getCurrentTime())),Dt(this.observeState().pipe(Hr(1)))):Ze((null===(t=this.player)||void 0===t?void 0:t.getCurrentTime())||0)})))}observeDuration(){return this.observeState().pipe(nt((()=>{var e;return(null===(e=this.player)||void 0===e?void 0:e.getDuration())||0})),Ft((e=>0!==e)),rt())}observeEnded(){return this.observeState().pipe(Ft((e=>e===On.ENDED&&!this.loop)),nt((()=>{})))}observeError(){return this.error$}observePlaying(){return this.observeState().pipe(Ft((e=>e===On.PLAYING)),nt((()=>{})))}appendTo(e){if(e.appendChild(this.element),!this.player){const e=dn()(this.targetId,{playerVars:Fn});e.on("ready",(({target:e})=>{this.player=e,e.setVolume(100*this.volume),(this.muted||0===this.volume)&&e.mute(),this.ready$.next(void 0)})),e.on("stateChange",(({data:e})=>{this.state$.next(e)})),e.on("error",(e=>{this.error$.next(e)}))}}load(e){this.autoplay&&!this.player?this.error$.next(Error("YouTube player not loaded.")):this.autoplay&&this.player&&e===this.src?this.player.playVideo():this.src$.next(e)}play(){this.player?this.player.playVideo():this.error$.next(Error("YouTube player not loaded."))}pause(){var e;null===(e=this.player)||void 0===e||e.pauseVideo()}stop(){var e;null===(e=this.player)||void 0===e||e.stopVideo()}seek(e){var t;null===(t=this.player)||void 0===t||t.seekTo(e,!0)}resize(e,t){this.size$.next({width:e,height:t})}destroy(){var e;null===(e=this.player)||void 0===e||e.destroy(),this.element.remove()}get src(){return this.src$.getValue()}observeAspectRatio(){return this.observeVideoId().pipe(Ot((e=>e?this.getAspectRatio(e):Ze(Nn))),rt())}observeReady(){return this.ready$.pipe(Nt(1))}observeSize(){return this.size$.pipe(rt(Dn),Ft((({width:e,height:t})=>e*t>0)))}observeSrc(){return this.src$.pipe(rt())}observeState(){return this.state$}observeVideoId(){return this.observeState().pipe(nt((()=>{var e;return this.getVideoId((null===(e=this.player)||void 0===e?void 0:e.getVideoUrl())||"")})),rt())}observeVideoSize(){return Ct([this.observeSize(),this.observeAspectRatio()]).pipe(nt((([{width:e,height:t},r])=>{const i=Math.max(Math.round(e/r),t);return{width:Math.max(Math.round(i*r),e),height:i}})),rt(Dn))}getAspectRatio(e){return Je(Cn(e)).pipe(Dt(ji(3e3)),Dt(this.observeVideoId().pipe(Hr(1))),nt((({aspectRatio:e})=>e||Nn)),Lt((t=>(this.logger.log(`Could not obtain oembed info: videoId='${e}' (status=${t.status})`),t.status>=400&&(401===t.status?this.error$.next(Error("Embedding prevented by channel owner.")):403===t.status?this.error$.next(Error("Private video.")):404===t.status?this.error$.next(Error("Video does not exist.")):this.error$.next(`Error: ${t.statusText} (${t.status})`)),Ze(Nn)))))}getPlayerState(){return this.player?this.player.getPlayerState():On.UNSTARTED}getPlaylist(){var e;return(null===(e=this.player)||void 0===e?void 0:e.getPlaylist())||[]}getVideoId(e){return e.startsWith("youtube:")?e.replace("youtube:video:",""):mn()(e)||""}}Mn=new WeakMap,Rn=new WeakMap;const Un=new r("plex"),jn={get clientId(){let e=Un.getItem("clientId");return e||(e=or(),Un.setItem("clientId",e)),e},get connection(){const e=Un.getItem("connection");return e?JSON.parse(e):null},set connection(e){Un.setItem("connection",JSON.stringify(e))},get host(){var e;return(null===(e=this.connection)||void 0===e?void 0:e.uri)||""},get libraryId(){return Un.getItem("libraryId")||""},set libraryId(e){Un.setItem("libraryId",e)},get server(){const e=Un.getItem("server");return e?JSON.parse(e):null},set server(e){Un.setItem("server",JSON.stringify(e))},get serverToken(){var e;return(null===(e=this.server)||void 0===e?void 0:e.accessToken)||""},get userToken(){return Un.getItem("userToken")||""},set userToken(e){Un.setItem("userToken",e)},get userId(){return Un.getItem("userId")||""},set userId(e){Un.setItem("userId",e)},clear(){const e=this.clientId;Un.clear(),e&&Un.setItem("clientId",e)}};var Vn=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};function Qn({host:e=jn.host,path:t,method:r="GET",params:i,headers:n,body:a,token:s,keepalive:o}){return Vn(this,void 0,void 0,(function*(){if(!e)throw Error("No Plex connection.");(t=i?`${t}?${new URLSearchParams(i)}`:t).startsWith("/")||(t=`/${t}`),s||(s=e===jn.host?jn.serverToken:jn.userToken);const l=yield window.fetch(`${e}${t}`,{method:r,headers:Object.assign(Object.assign({},n),qn(s)),body:a,keepalive:o});if(!l.ok)throw Error(l.statusText);return l}))}function qn(e){const t={"X-Plex-Product":"ampcast","X-Plex-Version":"0.4.7","X-Plex-Platform":ge.displayName,"X-Plex-Platform-Version":ge.version,"X-Plex-Device":ge.os,"X-Plex-Device-Name":ge.displayName,"X-Plex-Client-Identifier":jn.clientId,"X-Plex-Model":"hosted","Accept-Encoding":"gzip, deflate, br"};return e&&(t["X-Plex-Token"]=e),t}console.log("module::plexApi");const Xn={fetch:Qn,fetchJSON:function(e){var{headers:t,body:r}=e,i=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(e,["headers","body"]);return Vn(this,void 0,void 0,(function*(){return t=Object.assign(Object.assign({},t),{Accept:"application/json"}),r&&(t=Object.assign(Object.assign({},t),{"Content-Type":"application/json"}),r=JSON.stringify(r)),(yield Qn(Object.assign({headers:t,body:r},i))).json()}))},getPlayableUrlFromSrc:function(e){const{host:t,serverToken:r}=jn;if(t&&r){const[,,i]=e.split(":");return`${t}${i}?X-Plex-Token=${r}`}throw Error("Not logged in.")}},Wn=Xn;class Hn{constructor(e){this.error$=new Z,this.src="",this.loadedSrc="",this.autoplay=!1;const t=this.element=document.createElement(e);t.hidden=!0,t.muted=!0,t.autoplay=!1,t.className=`html5-${e}`,t.crossOrigin="anonymous",Kr(t,"error").pipe(nt((()=>t.error))).subscribe(this.error$);const r=new ie(`HTML5Player.${e}`);this.observeError().subscribe(r.error)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e}get loop(){return this.element.loop}set loop(e){this.element.loop=e}get muted(){return this.element.muted}set muted(e){this.element.muted=e}get volume(){return this.element.volume}set volume(e){this.element.volume=e}observeCurrentTime(){return Kr(this.element,"timeupdate").pipe(nt((()=>this.element.currentTime)),nt((e=>isFinite(e)?e:0)))}observeDuration(){return Kr(this.element,"durationchange").pipe(nt((()=>this.element.duration)),nt((e=>isFinite(e)?e:0)))}observeEnded(){return Kr(this.element,"ended").pipe(nt((()=>{})))}observeError(){return this.error$}observePlaying(){return Kr(this.element,"playing").pipe(nt((()=>{})))}appendTo(e){e.appendChild(this.element)}load(e){this.src=e;try{const t=this.getMediaSource(this.src);this.loadedSrc=e,this.element.setAttribute("src",t),this.autoplay&&this.element.play().then(void 0,(e=>this.error$.next(e)))}catch(e){this.error$.next(e)}}play(){try{const e=this.getMediaSource(this.src);this.src!==this.loadedSrc&&(this.loadedSrc=this.src,this.element.setAttribute("src",e)),this.element.play().then(void 0,(e=>this.error$.next(e)))}catch(e){this.error$.next(e)}}pause(){this.element.pause()}stop(){this.element.pause(),this.element.currentTime=0}seek(e){this.element.currentTime=e}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}getMediaSource(e){return e.startsWith("jellyfin:")?fr.getPlayableUrlFromSrc(e):e.startsWith("plex:")?Wn.getPlayableUrlFromSrc(e):e}}const Gn=new Hn("video"),$n=new zn("ambient",{startTime:120}),Yn=new cn([Gn,$n],(function(e){return e?e.startsWith("youtube:")?$n:Gn:null}),(function(e,t){e.load(t)}));Yn.loop=!0,Yn.volume=0,Yn.hidden=!0;const Kn=Yn;class Jn{constructor(){this.autoplay=!1,this.loop=!0,this.muted=!0,this.volume=0}observeCurrentTime(){return et}observeDuration(){return et}observeEnded(){return et}observeError(){return et}observePlaying(){return et}seek(){}}const Zn=new ie("AmpShade"),ea=2*Math.PI,ta=Math.PI/2,ra=ea/3600;class ia{constructor(e,t={}){let r;if(this._ready=!1,this._gradients={classic:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )",{pos:.6,color:"hsl( 60, 100%, 50% )"},"hsl( 120, 100%, 50% )"]},prism:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 50% )","hsl( 240, 100%, 50% )"]},rainbow:{bgColor:"#111",dir:"h",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 47% )","hsl( 240, 100%, 58% )","hsl( 300, 100%, 50% )","hsl( 360, 100%, 50% )"]}},this._container=e||document.body,this._defaultWidth=this._container.clientWidth||640,this._defaultHeight=this._container.clientHeight||270,t.source&&(r=t.source.context));else if(r=t.audioCtx);else try{r=new(window.AudioContext||window.webkitAudioContext)}catch(e){throw new na("ERR_AUDIO_CONTEXT_FAIL","Could not create audio context. Web Audio API not supported?")}if(!r.createGain)throw new na("ERR_INVALID_AUDIO_CONTEXT","Provided audio context is not valid");const i=this._analyzer=[r.createAnalyser(),r.createAnalyser()],n=this._splitter=r.createChannelSplitter(2),a=this._merger=r.createChannelMerger(2);this._input=r.createGain(),this._output=r.createGain(),this._sources=[],t.source&&this.connectInput(t.source);for(const e of[0,1])n.connect(i[e],e);a.connect(this._output),this._outNodes=[],!1!==t.connectSpeakers&&this.connectOutput(),this._energy={val:0,peak:0,hold:0};const s=document.createElement("canvas");s.style="max-width: 100%;",this._canvasCtx=s.getContext("2d");for(const e of["_scaleX","_scaleR"])this[e]=document.createElement("canvas").getContext("2d");this._fsEl=t.fsElement||s;const o=()=>{this._fsTimeout||(this._fsTimeout=window.setTimeout((()=>{this._fsChanging||(this._setCanvas("resize"),this._fsTimeout=0)}),60))};window.ResizeObserver&&new ResizeObserver(o).observe(this._container),window.addEventListener("resize",o),s.addEventListener("fullscreenchange",(()=>{this._fsChanging=!0,this._fsTimeout&&window.clearTimeout(this._fsTimeout),this._setCanvas("fschange"),this._fsTimeout=window.setTimeout((()=>{this._fsChanging=!1,this._fsTimeout=0}),60)}));const l=()=>{"suspended"==r.state&&r.resume(),window.removeEventListener("click",l)};window.addEventListener("click",l),this._calcAux(),this._setProps(t,!0),this.useCanvas&&this._container.appendChild(s),this._ready=!0,this._setCanvas("create")}get alphaBars(){return this._alphaBars}set alphaBars(e){this._alphaBars=!!e,this._calcAux()}get barSpace(){return this._barSpace}set barSpace(e){this._barSpace=+e||0,this._calcAux()}get fftSize(){return this._analyzer[0].fftSize}set fftSize(e){for(const t of[0,1])this._analyzer[t].fftSize=e;const t=this._analyzer[0].frequencyBinCount;this._fftData=[new Uint8Array(t),new Uint8Array(t)],this._calcBars()}get gradient(){return this._gradient}set gradient(e){if(!this._gradients.hasOwnProperty(e))throw new na("ERR_UNKNOWN_GRADIENT",`Unknown gradient: '${e}'`);this._gradient=e,this._makeGrad()}get height(){return this._height}set height(e){this._height=e,this._setCanvas("user")}get ledBars(){return this._showLeds}set ledBars(e){this._showLeds=!!e,this._calcAux()}get loRes(){return this._loRes}set loRes(e){this._loRes=!!e,this._setCanvas("lores")}get lumiBars(){return this._lumiBars}set lumiBars(e){this._lumiBars=!!e,this._calcAux(),this._calcLeds(),this._makeGrad()}get maxDecibels(){return this._analyzer[0].maxDecibels}set maxDecibels(e){for(const t of[0,1])this._analyzer[t].maxDecibels=e}get maxFreq(){return this._maxFreq}set maxFreq(e){if(e<1)throw new na("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._maxFreq=e,this._calcBars()}get minDecibels(){return this._analyzer[0].minDecibels}set minDecibels(e){for(const t of[0,1])this._analyzer[t].minDecibels=e}get minFreq(){return this._minFreq}set minFreq(e){if(e<1)throw new na("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._minFreq=e,this._calcBars()}get mirror(){return this._mirror}set mirror(e){this._mirror=0|Math.sign(e),this._calcAux(),this._calcBars(),this._makeGrad()}get mode(){return this._mode}set mode(e){const t=0|e;if(!(t>=0&&t<=10&&9!=t))throw new na("ERR_INVALID_MODE",`Invalid mode: ${e}`);this._mode=t,this._calcAux(),this._calcBars(),this._makeGrad()}get outlineBars(){return this._outlineBars}set outlineBars(e){this._outlineBars=!!e,this._calcAux()}get radial(){return this._radial}set radial(e){this._radial=!!e,this._calcAux(),this._calcBars(),this._makeGrad()}get reflexRatio(){return this._reflexRatio}set reflexRatio(e){if((e=+e||0)<0||e>=1)throw new na("ERR_REFLEX_OUT_OF_RANGE","Reflex ratio must be >= 0 and < 1");this._reflexRatio=e,this._calcAux(),this._makeGrad(),this._calcLeds()}get showLeds(){return this.ledBars}set showLeds(e){this.ledBars=e}get smoothing(){return this._analyzer[0].smoothingTimeConstant}set smoothing(e){for(const t of[0,1])this._analyzer[t].smoothingTimeConstant=e}get spinSpeed(){return this._spinSpeed}set spinSpeed(e){e=+e||0,void 0!==this._spinSpeed&&0!=e||(this._spinAngle=-ta),this._spinSpeed=e}get splitGradient(){return this._splitGradient}set splitGradient(e){this._splitGradient=!!e,this._makeGrad()}get stereo(){return this._stereo}set stereo(e){this._stereo=!!e,this._input.disconnect(),this._input.connect(this._stereo?this._splitter:this._analyzer[0]),this._analyzer[0].disconnect(),this._outNodes.length&&this._analyzer[0].connect(this._stereo?this._merger:this._output),this._calcAux(),this._createScales(),this._calcLeds(),this._makeGrad()}get volume(){return this._output.gain.value}set volume(e){this._output.gain.value=e}get width(){return this._width}set width(e){this._width=e,this._setCanvas("user")}get audioCtx(){return this._input.context}get canvas(){return this._canvasCtx.canvas}get canvasCtx(){return this._canvasCtx}get connectedSources(){return this._sources}get connectedTo(){return this._outNodes}get energy(){return this.getEnergy()}get fps(){return this._fps}get fsHeight(){return this._fsHeight}get fsWidth(){return this._fsWidth}get isAlphaBars(){return this._isAlphaBars}get isFullscreen(){return(document.fullscreenElement||document.webkitFullscreenElement)===this._fsEl}get isLedBars(){return this._isLedDisplay}get isLedDisplay(){return this.isLedBars}get isLumiBars(){return this._isLumiBars}get isOctaveBands(){return this._isOctaveBands}get isOn(){return void 0!==this._runId}get isOutlineBars(){return this._isOutline}get peakEnergy(){return this.getEnergy("peak")}get pixelRatio(){return this._pixelRatio}static get version(){return"3.6.0"}connectInput(e){const t=e instanceof HTMLMediaElement;if(!t&&!e.connect)throw new na("ERR_INVALID_AUDIO_SOURCE","Audio source must be an instance of HTMLMediaElement or AudioNode");const r=t?this.audioCtx.createMediaElementSource(e):e;return this._sources.includes(r)||(r.connect(this._input),this._sources.push(r)),r}connectOutput(e=this.audioCtx.destination){if(!this._outNodes.includes(e)&&(this._output.connect(e),this._outNodes.push(e),1==this._outNodes.length))for(const e of[0,1])this._analyzer[e].connect(this._stereo||e?this._merger:this._output,0,e)}disconnectInput(e){e?Array.isArray(e)||(e=[e]):e=Array.from(this._sources);for(const t of e){const e=this._sources.indexOf(t);e>=0&&(t.disconnect(this._input),this._sources.splice(e,1))}}disconnectOutput(e){if((!e||this._outNodes.includes(e))&&(this._output.disconnect(e),this._outNodes=e?this._outNodes.filter((t=>t!==e)):[],0==this._outNodes.length))for(const e of[0,1])this._analyzer[e].disconnect()}getBars(){return Array.from(this._bars,(({posX:e,freqLo:t,freqHi:r,hold:i,peak:n,value:a})=>({posX:e,freqLo:t,freqHi:r,hold:i,peak:n,value:a})))}getEnergy(e,t){if(void 0===e)return this._energy.val;if(e!=+e){if("peak"==e)return this._energy.peak;const r={bass:[20,250],lowMid:[250,500],mid:[500,2e3],highMid:[2e3,4e3],treble:[4e3,16e3]};if(!r[e])return null;[e,t]=r[e]}const r=this._freqToBin(e),i=t?this._freqToBin(t):r,n=this._stereo+1;let a=0;for(let e=0;e<n;e++)for(let t=r;t<=i;t++)a+=this._fftData[e][t];return a/(i-r+1)/n/255}registerGradient(e,t){if("string"!=typeof e||0==e.trim().length)throw new na("ERR_GRADIENT_INVALID_NAME","Gradient name must be a non-empty string");if("object"!=typeof t)throw new na("ERR_GRADIENT_NOT_AN_OBJECT","Gradient options must be an object");if(void 0===t.colorStops||t.colorStops.length<2)throw new na("ERR_GRADIENT_MISSING_COLOR","Gradient must define at least two colors");this._gradients[e]={bgColor:t.bgColor||"#111",dir:t.dir,colorStops:t.colorStops},e==this._gradient&&this._makeGrad()}setCanvasSize(e,t){this._width=e,this._height=t,this._setCanvas("user")}setFreqRange(e,t){if(e<1||t<1)throw new na("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._minFreq=Math.min(e,t),this._maxFreq=Math.max(e,t),this._calcBars()}setLedParams(e){let t,r,i;e&&(t=0|e.maxLeds,r=+e.spaceV,i=+e.spaceH),this._ledParams=t>0&&r>0&&i>=0?[t,r,i]:void 0,this._calcLeds()}setOptions(e){this._setProps(e)}setSensitivity(e,t){for(const r of[0,1])this._analyzer[r].minDecibels=Math.min(e,t),this._analyzer[r].maxDecibels=Math.max(e,t)}toggleAnalyzer(e){const t=this.isOn;return void 0===e&&(e=!t),t&&!e?(cancelAnimationFrame(this._runId),this._runId=void 0):!t&&e&&(this._frame=this._fps=0,this._time=performance.now(),this._runId=requestAnimationFrame((e=>this._draw(e)))),this.isOn}toggleFullscreen(){if(this.isFullscreen)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{const e=this._fsEl;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}}_calcAux(){const e=this.canvas,t=this._radial,r=this._stereo&&!t,i=e.width>>1;this._radius=Math.min(e.width,e.height)*(this._stereo?.375:.125)|0,this._barSpacePx=Math.min(this._barWidth-1,this._barSpace>0&&this._barSpace<1?this._barWidth*this._barSpace:this._barSpace),this._isOctaveBands=this._mode%10!=0,this._isLedDisplay=this._showLeds&&this._isOctaveBands&&!t,this._isLumiBars=this._lumiBars&&this._isOctaveBands&&!t,this._isAlphaBars=this._alphaBars&&!this._isLumiBars&&10!=this._mode,this._isOutline=this._outlineBars&&this._isOctaveBands&&!this._isLumiBars&&!this._isLedDisplay,this._maximizeLeds=!this._stereo||this._reflexRatio>0&&!this._isLumiBars,this._channelHeight=e.height-(r&&!this._isLedDisplay?.5:0)>>r,this._analyzerHeight=this._channelHeight*(this._isLumiBars||t?1:1-this._reflexRatio)|0,this._channelGap=r?e.height-2*this._channelHeight:0,this._analyzerWidth=e.width-i*(0!=this._mirror),this._initialX=i*(-1==this._mirror&&!t)}_calcBars(){const e=this._bars=[];if(!this._ready)return;const t=e=>e*this.audioCtx.sampleRate/this.fftSize||1,r=(t,r,i,n,a,s,o)=>e.push({posX:t,binLo:r,binHi:i,freqLo:n,freqHi:a,ratioLo:s,ratioHi:o,peak:[0,0],hold:[0],value:[0]}),i=this._analyzerWidth,n=this._initialX,a=this._maxFreq,s=this._minFreq;let o,l;if(this._isOctaveBands){let c=[];for(let e=0;e<11;e++)for(let r=0;r<24;r++){const i=16.351597831287332*1.029302236643492**(24*e+r),n=this._freqToBin(i,"floor"),a=t(n),s=(i-a)/(t(n+1)-a);c.push({freq:i,bin:n,ratio:s})}const u=[0,1,2,3,4,6,8,12,24][this._mode];for(let i=0;i<c.length;i+=u){let{freq:n,bin:o,ratio:l}=c[i],{freq:h,bin:d,ratio:f}=c[i+u-1];const m=e.length,p=e[m-1];if(h>a||d>=this.fftSize/2){p.binHi++,p.ratioHi=0,p.freqHi=t(p.binHi);break}if(n>=s){if(m>0){const r=o-p.binHi;r>1&&(p.binHi=o-(r>>1),p.ratioHi=0,p.freqHi=t(p.binHi),m>1&&p.binHi>p.binLo&&p.binLo>e[m-2].binHi&&(p.ratioLo=0,p.freqLo=t(p.binLo)),o=p.binHi+1),d>o&&o>p.binHi&&(l=0,n=t(o))}r(0,o,d,n,h,l,f)}}this._barWidth=i/e.length,e.forEach(((e,t)=>e.posX=n+t*this._barWidth)),o=Math.log10(e[0].freqLo),l=i/(Math.log10(e[e.length-1].freqHi)-o)}else{this._barWidth=1,o=Math.log10(s),l=i/(Math.log10(a)-o);const c=this._freqToBin(s,"floor"),u=this._freqToBin(a);let h=-999;for(let i=c;i<=u;i++){const a=t(i),s=n+Math.round(l*(Math.log10(a)-o));s>h?(r(s,i,i,a,a,0,0),h=s):e.length&&(e[e.length-1].binHi=i,e[e.length-1].freqHi=a)}}this._minLog=o,this._logWidth=l,this._calcAux(),this._createScales(),this._calcLeds()}_calcLeds(){if(!this._isOctaveBands||!this._ready)return;const e=this._pixelRatio/(window.devicePixelRatio>1&&window.screen.height<=540?2:1),t=this._ledParams,[r,i,n]=t||[[],[128,3,.45],[128,4,.225],[96,6,.225],[80,6,.225],[80,6,.125],[64,6,.125],[48,8,.125],[24,16,.125]][this._mode];let a,s,o=this._analyzerHeight;if(t){const t=2*e;let n;a=r+1;do{a--,n=o/a/(1+i),s=n*i}while((n<t||s<t)&&a>1)}else{const t=540/i;s=Math.min(i*e,Math.max(2,o/t+.1|0))}this._maximizeLeds&&(o+=s),t||(a=Math.min(r,o/(2*s)|0)),this._leds=[a,n>=1?n:this._barWidth*n,s,o/a-s]}_createScales(){const e=[16,31,63,125,250,500,1e3,2e3,4e3,8e3,16e3],t=this._canvasCtx.canvas,r=this._scaleX,i=this._scaleR,n=r.canvas,a=i.canvas,s=.03*Math.min(t.width,t.height)|0;a.width=a.height=(this._radius<<1)+this._stereo*s;const o=a.width>>1,l=o-.7*s,c=(e,r)=>{const n=ea*(e/t.width),a=n-ta,s=l*Math.cos(a),c=l*Math.sin(a);i.save(),i.translate(o+s,o+c),i.rotate(n),i.fillText(r,0,0),i.restore()};n.width|=0,r.fillStyle=i.strokeStyle="#000c",r.fillRect(0,0,n.width,n.height),i.arc(o,o,o-s/2,0,ea),i.lineWidth=s,i.stroke(),r.fillStyle=i.fillStyle="#fff",r.font=(n.height>>1)+"px sans-serif",i.font=(s>>1)+"px sans-serif",r.textAlign=i.textAlign="center";for(const i of e){const e=i>=1e3?i/1e3+"k":i,a=this._logWidth*(Math.log10(i)-this._minLog);a>=0&&a<=this._analyzerWidth&&(r.fillText(e,this._initialX+a,.75*n.height),a<this._analyzerWidth&&c(a,e),this._mirror&&(r.fillText(e,(this._initialX||t.width)-a,.75*n.height),a>10&&c(-a,e)))}}_draw(e){const t=this._canvasCtx,r=t.canvas,i=this._scaleX.canvas,n=this._scaleR.canvas,a=this._energy,s=this._mode,o=this._isAlphaBars,l=this._isLedDisplay,c=this._isLumiBars,u=this._isOctaveBands,h=this._isOutline,d=this._radial,f=this._stereo,m=+this.lineWidth,p=this._mirror,g=this._channelHeight,A=this._channelGap,b=this._analyzerHeight,v=d?r.width:this._analyzerWidth,y=this._initialX,w=y+v,E=r.width>>1,_=r.height>>1,T=this._radius,S=d?Math.min(E,_)-T:b,x=this.useCanvas;a.val>0&&(this._spinAngle+=this._spinSpeed*ra);const k=e=>{if(e&&m){const e=t.globalAlpha;t.globalAlpha=1,t.stroke(),t.globalAlpha=e}},I=(e,t,i)=>{const n=T+t,a=i*ea*(e/r.width)+this._spinAngle;return[E+n*Math.cos(a),_+n*Math.sin(a)]},C=(e,r,i,n,a)=>{t.beginPath();for(const a of p?[1,-1]:[1])t.moveTo(...I(e,r,a)),t.lineTo(...I(e,r+n,a)),t.lineTo(...I(e+i,r+n,a)),t.lineTo(...I(e+i,r,a));k(a),t.fill()},[P,M,R,B]=this._leds||[],L=e=>(e*P|0)*(B+R)-R,D=!this.showBgColor||l&&!this.overlay?"#000":this._gradients[this._gradient].bgColor;let N=this._barWidth-(u?Math.max(l?M:0,this._barSpacePx):0);0!=this._barSpace||l||(N|=0);let F=0;const O=this._bars.length;for(let e=0;e<f+1;e++){const n=g*e+A*e,a=n+g,u=n+b-(l&&!this._maximizeLeds?R:0);if(x){if(this.overlay&&t.clearRect(0,n-A,r.width,g+A),this.overlay&&!this.showBgColor||(this.overlay&&(t.globalAlpha=this.bgAlpha),t.fillStyle=D,d&&0!=e||t.fillRect(y,n-A,v,(this.overlay&&1==this.reflexAlpha?b:g)+A),t.globalAlpha=1),this.showScaleY&&!c&&!d){const e=i.height,a=e>>1,s=this._analyzer[0].minDecibels,o=this._analyzer[0].maxDecibels,l=b/(o-s);t.fillStyle="#888",t.font=`${a}px sans-serif`,t.textAlign="right",t.lineWidth=1;for(let i=o;i>s;i-=5){const s=n+(o-i)*l,c=i%2==0|0;if(c){const o=s+a*(s==n?.8:.35);-1!=p&&t.fillText(i,.85*e,o),1!=p&&t.fillText(i,r.width-.1*e,o),t.strokeStyle="#888",t.setLineDash([2,4]),t.lineDashOffset=0}else t.strokeStyle="#555",t.setLineDash([2,8]),t.lineDashOffset=1;t.beginPath(),t.moveTo(y+e*c*(-1!=p),.5+~~s),t.lineTo(w-e*c*(1!=p),.5+~~s),t.stroke()}t.setLineDash([]),t.lineDashOffset=0}l?(t.setLineDash([B,R]),t.lineWidth=N):t.lineWidth=h?Math.min(m,N/2):m,t.fillStyle=t.strokeStyle=this._canvasGradient}const P=this._fftData[e];this._analyzer[e].getByteFrequencyData(P);const z=(e,t)=>P[e]+(P[e+1]-P[e])*t;t.beginPath();let U=[];for(let r=0;r<O;r++){const i=this._bars[r],{binLo:f,binHi:g,ratioLo:A,ratioHi:b}=i;let v=Math.max(z(f,A),z(g,b));for(let e=f+1;e<g;e++)P[e]>v&&(v=P[e]);if(v/=255,i.value[e]=v,F+=v,i.peak[e]>0&&(i.hold[e]--,i.hold[e]<0&&(i.peak[e]+=i.hold[e]/S)),v>=i.peak[e]&&(i.peak[e]=v,i.hold[e]=30),!x)continue;c||o?t.globalAlpha=v:h&&(t.globalAlpha=this.fillAlpha),l?(v=L(v),v<0&&(v=0)):v=v*S|0,d&&1==e&&(v*=-1);let E=N,_=i.posX;if(10==s){const i=r?0:(P[this._bars[1].binLo]/255*S*(!d||!e||-1)+v)/2;if(d){if(0==r&&t.lineTo(...I(0,_<0?i:v,1)),_>=0){const e=[_,v];t.lineTo(...I(...e,1)),U.push(e)}}else{if(0==r)if(-1!=p){const e=f?P[f-1]/255*S:v;t.moveTo(y-m,u-e)}else t.moveTo(y,u-(_<y?i:v));(-1!=p||_>=y)&&t.lineTo(_,u-v)}}else if(s>0&&(l?_+=Math.max(M/2,this._barSpacePx/2):0==this._barSpace?(_|=0,r>0&&_>this._bars[r-1].posX+N&&(_--,E++)):_+=this._barSpacePx/2),l){const e=_+N/2;if(this.showBgColor&&!this.overlay){const r=t.globalAlpha;t.beginPath(),t.moveTo(e,n),t.lineTo(e,u),t.strokeStyle="#7f7f7f22",t.globalAlpha=1,t.stroke(),t.strokeStyle=t.fillStyle,t.globalAlpha=r}t.beginPath(),t.moveTo(e,c?n:u),t.lineTo(e,c?a:u-v),t.stroke()}else if(_>=y)if(d)C(_,0,E,v,h);else{const e=_,r=c?n:u,i=E,s=c?a:-v;t.beginPath(),t.moveTo(e,r),t.lineTo(e,r+s),t.lineTo(e+i,r+s),t.lineTo(e+i,r),k(h),t.fill()}const T=i.peak[e];T>0&&this.showPeaks&&!c&&_>=y&&_<w&&(h&&m>0?t.globalAlpha=1:o&&(t.globalAlpha=T),l?t.fillRect(_,u-L(T),N,B):d?10!=s&&C(_,T*S*(!e||-1),E,-2):t.fillRect(_,u-T*S,E,2))}if(x){if(t.globalAlpha=1,10==s){if(d){if(p){let e;for(;e=U.pop();)t.lineTo(...I(...e,-1))}t.closePath()}m>0&&t.stroke(),this.fillAlpha>0&&(d?(t.moveTo(E+T,_),t.arc(E,_,T,0,ea,!0)):(t.lineTo(w,u),t.lineTo(y,u)),t.globalAlpha=this.fillAlpha,t.fill(),t.globalAlpha=1)}if(this._reflexRatio>0&&!c){let i,a;this.reflexFit||f?(i=f&&0==e?g+A:0,a=g-b):(i=r.height-2*b,a=b),t.globalAlpha=this.reflexAlpha,1!=this.reflexBright&&(t.filter=`brightness(${this.reflexBright})`),t.setTransform(1,0,0,-1,0,r.height),t.drawImage(r,0,n,r.width,b,0,i,r.width,a),t.setTransform(1,0,0,1,0,0),t.filter="none",t.globalAlpha=1}}}a.val=F/(O<<f),a.val>=a.peak?(a.peak=a.val,a.hold=30):a.hold>0?a.hold--:a.peak>0&&(a.peak*=(30+a.hold--)/30),x&&(p&&!d&&(t.setTransform(-1,0,0,1,r.width-y,0),t.drawImage(r,y,0,E,r.height,0,0,E,r.height),t.setTransform(1,0,0,1,0,0)),t.setLineDash([]),this.showScaleX&&(d?(t.save(),t.translate(E,_),this._spinSpeed&&t.rotate(this._spinAngle+ta),t.drawImage(n,-n.width>>1,-n.width>>1),t.restore()):t.drawImage(i,0,r.height-i.height))),this._frame++;const z=e-this._time;if(z>=1e3&&(this._fps=this._frame/(z/1e3),this._frame=0,this._time=e),this.showFPS){const e=i.height;t.font=`bold ${e}px sans-serif`,t.fillStyle="#0f0",t.textAlign="right",t.fillText(Math.round(this._fps),r.width-e,2*e)}this.onCanvasDraw&&(t.save(),t.fillStyle=t.strokeStyle=this._canvasGradient,this.onCanvasDraw(this),t.restore()),this._runId=requestAnimationFrame((e=>this._draw(e)))}_freqToBin(e,t="round"){const r=this._analyzer[0].frequencyBinCount-1,i=Math[t](e*this.fftSize/this.audioCtx.sampleRate);return i<r?i:r}_makeGrad(){if(!this._ready)return;const e=this._canvasCtx,t=e.canvas,r=this._isLumiBars,i=r?t.height:t.height*(1-this._reflexRatio*!this._stereo)|0,n=1-this._reflexRatio,a=this._initialX,s=t.width>>1,o=t.height>>1,l=Math.min(s,o),c=this._radius,u=this._gradients[this._gradient],h=u.colorStops,d="h"==u.dir;let f;if(f=this._radial?e.createRadialGradient(s,o,l,s,o,c-(l-c)*this._stereo):e.createLinearGradient(...d?[a,0,a+this._analyzerWidth,0]:[0,0,0,i]),h){const e=this._stereo&&!this._splitGradient&&!d,t=(e,t)=>f.addColorStop(e,t.color||t);for(let i=0;i<1+e;i++)h.forEach(((a,s)=>{const o=h.length-1;let l=void 0!==a.pos?a.pos:s/o;if(e&&(l/=2),!this._stereo||r||this._radial||d||(l*=n,!e&&l>.5*n&&(l+=.5*this._reflexRatio)),1==i)if(this._radial||r){const e=o-s;l=1-(void 0!==(a=h[e]).pos?a.pos:e/o)/2}else 0==s&&l>0&&t(.5,a),l+=.5;t(l,a),this._stereo&&s==o&&l<.5&&t(.5,a)}))}this._canvasGradient=f}_setCanvas(e){if(!this._ready)return;const t=this._canvasCtx,r=t.canvas,i=this._scaleX.canvas,n=window.devicePixelRatio/(this._loRes+1);let a=window.screen.width*n,s=window.screen.height*n;90==Math.abs(window.orientation)&&a<s&&([a,s]=[s,a]);const o=this.isFullscreen,l=o&&this._fsEl==r,c=l?a:(this._width||this._container.clientWidth||this._defaultWidth)*n|0,u=l?s:(this._height||this._container.clientHeight||this._defaultHeight)*n|0;this._pixelRatio=n,this._fsWidth=a,this._fsHeight=s,r.width==c&&r.height==u||(r.width=c,r.height=u,this._calcAux(),this.overlay||(t.fillStyle="#000",t.fillRect(0,0,c,u)),t.lineJoin="bevel",i.width=c,i.height=Math.max(20*n,Math.min(c,u)/27|0),this._makeGrad(),this._calcBars(),void 0!==this._fsStatus&&this._fsStatus!==o&&(e="fschange"),this._fsStatus=o,this.onCanvasResize&&this.onCanvasResize(e,this))}_setProps(e,t){const r={alphaBars:!1,barSpace:.1,bgAlpha:.7,fftSize:8192,fillAlpha:1,gradient:"classic",ledBars:!1,lineWidth:0,loRes:!1,lumiBars:!1,maxDecibels:-25,maxFreq:22e3,minDecibels:-85,minFreq:20,mirror:0,mode:0,outlineBars:!1,overlay:!1,radial:!1,reflexAlpha:.15,reflexBright:1,reflexFit:!0,reflexRatio:0,showBgColor:!0,showFPS:!1,showPeaks:!0,showScaleX:!0,showScaleY:!1,smoothing:.5,spinSpeed:0,splitGradient:!1,start:!0,stereo:!1,useCanvas:!0,volume:1},i=["onCanvasDraw","onCanvasResize"],n=Object.keys(r).filter((e=>"start"!=e)).concat(i,["height","width"]);e&&void 0!==e.showLeds&&void 0===e.ledBars&&(e.ledBars=e.showLeds),(t||void 0===e)&&(e={...r,...e});for(const t of Object.keys(e))i.includes(t)&&"function"!=typeof e[t]?this[t]=void 0:n.includes(t)&&(this[t]=e[t]);void 0!==e.start&&this.toggleAnalyzer(e.start)}}class na extends Error{constructor(e,t){super(t),this.name="AudioMotionError",this.code=e}}const aa=[{name:"Anemone",options:{radial:!0,ledBars:!1,spinSpeed:1,mode:8,barSpace:0,gradient:"rainbow",reflexRatio:.4,showPeaks:!0,mirror:-1,maxFreq:8e3,lineWidth:2,fillAlpha:.2}},{name:"Classic LEDs",options:{mode:7,barSpace:0,gradient:"classic",ledBars:!0,lumiBars:!1,radial:!1,reflexRatio:0,showPeaks:!0}},{name:"Mirror wave",options:{mode:10,fillAlpha:.6,gradient:"rainbow",lineWidth:2,mirror:-1,radial:!1,reflexAlpha:1,reflexBright:1,reflexRatio:.5,showPeaks:!1}},{name:"Radial overlay",options:{mode:5,barSpace:.1,gradient:"prism",radial:!0,ledBars:!1,showPeaks:!0,spinSpeed:1}},{name:"Reflex Bars",options:{mode:5,barSpace:.25,gradient:"rainbow",lumiBars:!1,radial:!1,reflexAlpha:.25,reflexBright:1,reflexFit:!0,reflexRatio:.3,ledBars:!1,showPeaks:!0}}],sa=new ie("AudioMotion");var oa=__webpack_require__(2238),la=__webpack_require__.n(oa),ca=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};const ua=new te([]);function ha(){return ua.getValue()}setTimeout((()=>ca(void 0,void 0,void 0,(function*(){yield ve("./lib/butterchurn-presets-base.min.js");const e=window.butterchurnPresets;e&&(ua.next(Object.keys(e).map((t=>({name:t,data:e[t]})))),setTimeout((()=>ca(void 0,void 0,void 0,(function*(){yield ve("./lib/butterchurn-presets-extra.min.js");const e=window.butterchurnPresetsExtra;e&&ua.next(ua.getValue().concat(Object.keys(e).map((t=>({name:t,data:e[t]})))))}))),1e3))}))),1e3);const da={get size(){return ha().length},observe:function(){return ua},find:function(e){return ua.getValue().find((t=>t.name===e))||null},get:ha,getNames:function(){return ua.getValue().map((e=>e.name))}},fa=new ie("Milkdrop");function ma(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var r=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function pa(e){return Math.min(1,Math.max(0,e))}function ga(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function Aa(e){return e<=1?"".concat(100*Number(e),"%"):e}function ba(e){return 1===e.length?"0"+e:String(e)}function va(e,t,r){e=ma(e,255),t=ma(t,255),r=ma(r,255);var i=Math.max(e,t,r),n=Math.min(e,t,r),a=0,s=0,o=(i+n)/2;if(i===n)s=0,a=0;else{var l=i-n;switch(s=o>.5?l/(2-i-n):l/(i+n),i){case e:a=(t-r)/l+(t<r?6:0);break;case t:a=(r-e)/l+2;break;case r:a=(e-t)/l+4}a/=6}return{h:a,s,l:o}}function ya(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*r*(t-e):r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function wa(e,t,r){e=ma(e,255),t=ma(t,255),r=ma(r,255);var i=Math.max(e,t,r),n=Math.min(e,t,r),a=0,s=i,o=i-n,l=0===i?0:o/i;if(i===n)a=0;else{switch(i){case e:a=(t-r)/o+(t<r?6:0);break;case t:a=(r-e)/o+2;break;case r:a=(e-t)/o+4}a/=6}return{h:a,s:l,v:s}}function Ea(e,t,r,i){var n=[ba(Math.round(e).toString(16)),ba(Math.round(t).toString(16)),ba(Math.round(r).toString(16))];return i&&n[0].startsWith(n[0].charAt(1))&&n[1].startsWith(n[1].charAt(1))&&n[2].startsWith(n[2].charAt(1))?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function _a(e){return Ta(e)/255}function Ta(e){return parseInt(e,16)}var Sa={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var xa="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),ka="[\\s|\\(]+(".concat(xa,")[,|\\s]+(").concat(xa,")[,|\\s]+(").concat(xa,")\\s*\\)?"),Ia="[\\s|\\(]+(".concat(xa,")[,|\\s]+(").concat(xa,")[,|\\s]+(").concat(xa,")[,|\\s]+(").concat(xa,")\\s*\\)?"),Ca={CSS_UNIT:new RegExp(xa),rgb:new RegExp("rgb"+ka),rgba:new RegExp("rgba"+Ia),hsl:new RegExp("hsl"+ka),hsla:new RegExp("hsla"+Ia),hsv:new RegExp("hsv"+ka),hsva:new RegExp("hsva"+Ia),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Pa(e){return Boolean(Ca.CSS_UNIT.exec(String(e)))}var Ma=function(){function e(t,r){var i;if(void 0===t&&(t=""),void 0===r&&(r={}),t instanceof e)return t;"number"==typeof t&&(t=function(e){return{r:e>>16,g:(65280&e)>>8,b:255&e}}(t)),this.originalInput=t;var n=function(e){var t,r,i,n={r:0,g:0,b:0},a=1,s=null,o=null,l=null,c=!1,u=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(Sa[e])e=Sa[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var r=Ca.rgb.exec(e);return r?{r:r[1],g:r[2],b:r[3]}:(r=Ca.rgba.exec(e))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=Ca.hsl.exec(e))?{h:r[1],s:r[2],l:r[3]}:(r=Ca.hsla.exec(e))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=Ca.hsv.exec(e))?{h:r[1],s:r[2],v:r[3]}:(r=Ca.hsva.exec(e))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=Ca.hex8.exec(e))?{r:Ta(r[1]),g:Ta(r[2]),b:Ta(r[3]),a:_a(r[4]),format:t?"name":"hex8"}:(r=Ca.hex6.exec(e))?{r:Ta(r[1]),g:Ta(r[2]),b:Ta(r[3]),format:t?"name":"hex"}:(r=Ca.hex4.exec(e))?{r:Ta(r[1]+r[1]),g:Ta(r[2]+r[2]),b:Ta(r[3]+r[3]),a:_a(r[4]+r[4]),format:t?"name":"hex8"}:!!(r=Ca.hex3.exec(e))&&{r:Ta(r[1]+r[1]),g:Ta(r[2]+r[2]),b:Ta(r[3]+r[3]),format:t?"name":"hex"}}(e)),"object"==typeof e&&(Pa(e.r)&&Pa(e.g)&&Pa(e.b)?(t=e.r,r=e.g,i=e.b,n={r:255*ma(t,255),g:255*ma(r,255),b:255*ma(i,255)},c=!0,u="%"===String(e.r).substr(-1)?"prgb":"rgb"):Pa(e.h)&&Pa(e.s)&&Pa(e.v)?(s=Aa(e.s),o=Aa(e.v),n=function(e,t,r){e=6*ma(e,360),t=ma(t,100),r=ma(r,100);var i=Math.floor(e),n=e-i,a=r*(1-t),s=r*(1-n*t),o=r*(1-(1-n)*t),l=i%6;return{r:255*[r,s,a,a,o,r][l],g:255*[o,r,r,s,a,a][l],b:255*[a,a,o,r,r,s][l]}}(e.h,s,o),c=!0,u="hsv"):Pa(e.h)&&Pa(e.s)&&Pa(e.l)&&(s=Aa(e.s),l=Aa(e.l),n=function(e,t,r){var i,n,a;if(e=ma(e,360),t=ma(t,100),r=ma(r,100),0===t)n=r,a=r,i=r;else{var s=r<.5?r*(1+t):r+t-r*t,o=2*r-s;i=ya(o,s,e+1/3),n=ya(o,s,e),a=ya(o,s,e-1/3)}return{r:255*i,g:255*n,b:255*a}}(e.h,s,l),c=!0,u="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(a=e.a)),a=ga(a),{ok:c,format:e.format||u,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a}}(t);this.originalInput=t,this.r=n.r,this.g=n.g,this.b=n.b,this.a=n.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(i=r.format)&&void 0!==i?i:n.format,this.gradientType=r.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=n.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},e.prototype.getLuminance=function(){var e=this.toRgb(),t=e.r/255,r=e.g/255,i=e.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(e){return this.a=ga(e),this.roundA=Math.round(100*this.a)/100,this},e.prototype.toHsv=function(){var e=wa(this.r,this.g,this.b);return{h:360*e.h,s:e.s,v:e.v,a:this.a}},e.prototype.toHsvString=function(){var e=wa(this.r,this.g,this.b),t=Math.round(360*e.h),r=Math.round(100*e.s),i=Math.round(100*e.v);return 1===this.a?"hsv(".concat(t,", ").concat(r,"%, ").concat(i,"%)"):"hsva(".concat(t,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var e=va(this.r,this.g,this.b);return{h:360*e.h,s:e.s,l:e.l,a:this.a}},e.prototype.toHslString=function(){var e=va(this.r,this.g,this.b),t=Math.round(360*e.h),r=Math.round(100*e.s),i=Math.round(100*e.l);return 1===this.a?"hsl(".concat(t,", ").concat(r,"%, ").concat(i,"%)"):"hsla(".concat(t,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(e){return void 0===e&&(e=!1),Ea(this.r,this.g,this.b,e)},e.prototype.toHexString=function(e){return void 0===e&&(e=!1),"#"+this.toHex(e)},e.prototype.toHex8=function(e){return void 0===e&&(e=!1),function(e,t,r,i,n){var a,s=[ba(Math.round(e).toString(16)),ba(Math.round(t).toString(16)),ba(Math.round(r).toString(16)),ba((a=i,Math.round(255*parseFloat(a)).toString(16)))];return n&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}(this.r,this.g,this.b,this.a,e)},e.prototype.toHex8String=function(e){return void 0===e&&(e=!1),"#"+this.toHex8(e)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),r=Math.round(this.b);return 1===this.a?"rgb(".concat(e,", ").concat(t,", ").concat(r,")"):"rgba(".concat(e,", ").concat(t,", ").concat(r,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var e=function(e){return"".concat(Math.round(100*ma(e,255)),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var e=function(e){return Math.round(100*ma(e,255))};return 1===this.a?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var e="#"+Ea(this.r,this.g,this.b,!1),t=0,r=Object.entries(Sa);t<r.length;t++){var i=r[t],n=i[0];if(e===i[1])return n}return!1},e.prototype.toString=function(e){var t=Boolean(e);e=null!=e?e:this.format;var r=!1,i=this.a<1&&this.a>=0;return t||!i||!e.startsWith("hex")&&"name"!==e?("rgb"===e&&(r=this.toRgbString()),"prgb"===e&&(r=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(r=this.toHexString()),"hex3"===e&&(r=this.toHexString(!0)),"hex4"===e&&(r=this.toHex8String(!0)),"hex8"===e&&(r=this.toHex8String()),"name"===e&&(r=this.toName()),"hsl"===e&&(r=this.toHslString()),"hsv"===e&&(r=this.toHsvString()),r||this.toHexString()):"name"===e&&0===this.a?this.toName():this.toRgbString()},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.l+=t/100,r.l=pa(r.l),new e(r)},e.prototype.brighten=function(t){void 0===t&&(t=10);var r=this.toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(-t/100*255))),r.g=Math.max(0,Math.min(255,r.g-Math.round(-t/100*255))),r.b=Math.max(0,Math.min(255,r.b-Math.round(-t/100*255))),new e(r)},e.prototype.darken=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.l-=t/100,r.l=pa(r.l),new e(r)},e.prototype.tint=function(e){return void 0===e&&(e=10),this.mix("white",e)},e.prototype.shade=function(e){return void 0===e&&(e=10),this.mix("black",e)},e.prototype.desaturate=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.s-=t/100,r.s=pa(r.s),new e(r)},e.prototype.saturate=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.s+=t/100,r.s=pa(r.s),new e(r)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var r=this.toHsl(),i=(r.h+t)%360;return r.h=i<0?360+i:i,new e(r)},e.prototype.mix=function(t,r){void 0===r&&(r=50);var i=this.toRgb(),n=new e(t).toRgb(),a=r/100;return new e({r:(n.r-i.r)*a+i.r,g:(n.g-i.g)*a+i.g,b:(n.b-i.b)*a+i.b,a:(n.a-i.a)*a+i.a})},e.prototype.analogous=function(t,r){void 0===t&&(t=6),void 0===r&&(r=30);var i=this.toHsl(),n=360/r,a=[this];for(i.h=(i.h-(n*t>>1)+720)%360;--t;)i.h=(i.h+n)%360,a.push(new e(i));return a},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){void 0===t&&(t=6);for(var r=this.toHsv(),i=r.h,n=r.s,a=r.v,s=[],o=1/t;t--;)s.push(new e({h:i,s:n,v:a})),a=(a+o)%1;return s},e.prototype.splitcomplement=function(){var t=this.toHsl(),r=t.h;return[this,new e({h:(r+72)%360,s:t.s,l:t.l}),new e({h:(r+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var r=this.toRgb(),i=new e(t).toRgb();return new e({r:i.r+(r.r-i.r)*r.a,g:i.g+(r.g-i.g)*r.a,b:i.b+(r.b-i.b)*r.a})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var r=this.toHsl(),i=r.h,n=[this],a=360/t,s=1;s<t;s++)n.push(new e({h:(i+s*a)%360,s:r.s,l:r.l}));return n},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function Ra(e,t){var r=new Ma(e),i=new Ma(t);return(Math.max(r.getLuminance(),i.getLuminance())+.05)/(Math.min(r.getLuminance(),i.getLuminance())+.05)}function Ba(e,t,r){void 0===r&&(r={includeFallbackColors:!1,level:"AA",size:"small"});for(var i=null,n=0,a=r.includeFallbackColors,s=r.level,o=r.size,l=0,c=t;l<c.length;l++){var u=c[l],h=Ra(e,u);h>n&&(n=h,i=new Ma(u))}return function(e,t,r){var i,n;void 0===r&&(r={level:"AA",size:"small"});var a=Ra(e,t);switch((null!==(i=r.level)&&void 0!==i?i:"AA")+(null!==(n=r.size)&&void 0!==n?n:"small")){case"AAsmall":case"AAAlarge":return a>=4.5;case"AAlarge":return a>=3;case"AAAsmall":return a>=7;default:return!1}}(e,i,{level:s,size:o})||!a?i:(r.includeFallbackColors=!1,Ba(e,["#fff","#000"],r))}const La=JSON.parse('{"name":"Black Gold","backgroundColor":"#0d0c0c","textColor":"#cbccad","frameColor":"#0e0e0c","frameTextColor":"#e8e8bf","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.25,"flat":false}'),Da=JSON.parse('{"name":"Boring Skyblue","backgroundColor":"#08090a","textColor":"#7ccaf8","frameColor":"#333738","frameTextColor":"#d2d2d2","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#163d5a","selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0,"flat":false}'),Na=JSON.parse('{"name":"Grey Green","backgroundColor":"#0f0f10","textColor":"#d1f5d2","frameColor":"#24322c","frameTextColor":"#c3feca","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.25,"flat":false}'),Fa=JSON.parse('{"name":"Indigo","backgroundColor":"#06181e","textColor":"#d1d3f5","frameColor":"#43477a","frameTextColor":"#f3f3f7","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#4b4049","selectedTextColor":"#ffffff","evenRowBackgroundColor":null,"spacing":0.625,"roundness":0.84375,"flat":true}'),Oa=JSON.parse('{"name":"Lemon","backgroundColor":"#e7fdfc","textColor":"#000000","frameColor":"#e8d502","frameTextColor":"#180c06","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#aaaaaa","selectedTextColor":"#000000","evenRowBackgroundColor":null,"spacing":0.375,"roundness":0,"flat":true}'),za=JSON.parse('{"name":"Lilac","backgroundColor":"#12051a","textColor":"#f5d1ed","frameColor":"#79437a","frameTextColor":"#f3f7f3","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.625,"roundness":0.84375,"flat":true}'),Ua=JSON.parse('{"name":"Moody Blue","backgroundColor":"#000000","textColor":"#bec1c0","frameColor":"#125673","frameTextColor":"#d8eee7","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.53125,"roundness":0.40625,"flat":false}'),ja=JSON.parse('{"name":"Olive Oil","backgroundColor":"#1e1710","textColor":"#cbccad","frameColor":"#81810e","frameTextColor":"#181816","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.25,"flat":false}'),Va=JSON.parse('{"name":"Pale Pink","backgroundColor":"#f7f7f7","textColor":"#120f0c","frameColor":"#cfbdd0","frameTextColor":"#121211","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.53125,"flat":true}'),Qa=JSON.parse('{"name":"Purplelicious (Winamp)","backgroundColor":"#000000","textColor":"#ffb464","frameColor":"#3e0445","frameTextColor":"#ffb464","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#3e0445","selectedTextColor":"#ffb464","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),qa=JSON.parse('{"name":"Saddle","backgroundColor":"#271607","textColor":"#cbbe86","frameColor":"#331d0a","frameTextColor":"#fedfc3","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.34375,"flat":false}'),Xa=JSON.parse('{"name":"Seaweed","backgroundColor":"#244319","textColor":"#bef3c5","frameColor":"#3b722c","frameTextColor":"#fcfcf7","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":"#54e3da","mediaButtonTextColor":null,"selectedBackgroundColor":"#04958b","selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.78125,"roundness":0.8125,"flat":true}'),Wa=JSON.parse('{"name":"Tangerine","backgroundColor":"#eaf2c5","textColor":"#2e1f05","frameColor":"#e89f02","frameTextColor":"#180c06","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#adaaaa","selectedTextColor":"#000000","evenRowBackgroundColor":null,"spacing":0.46875,"roundness":1,"flat":false}'),Ha=JSON.parse('{"name":"Winamp Amber","backgroundColor":"#000000","textColor":"#e79a36","frameColor":"#383757","frameTextColor":"#d2d2d2","buttonColor":"#464379","buttonTextColor":"#ebebeb","mediaButtonColor":"#cccccc","mediaButtonTextColor":"#111111","selectedBackgroundColor":"#76490e","selectedTextColor":"#ebebeb","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),Ga=JSON.parse('{"name":"Winamp Classic","backgroundColor":"#000000","textColor":"#00e200","frameColor":"#383757","frameTextColor":"#d2d2d2","buttonColor":"#464379","buttonTextColor":"#d2d2d2","mediaButtonColor":"#cccccc","mediaButtonTextColor":"#111111","selectedBackgroundColor":"#040dae","selectedTextColor":"#d2d2d2","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),$a=JSON.parse('{"name":"Winamp Modern (WACUP)","backgroundColor":"#14121c","textColor":"#8ac440","frameColor":"#1f1f36","frameTextColor":"#f0f0f0","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":"#cccccc","mediaButtonTextColor":"#111111","selectedBackgroundColor":"#2f2f76","selectedTextColor":"#f0f0f0","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),Ya={name:"",backgroundColor:"#000000",textColor:"#ebebeb",frameColor:"#000000",frameTextColor:"#ebebeb",buttonColor:null,buttonTextColor:null,mediaButtonColor:null,mediaButtonTextColor:null,selectedBackgroundColor:null,selectedTextColor:null,evenRowBackgroundColor:null,spacing:.375,roundness:.25,flat:!1},Ka=[Ya,La,Da,Na,Fa,Oa,za,Ua,ja,Va,Qa,qa,Xa,Wa,Ha,Ga,$a],Ja=new r("theme"),Za=new class{constructor(){this.app=document.getElementById("app"),this.popup=document.getElementById("popup"),this.system=document.getElementById("system"),this.theme$=new te(Ya);const e=document.createElement("style");document.head.append(e),this.sheet=e.sheet,this.rootStyle=this.createStyle(":root"),this.appStyle=this.createStyle(".app"),this.playheadStyle=this.createStyle("#playhead"),this.restore()}observe(){return this.theme$}get backgroundColor(){return this.current.backgroundColor}set backgroundColor(e){this.setColor("backgroundColor",e),this.app.classList.toggle("dark",this.isDark),this.app.classList.toggle("light",this.isLight),this.popup.classList.toggle("dark",this.isDark),this.popup.classList.toggle("light",this.isLight)}get buttonColor(){return this.current.buttonColor}set buttonColor(e){this.setColor("buttonColor",e)}get buttonTextColor(){return this.current.buttonTextColor}set buttonTextColor(e){this.setColor("buttonTextColor",e)}get current(){return this.theme$.value}get evenRowBackgroundColor(){return this.current.evenRowBackgroundColor}set evenRowBackgroundColor(e){this.setColor("evenRowBackgroundColor",e)}get flat(){return this.current.flat}set flat(e){this.app.classList.toggle("flat",!!e),this.popup.classList.toggle("flat",!!e),this.theme$.next(Object.assign(Object.assign({},this.current),{flat:e}))}get fontSize(){return Number(this.rootStyle.getPropertyValue("--font-size"))||16}set fontSize(e){this.rootStyle.setProperty("--font-size",String(e)),this.createPlayheadSmiley()}get frameColor(){return this.current.frameColor}set frameColor(e){this.setColor("frameColor",e),this.app.classList.toggle("frame-light",this.isFrameLight),this.app.classList.toggle("frame-dark",this.isFrameDark),this.popup.classList.toggle("frame-light",this.isFrameLight),this.popup.classList.toggle("frame-dark",this.isFrameDark),this.createPlayheadSmiley()}get frameTextColor(){return this.current.frameTextColor}set frameTextColor(e){this.setColor("frameTextColor",e)}get mediaButtonColor(){return this.current.mediaButtonColor}set mediaButtonColor(e){this.setColor("mediaButtonColor",e)}get mediaButtonTextColor(){return this.current.mediaButtonTextColor}set mediaButtonTextColor(e){this.setColor("mediaButtonTextColor",e)}get name(){return this.current.name}set name(e){this.theme$.next(Object.assign(Object.assign({},this.current),{name:e}))}get roundness(){return this.current.roundness}set roundness(e){this.setProperty("roundness",e),this.theme$.next(Object.assign(Object.assign({},this.current),{roundness:e}))}get selectedBackgroundColor(){var e;return null!==(e=this.current.selectedBackgroundColor)&&void 0!==e?e:null}set selectedBackgroundColor(e){if(this.setColor("selectedBackgroundColor",e),this.selectedBackgroundColor){let e=new Ma(this.selectedBackgroundColor).desaturate(40);e=e.isLight()?e.tint(25):e.shade(25),this.setProperty("selected-background-color-blurred",e.toHexString())}}get selectedTextColor(){return this.current.selectedTextColor}set selectedTextColor(e){this.setColor("selectedTextColor",e)}get spacing(){return this.current.spacing}set spacing(e){this.setProperty("spacing",e),this.theme$.next(Object.assign(Object.assign({},this.current),{spacing:e}))}get textColor(){return this.current.textColor}set textColor(e){this.setColor("textColor",e)}get isDark(){return new Ma(this.backgroundColor).isDark()}get isLight(){return new Ma(this.backgroundColor).isLight()}get isFrameDark(){return new Ma(this.frameColor).isDark()}get isFrameLight(){return new Ma(this.frameColor).isLight()}load(e){let t;t="string"==typeof e?Ka.find((t=>t.name===e)):e,t&&Object.assign(this,this.applyDefaults(t))}restore(){const e=this.retrieve("current"),t=e?JSON.parse(e):Ya;Object.assign(this,this.applyDefaults(t)),this.fontSize=Number(this.retrieve("fontSize"))||16,this.app.classList.toggle("dark",this.isDark),this.app.classList.toggle("light",this.isLight),this.app.classList.toggle("frame-light",this.isFrameLight),this.app.classList.toggle("frame-dark",this.isFrameDark),this.popup.classList.toggle("dark",this.isDark),this.popup.classList.toggle("light",this.isLight),this.popup.classList.toggle("frame-light",this.isFrameLight),this.popup.classList.toggle("frame-dark",this.isFrameDark),this.system.classList.toggle("dark",this.isDark),this.system.classList.toggle("light",this.isLight),this.createPlayheadSmiley()}save(){this.store("fontSize",this.fontSize),this.store("current",JSON.stringify(this.current)),this.system.classList.toggle("dark",this.isDark),this.system.classList.toggle("light",this.isLight)}applyDefaults(e){if(!e.selectedBackgroundColor){const t=new Ma(e.textColor),r=t.monochromatic();r.sort(((e,t)=>e.getBrightness()-t.getBrightness())),t.isLight()?e.selectedBackgroundColor=r[1].toHexString():e.selectedBackgroundColor=r[r.length-2].toHexString(),r.push(new Ma("white"),new Ma("black")),e.selectedTextColor=Ba(e.selectedBackgroundColor,r,{includeFallbackColors:!0,level:"AA",size:"large"}).toHexString()}return e}setColor(e,t){"string"==typeof t&&(t=new Ma(t));const r=null==t?void 0:t.toHsl(),i=this.toDashName(e);this.setProperty(`${i}-h`,r?String(r.h):null),this.setProperty(`${i}-s`,r?100*r.s+"%":null),this.setProperty(`${i}-l`,r?100*r.l+"%":null),this.theme$.next(Object.assign(Object.assign({},this.current),{[e]:t?t.toHexString():null}))}setProperty(e,t){this.appStyle.setProperty(`--${e}`,null==t?null:String(t))}createStyle(e){const t=this.sheet.insertRule(`${e}{}`);return this.sheet.cssRules[t].style}get defaultMediaButtonColor(){const e=new Ma(this.frameColor).toHsl();return e.s+=1-.33*e.s,e.l+=1-.5*e.l,new Ma(e).toHexString()}get defaultMediaButtonTextColor(){const e=new Ma(this.defaultMediaButtonColor).toHsl();return e.s-=.5*e.s,e.l-=.9*e.l,new Ma(e).toHexString()}get smileyColor(){return this.mediaButtonTextColor||this.defaultMediaButtonTextColor}createPlayheadSmiley(){const e=new Ma(this.smileyColor).toRgbString(),t=[`<path fill='${e}' d='M 160.5,164.5 C 183.647,162.813 194.147,173.48 192,196.5C 186.494,211.009 175.994,216.842 160.5,214C 145.991,208.494 140.158,197.994 143,182.5C 145.683,173.318 151.517,167.318 160.5,164.5 Z'/>`,`<path fill='${e}' d='M 335.5,164.5 C 358.647,162.813 369.147,173.48 367,196.5C 361.494,211.009 350.994,216.842 335.5,214C 320.991,208.494 315.158,197.994 318,182.5C 320.683,173.318 326.517,167.318 335.5,164.5 Z'/>`,`<path fill='${e}' d='M 164.5,296.5 C 172.699,295.1 179.865,297.1 186,302.5C 201.99,327.582 224.823,341.582 254.5,344.5C 279.499,342.418 299.999,331.751 316,312.5C 318.955,308.756 321.789,304.922 324.5,301C 334.716,294.616 344.55,295.116 354,302.5C 358.296,308.845 359.63,315.845 358,323.5C 334.118,361.698 299.618,382.365 254.5,385.5C 209.382,382.365 174.882,361.698 151,323.5C 148.138,310.557 152.638,301.557 164.5,296.5 Z'/>`].join(""),r=this.createBase64SVG(512,512,t);this.playheadStyle.setProperty("--smiley",r),this.playheadStyle.setProperty("--thumb-size",`${Math.round(1.25*this.fontSize)}px`)}createBase64SVG(e,t,r){return`url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='${e}' height='${t}'>${r}</svg>")`}retrieve(e){return Ja.getItem(e)}store(e,t){Ja.setItem(e,String(t))}toDashName(e){return e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))}},es=new ie("Waveform");console.log("module::visualizer/player");const ts=new ie("visualizer/player"),rs=new class extends Jn{constructor(e,t){super(),this.audioContext=e,this.analyser=t,this.canvas=document.createElement("canvas"),this.gl=this.canvas.getContext("webgl"),this.animationFrameId=0;const r=this.canvas,i=this.gl;r.hidden=!0,r.className="visualizer visualizer-ampshade",this.shader=function(e,t){const r=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(r,"\nattribute vec2 position;\n\nvoid main(void) {\n  gl_Position = vec4(position, 0, 1);\n}\n"),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(r));const i=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(i,"\nprecision mediump float;\n\nuniform float time;\nuniform vec2 resolution;\nuniform sampler2D spectrum;\n\nvoid main(void) {\n  vec3 c;\n  float z = 0.1 * time;\n  vec2 uv = gl_FragCoord.xy / resolution;\n  vec2 p = uv - 0.5;\n  p.x *= resolution.x / resolution.y;\n  float l = 0.2 * length(p);\n  for (int i = 0; i < 3; i++) {\n    z += 0.07;\n    uv += p / l * (sin(z) + 1.0) * abs(sin(l * 9.0 - z * 2.0));\n    c[i] = 0.01 / length(abs(mod(uv, 1.0) - 0.5));\n  }\n  float intensity = texture2D(spectrum, vec2(l, 0.5)).x;\n  gl_FragColor = vec4(c / l * intensity, time);\n}\n"),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(i));const n=e.createProgram();return e.attachShader(n,r),e.attachShader(n,i),e.linkProgram(n),e.useProgram(n),n}(i);const n=i.getAttribLocation(this.shader,"position");i.enableVertexAttribArray(n),this.fragTime=i.getUniformLocation(this.shader,"time"),i.uniform1f(this.fragTime,e.currentTime),this.fragResolution=i.getUniformLocation(this.shader,"resolution"),i.uniform2f(this.fragResolution,r.width,r.height),this.spectrum=new Uint8Array(this.analyser.frequencyBinCount),this.fragSpectrumArray=new Uint8Array(4*this.spectrum.length),function(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}(i),function(e){const t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t);const r=new Float32Array([-1,-1,1,-1,-1,1,1,1]);e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0)}(i)}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e||this.animationFrameId||this.render())}appendTo(e){e.append(this.canvas)}load(){Zn.log("load"),this.play()}play(){Zn.log("play"),this.animationFrameId||this.render()}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){const r=this.canvas,i=this.gl;r.width=e,r.height=t,i.viewport(0,0,e,t),this.fragResolution=i.getUniformLocation(this.shader,"resolution"),i.uniform2f(this.fragResolution,r.width,r.height),this.renderFrame()}clear(){}render(){this.renderFrame(),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((()=>this.render())))}renderFrame(){this.analyser.getByteFrequencyData(this.spectrum),this.gl.uniform1f(this.fragTime,this.audioContext.currentTime),function(e,t,r){for(let e=0;e<t.length;e++)r[4*e+0]=t[e],r[4*e+1]=t[e],r[4*e+2]=t[e],r[4*e+3]=255;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t.length,1,0,e.RGBA,e.UNSIGNED_BYTE,r)}(this.gl,this.spectrum,this.fragSpectrumArray),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}(Yi,Ki),is=new class extends Jn{constructor(e,t){super();const r=this.element=document.createElement("div");r.hidden=!0,r.className="visualizer visualizer-audiomotion",this.audioSourceNode=e.createMediaElementSource(new Audio);const i=this.visualizer=new ia(r,{source:this.audioSourceNode,showBgColor:!1,overlay:!0,showScaleX:!1,showScaleY:!1,connectSpeakers:!1});t.subscribe((e=>{this.audioSourceNode=e,this.element.hidden||i.connectInput(e)}))}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden!==e&&(this.element.hidden=e,e?this.visualizer.disconnectInput():this.visualizer.connectInput(this.audioSourceNode))}appendTo(e){e.append(this.element)}load(e){sa.log("load");const t=aa.find((t=>t.name===e));t&&(sa.log(`Using AudioMotion preset: ${t.name}`),this.visualizer.setOptions(t.options)),this.autoplay&&this.play()}play(){sa.log("play"),this.visualizer.toggleAnalyzer(!0)}pause(){this.visualizer.toggleAnalyzer(!1)}stop(){this.visualizer.toggleAnalyzer(!0)}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}}(Yi,tn()),ns=new class extends Jn{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"),this.animationFrameId=0,this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-milkdrop",(this.visualizer=la().createVisualizer(e.context,this.canvas,{width:400,height:200})).connectAudio(e)}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e?this.visualizer.disconnectAudio(this.analyser):(this.visualizer.connectAudio(this.analyser),this.animationFrameId||this.render()))}appendTo(e){e.append(this.canvas)}load(e){fa.log("load",e);const t=da.find(e);t&&(fa.log(`Using butterchurn preset: ${t.name}`),this.visualizer.loadPreset(t.data,.5)),this.play()}play(){fa.log("play"),this.animationFrameId||this.render()}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){this.canvas.width=e,this.canvas.height=t,this.visualizer.render(),this.visualizer.setRendererSize(e,t),this.visualizer.render()}clear(){const e=this.canvas.width,t=this.canvas.height;this.canvasContext.clearRect(0,0,e,t)}render(){this.visualizer.render(),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((()=>this.render())))}}(Ki),as=new class extends Jn{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"),this.animationFrameId=0,this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-waveform"}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e||this.animationFrameId||this.render())}appendTo(e){e.append(this.canvas)}load(){es.log("load"),this.play()}play(){es.log("play"),this.animationFrameId||this.render()}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){this.canvas.width=e,this.canvas.height=t,this.renderFrame()}clear(){const e=this.canvas.getContext("2d"),t=this.canvas.width,r=this.canvas.height;e.clearRect(0,0,t,r)}render(){this.renderFrame(),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((()=>this.render())))}renderFrame(){const e=this.analyser.frequencyBinCount,t=new Uint8Array(e),r=this.canvasContext,i=this.canvas.width,n=this.canvas.height,a=i/e;let s=0;r.lineWidth=2,Za.isLight&&Za.isFrameLight?r.strokeStyle=Za.frameColor:r.strokeStyle=Za.textColor,r.clearRect(0,0,i,n),r.beginPath(),this.analyser.getByteTimeDomainData(t);for(let i=0;i<e;i++){const e=t[i]/128*n/2;0===i?r.moveTo(s,e):r.lineTo(s,e),s+=a}r.lineTo(i,n/2),r.stroke()}}(Ki),ss=new cn([rs,is,ns,as,Kn],(function(e){switch(e.provider){case"ampshade":return rs;case"audiomotion":return is;case"milkdrop":return ns;case"video":return Kn;case"waveform":return as;default:return null}}),(function(e,t){e.load(t.preset)}));ss.loop=!0,ss.muted=!0,ss.volume=.07;const os=ss;ss.observeError().subscribe(ts.error),ss.observePlaying().subscribe(ts.all("playing")),ss.observeEnded().subscribe(ts.all("ended"));var ls,cs,us=function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},hs=function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};const ds=new ie("MusicKitPlayer"),fs="Apple Music player not connected.";ls=new WeakMap,cs=new WeakMap;const ms=new class{constructor(e){this.isLoggedIn$=e,this.duration$=new Z,this.currentTime$=new Z,this.ended$=new Z,this.playing$=new Z,this.error$=new Z,this.playerReady$=new Z,this.src$=new te(""),this.loadedSrc="",this.isLoggedIn=!1,this.loop=!1,this.autoplay=!1,ls.set(this,!0),cs.set(this,1),this.onPlaybackStateChange=({state:e})=>{if(e===MusicKit.PlaybackStates.ended)this.ended$.next(void 0);else if(e===MusicKit.PlaybackStates.playing){const[,,e]=this.src.split(":"),t=this.player.nowPlayingItem;!1===(null==t?void 0:t.isPlayable)&&(null==t?void 0:t.id)===e?(this.error$.next(Error("Unplayable")),this.player.stop()):this.playing$.next(void 0)}},this.onPlaybackDurationChange=({duration:e})=>{this.duration$.next(e)},this.onPlaybackTimeChange=({currentPlaybackTime:e})=>{this.currentTime$.next(e)},this.onPlaybackError=e=>{console.log("MusicKit::onPlaybackError",e)};const t=this.element=document.createElement("div");t.hidden=!0,t.className="apple-video",t.id="apple-music-video-container",this.observeIsLoggedIn().pipe(Ft((e=>e)),Rt((()=>{const e=this.player=MusicKit.getInstance(),t=MusicKit.Events;e.addEventListener(t.playbackStateDidChange,this.onPlaybackStateChange),e.addEventListener(t.playbackDurationDidChange,this.onPlaybackDurationChange),e.addEventListener(t.playbackTimeDidChange,this.onPlaybackTimeChange),e.addEventListener(t.mediaPlaybackError,this.onPlaybackError),e.volume=this.muted?0:this.volume,this.playerReady$.next(void 0)})),Nt(1)).subscribe(ds),this.observeReady().pipe(Bt((()=>Ct([this.observeSrc(),this.observeIsLoggedIn()]))),Ot((([e,t])=>{if(t&&e&&e!==this.loadedSrc){const[,t,r]=e.split(":");return Je(this.player.setQueue({[t]:r})).pipe(Bt((()=>(this.loadedSrc=e,this.autoplay?this.player.play():et))),Lt((e=>(this.error$.next(e),et))))}return et}))).subscribe(ds),this.observeIsLoggedIn().pipe(un((e=>e===this.isLoggedIn))).subscribe((e=>{var t;this.isLoggedIn=e,!e&&(null===(t=this.player)||void 0===t?void 0:t.isPlaying)&&(this.stop(),this.error$.next(Error(fs)))})),this.observeError().subscribe(ds.error)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e}get muted(){return us(this,ls,"f")}set muted(e){us(this,ls,"f")!==e&&(hs(this,ls,e,"f"),this.player&&(this.player.volume=e?0:this.volume))}get volume(){return us(this,cs,"f")}set volume(e){us(this,cs,"f")!==e&&(hs(this,cs,e,"f"),this.player&&(this.player.volume=this.muted?0:e))}observeCurrentTime(){return this.currentTime$.pipe(rt())}observeDuration(){return this.duration$.pipe(rt())}observePlaying(){return this.playing$}observeEnded(){return this.ended$}observeError(){return this.error$}appendTo(e){e.appendChild(this.element)}load(e){this.src$.next(e),this.player&&this.isLoggedIn?this.autoplay&&e===this.loadedSrc&&this.player.play().then(void 0,(e=>this.error$.next(e))):this.autoplay&&this.error$.next(Error(fs))}play(){this.player&&this.isLoggedIn?this.src===this.loadedSrc&&this.player.play().then(void 0,(e=>this.error$.next(e))):this.error$.next(Error(fs))}pause(){var e;(null===(e=this.player)||void 0===e?void 0:e.isPlaying)&&this.player.pause()}stop(){var e;null===(e=this.player)||void 0===e||e.stop()}seek(e){var t;null===(t=this.player)||void 0===t||t.seekToTime(e)}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}get src(){return this.src$.getValue()}observeIsLoggedIn(){return this.isLoggedIn$}observeReady(){return this.playerReady$.pipe(nt((()=>{})),Nt(1))}observeSrc(){return this.src$.pipe(rt())}}(mt());function ps(e,t){return void 0===e&&(e=0),void 0===t&&(t=ai),e<0&&(e=0),ji(e,e,t)}function gs(){return rn(1)}function As(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return gs()(Je(e,Re(e)))}function bs(e,t){return t?function(r){return As(t.pipe(Nt(1),We((function(e,t){e.subscribe(He(t,L))}))),r.pipe(bs(e)))}:Bt((function(t,r){return e(t,r).pipe(Nt(1),function(e){return nt((function(){return e}))}(t))}))}function vs(e,t){void 0===t&&(t=ai);var r=ji(e,t);return bs((function(){return r}))}var ys=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};console.log("module::spotifyAuth");const ws=new ie("spotifyAuth"),Es=new r("spotify/auth"),_s=location.hostname,Ts=("localhost"===_s?`http://${_s}:${location.port}`:`https://${_s}`)+"/auth/spotify/callback/",Ss="https://accounts.spotify.com",xs=new te("");function ks(){return xs.pipe(rt())}function Is(){return ys(this,void 0,void 0,(function*(){if(""===xs.getValue())try{Ps(yield function(){return ys(this,void 0,void 0,(function*(){const e=function(e){let t="";const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let e=0;e<64;e++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}(),t=yield function(e){return ys(this,void 0,void 0,(function*(){const t=yield crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}))}(e);return Es.setItem("code_verifier",e),new Promise(((e,r)=>{let i=null;const n=t=>{if(/(localhost|ampcast)/.test(t.origin)){if(clearInterval(s),window.removeEventListener("message",n,!1),null==i||i.close(),i=null,t.origin!==location.origin)return void r({message:`Origin ${t.origin} does not match ${location.origin}`});(function(e){return ys(this,void 0,void 0,(function*(){const t=Es.getItem("code_verifier"),r=yield fetch(`${Ss}/api/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({client_id:lt,grant_type:"authorization_code",code:e,redirect_uri:Ts,code_verifier:t})});if(!r.ok)throw r;return yield r.json()}))})(t.data.code).then(e,r)}};window.addEventListener("message",n,!1);const a=new URLSearchParams({client_id:lt,scope:["user-read-recently-played","user-read-playback-position","user-top-read","user-read-playback-state","user-modify-playback-state","user-read-currently-playing","streaming","user-read-email","user-read-private","playlist-read-private","user-library-read"].join(" "),redirect_uri:Ts,response_type:"code",code_challenge_method:"S256",code_challenge:t});i=window.open(`${Ss}/authorize?${a}`,"Spotify","popup");const s=setInterval((()=>{(null==i?void 0:i.closed)&&(clearInterval(s),r({message:"access_denied"}))}),500)}))}))}())}catch(e){ws.log("Could not obtain access token."),ws.error(e)}}))}function Cs(){return ys(this,void 0,void 0,(function*(){const e=Ms(),t=null==e?void 0:e.refresh_token;if(t){const e=yield fetch(`${Ss}/api/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({client_id:lt,grant_type:"refresh_token",refresh_token:t})});if(!e.ok)throw Bs(),Error(e.statusText);const r=yield e.json();return Ps(r),r.access_token}throw Bs(),Error("No 'refresh_token'")}))}function Ps(e){const{access_token:t,refresh_token:r,expires_in:i}=e,n=new Date,a=new Date(n.setSeconds(n.getSeconds()+i)).toISOString();Es.setItem("token",JSON.stringify({access_token:t,refresh_token:r,expires_at:a})),Rs(t),setTimeout(Cs,1e3*i)}function Ms(){const e=JSON.parse(Es.getItem("token")||"null");return e&&(e.expires_at=new Date(e.expires_at)),e}function Rs(e){ws.log("Access token successfully obtained."),xs.next(e)}function Bs(){Es.removeItem("token"),xs.next("")}!function(){ys(this,void 0,void 0,(function*(){const e=Ms();if(e){const t=e.expires_at.getTime()-Date.now();t<=0?yield Cs():(Rs(e.access_token),setTimeout(Cs,t))}}))}();var Ls,Ds,Ns=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))},Fs=function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},Os=function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};const zs=new ie("SpotifyPlayer"),Us="Spotify player not connected.",js=(e,t)=>e.paused===t.paused&&e.position===t.position;Ls=new WeakMap,Ds=new WeakMap;const Vs=new class{constructor(e){this.accessToken$=e,this.player=null,this.paused$=new te(!0),this.src$=new te(""),this.error$=new Z,this.ready$=new Z,this.state$=new te(null),this.loadedSrc="",this.currentTrackSrc="",this.isLoggedIn=!1,this.deviceId="",this.autoplay=!1,this.hidden=!0,this.loop=!1,Ls.set(this,!0),Ds.set(this,1),this.onSpotifyWebPlaybackSDKReady=()=>{zs.log("onSpotifyWebPlaybackSDKReady"),this.observeAccessToken().pipe(Ft((e=>""!==e)),Rt((e=>{let t=!1;const r=new Spotify.Player({name:"ampcast",getOAuthToken:r=>Ns(this,void 0,void 0,(function*(){t&&(e=yield Cs()),t=!0,r(e)})),volume:this.muted?0:this.volume});r.addListener("initialization_error",zs.error),r.addListener("authentication_error",zs.error),r.addListener("account_error",zs.error),r.addListener("playback_error",(e=>this.error$.next(e))),r.addListener("player_state_changed",(e=>this.state$.next(e))),r.addListener("not_ready",(()=>{zs.log("not_ready"),this.deviceId=""})),r.addListener("ready",(({device_id:e})=>{zs.log("ready"),this.player=r,this.deviceId=e,this.ready$.next(void 0)})),r.connect()})),Nt(1)).subscribe(zs)},window.onSpotifyWebPlaybackSDKReady=this.onSpotifyWebPlaybackSDKReady,this.observeReady().pipe(Bt((()=>this.observeIsLoggedIn())),Ot((e=>e?this.observeSrc():et)),Zr(this.observeAccessToken()),Ot((([e,t])=>e&&e!==this.loadedSrc?this.observeNotLoading().pipe(bs((()=>this.loadError?this.reconnect():Ze(0))),Bt((()=>this.addToQueue(e,t))),Bt((()=>this.observeState().pipe(nt((e=>e.track_window.current_track.uri)),un((e=>e===this.currentTrackSrc)),Rt((e=>this.currentTrackSrc=e)),Nt(1)))),Lt((t=>(this.loadedSrc="",this.currentTrackSrc="",this.loadError={src:e,error:t,timeStamp:Date.now()},this.error$.next(t),et))),Rt(zs.all("step5")),Nt(1)):et))).subscribe(zs),this.observeState().pipe(Rt((e=>{this.paused&&!e.paused?this.player.pause().then(void 0,zs.error):e.paused&&!this.paused&&e.track_window.current_track.uri===this.currentTrackSrc&&this.player.resume().then(void 0,(e=>this.error$.next(e)))}))).subscribe(zs),this.observeIsLoggedIn().pipe(un((e=>e===this.isLoggedIn)),Rt((e=>{this.isLoggedIn=e,e||this.paused||(this.stop(),this.error$.next(Error(Us)))}))).subscribe(zs),this.observeError().subscribe(zs.error),ve("https://sdk.scdn.co/spotify-player.js")}get muted(){return Fs(this,Ls,"f")}set muted(e){Fs(this,Ls,"f")!==e&&(Os(this,Ls,e,"f"),this.setVolume(e?0:this.volume))}get volume(){return Fs(this,Ds,"f")}set volume(e){Fs(this,Ds,"f")!==e&&(Os(this,Ds,e,"f"),this.setVolume(this.muted?0:e))}observeCurrentTime(){return nn(this.observeCurrentTrackState(),this.observePaused().pipe(Ot((e=>e?this.getCurrentState():ps(250).pipe(Bt((()=>this.getCurrentState()))))))).pipe(nt((e=>e?e.position/1e3:0)),rt())}observeDuration(){return this.observeSrc().pipe(Ot((e=>e?this.observeCurrentTrackState().pipe(nt((e=>e.duration/1e3)),Nt(1)):Ze(0))))}observeEnded(){return this.observeCurrentTrackState().pipe(rt(js),Zr(this.observePaused()),nt((([e,t])=>!t&&e.paused&&0===e.position)),Ft((e=>e)),nt((()=>{})))}observeError(){return this.error$}observePlaying(){return this.observeCurrentTrackState().pipe(rt(js),Zr(this.observePaused()),nt((([e,t])=>!t&&!e.paused)),Ft((e=>e)),nt((()=>{})))}appendTo(){}load(e){this.src$.next(e),this.player&&this.isLoggedIn?this.autoplay&&(this.paused$.next(!1),e===this.loadedSrc&&this.player.resume().then(void 0,(e=>this.error$.next(e)))):this.autoplay&&this.error$.next(Error(Us))}play(){var e;this.paused$.next(!1),this.player&&this.isLoggedIn?this.src===(null===(e=this.loadError)||void 0===e?void 0:e.src)?this.error$.next(this.loadError.error):this.src===this.loadedSrc&&this.player.resume().then(void 0,(e=>this.error$.next(e))):this.error$.next(Error(Us))}pause(){var e;this.paused$.next(!0),this.loadedSrc&&(null===(e=this.player)||void 0===e||e.pause())}stop(){var e;this.paused$.next(!0),this.loadedSrc&&(null===(e=this.player)||void 0===e||e.seek(0).then((()=>this.player.pause())))}seek(e){var t;null===(t=this.player)||void 0===t||t.seek(1e3*e)}resize(){}get paused(){return this.paused$.getValue()}get src(){return this.src$.getValue()}observeAccessToken(){return this.accessToken$}observeIsLoggedIn(){return this.observeAccessToken().pipe(nt((e=>!!e)),rt())}observeNotLoading(){return this.state$.pipe(nt((e=>!0!==(null==e?void 0:e.loading))),rt(),nt((()=>{})))}observePaused(){return this.paused$.pipe(rt())}observeReady(){return this.ready$.pipe(Nt(1))}observeSrc(){return this.src$.pipe(rt())}observeState(){return this.state$.pipe(Ft(Ae))}observeCurrentTrackState(){return this.observeState().pipe(Ft((e=>e.track_window.current_track.uri===this.currentTrackSrc)),nt((e=>e)))}getCurrentState(){return this.player?this.player.getCurrentState():Promise.resolve(null)}addToQueue(e,t,r=3){return Ns(this,void 0,void 0,(function*(){if(!t)throw Error(Us);const i=yield fetch(`https://api.spotify.com/v1/me/player/play?device_id=${this.deviceId}`,{method:"PUT",body:JSON.stringify({uris:[e],position_ms:0}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!i.ok){if(401===i.status&&r>0){const t=yield Cs();return this.addToQueue(e,t,--r)}throw i}this.loadError=void 0,this.loadedSrc=e}))}reconnect(){return Je(Promise.resolve().then((()=>this.player.disconnect()))).pipe(vs(1e3),Bt((()=>this.player.connect())),vs(1e3),Rt((()=>this.loadError=void 0)),nt((()=>{})))}setVolume(e){return this.player?this.player.setVolume(e).then(void 0,zs.error):Promise.resolve()}}(ks());console.log("module::mediaPlayer");const Qs=new Hn("audio"),qs=new Hn("video"),Xs=new zn("main"),Ws=new cn([Qs,qs,Xs,ms,Vs],(function(e){return e?e.src.startsWith("youtube:")?Xs:e.src.startsWith("apple:")?ms:e.src.startsWith("spotify:")?Vs:e.mediaType===yt.Video?qs:Qs:null}),(function(e,t){if(null==t?void 0:t.unplayable)throw Error("Unplayable.");e.load(function(e){return e?e.blob?URL.createObjectURL(e.blob):e.src||"":""}(t))})),Hs=Ws;console.log("module::mediaPlayback");const Gs=new ie("mediaPlayback"),$s=new r("mediaPlayback"),Ys=new r("mediaPlayback",sessionStorage),Ks=new te(!1);let Js="forward";function Zs(){return Ks.pipe(rt(),Ot((e=>e?et:zi.observeCurrentItem())))}function eo(){return $i.observeCurrentTime()}function to(){return $i.observeDuration()}function ro(){return Hs.observeEnded()}function io(){return $i.observePaused()}function no(){return $i.observePlaybackStart()}function ao(){return $i.observePlaybackEnd()}function so(e){return $i.observePlaybackProgress(e)}function oo(){return $i.observeState()}function lo(){return Hs.observePlaying()}function co(e){Gs.log("load",null==e?void 0:e.title),Hs.load(e)}function uo(){Gs.log("play"),Js="forward",yo(),$i.play(),$i.paused||Hs.play()}function ho(){Gs.log("pause"),yo(),$i.pause(),Hs.pause()}function fo(e){Hs.seek(e)}function mo(){Gs.log("stop"),yo(),$i.stop(),Hs.stop()}function po(){Js="backward",vo(),zi.prev()}function go(){Js="forward",vo(),zi.next()}function Ao(){zi.shuffle()}function bo(){return Ct([zi.observeCurrentIndex(),zi.observeSize()]).pipe(nt((([e,t])=>e===t-1)),rt())}function vo(){$i.paused||!1!==Ks.getValue()||(mo(),$i.play()),Ks.next(!0)}function yo(){Ks.next(!1)}const wo={get autoplay(){return Hs.autoplay},set autoplay(e){Hs.autoplay=e,os.autoplay=e},get hidden(){return!1},get loop(){return!1},get muted(){return Hs.muted},set muted(e){Ys.setItem("muted",String(e)),Hs.muted=e},get paused(){return $i.paused},get volume(){return Hs.volume},set volume(e){$s.setItem("volume",String(e)),Hs.volume=e},observeCurrentItem:Zs,observeCurrentTime:eo,observeDuration:to,observeEnded:ro,observeError:function(){return Hs.observeError()},observePaused:io,observePlaying:lo,observePlaybackStart:no,observePlaybackEnd:ao,observePlaybackProgress:so,observePlaybackState:oo,appendTo:function(e){const t=e.querySelector("#players"),r=e.querySelector("#visualizers");Hs.appendTo(t),os.appendTo(r)},load:co,play:uo,pause:ho,stop:mo,seek:fo,resize:function(e,t){Hs.resize(e,t),os.resize(e,t)},next:go,prev:po,shuffle:Ao},Eo=wo;var _o;wo.muted="true"===Ys.getItem("muted"),wo.volume=Number($s.getItem("volume"))||1,Hs.observeCurrentTime().subscribe((e=>$i.setCurrentTime(e))),Hs.observeDuration().subscribe((e=>$i.setDuration(e))),Hs.observePlaying().subscribe((()=>$i.started())),Hs.observeEnded().subscribe((()=>$i.ended())),Hs.observePlaying().subscribe((()=>Js="forward")),Hs.observeEnded().pipe(Zr(bo())).subscribe((([,e])=>{e?mo():zi.next()})),Hs.observeError().pipe(Zr(io(),zi.observeCurrentIndex().pipe(nt((e=>0===e)),rt()),bo())).subscribe((([,e,t,r])=>{r||t&&"backward"===Js?mo():e||("backward"===Js?zi.prev():zi.next())})),zi.observeSize().pipe(nt((e=>0===e)),rt(),Ft((e=>e))).subscribe(mo),Ks.pipe((250,void 0===_o&&(_o=ai),We((function(e,t){var r=null,i=null,n=null,a=function(){if(r){r.unsubscribe(),r=null;var e=i;i=null,t.next(e)}};function s(){var e=n+250,i=_o.now();if(i<e)return r=this.schedule(void 0,e-i),void t.add(r);a()}e.subscribe(He(t,(function(e){i=e,n=_o.now(),r||(r=_o.schedule(s,250),t.add(r))}),(function(){a(),t.complete()}),void 0,(function(){i=r=null})))}))),Ft((e=>e)),Rt((()=>{wo.autoplay=!$i.paused,Ks.next(!1)}))).subscribe(Gs),Zs().subscribe(co),Kr(window,"pagehide").subscribe(mo),to().subscribe(Gs.all("duration")),eo().pipe(Ft((e=>Math.round(e)%10==0))).subscribe(Gs.all("currentTime")),lo().subscribe(Gs.all("playing")),ro().subscribe(Gs.all("ended")),no().subscribe(Gs.all("playbackStart")),ao().subscribe(Gs.all("playbackEnd"));var To=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};function So(e,t,r,i){return To(this,void 0,void 0,(function*(){const[,,n]=e.src.split(":");yield fr.post("Sessions/Playing/Progress",{ItemId:n,IsPaused:r,PositionTicks:Math.floor(1e7*t),PlayMethod:"Transcode",EventName:i})}))}console.log("module::jellyfinPlayback"),console.log("module::jellyfinReporting");const xo=e=>{var t;return(null===(t=e.currentItem)||void 0===t?void 0:t.src.startsWith("jellyfin:"))||!1},ko=Ft(xo);no().pipe(ko).subscribe((({currentItem:e})=>function(e){return To(this,void 0,void 0,(function*(){const[,,t]=e.src.split(":");yield fr.post("Sessions/Playing",{ItemId:t,IsPaused:!1,PositionTicks:0,PlayMethod:"Transcode"})}))}(e))),ao().pipe(ko).subscribe((({currentItem:e,currentTime:t})=>function(e,t){return To(this,void 0,void 0,(function*(){const[,,r]=e.src.split(":");yield fr.post("Sessions/Playing/Stopped",{ItemId:r,IsPaused:!1,PositionTicks:Math.floor(1e7*t),PlayMethod:"Transcode"})}))}(e,t))),so(1e4).pipe(ko).subscribe((({currentItem:e,currentTime:t,paused:r})=>So(e,t,r,"timeupdate"))),no().pipe(Ot((e=>xo(e)?oo().pipe(rt(((e,t)=>e.paused===t.paused)),Hr(1),Dt(ao())):et))).subscribe((({currentItem:e,currentTime:t,paused:r})=>So(e,t,r,r?"pause":"unpause"))),console.log("module::jellyfin");const Io={view:"details",fields:["Artist","Title","Album","Track","Duration","Genre","PlayCount"]},Co={id:"jellyfin/liked-songs",title:"Liked Songs",icon:"heart",itemType:Ie.Media,layout:Io,search:()=>Lo({Filters:"IsFavorite"})},Po={id:"jellyfin/liked-albums",title:"Liked Albums",icon:"heart",itemType:Ie.Album,search:()=>Lo({Filters:"IsFavorite",IncludeItemTypes:"MusicAlbum"})},Mo={id:"jellyfin/recently-played",title:"Recently Played",icon:"clock",itemType:Ie.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search:()=>Lo({SortBy:"DatePlayed",SortOrder:"Descending",Filters:"IsPlayed"})},Ro={id:"jellyfin/most-played",title:"Most Played",icon:"most-played",itemType:Ie.Media,layout:Io,search:()=>Lo({SortBy:"PlayCount,DatePlayed",SortOrder:"Descending",Filters:"IsPlayed"})},Bo={id:"jellyfin/playlists",title:"Playlists",icon:"playlists",itemType:Ie.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","TrackCount"]},secondaryLayout:Io,search:()=>Lo({SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"Playlist"})};function Lo(e){return new mr(`Users/${cr.userId}/Items`,e)}function Do(e,t){return Object.assign(Object.assign({},t),{id:e,icon:"",searchable:!0,search:t=>function(e,t="Audio"){return e?Lo({SearchTerm:e,IncludeItemTypes:t}):new tt}(t,e)})}const No={id:"jellyfin",title:"Jellyfin",icon:"jellyfin",searches:[Do("Audio",{title:"Songs",itemType:Ie.Media}),Do("MusicAlbum",{title:"Albums",itemType:Ie.Album}),{id:"Artist",title:"Artists",icon:"",itemType:Ie.Artist,searchable:!0,search:e=>e?new mr("Artists",{searchTerm:e}):new tt},Do("Playlist",{title:"Playlists",itemType:Ie.Playlist})],sources:[Ro,Mo,Co,Po,Bo],observeIsLoggedIn:function(){return Xr.pipe(rt()).pipe(nt((e=>""!==e)),rt())},login:function(){return Qr(this,void 0,void 0,(function*(){if(""===Xr.getValue())try{const e=yield function(){return jr(this,void 0,void 0,(function*(){return zr(Vr)}))}(),{userId:t,token:r}=JSON.parse(e);cr.userId=t,Wr(r)}catch(e){qr.log("Could not obtain access token."),qr.error(e)}}))},logout:function(){return Qr(this,void 0,void 0,(function*(){Wr(""),cr.clear()}))}};var Fo=__webpack_require__(2568),Oo=__webpack_require__.n(Fo);const zo=new r("lastfm"),Uo={get token(){return zo.getItem("token")||""},set token(e){zo.setItem("token",e)},get userId(){return zo.getItem("userId")||""},set userId(e){zo.setItem("userId",e)},get sessionKey(){return zo.getItem("sessionKey")||""},set sessionKey(e){zo.setItem("sessionKey",e)},clear(){zo.clear()}};var jo=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};console.log("module::lastfmAuth");const Vo=new ie("lastfmAuth"),Qo=new te(""),qo=new te("");function Xo(){return Qo.pipe(rt())}function Wo(){return qo.pipe(rt())}function Ho(e){const t=Object.keys(e);let r="";return t.sort(),t.forEach((t=>r+=t+e[t])),r+=ot,Oo()(r)}qo.next(Uo.sessionKey),Qo.next(Uo.token);class Go{constructor(e,t,r,i="playcount"){this.playCountName=i,this.defaultConfig={minPageSize:Go.minPageSize,maxPageSize:Go.maxPageSize,pageSize:50},this.pageNumber=1;const n=Object.assign(Object.assign({},this.defaultConfig),r);this.pager=new Wt(((r=this.defaultConfig.pageSize)=>{return i=this,n=void 0,s=function*(){const i=yield fetch(`https://ws.audioscrobbler.com/2.0?${e}&page=${this.pageNumber}&limit=${r}`);if(this.pageNumber++,!i.ok)throw i;const n=yield i.json(),{items:a,total:s,atEnd:o,itemType:l}=t(n);return{items:this.createMediaObjects(l,a),total:s,atEnd:o}},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(r,o)}l((s=s.apply(i,n||[])).next())}));var i,n,a,s}),n)}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeMaxSize(){return this.pager.observeMaxSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createMediaObjects(e,t){switch(e){case Ie.Artist:return t.map((e=>this.createMediaArtist(e)));case Ie.Album:return t.map((e=>this.createMediaAlbum(e)));case Ie.Media:return t.map((e=>this.createMediaItem(e)));case Ie.Playlist:return[]}}createMediaItem(e){var t,r;return Object.assign(Object.assign({},this.createMediaObject(Ie.Media,e)),{mediaType:yt.Audio,src:`lastfm:track:${or()}`,artist:null===(t=e.artist)||void 0===t?void 0:t.name,album:null===(r=e.album)||void 0===r?void 0:r["#text"],duration:Number(e.duration)||0,playedOn:e.date?1e3*e.date.uts:void 0,unplayable:!0})}createMediaAlbum(e){var t;return Object.assign(Object.assign({},this.createMediaObject(Ie.Album,e)),{src:`lastfm:album:${or()}`,artist:e.artist.name,year:(null===(t=e.wiki)||void 0===t?void 0:t.published)&&new Date(e.wiki.published).getFullYear()||void 0,pager:this.createAlbumPager(e),unplayable:!0})}createMediaArtist(e){return Object.assign(Object.assign({},this.createMediaObject(Ie.Artist,e)),{src:`lastfm:artist:${or()}`,pager:this.createArtistAlbumsPager(e)})}createMediaObject(e,t){return Object.assign(Object.assign({},Se(e)),{title:t.name,rating:Number(t.loved)||0,playCount:Number(t[this.playCountName])||void 0,globalPlayCount:"userplaycount"===this.playCountName&&Number(t.playcount)||void 0,thumbnails:this.createThumbnails(t.image),externalUrl:t.url})}createThumbnails(e){return e?[this.createThumbnail(e[0],34),this.createThumbnail(e[1],64),this.createThumbnail(e[2],174),this.createThumbnail(e[3],300)].filter(Ae):void 0}createThumbnail(e,t,r=t){if(e){const i=e["#text"];if(i&&!i.endsWith("2a96cbd8b46e442fc41c2b86b821562f.png"))return{url:i,width:t,height:r}}}createArtistAlbumsPager(e){return new Go(`method=artist.getTopAlbums&artist=${encodeURIComponent(e.name)}&api_key=${st}&format=json`,(({topalbums:e})=>{const t=e["@attr"];return{items:e.album,total:Number(t.total)||void 0,atEnd:t.page===t.totalPages,itemType:Ie.Album}}),{maxSize:100},"userplaycount")}createAlbumPager(e){return new Go(`method=album.getInfo&album=${encodeURIComponent(e.name)}&artist=${encodeURIComponent(e.artist.name)}&api_key=${st}&user=${Uo.userId}&format=json`,(({album:e})=>{if(e.tracks){const t=e.tracks.track;return{items:t,total:t.length,atEnd:!0,itemType:Ie.Media}}throw Error("No track info")}),void 0,"userplaycount")}}Go.minPageSize=10,Go.maxPageSize=200;var $o=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};console.log("module::lastfmScrobbler");const Yo=new ie("lastfmScrobbler"),Ko="https://ws.audioscrobbler.com/2.0",Jo=({currentItem:e})=>!!(null==e?void 0:e.title)&&!!(null==e?void 0:e.artist)&&(null==e?void 0:e.duration)>30;function Zo(e){const t={};return t.track=e.title,t.artist=e.artist,e.album&&(t.album=e.album),e.albumArtist&&(t.albumArtist=e.albumArtist),e.duration&&(t.duration=String(Math.round(e.duration))),e.track&&(t.trackNumber=String(e.track)),t}no().pipe(Ft(Jo),Zr(Xo(),Wo()),Ft((([,e,t])=>!!e&&!!t)),Bt((([{currentItem:e},t,r])=>function(e,t,r){return $o(this,void 0,void 0,(function*(){const i=Object.assign({api_key:st,token:t,sk:r,method:"track.updateNowPlaying"},Zo(e)),n=Ho(i);yield fetch(Ko,{method:"POST",body:`${new URLSearchParams(i)}&api_sig=${n}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}))}(e,t,r)))).subscribe(Yo),ao().pipe(Ft(Jo),Zr(Xo(),Wo()),Ft((([,e,t])=>!!e&&!!t)),Bt((([{currentItem:e,startedAt:t},r,i])=>function(e,t,r,i){return $o(this,void 0,void 0,(function*(){i=Math.floor(i/1e3);const n=Math.floor(Date.now()/1e3)-i;if(n>240||n>e.duration/2){const n="track.scrobble",a=String(i),s=Object.assign({api_key:st,token:t,sk:r,method:n,timestamp:a},Zo(e)),o=Ho(s);yield fetch(Ko,{method:"POST",body:`${new URLSearchParams(s)}&api_sig=${o}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}))}(e,r,i,t)))).subscribe(Yo),console.log("module::lastfm");const el={view:"card compact",fields:["Thumbnail","Title","Artist","Year","PlayCount"]},tl={view:"details",fields:["Index","Title","Artist"]},rl={id:"lastfm/recently-played",title:"Recently Played",icon:"clock",itemType:Ie.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},unplayable:!0,search:()=>new Go(`method=user.getRecentTracks&user=${Uo.userId}&api_key=${st}&extended=1&format=json`,(({recenttracks:e})=>{var t,r;const i=e["@attr"],n=e.track,a="true"===(null===(r=null===(t=n[0])||void 0===t?void 0:t["@attr"])||void 0===r?void 0:r.nowplaying),s=Number(i.total)+(a?1:0),o=i.page===i.totalPages;return a&&"1"!==i.page&&n.shift(),{items:n,total:s,atEnd:o,itemType:Ie.Media}}))};function il(e,t){return Object.assign(Object.assign({},t),{id:e,icon:"",searchable:!1,unplayable:!0,search:()=>function(e,t){return new Go(`method=${e}&user=${Uo.userId}&api_key=${st}&format=json`,(r=>{const[,i]=e.toLowerCase().split("."),n=r[i.slice(3)],a=n["@attr"];return{items:n[i.slice(6,-1)],total:Number(a.total)||void 0,atEnd:a.page===a.totalPages,itemType:t}}))}(e,t.itemType)})}const nl={id:"lastfm",title:"last.fm",icon:"lastfm",sources:[rl],searches:[il("user.getTopTracks",{title:"Top Tracks",itemType:Ie.Media,layout:{view:"card compact",fields:["Thumbnail","Title","Artist","PlayCount"]}}),il("user.getTopAlbums",{title:"Top Albums",itemType:Ie.Album,layout:el,secondaryLayout:tl}),il("user.getTopArtists",{title:"Top Artists",itemType:Ie.Artist,layout:{view:"card minimal",fields:["Thumbnail","Title","PlayCount"]},secondaryLayout:el,tertiaryLayout:tl})],observeIsLoggedIn:function(){return Xo().pipe(nt((e=>""!==e)),rt())},login:function(){return jo(this,void 0,void 0,(function*(){if(""===Qo.getValue())try{const e=yield function(){return jo(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{const r=location.hostname,i=("localhost"===r?`http://${r}:${location.port}`:`https://${r}`)+"/auth/lastfm/callback/";let n=null;const a=r=>{if(/(localhost|ampcast)/.test(r.origin)){if(clearInterval(s),window.removeEventListener("message",a,!1),null==n||n.close(),n=null,r.origin!==location.origin)return void t({message:`Origin ${r.origin} does not match ${location.origin}`});e(r.data.token)}};window.addEventListener("message",a,!1),n=window.open(`https://www.last.fm/api/auth?api_key=${st}&cb=${i}`,"last.fm","popup");const s=setInterval((()=>{(null==n?void 0:n.closed)&&(clearInterval(s),t({message:"access_denied"}))}),500)}))}))}(),t=yield function(e){return jo(this,void 0,void 0,(function*(){const t="auth.getSession",r=Ho({api_key:st,token:e,method:t}),i=yield fetch(`https://ws.audioscrobbler.com/2.0?method=${t}&api_key=${st}&token=${e}&api_sig=${r}&format=json`);if(!i.ok)throw i;const{session:n}=yield i.json();return Uo.userId=n.name,Uo.token=e,Uo.sessionKey=n.key,n.key}))}(e);qo.next(t),Qo.next(e),Vo.log("Access token successfully obtained.")}catch(e){Vo.log("Could not obtain access token."),Vo.error(e)}}))},logout:function(){return jo(this,void 0,void 0,(function*(){qo.next(""),Qo.next(""),Uo.clear()}))}};var al=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};console.log("module::plexAuth");const sl=new ie("plexAuth"),ol="https://plex.tv/api/v2",ll=new te(""),cl=new te(!1);function ul(){return ll.pipe(rt()).pipe(nt((e=>""!==e)),rt())}function hl(e){e&&sl.log("Access token successfully obtained."),jn.userToken=e,ll.next(e)}hl(jn.userToken),ul().pipe(Ft((e=>e)),Rt((()=>al(void 0,void 0,void 0,(function*(){const e=function(e,t){return al(this,void 0,void 0,(function*(){try{return yield Wn.fetch({host:e.uri,path:"/",method:"HEAD",token:t}),e}catch(e){return null}}))},t=jn.connection;if(t){if(yield e(t,jn.serverToken))return sl.log(`Using existing ${t.local?"local":"public"} connection.`),void cl.next(!0);jn.server=null,jn.connection=null}sl.log("Searching for a connection...");const r=(yield function(){return al(this,void 0,void 0,(function*(){return Wn.fetchJSON({host:ol,path:"/resources",params:{includeHttps:"1"}})}))}()).filter((e=>"server"===e.provides));for(const t of r){const r=yield Promise.all([...t.connections.map((r=>e(r,t.accessToken)))]),i=r.filter(Ae);if(i.length){const e=i.find((e=>e.local))||i[0];return jn.server=t,jn.connection=e,sl.log(`Using ${e.local?"local":"public"} connection.`),void cl.next(!0)}}sl.log("Could not establish a connection.")}))))).subscribe(sl),cl.pipe(Ft((e=>e)),Rt((()=>al(void 0,void 0,void 0,(function*(){sl.log("Connected");const{MediaContainer:{Directory:e}}=yield Wn.fetchJSON({path:"/library/sections"}),t=e.find((e=>"artist"===e.type));jn.libraryId=(null==t?void 0:t.key)||""}))))).subscribe(sl);class dl{constructor(e,t){var r;this.path=e,this.params=t,this.pageSize=(null===(r=jn.connection)||void 0===r?void 0:r.local)?dl.maxPageSize:dl.minPageSize,this.pager=new sr((e=>this.fetch(e)),{pageSize:this.pageSize})}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeMaxSize(){return this.pager.observeMaxSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}fetch(e){return t=this,r=void 0,n=function*(){const t=yield Wn.fetchJSON({path:this.path,params:this.params,headers:{"X-Plex-Container-Size":String(this.pageSize),"X-Plex-Container-Start":String((e-1)*this.pageSize)}}),{MediaContainer:{Metadata:r=[],totalSize:i}}=t;return{items:r.map((e=>this.createItem(e))),total:i}},new((i=void 0)||(i=Promise))((function(e,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,o)}l((n=n.apply(t,r||[])).next())}));var t,r,i,n}createItem(e){switch(e.type){case"clip":return this.createMediaItemFromVideo(e);case"album":return this.createMediaAlbum(e);case"artist":return this.createMediaArtist(e);case"playlist":return this.createMediaPlaylist(e);default:return this.createMediaItemFromTrack(e)}}createMediaItemFromTrack(e){const[t]=e.Media,[r]=t.Part,i="[Unknown Album]"===e.parentTitle?"":e.parentTitle||"";return Object.assign(Object.assign({},Se(Ie.Media)),{mediaType:yt.Audio,src:`plex:audio:${r.key}`,title:e.title,addedOn:e.addedAt,artist:e.grandparentTitle,albumArtist:i?e.grandparentTitle:void 0,album:i,duration:e.duration/1e3,track:i?e.index:void 0,rating:e.userRating,year:e.parentYear,playedOn:e.lastViewedAt?1e3*e.lastViewedAt:void 0,playCount:e.viewCount,plex:{ratingKey:e.ratingKey},thumbnails:this.createThumbnails(e.thumb)})}createMediaAlbum(e){var t;return Object.assign(Object.assign({},Se(Ie.Album)),{src:`plex:album:${e.ratingKey}`,title:e.title||"",addedOn:e.addedAt,artist:e.parentTitle,rating:e.userRating,year:e.year,playedOn:e.lastViewedAt?1e3*e.lastViewedAt:void 0,playCount:e.viewCount,genre:null===(t=e.Genre)||void 0===t?void 0:t.map((e=>e.tag)).join(";"),plex:{ratingKey:e.ratingKey},pager:this.createPager(e.key),thumbnails:this.createThumbnails(e.thumb)})}createMediaArtist(e){var t;return Object.assign(Object.assign({},Se(Ie.Artist)),{src:`plex:album:${e.ratingKey}`,title:e.title,addedOn:e.addedAt,rating:e.userRating,genre:null===(t=e.Genre)||void 0===t?void 0:t.map((e=>e.tag)).join(";"),plex:{ratingKey:e.ratingKey},pager:this.createPager(e.key),thumbnails:this.createThumbnails(e.thumb)})}createMediaItemFromVideo(e){const[t]=e.Media,[r]=t.Part;return Object.assign(Object.assign({},Se(Ie.Media)),{mediaType:yt.Video,src:`plex:video:${r.key}`,title:e.title||"Video",addedOn:e.addedAt,artist:e.grandparentTitle,duration:e.duration/1e3,playedOn:e.lastViewedAt?1e3*e.lastViewedAt:void 0,playCount:e.viewCount,plex:{ratingKey:e.ratingKey},thumbnails:this.createThumbnails(e.thumb)})}createMediaPlaylist(e){return Object.assign(Object.assign({},Se(Ie.Playlist)),{src:`plex:playlist:${e.key}`,title:e.title,addedOn:e.addedAt,duration:e.duration/1e3,playedOn:e.lastViewedAt?1e3*e.lastViewedAt:void 0,playCount:e.viewCount,trackCount:e.leafCount,plex:{ratingKey:e.ratingKey},pager:this.createPager(e.key),thumbnails:this.createThumbnails(e.composite)})}createThumbnails(e){return e?[this.createThumbnail(e,60),this.createThumbnail(e,120),this.createThumbnail(e,240),this.createThumbnail(e,480)]:void 0}createThumbnail(e,t,r=t){return{url:`${jn.host}/photo/:/transcode?url=${encodeURIComponent(e)}&width=${t}&height=${r}&minSize=1&upscale=1&X-Plex-Token=${jn.serverToken}`,width:t,height:r}}createPager(e){return new dl(e)}}dl.minPageSize=100,dl.maxPageSize=1e3;var fl=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};console.log("module::plexPlayback");let ml=null;function pl(e,t,r){return fl(this,void 0,void 0,(function*(){yield gl(e,t,r)}))}function gl(e,t,r,i){return fl(this,void 0,void 0,(function*(){const[,,n]=e.src.split(":");yield Wn.fetch({path:"/:/timeline",params:{key:n,ratingKey:e.plex.ratingKey,playQueueItemID:String(ml.playQueueSelectedItemID),state:r,hasMDE:"1",time:String(Math.floor(1e3*t)),duration:String(Math.floor(1e3*e.duration))},keepalive:i})}))}console.log("module::plexReporting");const Al=new ie("plexReporting"),bl=e=>{var t;return(null===(t=e.currentItem)||void 0===t?void 0:t.src.startsWith("plex:"))||!1};no().pipe(Ft(bl),Rt((({currentItem:e})=>function(e){return fl(this,void 0,void 0,(function*(){const[,,t]=e.src.split(":");ml=yield function(e){return fl(this,void 0,void 0,(function*(){return Wn.fetchJSON({path:"/playQueues",method:"POST",params:{type:"music",continuous:"0",uri:`server://${jn.server.clientIdentifier}/com.plexapp.plugins.library/${e}`,repeat:"0",own:"1",includeExternalMedia:"1"}})}))}(t),yield gl(e,0,"playing")}))}(e)))).subscribe(Al),ao().pipe(Ft(bl),Rt((({currentItem:e})=>function(e){return fl(this,void 0,void 0,(function*(){yield gl(e,0,"stopped",!0)}))}(e)))).subscribe(Al),so(1e4).pipe(Ft(bl),Rt((({currentItem:e,currentTime:t,paused:r})=>pl(e,t,r?"paused":"playing")))).subscribe(Al),no().pipe(Ot((e=>bl(e)?oo().pipe(rt(((e,t)=>e.paused===t.paused)),Hr(1),Dt(ao())):et)),Rt((({currentItem:e,currentTime:t,paused:r})=>pl(e,t,r?"paused":"playing")))).subscribe(Al),console.log("module::plex");const vl={id:"plex/video",title:"Music Video",icon:"video",itemType:Ie.Media,searchable:!0,search:e=>new dl(`/library/sections/${jn.libraryId}/extras/all`,{title:e,type:"8",extraType:"4"})},yl={id:"plex/recently-played",title:"Recently Played",icon:"clock",itemType:Ie.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search:()=>new dl(`/library/sections/${jn.libraryId}/all`,{type:"10","lastViewedAt>":"-3mon",sort:"lastViewedAt:desc"})};function wl(e,t){return Object.assign(Object.assign({},t),{id:e,icon:"",searchable:!0,search:t=>function(e,t){return e?new dl(`/library/sections/${jn.libraryId}/all`,{title:e,type:t}):new tt}(t,e)})}const El={id:"plex",title:"Plex",icon:"plex",sources:[vl,{id:"plex/most-played",title:"Most Played",icon:"most-played",itemType:Ie.Media,search:()=>new dl(`/library/sections/${jn.libraryId}/all`,{type:"10","viewCount>":"1",sort:"viewCount:desc,lastViewedAt:desc"})},yl,{id:"plex/top-rated",title:"Top Rated",icon:"star",itemType:Ie.Media,search:()=>new dl(`/library/sections/${jn.libraryId}/all`,{type:"10","track.userRating>":"1",sort:"track.userRating:desc,viewCount:desc,lastViewedAt:desc"})},{id:"plex/playlists",title:"Playlists",icon:"playlists",itemType:Ie.Playlist,search:()=>new dl("/playlists/all",{type:"15",playlistType:"audio"})}],searches:[wl("10",{title:"Songs",itemType:Ie.Media}),wl("9",{title:"Albums",itemType:Ie.Album}),wl("8",{title:"Artists",itemType:Ie.Artist}),wl("15",{title:"Playlists",itemType:Ie.Playlist})],observeIsLoggedIn:ul,login:function(){return al(this,void 0,void 0,(function*(){if(""===ll.getValue())try{const{id:e,authToken:t}=yield function(){return al(this,void 0,void 0,(function*(){const e=yield Wn.fetchJSON({host:ol,path:"/pins",method:"POST",params:{strong:"true"}});return new Promise(((t,r)=>{const i=location.hostname,n=("localhost"===i?`http://${i}:${location.port}`:`https://${i}`)+"/auth/plex/callback/";let a=null;const s=i=>{if(/(localhost|ampcast)/.test(i.origin)){if(clearInterval(l),window.removeEventListener("message",s,!1),null==a||a.close(),a=null,i.origin!==location.origin)return void r({message:`Origin ${i.origin} does not match ${location.origin}`});let n=10;const o=()=>al(this,void 0,void 0,(function*(){n--;try{const{authToken:i,id:a}=yield Wn.fetchJSON({host:ol,path:`/pins/${e.id}`});i?t({id:a,authToken:i}):n?setTimeout(o,200):r("Timeout.")}catch(e){r(e)}}));o()}};window.addEventListener("message",s,!1);const o=`clientID=${jn.clientId}&code=${e.code}&forwardUrl=${encodeURIComponent(n)}&context%5Bdevice%5D%5Bproduct%5D=ampcast`;a=window.open(`https://app.plex.tv/auth#?${o}`,"Plex","popup");const l=setInterval((()=>{(null==a?void 0:a.closed)&&(clearInterval(l),r({message:"access_denied"}))}),500)}))}))}();jn.userId=e,hl(t)}catch(e){sl.log("Could not obtain access token."),sl.error(e)}}))},logout:function(){return al(this,void 0,void 0,(function*(){cl.next(!1),hl(""),jn.clear()}))}};var _l=__webpack_require__(5754),Tl=__webpack_require__.n(_l),Sl=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};class xl{constructor(e,t){this.defaultConfig={minPageSize:xl.minPageSize,maxPageSize:xl.maxPageSize,pageSize:xl.maxPageSize},this.pageNumber=1;const r=Object.assign(Object.assign({},this.defaultConfig),t);this.pager=new Wt(((t=this.defaultConfig.pageSize)=>Sl(this,void 0,void 0,(function*(){const r=(this.pageNumber-1)*t,i=()=>Sl(this,void 0,void 0,(function*(){const{items:i,total:n,next:a}=yield e(r,t);return this.pageNumber++,{items:i.map((e=>this.createMediaObject(e))),total:n,atEnd:!a}}));try{return yield i()}catch(e){if(401===e.status)return yield Cs(),yield i();throw e}}))),r)}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeMaxSize(){return this.pager.observeMaxSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createMediaObject(e){switch(e.type){case"episode":return this.createMediaItemFromEpisode(e);case"artist":return this.createMediaArtist(e);case"album":return this.createMediaAlbum(e);case"playlist":return this.createMediaPlaylist(e);case"track":return this.createMediaItemFromTrack(e)}}createMediaItemFromEpisode(e){return Object.assign(Object.assign({},Se(Ie.Media)),{mediaType:yt.Audio,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,duration:e.duration_ms/1e3,thumbnails:e.images,unplayable:!1===e.is_playable})}createMediaAlbum(e){var t;return Object.assign(Object.assign({},Se(Ie.Album)),{src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,artist:e.artists.map((e=>e.name)).join("/"),year:new Date(e.release_date).getFullYear(),thumbnails:e.images,trackCount:null===(t=e.tracks)||void 0===t?void 0:t.total,pager:this.createAlbumPager(e)})}createMediaArtist(e){return Object.assign(Object.assign({},Se(Ie.Artist)),{src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,thumbnails:e.images,pager:this.createArtistAlbumsPager(e)})}createMediaPlaylist(e){return Object.assign(Object.assign({},Se(Ie.Playlist)),{src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,thumbnails:e.images,trackCount:e.tracks.total,pager:this.createPlaylistPager(e),owner:{name:e.owner.display_name||"",url:e.owner.external_urls.spotify}})}createMediaItemFromTrack(e){var t,r,i,n,a;const s=/album|compilation/i.test((null===(t=e.album)||void 0===t?void 0:t.album_type)||"")?e.album:null;return Object.assign(Object.assign({},Se(Ie.Media)),{mediaType:yt.Audio,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,artist:e.artists.map((e=>e.name)).join("/"),albumArtist:null===(r=null==s?void 0:s.artists[0])||void 0===r?void 0:r.name,album:null==s?void 0:s.name,duration:e.duration_ms/1e3,playedOn:e.played_at&&new Date(e.played_at).getTime()||void 0,genre:null===(n=null===(i=e.album)||void 0===i?void 0:i.genres)||void 0===n?void 0:n.join(";"),disc:s?e.disc_number:void 0,track:s?e.track_number:void 0,year:e.album?new Date(e.album.release_date).getFullYear():void 0,thumbnails:null===(a=e.album)||void 0===a?void 0:a.images,unplayable:!1===e.is_playable})}createArtistAlbumsPager(e){const t=this.getMarket();return new xl(((r,i)=>Sl(this,void 0,void 0,(function*(){const{items:n,total:a,next:s}=yield Cl.getArtistAlbums(e.id,{offset:r,limit:i,market:t});return{items:n,total:a,next:s}}))))}createAlbumPager(e){var t;const r=null===(t=e.tracks)||void 0===t?void 0:t.items;if(r&&r.length===e.total_tracks)return new tt(r.map((e=>this.createMediaItemFromTrack(e))));{const t=this.getMarket();return new xl(((r,i)=>Sl(this,void 0,void 0,(function*(){return yield Cl.getAlbumTracks(e.id,{offset:r,limit:i,market:t})}))))}}createPlaylistPager(e){const t=this.getMarket();return new xl(((r,i)=>Sl(this,void 0,void 0,(function*(){const{items:n,total:a,next:s}=yield Cl.getPlaylistTracks(e.id,{offset:r,limit:i,market:t});return{items:n.map((e=>e.track)),total:a,next:s}}))))}getMarket(){return Es.getItem("market")||""}}xl.minPageSize=10,xl.maxPageSize=50;var kl=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};console.log("module::spotify");const Il=new ie("spotify"),Cl=new(Tl()),Pl={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","Duration"]};function Ml(){return Es.getItem("market")||""}const Rl={id:"spotify",title:"Spotify",icon:"spotify",sources:[{id:"spotify/recently-played",title:"Recently Played",icon:"clock",itemType:Ie.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search(){return new xl(((e,t)=>kl(this,void 0,void 0,(function*(){const{items:e,total:r}=yield Cl.getMyRecentlyPlayedTracks({limit:t});return{items:e.map((e=>Object.assign({played_at:e.played_at},e.track))),total:r,next:void 0}}))),{maxSize:50,pageSize:50})}},{id:"spotify/top-tracks",title:"Top Tracks",icon:"star",itemType:Ie.Media,layout:Pl,search(){return new xl(((e,t)=>kl(this,void 0,void 0,(function*(){return Cl.getMyTopTracks({offset:e,limit:t})}))))}},{id:"spotify/liked-songs",title:"Liked Songs",icon:"heart",itemType:Ie.Media,layout:Pl,search(){const e=Ml();return new xl(((t,r)=>kl(this,void 0,void 0,(function*(){const{items:i,total:n,next:a}=yield Cl.getMySavedTracks({offset:t,limit:r,market:e});return{items:i.map((e=>e.track)),total:n,next:a}}))))}},{id:"spotify/liked-albums",title:"Liked Albums",icon:"heart",itemType:Ie.Album,search(){const e=Ml();return new xl(((t,r)=>kl(this,void 0,void 0,(function*(){const{items:i,total:n,next:a}=yield Cl.getMySavedAlbums({offset:t,limit:r,market:e});return{items:i.map((e=>e.album)),total:n,next:a}}))),{calculatePageSize:!0})}},{id:"spotify/playlists",title:"Playlists",icon:"playlists",itemType:Ie.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","TrackCount","Owner"]},search(){const e=Ml();return new xl(((t,r)=>kl(this,void 0,void 0,(function*(){const{items:i,total:n,next:a}=yield Cl.getUserPlaylists(void 0,{offset:t,limit:r,market:e});return{items:i,total:n,next:a}}))))}}],searches:[{id:"spotify/search/songs",title:"Songs",icon:"",itemType:Ie.Media,layout:Pl,searchable:!0,search(e){if(e){const t=Ml();return new xl(((r,i)=>kl(this,void 0,void 0,(function*(){const{tracks:{items:n,total:a,next:s}}=yield Cl.searchTracks(e,{offset:r,limit:i,market:t});return{items:n,total:a,next:s}}))),{maxSize:250})}return new tt}},{id:"spotify/search/albums",title:"Albums",icon:"",itemType:Ie.Album,searchable:!0,search(e){if(e){const t=Ml();return new xl(((r,i)=>kl(this,void 0,void 0,(function*(){const{albums:{items:n,total:a,next:s}}=yield Cl.searchAlbums(e,{offset:r,limit:i,market:t});return{items:n,total:a,next:s}}))),{maxSize:250})}return new tt}},{id:"spotify/search/artists",title:"Artists",icon:"",itemType:Ie.Artist,searchable:!0,search(e){if(e){const t=Ml();return new xl(((r,i)=>kl(this,void 0,void 0,(function*(){const{artists:{items:n,total:a,next:s}}=yield Cl.searchArtists(e,{offset:r,limit:i,market:t});return{items:n,total:a,next:s}}))),{maxSize:250})}return new tt}},{id:"spotify/search/playlists",title:"Playlists",icon:"",itemType:Ie.Playlist,searchable:!0,search(e){if(e){const t=Ml();return new xl(((r,i)=>kl(this,void 0,void 0,(function*(){const{playlists:{items:n,total:a,next:s}}=yield Cl.searchPlaylists(e,{offset:r,limit:i,market:t});return{items:n,total:a,next:s}}))),{maxSize:250})}return new tt}}],observeIsLoggedIn:function(){return ks().pipe(nt((e=>""!==e)),rt())},login:Is,logout:function(){return ys(this,void 0,void 0,(function*(){Bs(),Es.clear()}))}};ks().subscribe((e=>Cl.setAccessToken(e))),Ml()||ks().pipe(un((e=>!e)),Bt((()=>Cl.getMe())),Rt((e=>Es.setItem("market",e.country))),Nt(1)).subscribe(Il);const Bl=[ir,Rl,Pn,El,No,nl];var Ll;const Dl=new r("sources"),Nl=Bl.reduce(((e,t)=>(e.push(t.id,...t.sources.map((e=>e.id))),e)),[]),Fl=new te((null===(Ll=Dl.getItem("all"))||void 0===Ll?void 0:Ll.split(","))||Nl);function Ol(){return Fl}function zl(){return Fl.getValue()}function Ul(){return Bl.map((e=>e.id))}function jl(e){Dl.setItem("all",String(e)),Fl.next(e)}const Vl={observeAll:Ol,getAll:zl,getServices:function(){const e=Ul();return zl().filter((t=>e.includes(t)))},setServices:function(e){const t=new Set(zl());Ul().forEach((r=>{e.includes(r)?t.add(r):t.delete(r)})),jl([...t])},getSources:function(e){return zl().filter((t=>t.startsWith(`${e}/`)))},setSources:function(e,t){const r=new Set(zl()),i=function(e){var t;return(null===(t=Bl.find((t=>t.id===e)))||void 0===t?void 0:t.sources.map((e=>e.id)))||[]}(e);i.forEach((e=>{t.includes(e)?r.add(e):r.delete(e)})),jl([...r])}},Ql=Vl;function ql({children:t}){return e.createElement(e.Fragment,null,t)}function Xl(e,t){switch(t.type){case"resize":{const r=Math.max(t.clientSize,0),i=Math.max(t.scrollSize,r);if(r!==e.clientSize||i!==e.scrollSize){const t=i-r,n=Wl(e.position,t);return Object.assign(Object.assign({},e),{position:n,max:t,clientSize:r,scrollSize:i})}return e}case"scrollBy":{const r=Wl(e.position+t.amount,e.max);return r!==e.position?Object.assign(Object.assign({},e),{position:r}):e}case"scrollTo":{const r=Wl(t.position,e.max);return r!==e.position?Object.assign(Object.assign({},e),{position:r}):e}default:return e}}function Wl(e,t){return Math.min(Math.max(e,0),t)}const Hl={position:0,max:0,clientSize:0,scrollSize:0};const Gl=(0,e.memo)((function(t){var{orientation:r,scrollAmount:i,onChange:n,onResize:s,scrollbarRef:o}=t,l=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["orientation","scrollAmount","onChange","onResize","scrollbarRef"]);const c=(0,e.useRef)(null),u=(0,e.useRef)(null),{position:h,max:d,clientSize:f,scrollSize:m,resize:p,scrollBy:g,scrollTo:A}=function(){const[{position:t,max:r,clientSize:i,scrollSize:n},a]=(0,e.useReducer)(Xl,Hl),s=(0,e.useCallback)(((e,t)=>a({type:"resize",clientSize:e,scrollSize:t})),[]),o=(0,e.useCallback)((e=>a({type:"scrollTo",position:e})),[]);return{position:t,max:r,clientSize:i,scrollSize:n,scrollTo:o,scrollBy:(0,e.useCallback)((e=>a({type:"scrollBy",amount:e})),[]),resize:s}}(),[b,v]=(0,e.useState)(0),[y,w]=(0,e.useState)(0),[E,_]=(0,e.useState)(0),[T,S]=(0,e.useState)(-1),[x,k]=(0,e.useState)(0),I=-1!==T,C="vertical"===r,P=Math.ceil(h/d*(y-E));(0,e.useEffect)((()=>{o.current={scrollBy:g,scrollTo:A}}),[o,g,A]),(0,e.useLayoutEffect)((()=>p(l.clientSize,l.scrollSize)),[l.clientSize,l.scrollSize,p]),(0,e.useLayoutEffect)((()=>null==n?void 0:n(h)),[h,n]),(0,e.useLayoutEffect)((()=>null==s?void 0:s(b)),[b,s]),a(c,(0,e.useCallback)((()=>{const e=c.current.getBoundingClientRect();w(C?e.height:e.width),v(C?e.width:e.height)}),[C])),a(u,(0,e.useCallback)((()=>{const e=u.current.getBoundingClientRect();_(C?e.height:e.width)}),[C]));const M=(0,e.useCallback)(((e,t)=>{const r=()=>o.current.scrollBy(t),i=t=>t.target===e,n=Kr(document,"mouseup"),a=Kr(e,"mouseover").pipe(nt(i),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Re(e);return We((function(t,i){(r?As(e,t,r):As(e,t)).subscribe(i)}))}(!0)),s=nn(a,Kr(e,"mouseout").pipe(Ft(i),nt((()=>!1)))).pipe(Ot(((e,t)=>e?ji(0===t?400:0,40):et)),Dt(n)).subscribe(r);return r(),()=>s.unsubscribe()}),[o]),R=(0,e.useCallback)((e=>{if(0===e.button)return e.stopPropagation(),M(e.target,-i)}),[i,M]),B=(0,e.useCallback)((e=>{if(0===e.button)return e.stopPropagation(),M(e.target,i)}),[i,M]),L=(0,e.useCallback)((e=>{if(0===e.button){e.preventDefault();const t=C?e.nativeEvent.offsetY:e.nativeEvent.offsetX;return M(e.target,t<P?-f:f)}}),[C,f,P,M]),D=(0,e.useCallback)((e=>{0===e.button&&(e.preventDefault(),e.stopPropagation(),S(C?e.screenY:e.screenX),k(P))}),[C,P]),N=(0,e.useCallback)((e=>{const t=C?e.screenY:e.screenX;A((x+(t-T))*d/(y-E))}),[C,T,x,d,E,y,A]),F=(0,e.useCallback)((()=>{S(-1),k(0)}),[]);return(0,e.useEffect)((()=>{if(I)return document.body.classList.add("dragging"),document.addEventListener("mouseup",F),document.addEventListener("mousemove",N),()=>{document.body.classList.remove("dragging"),document.removeEventListener("mouseup",F),document.removeEventListener("mousemove",N)}}),[I,N,F]),e.createElement("div",{className:`scrollbar scrollbar-${r}`},e.createElement("div",{className:"scrollbar-button scrollbar-button-decrement",onMouseDown:R},e.createElement("svg",{className:"icon",viewBox:"0 0 50 50"},e.createElement("polygon",{points:C?"0,50 25,0 50,50":"50,0 0,25 50,50"}))),e.createElement("div",{className:"scrollbar-track",onMouseDown:L,ref:c},e.createElement("div",{className:"scrollbar-thumb",onMouseDown:D,style:{[C?"height":"width"]:y*(m?f/m:0)+"px",transform:`translate${C?"Y":"X"}(${P}px)`},ref:u})),e.createElement("div",{className:"scrollbar-button scrollbar-button-increment",onMouseDown:B},e.createElement("svg",{className:"icon",viewBox:"0 0 50 50"},e.createElement("polygon",{points:C?"0,0 25,50 50,0":"0,0 50,25 0,50"}))))}));function $l({children:t,scrollWidth:r=0,scrollHeight:i=0,scrollAmount:n=10,droppable:s,onResize:o,onScroll:l,scrollableRef:c}){const u=(0,e.useRef)(null),h=(0,e.useRef)(null),d=(0,e.useRef)(null),f=(0,e.useRef)(null),m=(0,e.useRef)(null),p=(0,e.useRef)(null),[g,A]=(0,e.useState)(0),[b,v]=(0,e.useState)(0),[y,w]=(0,e.useState)(0),[E,_]=(0,e.useState)(0),[T,S]=(0,e.useState)(0),[x,k]=(0,e.useState)(r),[I,C]=(0,e.useState)(i),[P,M]=(0,e.useState)(0),[R,B]=(0,e.useState)(0),[L,D]=(0,e.useState)(!1),[N,F]=(0,e.useState)(!1),[O,z]=(0,e.useState)(0),U=P-(N?b:0),j=R-(L?g:0);(0,e.useEffect)((()=>{c&&(c.current={scrollTo:({left:e,top:t})=>{void 0!==e&&m.current.scrollTo(e),void 0!==t&&p.current.scrollTo(t)}})}),[c]),(0,e.useLayoutEffect)((()=>{D(x-U>1)}),[U,x]),(0,e.useLayoutEffect)((()=>{F(I-j>1)}),[j,I]),(0,e.useLayoutEffect)((()=>{u.current.classList.toggle("overflow-x",L)}),[L]),(0,e.useLayoutEffect)((()=>{u.current.classList.toggle("overflow-y",N)}),[N]),(0,e.useLayoutEffect)((()=>{var e;k(0===r?(null===(e=h.current)||void 0===e?void 0:e.scrollWidth)||0:r)}),[r]),(0,e.useLayoutEffect)((()=>{var e;C(0===i?(null===(e=h.current)||void 0===e?void 0:e.scrollHeight)||0:i)}),[i]);const V=(0,e.useCallback)((()=>{const e=u.current;M(e.clientWidth),B(e.clientHeight),w(e.getBoundingClientRect().top)}),[]),Q=(0,e.useCallback)((()=>{const e=h.current,t=f.current;0===r&&k(e.scrollWidth),0===i&&C(t.scrollHeight+d.current.clientHeight),null==o||o({width:e.clientWidth,height:e.clientHeight})}),[r,i,o]);a(u,V),a(h,Q),a(f,Q),(0,e.useLayoutEffect)((()=>{null==l||l({left:E,top:T})}),[E,T,l]);const q=(0,e.useCallback)((e=>{p.current.scrollBy(3*n*Math.sign(e.deltaY))}),[n]),X=(0,e.useCallback)((e=>{const t=e.nativeEvent.clientY-y;t+n/2>R?z(n):t<n&&z(-n)}),[y,R,n]);(0,e.useEffect)((()=>{if(O){const e=()=>p.current.scrollBy(O),t=ps(100).subscribe(e);return()=>t.unsubscribe()}}),[O]);const W=(0,e.useCallback)((()=>z(0)),[]),[H,G]=Ee(e.Children.toArray(t),(e=>(null==e?void 0:e.type)===ql));return e.createElement("div",{className:"scrollable",onWheel:q,ref:u},e.createElement("div",{className:"scrollable-content",onDragOver:s?X:void 0,onDragLeave:s?W:void 0,onDragEnd:s?W:void 0,onDrop:s?W:void 0,style:{right:N?`${b}px`:"0",bottom:L?`${g}px`:"0",transform:`translateX(-${E}px)`},ref:h},e.createElement("div",{className:"scrollable-head",ref:d},H),e.createElement("div",{className:"scrollable-body",style:{width:r?`${r}px`:void 0}},e.createElement("div",{className:"scrollable-body-content",style:{transform:`translateY(-${T}px)`},ref:f},G))),e.createElement(Gl,{orientation:"horizontal",clientSize:U,scrollSize:x,scrollAmount:n,onChange:_,onResize:A,scrollbarRef:m}),e.createElement(Gl,{orientation:"vertical",clientSize:j,scrollSize:I,scrollAmount:n,onChange:S,onResize:v,scrollbarRef:p}))}function Yl(t=200){const[r,i]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{const e=(e,t)=>Kr(document,e,{capture:!0}).pipe(nt((()=>t))),r=nn(e("keydown",!0),e("keyup",!1)).pipe((n=e=>e?Ze(0):ji(t),We((function(e,t){var r=!1,i=null,a=null,s=function(){if(null==a||a.unsubscribe(),a=null,r){r=!1;var e=i;i=null,t.next(e)}};e.subscribe(He(t,(function(e){null==a||a.unsubscribe(),r=!0,i=e,a=He(t,s,L),Qe(n(e)).subscribe(a)}),(function(){s(),t.complete()}),void 0,(function(){i=a=null})))})))).subscribe(i);var n;return()=>r.unsubscribe()}),[t]),r}function Kl(t){return(0,e.useMemo)((()=>Jl(t)),[t])}function Jl(e){return e.reduce(((e,t)=>(e.push(t.id),t.children?e.concat(Jl(t.children)):e)),[])}function Zl(t){return{storeExpandedState:(0,e.useCallback)(((e,r)=>{t&&localStorage.setItem(`${t}/${e}`,String(!!r))}),[t]),retrieveExpandedState:(0,e.useCallback)(((e,r=!1)=>{if(t){const i=localStorage.getItem(`${t}/${e}`);return"string"==typeof i?"true"===i:r}return r}),[t]),storeSelectedNodeId:(0,e.useCallback)((e=>{t&&localStorage.setItem(`${t}/selectedId`,e)}),[t]),retrieveSelectedNodeId:(0,e.useCallback)((e=>t&&localStorage.getItem(`${t}/selectedId`)||e),[t])}}function ec(t,r){const{storeExpandedState:i,retrieveExpandedState:n}=Zl(r),a=Kl(t),[s,o]=(0,e.useState)((()=>tc(t,n)));(0,e.useEffect)((()=>{const e=s.filter((e=>a.includes(e)));e.length!==s.length&&o(e)}),[a,s]);const l=(0,e.useCallback)(((e,t)=>{const r=s.includes(e);r!==t&&(o(r?s.filter((t=>t!==e)):s.concat(e)),i(e,!r))}),[s,i]);return{expandedIds:s,toggle:l}}function tc(e,t){return e.reduce(((e,r)=>(t(r.id,r.startExpanded)&&e.push(r.id),r.children?e.concat(tc(r.children,t)):e)),[])}function rc(t,r){return(0,e.useMemo)((()=>ic(t,r)),[t,r])}function ic(e,t){return e.reduce(((e,r)=>(e.push(r.id),r.children&&t.includes(r.id)?e.concat(ic(r.children,t)):e)),[])}function nc({id:t,label:r,children:i=[],selectedId:n,expandedIds:a,level:s,rowHeight:o,nodeIndex:l,setSize:c,onSelect:u,onToggle:h}){const d=a.includes(t),f=0!==i.length,m=t===n,p=`${f?"expandable":""} ${d?"expanded":""} ${m?"selected":""} ${0===i.length?"empty":""}`,g=(0,e.useCallback)((e=>{e.stopPropagation()}),[]),A=(0,e.useCallback)((e=>{e.stopPropagation(),null==u||u(t)}),[t,u]),b=(0,e.useCallback)((e=>{e.stopPropagation(),null==h||h(t)}),[t,h]),v=(0,e.useCallback)((e=>{e.stopPropagation(),null==h||h(t),d&&sc(i,n)&&(null==u||u(t))}),[t,n,d,i,u,h]);return e.createElement("li",{className:`tree-view-node ${p}`,id:`tree-view-node-${t}`,role:"treeitem","aria-selected":m?"true":void 0,"aria-expanded":d?"true":void 0,"aria-labelledby":`tree-view-node-label-${t}`,"aria-level":s,"aria-setsize":c,"aria-posinset":l+1,onMouseDown:A},e.createElement("span",{className:"tree-view-row",onDoubleClick:b,style:{height:`${o}px`}},f&&e.createElement("svg",{className:"tree-view-node-marker",viewBox:`0 0 ${d?320:256} 512`,onMouseDown:g,onClick:v},d?e.createElement("path",{d:"M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"}):e.createElement("path",{d:"M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"})),e.createElement("span",{className:"tree-view-node-label",id:`tree-view-node-label-${t}`},r)),d&&e.createElement("ul",{className:"tree-view-node-children",role:"group"},i.map(((t,r)=>{var{id:l}=t,c=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["id"]);return e.createElement(nc,Object.assign({},c,{id:l,selectedId:n,expandedIds:a,level:s+1,rowHeight:o,nodeIndex:r,setSize:i.length,onSelect:u,onToggle:h,key:l}))}))))}function ac({roots:t,className:r="",storeId:i,onContextMenu:n,onDelete:s,onEnter:o,onInfo:l,onSelect:c}){const u=(0,e.useRef)(null),h=(0,e.useRef)(null),d=(0,e.useRef)(null),{storeSelectedNodeId:f,retrieveSelectedNodeId:m}=Zl(i),[p,g]=(0,e.useState)((()=>{var e;return m(null===(e=t[0])||void 0===e?void 0:e.id)})),{expandedIds:A,toggle:b}=ec(t,i),v=rc(t,A),y=v.indexOf(p),[w,E]=(0,e.useState)(0),[_,T]=(0,e.useState)(24),[S,x]=(0,e.useState)(0),k=Math.floor(w/_)-1,I=v.length,C=oc(t,p),P=Yl()&&!(0===y||y===I-1),[M,R]=(0,e.useState)((()=>C));(0,e.useLayoutEffect)((()=>{if(!sc(t,p)){const e=t.find((e=>p.startsWith(`${e.id}/`)))||t[0];g(null==e?void 0:e.id)}}),[t,p]),(0,e.useLayoutEffect)((()=>{null==c||c(M)}),[M,c]),(0,e.useEffect)((()=>{f(p)}),[p,f]),(0,e.useEffect)((()=>{P||R(C)}),[C,P]);const B=(0,e.useCallback)((e=>{e.preventDefault(),null==n||n(C,e.pageX,e.pageY)}),[C,n]),L=(0,e.useCallback)((e=>{switch(e.key){case"Enter":e.stopPropagation(),e.repeat||null==o||o(C);break;case"Delete":e.stopPropagation(),e.repeat||null==s||s(C);break;case"Info":case"i":e.stopPropagation(),e.repeat||null==l||l(C);break;case"ArrowLeft":e.stopPropagation(),e.repeat||b(p,!1);break;case"ArrowRight":e.stopPropagation(),e.repeat||b(p,!0);break;default:{const t=function(e,t,r){switch(e){case"ArrowUp":return t[t.indexOf(r)-1]||r;case"ArrowDown":return t[t.indexOf(r)+1]||r;case"Home":return t[0]||r;case"End":return t[t.length-1]||r;default:return""}}(e.key,v,p);if(t&&(e.preventDefault(),t!==p)){e.stopPropagation();const r=h.current,i=Math.floor(S/_),n=v.indexOf(t);if(n>=i+k-1){const e=I*_,t=I-k-1,i=Math.min(I-1,n+1)-k,a=i===t?e:i*_;r.scrollTo({top:a})}else if(n<=i){const e=Math.max(0,n-1)*_;r.scrollTo({top:e})}g(t)}}}}),[v,p,C,_,k,I,S,s,o,l,b]),D=(0,e.useCallback)((({height:e})=>E(e)),[]),N=(0,e.useCallback)((({top:e})=>x(e)),[]);return a(d,(0,e.useCallback)((()=>{T(d.current.getBoundingClientRect().height)}),[])),e.createElement("div",{className:`tree-view ${r}`,tabIndex:0,onContextMenu:B,onKeyDown:L,ref:u},e.createElement($l,{scrollAmount:_,onResize:D,onScroll:N,scrollableRef:h},e.createElement("ul",{role:"tree"},t.map(((r,i)=>{var{id:n}=r,a=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(r,["id"]);return e.createElement(nc,Object.assign({},a,{id:n,selectedId:p,expandedIds:A,level:1,rowHeight:_,nodeIndex:i,setSize:t.length,onSelect:g,onToggle:b,key:n}))}))),e.createElement("div",{className:"tree-view-cursor",style:{transform:`translateY(${y*_}px)`},ref:d})))}function sc(e,t){for(const r of e){if(r.id===t)return!0;if(r.children&&sc(r.children,t))return!0}return!1}function oc(e,t){return e.reduce(((e,r)=>{if(void 0===e)if(r.id===t)e=r.value;else if(r.children)return oc(r.children,t);return e}),void 0)}function lc(){return e.createElement("div",{className:"panel"},e.createElement("div",{className:"page login"},e.createElement("p",null,"You need to be logged in to play music from Spotify*."),e.createElement("p",null,e.createElement(Lr,{className:"branded login",onClick:Is},"Log in to Spotify")),e.createElement("p",null,e.createElement("small",null,e.createElement("em",null,"*Spotify Premium required.")))))}function cc(){return e.createElement("div",{className:"panel"},e.createElement("div",{className:"page login"},e.createElement("p",null,"You can still play YouTube videos without being logged in.",e.createElement("br",null),"But you need to be logged in to search for music."),e.createElement("p",null,e.createElement(Lr,{className:"branded login",onClick:wn},"Log in to YouTube"))))}function uc({service:t}){switch(t.id){case"spotify":return e.createElement(lc,null);case"youtube":return e.createElement(cc,null);default:return e.createElement("div",{className:"panel"},e.createElement("div",{className:"page login"},e.createElement("p",null,"You need to be logged in to play music from ",t.title,"."),e.createElement("p",null,e.createElement(Lr,{className:"branded login",onClick:t.login},"Log in to ",t.title))))}}function hc({onSubmit:t}){const r=(0,e.useRef)(null),i=(0,e.useCallback)((e=>{const i=r.current.value;e.preventDefault(),null==t||t(i)}),[t]);return e.createElement("form",{className:"search-bar",onSubmit:i},e.createElement("p",{className:"search-bar-input"},e.createElement(Ur,{type:"search",spellCheck:!1,autoComplete:"off",autoCapitalize:"off",ref:r}),e.createElement(Lr,{type:"submit"},"Search")))}function dc(t,r){const[i,n]=(0,e.useState)(r),a=(0,e.useMemo)(t,[t]);return(0,e.useEffect)((()=>{const e=a.subscribe(n);return()=>e.unsubscribe()}),[a]),i}function fc(){const t=(0,e.useRef)(null);null===t.current&&(t.current=new Z),(0,e.useEffect)((()=>()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.complete()}),[]);const r=(0,e.useCallback)((e=>{t.current.next(e)}),[]);return[t.current,r]}function mc({item:t}){switch(t.itemType){case Ie.Media:return e.createElement(pc,{item:t});case Ie.Artist:return e.createElement(Ac,{item:t});case Ie.Album:return e.createElement(gc,{item:t});case Ie.Playlist:return e.createElement(bc,{item:t})}}function pc({item:t}){return e.createElement("article",{className:"media-info media-item-info"},e.createElement("div",{className:"media-info-main"},e.createElement(Sc,{thumbnails:t.thumbnails}),e.createElement(vc,{title:t.title}),e.createElement(yc,{artist:t.artist}),e.createElement(_c,{album:t.album,year:t.year}),e.createElement(wc,{owner:t.owner,src:t.src})),e.createElement(Ec,{url:t.externalUrl,src:t.src}))}function gc({item:t}){return e.createElement("article",{className:"media-info album-info"},e.createElement("div",{className:"media-info-main"},e.createElement(Sc,{thumbnails:t.thumbnails}),e.createElement(vc,{title:t.title}),e.createElement(yc,{artist:t.artist}),e.createElement(Tc,{year:t.year})),e.createElement(Ec,{url:t.externalUrl,src:t.src}))}function Ac({item:t}){return e.createElement("article",{className:"media-info artist-info"},e.createElement("div",{className:"media-info-main"},e.createElement(Sc,{thumbnails:t.thumbnails}),e.createElement(vc,{title:t.title})),e.createElement(Ec,{url:t.externalUrl,src:t.src}))}function bc({item:t}){return e.createElement("article",{className:"media-info playlist-info"},e.createElement("div",{className:"media-info-main"},e.createElement(Sc,{thumbnails:t.thumbnails}),e.createElement(vc,{title:t.title}),e.createElement(wc,{owner:t.owner,src:t.src})),e.createElement(Ec,{url:t.externalUrl,src:t.src}))}function vc({title:t}){return e.createElement("h3",{className:"title"},t||"(no title)")}function yc({artist:t}){return t?e.createElement("h4",{className:"artist"},"By: ",t):null}function wc({src:t,owner:r}){if(!r)return null;const[i]=t.split(":");let n="Owner";return"youtube"!==i?null:(n="Channel",e.createElement("p",{className:"owner"},n,":"," ",e.createElement("a",{href:r.url,target:`ampcast-${i}`},r.name)))}function Ec({src:t,url:r}){if(!r)return null;const[i]=t.split(":");let n="";switch(i){case"apple":n="Apple Music";break;case"spotify":n="Spotify";break;case"youtube":n="YouTube";break;case"lastfm":n="last.fm";break;default:return null}return e.createElement("p",{className:"external-view"},"View on ",n,": ",e.createElement(Dr,{name:i})," ",e.createElement("a",{href:r,target:`ampcast-${i}`},r))}function _c({album:t,year:r}){return t&&r?e.createElement("h4",{className:"album"},"From: ",t," (",r,")"):t?e.createElement("h4",{className:"album"},"From: ",t):r?e.createElement("h4",{className:"album"},"Year: ",r):null}function Tc({year:t}){return t?e.createElement("p",{className:"year"},"Year: ",t):null}function Sc({thumbnails:t}){const r=we(t);return e.createElement("div",{className:"thumbnail"},e.createElement("div",{className:"thumbnail-img",style:{backgroundImage:`url(${r.url})`}}))}function xc(t){zr((r=>e.createElement(kc,Object.assign({},r,{item:t,target:"popup"}))))}function kc(t){var{item:r}=t,i=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["item"]);return e.createElement(Fr,Object.assign({},i,{className:"media-info-dialog",title:"Media Info"}),e.createElement("form",{method:"dialog"},e.createElement(mc,{item:r}),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,null,"Close"))))}let Ic=null;const Cc=function(e){return"#globalDrag"===e.dataTransfer.getData("text")?Ic:null},Pc=function(e,t){e.dataTransfer.setData("text","#globalDrag"),Ic=t},Mc=function(){Ic=null};function Rc({style:t,title:r}){return e.createElement("div",{className:"list-view-cell",style:t},r)}function Bc({col:t,onResize:r}){const[i,n]=(0,e.useState)(t.width),[a,s]=(0,e.useState)(-1),[o,l]=(0,e.useState)(0),c=-1!==a,u=(0,e.useCallback)((e=>{e.preventDefault(),0===e.button&&(s(e.screenX),l(i))}),[i]);(0,e.useEffect)((()=>r(t.index,i)),[t.index,i,r]);const h=(0,e.useCallback)((e=>{n(Math.max(20,o+(e.screenX-a)))}),[a,o]),d=(0,e.useCallback)((()=>{s(-1),l(0)}),[]);return(0,e.useEffect)((()=>{if(c)return document.documentElement.style.cursor="col-resize",document.body.classList.add("dragging"),document.addEventListener("mouseup",d),document.addEventListener("mousemove",h),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",d),document.removeEventListener("mousemove",h)}}),[c,h,d]),e.createElement("span",{className:"column-resizer",onMouseDown:u,style:{left:t.left+i-4+"px"}})}function Lc({width:t,height:r,cols:i,sizeable:n,onColumnResize:a}){const s=(0,e.useCallback)(((e,t)=>{null==a||a(e,t)}),[a]);return e.createElement("header",{className:"list-view-head",style:{width:`${t}px`}},e.createElement("div",{className:"list-view-row",style:{width:`${t}px`,height:`${r}px`}},i.map((t=>e.createElement(Rc,Object.assign({},t,{key:t.title}))))," ",n&&i.map((t=>e.createElement(Bc,{col:t,onResize:s,key:t.title})))))}function Dc({rowIndex:t,col:{className:r="",render:i,style:n},item:a}){return e.createElement("div",{className:`list-view-cell ${r}`,style:n},i(a,t))}function Nc({item:t,className:r,rowIndex:i,height:n,selected:a,cols:s,setSize:o,dragIndex:l}){const c=`${r} ${a?"selected":""} ${l===o?i===o-1?"drag-over-last":"":l===i?"drag-over":""}`;return e.createElement("li",{role:"option",className:`list-view-row ${c}`,"aria-selected":a?"true":void 0,"aria-setsize":o,"aria-posinset":i+1,style:{height:`${n}px`,transform:`translateY(${n*i}px)`}},s.map((r=>e.createElement(Dc,{rowIndex:i,col:r,item:t,key:r.title}))))}function Fc({width:t,height:r,rowHeight:i,cols:n,items:a,itemKey:s,itemClassName:o,scrollTop:l,overScan:c=20,selection:u,draggable:h,dragIndex:d}){const f=(0,e.useRef)(null),m=a.length,p=Math.floor(l/i),g=Math.floor(r/i),A=Math.max(0,p-c),b=Math.min(m,g+2*c),v=(0,e.useMemo)((()=>a.slice(A,A+b)),[a,A,b]);return e.createElement("ol",{role:"listbox",className:"list-view-body",draggable:h,style:{width:t?`${t}px`:void 0},ref:f},v.map(((t,r)=>e.createElement(Nc,{className:o(t),rowIndex:A+r,height:i,selected:u.includes(t),cols:n,item:t,setSize:m,dragIndex:d,key:t[s]}))))}const Oc=()=>"";function zc({items:t=[],itemKey:r,itemClassName:i=Oc,layout:n,className:s="",draggable:l,droppable:c,droppableTypes:u=[],multiSelect:h,reorderable:d,onClick:f,onDoubleClick:m,onContextMenu:p,onDrop:g,onDelete:A,onEnter:b,onInfo:v,onRowIndexChange:y,onScrollIndexChange:w,onPageSizeChange:E,onSelect:_,onMove:T,listViewRef:S}){const x=(0,e.useRef)(null),k=(0,e.useRef)(null),I=(0,e.useRef)(null),C=(0,e.useRef)(null),P="details"===n.view&&n.showTitles,M="details"===n.view&&n.sizeable,[R,B]=(0,e.useState)(-1),[L,D]=(0,e.useState)(0),[N,F]=(0,e.useState)(0),[O,z]=(0,e.useState)(0),[U,j]=(0,e.useState)(0),[V,Q]=function(t,r=!1){const[i,n]=(0,e.useState)([]);(0,e.useEffect)((()=>{n(t.reduce(((e,t,i)=>{const n=e[i-1],a=n?n.left+n.width:0,{className:s="",align:o="left",sortOrder:l="none",sortPriority:c=0,width:u=200}=t,h=r?{left:`${a}px`,width:`${u}px`,textAlign:o}:{textAlign:o};return e.push(Object.assign(Object.assign({},t),{className:s,align:o,index:i,left:a,width:u,style:h,sortOrder:l,sortPriority:c})),e}),[]))}),[t,r]);const a=(0,e.useCallback)(((e,t)=>{r&&i[e].width!==t&&n(i.reduce(((r,i,n)=>{if(n>=e){const a=r[n-1],s=a?a.left+a.width:0,o=n===e?t:i.width,l={left:`${s}px`,width:`${o}px`,textAlign:i.align};r.push(Object.assign(Object.assign({},i),{left:s,width:o,style:l}))}else r.push(i);return r}),[]))}),[i,r]);return[i,a]}(n.cols,M),q=(0,e.useMemo)((()=>V.reduce(((e,t)=>e+t.width),0)),[V]),X=U?Math.floor(N/U)-(P?1:0):0,W=t.length,{selectedItems:H,selectAll:G,selectAt:$,selectRange:Y,toggleSelectionAt:K}=function(t,r){const[i,n]=(0,e.useState)([]);(0,e.useLayoutEffect)((()=>{const e=t.filter((e=>i.some((t=>t[r]===e[r]))));var a,s;s=e,(a=i).length===s.length&&a.every(((e,t)=>s[t]===e))||n(e)}),[t,i,r]);const a=(0,e.useCallback)((()=>{n(t.slice())}),[t]),s=(0,e.useCallback)((e=>{const r=t[e];n(r?[r]:[])}),[t]),o=(0,e.useCallback)(((e,r)=>{const i=Math.min(e,r),a=Math.max(e,r),s=t.slice(i,a+1);n(s)}),[t]),l=(0,e.useCallback)(((e,r)=>{const a=t[e],s=i.includes(a);s!==r&&n(s?i.filter((e=>e!==a)):i.concat(a))}),[t,i]);return{selectedItems:i,selectAll:a,selectAt:s,selectRange:o,toggleSelectionAt:l}}(t,r),J=o(),[Z,ee]=(0,e.useState)(-1),[te,re]=(0,e.useState)(-1),[ie,ne]=(0,e.useState)(-1),ae=0===W,se=function(t){const r=(0,e.useRef)();return(0,e.useEffect)((()=>{r.current=t}),[t]),r.current}(ae),oe=-1!==ie,le=U?Math.floor(L/U):0,ce=Yl()&&!(0===R||R===W-1),[ue,he]=(0,e.useState)((()=>H)),[de,fe,me,pe]=l?ue:[];(0,e.useEffect)((()=>{S&&(S.current={selectAll:G})}),[S,G]),(0,e.useLayoutEffect)((()=>null==y?void 0:y(R)),[R,y]),(0,e.useLayoutEffect)((()=>null==w?void 0:w(le)),[le,w]),(0,e.useLayoutEffect)((()=>null==E?void 0:E(X)),[X,E]),(0,e.useLayoutEffect)((()=>null==_?void 0:_(ue)),[ue,_]),(0,e.useEffect)((()=>B(Math.min(W-1,R))),[W,R]),(0,e.useEffect)((()=>{ce||he(H)}),[H,ce]),(0,e.useEffect)((()=>{ae?B(-1):se&&(B(0),$(0))}),[ae,se,$]);const ge=(0,e.useCallback)((e=>{switch(e.key){case"Enter":e.stopPropagation(),e.repeat||null==b||b(H,e.ctrlKey,e.shiftKey);break;case"Delete":e.stopPropagation(),null==A||A(H);break;case"i":if(e.stopPropagation(),e.ctrlKey&&!e.repeat){null==v||v(H);break}break;case"Info":e.preventDefault(),e.stopPropagation(),e.repeat||null==v||v(H);break;case"a":e.ctrlKey&&(e.preventDefault(),e.stopPropagation(),e.repeat||G());break;case"Shift":e.repeat||ee(R);break;case" ":e.preventDefault(),e.repeat||(e.ctrlKey?(e.stopPropagation(),K(R)):H.includes(t[R])||(e.stopPropagation(),K(R,!0)));break;default:{const r=t.length,i=function(e,t,r,i){switch(e){case"ArrowUp":t-=1;break;case"ArrowDown":t+=1;break;case"PageUp":t-=r-1;break;case"PageDown":t+=r-1;break;case"Home":t=0;break;case"End":t=i-1;break;default:return-1}return Math.min(Math.max(t,0),i-1)}(e.key,R,X,r);if(-1!==i){if(e.preventDefault(),i!==R){e.stopPropagation();const t=k.current,n=Math.floor(L/U);if(i>=n+X-1){const e=(r+(P?1:0))*U,n=r-X-1,a=Math.min(r-1,i+1)-X,s=a===n?e:a*U;t.scrollTo({top:s})}else if(i<=n){const e=Math.max(0,i-1)*U;t.scrollTo({top:e})}B(i)}h&&e.shiftKey&&-1!==Z?Y(Z,i):e.ctrlKey||$(i)}}}}),[R,t,X,U,P,b,A,v,G,$,Y,K,H,h,Z,L]),Ae=(0,e.useCallback)((e=>{const t=Uc(e);-1!==t&&(B(t),h&&e.ctrlKey?K(t):h&&e.shiftKey?-1===Z?Y(t,R):Y(Z,t):function(e){const t=jc(e);return(null==t?void 0:t.classList.contains("selected"))||!1}(e)||$(t))}),[$,K,Y,R,Z,h]),be=(0,e.useCallback)((e=>{if(0===e.button){const t=Uc(e);-1!==t&&(!h||e.ctrlKey||e.shiftKey||$(t))}}),[$,h]),ve=(0,e.useCallback)((e=>{"Shift"===e.key&&ee(-1)}),[]),ye=(0,e.useCallback)((({width:e,height:t})=>{z(e),F(t)}),[]),we=(0,e.useCallback)((({top:e})=>{D(e)}),[]);a(I,(0,e.useCallback)((()=>{j(I.current.getBoundingClientRect().height)}),[])),(0,e.useLayoutEffect)((()=>{x.current.classList.toggle("thin",20*J>O)}),[J,O]);const Ee=(0,e.useCallback)((e=>{const r=Uc(e);-1!==r&&(e.preventDefault(),null==f||f(t[r],r))}),[t,f]),_e=(0,e.useCallback)((e=>{e.preventDefault(),-1!==Uc(e)&&(null==p||p(H,e.pageX,e.pageY))}),[H,p]),Te=(0,e.useCallback)((e=>{const r=Uc(e);-1!==r&&(e.preventDefault(),null==m||m(t[r],r))}),[t,m]);(0,e.useEffect)((()=>{const e=C.current;for(;e.hasChildNodes();)e.removeChild(e.lastChild);const t=Array.from(x.current.querySelectorAll(".list-view-body:not(list-view-drag-image) li.selected"));t.length=Math.min(t.length,4);for(let r=0;r<t.length;r++){const i=t[r].cloneNode(!0);i.style.transform=`translateY(${U*r}px)`,e.appendChild(i)}}),[de,fe,me,pe,U]);const Se=(0,e.useCallback)((e=>{const t=e.dataTransfer;l||d?(Pc(e,H),t.setDragImage(C.current,-10,-10),t.effectAllowed=l&&d?"copyMove":l?"copy":"move",ne(R)):t.effectAllowed="none"}),[l,d,H,R]),xe=(0,e.useCallback)((e=>{const t=e.dataTransfer;if(c||d){const r=t.types.includes("text/plain");let i=Uc(e);-1===i&&(i=W),oe?d&&r?(t.dropEffect="move",re(i)):(t.dropEffect="none",re(-1)):c&&(r||Vc(t.items,u))?(t.dropEffect="copy",re(i)):(t.dropEffect="none",re(-1))}else oe?t.dropEffect="copy":(t.dropEffect="none",re(-1));e.preventDefault(),e.stopPropagation()}),[W,oe,c,u,d]),ke=(0,e.useCallback)((e=>{if(c||d){const t=e.dataTransfer;let r=Uc(e);if(-1===r&&(r=W),"copy"===t.effectAllowed){const t=Cc(e);t&&(null==g||g(t,r))}else if("move"===t.effectAllowed){const e=ie<r?-1:0;null==T||T(H,r),B(r+e)}else c&&Vc(t.items,u)&&(null==g||g(t.files,r))}re(-1),e.preventDefault(),e.stopPropagation()}),[W,H,c,u,d,ie,g,T]),Ie=(0,e.useCallback)((()=>{Mc(),ne(-1)}),[]),Ce=(0,e.useCallback)((()=>{re(-1)}),[]);return e.createElement("div",{className:`list-view list-view-${n.view} ${s}`,tabIndex:0,onClick:Ee,onContextMenu:_e,onDoubleClick:Te,onDragStart:Se,onDragEnter:xe,onDragOver:xe,onDragLeave:Ce,onDragEnd:Ie,onDrop:ke,onKeyDown:ge,onKeyUp:ve,onMouseDown:Ae,onMouseUp:be,ref:x},e.createElement($l,{scrollWidth:M?q:void 0,scrollHeight:(W+(c?1:0)+(P?1:0))*U,scrollAmount:U,droppable:c||d&&oe,onResize:ye,onScroll:we,scrollableRef:k},P&&e.createElement(ql,null,e.createElement(Lc,{width:q,height:U,sizeable:M,cols:V,onColumnResize:Q})),e.createElement(Fc,{width:M?q:void 0,height:N,rowHeight:U,cols:V,items:t,itemKey:r,itemClassName:i,scrollTop:L,selection:H,dragIndex:te,draggable:l||d}),e.createElement("div",{className:"list-view-cursor",style:{width:M?`${q}px`:void 0,transform:`translateY(${R*U}px)`},ref:I}),e.createElement("ul",{className:"list-view-drag-image list-view-body",ref:C})))}function Uc(e){let t=0;const r=jc(e);return r&&(t=Number(r.getAttribute("aria-posinset"))||0),t-1}function jc(e){let t=e.target;for(;t&&!(null==t?void 0:t.hasAttribute("aria-posinset"));)t=t.parentElement;return t}function Vc(e,t){return-1!==Array.from(e).findIndex((e=>t.some((t=>((e,t)=>{const[r,i]=e.split("/"),[n,a]=t.split("/");return r===n&&(i===a||"*"===i)})(t,e.type)))))}new Image(0,0).src=re;var Qc,qc=1,Xc={};function Wc(e){return e in Xc&&(delete Xc[e],!0)}var Hc=function(e){var t=qc++;return Xc[t]=!0,Qc||(Qc=Promise.resolve()),Qc.then((function(){return Wc(t)&&e()})),t},Gc=function(e){Wc(e)},$c={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=$c.delegate;return((null==r?void 0:r.setImmediate)||Hc).apply(void 0,g([],p(e)))},clearImmediate:function(e){var t=$c.delegate;return((null==t?void 0:t.clearImmediate)||Gc)(e)},delegate:void 0},Yc=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i.scheduler=t,i.work=r,i}return d(t,e),t.prototype.requestAsyncId=function(t,r,i){return void 0===i&&(i=0),null!==i&&i>0?e.prototype.requestAsyncId.call(this,t,r,i):(t.actions.push(this),t._scheduled||(t._scheduled=$c.setImmediate(t.flush.bind(t,void 0))))},t.prototype.recycleAsyncId=function(t,r,i){if(void 0===i&&(i=0),null!=i&&i>0||null==i&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,r,i);t.actions.some((function(e){return e.id===r}))||($c.clearImmediate(r),t._scheduled=void 0)},t}(ri),Kc=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var r,i=this.actions;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}},t}(ni))(Yc);function Jc({children:t}){return e.createElement("footer",{className:"status-bar"},t)}function Zc({items:t,size:r,maxSize:i,error:n,loading:a,loadingText:s="Loading",selectedCount:o,itemName:l="item",itemNamePlural:c=l+"s"}){let u="";if(a)u=e.createElement("span",{className:"message"},s,"...");else if(t.length>0){const n=t.reduce((e=>e+1),0),a=e.createElement("span",{className:"selected"},"(",o," selected)"),s=n===r?`${r.toLocaleString()} ${1===r?l:c}`:`Loaded ${n}/${void 0===r?i||`${t.length}+`:i?Math.min(r,i):r} ${c}`;u=e.createElement("span",{className:"message"},s," ",a)}else if(n){const t=null==n?void 0:n.message;u=e.createElement("span",{className:"error"},t?`Error: ${t}`:"Error")}else u=e.createElement("span",{className:"message"},"0 ",c);return e.createElement(Jc,null,u)}function eu({time:t,className:r}){return e.createElement("time",{className:r},function(e){return new Date(Math.round(1e3*(e||0))).toISOString().slice(11,19).replace(/^[0:]+(.{4,})$/,"$1")}(t))}const tu={view:"details",fields:["Title","Genre","Owner"]};const ru=t=>e.createElement(eu,{time:t.duration||0}),iu={Index:{title:"#",render:(e,t)=>t+1,className:"index",align:"right",width:60},Artist:{title:"Artist",render:e=>e.artist,className:"artist"},Title:{title:"Title",render:e=>e.title,className:"title"},Album:{title:"Album",render:e=>e.album,className:"album"},AlbumAndYear:{title:"Album",render:e=>e.album?e.year?`${e.album} (${e.year})`:e.album:e.year||"",className:"album"},Track:{title:"Track",render:e=>e.track||"-",align:"right",width:80,className:"track"},Duration:{title:"Time",render:ru,align:"right",width:120,className:"duration"},PlayCount:{title:"Play Count",render:e=>e.playCount||"",align:"right",width:120,className:"play-count"},TrackCount:{title:"Tracks",render:e=>e.trackCount||"",align:"right",width:120,className:"track-count"},Year:{title:"Year",render:e=>e.year||"",align:"right",width:120,className:"year"},Genre:{title:"Genre",render:e=>{var t;return null===(t=e.genre)||void 0===t?void 0:t.split(";").join(", ")},className:"genre"},Owner:{title:"Owner",render:e=>{var t;return null===(t=e.owner)||void 0===t?void 0:t.name},className:"owner"},LastPlayed:{title:"Last Played",render:e=>{if(!e.playedOn)return"";const t=Date.now()-e.playedOn;if(t<12e4)return"just now";const r=36e5;if(t<54e5)return`${Math.round(t/6e4)} minutes ago`;const i=24*r;if(t<1.5*i)return`${Math.round(t/r)} hours ago`;if(t<12*i)return`${Math.round(t/i)} days ago`;const n=7*i;if(t<10*n)return`${Math.round(t/n)} weeks ago`;const a=365*i;return t<a?`${Math.round(t/2592e6)} months ago`:t<2*a?"1 year ago":`${Math.floor(t/a)} years ago`},className:"played-on"},Thumbnail:{title:"Thumbnail",render:t=>{const r=we(t.thumbnails);return e.createElement("div",{className:"thumbnail-img",style:{backgroundImage:`url(${r.url})`}})},className:"thumbnail"}};function nu(t){var{className:r="",pager:i=null,keepAlive:n,statusBar:a=!0,loadingText:s,onSelect:o,unplayable:l}=t,c=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["className","pager","keepAlive","statusBar","loadingText","onSelect","unplayable"]);const u=function(t=tu){return(0,e.useMemo)((()=>function(e){const{view:t,fields:r}=e,i=r.map((e=>iu[e]));return"details"===t?{view:t,cols:i,showTitles:!0,sizeable:!0}:{view:t,cols:i}}(t)),[t])}(c.layout),[h,d]=(0,e.useState)(0),[f,m]=(0,e.useState)(0),[{items:p,loaded:g,error:A,size:b,maxSize:v},y]=function(t,r=!1){const[i,n]=fc(),[a,s]=(0,e.useState)([]),[o,l]=(0,e.useState)(void 0),[c,u]=(0,e.useState)(void 0),[h,d]=(0,e.useState)(),[f,m]=(0,e.useState)(!1),p=(0,e.useMemo)((()=>({items:a,size:o,maxSize:c,error:h,loaded:f})),[a,o,c,h,f]),g=(0,e.useCallback)(((e,t)=>{n([e,t])}),[n]);return(0,e.useEffect)((()=>{if(s([]),l(void 0),u(void 0),d(void 0),m(!1),!t)return;const e=t.observeItems(),n=t.observeSize(),a=t.observeMaxSize(),o=t.observeError(),c=nn(e,o).pipe(Nt(1),nt((()=>!0))),h=As(Ze([]),et.pipe(vs(0,Kc))),f=new _;return f.add(As(h,e).subscribe(s)),f.add(n.subscribe(l)),f.add(a.subscribe(u)),f.add(o.subscribe(d)),f.add(c.subscribe(m)),f.add(i.subscribe((([e,r])=>t.fetchAt(e,r)))),r||f.add((()=>t.disconnect())),()=>f.unsubscribe()}),[t,i,r]),[p,g]}(i,n),[w,E]=(0,e.useState)(0);(0,e.useEffect)((()=>{h>=0&&f>0&&y(h,f)}),[y,h,f,i]);const T=(0,e.useCallback)((e=>{E(e.length),null==o||o(e)}),[o]);return e.createElement("div",{className:`panel ${r}`},e.createElement(zc,Object.assign({},c,{className:"media-list "+(l?"":"playable"),layout:u,items:p,itemKey:"src",onPageSizeChange:m,onScrollIndexChange:d,onSelect:T})),a?e.createElement(Zc,{items:p,error:A,size:b,maxSize:v,loading:!!i&&!g,loadingText:s,selectedCount:w}):null)}function au({className:t="",children:r,onClose:i,x:n,y:a}){const s=(0,e.useRef)(null),[o,l]=(0,e.useState)({visibility:"hidden"});(0,e.useLayoutEffect)((()=>{const e={},t=s.current;n+t.offsetWidth>document.body.clientWidth?e.left=n-t.offsetWidth+"px":e.left=`${n}px`,a+t.offsetHeight>document.body.clientHeight?e.top=a-t.offsetHeight+"px":e.top=`${a}px`,l(e)}),[n,a]),(0,e.useEffect)((()=>{const e=nn(Kr(document,"click"),Kr(document,"keydown",{capture:!0}),Kr(document,"contextmenu",{capture:!0}),Kr(window,"blur")).subscribe((()=>i("")));return()=>e.unsubscribe()}),[i]);const c=(0,e.useCallback)((e=>{let t=e.target;for(;t&&!t.value;)t=t.parentElement;(null==t?void 0:t.value)&&(e.stopPropagation(),i(t.value))}),[i]);return pr.createPortal(e.createElement("menu",{className:`popup-menu ${t}`,onClick:c,style:o,ref:s},r),document.getElementById("popup"))}function su({label:t,acceleratorKey:r="",action:i}){return e.createElement("li",{className:"popup-menu-item"},e.createElement(Lr,{value:i},e.createElement("span",{className:"popup-menu-item-label"},t),e.createElement("span",{className:"popup-menu-item-accelerator-key"},r)))}function ou(r,i,n){return a=this,s=void 0,l=function*(){return new Promise(((a,s)=>{const o=document.createElement("div"),l=(0,t.s)(o);try{const t=e=>{l.unmount(),o.remove(),a(e)};document.body.append(o),l.render(e.createElement(r,{x:i,y:n,onClose:t}))}catch(e){l.unmount(),o.remove(),s(e)}}))},new((o=void 0)||(o=Promise))((function(e,t){function r(e){try{n(l.next(e))}catch(e){t(e)}}function i(e){try{n(l.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,i)}n((l=l.apply(a,s||[])).next())}));var a,s,o,l}function lu(t,r,i,n){return a=this,s=void 0,l=function*(){return ou((r=>e.createElement(cu,Object.assign({},r,{items:t,unplayable:n}))),r,i)},new((o=void 0)||(o=Promise))((function(e,t){function r(e){try{n(l.next(e))}catch(e){t(e)}}function i(e){try{n(l.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,i)}n((l=l.apply(a,s||[])).next())}));var a,s,o,l}function cu(t){var{items:r,unplayable:i}=t,n=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["items","unplayable"]);const a=1===r.length,s=!i&&r.every((e=>e.itemType===Ie.Media||e.itemType===Ie.Album));return e.createElement(au,Object.assign({},n,{className:"actions"}),e.createElement("ul",{className:"actions-menu-items"},s?e.createElement(e.Fragment,null,e.createElement(su,{label:"Queue",action:"queue",acceleratorKey:"Enter",key:"queue"}),e.createElement(su,{label:"Play next",action:"play-next",acceleratorKey:"Shift+Enter",key:"play-next"}),e.createElement(su,{label:"Play now",action:"play",acceleratorKey:"Ctrl+Enter",key:"play"})):null,a?e.createElement(su,{label:"Info...",action:"info",acceleratorKey:"Ctrl+I",key:"info"}):null))}var uu=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};const hu={view:"card compact",fields:["Thumbnail","Title","Artist","Year"]};function du(t){var{className:r="",layout:i=hu,unplayable:n}=t,a=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["className","layout","unplayable"]);const s=dc(zi.observeCurrentIndex,-1),o=(0,e.useCallback)((([e],t,r)=>uu(this,void 0,void 0,(function*(){switch(yield lu([e],t,r,n)){case"play":Eo.autoplay=!0,yield zi.insertAt(e,s+1),Eo.next();break;case"play-next":yield zi.insertAt(e,s+1);break;case"queue":zi.add(e);break;case"info":xc(e)}}))),[s,n]),l=(0,e.useCallback)((e=>{n||zi.add(e)}),[n]),c=(0,e.useCallback)((([e],t,r)=>uu(this,void 0,void 0,(function*(){n||(t||r?t&&!r?(Eo.autoplay=!0,yield zi.insertAt(e,s+1),Eo.next()):r&&!t&&(yield zi.insertAt(e,s+1)):zi.add(e))}))),[s,n]),u=(0,e.useCallback)((([e])=>{e&&xc(e)}),[]);return e.createElement(nu,Object.assign({},a,{className:`albums ${r}`,layout:i,draggable:!n,unplayable:n,onContextMenu:o,onDoubleClick:l,onEnter:c,onInfo:u}))}function fu(){return dc(Pi,null)}var mu=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))};const pu={view:"details",fields:["Artist","Title","Album","Track","Duration","Genre","PlayCount"]};function gu(t){var{className:r="",layout:i=pu,unplayable:n}=t,a=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["className","layout","unplayable"]);const s=fu(),o=dc(zi.observeCurrentIndex,-1),l=(0,e.useCallback)((e=>{const[t]=e.src.split(":");return`source-${t} ${e.src===(null==s?void 0:s.src)?"playing":""} ${e.unplayable?"unplayable":""}`}),[s]),c=(0,e.useCallback)(((e,t,r)=>mu(this,void 0,void 0,(function*(){switch(yield lu(e,t,r,n)){case"play":Eo.autoplay=!0,yield zi.insertAt(e,o+1),Eo.next();break;case"play-next":yield zi.insertAt(e,o+1);break;case"queue":zi.add(e);break;case"info":xc(e[0])}}))),[o,n]),u=(0,e.useCallback)((e=>{n||zi.add(e)}),[n]),h=(0,e.useCallback)(((e,t,r)=>mu(this,void 0,void 0,(function*(){n||(t||r?t&&!r?(Eo.autoplay=!0,yield zi.insertAt(e,o+1),Eo.next()):r&&!t&&(yield zi.insertAt(e,o+1)):zi.add(e))}))),[o,n]),d=(0,e.useCallback)((([e])=>{e&&xc(e)}),[]);return e.createElement(nu,Object.assign({},a,{className:`media-items ${r}`,itemClassName:l,layout:i,multiSelect:!0,draggable:!n,unplayable:n,onContextMenu:c,onDoubleClick:u,onEnter:h,onInfo:d}))}const Au={view:"details",fields:["Index","Title","Artist","Duration"]};function bu(t){var{source:r}=t,i=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["source"]);const[n,a]=(0,e.useState)(null),s=(0,e.useCallback)((([e])=>{a(e||null)}),[]);return e.createElement("div",{className:"panel album-browser"},e.createElement(u,{id:"album-browser-layout",arrange:"rows",primaryIndex:1},e.createElement(du,Object.assign({},i,{unplayable:r.unplayable,onSelect:s})),e.createElement(gu,{className:"album-items",pager:null==n?void 0:n.pager,keepAlive:!0,layout:r.secondaryLayout||Au,unplayable:r.unplayable})))}const vu={view:"card minimal",fields:["Thumbnail","Title"]};function yu(t){var{className:r="",layout:i=vu}=t,n=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["className","layout"]);const a=(0,e.useCallback)((([e],t,r)=>{return i=this,n=void 0,s=function*(){"info"===(yield lu([e],t,r))&&xc(e)},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(r,o)}l((s=s.apply(i,n||[])).next())}));var i,n,a,s}),[]),s=(0,e.useCallback)((([e])=>{e&&xc(e)}),[]);return e.createElement(nu,Object.assign({},n,{className:`artists ${r}`,layout:i,onContextMenu:a,onInfo:s}))}const wu={view:"card compact",fields:["Thumbnail","Title","Year"]},Eu={view:"details",fields:["Index","Title","Artist","Duration"]};function _u(t){var{source:r}=t,i=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["source"]);const[n,a]=(0,e.useState)(null),[s,o]=(0,e.useState)(null),l=(0,e.useCallback)((([e])=>{a(e||null)}),[]),c=(0,e.useCallback)((([e])=>{o(e||null)}),[]);return e.createElement("div",{className:"panel artist-browser"},e.createElement(u,{id:"artist-browser-layout",arrange:"columns",primaryIndex:0},e.createElement(yu,Object.assign({},i,{unplayable:r.unplayable,onSelect:l})),e.createElement(u,{id:"artist-album-browser-layout",arrange:"rows",primaryIndex:1},e.createElement(du,{className:"artist-albums",pager:null==n?void 0:n.pager,keepAlive:!0,layout:r.secondaryLayout||wu,unplayable:r.unplayable,onSelect:c}),e.createElement(gu,{className:"album-items",pager:null==s?void 0:s.pager,keepAlive:!0,layout:r.tertiaryLayout||Eu,unplayable:r.unplayable}))))}function Tu(t){var{source:r}=t,i=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["source"]);return e.createElement("div",{className:"panel media-item-browser"},"return ",e.createElement(gu,Object.assign({},i,{unplayable:r.unplayable})),";")}function Su({sources:t,onSourceChange:r}){const i=(0,e.useId)(),n=(0,e.useCallback)((e=>{const i=Number(e.target.value),n=t[i];null==r||r(n)}),[t,r]);return e.createElement("form",{className:"media-source-selector"},e.createElement("ul",{className:"media-sources"},t.map(((t,r)=>e.createElement("li",{className:"media-source",key:t.id},e.createElement(Ur,{id:`${i}-${t.id}`,type:"radio",name:"search-type",value:r,defaultChecked:0===r,onChange:n}),e.createElement("label",{htmlFor:`${i}-${t.id}`},t.title))))))}const xu={view:"card compact",fields:["Thumbnail","Title","TrackCount","Owner"]};function ku(t){var{className:r="",layout:i=xu,unplayable:n}=t,a=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["className","layout","unplayable"]);const s=(0,e.useCallback)((([e],t,r)=>{return i=this,a=void 0,o=function*(){"info"===(yield lu([e],t,r,n))&&xc(e)},new((s=void 0)||(s=Promise))((function(e,t){function r(e){try{l(o.next(e))}catch(e){t(e)}}function n(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(r,n)}l((o=o.apply(i,a||[])).next())}));var i,a,s,o}),[n]),o=(0,e.useCallback)((([e])=>{e&&xc(e)}),[]);return e.createElement(nu,Object.assign({},a,{className:`playlists ${r}`,layout:i,unplayable:n,onContextMenu:s,onInfo:o}))}const Iu={view:"details",fields:["Index","Artist","Title","Album","Duration","Genre","PlayCount"]};function Cu(t){var{source:r}=t,i=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["source"]);const[n,a]=(0,e.useState)(null),s=(0,e.useCallback)((([e])=>{a(e||null)}),[]);return e.createElement("div",{className:"panel playlist-browser"},e.createElement(u,{id:"playlist-browser-layout",arrange:"rows",primaryIndex:1},e.createElement(ku,Object.assign({},i,{unplayable:r.unplayable,onSelect:s})),e.createElement(gu,{className:"playlist-items",pager:null==n?void 0:n.pager,keepAlive:!0,layout:r.secondaryLayout||Iu,unplayable:r.unplayable})))}function Pu({service:t,sources:r}){const i=dc(t.observeIsLoggedIn,!1),n=String(r.map((e=>e.id)));return e.createElement("div",{className:`media-browser ${t.id}-browser`,key:n},i?0===t.sources.length?null:e.createElement(Mu,{service:t,sources:r}):e.createElement(uc,{service:t}))}function Mu({sources:t}){const[r,i]=(0,e.useState)((()=>t[0])),[n,a]=(0,e.useState)(""),s=function(t,r=""){const[i,n]=fc(),[a,s]=(0,e.useState)(null);return(0,e.useEffect)((()=>{if(t){const e=i.pipe(nt((e=>t.search(e)))).subscribe(s);return()=>e.unsubscribe()}s(null)}),[t,i]),(0,e.useEffect)((()=>n(r)),[r,t,n]),a}(r,n),o=!!r.searchable;return e.createElement(e.Fragment,null,o&&e.createElement(hc,{onSubmit:a}),t.length>1?e.createElement(Su,{sources:t,onSourceChange:i}):null,e.createElement(Ru,{source:r,pager:s,layout:r.layout,loadingText:n?"Searching":void 0}))}function Ru(t){switch(t.source.itemType){case Ie.Artist:return e.createElement(_u,Object.assign({},t));case Ie.Album:return e.createElement(bu,Object.assign({},t));case Ie.Playlist:return e.createElement(Cu,Object.assign({},t));default:return e.createElement(Tu,Object.assign({},t))}}function Bu({icon:t,text:r,showConnectivity:i}){return e.createElement("span",{className:"media-source-label"},e.createElement(Dr,{name:t,className:i?"show-connectivity":""}),e.createElement("span",{className:"text"},r))}function Lu({onSelect:t}){const r=function(){const t=dc(Ol,(0,e.useMemo)(zl,[]));return(0,e.useMemo)((()=>Bl.filter((e=>t.includes(e.id))).map((r=>({id:r.id,label:e.createElement(Bu,{icon:r.icon,text:r.title,showConnectivity:!0}),value:e.createElement(Pu,{sources:r.searches,service:r}),startExpanded:!0,children:r.sources.filter((e=>t.includes(e.id))).map((t=>({id:t.id,label:e.createElement(Bu,{icon:t.icon,text:t.title}),value:e.createElement(Pu,{sources:[t],service:r})})))})))),[t])}();return e.createElement("div",{className:"panel media-sources"},e.createElement(ac,{roots:r,onSelect:t,storeId:Dl.id}))}function Du({label:t,items:r,className:i=""}){const n=(0,e.useId)(),[a,s]=(0,e.useState)(0),o=r.length,l=(0,e.useCallback)((e=>{switch(e.key){case"left":e.preventDefault(),a>0&&(s(a-1),e.stopPropagation());break;case"right":e.preventDefault(),a<o-1&&(s(a+1),e.stopPropagation())}}),[a,o]);return e.createElement("div",{className:`tab-list ${i}`},e.createElement("ul",{className:"tab-list-tabs",role:"tablist","aria-label":t,onKeyDown:l},r.map(((t,r)=>e.createElement("li",{role:"presentation",key:r},e.createElement(Nu,{id:n,item:t,index:r,selected:r===a,onSelect:s}))))),e.createElement("div",{className:"tab-list-panels"},r.map(((t,r)=>e.createElement(Fu,{id:n,item:t,index:r,hidden:r!==a,key:r})))))}function Nu({id:t,item:r,index:i,selected:n,onSelect:a}){const s=(0,e.useCallback)((()=>a(i)),[i,a]);return e.createElement(Lr,{className:"tab",id:`${t}-tab-${i}`,tabIndex:n?0:-1,role:"tab","aria-selected":n,"aria-controls":`${t}-panel-${i}`,onFocus:s},r.tab)}function Fu({id:t,item:r,index:i,hidden:n}){return e.createElement("div",{className:"tab-panel",id:`${t}-panel-${i}`,tabIndex:0,hidden:n,role:"tabpanel","aria-labelledby":`${t}-tab-${i}`},r.panel)}console.log("component::MediaSources");function Ou(t){var{colorName:r}=t,i=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["colorName"]);const n=(0,e.useCallback)((e=>{Za[r]=e.target.value}),[r]);return e.createElement(Ur,Object.assign({},i,{type:"color",onChange:n}))}const zu=[{tab:"Theme",panel:e.createElement((function(){const t=(0,e.useMemo)((()=>Za.fontSize),[]),r=dc((()=>Za.observe()),Ya);(0,e.useLayoutEffect)((()=>(document.getElementById("system").style.setProperty("--font-size",String(Za.fontSize)),()=>Za.restore())),[]);const i=(0,e.useCallback)((()=>Za.save()),[]),n=(0,e.useCallback)((e=>{Za.load(e.target.value)}),[]),a=(0,e.useCallback)((e=>{Za.spacing=e.target.valueAsNumber}),[]),s=(0,e.useCallback)((e=>{Za.fontSize=e.target.valueAsNumber}),[]),o=(0,e.useCallback)((e=>{Za.roundness=e.target.valueAsNumber}),[]),l=(0,e.useCallback)((e=>{Za.flat=e.target.checked}),[]);return e.createElement("form",{className:"theme-settings",method:"dialog",onSubmit:i},e.createElement("fieldset",null,e.createElement("legend",null,e.createElement("label",{htmlFor:"theme-name"},"Name:"),e.createElement("select",{id:"theme-name",onChange:n,value:Za.name},Ka.map((({name:t})=>e.createElement("option",{value:t,key:t},t||"(none)"))))),e.createElement("div",{className:"table-layout"},e.createElement("p",null,e.createElement("label",{htmlFor:"theme-fontFamily"},"Font:"),e.createElement("select",{id:"theme-fontFamily"},e.createElement("option",null,"Arial, sans-serif"))),e.createElement("p",null,e.createElement("label",null,"Frame:"),e.createElement(Ou,{id:"frameColor",colorName:"frameColor",value:r.frameColor,title:"Frame background"}),e.createElement(Ou,{colorName:"frameTextColor",value:r.frameTextColor,title:"Frame text"})),e.createElement("p",null,e.createElement("label",null,"Content:"),e.createElement(Ou,{colorName:"backgroundColor",value:r.backgroundColor,title:"Content background"}),e.createElement(Ou,{colorName:"textColor",value:r.textColor,title:"Content text"})),e.createElement("p",null,e.createElement("label",{htmlFor:"theme-spacing"},"Spacing:"),e.createElement(Ur,{type:"range",id:"theme-spacing",min:0,max:1,step:.03125,value:r.spacing,onChange:a})),e.createElement("p",null,e.createElement("label",{htmlFor:"theme-roundness"},"Roundness:"),e.createElement(Ur,{type:"range",id:"theme-roundness",min:0,max:1,step:.03125,value:r.roundness,onChange:o})),e.createElement("p",null,e.createElement("label",{htmlFor:"theme-flat"},"Flat:"),e.createElement(Ur,{type:"checkbox",id:"theme-flat",checked:r.flat,onChange:l}))),e.createElement("p",{className:"dialog-buttons"},e.createElement(Lr,{className:"small",type:"button",disabled:!0},"Save…"))),e.createElement("p",null,e.createElement("label",{htmlFor:"theme-fontSize"},"Font Size:"),e.createElement(Ur,{type:"range",id:"theme-fontSize",min:10,max:32,step:1,defaultValue:t,onChange:s,key:t})),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel"},"Cancel"),e.createElement(Lr,null,"Confirm")))}),null)}],Uu=[{tab:"General",panel:e.createElement((function(){const t=(0,e.useMemo)((()=>bi()),[]),r=dc(Ai,t),i=(0,e.useRef)(null),n=(0,e.useRef)(null),a=(0,e.useRef)(null),s=(0,e.useRef)(null),o=(0,e.useCallback)((()=>{vi(t)}),[t]),l=(0,e.useCallback)((()=>{vi({allowDuplicates:i.current.checked,showLineNumbers:n.current.checked,zeroPadLineNumbers:a.current.checked,showSourceIcons:s.current.checked})}),[]);return e.createElement("form",{className:"playlist-general-settings",method:"dialog"},e.createElement("fieldset",null,e.createElement("legend",null,"Content"),e.createElement("p",null,e.createElement(Ur,{id:"playlist-allow-duplicates",type:"checkbox",checked:r.allowDuplicates,onChange:l,ref:i}),e.createElement("label",{htmlFor:"playlist-allow-duplicates"},"Allow duplicates"))),e.createElement("fieldset",null,e.createElement("legend",null,"Display"),e.createElement("p",null,e.createElement(Ur,{id:"playlist-item-numbers",type:"checkbox",checked:r.showLineNumbers,onChange:l,ref:n}),e.createElement("label",{htmlFor:"playlist-item-numbers"},"Show playlist line numbers")),e.createElement("p",null,e.createElement(Ur,{id:"playlist-zero-pad",type:"checkbox",checked:r.zeroPadLineNumbers,disabled:!r.showLineNumbers,onChange:l,ref:a}),e.createElement("label",{htmlFor:"playlist-zero-pad"},"Zero pad line numbers")),e.createElement("p",null,e.createElement(Ur,{id:"playlist-source-icons",type:"checkbox",checked:r.showSourceIcons,onChange:l,ref:s}),e.createElement("label",{htmlFor:"playlist-source-icons"},"Show media source icons"))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel",onClick:o},"Cancel"),e.createElement(Lr,null,"Confirm")))}),null)}];function ju(e,t){return function(r,i){return!e.call(t,r,i)}}function Vu(e,t,r){return[Ft(t,r)(Qe(e)),Ft(ju(t,r))(Qe(e))]}const Qu="\nmo2re_RX3Bs blXien2Jh_o etiatMRgFcM DYsMJiwiZSI _MZ7UZ5frCI 33XT9PQUfVU HCx1Z92PjJE dIP7wWY4Znw\nA1m0SEqmmbE 9uZ8CCa0t4Y MXlFDpaQ1ec wz_ItcoR0-c jS4-FmNEDKo Tz77vqH_LJw K73lfmxDVR0 W8ayfyRWUrg\ncbuldALGsaQ AJZon2grzmA H5ASEM9dMiA GE2YEq7vaLc MYGOdJNAzrI Oszl95YWfbs b0-IkxXyhmY\nAgpGXSAS7Cs p-OUNPqRzII XaTxLSPh_Is 1n3ezT1cvAM CWU1pZVw0xM ry1Q7KaQdxM VlC5LSTvoj0\ng5yQtQc3K-0 f6OZ01vvmko o4jE24WixcI BIej9P2LrzM dxw91a7C5BQ jmh_usvhHLw VVkZKzTbWQs vXCB1zGGFiY\nJHARFKMl8dU KSB1AZ0-I74 IGqfU6cJJc8 8zg22-ZCUfE WMlR8eJRS3I V0ggp2sJqA0 A5pbF_YBulo dRFRsKobN9I\ntlN0LoTv3c0 IlDvBTDGanI Az3UNGBKRX8 mOmwk3WyYnw im2eWwIiTOc lxQS58t39_U yk076o8NF3k oggiHfuV4m8\np_GnUkm-G1M xVMsAgHy_IY VdZkfef44JI ZxOd8tmdsIM fszuqfJWKxc 0LGL_lx9XcA i_hU5eUrVIs\nuZjCNtOeZG4 ZpXnEvW0XD0 -C8TYbhnVTU WzxSiEWK3cg ZE8vuq4aqNA 7HMw3bcIgRE ZJiCEDweLl8 lyh2kAjcmSY\nvFwqZ4qAUkE QLbPYQcUcgM xwf7EssFnXU FvNFuSTDPuk vvm8b2jAfv0 XkRFSnxXQ_w Ee0Qh_nIoHw 78rppSvbh7A\nNXIaYDJql1c e5eg-tOusSo ZkRjihsMdp8 e1M6jHcRrlM z9Ug-3qhrwY mA30W2dHQIo XIhEPwTMjWk -Tm4H4CrKT0\nT6tapzmF_n0 7QetsPh7BPM xBDqge4w-XA suWbFuw1O_I yCUQ8n2OxjI ZX8fSO8uTPg xX9xfFT-Qw0 0G9a9o3wOIQ\n-WIamcIaipI Zjc6DwVDvq0 eHjoav_sb88 7E0WVROBsEE BvLIJSmzAnY YPurG3WT8xI\naC7s2UVXt3c EJArkl7K29k 9eFVeErnUzg 7eyYe-MN1Nc B1-yyoNMUzs Ab5I38wGxko sVuqgnXD9AE\nY0U0HAwpw2s Shf_P0PLhNA Nde5P8Ob2xg f-Xul0mdBCA ExStG9rRkoY tMzCwwvHwN0\nQ6YbP3m-KvA eYpCCSAW3aw XfBNIrQ5JKQ -b68N6Q4Qus H3mdjo7kYiQ 9CJLtzzUphU yy-aMo2ds2k\nLtPGmDskDiY U9rtWGI6H5A NHa506wwN0Y PLSxe5Z8Asw ubQKAfwSLDA aFsNz5VMyC8 h6yhFP_qUro\nPEgQ0dIOB5c KWz3SXWnFys MGRDy2PqCGk 4DcMcAHrURw ETwbuC3p1ls iszl1WqjQIk njcvxMb8TVQ sTS5tBOS4GM\nhNNN5xPyyeY 8ls8xBn70gM 2XREaQqoU1U MXL2qjIL4qI 9YqbQcfIre0 JVI9BvU8-Oo\nPaIH77c53LA FSlhSL8bFoI XLuV3_a-ro0 mo7mUJZV6DM IqWPDr8KCmQ v-QS_Kh_i6o RvZFYE5jo1M Xn8tufsbSz0\n7gG4l70v8mw thurNCHVo08 YgryBZTMVZY XAmU3yQc90M KBUg3U3MRao v_My9t4gadA Xwb1xsWClCM KlH1g1x6RJk\nyYP2A8TkSQ0 LMSmWzCqlPE oN3glsVrnRY PPBV3hem5iM 1JbI8Ml25WQ nSJ67PGjQfQ EoBF2xRsbAc KDUYy3xwCFs\nRZOcoZS_52Q pSP9_otXcTU H36qe8NatNQ qgfd-uWTVwg Blu_yCEFYvk HeYMIBFtwh4 fb0QX7DbqLg kdqyAA0ILD4\nriZWEoGKyuU 4qo9bKRxgYA t0j_GdkG1BM hLq9J32lGRs zfc53CpvlZ4 IjNKQbm4AQ8 Ms0uDHae8FY tG991Undnbc\nsh8l2-cCAGQ XDE5pd4V_xc C2BVXFIX7bY ySPxZpoqXZ8 hiEUaLX4cCM wHxEyBMi1A4 YJSw3ougt9Y 2hUJBRUtrPU\nWsCCYv2adkM kD5x3_b1J0o 9Rvtm2zGEl4 DGlAMkUjcY0 h2s_WOkfTXk 0VhxPdtX0xg 6vuFh6NNa70 ukOHqdPbYYg\nH6OmEQ8RqVk qPp315pPVSI FQqj6gN7M6M Xrwks9O2-JQ ipRwt3TDgY4 aVqRyfRviwA X33dmu12C5c QEwzFKoG7tk\nh98nR30UD8Q Z7WpAwRjprI ilqlSBYfCGs V6SoeDWDon0 d-Hwz42Vfw4 hcmxvqJDpDw 22dlye7h3qU\nblSZ365wpfQ ADF4KgfhzPs jSRvD7Uma1g uLMC6bL_q38 k9DuPxFQ7HQ 7f2taFPyqxc YVYDz_coSfY\nOad8nSzotHw YiezM4raRrY H3GL5jO53NU acTsYqhq-AA vp2yiZnjK0w eR5vsN1Lq4E D_l0pBDHFgs HFnt39uG5W0\n7qXiAaxxGBs m6m6bqHiT6U l5jUOT0XiUM NLxwmtJSvk4 dv_QzcJGHAE kaPD4n9uQ2k r7HpeG2ofU0 O1AQcFpPs04\n44ih4WRTyGg W5BmjLsEsB0 JkNlFaei_k8 2ttB1FzBpZ4 k3Q1vse7In8 7xltSb3VBJQ ojbiGfhnjTU _Qb7TJ-T1HM\ngvT3gIDSwq8 4X95pykbYTY BPDznHIgVMA OIA5xQWkk2U 2uQ58Xwx1V4 UVjCFpYMR6A -uww0BzTb7g EqWBy5i8LyQ\nszErNcJMCdA 5k1DGpr_qDw YNEkjkh0bYo jmjrpHYegzc Eye8xYrjm24 rVLOQB5kGGw F8MN0o6RS9o viim_l9gbF8\nsBtYWK817-0 cFRcqnCpqoo y7vz1qQGUd8 -0ewPjoBBNI S1emxk9UWBE 1muEwEFDKgk nnDBkUfVU1Y MPEvXbw3hYA\nwwXpkTd1CaQ W2A_PcIhUVM ZIb8u6uJwBo TWjid2dVjMk gdJjc6l6iII n3Dru5y3ROc OOf4Z7tyLVM iDXDrTKJehk\nwYhliE9O_3k nw0uvJZonBc cK7x6lUUsYo XPjkpBDEs2U e2AUzM6QgGs 3cxyYOXiJss AsD5u6k6dKI d_hx39kXDUg\nhlvfDL3nSoo 6L2xYzu724E OhBo1A8atuA V-ntXk-4TPo yttvb9ByOtY ctqujFKaFZQ NWF3dNJ-EhQ WUkwH9WmmBA\nef1wAfrMg5I eN-RZVkFGj0 dc8LEG9jDFM 0-skl5qAC9Q u1rRUwx_Vy4 iTjgWeJMUJo WL9EOfzoSsA xrCNwCD-z-M\nCC3AanQdQZA ZGLrP5eawdY HoOghpRTkvs N787WRdI35A Cw0d-nqSNE8 2vifO3_gjiM OeJ5xXrbkfU\njP4gBqxfheI gIJxDy25nwM oN8q7p57nZw 6vnxzfejWN4 gVamQ6jodK0 iU5QjAbuhec qLIU_90P4Ac z8k_ximc8Og\nZFBoN7yIMZw 4mexI7cACZk bx-0YlFprqc NDWpXTg3koc Vo2AcHSCRiQ 2ve6LNoU6Qk WXI7byeZk5s y8d7Ihe0IwE\nubmUJcwor3k CGslieDL-04 w7ljU-lmaK4 I0B21LjeSUQ PyFN_FYwqvc vlyVzeLzNe8 ahmrb5EYoxY HGxuVWpN8vQ\nDNR1zyr5Go4 eyPhudLTuis aPWXL4ahxdY JB0A8Me8EKk dGy_6qyyY7c rxrDLgt5YFA uhcocK-td5E 4Z5FLeh7P18\nVB0zDS9ITmk VukLV0AoeFA CouF-tNHV3g lTvYjERVAnY S27YOjpgaaE 24uCC_-zaaE DslTxXsDLsw xilGAQPx5Xw\nzlHISDs2HtQ tdi8B0YzxHg R1OHRQoJOP0 fbqmVbEj9fg asL1AN3hifU rUkLoqxFOTw 3ma3yXXc3V8 1U1We59en3s\niNm7PPqO6rM CLRk8SgtVS4 VYO8Biwffns -imG6CNF9kI ZMOC332wC7A doORhRob3Qg E2sSvVCRI4s nPQ4BpTfK1Q\nE6Ww7lpuZ2k Ueqm3PQKYPk eFiKAcbp2MY dAfMgDBeqwU Wuq5NHJPXyQ LAFK1EvwulU rU07g1g-PIY L_mlofcsRaA\neZe4Q_58UTU NXObT_Fl-xI t6jlhqNxRYk _WkkH31sTMI ALJcKvnOjHM 85Y1N8avsXs NCY42RnUpCE 2QSukL7dl5o\n0Tpq2mLtXDc Zp1Oajc7VQw WGi4XiEGe8M b6L40CEYVyM Mw9qiV7XlFs UgHKb_7884o mvIYmMo906E 2RakvEQhTTA\nRyOu7hdbqg0 k9rKpHXwA1E MTG3VA-m6qk cU3XY6Ii8v0 Flbhk1KHHJw k5sznEJz8BA R8W3U0Mu6t4\n6KBo0GhU9XM d5R3FK9vLBs N5b7Iy4W0ow VogwWGEO1-c YKRe7n3jQ_M A-mPDdnzipI 6gqU-HL68wE\nVIlQIVVLWVs 6A-kQCdEIpI _lisL6tLbdg VarS6olPfTA va306f9aN3A zzscMK0ZtjE KpFU_kIw6To\nbHK0ZvQzfOY PkF4EKJQOOg 0aMUCiKjBDI D1KsEOUqCEU _SFTmh-b-Z4 omlVslJvzxQ FoS3732REf0\nqqC80mXlOKo MS2asGj1-_M BizH494DmJI IahW6hJ1-SM 9MIJm1NeUpE 2qzbMPpgtDw H3UY2gQfj-s 9kekiNImlsI\n5zUCClmhjF0 76Atd-tAkmg e18IjYKZnTA MAFdQs_yWvg xkAUTCdoteI X0IEHj4PhCc JX19TZp8gDQ 7TML_MTQdg4\nSH4f_DnPIto\n".match(/\S+/g).map((e=>`youtube:video:${e}`));var qu=function(e,t,r,i){return new(r||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))},Xu=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r};console.log("module::visualizer");const Wu=new ie("visualizer"),Hu=aa.map((e=>e.name)),Gu=li("ampcast/visualizer","keyval"),$u={provider:"none",preset:""},Yu=new te($u),Ku=new te({}),Ju=new Z,Zu=Zs().pipe(Ft((e=>null==e))),eh=Zs().pipe(Ft(Ae)),[th,rh]=Vu(eh,(e=>e.mediaType===yt.Audio)),[ih,nh]=Vu(io(),Boolean),ah=[...Array(83).fill("milkdrop"),...Array(10).fill("video"),...Array(5).fill("audiomotion"),...Array(1).fill("ampshade"),...Array(1).fill("waveform")];function sh(){return Yu}function oh(){return ch().pipe(nt((e=>!!e.locked)))}function lh(){return ch().pipe(nt((e=>e.provider||"")),rt())}function ch(){return Ku}function uh(){Ju.next(void 0)}function hh(){return qu(this,void 0,void 0,(function*(){return fh(!0)}))}function dh(){return qu(this,void 0,void 0,(function*(){return fh(!1)}))}function fh(e){return qu(this,void 0,void 0,(function*(){const t=Ku.getValue(),{locked:r}=t,i=Xu(t,["locked"]);if(!!r!==e){const t=Yu.getValue(),r=e?Object.assign(Object.assign({},i),{locked:t}):i;yield di("settings",r,Gu),Ku.next(r)}}))}qu(void 0,void 0,void 0,(function*(){var e;const t=null!==(e=yield hi("settings",Gu))&&void 0!==e?e:{};Ku.next(t)})),Zu.subscribe((()=>os.stop())),th.subscribe((()=>os.hidden=!1)),rh.subscribe((()=>{os.pause(),os.hidden=!0})),ih.subscribe((()=>os.pause())),nn(th,Ju,lh(),os.observeError()).pipe(Zr(th,ch()),nt((([,e,t])=>function(e,t){if(t.locked)return t.locked;let r=t.provider,i="";e.src.startsWith("spotify:")&&(r="video"),r||(r=xe(ah));const n=Yu.getValue().preset;switch(r){case"audiomotion":i=xe(Hu,n);break;case"milkdrop":i=xe(da.getNames(),n);break;case"video":i=xe(Qu,n)}return i?{provider:r,preset:i}:$u}(e,t))),rt()).subscribe(Yu),sh().pipe(Rt((e=>os.load(e)))).subscribe(Wu),th.pipe(Ot((()=>nh))).subscribe((()=>os.play())),Wu.log("Ambient videos:",Qu.length),Wu.log("AudioMotion presets:",aa.length),da.observe().pipe(Zr(sh()),Rt((([,e])=>{e===$u&&uh()})),Nt(2)).subscribe((()=>Wu.log("Butterchurn presets:",da.size)));const mh=[{tab:"General",panel:e.createElement((function(){const t=(0,e.useRef)(null),r=dc(lh,""),i=(0,e.useCallback)((()=>{!function(e){qu(this,void 0,void 0,(function*(){const t=Ku.getValue(),{provider:r}=t,i=Xu(t,["provider"]);if(e!==r){const t=e?Object.assign(Object.assign({},i),{provider:e}):i;yield di("settings",t,Gu),Ku.next(t)}}))}(t.current.value)}),[]);return e.createElement("form",{className:"visualizer-general-settings",method:"dialog",onSubmit:i},e.createElement("p",null,e.createElement("label",{htmlFor:"visualizer-provider"},"Provider:"),e.createElement("select",{id:"visualizer-provider",defaultValue:r,key:r,ref:t},e.createElement("option",{value:""},"(random)"),e.createElement("option",{value:"video"},"Ambient Video"),e.createElement("option",{value:"audiomotion"},"AudioMotion Visualizer"),e.createElement("option",{value:"milkdrop"},"Milkdrop Visualizer"),e.createElement("option",{value:"waveform"},"Waveform Visualizer"),e.createElement("option",{value:"ampshade"},"Ampshade Visualizer"))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel"},"Cancel"),e.createElement(Lr,null,"Confirm")))}),null)}];function ph(){return e.createElement(Du,{items:mh,label:"Visualizers"})}function gh(t){return e.createElement(Fr,Object.assign({},t,{className:"visualizer-settings-dialog",title:"Visualizer Settings"}),e.createElement(ph,null))}function Ah(){const t=(0,e.useId)(),r=(0,e.useRef)(null),i=(0,e.useMemo)((()=>Ql.getServices()),[]),n=(0,e.useCallback)((()=>{const e=[],t=r.current.elements;for(const r of t)r.checked&&e.push(r.value);Ql.setServices(e)}),[]);return e.createElement("form",{className:"media-library-general-settings",method:"dialog",onSubmit:n},e.createElement("fieldset",{ref:r},e.createElement("legend",null,"Display"),e.createElement("ul",null,Bl.map((r=>e.createElement("li",{key:r.id},e.createElement(Ur,{id:`${t}-${r.id}`,type:"checkbox",value:r.id,defaultChecked:i.includes(r.id),disabled:"local"===r.id}),e.createElement("label",{htmlFor:`${t}-${r.id}`},r.title)))))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel"},"Cancel"),e.createElement(Lr,null,"Confirm")))}function bh({service:t}){const r=(0,e.useMemo)((()=>[{tab:"General",panel:e.createElement(vh,{service:t})}]),[t]);return e.createElement(Du,{items:r,label:t.title})}function vh({service:t}){const r=(0,e.useId)(),i=(0,e.useRef)(null),n=dc(t.observeIsLoggedIn,!1),a=(0,e.useMemo)((()=>Ql.getSources(t.id)),[t]),s=(0,e.useCallback)((()=>{const e=[],r=i.current.elements;for(const t of r)t.checked&&e.push(t.value);Ql.setSources(t.id,e)}),[t]);return e.createElement("form",{className:`media-library-settings ${t.id}-settings`,method:"dialog",onSubmit:s},e.createElement("p",null,e.createElement(Lr,{className:"disconnect",onClick:t.logout,disabled:!n},n?"Disconnect...":"Not connected")),e.createElement("fieldset",{ref:i},e.createElement("legend",null,"Display"),e.createElement("ul",null,t.sources.map((t=>e.createElement("li",{key:t.id},e.createElement(Ur,{id:`${r}-${t.id}`,type:"checkbox",value:t.id,defaultChecked:a.includes(t.id)}),e.createElement("label",{htmlFor:`${r}-${t.id}`},t.title)))))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel"},"Cancel"),e.createElement(Lr,null,"Confirm")))}const yh=[{id:"services",label:"Media Services",value:e.createElement((function(){const t=(0,e.useMemo)((()=>[{tab:"General",panel:e.createElement(Ah,null)}]),[]);return e.createElement(Du,{items:t,label:"Media Services"})}),null),startExpanded:!0,children:[{id:"apple",label:e.createElement(Bu,{icon:"apple",text:"Apple Music"}),value:e.createElement((function(){return e.createElement(bh,{service:ir})}),null)},{id:"spotify",label:e.createElement(Bu,{icon:"spotify",text:"Spotify"}),value:e.createElement((function(){return e.createElement(bh,{service:Rl})}),null)},{id:"youtube",label:e.createElement(Bu,{icon:"youtube",text:"YouTube"}),value:e.createElement((function(){return e.createElement(bh,{service:Pn})}),null)},{id:"plex",label:e.createElement(Bu,{icon:"plex",text:"Plex"}),value:e.createElement((function(){return e.createElement(bh,{service:El})}),null)},{id:"jellyfin",label:e.createElement(Bu,{icon:"jellyfin",text:"Jellyfin"}),value:e.createElement((function(){return e.createElement(bh,{service:No})}),null)},{id:"lastfm",label:e.createElement(Bu,{icon:"lastfm",text:"last.fm"}),value:e.createElement((function(){return e.createElement(bh,{service:nl})}),null)}]},{id:"visualizer",label:"Visualizer",value:e.createElement(ph,null)},{id:"playlist",label:"Playlist",value:e.createElement((function(){return e.createElement(Du,{items:Uu,label:"Playlist Settings"})}),null)},{id:"playback",label:"Playback",value:e.createElement("div",null)},{id:"appearance",label:"Appearance",value:e.createElement((function(){return e.createElement(Du,{items:zu,label:"Appearance"})}),null)}];function wh(){return yh}function Eh(t){const r=wh(),[i,n]=(0,e.useState)(e.createElement("div",null));return e.createElement(Fr,Object.assign({},t,{className:"settings-dialog",title:"Settings"}),e.createElement(ac,{className:"settings-dialog-sources",roots:r,storeId:"settings-dialog-sources",onSelect:n}),e.createElement("div",{className:"settings-dialog-source"},i))}function _h(t){var{icon:r,className:i=""}=t,n=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["icon","className"]);return e.createElement(Lr,Object.assign({},n,{className:`icon-button icon-button-${r} ${i}`,onMouseDown:_e,onDoubleClick:Te}),e.createElement(Dr,{name:r}))}function Th(){const[t,r]=(0,e.useState)(null),[i,n]=Or(Eh);return e.createElement("div",{className:"media-library"},e.createElement("header",{className:"media-library-head"},e.createElement("h1",null,"Ampcast ",e.createElement("span",{className:"version"},"0.4.7")),e.createElement(_h,{icon:"settings",className:"in-frame",title:"Settings",onClick:n}),i),e.createElement("div",{className:"media-library-body"},e.createElement(u,{id:"media-library-layout",arrange:"columns",primaryIndex:1},e.createElement(Lu,{onSelect:r}),t)))}function Sh({className:t="",children:r}){return e.createElement("div",{className:`icon-buttons ${t}`},r)}function xh(){return dc(sh,null)}function kh(t){const[r,i]=(0,e.useState)(null);return(0,e.useEffect)((()=>{null==r&&null!=t&&i(t)}),[r,t]),r}function Ih({visualizer:t}){return e.createElement("article",{className:"visualizer-info"},e.createElement(Ch,{visualizer:t}),e.createElement(Ph,{visualizer:t}))}function Ch({visualizer:t}){return e.createElement("h3",null,"Visualizer: ",function(e){switch(null==e?void 0:e.provider){case"ampshade":return"Ampshade";case"audiomotion":return"AudioMotion";case"milkdrop":return"Milkdrop";case"video":return"Ambient Video";case"waveform":return"Waveform";default:return"none"}}(t))}function Ph({visualizer:t}){return"video"===(null==t?void 0:t.provider)&&t.preset.startsWith("youtube:")?e.createElement(Mh,{visualizer:t}):(null==t?void 0:t.preset)?e.createElement("h4",null,"Name: ",t.preset):null}function Mh({visualizer:t}){const r=function(t){const[r,,i]=t.split(":"),[n,a]=(0,e.useState)(null);return(0,e.useEffect)((()=>{if(a(null),i&&"youtube"===r){const e=Je(Cn(i)).subscribe(a);return()=>e.unsubscribe()}}),[r,i]),n}(t.preset);return r?e.createElement("div",{className:"youtube-video-info"},e.createElement("h4",null,"Title: ",r.title),e.createElement(wc,{owner:r.owner,src:r.src}),e.createElement(Ec,{url:r.externalUrl,src:r.src})):null}function Rh(t){const r=fu(),i=xh(),n=kh(r),a=kh(i);return e.createElement(Fr,Object.assign({},t,{className:"currently-playing-dialog",title:"Media Info"}),e.createElement("form",{method:"dialog"},n?e.createElement(mc,{item:n}):e.createElement("p",null,"The playlist is empty."),n&&n.mediaType!==yt.Video?e.createElement(Ih,{visualizer:a}):null,e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,null,"Close"))))}function Bh(){const t=dc(oh,!1),[r,i]=Or(Rh,"popup"),[n,a]=Or(gh),s=function(){const t=fu(),r=xh(),[i,n]=(0,e.useState)("");return(0,e.useEffect)((()=>{(null==t?void 0:t.src.startsWith("youtube:"))?n("youtube"):(null==t?void 0:t.src.startsWith("apple:"))&&(null==t?void 0:t.mediaType)===yt.Video?n("apple"):(null==r?void 0:r.preset.startsWith("youtube:"))?n("youtube"):n("")}),[t,r]),i}();return e.createElement("div",{className:"visualizer-controls"},e.createElement(Sh,{className:"visualizer-controls-settings"},e.createElement(_h,{className:"with-overlay",icon:"info",title:"Info",tabIndex:-1,onClick:i}),r,e.createElement(_h,{className:"with-overlay",icon:"settings",title:"Settings",tabIndex:-1,onClick:a}),n),e.createElement(Sh,{className:"visualizer-controls-selector"},e.createElement(_h,{className:"with-overlay",icon:t?"locked":"unlocked",title:t?"Unlock":"Lock the current visualizer",tabIndex:-1,onClick:t?dh:hh}),t?null:e.createElement(_h,{className:"with-overlay",icon:"right",title:"Next visualizer",tabIndex:-1,onClick:uh})),s?e.createElement(Dr,{className:"source-icon",name:s}):null)}function Lh(){const t=fu(),[r,i]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{const e=setTimeout((()=>i(!1)),5e3);return i(!0),()=>clearTimeout(e)}),[t]),e.createElement("div",{className:"interstitial "+(r?"is-recent":"")},t?e.createElement(Dh,{item:t}):e.createElement("p",null,"The playlist is empty."))}function Dh({item:t}){return e.createElement("div",{className:"currently-playing"},e.createElement("h3",null,t.title),t.artist?e.createElement(e.Fragment,null,e.createElement("span",{className:"by"},"by"),e.createElement("h4",null,t.artist)):null)}function Nh(){const t=(0,e.useRef)(null),[r,i]=(0,e.useState)(!1);(0,e.useLayoutEffect)((()=>{Eo.appendTo(t.current)}),[]),(0,e.useLayoutEffect)((()=>{const e=Kr(document,"fullscreenchange").pipe(nt((()=>document.fullscreenElement===t.current))).subscribe(i);return()=>e.unsubscribe()}),[]),a(t,(0,e.useCallback)((()=>{const e=t.current;Eo.resize(e.clientWidth,e.clientHeight)}),[]));const n=(0,e.useCallback)((()=>{r?document.exitFullscreen():t.current.requestFullscreen()}),[r]);return e.createElement("div",{className:"panel media "+(r?"full-screen":""),onDoubleClick:n,ref:t},e.createElement("div",{id:"players"}),e.createElement("div",{id:"visualizers"}),e.createElement(Lh,null),e.createElement(Bh,null))}function Fh({icon:t,onClick:r}){return e.createElement(Lr,{className:`media-button media-button-${t}`,onClick:r},e.createElement(Dr,{name:t}))}function Oh(){const t=(0,e.useRef)(null),r=(0,e.useRef)(null),i=dc(eo,0),n=dc(to,0),a=dc(io,!0),[s,o]=(0,e.useState)((()=>Eo.muted)),[l,c]=(0,e.useState)((()=>Eo.volume)),u=l<=.33?"low":l<=.67?"medium":"high";(0,e.useEffect)((()=>{Eo.muted=s}),[s]),(0,e.useEffect)((()=>{Eo.volume=l}),[l]);const h=(0,e.useCallback)((()=>{fo(t.current.valueAsNumber)}),[]),d=(0,e.useCallback)((()=>{const e=r.current.valueAsNumber;c(e),o(0===e)}),[]),f=(0,e.useCallback)((()=>{o((e=>!e))}),[]);return e.createElement("div",{className:`media-playback-bar volume-${u}`},e.createElement("p",{className:"media-playback-bar-current-time"},e.createElement(eu,{time:i}),e.createElement(Ur,{id:"playhead",type:"range",min:0,max:n,step:1,value:i,disabled:a,onChange:h,ref:t})),e.createElement("div",{className:"media-playback-bar-controls"},e.createElement("p",{className:"media-playback-bar-volume"},e.createElement(_h,{icon:s?"muted":"volume",className:"in-frame",title:s?"unmute":"mute",onClick:f}),e.createElement(Ur,{type:"range",min:0,max:1,step:.01,value:s?0:l,onChange:d,ref:r})),e.createElement("p",{className:"media-playback-bar-buttons"},e.createElement(Fh,{icon:"prev",onClick:po}),e.createElement(Fh,{icon:a?"play":"pause",onClick:a?uo:ho}),e.createElement(Fh,{icon:"stop",onClick:mo}),e.createElement(Fh,{icon:"next",onClick:go})),e.createElement("p",{className:"media-playback-bar-more"},e.createElement(Lr,{className:"media-button media-button-shuffle",onClick:Ao},"Shuffle"))))}console.log("component::MediaLibrary"),console.log("component::Media");function zh(t){var{items:r}=t,i=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["items"]);const n=1===r.length;return e.createElement(au,Object.assign({},i,{className:"actions"}),e.createElement("ul",{className:"actions-menu-items"},e.createElement(su,{label:"Select all",action:"select-all",acceleratorKey:"Ctrl+A",key:"select-all"}),n?e.createElement(su,{label:"Play",action:"play",acceleratorKey:"Enter",key:"play"}):null,e.createElement(su,{label:"Remove",action:"remove",acceleratorKey:"Del",key:"remove"}),n?e.createElement(su,{label:"Info...",action:"info",acceleratorKey:"Ctrl+I",key:"info"}):null))}const Uh={view:"details",showTitles:!1,cols:[{title:"#",render:()=>null,align:"right",className:"track"},{title:"Source",render:function({src:t}){const[r]=t.split(":");return e.createElement(Dr,{name:r,className:"youtube"===r?"":"show-connectivity"})},align:"center",className:"source"},{title:"Title",render:function({title:t,artist:r}){return r?e.createElement(e.Fragment,null,e.createElement("span",{className:"artist-text"},r),e.createElement("span",{role:"separator"},"-"),e.createElement("span",{className:"title-text"},t)):e.createElement("span",{className:"title-text"},t)},className:"title"},{title:"Time",render:ru,align:"right",className:"duration"}]};const jh=["audio/*","video/*"];function Vh(t){var{onSelect:r,onPlay:i}=t,n=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}(t,["onSelect","onPlay"]);const a=(0,e.useRef)(null),s=dc(zi.observe,[]),o=function(t){const r=String(t).length,{zeroPadLineNumbers:i,showLineNumbers:n,showSourceIcons:a}=dc(Ai,bi());return(0,e.useMemo)((()=>Object.assign(Object.assign({},Uh),{cols:Uh.cols.filter((e=>{switch(e.className){case"track":return n;case"source":return a;default:return!0}})).map((e=>"track"===e.className?Object.assign(Object.assign({},e),{render:(e,t)=>function(e,t=0){return String(e+1).padStart(t,"0")}(t,i?r:0)}):e))})),[i,n,a,r])}(s.length),l=fu(),[c,u]=(0,e.useState)(0),h=(0,e.useCallback)((e=>{const[t]=e.src.split(":");return`source-${t} ${e.id===(null==l?void 0:l.id)?"playing":""} ${e.unplayable?"unplayable":""}`}),[l]),d=(0,e.useCallback)((e=>{u(e.length),null==r||r(e)}),[r]),f=(0,e.useCallback)((e=>{null==i||i(e)}),[i]),m=(0,e.useCallback)((e=>{1===e.length&&(null==i||i(e[0]))}),[i]),p=(0,e.useCallback)(((t,r,n)=>{return s=this,o=void 0,c=function*(){const s=yield function(t,r,i){return n=this,a=void 0,o=function*(){return ou((r=>e.createElement(zh,Object.assign({},r,{items:t}))),r,i)},new((s=void 0)||(s=Promise))((function(e,t){function r(e){try{l(o.next(e))}catch(e){t(e)}}function i(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(r,i)}l((o=o.apply(n,a||[])).next())}));var n,a,s,o}(t,r,n);switch(s){case"play":null==i||i(t[0]);break;case"remove":zi.remove(t);break;case"info":xc(t[0]);break;case"select-all":a.current.selectAll()}},new((l=void 0)||(l=Promise))((function(e,t){function r(e){try{n(c.next(e))}catch(e){t(e)}}function i(e){try{n(c.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):(n=t.value,n instanceof l?n:new l((function(e){e(n)}))).then(r,i)}n((c=c.apply(s,o||[])).next())}));var s,o,l,c}),[i]);return e.createElement("div",{className:"playlist"},e.createElement(zc,Object.assign({},n,{className:"media-list playable",layout:o,items:s,itemKey:"id",itemClassName:h,droppable:!0,droppableTypes:jh,multiSelect:!0,reorderable:!0,onContextMenu:p,onDelete:zi.remove,onDoubleClick:f,onDrop:zi.insertAt,onEnter:m,onMove:zi.moveSelection,onSelect:d,listViewRef:a})),e.createElement(Zc,{items:s,size:s.length,selectedCount:c}))}function Qh(){return dc(io,!0)}function qh(){const t=Qh(),r=(0,e.useCallback)((e=>{return t=this,r=void 0,n=function*(){Eo.autoplay=!0,yield zi.setCurrentItem(e),Eo.play()},new((i=void 0)||(i=Promise))((function(e,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,o)}l((n=n.apply(t,r||[])).next())}));var t,r,i,n}),[]);return e.createElement("div",{className:"media-playback "+(t?"paused":"")},e.createElement(u,{id:"media-playback-layout",arrange:"rows"},e.createElement("div",{className:"panel playback"},e.createElement(Oh,null),e.createElement(Vh,{onPlay:r})),e.createElement(Nh,null)))}console.log("component::MediaPlayback");const Xh={apple:bt,jellyfin:No,lastfm:nl,plex:El,spotify:Rl,youtube:Pn};function Wh(e){const t=e.dataTransfer;t&&(e.preventDefault(),t.effectAllowed="none",t.dropEffect="none")}const Hh=navigator.mediaSession;console.log("module::App"),(0,t.s)(document.getElementById("app")).render(e.createElement((function(){return(0,e.useEffect)((()=>{document.body.classList.add(`browser-${ge.name.replace(/\s+/g,"-")}`)}),[]),(0,e.useEffect)((()=>{const e=new _;return Object.keys(Xh).forEach((t=>{const r=Xh[t].observeIsLoggedIn().subscribe((e=>{document.body.classList.toggle(`${t}-connected`,e),document.body.classList.toggle(`${t}-not-connected`,!e)}));e.add(r)})),()=>e.unsubscribe()}),[]),(0,e.useEffect)((()=>{const e=Kr(document,"dragenter"),t=Kr(document,"dragover"),r=Kr(document,"drop"),i=nn(e,t).pipe(Rt(Wh)),n=nn(i,r.pipe(Rt(_e))).subscribe();return()=>n.unsubscribe()}),[]),function(){const t=fu(),r=Qh(),i=dc(eo,0),n=dc(to,0);(0,e.useEffect)((()=>{Hh.setPositionState({duration:n,position:i,playbackRate:1})}),[n,i]),(0,e.useEffect)((()=>{const e=t?r?"paused":"playing":"none",i=ji(0,100).pipe(Nt(2),Rt((()=>{!function(e){var t;Hh.metadata=e?new MediaMetadata({title:e.title,artist:e.artist,album:e.artist?"":e.album,artwork:(null===(t=e.thumbnails)||void 0===t?void 0:t.map((e=>({src:e.url,sizes:`${e.width}x${e.height}`}))))||[]}):null}(t),Hh.setActionHandler("play",uo),Hh.setActionHandler("pause",ho),Hh.setActionHandler("stop",mo),Hh.setActionHandler("previoustrack",po),Hh.setActionHandler("nexttrack",go),Hh.setActionHandler("seekto",(e=>{null!=e.seekTime&&fo(e.seekTime)})),Hh.playbackState=e}))).subscribe();return()=>i.unsubscribe()}),[t,r])}(),function(){const t=Qh();(0,e.useEffect)((()=>{document.getElementById("system").addEventListener("keydown",Te),document.getElementById("popup").addEventListener("keydown",Te)}),[]),(0,e.useEffect)((()=>{document.body.addEventListener("keydown",(e=>function(e,t){switch(e.key){case" ":case"MediaPlayPause":e.preventDefault(),t?Eo.play():Eo.pause();break;case"MediaStop":e.preventDefault(),Eo.stop();break;case"MediaTrackPrevious":e.preventDefault(),Eo.prev();break;case"MediaTrackNext":e.preventDefault(),Eo.next();break;case"AudioVolumeMute":e.preventDefault(),Eo.muted=!0}}(e,t)))}),[t])}(),function(){(0,e.useEffect)((()=>{(()=>{var e,t,r,i;e=this,t=void 0,i=function*(){var e,t,r,i;const{state:n="granted"}=(yield null===(e=navigator.permissions)||void 0===e?void 0:e.query({name:"persistent-storage"}))||{};let a=yield null===(r=null===(t=navigator.storage)||void 0===t?void 0:t.persisted)||void 0===r?void 0:r.call(t);"granted"!==n||a||(a=yield null===(i=navigator.storage)||void 0===i?void 0:i.persist()),console.log("Persisted storage:",{state:n,persisted:a})},new((r=void 0)||(r=Promise))((function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}))})()}),[])}(),e.createElement("main",null,e.createElement(u,{id:"main-layout",arrange:"columns"},e.createElement(Th,null),e.createElement(qh,null)))}),null))})()})();