/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var __webpack_modules__={9742:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,a=l(e),s=a[0],o=a[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,s,o)),u=0,h=o>0?s-4:s;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===o&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[u++]=255&t),1===o&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],s=16383,o=0,l=n-i;o<l;o+=s)a.push(c(e,o,o+s>l?l:o+s));return 1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=a.length;s<o;++s)r[s]=a[s],n[a.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,n){for(var i,a,s=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},8764:(e,t,r)=>{"use strict";const n=r(9742),i=r(645),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function o(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|p(e,t);let n=o(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if($(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if($(e,ArrayBuffer)||e&&$(e.buffer,ArrayBuffer))return f(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&($(e,SharedArrayBuffer)||e&&$(e.buffer,SharedArrayBuffer)))return f(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,r);const i=function(e){if(l.isBuffer(e)){const t=0|m(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||Y(e.length)?o(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),o(e<0?0:0|m(e))}function d(e){const t=e.length<0?0:0|m(e.length),r=o(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,l.prototype),n}function m(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||$(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return W(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return H(e).length;default:if(i)return n?-1:W(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return I(this,t,r);case"latin1":case"binary":return C(this,t,r);case"base64":return x(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function A(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Y(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){let a,s=1,o=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,o/=2,l/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let n=-1;for(a=r;a<o;a++)if(c(e,a)===c(t,-1===n?0:a-n)){if(-1===n&&(n=a),a-n+1===l)return n*s}else-1!==n&&(a-=a-n),n=-1}else for(r+l>o&&(r=o-l),a=r;a>=0;a--){let r=!0;for(let n=0;n<l;n++)if(c(e,a+n)!==c(t,n)){r=!1;break}if(r)return a}return-1}function y(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const a=t.length;let s;for(n>a/2&&(n=a/2),s=0;s<n;++s){const n=parseInt(t.substr(2*s,2),16);if(Y(n))return s;e[r+s]=n}return s}function w(e,t,r,n){return G(W(t,e.length-r),e,r,n)}function E(e,t,r,n){return G(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return G(H(t),e,r,n)}function T(e,t,r,n){return G(function(e,t){let r,n,i;const a=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,a.push(i),a.push(n);return a}(t,e.length-r),e,r,n)}function x(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function S(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let a=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=r){let r,n,o,l;switch(s){case 1:t<128&&(a=t);break;case 2:r=e[i+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(a=l));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(l=(15&t)<<12|(63&r)<<6|63&n,l>2047&&(l<55296||l>57343)&&(a=l));break;case 4:r=e[i+1],n=e[i+2],o=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&o)&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&o,l>65535&&l<1114112&&(a=l))}}null===a?(a=65533,s=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=s}return function(e){const t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=k));return r}(n)}t.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,r){return function(e,t,r){return u(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},l.allocUnsafe=function(e){return h(e)},l.allocUnsafeSlow=function(e){return h(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if($(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),$(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=l.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if($(t,Uint8Array))i+t.length>n.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)A(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)A(this,t,t+3),A(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)A(this,t,t+7),A(this,t+1,t+6),A(this,t+2,t+5),A(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},a&&(l.prototype[a]=l.prototype.inspect),l.prototype.compare=function(e,t,r,n,i){if($(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let a=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);const o=Math.min(a,s),c=this.slice(n,i),u=e.slice(t,r);for(let e=0;e<o;++e)if(c[e]!==u[e]){a=c[e],s=u[e];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},l.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let a=!1;for(;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return w(this,e,t,r);case"ascii":case"latin1":case"binary":return E(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const k=4096;function I(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function C(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function P(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=K[e[n]];return i}function M(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function R(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,r,n,i,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n,i){V(t,n,i,e,r,7);let a=Number(t&BigInt(4294967295));e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function D(e,t,r,n,i){V(t,n,i,e,r,7);let a=Number(t&BigInt(4294967295));e[r+7]=a,a>>=8,e[r+6]=a,a>>=8,e[r+5]=a,a>>=8,e[r+4]=a;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function N(e,t,r,n,i,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(e,t,r,n,a){return t=+t,r>>>=0,a||N(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function O(e,t,r,n,a){return t=+t,r>>>=0,a||N(e,0,r,8),i.write(e,t,r,n,52,8),r+8}l.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=this[e],i=1,a=0;for(;++a<t&&(i*=256);)n+=this[e+a]*i;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=J((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=J((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=this[e],i=1,a=0;for(;++a<t&&(i*=256);)n+=this[e+a]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||R(e,t,this.length);let n=t,i=1,a=this[e+--n];for(;n>0&&(i*=256);)a+=this[e+--n]*i;return i*=128,a>=i&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||R(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){e>>>=0,t||R(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=J((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=J((function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Q(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||R(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||R(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||R(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||R(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);let i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);let i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=J((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=J((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);B(this,e,t,r,n-1,-n)}let i=0,a=1,s=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);B(this,e,t,r,n-1,-n)}let i=r-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=J((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=J((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return O(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return O(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},l.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const a=l.isBuffer(e)?e:l.from(e,n),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=a[i%s]}return this};const z={};function U(e,t,r){z[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function j(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function V(e,t,r,n,i,a){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=a>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(a+1)}${n}`:`>= -(2${n} ** ${8*(a+1)-1}${n}) and < 2 ** ${8*(a+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new z.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){q(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||Q(t,e.length-(r+1))}(n,i,a)}function q(e,t){if("number"!=typeof e)throw new z.ERR_INVALID_ARG_TYPE(t,"number",e)}function Q(e,t,r){if(Math.floor(e)!==e)throw q(e,r),new z.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new z.ERR_BUFFER_OUT_OF_BOUNDS;throw new z.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=j(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=j(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const X=/[^+/0-9A-Za-z-_]/g;function W(e,t){let r;t=t||1/0;const n=e.length;let i=null;const a=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function H(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function $(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Y(e){return e!=e}const K=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function J(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},2238:e=>{var t;window,t=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./src/index.js")}({"./node_modules/@assemblyscript/loader/index.js":function(e,t,r){"use strict";r.r(t),r.d(t,"instantiate",(function(){return h})),r.d(t,"instantiateSync",(function(){return d})),r.d(t,"instantiateStreaming",(function(){return f})),r.d(t,"demangle",(function(){return m}));const n="undefined"!=typeof BigUint64Array,i=Symbol(),a=new TextDecoder("utf-16le");function s(e,t){const r=new Uint32Array(e)[t+-4>>>2]>>>1,n=new Uint16Array(e,t,r);return r<=32?String.fromCharCode.apply(String,n):a.decode(n)}function o(e){const t={};function r(e,t){return e?s(e.buffer,t):"<yet unknown>"}const n=e.env=e.env||{};return n.abort=n.abort||function(e,i,a,s){const o=t.memory||n.memory;throw Error(`abort: ${r(o,e)} at ${r(o,i)}:${a}:${s}`)},n.trace=n.trace||function(e,i,...a){const s=t.memory||n.memory;console.log(`trace: ${r(s,e)}${i?" ":""}${a.slice(0,i).join(", ")}`)},n.seed=n.seed||Date.now,e.Math=e.Math||Math,e.Date=e.Date||Date,t}function l(e,t){const r=t.exports,i=r.memory,a=r.table,o=r.__new,l=r.__retain,c=r.__rtti_base||-1;function u(e){const t=function(e){const t=new Uint32Array(i.buffer);if((e>>>=0)>=t[c>>>2])throw Error(`invalid id: ${e}`);return t[(c+4>>>2)+2*e]}(e);if(!(7&t))throw Error(`not an array: ${e}, flags=${t}`);return t}function h(e){const t=new Uint32Array(i.buffer);if((e>>>=0)>=t[c>>>2])throw Error(`invalid id: ${e}`);return t[(c+4>>>2)+2*e+1]}function d(e){return 31-Math.clz32(e>>>6&31)}function f(e,t,r){const n=i.buffer;if(r)switch(e){case 2:return new Float32Array(n);case 3:return new Float64Array(n)}else switch(e){case 0:return new(t?Int8Array:Uint8Array)(n);case 1:return new(t?Int16Array:Uint16Array)(n);case 2:return new(t?Int32Array:Uint32Array)(n);case 3:return new(t?BigInt64Array:BigUint64Array)(n)}throw Error(`unsupported align: ${e}`)}function p(e){const t=new Uint32Array(i.buffer),r=u(t[e+-8>>>2]),n=d(r);let a=4&r?e:t[e+4>>>2];const s=2&r?t[e+12>>>2]:t[a+-4>>>2]>>>n;return f(n,2048&r,4096&r).subarray(a>>>=n,a+s)}function g(e,t,r){return new e(A(e,t,r))}function A(e,t,r){const n=i.buffer,a=new Uint32Array(n),s=a[r+4>>>2];return new e(n,s,a[s+-4>>>2]>>>t)}function b(t,r,n){e[`__get${r}`]=g.bind(null,t,n),e[`__get${r}View`]=A.bind(null,t,n)}return e.__newString=function(e){if(null==e)return 0;const t=e.length,r=o(t<<1,1),n=new Uint16Array(i.buffer);for(var a=0,s=r>>>1;a<t;++a)n[s+a]=e.charCodeAt(a);return r},e.__getString=function(e){if(!e)return null;const t=i.buffer;if(1!==new Uint32Array(t)[e+-8>>>2])throw Error(`not a string: ${e}`);return s(t,e)},e.__newArray=function(e,t){const r=u(e),n=d(r),a=t.length,s=o(a<<n,4&r?e:0);let c;if(4&r)c=s;else{const t=o(2&r?16:12,e),u=new Uint32Array(i.buffer);u[t+0>>>2]=l(s),u[t+4>>>2]=s,u[t+8>>>2]=a<<n,2&r&&(u[t+12>>>2]=a),c=t}const h=f(n,2048&r,4096&r);if(16384&r)for(let e=0;e<a;++e)h[(s>>>n)+e]=l(t[e]);else h.set(t,s>>>n);return c},e.__getArrayView=p,e.__getArray=function(e){const t=p(e),r=t.length,n=new Array(r);for(let e=0;e<r;e++)n[e]=t[e];return n},e.__getArrayBuffer=function(e){const t=i.buffer,r=new Uint32Array(t)[e+-4>>>2];return t.slice(e,e+r)},[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array].forEach((e=>{b(e,e.name,31-Math.clz32(e.BYTES_PER_ELEMENT))})),n&&[BigUint64Array,BigInt64Array].forEach((e=>{b(e,e.name.slice(3),3)})),e.__instanceof=function(e,t){const r=new Uint32Array(i.buffer);let n=r[e+-8>>>2];if(n<=r[c>>>2])do{if(n==t)return!0;n=h(n)}while(n);return!1},e.memory=e.memory||i,e.table=e.table||a,m(r,e)}function c(e){return"undefined"!=typeof Response&&e instanceof Response}function u(e){return e instanceof WebAssembly.Module}async function h(e,t={}){if(c(e=await e))return f(e,t);const r=u(e)?e:await WebAssembly.compile(e),n=o(t),i=await WebAssembly.instantiate(r,t);return{module:r,instance:i,exports:l(n,i)}}function d(e,t={}){const r=u(e)?e:new WebAssembly.Module(e),n=o(t),i=new WebAssembly.Instance(r,t);return{module:r,instance:i,exports:l(n,i)}}async function f(e,t={}){if(!WebAssembly.instantiateStreaming)return h(c(e=await e)?e.arrayBuffer():e,t);const r=o(t),n=await WebAssembly.instantiateStreaming(e,t),i=l(r,n.instance);return{...n,exports:i}}function m(e,t={}){const r=e.__argumentsLength?t=>{e.__argumentsLength.value=t}:e.__setArgumentsLength||e.__setargc||(()=>{});for(let n in e){if(!Object.prototype.hasOwnProperty.call(e,n))continue;const a=e[n];let s=n.split("."),o=t;for(;s.length>1;){let e=s.shift();Object.prototype.hasOwnProperty.call(o,e)||(o[e]={}),o=o[e]}let l=s[0],c=l.indexOf("#");if(c>=0){const t=l.substring(0,c),s=o[t];if(void 0===s||!s.prototype){const e=function(...t){return e.wrap(e.prototype.constructor(0,...t))};e.prototype={valueOf(){return this[i]}},e.wrap=function(t){return Object.create(e.prototype,{[i]:{value:t,writable:!1}})},s&&Object.getOwnPropertyNames(s).forEach((t=>Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t)))),o[t]=e}if(l=l.substring(c+1),o=o[t].prototype,/^(get|set):/.test(l)){if(!Object.prototype.hasOwnProperty.call(o,l=l.substring(4))){let t=e[n.replace("set:","get:")],r=e[n.replace("get:","set:")];Object.defineProperty(o,l,{get(){return t(this[i])},set(e){r(this[i],e)},enumerable:!0})}}else"constructor"===l?(o[l]=(...e)=>(r(e.length),a(...e))).original=a:(o[l]=function(...e){return r(e.length),a(this[i],...e)}).original=a}else/^(get|set):/.test(l)?Object.prototype.hasOwnProperty.call(o,l=l.substring(4))||Object.defineProperty(o,l,{get:e[n.replace("set:","get:")],set:e[n.replace("get:","set:")],enumerable:!0}):"function"==typeof a&&a!==r?(o[l]=(...e)=>(r(e.length),a(...e))).original=a:o[l]=a}return t}t.default={instantiate:h,instantiateSync:d,instantiateStreaming:f,demangle:m}},"./node_modules/@babel/runtime/helpers/defineProperty.js":function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},"./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js":function(e,t,r){"use strict";{const e=(e,t)=>{var r="function"==typeof t,n="function"==typeof t,i="function"==typeof t;Object.defineProperty(Math,e,{configurable:r,enumerable:i,writable:n,value:t})};e("DEG_PER_RAD",Math.PI/180),e("RAD_PER_DEG",180/Math.PI);const t=new Float32Array(1);e("scale",(function(e,t,r,n,i){return 0===arguments.length||Number.isNaN(e)||Number.isNaN(t)||Number.isNaN(r)||Number.isNaN(n)||Number.isNaN(i)?NaN:e===1/0||e===-1/0?e:(e-t)*(i-n)/(r-t)+n})),e("fscale",(function(e,r,n,i,a){return t[0]=Math.scale(e,r,n,i,a),t[0]})),e("clamp",(function(e,t,r){return Math.min(r,Math.max(t,e))})),e("radians",(function(e){return e*Math.DEG_PER_RAD})),e("degrees",(function(e){return e*Math.RAD_PER_DEG}))}},"./node_modules/eel-wasm/dist/build/parser.js":function(e,t,r){(function(e,n){var i=function(){var e=function(e,t,r,n){for(r=r||{},n=e.length;n--;r[e[n]]=t);return r},t=[1,18],r=[1,7],n=[1,19],i=[1,20],a=[1,14],s=[1,15],o=[1,16],l=[1,33],c=[1,31],u=[1,23],h=[1,22],d=[1,24],f=[1,25],m=[1,26],p=[1,27],g=[1,28],A=[1,29],b=[1,30],v=[5,8,15,18,20,28,29,32,33,34,35,36,37,38],y=[5,15,18],w=[5,12,15,17,18,24,25,28,29,30],E=[1,57],_=[5,8,12,15,17,18,24,25,28,29,30],T=[15,18],x=[5,8,15,18,28,29,38],S=[5,8,15,18,28,29,32,33,38],k=[5,8,15,18,28,29,32,33,34,37,38],I=[5,8,15,18,28,29,32,33,34,35,36,37,38],C=[5,8,15,18],P=[5,8,15,18,20,22,28,29,32,33,34,35,36,37,38],M={trace:function(){},yy:{},symbols_:{error:2,SCRIPT:3,expression:4,EOF:5,expressionsOptionalTrailingSemi:6,separator:7,";":8,expressions:9,EXPRESSION_BLOCK:10,IDENTIFIER:11,IDENTIFIER_TOKEN:12,argument:13,arguments:14,",":15,FUNCTION_CALL:16,"(":17,")":18,LOGICAL_EXPRESSION:19,LOGICAL_OPERATOR_TOKEN:20,ASSIGNMENT:21,ASSIGNMENT_OPERATOR_TOKEN:22,number:23,DIGITS_TOKEN:24,".":25,NUMBER_LITERAL:26,UNARY_EXPRESSION:27,"-":28,"+":29,"!":30,BINARY_EXPRESSION:31,"*":32,"/":33,"%":34,"&":35,"|":36,"^":37,COMPARISON_TOKEN:38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:";",12:"IDENTIFIER_TOKEN",15:",",17:"(",18:")",20:"LOGICAL_OPERATOR_TOKEN",22:"ASSIGNMENT_OPERATOR_TOKEN",24:"DIGITS_TOKEN",25:".",28:"-",29:"+",30:"!",32:"*",33:"/",34:"%",35:"&",36:"|",37:"^",38:"COMPARISON_TOKEN"},productions_:[0,[3,2],[3,2],[3,1],[7,1],[7,2],[9,2],[9,3],[6,1],[6,2],[10,1],[11,1],[13,1],[13,1],[14,1],[14,3],[16,3],[16,4],[19,3],[21,3],[21,3],[23,1],[23,2],[23,3],[23,2],[23,1],[26,1],[27,2],[27,2],[27,2],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[4,1],[4,1],[4,3],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3]],performAction:function(e,t,r,n,i,a,s){var o=a.length-1;switch(i){case 1:return{type:"SCRIPT",body:[a[o-1]],loc:this._$};case 2:return{type:"SCRIPT",body:a[o-1],loc:this._$};case 3:return{type:"SCRIPT",body:[],loc:this._$};case 6:this.$=[a[o-1]];break;case 7:this.$=a[o-2].concat([a[o-1]]);break;case 8:this.$=a[o];break;case 9:this.$=a[o-1].concat([a[o]]);break;case 10:this.$={type:"EXPRESSION_BLOCK",body:a[o],loc:this._$};break;case 11:this.$={type:"IDENTIFIER",value:a[o].toLowerCase(),loc:this._$};break;case 14:this.$=[a[o]];break;case 15:this.$=a[o-2].concat([a[o]]);break;case 16:this.$={type:"CALL_EXPRESSION",callee:a[o-2],arguments:[],loc:this._$};break;case 17:this.$={type:"CALL_EXPRESSION",callee:a[o-3],arguments:a[o-1],loc:this._$};break;case 18:this.$={type:"LOGICAL_EXPRESSION",left:a[o-2],right:a[o],operator:a[o-1],loc:this._$};break;case 19:case 20:this.$={type:"ASSIGNMENT_EXPRESSION",left:a[o-2],operator:a[o-1],right:a[o],loc:this._$};break;case 21:this.$=Number(a[o]);break;case 22:this.$=Number(a[o-1]);break;case 23:this.$=Number(a[o-2]+a[o-1]+a[o]);break;case 24:this.$=Number("0"+a[o-1]+a[o]);break;case 25:this.$=0;break;case 26:this.$={type:"NUMBER_LITERAL",value:a[o],loc:this._$};break;case 27:case 28:case 29:this.$={type:"UNARY_EXPRESSION",value:a[o],operator:a[o-1],loc:this._$};break;case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:this.$={type:"BINARY_EXPRESSION",left:a[o-2],right:a[o],operator:a[o-1],loc:this._$};break;case 41:case 47:this.$=a[o-1]}},table:[{3:1,4:2,5:[1,4],6:3,9:13,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{1:[3]},{5:[1,21],7:32,8:l,20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b},{5:[1,34]},{1:[2,3]},e(v,[2,39]),e(v,[2,40]),{4:35,6:37,9:13,10:36,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},e(v,[2,42]),e(v,[2,43]),e(v,[2,44],{22:[1,38]}),e(v,[2,45],{17:[1,40],22:[1,39]}),e(v,[2,46]),e(y,[2,8],{31:5,27:6,26:8,21:9,16:10,11:11,19:12,23:17,4:41,12:t,17:r,24:n,25:i,28:a,29:s,30:o}),{4:42,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:43,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:44,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},e(v,[2,26]),e([5,8,15,17,18,20,22,28,29,32,33,34,35,36,37,38],[2,11]),e(v,[2,21],{25:[1,45]}),e(v,[2,25],{24:[1,46]}),{1:[2,1]},{4:47,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:48,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:49,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:50,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:51,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:52,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:53,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:54,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:55,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:56,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},e(w,[2,6],{8:E}),e(_,[2,4]),{1:[2,2]},{7:32,8:l,18:[1,58],20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b},{18:[1,59]},e(T,[2,10]),{4:60,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:61,11:11,12:t,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},{4:65,6:37,9:13,10:66,11:11,12:t,13:64,14:63,16:10,17:r,18:[1,62],19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},e(y,[2,9],{7:67,8:l,20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b}),e(x,[2,27],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(x,[2,28],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(x,[2,29],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(v,[2,22],{24:[1,68]}),e(v,[2,24]),e(x,[2,30],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(x,[2,31],{20:c,32:d,33:f,34:m,35:p,36:g,37:A}),e(S,[2,32],{20:c,34:m,35:p,36:g,37:A}),e(S,[2,33],{20:c,34:m,35:p,36:g,37:A}),e(k,[2,34],{20:c,35:p,36:g}),e(I,[2,35],{20:c}),e(I,[2,36],{20:c}),e(k,[2,37],{20:c,35:p,36:g}),e(C,[2,38],{20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b}),e(v,[2,18]),e(_,[2,5]),e(v,[2,41]),e(v,[2,47]),e(C,[2,20],{20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b}),e(C,[2,19],{20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b}),e(P,[2,16]),{15:[1,70],18:[1,69]},e(T,[2,14]),e(T,[2,12],{7:32,8:l,20:c,28:u,29:h,32:d,33:f,34:m,35:p,36:g,37:A,38:b}),e(T,[2,13]),e(w,[2,7],{8:E}),e(v,[2,23]),e(P,[2,17]),{4:65,6:37,9:13,10:66,11:11,12:t,13:71,16:10,17:r,19:12,21:9,23:17,24:n,25:i,26:8,27:6,28:a,29:s,30:o,31:5},e(T,[2,15])],defaultActions:{4:[2,3],21:[2,1],34:[2,2]},parseError:function(e,t){if(!t.recoverable){var r=new Error(e);throw r.hash=t,r}this.trace(e)},parse:function(e){var t=this,r=[0],n=[null],i=[],a=this.table,s="",o=0,l=0,c=0,u=2,h=1,d=i.slice.call(arguments,1),f=Object.create(this.lexer),m={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(m.yy[p]=this.yy[p]);f.setInput(e,m.yy),m.yy.lexer=f,m.yy.parser=this,void 0===f.yylloc&&(f.yylloc={});var g=f.yylloc;i.push(g);var A=f.options&&f.options.ranges;"function"==typeof m.yy.parseError?this.parseError=m.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var b,v,y,w,E,_,T,x,S,k=function(){var e;return"number"!=typeof(e=f.lex()||h)&&(e=t.symbols_[e]||e),e},I={};;){if(y=r[r.length-1],this.defaultActions[y]?w=this.defaultActions[y]:(null==b&&(b=k()),w=a[y]&&a[y][b]),void 0===w||!w.length||!w[0]){var C="";for(_ in S=[],a[y])this.terminals_[_]&&_>u&&S.push("'"+this.terminals_[_]+"'");C=f.showPosition?"Parse error on line "+(o+1)+":\n"+f.showPosition()+"\nExpecting "+S.join(", ")+", got '"+(this.terminals_[b]||b)+"'":"Parse error on line "+(o+1)+": Unexpected "+(b==h?"end of input":"'"+(this.terminals_[b]||b)+"'"),this.parseError(C,{text:f.match,token:this.terminals_[b]||b,line:f.yylineno,loc:g,expected:S})}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+b);switch(w[0]){case 1:r.push(b),n.push(f.yytext),i.push(f.yylloc),r.push(w[1]),b=null,v?(b=v,v=null):(l=f.yyleng,s=f.yytext,o=f.yylineno,g=f.yylloc,c>0&&c--);break;case 2:if(T=this.productions_[w[1]][1],I.$=n[n.length-T],I._$={first_line:i[i.length-(T||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(T||1)].first_column,last_column:i[i.length-1].last_column},A&&(I._$.range=[i[i.length-(T||1)].range[0],i[i.length-1].range[1]]),void 0!==(E=this.performAction.apply(I,[s,l,o,m.yy,w[1],n,i].concat(d))))return E;T&&(r=r.slice(0,-1*T*2),n=n.slice(0,-1*T),i=i.slice(0,-1*T)),r.push(this.productions_[w[1]][0]),n.push(I.$),i.push(I._$),x=a[r[r.length-2]][r[r.length-1]],r.push(x);break;case 3:return!0}}return!0}},R={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var r,n,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(n=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],r=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var a in i)this[a]=i[a];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),a=0;a<i.length;a++)if((r=this._input.match(this.rules[i[a]]))&&(!t||r[0].length>t[0].length)){if(t=r,n=a,this.options.backtrack_lexer){if(!1!==(e=this.test_match(r,i[a])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[n]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){return this.next()||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,r,n){switch(r){case 0:break;case 1:return 24;case 2:return 38;case 3:return 22;case 4:return 20;case 5:return 12;case 6:return 5;case 7:return t.yytext[0]}},rules:[/^(?:\s+)/,/^(?:[0-9]+)/,/^(?:(==|!=|<=|>=|<|>))/,/^(?:[+\-*/%]?=)/,/^(?:(\&\&)|\|\|)/,/^(?:[a-zA-Z_][a-zA-Z0-9._]*)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7],inclusive:!0}}};function B(){this.yy={}}return M.lexer=R,B.prototype=M,M.Parser=B,new B}();t.parser=i,t.Parser=i.Parser,t.parse=function(){return i.parse.apply(i,arguments)},t.main=()=>{},r.c[r.s]===e&&t.main(n.argv.slice(1))}).call(this,r("./node_modules/webpack/buildin/module.js")(e),r("./node_modules/process/browser.js"))},"./node_modules/eel-wasm/dist/src/astUtils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={ASSIGNMENT_EXPRESSION:[{type:"NODE",key:"right"}],SCRIPT:[{type:"ARRAY",key:"body"}],EXPRESSION_BLOCK:[{type:"ARRAY",key:"body"}],UNARY_EXPRESSION:[{type:"NODE",key:"value"}],NUMBER_LITERAL:[],IDENTIFIER:[],CALL_EXPRESSION:[{type:"ARRAY",key:"arguments"},{type:"NODE",key:"callee"}],BINARY_EXPRESSION:[{type:"NODE",key:"left"},{type:"NODE",key:"right"}],LOGICAL_EXPRESSION:[{type:"NODE",key:"left"},{type:"NODE",key:"right"}]};t.mapAst=function e(t,r){const i=n[t.type];let a=t;if(null==i)throw new Error(`Unknown children definition for ${t.type}`);return i.forEach((n=>{if("NODE"===n.type){const i=t[n.key],s=e(i,r);s!==i&&(a=Object.assign(Object.assign({},a),{[n.key]:s}))}else if("ARRAY"===n.type){const i=t[n.key],s=i.map((t=>e(t,r))),o=i.some(((e,t)=>e!==s[t]));o&&(a=Object.assign(Object.assign({},a),{[n.key]:s}))}})),r(a)}},"./node_modules/eel-wasm/dist/src/compiler.js":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const a=r("./node_modules/eel-wasm/dist/src/parser.js"),s=r("./node_modules/eel-wasm/dist/src/emitter.js"),o=r("./node_modules/eel-wasm/dist/src/encoding.js"),l=n(r("./node_modules/eel-wasm/dist/src/shims.js")),c=i(r("./node_modules/eel-wasm/dist/src/utils.js")),u=r("./node_modules/eel-wasm/dist/src/wasmFunctions.js"),h=r("./node_modules/eel-wasm/dist/src/constants.js");t.compileModule=function({pools:e,functions:t,eelVersion:r=2,preParsed:n=!1}){if(Object.keys(e).includes("shims"))throw new Error('You may not name a pool "shims". "shims" is reserved for injected JavaScript functions.');const i=[];Object.entries(e).forEach((([e,t])=>{t.forEach((t=>{i.push([e,t])}))}));const d=new c.ScopedIdMap;i.forEach((([e,t])=>{d.get(e,t)}));const f=Object.entries(l.default).map((([e,t])=>({args:new Array(t.length).fill(null).map((e=>o.VAL_TYPE.f64)),returns:[o.VAL_TYPE.f64],name:e}))),m=[],p=[];Object.entries(t).forEach((([t,{pool:i,code:l}])=>{if(null==e[i]){const r=Object.keys(e);if(0===r.length)throw new Error(`The function "${t}" was declared as using a variable pool named "${i}" but no pools were defined.`);throw new Error(`The function "${t}" was declared as using a variable pool named "${i}" which is not among the variable pools defined. The defined variable pools are: ${c.formatList(r)}.`)}const h=n?l:a.parse(l);if("string"==typeof h)throw new Error("Got passed unparsed code without setting the preParsed flag");if("SCRIPT"!==h.type)throw new Error("Invalid AST");if(0===h.body.length)return;const g=[],A={resolveVar:e=>/^reg\d\d$/.test(e)?d.get(null,e):d.get(i,e),resolveLocal:e=>(g.push(e),g.length-1),resolveFunc:e=>{const t=f.findIndex((t=>t.name===e));if(-1!==t){const n=o.op.call(t);return"rand"===e&&1===r?[...n,o.op.f64_floor]:n}if(null==u.localFuncMap[e])return null;let n=m.indexOf(e);return-1===n&&(m.push(e),n=m.length-1),o.op.call(n+f.length)},rawSource:l},b=s.emit(h,A);p.push({binary:b,exportName:t,args:[],returns:[],localVariables:g})}));const g=m.map((e=>{const t=u.localFuncMap[e];if(null==t)throw new Error(`Undefined local function "${e}"`);return t})),A=e=>[...e.args,"|",...e.returns].join("-"),b=[],v=new Map;function y(e){const t=A(e),r=v.get(t);if(null==r)throw new Error(`Failed to get a type index for key ${t}`);return r}[...f,...g,...p].forEach((e=>{const t=A(e);v.has(t)||(b.push([o.FUNCTION_TYPE,...o.encodeFlatVector(e.args),...o.encodeFlatVector(e.returns)]),v.set(t,b.length-1))}));const w=[...i.map((([e,t])=>[...o.encodeString(e),...o.encodeString(t),o.GLOBAL_TYPE,o.VAL_TYPE.f64,o.MUTABILITY.var])),...f.map(((e,t)=>{const r=y(e);return[...o.encodeString("shims"),...o.encodeString(e.name),o.TYPE_IDX,...o.unsignedLEB128(r)]}))],E=[...g,...p].map((e=>{const t=y(e);return o.unsignedLEB128(t)})),_=[[1,...o.unsignedLEB128(h.WASM_MEMORY_SIZE),...o.unsignedLEB128(h.WASM_MEMORY_SIZE)]],T=d.size()-i.length,x=c.times(T,(()=>[o.VAL_TYPE.f64,o.MUTABILITY.var,...o.op.f64_const(0),o.op.end])),S=[...p].map(((e,t)=>{const r=t+f.length+g.length;return[...o.encodeString(e.exportName),o.EXPORT_TYPE.FUNC,...o.unsignedLEB128(r)]})),k=[...g,...p].map((e=>{var t;const r=(null!==(t=e.localVariables)&&void 0!==t?t:[]).map((e=>[...o.unsignedLEB128(1),e]));return o.encodeFlatVector([...o.encodeNestedVector(r),...e.binary,o.op.end])}));return new Uint8Array([...o.MAGIC,...o.WASM_VERSION,...o.encodeSection(o.SECTION.TYPE,b),...o.encodeSection(o.SECTION.IMPORT,w),...o.encodeSection(o.SECTION.FUNC,E),...o.encodeSection(o.SECTION.MEMORY,_),...o.encodeSection(o.SECTION.GLOBAL,x),...o.encodeSection(o.SECTION.EXPORT,S),...o.encodeSection(o.SECTION.CODE,k)])}},"./node_modules/eel-wasm/dist/src/constants.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_LOOP_COUNT=1048576,t.BUFFER_SIZE=8388608,t.WASM_MEMORY_SIZE=Math.ceil(8*t.BUFFER_SIZE*2/65536)},"./node_modules/eel-wasm/dist/src/emitter.js":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r("./node_modules/eel-wasm/dist/src/encoding.js"),a=n(r("./node_modules/eel-wasm/dist/src/shims.js")),s=r("./node_modules/eel-wasm/dist/src/errorUtils.js"),o=r("./node_modules/eel-wasm/dist/src/wasmFunctions.js"),l=r("./node_modules/eel-wasm/dist/src/utils.js"),c=r("./node_modules/eel-wasm/dist/src/constants.js");function u(e,t){var r,n,f;switch(e.type){case"SCRIPT":{const r=e.body.map(((e,r)=>[...u(e,t),i.op.drop]));return l.flatten(r)}case"EXPRESSION_BLOCK":return h(e.body,t);case"BINARY_EXPRESSION":{const r=u(e.left,t),n=u(e.right,t),a={"+":[i.op.f64_add],"-":[i.op.f64_sub],"*":[i.op.f64_mul],"/":t.resolveFunc("div"),"%":t.resolveFunc("mod"),"|":t.resolveFunc("bitwiseOr"),"&":t.resolveFunc("bitwiseAnd"),"^":t.resolveFunc("pow"),"==":[i.op.f64_sub,...i.IS_ZEROISH,i.op.f64_convert_i32_s],"!=":[i.op.f64_sub,...i.IS_NOT_ZEROISH,i.op.f64_convert_i32_s],"<":[i.op.f64_lt,i.op.f64_convert_i32_s],">":[i.op.f64_gt,i.op.f64_convert_i32_s],"<=":[i.op.f64_le,i.op.f64_convert_i32_s],">=":[i.op.f64_ge,i.op.f64_convert_i32_s]}[e.operator];if(null==a)throw s.createCompilerError(`Unknown binary expression operator ${e.operator}`,e.loc,t.rawSource);return[...r,...n,...a]}case"CALL_EXPRESSION":{const n=e.callee.value,f=e.arguments,m=r=>{if(f.length<r)throw s.createUserError(`Too few arguments passed to \`${n}()\`. Expected ${r} but only got ${f.length}.`,e.loc,t.rawSource);if(f.length>r)throw s.createUserError(`Too many arguments passed to \`${n}()\`. Expected ${r} but got ${f.length}.`,f[r].loc,t.rawSource)};switch(n){case"exec2":return m(2),h(e.arguments,t);case"exec3":return m(3),h(e.arguments,t);case"if":m(3);const[a,o,l]=e.arguments;return function(e,t,r,n){return[...u(e,n),...i.IS_NOT_ZEROISH,...i.op.if(i.BLOCK.f64),...u(t,n),i.op.else,...u(r,n),i.op.end]}(a,o,l,t);case"while":return m(1),function(e,t){const r=u(e,t),n=t.resolveLocal(i.VAL_TYPE.i32);return[...i.op.i32_const(0),...i.op.local_set(n),...i.op.loop(i.BLOCK.void),...i.op.local_get(n),...i.op.i32_const(1),i.op.i32_add,...i.op.local_tee(n),...i.op.i32_const(c.MAX_LOOP_COUNT),i.op.i32_lt_u,...r,...i.IS_NOT_ZEROISH,i.op.i32_and,...i.op.br_if(0),i.op.end,...i.op.f64_const(0)]}(e.arguments[0],t);case"loop":return m(2),function(e,t,r){const n=u(t,r),a=r.resolveLocal(i.VAL_TYPE.i32);return[...i.op.block(i.BLOCK.void),...u(e,r),i.op.i32_trunc_f64_s,...i.op.local_tee(a),...i.op.i32_const(0),i.op.i32_le_s,...i.op.br_if(1),...i.op.loop(i.BLOCK.void),...n,i.op.drop,...i.op.local_get(a),...i.op.i32_const(1),i.op.i32_sub,...i.op.local_tee(a),...i.op.i32_const(0),i.op.i32_ne,...i.op.br_if(0),i.op.end,i.op.end,...i.op.f64_const(0)]}(e.arguments[0],e.arguments[1],t);case"megabuf":case"gmegabuf":m(1);const f=t.resolveLocal(i.VAL_TYPE.i32);return[...u(e.arguments[0],t),...null!==(r=t.resolveFunc("_getBufferIndex"))&&void 0!==r?r:[],...i.op.local_tee(f),...i.op.i32_const(-1),i.op.i32_ne,...i.op.if(i.BLOCK.f64),...i.op.local_get(f),...i.op.f64_load(3,d(n)),i.op.else,...i.op.f64_const(0),i.op.end];case"assign":m(2);const p=e.arguments[0];if("IDENTIFIER"!=p.type)throw s.createUserError("Expected the first argument of `assign()` to be an identifier.",p.loc,t.rawSource);const g=t.resolveVar(p.value);return[...u(e.arguments[1],t),...i.op.global_set(g),...i.op.global_get(g)]}const p=l.flatten(e.arguments.map((e=>u(e,t))));switch(n){case"abs":return m(1),[...p,i.op.f64_abs];case"sqrt":return m(1),[...p,i.op.f64_abs,i.op.f64_sqrt];case"int":case"floor":return m(1),[...p,i.op.f64_floor];case"min":return m(2),[...p,i.op.f64_min];case"max":return m(2),[...p,i.op.f64_max];case"above":return m(2),[...p,i.op.f64_gt,i.op.f64_convert_i32_s];case"below":return m(2),[...p,i.op.f64_lt,i.op.f64_convert_i32_s];case"equal":return m(2),[...p,i.op.f64_sub,...i.IS_ZEROISH,i.op.f64_convert_i32_s];case"bnot":return m(1),[...p,...i.IS_ZEROISH,i.op.f64_convert_i32_s];case"ceil":return m(1),[...p,i.op.f64_ceil]}const g=t.resolveFunc(n);if(null==g||n.startsWith("_"))throw s.createUserError(`"${n}" is not defined.`,e.callee.loc,t.rawSource);if(null!=a.default[n])m(a.default[n].length);else{if(null==o.localFuncMap[n])throw s.createCompilerError(`Missing arity information for the function \`${n}()\``,e.callee.loc,t.rawSource);m(o.localFuncMap[n].args.length)}return[...p,...g]}case"ASSIGNMENT_EXPRESSION":{const{left:r}=e,a=u(e.right,t),o=function(e,t){const r={"+=":[i.op.f64_add],"-=":[i.op.f64_sub],"*=":[i.op.f64_mul],"/=":[i.op.f64_div],"%=":t.resolveFunc("mod"),"=":null}[e.operator];if(void 0===r)throw s.createCompilerError(`Unknown assignment operator "${e.operator}"`,e.loc,t.rawSource);return r}(e,t);if("IDENTIFIER"===r.type){const e=t.resolveVar(r.value),n=i.op.global_get(e),s=i.op.global_set(e);return null===o?[...a,...s,...n]:[...n,...a,...o,...s,...n]}if("CALL_EXPRESSION"!==r.type)throw s.createCompilerError(`Unexpected left hand side type for assignment: ${r.type}`,e.loc,t.rawSource);const l=t.resolveLocal(i.VAL_TYPE.i32);if(1!==r.arguments.length)throw s.createUserError(`Expected 1 argument when assinging to a buffer but got ${r.arguments.length}.`,0===r.arguments.length?r.loc:r.arguments[1].loc,t.rawSource);const c=r.callee.value;if("gmegabuf"!==c&&"megabuf"!==c)throw s.createUserError("The only function calls which may be assigned to are `gmegabuf()` and `megabuf()`.",r.callee.loc,t.rawSource);const h=d(c);if(null===o){const e=t.resolveLocal(i.VAL_TYPE.i32),s=t.resolveLocal(i.VAL_TYPE.f64);return[...a,...i.op.local_set(s),...u(r.arguments[0],t),...null!==(n=t.resolveFunc("_getBufferIndex"))&&void 0!==n?n:[],...i.op.local_tee(e),...i.op.i32_const(0),i.op.i32_lt_s,...i.op.if(i.BLOCK.f64),...i.op.f64_const(0),i.op.else,...i.op.local_get(e),...i.op.local_tee(l),...i.op.local_get(s),...i.op.f64_store(3,h),...i.op.local_get(s),i.op.end]}const m=t.resolveLocal(i.VAL_TYPE.i32),p=t.resolveLocal(i.VAL_TYPE.i32),g=t.resolveLocal(i.VAL_TYPE.f64),A=t.resolveLocal(i.VAL_TYPE.f64);return[...a,...i.op.local_set(g),...u(r.arguments[0],t),...null!==(f=t.resolveFunc("_getBufferIndex"))&&void 0!==f?f:[],...i.op.local_tee(m),...i.op.i32_const(-1),i.op.i32_ne,...i.op.local_tee(p),...i.op.if(i.BLOCK.f64),...i.op.local_get(m),...i.op.f64_load(3,h),i.op.else,...i.op.f64_const(0),i.op.end,...i.op.local_get(g),...o,...i.op.local_tee(A),...i.op.local_get(p),...i.op.if(i.BLOCK.void),...i.op.local_get(m),...i.op.local_get(A),...i.op.f64_store(3,h),i.op.end]}case"LOGICAL_EXPRESSION":{const r=u(e.left,t),n=u(e.right,t),a={"&&":{comparison:i.IS_ZEROISH,shortCircutValue:0},"||":{comparison:i.IS_NOT_ZEROISH,shortCircutValue:1}}[e.operator];if(null==a)throw s.createCompilerError(`Unknown logical expression operator ${e.operator}`,e.loc,t.rawSource);const{comparison:o,shortCircutValue:l}=a;return[...r,...o,...i.op.if(i.BLOCK.f64),...i.op.f64_const(l),i.op.else,...n,...i.IS_NOT_ZEROISH,i.op.f64_convert_i32_s,i.op.end]}case"UNARY_EXPRESSION":{const r=u(e.value,t),n={"-":[i.op.f64_neg],"+":[],"!":[...i.IS_ZEROISH,i.op.f64_convert_i32_s]}[e.operator];if(null==n)throw s.createCompilerError(`Unknown logical unary operator ${e.operator}`,e.loc,t.rawSource);return[...r,...n]}case"IDENTIFIER":const m=e.value;return i.op.global_get(t.resolveVar(m));case"NUMBER_LITERAL":return i.op.f64_const(e.value);default:throw s.createCompilerError(`Unknown AST node type ${e.type}`,e.loc,t.rawSource)}}function h(e,t){const r=e.map(((e,r)=>u(e,t)));return l.flatten(l.arrayJoin(r,[i.op.drop]))}function d(e){switch(e){case"gmegabuf":return 8*c.BUFFER_SIZE;case"megabuf":return 0}}t.emit=u},"./node_modules/eel-wasm/dist/src/encoding.js":function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r("./node_modules/eel-wasm/dist/src/ieee754.js")),a=r("./node_modules/eel-wasm/dist/src/utils.js");function s(e){const t=new Uint8Array(8);return i.write(t,e),t}function o(e){const t=[];do{let r=127&e;0!=(e>>>=7)&&(r|=128),t.push(r)}while(0!==e);return t}function l(e){let t=[],r=0,n=Math.ceil(Math.log2(Math.abs(e))),i=e<0,a=!0;for(;a;)r=127&e,e>>=7,i&&(e|=-(1<<n-7)),0==e&&0==(64&r)||-1==e&&64==(64&r)?a=!1:r|=128,t.push(r);return t}t.MAGIC=[0,97,115,109],t.WASM_VERSION=[1,0,0,0],t.EPSILON=1e-5,t.SECTION={TYPE:1,IMPORT:2,FUNC:3,MEMORY:5,GLOBAL:6,EXPORT:7,CODE:10},t.EXPORT_TYPE={FUNC:0,TABLE:1,MEMORY:2,GLOBAL:3},t.op={block:e=>[2,e],loop:e=>[3,e],if:e=>[4,e],else:5,end:11,br_if:e=>[13,...o(e)],call:e=>[16,...o(e)],drop:26,select:27,local_get:e=>[32,...o(e)],local_set:e=>[33,...o(e)],local_tee:e=>[34,...o(e)],global_get:e=>[35,...o(e)],global_set:e=>[36,...o(e)],f64_load:(e,t)=>[43,...o(e),...o(t)],f64_store:(e,t)=>[57,...o(e),...o(t)],i32_const:e=>[65,...l(e)],f64_const:e=>[68,...s(e)],i32_eqz:69,i32_ne:71,i32_lt_s:72,i32_lt_u:73,i32_gt_s:74,i32_le_s:76,i32_le_u:77,i32_ge_s:78,f64_eq:97,f64_ne:98,f64_lt:99,f64_gt:100,f64_le:101,f64_ge:102,i32_add:106,i32_sub:107,i32_mul:108,i32_rem_s:111,i32_and:113,i32_or:114,i64_rem_s:129,i64_and:131,i64_or:132,f64_abs:153,f64_neg:154,f64_ceil:155,f64_floor:156,f64_sqrt:159,f64_add:160,f64_sub:161,f64_mul:162,f64_div:163,f64_min:164,f64_max:165,i32_trunc_f64_s:170,i32_trunc_f64_u:171,i64_trunc_s_f64:176,f64_convert_i64_s:185,f64_convert_i32_s:183},t.VAL_TYPE={i32:127,i64:126,f32:125,f64:124},t.MUTABILITY={const:0,var:1},t.BLOCK={void:64,i32:127,i64:126,f32:125,f64:124},t.FUNCTION_TYPE=96,t.MEMORY_IDX=2,t.GLOBAL_TYPE=3,t.TYPE_IDX=0,t.IS_ZEROISH=[t.op.f64_abs,...t.op.f64_const(t.EPSILON),t.op.f64_lt],t.IS_NOT_ZEROISH=[t.op.f64_abs,...t.op.f64_const(t.EPSILON),t.op.f64_gt],t.encodef64=s,t.encodeString=e=>[e.length].concat(e.split("").map((e=>e.charCodeAt(0)))),t.unsignedLEB128=o,t.signedLEB128=l,t.encodeFlatVector=e=>o(e.length).concat(e),t.encodeNestedVector=e=>o(e.length).concat(a.flatten(e)),t.encodeSection=function(e,r){if(0===r.length)return[];const n=t.encodeFlatVector(t.encodeNestedVector(r));return n.unshift(e),n}},"./node_modules/eel-wasm/dist/src/envParser.js":function(e,t,r){let n=r("./node_modules/eel-wasm/dist/build/parser.js");e.exports={parse:n.parse}},"./node_modules/eel-wasm/dist/src/errorUtils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("./node_modules/eel-wasm/dist/src/utils.js");function i(e,t,r=1){const i=Math.max(e.first_line-1-r,0),a=e.last_line+r,s=t.split("\n").slice(i,a).map(((t,r)=>{const n=r+i+1;return`${n>=e.first_line&&n<=e.last_line?">":" "} ${n} | ${t}`}));if(e.first_line===e.last_line){const t=n.repeat(e.first_column," "),r=n.repeat(e.last_column-e.first_column,"^"),a=e.first_line-i;s.splice(a,0,`    | ${t}${r}`)}return s.join("\n")}t.printLoc=i;class a extends Error{constructor(e,t,r){super(e),this.sourceContext=i(t,r),this.loc=t}}class s extends a{}t.createUserError=function(e,t,r){return new s(e,t,r)},t.createCompilerError=function(e,t,r){return new a(e,t,r)}},"./node_modules/eel-wasm/dist/src/ieee754.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.write=function(e,t){let r=52;var n,i,a,s=64-r-1,o=(1<<s)-1,l=o>>1,c=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,u=0,h=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(i=isNaN(t)?1:0,n=o):(n=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-n))<1&&(n--,a*=2),(t+=n+l>=1?c/a:c*Math.pow(2,1-l))*a>=2&&(n++,a/=2),n+l>=o?(i=0,n=o):n+l>=1?(i=(t*a-1)*Math.pow(2,r),n+=l):(i=t*Math.pow(2,l-1)*Math.pow(2,r),n=0));r>=8;e[0+u]=255&i,u+=1,i/=256,r-=8);for(n=n<<r|i,s+=r;s>0;e[0+u]=255&n,u+=1,n/=256,s-=8);e[0+u-1]|=128*h}},"./node_modules/eel-wasm/dist/src/index.js":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r("./node_modules/eel-wasm/dist/src/parser.js");t.parse=i.parse;const a=r("./node_modules/eel-wasm/dist/src/compiler.js");t.compileModule=a.compileModule;const s=n(r("./node_modules/eel-wasm/dist/src/shims.js"));t.shims=s.default;const o=r("./node_modules/eel-wasm/dist/src/loader.js");t.loadModule=o.loadModule},"./node_modules/eel-wasm/dist/src/loader.js":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r("./node_modules/eel-wasm/dist/src/shims.js")),a=r("./node_modules/eel-wasm/dist/src/compiler.js");t.loadModule=async function({pools:e,functions:t,eelVersion:r=2}){let n={};Object.entries(e).forEach((([e,t])=>{n[e]=new Set(Object.keys(t))}));const s=a.compileModule({pools:n,functions:t,eelVersion:r}),o=await WebAssembly.compile(s);var l=Object.assign(Object.assign({},e),{shims:i.default});return await WebAssembly.instantiate(o,l)}},"./node_modules/eel-wasm/dist/src/parser.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("./node_modules/eel-wasm/dist/src/preProcessor.js"),i=r("./node_modules/eel-wasm/dist/src/envParser.js"),a=r("./node_modules/eel-wasm/dist/src/astUtils.js"),s=r("./node_modules/eel-wasm/dist/src/errorUtils.js");function o(e,t){const r=n.getLoc(t,e.first_column),i=n.getLoc(t,e.last_column);return{first_column:r.column,last_column:i.column,first_line:r.line,last_line:i.line}}t.parse=function(e){const[t,r]=n.preProcess(e);try{const n=i.parse(t);return a.mapAst(n,(t=>{if(1!==t.loc.first_line||1!=t.loc.last_line)throw s.createCompilerError("Unexpected multiline",t.loc,e);return Object.assign(Object.assign({},t),{loc:o(t.loc,r)})}))}catch(t){if(null==t.hash)throw t;throw s.createUserError(`Parse Error: ${t.message.split("\n")[3]}`,o(t.hash.loc,r),e)}}},"./node_modules/eel-wasm/dist/src/preProcessor.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLoc=function(e,t){let r={destCol:1,srcCol:1,srcLine:1};e.forEach((e=>{e.destCol>t||(r=e)}));const n=t-r.destCol;return{column:r.srcCol+n,line:r.srcLine}},t.preProcess=function(e){const t=[];let r=1,n="",i=0,a=!1,s=!1,o=!1;for(let l=0;l<e.length;l++){const c=e[l];if(o){const e=n.length+1,a=l-i+1;t.push({destCol:e,srcCol:a,srcLine:r}),o=!1}"\n"===c?(a=!1,r++,i=l+1,o=!0):"\r"===c&&"\n"===e[l+1]?(l++,a=!1,r++,i=l+1,o=!0):s&&"*"===c&&"/"===e[l+1]?(s=!1,l++,o=!0):"\\"===c&&"\\"===e[l+1]||"/"===c&&"/"===e[l+1]?(a=!0,l++):"/"===c&&"*"===e[l+1]?(s=!0,l++):a||s||(n+=c)}return[n,t]}},"./node_modules/eel-wasm/dist/src/shims.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,atan2:Math.atan2,rand:e=>Math.random()*e,pow:Math.pow,log:Math.log,log10:Math.log10,exp:Math.exp,sigmoid:function(e,t){const r=1+Math.exp(-e*t);return Math.abs(r)>1e-5?1/r:0}};t.default=n},"./node_modules/eel-wasm/dist/src/utils.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayJoin=function(e,t){const r=[];for(let n=0;n<e.length;n++)r.push(e[n]),n===e.length-1||r.push(t);return r},t.flatten=function(e){return[].concat.apply([],e)},t.times=function(e,t){return new Array(e).fill(null).map(((e,r)=>t(r)))},t.repeat=function(e,t){return new Array(e).fill(t).join("")},t.ScopedIdMap=class{constructor(){this._map=new Map}get(e,t){const r=null==e?t:`${e}::${t}`;return this._map.has(r)||this._map.set(r,this._map.size),this._map.get(r)}size(){return this._map.size}},t.formatList=function(e){if(0===e.length)throw new Error("Cannot format an empty list");if(1===e.length)return e[0];const t=e.map((e=>`"${e}"`)),r=t.pop();return t.join(", ")+` and ${r}`}},"./node_modules/eel-wasm/dist/src/wasmFunctions.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r("./node_modules/eel-wasm/dist/src/encoding.js"),i=r("./node_modules/eel-wasm/dist/src/constants.js");t.localFuncMap={sqr:{args:[n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.local_get(0),...n.op.local_get(0),n.op.f64_mul]},bor:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.local_get(0),...n.IS_NOT_ZEROISH,...n.op.local_get(1),...n.IS_NOT_ZEROISH,n.op.i32_or,...n.op.i32_const(0),n.op.i32_ne,n.op.f64_convert_i32_s]},band:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.local_get(0),...n.IS_NOT_ZEROISH,...n.op.local_get(1),...n.IS_NOT_ZEROISH,n.op.i32_and,...n.op.i32_const(0),n.op.i32_ne,n.op.f64_convert_i32_s]},sign:{args:[n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.f64_const(0),...n.op.local_get(0),n.op.f64_lt,...n.op.local_get(0),...n.op.f64_const(0),n.op.f64_lt,n.op.i32_sub,n.op.f64_convert_i32_s]},mod:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],localVariables:[n.VAL_TYPE.i32],binary:[...n.op.local_get(1),n.op.i32_trunc_f64_s,...n.op.local_tee(2),...n.op.i32_const(0),n.op.i32_ne,...n.op.if(n.BLOCK.f64),...n.op.local_get(0),n.op.i32_trunc_f64_s,...n.op.local_get(2),n.op.i32_rem_s,n.op.f64_convert_i32_s,n.op.else,...n.op.f64_const(0),n.op.end]},bitwiseOr:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.local_get(0),n.op.i64_trunc_s_f64,...n.op.local_get(1),n.op.i64_trunc_s_f64,n.op.i64_or,n.op.f64_convert_i64_s]},bitwiseAnd:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],binary:[...n.op.local_get(0),n.op.i64_trunc_s_f64,...n.op.local_get(1),n.op.i64_trunc_s_f64,n.op.i64_and,n.op.f64_convert_i64_s]},div:{args:[n.VAL_TYPE.f64,n.VAL_TYPE.f64],returns:[n.VAL_TYPE.f64],localVariables:[n.VAL_TYPE.i32],binary:[...n.op.local_get(1),...n.op.f64_const(0),n.op.f64_ne,...n.op.if(n.BLOCK.f64),...n.op.local_get(0),...n.op.local_get(1),n.op.f64_div,n.op.else,...n.op.f64_const(0),n.op.end]},_getBufferIndex:{args:[n.VAL_TYPE.f64],returns:[n.VAL_TYPE.i32],localVariables:[n.VAL_TYPE.f64,n.VAL_TYPE.i32],binary:[...n.op.f64_const(n.EPSILON),...n.op.local_get(0),n.op.f64_add,...n.op.local_tee(1),n.op.i32_trunc_f64_s,...n.op.local_set(2),...n.op.i32_const(-1),...n.op.local_get(2),...n.op.i32_const(8),n.op.i32_mul,...n.op.local_get(2),...n.op.i32_const(0),n.op.i32_lt_s,...n.op.local_get(2),...n.op.i32_const(i.BUFFER_SIZE-1),n.op.i32_gt_s,n.op.i32_or,n.op.select]}}},"./node_modules/process/browser.js":function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&f())}function f(){if(!u){var e=o(d);u=!0;for(var t=c.length;t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new m(e,t)),1!==c.length||u||o(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/webpack/buildin/module.js":function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},"./src/assemblyscript/presetFunctions.ts":function(e,t){e.exports=()=>"AGFzbQEAAAABPQpgAABgAXwBfGACfHwBfGACf38AYAR/f39/AGAJf39/f3x8fHx8AGADf399AGABfwF/YAJ/fwF/YAF+AX8CuBWMAQNlbnYFYWJvcnQABAhwaXhlbEVxcwtwZXJQaXhlbEVxcwAADHBpeGVsVmFyUG9vbAR3YXJwA3wBDHBpeGVsVmFyUG9vbAR6b29tA3wBDHBpeGVsVmFyUG9vbAd6b29tZXhwA3wBDHBpeGVsVmFyUG9vbAJjeAN8AQxwaXhlbFZhclBvb2wCY3kDfAEMcGl4ZWxWYXJQb29sAnN4A3wBDHBpeGVsVmFyUG9vbAJzeQN8AQxwaXhlbFZhclBvb2wCZHgDfAEMcGl4ZWxWYXJQb29sAmR5A3wBDHBpeGVsVmFyUG9vbANyb3QDfAEMcGl4ZWxWYXJQb29sA3JhZAN8AQxwaXhlbFZhclBvb2wDYW5nA3wBDHBpeGVsVmFyUG9vbAF4A3wBDHBpeGVsVmFyUG9vbAF5A3wBCHFWYXJQb29sAnExA3wBCHFWYXJQb29sAnEyA3wBCHFWYXJQb29sAnEzA3wBCHFWYXJQb29sAnE0A3wBCHFWYXJQb29sAnE1A3wBCHFWYXJQb29sAnE2A3wBCHFWYXJQb29sAnE3A3wBCHFWYXJQb29sAnE4A3wBCHFWYXJQb29sAnE5A3wBCHFWYXJQb29sA3ExMAN8AQhxVmFyUG9vbANxMTEDfAEIcVZhclBvb2wDcTEyA3wBCHFWYXJQb29sA3ExMwN8AQhxVmFyUG9vbANxMTQDfAEIcVZhclBvb2wDcTE1A3wBCHFWYXJQb29sA3ExNgN8AQhxVmFyUG9vbANxMTcDfAEIcVZhclBvb2wDcTE4A3wBCHFWYXJQb29sA3ExOQN8AQhxVmFyUG9vbANxMjADfAEIcVZhclBvb2wDcTIxA3wBCHFWYXJQb29sA3EyMgN8AQhxVmFyUG9vbANxMjMDfAEIcVZhclBvb2wDcTI0A3wBCHFWYXJQb29sA3EyNQN8AQhxVmFyUG9vbANxMjYDfAEIcVZhclBvb2wDcTI3A3wBCHFWYXJQb29sA3EyOAN8AQhxVmFyUG9vbANxMjkDfAEIcVZhclBvb2wDcTMwA3wBCHFWYXJQb29sA3EzMQN8AQhxVmFyUG9vbANxMzIDfAEIdFZhclBvb2wCdDEDfAEIdFZhclBvb2wCdDIDfAEIdFZhclBvb2wCdDMDfAEIdFZhclBvb2wCdDQDfAEIdFZhclBvb2wCdDUDfAEIdFZhclBvb2wCdDYDfAEIdFZhclBvb2wCdDcDfAEIdFZhclBvb2wCdDgDfAEKc2hhcGVQb29sMAN4XzADfAEKc2hhcGVQb29sMAN5XzADfAEKc2hhcGVQb29sMAVyYWRfMAN8AQpzaGFwZVBvb2wwBWFuZ18wA3wBCnNoYXBlUG9vbDADcl8wA3wBCnNoYXBlUG9vbDADZ18wA3wBCnNoYXBlUG9vbDADYl8wA3wBCnNoYXBlUG9vbDADYV8wA3wBCnNoYXBlUG9vbDAEcjJfMAN8AQpzaGFwZVBvb2wwBGcyXzADfAEKc2hhcGVQb29sMARiMl8wA3wBCnNoYXBlUG9vbDAEYTJfMAN8AQpzaGFwZVBvb2wwCmJvcmRlcl9yXzADfAEKc2hhcGVQb29sMApib3JkZXJfZ18wA3wBCnNoYXBlUG9vbDAKYm9yZGVyX2JfMAN8AQpzaGFwZVBvb2wwCmJvcmRlcl9hXzADfAEKc2hhcGVQb29sMA50aGlja291dGxpbmVfMAN8AQpzaGFwZVBvb2wwCnRleHR1cmVkXzADfAEKc2hhcGVQb29sMAp0ZXhfem9vbV8wA3wBCnNoYXBlUG9vbDAJdGV4X2FuZ18wA3wBCnNoYXBlUG9vbDAKYWRkaXRpdmVfMAN8AQpzaGFwZVBvb2wxA3hfMQN8AQpzaGFwZVBvb2wxA3lfMQN8AQpzaGFwZVBvb2wxBXJhZF8xA3wBCnNoYXBlUG9vbDEFYW5nXzEDfAEKc2hhcGVQb29sMQNyXzEDfAEKc2hhcGVQb29sMQNnXzEDfAEKc2hhcGVQb29sMQNiXzEDfAEKc2hhcGVQb29sMQNhXzEDfAEKc2hhcGVQb29sMQRyMl8xA3wBCnNoYXBlUG9vbDEEZzJfMQN8AQpzaGFwZVBvb2wxBGIyXzEDfAEKc2hhcGVQb29sMQRhMl8xA3wBCnNoYXBlUG9vbDEKYm9yZGVyX3JfMQN8AQpzaGFwZVBvb2wxCmJvcmRlcl9nXzEDfAEKc2hhcGVQb29sMQpib3JkZXJfYl8xA3wBCnNoYXBlUG9vbDEKYm9yZGVyX2FfMQN8AQpzaGFwZVBvb2wxDnRoaWNrb3V0bGluZV8xA3wBCnNoYXBlUG9vbDEKdGV4dHVyZWRfMQN8AQpzaGFwZVBvb2wxCnRleF96b29tXzEDfAEKc2hhcGVQb29sMQl0ZXhfYW5nXzEDfAEKc2hhcGVQb29sMQphZGRpdGl2ZV8xA3wBCnNoYXBlUG9vbDIDeF8yA3wBCnNoYXBlUG9vbDIDeV8yA3wBCnNoYXBlUG9vbDIFcmFkXzIDfAEKc2hhcGVQb29sMgVhbmdfMgN8AQpzaGFwZVBvb2wyA3JfMgN8AQpzaGFwZVBvb2wyA2dfMgN8AQpzaGFwZVBvb2wyA2JfMgN8AQpzaGFwZVBvb2wyA2FfMgN8AQpzaGFwZVBvb2wyBHIyXzIDfAEKc2hhcGVQb29sMgRnMl8yA3wBCnNoYXBlUG9vbDIEYjJfMgN8AQpzaGFwZVBvb2wyBGEyXzIDfAEKc2hhcGVQb29sMgpib3JkZXJfcl8yA3wBCnNoYXBlUG9vbDIKYm9yZGVyX2dfMgN8AQpzaGFwZVBvb2wyCmJvcmRlcl9iXzIDfAEKc2hhcGVQb29sMgpib3JkZXJfYV8yA3wBCnNoYXBlUG9vbDIOdGhpY2tvdXRsaW5lXzIDfAEKc2hhcGVQb29sMgp0ZXh0dXJlZF8yA3wBCnNoYXBlUG9vbDIKdGV4X3pvb21fMgN8AQpzaGFwZVBvb2wyCXRleF9hbmdfMgN8AQpzaGFwZVBvb2wyCmFkZGl0aXZlXzIDfAEKc2hhcGVQb29sMwN4XzMDfAEKc2hhcGVQb29sMwN5XzMDfAEKc2hhcGVQb29sMwVyYWRfMwN8AQpzaGFwZVBvb2wzBWFuZ18zA3wBCnNoYXBlUG9vbDMDcl8zA3wBCnNoYXBlUG9vbDMDZ18zA3wBCnNoYXBlUG9vbDMDYl8zA3wBCnNoYXBlUG9vbDMDYV8zA3wBCnNoYXBlUG9vbDMEcjJfMwN8AQpzaGFwZVBvb2wzBGcyXzMDfAEKc2hhcGVQb29sMwRiMl8zA3wBCnNoYXBlUG9vbDMEYTJfMwN8AQpzaGFwZVBvb2wzCmJvcmRlcl9yXzMDfAEKc2hhcGVQb29sMwpib3JkZXJfZ18zA3wBCnNoYXBlUG9vbDMKYm9yZGVyX2JfMwN8AQpzaGFwZVBvb2wzCmJvcmRlcl9hXzMDfAEKc2hhcGVQb29sMw50aGlja291dGxpbmVfMwN8AQpzaGFwZVBvb2wzCnRleHR1cmVkXzMDfAEKc2hhcGVQb29sMwp0ZXhfem9vbV8zA3wBCnNoYXBlUG9vbDMJdGV4X2FuZ18zA3wBCnNoYXBlUG9vbDMKYWRkaXRpdmVfMwN8AQMZGAgDBwkBAQICAQYFAAAAAAAAAAAAAAAAAAUDAQABBuwMigF8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt/AUEAC3wBRAAAAAAAAAAAC3wBRAAAAAAAAAAAC34BQgALB9kBDwZtZW1vcnkCABJjcmVhdGVGbG9hdDMyQXJyYXkABBFydW5QaXhlbEVxdWF0aW9ucwAMBnNhdmVRcwANCXJlc3RvcmVRcwAOBnNhdmVUcwAPCXJlc3RvcmVUcwAQC3NoYXBlMF9zYXZlABEOc2hhcGUwX3Jlc3RvcmUAEgtzaGFwZTFfc2F2ZQATDnNoYXBlMV9yZXN0b3JlABQLc2hhcGUyX3NhdmUAFQ5zaGFwZTJfcmVzdG9yZQAWC3NoYXBlM19zYXZlABcOc2hhcGUzX3Jlc3RvcmUAGAgBGQraQRi0AQEGfyAAQez///8DSwRAAAsgAEEQaiICQfz///8DSwRAAAsjkAIhBiOQAkEEaiIEIAJBE2pBcHFBBGsiB2oiAj8AIgVBEHRBD2pBcHEiA0sEQCAFIAIgA2tB//8DakGAgHxxQRB2IgMgAyAFSBtAAEEASARAIANAAEEASARAAAsLCyACJJACIAYgBzYCACAEQQRrIgJBADYCBCACQQA2AgggAiABNgIMIAIgADYCECAEQRBqC7sCAQF/AkAgAUUNACAAQQA6AAAgACABakEEayICQQA6AAMgAUECTQ0AIABBADoAASAAQQA6AAIgAkEAOgACIAJBADoAASABQQZNDQAgAEEAOgADIAJBADoAACABQQhNDQAgAEEAIABrQQNxIgJqIgBBADYCACAAIAEgAmtBfHEiAmpBHGsiAUEANgIYIAJBCE0NACAAQQA2AgQgAEEANgIIIAFBADYCECABQQA2AhQgAkEYTQ0AIABBADYCDCAAQQA2AhAgAEEANgIUIABBADYCGCABQQA2AgAgAUEANgIEIAFBADYCCCABQQA2AgwgACAAQQRxQRhqIgFqIQAgAiABayEBA0AgAUEgTwRAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCABQSBrIQEgAEEgaiEADAELCwsLdwECfwJ/QQxBAxACIgFFBEBBDEECEAIhAQsgAQtBADYCACABQQA2AgQgAUEANgIIIABB/////wBLBEBBoAhB0AhBEkE5EAAACyAAQQJ0IgBBABACIgIgABADIAEoAgAaIAEgAjYCACABIAI2AgQgASAANgIIIAELuwQDAX8KfgF8IABC////////////AINCNIhClQh9IgVCBoenQQN0QYAJaiIBKQMAIQcgASkDCCEEIAEpAxAhAiAFQj+DIgVCAFIEQAJ+IAcgBYYgBELAACAFfSIDiIQhByAEIAWGIAIgA4iEIQQgAiAFhiABKQMYIAOIhAshAgsgAEL/////////B4NCgICAgICAgAiEIgVC/////w+DIgMgBEIgiCIIfiAEQv////8PgyIGIAN+IglCIIh8IQQgBiAFQiCIIgZ+IARC/////w+DfCEDIAYgCH4gBEIgiHwgA0IgiHwkkwIgBUIghyACQiCIfiIEIAlC/////w+DIANCIIZ8fCECIAIgBFStI5MCIAUgB358fCIIQgKGIAJCPoiEIgdCP4ciBUIBhyAHhSIDeSEEIAMgBIYgBSACQgKGhSIGQsAAIAR9iIQiAkL/////D4MhAyACQiCIIglCtISjiwJ+IANCorW/yAx+IANCtISjiwJ+IgpCIIh8IgtC/////w+DfCEDIAlCorW/yAx+IAtCIIh8IANCIIh8JJMCIApC/////w+DIANCIIZ8IgMgArpEhBtwUcyYOD+iIAYgBIa6RBgtRFT7ITk/oqCxIgJUrSOTAiIGQguIfLokkQIgAiAGQjWGIANCC4iEfLpEAAAAAAAA8DuiJJICI5ECQoCAgICAgIDYPCAEQjSGfSAAIAeFQoCAgICAgICAgH+DhL8iDKIkkQIjkgIgDKIkkgIgCEI+hyAFfacLlQYDAn8BfgR8IAC9IgNCIIinIgFBH3YhAiABQf////8HcSIBQfvDpP8DTQRAIAFBnsGa8gNJBEBEAAAAAAAA8D8PC0QAAAAAAADwPyAAIACiIgVEAAAAAAAA4D+iIgahIgREAAAAAAAA8D8gBKEgBqEgBSAFIAUgBUSQFcsZoAH6PqJEd1HBFmzBVr+gokRMVVVVVVWlP6CiIAUgBaIiBiAGoiAFIAVE1DiIvun6qL2iRMSxtL2e7iE+oKJErVKcgE9+kr6goqCiIABEAAAAAAAAAACioaCgDwsgAUGAgMD/B08EQCAAIAChDwsCfyADQiCIp0H/////B3EiAUH7w+SJBEkEQAJ8IAFBFHYiAiAAIABEg8jJbTBf5D+iniIFRAAAQFT7Ifk/oqEiACAFRDFjYhphtNA9oiIGoSIEvUIgiKdBFHZB/w9xa0EQSwRAAnwgBURzcAMuihmjO6IgACAAIAVEAABgGmG00D2iIgahIgChIAahoSEGIAIgACAGoSIEvUIgiKdBFHZB/w9xa0ExSwR8IAVEwUkgJZqDezmiIAAgACAFRAAAAC6KGaM7oiIGoSIAoSAGoaEhBiAAIAahBSAECwshBAsgBAskkQIgACAEoSAGoSSSAiAFqgwBC0EAIAMQBSIBayABIAIbCyECI5ECIQUjkgIhBiACQQFxBHwgBSAFoiIAIAWiIQQgBSAAIAZEAAAAAAAA4D+iIAQgACAARH3+sVfjHcc+okTVYcEZoAEqv6CiRKb4EBEREYE/oCAAIAAgAKKiIABEfNXPWjrZ5T2iROucK4rm5Vq+oKKgoqGiIAahIARESVVVVVVVxb+ioaEFRAAAAAAAAPA/IAUgBaIiAEQAAAAAAADgP6IiBKEiB0QAAAAAAADwPyAHoSAEoSAAIAAgACAARJAVyxmgAfo+okR3UcEWbMFWv6CiRExVVVVVVaU/oKIgACAAoiIEIASiIAAgAETUOIi+6fqovaJExLG0vZ7uIT6gokStUpyAT36SvqCioKIgBSAGoqGgoAsiAJogACACQQFqQQJxGwu8BAICfwN8IAAhAyAAvUIgiKdB/////wdxIgFBgIDAoARPBEAgACAAYgRAIAAPC0QYLURU+yH5PyADpg8LIAFBgIDw/gNJBEAgAUGAgIDyA0kEQCAADwtBfyECBSAAmSEAIAFBgIDM/wNJBHwgAUGAgJj/A0kEfCAAIACgRAAAAAAAAPA/oSAARAAAAAAAAABAoKMFQQEhAiAARAAAAAAAAPA/oSAARAAAAAAAAPA/oKMLBSABQYCAjoAESQR8QQIhAiAARAAAAAAAAPg/oSAARAAAAAAAAPg/okQAAAAAAADwP6CjBUEDIQJEAAAAAAAA8L8gAKMLCyEACyAAIACiIgUgBaIhBCAAIAUgBCAEIAQgBCAERBHaIuM6rZA/okTrDXYkS3upP6CiRFE90KBmDbE/oKJEbiBMxc1Ftz+gokT/gwCSJEnCP6CiRA1VVVVVVdU/oKIgBCAEIAQgBCAERC9saixEtKK/okSa/d5SLd6tv6CiRG2adK/ysLO/oKJEcRYj/sZxvL+gokTE65iZmZnJv6CioKIhBCACQQBIBEAgACAEoQ8LAkACQAJAAkACQAJAIAIOBAABAgMEC0RPu2EFZ6zdPyAEROJlLyJ/K3o8oSAAoaEhAAwEC0QYLURU+yHpPyAERAdcFDMmpoE8oSAAoaEhAAwDC0Sb9oHSC3PvPyAERL3L8HqIB3A8oSAAoaEhAAwCC0QYLURU+yH5PyAERAdcFDMmppE8oSAAoaEhAAwBCwALIAAgA6YLvgMCBX8BfkEBIAAgAGIgASABYhsEQCABIACgDwsgAL0iB0IgiKchBCAHpyEDIAG9IgenIgYgB0IgiKciBUGAgMD/A2tyRQRAIAAQBw8LIAVBHnZBAnEgBEEfdnIhAiAFQf////8HcSEFIARB/////wdxIgQgA3JFBEACQAJAAkACQCACRQ0AAkAgAkEBaw4DAQIDAAsMAwsgAA8LRBgtRFT7IQlADwtEGC1EVPshCcAPCwsCQCAFIAZyRQ0AIAVBgIDA/wdGBEBE0iEzf3zZAkBEGC1EVPsh6T8gAkECcRtEGC1EVPshCUBEAAAAAAAAAAAgAkECcRsgBEGAgMD/B0YbIgCaIAAgAkEBcRsPC0EBIARBgIDA/wdGIAQgBUGAgIAgaksbDQAgBSAEQYCAgCBqS0EAIAJBAnEbBHxEAAAAAAAAAAAFIAAgAaOZEAcLIQACQAJAAkACQCACIgMEQCADQQFrDgMBAgMECyAADwsgAJoPC0QYLURU+yEJQCAARAdcFDMmpqE8oaEPCyAARAdcFDMmpqE8oUQYLURU+yEJQKEPCwALRBgtRFT7Ifm/RBgtRFT7Ifk/IAJBAXEbC4ESAwl/AX4IfAJAAkACQAJAIAGZRAAAAAAAAABAZQRAIAFEAAAAAAAAAEBhDQEgAUQAAAAAAADgP2EEQCAAn5lEAAAAAAAA8H8gAEQAAAAAAADw/2IbDwsgAUQAAAAAAADwv2ENAiABRAAAAAAAAPA/YQRAIAAPCyABRAAAAAAAAAAAYQRARAAAAAAAAPA/DwsLIAC9IgunIQcgC0IgiKciBkH/////B3EhBCABvSILQiCIpyIDQf////8HcSIFIAunIghyRQRARAAAAAAAAPA/DwtBASAIQQAgBUGAgMD/B0YbQQEgBUGAgMD/B0tBASAHQQAgBEGAgMD/B0YbIARBgIDA/wdKGxsbBEAgACABoA8LIAZBAEgEfyAFQYCAgJoETwR/QQIFIAVBgIDA/wNPBH9BAiAIIAUgBUEUdkH/B2siAkEUSiIJGyIKQTRBFCAJGyACayICdiIJQQFxa0EAIAogCSACdEYbBUEACwsFQQALIQIgCEUEQCAFQYCAwP8HRgRAIAcgBEGAgMD/A2tyBEAgBEGAgMD/A04EQCABRAAAAAAAAAAAIANBAE4bDwVEAAAAAAAAAAAgAZogA0EAThsPCwAFRAAAAAAAAPh/DwsACyAFQYCAwP8DRgRAIANBAE4EQCAADwsMAwsgA0GAgICABEYNASADQYCAgP8DRgRAIAZBAE4EQCAAnw8LCwsgAJkhDCAHRQRAQQEgBEGAgMD/A0YgBEGAgMD/B0ZBASAEGxsEQEQAAAAAAADwPyAMoyAMIANBAEgbIQAgBkEASAR8IAIgBEGAgMD/A2tyBHwgAJogACACQQFGGwUgACAAoSIAIACjCwUgAAsPCwsgBkEASAR8IAJFBEAgACAAoSIAIACjDwtEAAAAAAAA8L9EAAAAAAAA8D8gAkEBRhsFRAAAAAAAAPA/CyEOIAVBgICAjwRLBHwgBUGAgMCfBEsEQCAEQf//v/8DTARARAAAAAAAAPB/RAAAAAAAAAAAIANBAEgbDwsgBEGAgMD/A04EQEQAAAAAAADwf0QAAAAAAAAAACADQQBKGw8LCyAEQf//v/8DSARAIA5EnHUAiDzkN36iRJx1AIg85Dd+oiAORFnz+MIfbqUBokRZ8/jCH26lAaIgA0EASBsPCyAEQYCAwP8DSgRAIA5EnHUAiDzkN36iRJx1AIg85Dd+oiAORFnz+MIfbqUBokRZ8/jCH26lAaIgA0EAShsPCyAMRAAAAAAAAPA/oSIARAAAAGBHFfc/oiIMIABERN9d+AuuVD6iIAAgAKJEAAAAAAAA4D8gAERVVVVVVVXVPyAARAAAAAAAANA/oqGioaJE/oIrZUcV9z+ioSINoL1CgICAgHCDvyEAIA0gACAMoaEFIARBgIDAAEgEfyAMRAAAAAAAAEBDoiIMvUIgiKchBEFLBUEACyAEQRR1Qf8Ha2ohAyAEQf//P3EiAkGAgMD/A3IhBCACQY6xDkwEf0EABSACQfrsLkgEf0EBBSADQQFqIQMgBEGAgEBqIQRBAAsLIQIgDL1C/////w+DIASsQiCGhL8iD0QAAAAAAAD4P0QAAAAAAADwPyACGyIQoSISRAAAAAAAAPA/IA8gEKCjIhOiIg29QoCAgIBwg78iDCAMoiERIAwgEUQAAAAAAAAIQKAgDSANoiIAIACiIAAgACAAIAAgAETvTkVKKH7KP6JEZdvJk0qGzT+gokQBQR2pYHTRP6CiRE0mj1FVVdU/oKJE/6tv27Zt2z+gokQDMzMzMzPjP6CiIBMgEiAMIARBAXVBgICAgAJyQYCAIGogAkESdGqsQiCGvyIAoqEgDCAPIAAgEKGhoqGiIg8gDCANoKKgIgygvUKAgICAcIO/IgCiIhAgDyAAoiAMIABEAAAAAAAACEChIBGhoSANoqAiDKC9QoCAgIBwg78iAEQAAADgCcfuP6IiDSAARPUBWxTgLz6+oiAMIAAgEKGhRP0DOtwJx+4/oqBEBtDPQ+v9TD5EAAAAAAAAAAAgAhugIgygRAAAAEADuOI/RAAAAAAAAAAAIAIbIg+gIAO3IhCgvUKAgICAcIO/IQAgDCAAIBChIA+hIA2hoQshDCABIAG9QoCAgIBwg78iDaEgAKIgASAMoqAiASANIACiIgCgIgy9IgunIQMgC0IgiKciAkGAgMCEBE4EQCADIAJBgIDAhARrciABRP6CK2VHFZc8oCAMIAChZHINAwUgAkH/////B3FBgJjDhARPQQAgAyACQYCYw4R8a3IgASAMIAChZXIbDQQLIAJB/////wdxIgRBFHZB/wdrIQVBACEDIAECfCAEQYCAgP8DSgRAAnwgAkGAgMAAIAVBAWp1aiIEQf////8HcUEUdkH/B2shBUEAIARB//8/cUGAgMAAckEUIAVrdSIDayADIAJBAEgbIQMgACAEQf//PyAFdUF/c3GsQiCGv6ELIQALIAALoL1CgICAgHCDvyIMRAAAAABDLuY/oiINIAEgDCAAoaFE7zn6/kIu5j+iIAxEOWyoDGFcIL6ioCIMoCIAIACiIQEgDkQAAAAAAADwPyAAIAAgASABIAEgASABRNCkvnJpN2Y+okTxa9LFQb27vqCiRCzeJa9qVhE/oKJEk72+FmzBZr+gokQ+VVVVVVXFP6CioSIBoiABRAAAAAAAAABAoaMgDCAAIA2hoSIBIAAgAaKgoSAAoaEiAL1CIIinIANBFHRqIgJBFHVBAEwEfCADIgJB/wdKBHwgAEQAAAAAAADgf6IhACACQf8HayICQf8HSgR8IAJB/wdrIgJB/wcgAkH/B0gbIQIgAEQAAAAAAADgf6IFIAALBSACQYJ4SAR8IABEAAAAAAAAYAOiIQAgAkHJB2oiAkGCeEgEfCACQckHaiICQYJ4IAJBgnhKGyECIABEAAAAAAAAYAOiBSAACwUgAAsLIAKsQv8HfEI0hr+iBSAAvUL/////D4MgAqxCIIaEvwuiDwsgACAAog8LRAAAAAAAAPA/IACjDwsgDkScdQCIPOQ3fqJEnHUAiDzkN36iDwsgDkRZ8/jCH26lAaJEWfP4wh9upQGiC9QFAwJ/AX4EfCAAvSIDQiCIpyIBQR92IQIgAUH/////B3EiAUH7w6T/A00EQCABQYCAwPIDSQRAIAAPCyAAIAAgAKIiBSAAoiAFIAUgBUR9/rFX4x3HPqJE1WHBGaABKr+gokSm+BARERGBP6AgBSAFIAWioiAFRHzVz1o62eU9okTrnCuK5uVavqCioKJESVVVVVVVxb+goqAPCyABQYCAwP8HTwRAIAAgAKEPCwJ/IANCIIinQf////8HcSIBQfvD5IkESQRAAnwgAUEUdiICIAAgAESDyMltMF/kP6KeIgVEAABAVPsh+T+ioSIAIAVEMWNiGmG00D2iIgahIgS9QiCIp0EUdkH/D3FrQRBLBEACfCAFRHNwAy6KGaM7oiAAIAAgBUQAAGAaYbTQPaIiBqEiAKEgBqGhIQYgAiAAIAahIgS9QiCIp0EUdkH/D3FrQTFLBHwgBUTBSSAlmoN7OaIgACAAIAVEAAAALooZozuiIgahIgChIAahoSEGIAAgBqEFIAQLCyEECyAECySRAiAAIAShIAahJJICIAWqDAELQQAgAxAFIgFrIAEgAhsLIQIjkQIhBSOSAiEGIAJBAXEEfEQAAAAAAADwPyAFIAWiIgBEAAAAAAAA4D+iIgShIgdEAAAAAAAA8D8gB6EgBKEgACAAIAAgAESQFcsZoAH6PqJEd1HBFmzBVr+gokRMVVVVVVWlP6CiIAAgAKIiBCAEoiAAIABE1DiIvun6qL2iRMSxtL2e7iE+oKJErVKcgE9+kr6goqCiIAUgBqKhoKAFIAUgBaIiACAFoiEEIAUgACAGRAAAAAAAAOA/oiAEIAAgAER9/rFX4x3HPqJE1WHBGaABKr+gokSm+BARERGBP6AgACAAIACioiAARHzVz1o62eU9okTrnCuK5uVavqCioKKhoiAGoSAERElVVVVVVcW/oqGhCyIAmiAAIAJBAnEbCxIAIAAoAgQgAUECdGogAjgCAAuTCAIFfwl8IAJBAWohDCADQQFqIQ1EAAAAAAAA8D8gBqMhECAEIAWiIgVEz/dT46Wb9j+iRAAAAAAAACRAoBAGRAAAAAAAABBAokRcj8L1KFwnQKAhFCAFRAIrhxbZzvE/okQAAAAAAAAcQKAQBkQAAAAAAAAIQKJECtejcD2KIUCgIRIgBUTufD81XrrzP6JEAAAAAAAACECgEAZEAAAAAAAACECiRBSuR+F6FCVAoCETIAVEQmDl0CLb7T+iRAAAAAAAABRAoBAGRAAAAAAAABBAokR7FK5H4fomQKAhFSMAJIoBIwEkiwEjAiSMASMDJI0BIwQkjgEjBSSPASMGJJABIwckkQEjCCSSASMJJJMBA0AgCiANSARAQQAhCQNAIAkgDEgEQCAJtyACt6MiBCAEoEQAAAAAAADwP6EiBiAGoiAHoiAHoiAKtyADt6MiBCAEoEQAAAAAAADwP6EiDyAPoiAIoiAIoqCfJAogAQRAIAm3IAK3RAAAAAAAAOA/omFBACAKtyADt0QAAAAAAADgP6JhGwRARAAAAAAAAAAAJAsFIA8gCKIgBiAHohAIIgREAAAAAAAAAABjBHwgBEQYLURU+yEZQKAFIAQLJAsLIAZEAAAAAAAA4D+iIAeiRAAAAAAAAOA/oCQMIA9EAAAAAAAA4L+iIAiiRAAAAAAAAOA/oCQNI4oBJAAjiwEkASOMASQCI40BJAMjjgEkBCOPASQFI5ABJAYjkQEkByOSASQII5MBJAkQAQsgBkQAAAAAAADgP6IgB6JEAAAAAAAA8D8jASMCIwoiBCAEoEQAAAAAAADwP6EQCRAJoyIOokQAAAAAAADgP6AjA6EjBaMjA6AhBCAPRAAAAAAAAOC/oiAIoiAOokQAAAAAAADgP6AjBKEjBqMjBKAhDiMARAAAAAAAAAAAYgRAAnwgBCMARHnpJjEIrGw/oiAFRB1aZDvfT9U/oiAQIAYgFKIiESAPIBWiIhahoqAQCqKgIQQgDiMARHnpJjEIrGw/oiAFRAAAAAAAANg/oiAQIAYgE6IgDyASoqCioRAGoqAhDiAEIwBEeekmMQisbD+iIAVEf2q8dJMY6D+iIBAgBiASoiAPIBOioaKhEAaioCEEIA4jAER56SYxCKxsP6IgBURmZmZmZmbqP6IgECARIBagoqAQCqKgCyEOCyAEIwOhIQQgDiMEoSEGIwkQBiEPIAQjCRAKIg6iIAYgD6KgIwSgIwihRAAAAAAAAOA/oSAIo0QAAAAAAADgP6AhESAAIAsgBCAPoiAGIA6ioSMDoCMHoUQAAAAAAADgP6EgB6NEAAAAAAAA4D+gthALIAAgC0EBaiARthALIAtBAmohCyAJQQFqIQkMAQsLIApBAWohCgwBCwsLogEAIw4klAEjDySVASMQJJYBIxEklwEjEiSYASMTJJkBIxQkmgEjFSSbASMWJJwBIxcknQEjGCSeASMZJJ8BIxokoAEjGyShASMcJKIBIx0kowEjHiSkASMfJKUBIyAkpgEjISSnASMiJKgBIyMkqQEjJCSqASMlJKsBIyYkrAEjJyStASMoJK4BIykkrwEjKiSwASMrJLEBIywksgEjLSSzAQuiAQAjlAEkDiOVASQPI5YBJBAjlwEkESOYASQSI5kBJBMjmgEkFCObASQVI5wBJBYjnQEkFyOeASQYI58BJBkjoAEkGiOhASQbI6IBJBwjowEkHSOkASQeI6UBJB8jpgEkICOnASQhI6gBJCIjqQEkIyOqASQkI6sBJCUjrAEkJiOtASQnI64BJCgjrwEkKSOwASQqI7EBJCsjsgEkLCOzASQtCyoAIy4ktAEjLyS1ASMwJLYBIzEktwEjMiS4ASMzJLkBIzQkugEjNSS7AQsqACO0ASQuI7UBJC8jtgEkMCO3ASQxI7gBJDIjuQEkMyO6ASQ0I7sBJDULawAjNiS8ASM3JL0BIzgkvgEjOSS/ASM6JMABIzskwQEjPCTCASM9JMMBIz4kxAEjPyTFASNAJMYBI0EkxwEjQiTIASNDJMkBI0QkygEjRSTLASNGJMwBI0ckzQEjSCTOASNJJM8BI0ok0AELawAjvAEkNiO9ASQ3I74BJDgjvwEkOSPAASQ6I8EBJDsjwgEkPCPDASQ9I8QBJD4jxQEkPyPGASRAI8cBJEEjyAEkQiPJASRDI8oBJEQjywEkRSPMASRGI80BJEcjzgEkSCPPASRJI9ABJEoLawAjSyTRASNMJNIBI00k0wEjTiTUASNPJNUBI1Ak1gEjUSTXASNSJNgBI1Mk2QEjVCTaASNVJNsBI1Yk3AEjVyTdASNYJN4BI1kk3wEjWiTgASNbJOEBI1wk4gEjXSTjASNeJOQBI18k5QELawAj0QEkSyPSASRMI9MBJE0j1AEkTiPVASRPI9YBJFAj1wEkUSPYASRSI9kBJFMj2gEkVCPbASRVI9wBJFYj3QEkVyPeASRYI98BJFkj4AEkWiPhASRbI+IBJFwj4wEkXSPkASReI+UBJF8LawAjYCTmASNhJOcBI2Ik6AEjYyTpASNkJOoBI2Uk6wEjZiTsASNnJO0BI2gk7gEjaSTvASNqJPABI2sk8QEjbCTyASNtJPMBI24k9AEjbyT1ASNwJPYBI3Ek9wEjciT4ASNzJPkBI3Qk+gELawAj5gEkYCPnASRhI+gBJGIj6QEkYyPqASRkI+sBJGUj7AEkZiPtASRnI+4BJGgj7wEkaSPwASRqI/EBJGsj8gEkbCPzASRtI/QBJG4j9QEkbyP2ASRwI/cBJHEj+AEkciP5ASRzI/oBJHQLdQAjdST7ASN2JPwBI3ck/QEjeCT+ASN5JP8BI3okgAIjeySBAiN8JIICI30kgwIjfiSEAiN/JIUCI4ABJIYCI4EBJIcCI4IBJIgCI4MBJIkCI4QBJIoCI4UBJIsCI4YBJIwCI4cBJI0CI4gBJI4CI4kBJI8CC3UAI/sBJHUj/AEkdiP9ASR3I/4BJHgj/wEkeSOAAiR6I4ECJHsjggIkfCODAiR9I4QCJH4jhQIkfyOGAiSAASOHAiSBASOIAiSCASOJAiSDASOKAiSEASOLAiSFASOMAiSGASONAiSHASOOAiSIASOPAiSJAQsIAEHMCiSQAgsLvAIDAEGMCAsvLAAAAAEAAAAAAAAAAQAAABwAAABJAG4AdgBhAGwAaQBkACAAbABlAG4AZwB0AGgAQbwICzk8AAAAAQAAAAAAAAABAAAAJgAAAH4AbABpAGIALwBhAHIAcgBhAHkAYgB1AGYAZgBlAHIALgB0AHMAQYAJC8ABboP5ogAAAADRVyf8KRVETpmVYtvA3TT1q2NR/kGQQzw6biS3YcW73uouSQbg0k1CHOsd/hyS0Qn1NYLoPqcpsSZwnOmERLsuOdaROUF+X7SLX4Sc9DlTg/+X+B87KPm9ixEv7w+YBd7PfjZtH20KWmY/Rk+3Ccsnx7ondS3qX573OQc9e/Hl67Ff+2vqklKKRjADVghdjR8gvM/wq2t7/GGR46kdNvSaX4WZZQgb5l6A2P+NQGigFFcVBgYxJ3NN"},"./src/audio/audioLevels.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{constructor(e){let t;this.audio=e,t=this.audio.audioContext?this.audio.audioContext.sampleRate:44100;const r=t/this.audio.fftSize,n=Math.clamp(Math.round(20/r)-1,0,this.audio.numSamps-1),i=Math.clamp(Math.round(320/r)-1,0,this.audio.numSamps-1),a=Math.clamp(Math.round(2800/r)-1,0,this.audio.numSamps-1),s=Math.clamp(Math.round(11025/r)-1,0,this.audio.numSamps-1);this.starts=[n,i,a],this.stops=[i,a,s],this.val=new Float32Array(3),this.imm=new Float32Array(3),this.att=new Float32Array(3),this.avg=new Float32Array(3),this.longAvg=new Float32Array(3),this.att.fill(1),this.avg.fill(1),this.longAvg.fill(1)}get bass(){return this.val[0]}get bass_att(){return this.att[0]}get mid(){return this.val[1]}get mid_att(){return this.att[1]}get treb(){return this.val[2]}get treb_att(){return this.att[2]}static isFiniteNumber(e){return Number.isFinite(e)&&!Number.isNaN(e)}static adjustRateToFPS(e,t,r){return e**(t/r)}updateAudioLevels(e,t){if(this.audio.freqArray.length>0){let r=e;!n.isFiniteNumber(r)||r<15?r=15:r>144&&(r=144),this.imm.fill(0);for(let e=0;e<3;e++)for(let t=this.starts[e];t<this.stops[e];t++)this.imm[e]+=this.audio.freqArray[t];for(let e=0;e<3;e++){let i;i=this.imm[e]>this.avg[e]?.2:.5,i=n.adjustRateToFPS(i,30,r),this.avg[e]=this.avg[e]*i+this.imm[e]*(1-i),i=t<50?.9:.992,i=n.adjustRateToFPS(i,30,r),this.longAvg[e]=this.longAvg[e]*i+this.imm[e]*(1-i),this.longAvg[e]<.001?(this.val[e]=1,this.att[e]=1):(this.val[e]=this.imm[e]/this.longAvg[e],this.att[e]=this.avg[e]/this.longAvg[e])}}}}},"./src/audio/audioProcessor.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/audio/fft.js");class i{constructor(e){this.numSamps=512,this.fftSize=2*this.numSamps,this.fft=new n.default(this.fftSize,512,!0),e&&(this.audioContext=e,this.audible=e.createDelay(),this.analyser=e.createAnalyser(),this.analyser.smoothingTimeConstant=0,this.analyser.fftSize=this.fftSize,this.audible.connect(this.analyser),this.analyserL=e.createAnalyser(),this.analyserL.smoothingTimeConstant=0,this.analyserL.fftSize=this.fftSize,this.analyserR=e.createAnalyser(),this.analyserR.smoothingTimeConstant=0,this.analyserR.fftSize=this.fftSize,this.splitter=e.createChannelSplitter(2),this.audible.connect(this.splitter),this.splitter.connect(this.analyserL,0),this.splitter.connect(this.analyserR,1)),this.timeByteArray=new Uint8Array(this.fftSize),this.timeByteArrayL=new Uint8Array(this.fftSize),this.timeByteArrayR=new Uint8Array(this.fftSize),this.timeArray=new Int8Array(this.fftSize),this.timeByteArraySignedL=new Int8Array(this.fftSize),this.timeByteArraySignedR=new Int8Array(this.fftSize),this.tempTimeArrayL=new Int8Array(this.fftSize),this.tempTimeArrayR=new Int8Array(this.fftSize),this.timeArrayL=new Int8Array(this.numSamps),this.timeArrayR=new Int8Array(this.numSamps)}sampleAudio(){this.analyser.getByteTimeDomainData(this.timeByteArray),this.analyserL.getByteTimeDomainData(this.timeByteArrayL),this.analyserR.getByteTimeDomainData(this.timeByteArrayR),this.processAudio()}updateAudio(e,t,r){this.timeByteArray.set(e),this.timeByteArrayL.set(t),this.timeByteArrayR.set(r),this.processAudio()}processAudio(){for(let e=0,t=0,r=0;e<this.fftSize;e++)this.timeArray[e]=this.timeByteArray[e]-128,this.timeByteArraySignedL[e]=this.timeByteArrayL[e]-128,this.timeByteArraySignedR[e]=this.timeByteArrayR[e]-128,this.tempTimeArrayL[e]=.5*(this.timeByteArraySignedL[e]+this.timeByteArraySignedL[r]),this.tempTimeArrayR[e]=.5*(this.timeByteArraySignedR[e]+this.timeByteArraySignedR[r]),e%2==0&&(this.timeArrayL[t]=this.tempTimeArrayL[e],this.timeArrayR[t]=this.tempTimeArrayR[e],t+=1),r=e;this.freqArray=this.fft.timeToFrequencyDomain(this.timeArray),this.freqArrayL=this.fft.timeToFrequencyDomain(this.timeByteArraySignedL),this.freqArrayR=this.fft.timeToFrequencyDomain(this.timeByteArraySignedR)}connectAudio(e){e.connect(this.audible)}disconnectAudio(e){e.disconnect(this.audible)}}},"./src/audio/fft.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{constructor(e,t,r=!1){this.samplesIn=e,this.samplesOut=t,this.equalize=r,this.NFREQ=2*t,this.equalize&&this.initEqualizeTable(),this.initBitRevTable(),this.initCosSinTable()}initEqualizeTable(){this.equalizeArr=new Float32Array(this.samplesOut);const e=1/this.samplesOut;for(let t=0;t<this.samplesOut;t++)this.equalizeArr[t]=-.02*Math.log((this.samplesOut-t)*e)}initBitRevTable(){this.bitrevtable=new Uint16Array(this.NFREQ);for(let e=0;e<this.NFREQ;e++)this.bitrevtable[e]=e;let e=0;for(let t=0;t<this.NFREQ;t++){if(e>t){const r=this.bitrevtable[t];this.bitrevtable[t]=this.bitrevtable[e],this.bitrevtable[e]=r}let r=this.NFREQ>>1;for(;r>=1&&e>=r;)e-=r,r>>=1;e+=r}}initCosSinTable(){let e=2,t=0;for(;e<=this.NFREQ;)t+=1,e<<=1;this.cossintable=[new Float32Array(t),new Float32Array(t)],e=2;let r=0;for(;e<=this.NFREQ;){const t=-2*Math.PI/e;this.cossintable[0][r]=Math.cos(t),this.cossintable[1][r]=Math.sin(t),r+=1,e<<=1}}timeToFrequencyDomain(e){const t=new Float32Array(this.NFREQ),r=new Float32Array(this.NFREQ);for(let n=0;n<this.NFREQ;n++){const i=this.bitrevtable[n];i<this.samplesIn?t[n]=e[i]:t[n]=0,r[n]=0}let n=2,i=0;for(;n<=this.NFREQ;){const e=this.cossintable[0][i],a=this.cossintable[1][i];let s=1,o=0;const l=n>>1;for(let i=0;i<l;i++){for(let e=i;e<this.NFREQ;e+=n){const n=e+l,i=s*t[n]-o*r[n],a=s*r[n]+o*t[n];t[n]=t[e]-i,r[n]=r[e]-a,t[e]+=i,r[e]+=a}const c=s;s=c*e-o*a,o=o*e+c*a}n<<=1,i+=1}const a=new Float32Array(this.samplesOut);if(this.equalize)for(let e=0;e<this.samplesOut;e++)a[e]=this.equalizeArr[e]*Math.sqrt(t[e]*t[e]+r[e]*r[e]);else for(let e=0;e<this.samplesOut;e++)a[e]=Math.sqrt(t[e]*t[e]+r[e]*r[e]);return a}}},"./src/blankPreset.js":function(e,t,r){var n;void 0===(n=function(){return{baseVals:{gammaadj:1.25,wave_g:.5,mv_x:12,warpscale:1,brighten:0,mv_y:9,wave_scale:1,echo_alpha:0,additivewave:0,sx:1,sy:1,warp:.01,red_blue:0,wave_mode:0,wave_brighten:0,wrap:0,zoomexp:1,fshader:0,wave_r:.5,echo_zoom:1,wave_smoothing:.75,warpanimspeed:1,wave_dots:0,wave_x:.5,wave_y:.5,zoom:1,solarize:0,modwavealphabyvolume:0,dx:0,cx:.5,dy:0,darken_center:0,cy:.5,invert:0,bmotionvectorson:0,rot:0,modwavealphaend:.95,wave_mystery:-.2,decay:.9,wave_a:1,wave_b:.5,rating:5,modwavealphastart:.75,darken:0,echo_orient:0,ib_r:.5,ib_g:.5,ib_b:.5,ib_a:0,ib_size:0,ob_r:.5,ob_g:.5,ob_b:.5,ob_a:0,ob_size:0,mv_dx:0,mv_dy:0,mv_a:0,mv_r:.5,mv_g:.5,mv_b:.5,mv_l:0},init_eqs:function(){return{}},frame_eqs:function(e){return e.rkeys=["warp"],e.zoom=1.01+.02*e.treb_att,e.warp=.15+.25*e.bass_att,e},pixel_eqs:function(e){return e.warp=e.warp+.15*e.rad,e},waves:[{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e},point_eqs:""}],shapes:[{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(e){return e.rkeys=[],e},frame_eqs:function(e){return e}}],warp:"shader_body {\nret = texture2D(sampler_main, uv).rgb;\nret -= 0.004;\n}\n",comp:"shader_body {\nret = texture2D(sampler_main, uv).rgb;\nret *= hue_shader;\n}\n"}}.apply(t,[]))||(e.exports=n)},"./src/equations/presetEquationRunner.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/utils.js");class i{constructor(e,t,r){this.preset=e,this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=n.default.range(1,33).map((e=>`q${e}`)),this.ts=n.default.range(1,9).map((e=>`t${e}`)),this.regs=n.default.range(100).map((e=>e<10?`reg0${e}`:`reg${e}`)),this.initializeEquations(t)}initializeEquations(e){this.runVertEQs=""!==this.preset.pixel_eqs,this.mdVSQInit=null,this.mdVSRegs=null,this.mdVSFrame=null,this.mdVSUserKeys=null,this.mdVSFrameMap=null,this.mdVSShapes=null,this.mdVSUserKeysShapes=null,this.mdVSFrameMapShapes=null,this.mdVSWaves=null,this.mdVSUserKeysWaves=null,this.mdVSFrameMapWaves=null,this.mdVSQAfterFrame=null,this.gmegabuf=new Array(1048576).fill(0);const t={frame:e.frame,time:e.time,fps:e.fps,bass:e.bass,bass_att:e.bass_att,mid:e.mid,mid_att:e.mid_att,treb:e.treb,treb_att:e.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY,gmegabuf:this.gmegabuf};this.mdVS=Object.assign({},this.preset.baseVals,t),this.mdVS.megabuf=new Array(1048576).fill(0),this.mdVS.rand_start=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.mdVS.rand_preset=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]);const r=this.qs.concat(this.regs,Object.keys(this.mdVS)),i=this.preset.init_eqs(n.default.cloneVars(this.mdVS));this.mdVSQInit=n.default.pick(i,this.qs),this.mdVSRegs=n.default.pick(i,this.regs);const a=n.default.pick(i,Object.keys(n.default.omit(i,r)));if(a.megabuf=i.megabuf,a.gmegabuf=i.gmegabuf,this.mdVSFrame=this.preset.frame_eqs(Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSRegs,a)),this.mdVSUserKeys=Object.keys(n.default.omit(this.mdVSFrame,r)),this.mdVSFrameMap=n.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=n.default.pick(this.mdVSFrame,this.qs),this.mdVSRegs=n.default.pick(this.mdVSFrame,this.regs),this.mdVSWaves=[],this.mdVSTWaveInits=[],this.mdVSUserKeysWaves=[],this.mdVSFrameMapWaves=[],this.preset.waves&&this.preset.waves.length>0)for(let e=0;e<this.preset.waves.length;e++){const r=this.preset.waves[e],i=r.baseVals;if(0!==i.enabled){let a=Object.assign({},i,t);const s=this.qs.concat(this.ts,this.regs,Object.keys(a));Object.assign(a,this.mdVSQAfterFrame,this.mdVSRegs),a.megabuf=new Array(1048576).fill(0),r.init_eqs&&(a=r.init_eqs(a),this.mdVSRegs=n.default.pick(a,this.regs),Object.assign(a,i)),this.mdVSWaves.push(a),this.mdVSTWaveInits.push(n.default.pick(a,this.ts)),this.mdVSUserKeysWaves.push(Object.keys(n.default.omit(a,s))),this.mdVSFrameMapWaves.push(n.default.pick(a,this.mdVSUserKeysWaves[e]))}else this.mdVSWaves.push({}),this.mdVSTWaveInits.push({}),this.mdVSUserKeysWaves.push([]),this.mdVSFrameMapWaves.push({})}if(this.mdVSShapes=[],this.mdVSTShapeInits=[],this.mdVSUserKeysShapes=[],this.mdVSFrameMapShapes=[],this.preset.shapes&&this.preset.shapes.length>0)for(let e=0;e<this.preset.shapes.length;e++){const r=this.preset.shapes[e],i=r.baseVals;if(0!==i.enabled){let a=Object.assign({},i,t);const s=this.qs.concat(this.ts,this.regs,Object.keys(a));Object.assign(a,this.mdVSQAfterFrame,this.mdVSRegs),a.megabuf=new Array(1048576).fill(0),r.init_eqs&&(a=r.init_eqs(a),this.mdVSRegs=n.default.pick(a,this.regs),Object.assign(a,i)),this.mdVSShapes.push(a),this.mdVSTShapeInits.push(n.default.pick(a,this.ts)),this.mdVSUserKeysShapes.push(Object.keys(n.default.omit(a,s))),this.mdVSFrameMapShapes.push(n.default.pick(a,this.mdVSUserKeysShapes[e]))}else this.mdVSShapes.push({}),this.mdVSTShapeInits.push({}),this.mdVSUserKeysShapes.push([]),this.mdVSFrameMapShapes.push({})}}updatePreset(e,t){this.preset=e,this.initializeEquations(t)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}runFrameEquations(e){return this.mdVSFrame=Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSFrameMap,e),this.mdVSFrame=this.preset.frame_eqs(this.mdVSFrame),this.mdVSFrameMap=n.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=n.default.pick(this.mdVSFrame,this.qs),this.mdVSFrame}runPixelEquations(e){return this.preset.pixel_eqs(e)}runShapeFrameEquations(e,t){return this.preset.shapes[e].frame_eqs(t)}runWaveFrameEquations(e,t){return this.preset.waves[e].frame_eqs(t)}runWavePointEquations(e,t){return this.preset.waves[e].point_eqs(t)}}},"./src/equations/presetEquationRunnerWASM.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/utils.js");class i{constructor(e,t,r){this.preset=e,this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=n.default.range(1,33).map((e=>`q${e}`)),this.ts=n.default.range(1,9).map((e=>`t${e}`)),this.regs=n.default.range(100).map((e=>e<10?`reg0${e}`:`reg${e}`)),this.globalKeys=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy"],this.frameKeys=["decay","wave_a","wave_r","wave_g","wave_b","wave_x","wave_y","wave_scale","wave_smoothing","wave_mode","old_wave_mode","wave_mystery","ob_size","ob_r","ob_g","ob_b","ob_a","ib_size","ib_r","ib_g","ib_b","ib_a","mv_x","mv_y","mv_dx","mv_dy","mv_l","mv_r","mv_g","mv_b","mv_a","echo_zoom","echo_alpha","echo_orient","wave_dots","wave_thick","additivewave","wave_brighten","modwavealphabyvolume","modwavealphastart","modwavealphaend","darken_center","gammaadj","warp","warpanimspeed","warpscale","zoom","zoomexp","rot","cx","cy","dx","dy","sx","sy","fshader","wrap","invert","brighten","darken","solarize","bmotionvectorson","b1n","b2n","b3n","b1x","b2x","b3x","b1ed"],this.waveFrameKeys=["samples","sep","scaling","spectrum","smoothing","r","g","b","a"],this.waveFrameInputKeys=["samples","r","g","b","a"],this.initializeEquations(t)}getQVars(e){return n.default.pickWasm(this.preset.globalPools[e],this.qs)}getTVars(e){return n.default.pickWasm(this.preset.globalPools[e],this.ts)}initializeEquations(e){this.runVertEQs=!!this.preset.pixel_eqs,this.mdVSQInit=null,this.mdVSQAfterFrame=null;const t={frame:e.frame,time:e.time,fps:e.fps,bass:e.bass,bass_att:e.bass_att,mid:e.mid,mid_att:e.mid_att,treb:e.treb,treb_att:e.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY};if(this.mdVS=Object.assign({},this.preset.baseVals,t),n.default.setWasm(this.preset.globalPools.perFrame,this.mdVS,Object.keys(this.mdVS)),this.rand_start=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.rand_preset=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.preset.init_eqs(),this.mdVSQInit=this.getQVars("perFrame"),this.preset.frame_eqs(),this.mdVSQAfterFrame=this.getQVars("perFrame"),this.mdVSTWaveInits=[],this.preset.waves&&this.preset.waves.length>0)for(let e=0;e<this.preset.waves.length;e++){const t=this.preset.waves[e],r=t.baseVals;0!==r.enabled?(n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],r,Object.keys(r)),t.init_eqs&&(t.init_eqs(),n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],r,Object.keys(r))),this.mdVSTWaveInits.push(this.getTVars(`wavePerFrame${e}`))):this.mdVSTWaveInits.push({})}if(this.mdVSTShapeInits=[],this.preset.shapes&&this.preset.shapes.length>0)for(let e=0;e<this.preset.shapes.length;e++){const t=this.preset.shapes[e],r=t.baseVals;0!==r.enabled?(n.default.setWasm(this.preset.globalPools[`shapePerFrame${e}`],r,Object.keys(r)),t.init_eqs&&(t.init_eqs(),n.default.setWasm(this.preset.globalPools[`shapePerFrame${e}`],r,Object.keys(r))),this.mdVSTShapeInits.push(this.getTVars(`shapePerFrame${e}`))):this.mdVSTShapeInits.push({})}}updatePreset(e,t){this.preset=e,this.initializeEquations(t)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}runFrameEquations(e){n.default.setWasm(this.preset.globalPools.perFrame,this.mdVS,this.frameKeys),n.default.setWasm(this.preset.globalPools.perFrame,this.mdVSQInit,this.qs),n.default.setWasm(this.preset.globalPools.perFrame,e,this.globalKeys),this.preset.frame_eqs(),this.preset.save_qs(),this.mdVSQAfterFrame=this.getQVars("perFrame");const t=n.default.pickWasm(this.preset.globalPools.perFrame,[...this.frameKeys,...this.globalKeys]);return t.rand_preset=this.rand_preset,t.rand_start=this.rand_start,t}runWaveFrameEquations(e,t){const r=this.preset.waves[e].baseVals;return n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],r,this.waveFrameInputKeys),n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],this.mdVSQAfterFrame,this.qs),n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],this.mdVSTWaveInits[e],this.ts),n.default.setWasm(this.preset.globalPools[`wavePerFrame${e}`],t,this.globalKeys),this.preset.waves[e].frame_eqs(),n.default.pickWasm(this.preset.globalPools[`wavePerFrame${e}`],this.waveFrameKeys)}}},"./src/image/imageTextures.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{constructor(e){this.gl=e,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.samplers={},this.clouds2Image=new Image,this.clouds2Image.onload=()=>{this.samplers.clouds2=this.gl.createTexture(),this.bindTexture(this.samplers.clouds2,this.clouds2Image,128,128)},this.clouds2Image.src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4RP+RXhpZgAASUkqAAgAAAAJAA8BAgAGAAAAegAAABABAgAVAAAAgAAAABIBAwABAAAAAQAAABoBBQABAAAAoAAAABsBBQABAAAAqAAAACgBAwABAAAAAgAAADIBAgAUAAAAsAAAABMCAwABAAAAAQAAAGmHBAABAAAAxAAAAGYFAABDYW5vbgBDYW5vbiBQb3dlclNob3QgUzExMAAAAAAAAAAAAAAAAEgAAAABAAAASAAAAAEAAAAyMDAyOjAxOjE5IDE3OjMzOjIwABsAmoIFAAEAAABWAwAAnYIFAAEAAABeAwAAAJAHAAQAAAAwMjEwA5ACABQAAAAOAgAABJACABQAAAAiAgAAAZEHAAQAAAABAgMAApEFAAEAAAA+AwAAAZIKAAEAAABGAwAAApIFAAEAAABOAwAABJIKAAEAAABmAwAABZIFAAEAAABuAwAABpIFAAEAAAB2AwAAB5IDAAEAAAAFAAAACZIDAAEAAAAAAAAACpIFAAEAAAB+AwAAfJIHAJoBAACGAwAAhpIHAAgBAAA2AgAAAKAHAAQAAAAwMTAwAaADAAEAAAABAAAAAqAEAAEAAACAAAAAA6AEAAEAAACAAAAABaAEAAEAAAAwBQAADqIFAAEAAAAgBQAAD6IFAAEAAAAoBQAAEKIDAAEAAAACAAAAF6IDAAEAAAACAAAAAKMHAAEAAAADAAAAAAAAADIwMDI6MDE6MTkgMTc6MzM6MjAAMjAwMjowMToxOSAxNzozMzoyMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAACoBAAAgAAAAuAAAACAAAAABAAAAgAIAAEgAAAAKAAAA/////wMAAACK+AIAAAABAL8BAADoAwAArQAAACAAAAAMAAEAAwAmAAAAHAQAAAIAAwAEAAAAaAQAAAMAAwAEAAAAcAQAAAQAAwAaAAAAeAQAAAAAAwAGAAAArAQAAAAAAwAEAAAAuAQAAAYAAgAgAAAAwAQAAAcAAgAYAAAA4AQAAAgABAABAAAAkc4UAAkAAgAgAAAA+AQAABAABAABAAAAAAAJAQ0AAwAEAAAAGAUAAAAAAABMAAIAAAAFAAAAAAAAAAQAAAABAAAAAQAAAAAAAAAAAAAAAwABAAEwAAD/////WgGtACAAYgC4AP//AAAAAAAAAAAAAP//SABABkAGAgCtANMAngAAAAAAAAAAADQAAACPAEYBtQAqAfT/AgABAAEAAAAAAAAAAAAEMAAAAAAAAAAAvwEAALgAJwEAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAElNRzpQb3dlclNob3QgUzExMCBKUEVHAAAAAAAAAAAARmlybXdhcmUgVmVyc2lvbiAxLjAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAMgAuQC5AABqGADOAAAAgE8SAJsAAAAEAAEAAgAEAAAAUjk4AAIABwAEAAAAMDEwMAEQAwABAAAAQAYAAAIQAwABAAAAsAQAAAAAAAAGAAMBAwABAAAABgAAABoBBQABAAAAtAUAABsBBQABAAAAvAUAACgBAwABAAAAAgAAAAECBAABAAAA9AUAAAICBAABAAAAuA0AAAAAAAC0AAAAAQAAALQAAAABAAAAaM5qp6ps7vXbS52etpVdo/tuYZ2wtrDFXnrx1HK+braKpineV1+3VFWVteo72Poc/9j/2wCEAAkGBggGBQkIBwgKCQkLDRYPDQwMDRwTFRAWIR0jIiEcIB8kKTQsJCcxJx4fLT0tMTY3Ojo6Iio/RD44QjM3OTYBCQkJDAoMFAwMFA8KCgoPGhoKChoaTxoaGhoaT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT//AABEIAHgAoAMBIQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AOdCcU4R11HMSLHTxFTAXy6PLxQIUJTglIDo9KtbWzjScNvnK/gtao1FkycjaO1ebWvOWvyR307RjZfM5zXoraacTW3DtkyD1PrWathui39q66cmoK+60OacU5O2xA8ZQlT2qBkrdfmYsiZMUwpxVCImXNRMntTERlaaRg0CN5Y8iniOszUlWOniOgQhj5o2UwDZS7KBFmAuoCnIAq69wUjIHPHWuaok5HTBtIqrbzXCMyAEDqCarPvGV6Yqlbb+Xch337kBTOd1RNHxgCrc+xKgNWAPxyD2qCWMAY7g81UJ83yJlGxCy4qJlzWqMyMpTClAjoxCUbDCniP2rK5qOVKkEdMA8ummPmgA2Vd0m1S4vMTIXjUEtjtUzdotrdLQcFeSXQfcQqJ2y/GaZL5fkhE5Y9TXPFt2Zu7K6IUinVWVW+XvjvSNCsceScsa0k1067kRT69NisY8mnC2YoWA4qL2KtcglyjcVVdd78daqnK3zImr/IheFgTkdKiZK6ou6MJKxGyUwrTJOxmjaS2WYqwjLHbnp9KBaeeB5MbZxzXLGVlfotzpcdbdXsQiKniOtSBfLppjoTE0NMdPiYxElSRmiSurAnZiSMTzmmKSDmpUdCpS1NvT0TUoHEjpGQcYC8n3qM6MJdxgYuF46VyyfI2ui6nQlzJPq+hDPo0qcKNz/wB0U54Es7co/wAzkcgdAamU01ZbtjUWnrsjDn+dzxiqpjYHK1aZDHJGQmM9ahe2zk+lbU5WZlOOhWZKjKV1nOddYTPLpptjztbcB2NTBXibaSUOOma4IWt+h2y3/Uj8rmlEdbJmLQpTjpTNlNCYnl00x1RI0x00x4oARd6tmPIPtW1o+uf2fGd+GORlcdffNZVaaqRt1NKc+R36HQxWsWoqbmGQ/MMkg4rL1bSdi5UV5fM4ys9LHfZNXXU599Lkd+FNMbSzGPmHNb85lyFaS32HgUx8pGcqK2g72M5aGY8fPSomSvRRwndafZfYtRCzL8rHFaPiPTTHKlxHGEjKhTj1ryKU/wB4uzR6dSPuPujF2YIzTxHxXamtuxyNPfuIY+KYY6okDHg4pHQIMsQKLhYhV0dtq8mr6aQ8loZRy390DNZVKqgr92aQpczKcd8+nXefLHAwVI6028nt7mTzIY/KJ5IB4qI3UuZO6fxIuSTjy21WzLmjXs9rKFidgM/dzxXTJeRECC5ZN5XPWscVTTlePxM0oS0s9kUriaIEiIKAPzrFup/3uBzmopU3fUqc0isTEQWftVWZ0dPlWuqNNr0RhKafqzOlh6mq7x12RZytHqssMcwSfy0wwyDuxRq2oCew8gxjdx1HT3rx6Uby9GenUdkc/wCSpPzdaV4WVeFJru226nLv8iFVc/eXFKYsCqi7omSIjHzS3EKSRZBJbHNOWwRMp4WjO/O0Z4NWUubuGParnafSsXFS0ZonYRo/Pwzcmk8gL0FbQgkjOUncfFK9sSU4JpkkzO+7Jz9atRV7mbk7WHpczAcOT9aUqzgu3Ud6lxSd1oylJvRkMgDZJJzVSTK9KqKJbIGJqJlzWiViG7nfW1/ZK8XJUDqT0q9q08V2sRiL5HAG35SD3Bryaalzps9KduWyKt1pjWoXzG2uRnkcCs+8ee2YKJUbIzx0Iq/bXemiRPs7IY15Ey7m+TA5BrPuNUDIyCMDnhs81rz3SsZ8tmXbFDe2DTKVzHwyk8n6Vl3944Zo04A7jvT9pp5oOTX1Mp5GVsnmtG21aEQKkikFRj604SFKJOmpWrHAYr9RUjMGXKcg9xW0WmYyTREwNN281qZkqphQRwacCMYPHvUPUpCPGhXORmqU0fNEXqEkV2j9qjKVoQa+GAALE47VPDezRYUOdo7V5CkelY0pb+eayOJt4PG1uSKxpEkQkkmp0T9StX8hnm5GCM1GUBzVXsIj+deFYge1NMTueuapyJURr2jMvTmqclq4PK4ohMJRIhGwNadgLolUjDMvcVtz217GfLc2PsuSQQdw7Uw2pU/MCK6FU6eWhg4afmWLeKFkZJcg9mFRzac8MSyMRhumKnns7PZvQOS6utLblaRMLyR9KhkhVVBDZzV21TFeysVXWoiK1MjttV8O/YWyXVgegFZRsTu4FeHdp2e63PWSvqupZtrbadpHFPnst4xgVDlqUkUX03ax7VEbNd3ByapSbFYDYKw4PPpTv7LdT0wRVq703J0XkBtlU7Sy7qje1yMMtJpoaaZWbTCZOB+FdVo+n/ZrRXaEh/pwacptxEo2ZZfRBLmQNskY8g1lXmm3VsS4IZaaxDvZ9NifZK35mUZbp7odD6jGK3jcotogmgUrWsp3tZ2sTGO+nqZr3Flco6JEEdc7eetLDoElxEH81Vz0FbQrOEby9530MZUlJ+7ppqOOgRxDMrqcdumaqz6Xa55YJnphqaxE5PRadgdGKWr17nd+cl4VFzGHAq0NEspRuRNp9K5vYxm3e6b2ZvzuK027CroNsPvLz6iql7oICFkOQO1RPCuMbp3a3Q41ruzWj2MG604xZJrInQoSVHPrXPB3NZEYlm6bM0gup0+SQttPXmt42W25DuRTW7ht6qXX1qxZSSSttZcqPWrjJPfXuiWrbGgFiADHBxW9p1z5dv8AvW3J2B7VbUeXuQnK/kM+0SyTt5GSg/ic8VUv7xpodrDn26Gs5wj0+LqXGT67dDFWLEhfkGo5nklyrE4qlC9vwJcrFRbJVl3GtO1njhTqQR61u4StYyU1civ7sSLtAJ981kSLnPJrelHlRhVlzM7yLTdTtJuu9Qe3NdBbGUorMFJxz2NcFPnUrWO2XK4lsdKCARg13bmBSurCGU4aMtn0qjJ4Xt3YnP0GK4pYbmk+X3bGyq2WvvFKTw5IpIRAR61Fc+Gttvvfn1GOlYeynHVq1uprzxfzKcCW1mdroXU8YIqQR2KA7AxPUgDGKiz3TKutjPnjic74jtB9TzT4p58Bc7yOm6tItrfoQ0mWEubtZf367l7DtUqq1w24gKg6kDpW0FFrm7Gc207dynKqqzAoOehFVmhLdFJ/CumKtuYN9gGnzuPlibmoXs5VJBXkH1qlVjtdEezlvYimtJEXLow/CqErIDWkZp7WZEotbnrsTkjrmphz1rGDutdToloxaK0EMkU9VGSKRDIQd4A9MVm+ZS0+F7selvPoNDuHw3T2oJWUlWH50r3Vn1HtqjG1LSmVS6DdzxxWQ+nTSTcghjXBKPs3Z/I6IvmV/vK7aWYptsp2jua0LG3tllLQZkK8dO9C95227g9FfcmuFnnUrtyF9BUthHhfLkjO0n14zXToo2WhiruV2JqFtFGNyxoSPUVztzrdzBJhdoVewFZJ8zs3dLY0a5dVu9yCTxLKUPyDd2NZE+tXDyF84J74rSMEiJSbKFxqFxMpDyuQe2azpN3dj+dbRlbYzkr7nvCJkYxsP95eDUqxyA584t7EVnTi+j5fLoaSa66+ZOM45orqMgooAYwqNhis5DQ0yMBio2Zm7ZrNu+5VrDNizPsdFI9CKjNrDCuEiCZ6kcVlKEd7fMtSe34DY2jV8YKknvzTLqUQcs+PwqJuyuVHU5TWtVeaX5coq/dGaxpLxpUw4zjvRFKwSepAF85SUGcdRVeaJh/DiqvZ2JsZ86sDz0qBo2xu/hq0yLHvy9KeK2pkvcdRWogpM0AIaYwqJAhNq1FcPKoHlIHHesZNqPu6vsWtXrou5HuK5YLzjjNZ1/c3YiIUZX+8vauec36LqbRivV9DNivriYlWOdo6HmrxleWIBgDx3HSpaugvZmDqFuWYgwKSPQVlsjxIym3BUgjmoXa+xT7lSOzd3PkAq3YZpby8vVASeNendBzWukt+nUz22Jo7S2v4A3lFGxzg1Rm0l4m+UMVPqKlSa03Q2k9T/9n4qqwQ2C6FUcJKhVwpbQ1vCsihOUlK0km1lS0VoSE2qiF4TrpDJE0aZJK5EgBF7pQGeoyWHrHyLxlrwklpeaZbWWmyFkkIa43/2P/bAEMAAgEBAQEBAgEBAQICAgICBAMCAgICBQQEAwQGBQYGBgUGBgYHCQgGBwkHBgYICwgJCgoKCgoGCAsMCwoMCQoKCv/bAEMBAgICAgICBQMDBQoHBgcKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCv/AABEIAIAAgAMBIgACEQEDEQH/xAAeAAACAwEAAwEBAAAAAAAAAAAGBwQFCAMBAgkACv/EADcQAAEDAwMDAgUDAgYCAwAAAAECAwQFBhEAEiEHMUETUQgiMmFxFIGRFaEjQlKxwdEW8ReCov/EABsBAAICAwEAAAAAAAAAAAAAAAUGAwQBAgcA/8QAMREAAgEDAwMCBQMDBQAAAAAAAQIDAAQRBRIhMUFRE3EiYYGRwaHR4QYU8BUjMnKx/9oADAMBAAIRAxEAPwDNEamJCR8v9tT4dJ3Zwn+2rSHStzaVBvOrSDShnBTpvDYpbIBqsi0QKRn0+QO2uwpJQQCjRFEpR8D+2uj1LIXjb/bWwfmtNvFDqaWE/LsHfXZFNB/y6uVU75uUjj7a6NwMfMEfjWd3Fa0f/DB0mtK7KpIum8KgUxqQ+0pmE2EqMlzOQFA/5MgZ/J1q2L1glUxsPtIbbitNpW80EgbwSO+PGsWWjUqhRZy/0Tqkh1OFgH78aaKLzm0i28SnlLddYwk+wGdJH9QafJd3QLtkdh4802aNeRwWxCjBHU+aA/iosex//ktysdPnN8SpAOymM/M1IUo7/wD6k8jS8uTpxPthCJL3yuJSFKGOwPY50wavS7gnU3+vro7i4QXkyA3naoc86FrhnVGqpQl1SvTI5QVZzycHR6zkmiiSMvkLwSevtQe7WJ5HcLyeRS/q0BHqLc9NIKjyB50Pz6cEkkj+2j2qUlDRWfrJSQEgdjqqRbKKkVMJe2uBO5KSngn20SW9t1OC1DjaTsMhaBKhBCWt23A841QVGnBaiQ3n86O67TGWigR1bsg7hjkHPnVFNiJSgpIyc8DRBDxVRhjigmVAAP041CcaW2rcgYI9tE82n5PCedVkqAUkgJ1uQDUXfFaZplIUMsqb2kHke2rGNSylf0g8+2j2rWvRZtbjvxXY7EV14tuymdxzknCiD9hnge+oU+110+WtoLS4hKylDiBwoe/+2gkVysgB80akhZCQao4lMCk528jXRykKJ3bfxq8jUopABT31KXSRn6NS7sVFjihNVM+Y5T24zr1FPIVt26I3aUoEkA9+2uCqaUuDKdShs1oQM0bVvpPAtizaDUKLKVIVUYaZcxTrQSpl4jBQPOE/7k6rK1QUU213PUmJVLeWG4zTSgoff8Ht/Op1239WbjjNqqMgKDLKW0hCQkAJAHYceNC8aprVNbW+nKErG7nxnnGlyG3vJcvIckHP8f4KNyz20QCxjqP4rlFq98KoZs5ptxmKuQQ4kZBK/PPtjx21U3NbopREMhKlgfOQex9taAhdK3uofT7/AMo6eUh2PBElXqOyn0bFKT9XJOQRuHccg6BKn0RvByUUyqI+pxbZWnCchSQcZyOMZxzqs97E5IwFweR3z86nS0dFByWyOD2x8qULduuOOfIwVcZOBquqaEUV9t1EMBQz3HjTz6c9OpUibLl1aKGIsMelIekfKncoHAB8nj9tK/qfDpiqu9Hp3KWyQCR3++q7XStcel4FSiAiLf5pTVmEhcl1aOQok8e+h2bTVBZJGD99HAYnQZKxCYSXHRt3LQFAZ+x17XBbjT0VpLURKNqcFwJ5Ufvpms9VUuEfvQC609gpZaWMqAcnjzxqslQwBx+2jGr0ZyI6WHmsKx/OqaXTu4KfxjxpgBDDNBDuU1t2HUKReHSW0yqB6D9NEhh+Q0jIWvcFBC/bgkhX3I8al1mQ5ULdj0gUeKw2zIW6hbKDuJICeSSf9I0c/Bn0Pi3xcL1o1iSmP6chKz6qcjaPlPB78Ej99D9etp63K1OtySfUMSU4zuAwCUqIz++Nc70q8huB6SHLJz9yaeNQt3hbe3Rhj7AUJMUc8fJru5S0+n9HI99EcOkFxO5ScY9hr2k0hIbPy+PbTCX3UEA2mg1ym7gfl51Hk0rCdwbOilVLUkkFGvC6SVEkI/IOrAkAqBlNBbkJQQQnODxqK7TFIPKNGTtFZS4d+AAMnOvU2dPqEN6bAhuuMxwPWdbbJSjPbJ8aw9xFEMk4FeSOSQ4UZqNY/V26LLpj1qR5CjT5K8uhP1oJKclJJ4+ka2DZLVgdROlbVDtKII9wohsKeDxG8Mn/AD4BI2naPPdWsxdOennSm511K27kulcCqlgKpUpxQ9FSwPpV7A++ovTq+Lw6IdUGJcSWmQuG56DjbUrc082T9IUONvn/AI0rana2msB1tjtlX4vG79x2/wDaYLO4udM2mcZjbjzinj1f6PXNEtfDtIYjts8+nETj1FEY3qz3JwNZJvGw566u4n0FbiTu419Ird6o2r18oaWnIiYr8mKlT0dXdteSCArGCMAY/wCNKq8ehtl2tMcl1LY8+SpSGkjsOcE/9aRrbULm0maKZfiHamiW1huI1dDxWGHOmU9tkPyIpSM5STqGKHBTIEea2VJB5GtFXzCob812AkIbUjgADHGgWo9OY7Sf1jrjYDhJQpRxxpktbidjlxig08MSjC81nbqPSKe3Wj/Twop9IbwrsFew0HzaeE8lPfTav+22WqissELUSd2DxjQRVKQGx8qPyddMsJA1qgz2pDvEK3LH519dunnRiPZfXiDc8OoxUU1x8IdUy6NqwrIBx3wSM6B/jNsG2aZ1fdlW5LbWJ0Rtx5pAyW1425J7HIAOmjYxrN8yqTb9UoEanKXT0h+ey8lTrxGcKScZRn2PnzpWdXKVKYvqo0559+U7EfLSJMiOW3HAnspSTnx57Ec65F/TyYuid3IGDjx710nV2zAo28Z/X2pVU+2JMJrZIVk9xrg6xDkLWww8lS0n5kA8jRo7NtiAwpF0SVNEK+YIQdwGq9u16ImOzWqO8l1qWne24MHI/wCD9jpvhugGEakEDrzS/Lb7gXYYJ+VCS6c5HUHkJ+dJyCR2OudJpEya86zGirce27m/TTnGOSSPbV7dM2FRkw0uOMqEuQWfkeSVIUMd0jkdxqM4HqK8qR6oZ9MEOlRxgeQdXBcJIp2HmqZt3jcFhxShvufX6ZWQuS84SlZJaSOMZ9tMzpz8RVmUmy5do120UuNPJBSyklG5eACSR3yB2++ll1F6rW69WZKItHTIUUFDD7rpGxefqwO478atrNtyFeVoR6o84gPeotC1NEDJB4PbQie3W/X02PGc9aKRTf2R3gVUXJRH59xuVSgRzGZcXuQ2CcIB8DXWHClMOIdlLKlA5yfHPfRk1bbkOElp9e5aBtzjwO2qmpNMxspTjPuPGjVnZpGB5FCLq7eQkY4o+HXyRYtowaBY4ALMlt5ySpeVhSQNwPH0nAI9hka6TPiakXWt2Rcqn23HUkrDaApJXwMjz7/zpRyWSpzcPOplOghLaHZLSi2VYCgNYk0PT2G5kyx79+awurXoOA3HjtVjWqgqq1FdVUVqbWCGyDhQOPOhK6KnV3VoVJdWG0AhAHkaNJUQrpbcVLSAVnd6iOVHuMaFrnp0tpKv1BJUgYIOpLeKFTtA6cVFNNKRknrzQLV5sV1agWjz/mPfQjVYSFLUWxx4zorqsBwun5cA6qJEEkH7edGIY1iHw0NkdpDzWvLB+KW9rXr0OpN1x55tbXpTQtsbkoOAQkqBwQBweccadHTfrT0wrFz1K5ruuWfOcl00x4s2SylTsde0JCl+OEgpBHP2GsvVG0ajCfUw7CIKDjKRqw6eyKjb9cbdMcPNKc2vMujhSc9jri6Tw+myrhdwwSPFdSaNyyk84OaPut/WO1oTkuzG6PFmul8LYrDBO5SMHIVu5UVcfg9u+l1Gvup0+lLRb0v/AA8ENtvEkNk8naNEd4dNl1J1+tNx0oU4srS0Owz4GfGltMo1VgTDGfWpKEqzwO+orW8WIARtgit5oC+d65BoaqIqqpSprkle71crKlHg50fdVevFq31ZdPt+NbyoU+PT249RloUNstaCT6pAAwo55P2Gh1+lSnt7CmS5nJScarUWstThbciFWOT8vYaIJqWcFjyPzVVrME4A4oErdLE1tamV5JOQfY6pqZeN22Sp1mkVd5lLowtKF8HTjh2HBfaSEIBJByPbQ/cnRhLzS5cTJOSSlQ7a2ttYEUmCaxNp5kTIFD1rfEHekScluoTjKaUseo2/yQnzg+NNinTqPdba36FN9cJA9RJGFJJ5wRpNW/02nTa81SGYpLrrwQkbfJONao6f/C3UunPTxd5Sn1LefdQlUb0+R3IP8aY7bW0jnRC3/LigdxpfqRMwHSl2/RH23Ni2SD7EauaRa1RlUaRLjxS4iMAp7YeQCcZx5AP8Z0aVyg0RgNvSZxafWfodSBzjjj+PxrzRK43aFX/Rwq9CccqLKmlNMvhRJIKcKT7j799GG1ZJIvhI3ePahY0x1k+LO3zS+juvtOBpvCcqHJAONV931CVP+R2GhWVY3oRjb/Gn51R6ET0Uin1i0LUHomIgyW2RvWF4PJH1DPck+4xxxpS3ZR61Zlddi16gNtnaU+m4nKT9xrW3vYL0BoSN3jIzxWJbSazOJQdv1xSlrFLbSokg5OqWRBSXDuIH50dVKmVCrOLMOEpz8J7aoa9Z1w0Vaf6tRZLBcA9NLjJG7PI/9aPRyDAVjzQhkJOQOK+lfxU/DzTVXM2enFkf4D6C4+7FbKxu85OcD8AaTUH4erjaeLrNGcSsKwpBbP8AbWtOiV5zKnVG00SptyUrOFpS8FA/YjPGnW3QrdrITOcpLaXQQTubwQR7++uKLok12zehIBz0I4x8iD+mK6h/qKQKokQnjrnmsCu9MJ8ajpZqNLWktpwoKTpe3TZtDZlrUI+1e3JCm+M6+md1dN7VuuCqPPpTW8NkNrQkAg447ayz1t6Ff0FMh5qlrKjnZhPnGhGqaZe6RIDL8St0I/Pir9nfW98pAGCOx/FZFbpkB2oKQ5BbbU2rAUrhK/tqxj2pa8qQp+tPMw1hISyMEpd57HGcHnPtgak3h0/uKbP/AEkeI6CFH6UEYOqef0lvNcb1XZDoWk7kJUrnOtreSHgsRXnVyOBXpd67Jst8xKdHMtfqAKLY+VQ8lKh3/OuUe2oVxRjPpAzv5LDn1t/Y++ulF6e1y9YZtp9paKgw5hlwpJ9XOePznU/p70tvqgXO8K3EfZEMFBTggLXgkDH7dtEi9hM2w4WqoFzGu5cmudk9B4NWvmImcoRGluBTkoJ4SnI5/OtnMdO2rdZgVKt1mNJgtsJERQQPTkYCRtxyO2SSeTu1nqk3TETV4dKVFTGUtwpkGQsJSnHPCjxp41S9alWbWVY1syI7UVhLf6mXJeAbYHOTvP8AqHAAz286llsrV1TEmfwKhW5uFZspj8mqjq58PfTe6KC7Vo8KNGU2hS1ORlggr5OMDkcax3UulMFfUVuO5MUhppe5DxPbHOONa2u2NVKBSlMUCVNkMuR0plPvpAaWvn6M4OPzpL1C3pcOovOymwXSFbVBOdufI/71pY288UpEDllPT81m5nieMGVQDUTqj1OrNm2221bF3PrdRGLLxaePJ5899DvTLqJROq9VpznVGC++mG2WnGwCQ8rOAT5z7/jXpUbcW+46mpI3kqyk9+NelvvtWe4h2nx0ZQ4CpJT3HnTFp2n3CpvHXnnoaDXt/AW2k8ccdRTerNsdGbepiq7SbPZSQz6qmxFUSkHt4IHP99KK7OtdlxnltsUKS4VEpfadOAMdsfcHVldvVKtVOkriQ3VRy4r/ABdijhQHYY8aUldil1TinkBSl87jotpmj78tdkk/9iaGX+rCMhbYAD2FfTe1PgzqHT+7UXJatwF6M1IC22ivDm0HI5Hn99Puh0+RTssKqLzzeMpTJBKk/bJ1CtaWzMbJizUOBBIWE5BB/BAP76vmySnn++hul6faxH14iefnkfT5e+aLXl1O/wDtv2+VedVdx04TlMtoajFS1FCvXZ3ZSe+PY41aaj1GK7LjlEd703ByheOx0VuohNAVxmqcTbJAaD698P3TisQZDDVDbZfeOQ+ngpP/AFoJY+Du3xUkzKrLalsDOWcFOD+f402Y9MqzVLdaqNS9V8kltxJIIGOBqPGl1OBGcDzO9RPClL57HQKXR9JkZXaDZx24+4HFEEvrxAVWTPv+M1k7qf03c6UXG5Kt+2W3S0slmSpsgd+/PfA/31VT+rw5XV7Tgxqi9HLzsh5IWXMA4wk8Jz/61qfqf0ypfUSkqnMtgzWo69iSTySOBrOVT+Fy8H6k2xVqTIbS4fmf2ZShOlG+0xrOUqyZU9CBnj+KN214J1BBwR1FI+5axbN0SRL9L0pTqgXGkNYQhWPA0QWv0pvrqJRAqgz5amow/wAJv1fkGMnsfHJ0Vv8ASGj9La+5Vbzt+XLisglpLUc7XecABXj8nTHoTFTdsaIbcguUlh0BSWW1J3ZcAyFecD/nWbRTI/pxnbjz+1YuJPTTe4z7UtbWoF2XPOYtepy1L/TIUpwOOhKUJQMq559j/Oqu+qXW4tYcRS6bMQzKQENMrQcqTjgcDkeR9tN+2enl4Wncypj8OO+AMu5SpaCnIzyPOrvrrU6bS7f/AFKKm1FfWgpSoqSTvxnA9iNMM+orZlSoDADH17mg8Nm90DklST+nYVmdfQq/6q4hX9CDKXRu3PvISEjPcjOf7Z1X3T0BlW/SHKtU7jhD0nQhxDIUoJ9yTjxnwNBV/dYep9r3K8+xXpYCuEoWtQBTnjH2Ol31P+IPqddDCI8utO7UIx6bR2p/cDv++rKanqbspVlA9v3qBtPsVBDBif8APFMWtWPSqdTnahIuultpwfSbmv8ApKUARhQye2Of20lbs6o2bDkriqrsJWxW0rbVuSr99ANzXLXZ29dSlur+XlS3CdLyvRW1rWsOg55I76MWupyoT6jbvpihtxp8LD4Bj61/RJHoRq8ZmNWFvJWyrcxIjultxP7juNXdEoJouRFqT7rSvqTJXuOffOvaIT6YBJOBxnU9ogpwBjVbTrSDAkxyMc9/5q7NcSOSvbxXtr9r9r920ZqrXhYBSQdQJjQIJx+dTVup7ajSNqknPtqCcAx1lTg5qllPvxcltwj8agSnqpIQSEuqB7nB51dqYjlRLo75BP2xquu+ZckWnoNqw0StqgH2lOYUUeQPzoHM/pRM7E4HYDJ+1EEw7hRxnueB96rabFcqrkmPJa9UNoBLK+x+bng9+NU9woj0+Utb1vtObAMteiR6ae+5I8du+plWqFah0t5VKbEV1xW4uuIO5IA4Bz986z71mvbqpRbmTUaqX429sNhyO4r03BnIWOfIxn8aA3N9CsigDnyen3olFayFDk0665W4Eq1v69HlyC00raWmlBSkKzwSPtwceQdYw+L3rDWLhqggJQ41FiI2RcnBWc/MtQAABJ8eO2tAWXcl2/p3WX3S4pwpVuWySl3I/wD1pQ9erfrM2c+0i3I8sFBcQtMTkI7c7e3PvoZNcPHcCQjj371aiCPGUB5rLNfviqyKYiTU2VrbQdiXHBnIz21CqNq1WpwUzaPDMhtxsLCmkZwD747aOLwgXNHt522avZjQiLWHEEp+dsDcBt9uSM/jVFRLZ6vWBSZF2dNHZSIzzKm5jbRStSRzwUkHgZznHfVxLkyLxgH9DVdo1j6nIpK31QaoylfqMEEDCgBoHl0OU7HVUm2VpS3wpvGc8d9ak6WVGL1IdnW51Ht6NMmuO+ozMGGHMEYKSBhJAPIOO5OfGqC//h1doNVcnUOnThGUopKS0HAoc9iO/wDHjUqak0bGNxz+lQtbK3xrX//Z",this.emptyImage=new Image,this.emptyImage.onload=()=>{this.samplers.empty=this.gl.createTexture(),this.bindTexture(this.samplers.empty,this.emptyImage,1,1)},this.emptyImage.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="}bindTexture(e,t,r,n){if(this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,r,n,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}}loadExtraImages(e){Object.keys(e).forEach((t=>{const{data:r,width:n,height:i}=e[t];if(!this.samplers[t]){const e=new Image;e.onload=()=>{this.samplers[t]=this.gl.createTexture(),this.bindTexture(this.samplers[t],e,n,i)},e.src=r}}))}getTexture(e){return this.samplers[e]||this.samplers.clouds2}}},"./src/index.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i})),r("./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js"),r("./src/presetBase.js");var n=r("./src/visualizer.js");class i{static createVisualizer(e,t,r){return new n.default(e,t,r)}}},"./src/noise/noise.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{constructor(e){this.gl=e,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.noiseTexLQ=this.gl.createTexture(),this.noiseTexLQLite=this.gl.createTexture(),this.noiseTexMQ=this.gl.createTexture(),this.noiseTexHQ=this.gl.createTexture(),this.noiseTexVolLQ=this.gl.createTexture(),this.noiseTexVolHQ=this.gl.createTexture(),this.nTexArrLQ=n.createNoiseTex(256,1),this.nTexArrLQLite=n.createNoiseTex(32,1),this.nTexArrMQ=n.createNoiseTex(256,4),this.nTexArrHQ=n.createNoiseTex(256,8),this.nTexArrVolLQ=n.createNoiseVolTex(32,1),this.nTexArrVolHQ=n.createNoiseVolTex(32,4),this.bindTexture(this.noiseTexLQ,this.nTexArrLQ,256,256),this.bindTexture(this.noiseTexLQLite,this.nTexArrLQLite,32,32),this.bindTexture(this.noiseTexMQ,this.nTexArrMQ,256,256),this.bindTexture(this.noiseTexHQ,this.nTexArrHQ,256,256),this.bindTexture3D(this.noiseTexVolLQ,this.nTexArrVolLQ,32,32,32),this.bindTexture3D(this.noiseTexVolHQ,this.nTexArrVolHQ,32,32,32),this.noiseTexPointLQ=this.gl.createSampler(),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.noiseTexPointLQ,e.TEXTURE_WRAP_T,e.REPEAT)}bindTexture(e,t,r,n){if(this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,r,n,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}}bindTexture3D(e,t,r,n,i){if(this.gl.bindTexture(this.gl.TEXTURE_3D,e),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage3D(this.gl.TEXTURE_3D,0,this.gl.RGBA,r,n,i,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_3D),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_3D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}}static fCubicInterpolate(e,t,r,n,i){const a=i*i,s=n-r-e+t;return s*(i*a)+(e-t-s)*a+(r-e)*i+t}static dwCubicInterpolate(e,t,r,i,a){const s=[];for(let o=0;o<4;o++){let l=n.fCubicInterpolate(e[o]/255,t[o]/255,r[o]/255,i[o]/255,a);l=Math.clamp(l,0,1),s[o]=255*l}return s}static createNoiseVolTex(e,t){const r=e*e*e,i=new Uint8Array(4*r),a=t>1?216:256,s=.5*a;for(let e=0;e<r;e++)i[4*e+0]=Math.floor(Math.random()*a+s),i[4*e+1]=Math.floor(Math.random()*a+s),i[4*e+2]=Math.floor(Math.random()*a+s),i[4*e+3]=Math.floor(Math.random()*a+s);const o=e*e,l=e;if(t>1){for(let r=0;r<e;r+=t)for(let a=0;a<e;a+=t)for(let s=0;s<e;s++)if(s%t!=0){const c=Math.floor(s/t)*t+e,u=r*o+a*l,h=[],d=[],f=[],m=[];for(let r=0;r<4;r++)h[r]=i[4*u+(c-t)%e*4+r],d[r]=i[4*u+c%e*4+r],f[r]=i[4*u+(c+t)%e*4+r],m[r]=i[4*u+(c+2*t)%e*4+r];const p=s%t/t,g=n.dwCubicInterpolate(h,d,f,m,p);for(let e=0;e<4;e++)i[r*o*4+a*l*4+(4*s+e)]=g[e]}for(let r=0;r<e;r+=t)for(let a=0;a<e;a++)for(let s=0;s<e;s++)if(s%t!=0){const c=Math.floor(s/t)*t+e,u=r*o,h=[],d=[],f=[],m=[];for(let r=0;r<4;r++){const n=4*a+4*u+r;h[r]=i[(c-t)%e*l*4+n],d[r]=i[c%e*l*4+n],f[r]=i[(c+t)%e*l*4+n],m[r]=i[(c+2*t)%e*l*4+n]}const p=s%t/t,g=n.dwCubicInterpolate(h,d,f,m,p);for(let e=0;e<4;e++)i[s*l*4+(4*a+4*u+e)]=g[e]}for(let r=0;r<e;r++)for(let a=0;a<e;a++)for(let s=0;s<e;s++)if(s%t!=0){const c=a*l,u=Math.floor(s/t)*t+e,h=[],d=[],f=[],m=[];for(let n=0;n<4;n++){const a=4*r+4*c+n;h[n]=i[(u-t)%e*o*4+a],d[n]=i[u%e*o*4+a],f[n]=i[(u+t)%e*o*4+a],m[n]=i[(u+2*t)%e*o*4+a]}const p=a%t/t,g=n.dwCubicInterpolate(h,d,f,m,p);for(let e=0;e<4;e++)i[s*o*4+(4*r+4*c+e)]=g[e]}}return i}static createNoiseTex(e,t){const r=e*e,i=new Uint8Array(4*r),a=t>1?216:256,s=.5*a;for(let e=0;e<r;e++)i[4*e+0]=Math.floor(Math.random()*a+s),i[4*e+1]=Math.floor(Math.random()*a+s),i[4*e+2]=Math.floor(Math.random()*a+s),i[4*e+3]=Math.floor(Math.random()*a+s);if(t>1){for(let r=0;r<e;r+=t)for(let a=0;a<e;a++)if(a%t!=0){const s=Math.floor(a/t)*t+e,o=r*e,l=[],c=[],u=[],h=[];for(let r=0;r<4;r++)l[r]=i[4*o+(s-t)%e*4+r],c[r]=i[4*o+s%e*4+r],u[r]=i[4*o+(s+t)%e*4+r],h[r]=i[4*o+(s+2*t)%e*4+r];const d=a%t/t,f=n.dwCubicInterpolate(l,c,u,h,d);for(let t=0;t<4;t++)i[r*e*4+4*a+t]=f[t]}for(let r=0;r<e;r++)for(let a=0;a<e;a++)if(a%t!=0){const s=Math.floor(a/t)*t+e,o=[],l=[],c=[],u=[];for(let n=0;n<4;n++)o[n]=i[(s-t)%e*e*4+4*r+n],l[n]=i[s%e*e*4+4*r+n],c[n]=i[(s+t)%e*e*4+4*r+n],u[n]=i[(s+2*t)%e*e*4+4*r+n];const h=a%t/t,d=n.dwCubicInterpolate(o,l,c,u,h);for(let t=0;t<4;t++)i[a*e*4+4*r+t]=d[t]}}return i}}},"./src/presetBase.js":function(e,t){var r=1e-5;window.sqr=function(e){return e*e},window.sqrt=function(e){return Math.sqrt(Math.abs(e))},window.log10=function(e){return Math.log(e)*Math.LOG10E},window.sign=function(e){return e>0?1:e<0?-1:0},window.rand=function(e){var t=Math.floor(e);return t<1?Math.random():Math.random()*t},window.randint=function(e){return Math.floor(rand(e))},window.bnot=function(e){return Math.abs(e)<r?1:0},window.pow=function(e,t){var r,n=Math.pow(e,t);return r=n,!isFinite(r)||isNaN(r)?0:n},window.div=function(e,t){return 0===t?0:e/t},window.mod=function(e,t){return 0===t?0:Math.floor(e)%Math.floor(t)},window.bitor=function(e,t){return Math.floor(e)|Math.floor(t)},window.bitand=function(e,t){return Math.floor(e)&Math.floor(t)},window.sigmoid=function(e,t){var n=1+Math.exp(-e*t);return Math.abs(n)>r?1/n:0},window.bor=function(e,t){return Math.abs(e)>r||Math.abs(t)>r?1:0},window.band=function(e,t){return Math.abs(e)>r&&Math.abs(t)>r?1:0},window.equal=function(e,t){return Math.abs(e-t)<r?1:0},window.above=function(e,t){return e>t?1:0},window.below=function(e,t){return e<t?1:0},window.ifcond=function(e,t,n){return Math.abs(e)>r?t:n},window.memcpy=function(e,t,r,n){let i=t,a=r,s=n;return a<0&&(s+=a,i-=a,a=0),i<0&&(s+=i,a-=i,i=0),s>0&&e.copyWithin(i,a,s),t}},"./src/rendering/blendPattern.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{constructor(e){this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.vertInfoA=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.vertInfoC=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.createBlendPattern()}static resizeMatrixValues(e,t,r,n,i){const a=new Float32Array((n+1)*(i+1));let s=0;for(let o=0;o<i+1;o++)for(let l=0;l<n+1;l++){let c=l/i,u=o/n;c*=t+1,u*=r+1,c=Math.clamp(c,0,t-1),u=Math.clamp(u,0,r-1);const h=Math.floor(c),d=Math.floor(u),f=c-h,m=u-d,p=e[d*(t+1)+h],g=e[d*(t+1)+(h+1)],A=e[(d+1)*(t+1)+h],b=e[(d+1)*(t+1)+(h+1)];a[s]=p*(1-f)*(1-m)+g*f*(1-m)+A*(1-f)*m+b*f*m,s+=1}return a}updateGlobals(e){const t=this.mesh_width,r=this.mesh_height;this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.mesh_width===t&&this.mesh_height===r||(this.vertInfoA=n.resizeMatrixValues(this.vertInfoA,t,r,this.mesh_width,this.mesh_height),this.vertInfoC=n.resizeMatrixValues(this.vertInfoC,t,r,this.mesh_width,this.mesh_height))}genPlasma(e,t,r,n,i){const a=Math.floor((e+t)/2),s=Math.floor((r+n)/2);let o=this.vertInfoC[r*(this.mesh_width+1)+e],l=this.vertInfoC[r*(this.mesh_width+1)+t],c=this.vertInfoC[n*(this.mesh_width+1)+e],u=this.vertInfoC[n*(this.mesh_width+1)+t];n-r>=2&&(0===e&&(this.vertInfoC[s*(this.mesh_width+1)+e]=.5*(o+c)+(2*Math.random()-1)*i*this.aspecty),this.vertInfoC[s*(this.mesh_width+1)+t]=.5*(l+u)+(2*Math.random()-1)*i*this.aspecty),t-e>=2&&(0===r&&(this.vertInfoC[r*(this.mesh_width+1)+a]=.5*(o+l)+(2*Math.random()-1)*i*this.aspectx),this.vertInfoC[n*(this.mesh_width+1)+a]=.5*(c+u)+(2*Math.random()-1)*i*this.aspectx),n-r>=2&&t-e>=2&&(o=this.vertInfoC[s*(this.mesh_width+1)+e],l=this.vertInfoC[s*(this.mesh_width+1)+t],c=this.vertInfoC[r*(this.mesh_width+1)+a],u=this.vertInfoC[n*(this.mesh_width+1)+a],this.vertInfoC[s*(this.mesh_width+1)+a]=.25*(c+u+o+l)+(2*Math.random()-1)*i,this.genPlasma(e,a,r,s,.5*i),this.genPlasma(a,t,r,s,.5*i),this.genPlasma(e,a,s,n,.5*i),this.genPlasma(a,t,s,n,.5*i))}createBlendPattern(){const e=1+Math.floor(3*Math.random());if(0===e){let e=0;for(let t=0;t<=this.mesh_height;t++)for(let t=0;t<=this.mesh_width;t++)this.vertInfoA[e]=1,this.vertInfoC[e]=0,e+=1}else if(1===e){const e=6.28*Math.random(),t=Math.cos(e),r=Math.sin(e),n=.1+.2*Math.random(),i=1/n;let a=0;for(let e=0;e<=this.mesh_height;e++){const s=e/this.mesh_height*this.aspecty;for(let e=0;e<=this.mesh_width;e++){let o=(e/this.mesh_width*this.aspectx-.5)*t+(s-.5)*r+.5;o=(o-.5)/Math.sqrt(2)+.5,this.vertInfoA[a]=i*(1+n),this.vertInfoC[a]=i*o-i,a+=1}}}else if(2===e){const e=.12+.13*Math.random(),t=1/e;this.vertInfoC[0]=Math.random(),this.vertInfoC[this.mesh_width]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)+this.mesh_width]=Math.random(),this.genPlasma(0,this.mesh_width,0,this.mesh_height,.25);let r=this.vertInfoC[0],n=this.vertInfoC[0],i=0;for(let e=0;e<=this.mesh_height;e++)for(let e=0;e<=this.mesh_width;e++)r>this.vertInfoC[i]&&(r=this.vertInfoC[i]),n<this.vertInfoC[i]&&(n=this.vertInfoC[i]),i+=1;const a=1/(n-r);i=0;for(let n=0;n<=this.mesh_height;n++)for(let n=0;n<=this.mesh_width;n++){const n=(this.vertInfoC[i]-r)*a;this.vertInfoA[i]=t*(1+e),this.vertInfoC[i]=t*n-t,i+=1}}else if(3===e){const e=.02+.14*Math.random()+.34*Math.random(),t=1/e,r=2*Math.floor(2*Math.random())-1;let n=0;for(let i=0;i<=this.mesh_height;i++){const a=(i/this.mesh_height-.5)*this.aspecty;for(let i=0;i<=this.mesh_width;i++){const s=(i/this.mesh_width-.5)*this.aspectx;let o=1.41421*Math.sqrt(s*s+a*a);-1===r&&(o=1-o),this.vertInfoA[n]=t*(1+e),this.vertInfoC[n]=t*o-t,n+=1}}}}}},"./src/rendering/motionVectors/motionVectors.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t){this.gl=e,this.maxX=64,this.maxY=48,this.positions=new Float32Array(this.maxX*this.maxY*2*3),this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.positionVertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      void main(void) {\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 u_color;\n      void main(void) {\n        fragColor = u_color;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}getMotionDir(e,t,r){const n=Math.floor(r*this.mesh_height),i=r*this.mesh_height-n,a=Math.floor(t*this.mesh_width),s=t*this.mesh_width-a,o=a+1,l=n+1,c=this.mesh_width+1;let u,h;return u=e[2*(n*c+a)+0]*(1-s)*(1-i),h=e[2*(n*c+a)+1]*(1-s)*(1-i),u+=e[2*(n*c+o)+0]*s*(1-i),h+=e[2*(n*c+o)+1]*s*(1-i),u+=e[2*(l*c+a)+0]*(1-s)*i,h+=e[2*(l*c+a)+1]*(1-s)*i,u+=e[2*(l*c+o)+0]*s*i,h+=e[2*(l*c+o)+1]*s*i,[u,1-h]}generateMotionVectors(e,t){const r=0===e.bmotionvectorson?0:e.mv_a;let n=Math.floor(e.mv_x),i=Math.floor(e.mv_y);if(r>.001&&n>0&&i>0){let a=e.mv_x-n,s=e.mv_y-i;n>this.maxX&&(n=this.maxX,a=0),i>this.maxY&&(i=this.maxY,s=0);const o=e.mv_dx,l=e.mv_dy,c=e.mv_l,u=1/this.texsizeX;this.numVecVerts=0;for(let e=0;e<i;e++){let r=(e+.25)/(i+s+.25-1);if(r-=l,r>1e-4&&r<.9999)for(let e=0;e<n;e++){let i=(e+.25)/(n+a+.25-1);if(i+=o,i>1e-4&&i<.9999){const e=this.getMotionDir(t,i,r);let n=e[0],a=e[1],s=n-i,o=a-r;s*=c,o*=c;let l=Math.sqrt(s*s+o*o);l<u&&l>1e-8?(l=u/l,s*=l,o*=l):(s=u,s=u),n=i+s,a=r+o;const h=2*i-1,d=2*r-1,f=2*n-1,m=2*a-1;this.positions[3*this.numVecVerts+0]=h,this.positions[3*this.numVecVerts+1]=d,this.positions[3*this.numVecVerts+2]=0,this.positions[3*(this.numVecVerts+1)+0]=f,this.positions[3*(this.numVecVerts+1)+1]=m,this.positions[3*(this.numVecVerts+1)+2]=0,this.numVecVerts+=2}}}if(this.numVecVerts>0)return this.color=[e.mv_r,e.mv_g,e.mv_b,r],!0}return!1}drawMotionVectors(e,t){this.generateMotionVectors(e,t)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color),this.gl.lineWidth(1),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.LINES,0,this.numVecVerts))}}},"./src/rendering/renderer.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return T}));var n=r("./src/audio/audioLevels.js"),i=r("./src/blankPreset.js"),a=r.n(i),s=r("./src/equations/presetEquationRunner.js"),o=r("./src/equations/presetEquationRunnerWASM.js"),l=r("./src/rendering/waves/basicWaveform.js"),c=r("./src/rendering/waves/customWaveform.js"),u=r("./src/rendering/shapes/customShape.js"),h=r("./src/rendering/sprites/border.js"),d=r("./src/rendering/sprites/darkenCenter.js"),f=r("./src/rendering/motionVectors/motionVectors.js"),m=r("./src/rendering/shaders/warp.js"),p=r("./src/rendering/shaders/comp.js"),g=r("./src/rendering/shaders/output.js"),A=r("./src/rendering/shaders/resample.js"),b=r("./src/rendering/shaders/blur/blur.js"),v=r("./src/noise/noise.js"),y=r("./src/image/imageTextures.js"),w=r("./src/rendering/text/titleText.js"),E=r("./src/rendering/blendPattern.js"),_=r("./src/utils.js");class T{constructor(e,t,r){this.gl=e,this.audio=t,this.frameNum=0,this.fps=30,this.time=0,this.presetTime=0,this.lastTime=performance.now(),this.timeHist=[0],this.timeHistMax=120,this.blending=!1,this.blendStartTime=0,this.blendProgress=0,this.blendDuration=0,this.width=r.width||1200,this.height=r.height||900,this.mesh_width=r.meshWidth||48,this.mesh_height=r.meshHeight||36,this.pixelRatio=r.pixelRatio||window.devicePixelRatio||1,this.textureRatio=r.textureRatio||1,this.outputFXAA=r.outputFXAA||!1,this.texsizeX=this.width*this.pixelRatio*this.textureRatio,this.texsizeY=this.height*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=_.default.range(1,33).map((e=>`q${e}`)),this.ts=_.default.range(1,9).map((e=>`t${e}`)),this.regs=_.default.range(0,100).map((e=>e<10?`reg0${e}`:`reg${e}`)),this.blurRatios=[[.5,.25],[.125,.125],[.0625,.0625]],this.audioLevels=new n.default(this.audio),this.prevFrameBuffer=this.gl.createFramebuffer(),this.targetFrameBuffer=this.gl.createFramebuffer(),this.prevTexture=this.gl.createTexture(),this.targetTexture=this.gl.createTexture(),this.compFrameBuffer=this.gl.createFramebuffer(),this.compTexture=this.gl.createTexture(),this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.targetFrameBuffer,this.targetTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture);const i={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.noise=new v.default(e),this.image=new y.default(e),this.warpShader=new m.default(e,this.noise,this.image,i),this.compShader=new p.default(e,this.noise,this.image,i),this.outputShader=new g.default(e,i),this.prevWarpShader=new m.default(e,this.noise,this.image,i),this.prevCompShader=new p.default(e,this.noise,this.image,i),this.numBlurPasses=0,this.blurShader1=new b.default(0,this.blurRatios,e,i),this.blurShader2=new b.default(1,this.blurRatios,e,i),this.blurShader3=new b.default(2,this.blurRatios,e,i),this.blurTexture1=this.blurShader1.blurVerticalTexture,this.blurTexture2=this.blurShader2.blurVerticalTexture,this.blurTexture3=this.blurShader3.blurVerticalTexture,this.basicWaveform=new l.default(e,i),this.customWaveforms=_.default.range(4).map((t=>new c.default(t,e,i))),this.customShapes=_.default.range(4).map((t=>new u.default(t,e,i))),this.prevCustomWaveforms=_.default.range(4).map((t=>new c.default(t,e,i))),this.prevCustomShapes=_.default.range(4).map((t=>new u.default(t,e,i))),this.darkenCenter=new d.default(e,i),this.innerBorder=new h.default(e,i),this.outerBorder=new h.default(e,i),this.motionVectors=new f.default(e,i),this.titleText=new w.default(e,i),this.blendPattern=new E.default(i),this.resampleShader=new A.default(e),this.supertext={startTime:-1},this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4),this.gl.clearColor(0,0,0,1),this.blankPreset=a.a;const o={frame:0,time:0,fps:45,bass:1,bass_att:1,mid:1,mid_att:1,treb:1,treb_att:1};this.preset=a.a,this.prevPreset=this.preset,this.presetEquationRunner=new s.default(this.preset,o,i),this.prevPresetEquationRunner=new s.default(this.prevPreset,o,i),this.preset.useWASM||(this.regVars=this.presetEquationRunner.mdVSRegs)}static getHighestBlur(e){return/sampler_blur3/.test(e)?3:/sampler_blur2/.test(e)?2:/sampler_blur1/.test(e)?1:0}loadPreset(e,t){this.blendPattern.createBlendPattern(),this.blending=!0,this.blendStartTime=this.time,this.blendDuration=t,this.blendProgress=0,this.prevPresetEquationRunner=this.presetEquationRunner,this.prevPreset=this.preset,this.preset=e,this.presetTime=this.time;const r={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att},n={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};e.useWASM?(this.preset.globalPools.perFrame.old_wave_mode.value=this.prevPreset.baseVals.wave_mode,this.preset.baseVals.old_wave_mode=this.prevPreset.baseVals.wave_mode,this.presetEquationRunner=new o.default(this.preset,r,n),this.preset.pixel_eqs_initialize_array&&this.preset.pixel_eqs_initialize_array(this.mesh_width,this.mesh_height)):(this.preset.baseVals.old_wave_mode=this.prevPreset.baseVals.wave_mode,this.presetEquationRunner=new s.default(this.preset,r,n),this.regVars=this.presetEquationRunner.mdVSRegs);const i=this.prevWarpShader;this.prevWarpShader=this.warpShader,this.warpShader=i;const a=this.prevCompShader;this.prevCompShader=this.compShader,this.compShader=a;const l=this.preset.warp.trim(),c=this.preset.comp.trim();this.warpShader.updateShader(l),this.compShader.updateShader(c),0===l.length?this.numBlurPasses=0:this.numBlurPasses=T.getHighestBlur(l),0!==c.length&&(this.numBlurPasses=Math.max(this.numBlurPasses,T.getHighestBlur(c)))}loadExtraImages(e){this.image.loadExtraImages(e)}setRendererSize(e,t,r){const n=this.texsizeX,i=this.texsizeY;if(this.width=e,this.height=t,this.mesh_width=r.meshWidth||this.mesh_width,this.mesh_height=r.meshHeight||this.mesh_height,this.pixelRatio=r.pixelRatio||this.pixelRatio,this.textureRatio=r.textureRatio||this.textureRatio,this.texsizeX=e*this.pixelRatio*this.textureRatio,this.texsizeY=t*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.texsizeX!==n||this.texsizeY!==i){const e=this.gl.createTexture();this.bindFrameBufferTexture(this.targetFrameBuffer,e),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.resampleShader.renderQuadTexture(this.targetTexture),this.targetTexture=e,this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture)}this.updateGlobals(),this.frameNum>0&&this.renderToScreen()}setInternalMeshSize(e,t){this.mesh_width=e,this.mesh_height=t,this.updateGlobals()}setOutputAA(e){this.outputFXAA=e}updateGlobals(){const e={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.presetEquationRunner.updateGlobals(e),this.prevPresetEquationRunner.updateGlobals(e),this.warpShader.updateGlobals(e),this.prevWarpShader.updateGlobals(e),this.compShader.updateGlobals(e),this.prevCompShader.updateGlobals(e),this.outputShader.updateGlobals(e),this.blurShader1.updateGlobals(e),this.blurShader2.updateGlobals(e),this.blurShader3.updateGlobals(e),this.basicWaveform.updateGlobals(e),this.customWaveforms.forEach((t=>t.updateGlobals(e))),this.customShapes.forEach((t=>t.updateGlobals(e))),this.prevCustomWaveforms.forEach((t=>t.updateGlobals(e))),this.prevCustomShapes.forEach((t=>t.updateGlobals(e))),this.darkenCenter.updateGlobals(e),this.innerBorder.updateGlobals(e),this.outerBorder.updateGlobals(e),this.motionVectors.updateGlobals(e),this.titleText.updateGlobals(e),this.blendPattern.updateGlobals(e),this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4),this.preset.pixel_eqs_initialize_array&&this.preset.pixel_eqs_initialize_array(this.mesh_width,this.mesh_height)}calcTimeAndFPS(e){let t;if(e)t=e;else{const e=performance.now();t=(e-this.lastTime)/1e3,(t>1||t<0||this.frame<2)&&(t=1/30),this.lastTime=e}this.time+=1/this.fps,this.blending&&(this.blendProgress=(this.time-this.blendStartTime)/this.blendDuration,this.blendProgress>1&&(this.blending=!1));const r=this.timeHist[this.timeHist.length-1]+t;this.timeHist.push(r),this.timeHist.length>this.timeHistMax&&this.timeHist.shift();const n=this.timeHist.length/(r-this.timeHist[0]);if(Math.abs(n-this.fps)>3&&this.frame>this.timeHistMax)this.fps=n;else{const e=.93;this.fps=e*this.fps+(1-e)*n}}runPixelEquations(e,t,r,n){const i=this.mesh_width,a=this.mesh_height,s=i+1,o=a+1,l=this.time*t.warpanimspeed,c=1/t.warpscale,u=11.68+4*Math.cos(1.413*l+10),h=8.77+3*Math.cos(1.113*l+7),d=10.54+3*Math.cos(1.233*l+3),f=11.49+4*Math.cos(.933*l+5),m=0/this.texsizeX,p=0/this.texsizeY,g=this.aspectx,A=this.aspecty;let b=0,v=0;if(e.preset.useWASM){const i=e.preset.globalPools.perVertex;if(_.default.setWasm(i,r,e.globalKeys),_.default.setWasm(i,e.mdVSQAfterFrame,e.qs),i.zoom.value=t.zoom,i.zoomexp.value=t.zoomexp,i.rot.value=t.rot,i.warp.value=t.warp,i.cx.value=t.cx,i.cy.value=t.cy,i.dx.value=t.dx,i.dy.value=t.dy,i.sx.value=t.sx,i.sy.value=t.sy,e.preset.pixel_eqs_wasm(e.runVertEQs,this.mesh_width,this.mesh_height,this.time,t.warpanimspeed,t.warpscale,this.aspectx,this.aspecty),n){const t=e.preset.pixel_eqs_get_array();let r=0,n=0;for(let e=0;e<o;e++)for(let e=0;e<s;e++){const e=t[r],i=t[r+1];let a=this.blendPattern.vertInfoA[r/2]*this.blendProgress+this.blendPattern.vertInfoC[r/2];a=Math.clamp(a,0,1),this.warpUVs[r]=this.warpUVs[r]*a+e*(1-a),this.warpUVs[r+1]=this.warpUVs[r+1]*a+i*(1-a),this.warpColor[n+0]=1,this.warpColor[n+1]=1,this.warpColor[n+2]=1,this.warpColor[n+3]=a,r+=2,n+=4}}else this.warpUVs=e.preset.pixel_eqs_get_array(),this.warpColor.fill(1)}else{let r=_.default.cloneVars(t),y=r.warp,w=r.zoom,E=r.zoomexp,T=r.cx,x=r.cy,S=r.sx,k=r.sy,I=r.dx,C=r.dy,P=r.rot;for(let M=0;M<o;M++)for(let o=0;o<s;o++){const s=o/i*2-1,R=M/a*2-1,B=Math.sqrt(s*s*g*g+R*R*A*A);if(e.runVertEQs){let n;n=M===a/2&&o===i/2?0:_.default.atan2(R*A,s*g),r.x=.5*s*g+.5,r.y=-.5*R*A+.5,r.rad=B,r.ang=n,r.zoom=t.zoom,r.zoomexp=t.zoomexp,r.rot=t.rot,r.warp=t.warp,r.cx=t.cx,r.cy=t.cy,r.dx=t.dx,r.dy=t.dy,r.sx=t.sx,r.sy=t.sy,r=e.runPixelEquations(r),y=r.warp,w=r.zoom,E=r.zoomexp,T=r.cx,x=r.cy,S=r.sx,k=r.sy,I=r.dx,C=r.dy,P=r.rot}const L=1/w**(E**(2*B-1));let D=.5*s*g*L+.5,N=.5*-R*A*L+.5;D=(D-T)/S+T,N=(N-x)/k+x,0!==y&&(D+=.0035*y*Math.sin(.333*l+c*(s*u-R*f)),N+=.0035*y*Math.cos(.375*l-c*(s*d+R*h)),D+=.0035*y*Math.cos(.753*l-c*(s*h-R*d)),N+=.0035*y*Math.sin(.825*l+c*(s*u+R*f)));const F=D-T,O=N-x,z=Math.cos(P),U=Math.sin(P);if(D=F*z-O*U+T,N=F*U+O*z+x,D-=I,N-=C,D=(D-.5)/g+.5,N=(N-.5)/A+.5,D+=m,N+=p,n){let e=this.blendPattern.vertInfoA[b/2]*this.blendProgress+this.blendPattern.vertInfoC[b/2];e=Math.clamp(e,0,1),this.warpUVs[b]=this.warpUVs[b]*e+D*(1-e),this.warpUVs[b+1]=this.warpUVs[b+1]*e+N*(1-e),this.warpColor[v+0]=1,this.warpColor[v+1]=1,this.warpColor[v+2]=1,this.warpColor[v+3]=e}else this.warpUVs[b]=D,this.warpUVs[b+1]=N,this.warpColor[v+0]=1,this.warpColor[v+1]=1,this.warpColor[v+2]=1,this.warpColor[v+3]=1;b+=2,v+=4}this.mdVSVertex=r}}static mixFrameEquations(e,t,r){const n=.5-.5*Math.cos(e*Math.PI),i=1-n,a=.5,s=_.default.cloneVars(t);return s.decay=n*t.decay+i*r.decay,s.wave_a=n*t.wave_a+i*r.wave_a,s.wave_r=n*t.wave_r+i*r.wave_r,s.wave_g=n*t.wave_g+i*r.wave_g,s.wave_b=n*t.wave_b+i*r.wave_b,s.wave_x=n*t.wave_x+i*r.wave_x,s.wave_y=n*t.wave_y+i*r.wave_y,s.wave_mystery=n*t.wave_mystery+i*r.wave_mystery,s.ob_size=n*t.ob_size+i*r.ob_size,s.ob_r=n*t.ob_r+i*r.ob_r,s.ob_g=n*t.ob_g+i*r.ob_g,s.ob_b=n*t.ob_b+i*r.ob_b,s.ob_a=n*t.ob_a+i*r.ob_a,s.ib_size=n*t.ib_size+i*r.ib_size,s.ib_r=n*t.ib_r+i*r.ib_r,s.ib_g=n*t.ib_g+i*r.ib_g,s.ib_b=n*t.ib_b+i*r.ib_b,s.ib_a=n*t.ib_a+i*r.ib_a,s.mv_x=n*t.mv_x+i*r.mv_x,s.mv_y=n*t.mv_y+i*r.mv_y,s.mv_dx=n*t.mv_dx+i*r.mv_dx,s.mv_dy=n*t.mv_dy+i*r.mv_dy,s.mv_l=n*t.mv_l+i*r.mv_l,s.mv_r=n*t.mv_r+i*r.mv_r,s.mv_g=n*t.mv_g+i*r.mv_g,s.mv_b=n*t.mv_b+i*r.mv_b,s.mv_a=n*t.mv_a+i*r.mv_a,s.echo_zoom=n*t.echo_zoom+i*r.echo_zoom,s.echo_alpha=n*t.echo_alpha+i*r.echo_alpha,s.echo_orient=n*t.echo_orient+i*r.echo_orient,s.wave_dots=n<a?r.wave_dots:t.wave_dots,s.wave_thick=n<a?r.wave_thick:t.wave_thick,s.additivewave=n<a?r.additivewave:t.additivewave,s.wave_brighten=n<a?r.wave_brighten:t.wave_brighten,s.darken_center=n<a?r.darken_center:t.darken_center,s.gammaadj=n<a?r.gammaadj:t.gammaadj,s.wrap=n<a?r.wrap:t.wrap,s.invert=n<a?r.invert:t.invert,s.brighten=n<a?r.brighten:t.brighten,s.darken=n<a?r.darken:t.darken,s.solarize=n<a?r.brighten:t.solarize,s.b1n=n*t.b1n+i*r.b1n,s.b2n=n*t.b2n+i*r.b2n,s.b3n=n*t.b3n+i*r.b3n,s.b1x=n*t.b1x+i*r.b1x,s.b2x=n*t.b2x+i*r.b2x,s.b3x=n*t.b3x+i*r.b3x,s.b1ed=n*t.b1ed+i*r.b1ed,s}static getBlurValues(e){let t=e.b1n,r=e.b2n,n=e.b3n,i=e.b1x,a=e.b2x,s=e.b3x;if(i-t<.1){const e=.5*(t+i);t=e-.05,i=e-.05}if(a=Math.min(i,a),r=Math.max(t,r),a-r<.1){const e=.5*(r+a);r=e-.05,a=e-.05}if(s=Math.min(a,s),n=Math.max(r,n),s-n<.1){const e=.5*(n+s);n=e-.05,s=e-.05}return{blurMins:[t,r,n],blurMaxs:[i,a,s]}}bindFrambufferAndSetViewport(e,t,r){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.viewport(0,0,t,r)}bindFrameBufferTexture(e,t){if(this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(this.texsizeX*this.texsizeY*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,t,0)}render({audioLevels:e,elapsedTime:t}={}){this.calcTimeAndFPS(t),this.frameNum+=1,e?this.audio.updateAudio(e.timeByteArray,e.timeByteArrayL,e.timeByteArrayR):this.audio.sampleAudio(),this.audioLevels.updateAudioLevels(this.fps,this.frameNum);const r={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY},n=Object.assign({},r);this.prevPreset.useWASM||(n.gmegabuf=this.prevPresetEquationRunner.gmegabuf),this.preset.useWASM||(r.gmegabuf=this.presetEquationRunner.gmegabuf,Object.assign(r,this.regVars));const i=this.presetEquationRunner.runFrameEquations(r);let a;this.runPixelEquations(this.presetEquationRunner,i,r,!1),this.preset.useWASM||(Object.assign(this.regVars,_.default.pick(this.mdVSVertex,this.regs)),Object.assign(r,this.regVars)),this.blending?(this.prevMDVSFrame=this.prevPresetEquationRunner.runFrameEquations(n),this.runPixelEquations(this.prevPresetEquationRunner,this.prevMDVSFrame,n,!0),a=T.mixFrameEquations(this.blendProgress,i,this.prevMDVSFrame)):a=i;const s=this.targetTexture;this.targetTexture=this.prevTexture,this.prevTexture=s;const o=this.targetFrameBuffer;this.targetFrameBuffer=this.prevFrameBuffer,this.prevFrameBuffer=o,this.gl.bindTexture(this.gl.TEXTURE_2D,this.prevTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const{blurMins:l,blurMaxs:c}=T.getBlurValues(a);this.blending?(this.prevWarpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,l,c,this.prevMDVSFrame,this.prevPresetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor),this.warpShader.renderQuadTexture(!0,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,l,c,a,this.presetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor)):this.warpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,l,c,i,this.presetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor),this.numBlurPasses>0&&(this.blurShader1.renderBlurTexture(this.targetTexture,i,l,c),this.numBlurPasses>1&&(this.blurShader2.renderBlurTexture(this.blurTexture1,i,l,c),this.numBlurPasses>2&&this.blurShader3.renderBlurTexture(this.blurTexture2,i,l,c)),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY)),this.motionVectors.drawMotionVectors(a,this.warpUVs),this.preset.shapes&&this.preset.shapes.length>0&&this.customShapes.forEach(((e,t)=>{e.drawCustomShape(this.blending?this.blendProgress:1,r,this.presetEquationRunner,this.preset.shapes[t],this.prevTexture)})),this.preset.waves&&this.preset.waves.length>0&&this.customWaveforms.forEach(((e,t)=>{e.drawCustomWaveform(this.blending?this.blendProgress:1,this.audio.timeArrayL,this.audio.timeArrayR,this.audio.freqArrayL,this.audio.freqArrayR,r,this.presetEquationRunner,this.preset.waves[t])})),this.blending&&(this.prevPreset.shapes&&this.prevPreset.shapes.length>0&&this.prevCustomShapes.forEach(((e,t)=>{e.drawCustomShape(1-this.blendProgress,n,this.prevPresetEquationRunner,this.prevPreset.shapes[t],this.prevTexture)})),this.prevPreset.waves&&this.prevPreset.waves.length>0&&this.prevCustomWaveforms.forEach(((e,t)=>{e.drawCustomWaveform(1-this.blendProgress,this.audio.timeArrayL,this.audio.timeArrayR,this.audio.freqArrayL,this.audio.freqArrayR,n,this.prevPresetEquationRunner,this.prevPreset.waves[t])}))),this.basicWaveform.drawBasicWaveform(this.blending,this.blendProgress,this.audio.timeArrayL,this.audio.timeArrayR,a),this.darkenCenter.drawDarkenCenter(a);const u=[a.ob_r,a.ob_g,a.ob_b,a.ob_a];this.outerBorder.drawBorder(u,a.ob_size,0);const h=[a.ib_r,a.ib_g,a.ib_b,a.ib_a];if(this.innerBorder.drawBorder(h,a.ib_size,a.ob_size),this.supertext.startTime>=0){const e=(this.time-this.supertext.startTime)/this.supertext.duration;e>=1&&this.titleText.renderTitle(e,!0,r)}this.globalVars=r,this.mdVSFrame=i,this.mdVSFrameMixed=a,this.renderToScreen()}renderToScreen(){this.outputFXAA?this.bindFrambufferAndSetViewport(this.compFrameBuffer,this.texsizeX,this.texsizeY):this.bindFrambufferAndSetViewport(null,this.width,this.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const{blurMins:e,blurMaxs:t}=T.getBlurValues(this.mdVSFrameMixed);if(this.blending?(this.prevCompShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,e,t,this.prevMDVSFrame,this.prevPresetEquationRunner.mdVSQAfterFrame,this.warpColor),this.compShader.renderQuadTexture(!0,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,e,t,this.mdVSFrameMixed,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor)):this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,e,t,this.mdVSFrame,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor),this.supertext.startTime>=0){const e=(this.time-this.supertext.startTime)/this.supertext.duration;this.titleText.renderTitle(e,!1,this.globalVars),e>=1&&(this.supertext.startTime=-1)}this.outputFXAA&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.compTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(null,this.width,this.height),this.outputShader.renderQuadTexture(this.compTexture))}launchSongTitleAnim(e){this.supertext={startTime:this.time,duration:1.7},this.titleText.generateTitleTexture(e)}toDataURL(){const e=new Uint8Array(this.texsizeX*this.texsizeY*4),t=this.gl.createFramebuffer(),r=this.gl.createTexture();this.bindFrameBufferTexture(t,r);const{blurMins:n,blurMaxs:i}=T.getBlurValues(this.mdVSFrameMixed);this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,n,i,this.mdVSFrame,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),Array.from({length:this.texsizeY},((t,r)=>e.slice(r*this.texsizeX*4,(r+1)*this.texsizeX*4))).forEach(((t,r)=>e.set(t,(this.texsizeY-r-1)*this.texsizeX*4)));const a=document.createElement("canvas");a.width=this.texsizeX,a.height=this.texsizeY;const s=a.getContext("2d"),o=s.createImageData(this.texsizeX,this.texsizeY);return o.data.set(e),s.putImageData(o,0,0),this.gl.deleteTexture(r),this.gl.deleteFramebuffer(t),a.toDataURL()}warpBufferToDataURL(){const e=new Uint8Array(this.texsizeX*this.texsizeY*4);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.targetFrameBuffer),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);const t=document.createElement("canvas");t.width=this.texsizeX,t.height=this.texsizeY;const r=t.getContext("2d"),n=r.createImageData(this.texsizeX,this.texsizeY);return n.data.set(e),r.putImageData(n,0,0),t.toDataURL()}}},"./src/rendering/shaders/blur/blur.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r("./src/rendering/shaders/blur/blurVertical.js"),i=r("./src/rendering/shaders/blur/blurHorizontal.js");class a{constructor(e,t,r,a={}){this.blurLevel=e,this.blurRatios=t,this.gl=r,this.texsizeX=a.texsizeX,this.texsizeY=a.texsizeY,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.blurHorizontalFrameBuffer=this.gl.createFramebuffer(),this.blurVerticalFrameBuffer=this.gl.createFramebuffer(),this.blurHorizontalTexture=this.gl.createTexture(),this.blurVerticalTexture=this.gl.createTexture(),this.setupFrameBufferTextures(),this.blurHorizontal=new i.default(r,this.blurLevel,a),this.blurVertical=new n.default(r,this.blurLevel,a)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.setupFrameBufferTextures()}getTextureSize(e){let t=Math.max(this.texsizeX*e,16);t=16*Math.floor((t+3)/16);let r=Math.max(this.texsizeY*e,16);return r=4*Math.floor((r+3)/4),[t,r]}setupFrameBufferTextures(){const e=this.blurLevel>0?this.blurRatios[this.blurLevel-1]:[1,1],t=this.blurRatios[this.blurLevel],r=this.getTextureSize(e[1]),n=this.getTextureSize(t[0]);this.bindFrameBufferTexture(this.blurHorizontalFrameBuffer,this.blurHorizontalTexture,n);const i=n,a=this.getTextureSize(t[1]);this.bindFrameBufferTexture(this.blurVerticalFrameBuffer,this.blurVerticalTexture,a),this.horizontalTexsizes=[r,n],this.verticalTexsizes=[i,a]}bindFrambufferAndSetViewport(e,t){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.viewport(0,0,t[0],t[1])}bindFrameBufferTexture(e,t,r){if(this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,r[0],r[1],0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(r[0]*r[1]*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const e=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,e)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,t,0)}renderBlurTexture(e,t,r,n){this.bindFrambufferAndSetViewport(this.blurHorizontalFrameBuffer,this.horizontalTexsizes[1]),this.blurHorizontal.renderQuadTexture(e,t,r,n,this.horizontalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurHorizontalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.blurVerticalFrameBuffer,this.verticalTexsizes[1]),this.blurVertical.renderQuadTexture(this.blurHorizontalTexture,t,this.verticalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurVerticalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D)}}},"./src/rendering/shaders/blur/blurHorizontal.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t){this.gl=e,this.blurLevel=t;const r=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],i=r[0]+r[1],a=r[2]+r[3],s=r[4]+r[5],o=r[6]+r[7],l=0+2*r[1]/i,c=2+2*r[3]/a,u=4+2*r[5]/s,h=6+2*r[7]/o;this.ws=new Float32Array([i,a,s,o]),this.ds=new Float32Array([l,c,u,h]),this.wDiv=.5/(i+a+s+o),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      out vec2 uv;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        uv = aPos * halfmad + halfmad;\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n       uniform vec4 texsize;\n       uniform float scale;\n       uniform float bias;\n       uniform vec4 ws;\n       uniform vec4 ds;\n       uniform float wdiv;\n\n       void main(void) {\n         float w1 = ws[0];\n         float w2 = ws[1];\n         float w3 = ws[2];\n         float w4 = ws[3];\n         float d1 = ds[0];\n         float d2 = ds[1];\n         float d3 = ds[2];\n         float d4 = ds[3];\n\n         vec2 uv2 = uv.xy;\n\n         vec3 blur =\n           ( texture(uTexture, uv2 + vec2( d1 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d1 * texsize.z,0.0) ).xyz) * w1 +\n           ( texture(uTexture, uv2 + vec2( d2 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d2 * texsize.z,0.0) ).xyz) * w2 +\n           ( texture(uTexture, uv2 + vec2( d3 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d3 * texsize.z,0.0) ).xyz) * w3 +\n           ( texture(uTexture, uv2 + vec2( d4 * texsize.z,0.0) ).xyz\n           + texture(uTexture, uv2 + vec2(-d4 * texsize.z,0.0) ).xyz) * w4;\n\n         blur.xyz *= wdiv;\n         blur.xyz = blur.xyz * scale + bias;\n\n         fragColor = vec4(blur, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.scaleLoc=this.gl.getUniformLocation(this.shaderProgram,"scale"),this.biasLoc=this.gl.getUniformLocation(this.shaderProgram,"bias"),this.wsLoc=this.gl.getUniformLocation(this.shaderProgram,"ws"),this.dsLocation=this.gl.getUniformLocation(this.shaderProgram,"ds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}getScaleAndBias(e,t){const r=[1,1,1],n=[0,0,0];let i,a;return r[0]=1/(t[0]-e[0]),n[0]=-e[0]*r[0],i=(e[1]-e[0])/(t[0]-e[0]),a=(t[1]-e[0])/(t[0]-e[0]),r[1]=1/(a-i),n[1]=-i*r[1],i=(e[2]-e[1])/(t[1]-e[1]),a=(t[2]-e[1])/(t[1]-e[1]),r[2]=1/(a-i),n[2]=-i*r[2],{scale:r[this.blurLevel],bias:n[this.blurLevel]}}renderQuadTexture(e,t,r,n,i){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(this.textureLoc,0);const{scale:a,bias:s}=this.getScaleAndBias(r,n);this.gl.uniform4fv(this.texsizeLocation,[i[0],i[1],1/i[0],1/i[1]]),this.gl.uniform1f(this.scaleLoc,a),this.gl.uniform1f(this.biasLoc,s),this.gl.uniform4fv(this.wsLoc,this.ws),this.gl.uniform4fv(this.dsLocation,this.ds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/blur/blurVertical.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t){this.gl=e,this.blurLevel=t;const r=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],i=r[0]+r[1]+r[2]+r[3],a=r[4]+r[5]+r[6]+r[7],s=0+(r[2]+r[3])/i*2,o=2+(r[6]+r[7])/a*2;this.wds=new Float32Array([i,a,s,o]),this.wDiv=1/(2*(i+a)),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      out vec2 uv;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        uv = aPos * halfmad + halfmad;\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n       uniform vec4 texsize;\n       uniform float ed1;\n       uniform float ed2;\n       uniform float ed3;\n       uniform vec4 wds;\n       uniform float wdiv;\n\n       void main(void) {\n         float w1 = wds[0];\n         float w2 = wds[1];\n         float d1 = wds[2];\n         float d2 = wds[3];\n\n         vec2 uv2 = uv.xy;\n\n         vec3 blur =\n           ( texture(uTexture, uv2 + vec2(0.0, d1 * texsize.w) ).xyz\n           + texture(uTexture, uv2 + vec2(0.0,-d1 * texsize.w) ).xyz) * w1 +\n           ( texture(uTexture, uv2 + vec2(0.0, d2 * texsize.w) ).xyz\n           + texture(uTexture, uv2 + vec2(0.0,-d2 * texsize.w) ).xyz) * w2;\n\n         blur.xyz *= wdiv;\n\n         float t = min(min(uv.x, uv.y), 1.0 - max(uv.x, uv.y));\n         t = sqrt(t);\n         t = ed1 + ed2 * clamp(t * ed3, 0.0, 1.0);\n         blur.xyz *= t;\n\n         fragColor = vec4(blur, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.ed1Loc=this.gl.getUniformLocation(this.shaderProgram,"ed1"),this.ed2Loc=this.gl.getUniformLocation(this.shaderProgram,"ed2"),this.ed3Loc=this.gl.getUniformLocation(this.shaderProgram,"ed3"),this.wdsLocation=this.gl.getUniformLocation(this.shaderProgram,"wds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}renderQuadTexture(e,t,r){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(this.textureLoc,0);const n=0===this.blurLevel?t.b1ed:0;this.gl.uniform4fv(this.texsizeLocation,[r[0],r[1],1/r[0],1/r[1]]),this.gl.uniform1f(this.ed1Loc,1-n),this.gl.uniform1f(this.ed2Loc,n),this.gl.uniform1f(this.ed3Loc,5),this.gl.uniform4fv(this.wdsLocation,this.wds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/comp.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t,r,i={}){this.gl=e,this.noise=t,this.image=r,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.compWidth=32,this.compHeight=24,this.buildPositions(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.compColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),e.samplerParameteri(this.mainSampler,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}buildPositions(){const e=this.compWidth,t=this.compHeight,r=e+1,n=t+1,i=2/e,a=2/t,s=[];for(let e=0;e<n;e++){const t=e*a-1;for(let e=0;e<r;e++){const r=e*i-1;s.push(r,-t,0)}}const o=[];for(let n=0;n<t;n++)for(let t=0;t<e;t++){const e=t+r*n,i=t+r*(n+1),a=t+1+r*(n+1),s=t+1+r*n;o.push(e,i,s),o.push(i,a,s)}this.vertices=new Float32Array(s),this.indices=new Uint16Array(o)}updateGlobals(e){this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}createShader(e=""){let t,r;if(0===e.length)t="float orient_horiz = mod(echo_orientation, 2.0);\n                        float orient_x = (orient_horiz != 0.0) ? -1.0 : 1.0;\n                        float orient_y = (echo_orientation >= 2.0) ? -1.0 : 1.0;\n                        vec2 uv_echo = ((uv - 0.5) *\n                                        (1.0 / echo_zoom) *\n                                        vec2(orient_x, orient_y)) + 0.5;\n\n                        ret = mix(texture(sampler_main, uv).rgb,\n                                  texture(sampler_main, uv_echo).rgb,\n                                  echo_alpha);\n\n                        ret *= gammaAdj;\n\n                        if(fShader >= 1.0) {\n                          ret *= hue_shader;\n                        } else if(fShader > 0.001) {\n                          ret *= (1.0 - fShader) + (fShader * hue_shader);\n                        }\n\n                        if(brighten != 0) ret = sqrt(ret);\n                        if(darken != 0) ret = ret*ret;\n                        if(solarize != 0) ret = ret * (1.0 - ret) * 4.0;\n                        if(invert != 0) ret = 1.0 - ret;",r="";else{const i=n.default.getShaderParts(e);r=i[0],t=i[1]}t=t.replace(/texture2D/g,"texture"),t=t.replace(/texture3D/g,"texture"),this.userTextures=n.default.getUserSamplers(r),this.shaderProgram=this.gl.createProgram();const i=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(i,"\n      #version 300 es\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      in vec4 aCompColor;\n      out vec2 vUv;\n      out vec4 vColor;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        vUv = aPos * halfmad + halfmad;\n        vColor = aCompColor;\n      }\n      ".trim()),this.gl.compileShader(i);const a=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(a,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      precision mediump sampler3D;\n\n      vec3 lum(vec3 v){\n          return vec3(dot(v, vec3(0.32,0.49,0.29)));\n      }\n\n      in vec2 vUv;\n      in vec4 vColor;\n      out vec4 fragColor;\n      uniform sampler2D sampler_main;\n      uniform sampler2D sampler_fw_main;\n      uniform sampler2D sampler_fc_main;\n      uniform sampler2D sampler_pw_main;\n      uniform sampler2D sampler_pc_main;\n      uniform sampler2D sampler_blur1;\n      uniform sampler2D sampler_blur2;\n      uniform sampler2D sampler_blur3;\n      uniform sampler2D sampler_noise_lq;\n      uniform sampler2D sampler_noise_lq_lite;\n      uniform sampler2D sampler_noise_mq;\n      uniform sampler2D sampler_noise_hq;\n      uniform sampler2D sampler_pw_noise_lq;\n      uniform sampler3D sampler_noisevol_lq;\n      uniform sampler3D sampler_noisevol_hq;\n\n      uniform float time;\n      uniform float gammaAdj;\n      uniform float echo_zoom;\n      uniform float echo_alpha;\n      uniform float echo_orientation;\n      uniform int invert;\n      uniform int brighten;\n      uniform int darken;\n      uniform int solarize;\n      uniform vec2 resolution;\n      uniform vec4 aspect;\n      uniform vec4 texsize;\n      uniform vec4 texsize_noise_lq;\n      uniform vec4 texsize_noise_mq;\n      uniform vec4 texsize_noise_hq;\n      uniform vec4 texsize_noise_lq_lite;\n      uniform vec4 texsize_noisevol_lq;\n      uniform vec4 texsize_noisevol_hq;\n\n      uniform float bass;\n      uniform float mid;\n      uniform float treb;\n      uniform float vol;\n      uniform float bass_att;\n      uniform float mid_att;\n      uniform float treb_att;\n      uniform float vol_att;\n\n      uniform float frame;\n      uniform float fps;\n\n      uniform vec4 _qa;\n      uniform vec4 _qb;\n      uniform vec4 _qc;\n      uniform vec4 _qd;\n      uniform vec4 _qe;\n      uniform vec4 _qf;\n      uniform vec4 _qg;\n      uniform vec4 _qh;\n\n      #define q1 _qa.x\n      #define q2 _qa.y\n      #define q3 _qa.z\n      #define q4 _qa.w\n      #define q5 _qb.x\n      #define q6 _qb.y\n      #define q7 _qb.z\n      #define q8 _qb.w\n      #define q9 _qc.x\n      #define q10 _qc.y\n      #define q11 _qc.z\n      #define q12 _qc.w\n      #define q13 _qd.x\n      #define q14 _qd.y\n      #define q15 _qd.z\n      #define q16 _qd.w\n      #define q17 _qe.x\n      #define q18 _qe.y\n      #define q19 _qe.z\n      #define q20 _qe.w\n      #define q21 _qf.x\n      #define q22 _qf.y\n      #define q23 _qf.z\n      #define q24 _qf.w\n      #define q25 _qg.x\n      #define q26 _qg.y\n      #define q27 _qg.z\n      #define q28 _qg.w\n      #define q29 _qh.x\n      #define q30 _qh.y\n      #define q31 _qh.z\n      #define q32 _qh.w\n\n      uniform vec4 slow_roam_cos;\n      uniform vec4 roam_cos;\n      uniform vec4 slow_roam_sin;\n      uniform vec4 roam_sin;\n\n      uniform float blur1_min;\n      uniform float blur1_max;\n      uniform float blur2_min;\n      uniform float blur2_max;\n      uniform float blur3_min;\n      uniform float blur3_max;\n\n      uniform float scale1;\n      uniform float scale2;\n      uniform float scale3;\n      uniform float bias1;\n      uniform float bias2;\n      uniform float bias3;\n\n      uniform vec4 rand_frame;\n      uniform vec4 rand_preset;\n\n      uniform float fShader;\n\n      float PI = ${Math.PI};\n\n      ${r}\n\n      void main(void) {\n        vec3 ret;\n        vec2 uv = vUv;\n        vec2 uv_orig = vUv;\n        uv.y = 1.0 - uv.y;\n        uv_orig.y = 1.0 - uv_orig.y;\n        float rad = length(uv - 0.5);\n        float ang = atan(uv.x - 0.5, uv.y - 0.5);\n        vec3 hue_shader = vColor.rgb;\n\n        ${t}\n\n        fragColor = vec4(ret, vColor.a);\n      }\n      `.trim()),this.gl.compileShader(a),this.gl.attachShader(this.shaderProgram,i),this.gl.attachShader(this.shaderProgram,a),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.compColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aCompColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.gammaAdjLoc=this.gl.getUniformLocation(this.shaderProgram,"gammaAdj"),this.echoZoomLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_zoom"),this.echoAlphaLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_alpha"),this.echoOrientationLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_orientation"),this.invertLoc=this.gl.getUniformLocation(this.shaderProgram,"invert"),this.brightenLoc=this.gl.getUniformLocation(this.shaderProgram,"brighten"),this.darkenLoc=this.gl.getUniformLocation(this.shaderProgram,"darken"),this.solarizeLoc=this.gl.getUniformLocation(this.shaderProgram,"solarize"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.fShaderLoc=this.gl.getUniformLocation(this.shaderProgram,"fShader"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];t.textureLoc=this.gl.getUniformLocation(this.shaderProgram,`sampler_${t.sampler}`)}}updateShader(e){this.createShader(e)}bindBlurVals(e,t){const r=e[0],n=e[1],i=e[2],a=t[0],s=t[1],o=t[2],l=a-r,c=r,u=s-n,h=n,d=o-i,f=i;this.gl.uniform1f(this.blur1MinLoc,r),this.gl.uniform1f(this.blur1MaxLoc,a),this.gl.uniform1f(this.blur2MinLoc,n),this.gl.uniform1f(this.blur2MaxLoc,s),this.gl.uniform1f(this.blur3MinLoc,i),this.gl.uniform1f(this.blur3MaxLoc,o),this.gl.uniform1f(this.scale1Loc,l),this.gl.uniform1f(this.scale2Loc,u),this.gl.uniform1f(this.scale3Loc,d),this.gl.uniform1f(this.bias1Loc,c),this.gl.uniform1f(this.bias2Loc,h),this.gl.uniform1f(this.bias3Loc,f)}static generateHueBase(e){const t=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1]);for(let r=0;r<4;r++){t[3*r+0]=.6+.3*Math.sin(30*e.time*.0143+3+21*r+e.rand_start[3]),t[3*r+1]=.6+.3*Math.sin(30*e.time*.0107+1+13*r+e.rand_start[1]),t[3*r+2]=.6+.3*Math.sin(30*e.time*.0129+6+9*r+e.rand_start[2]);const n=Math.max(t[3*r],t[3*r+1],t[3*r+2]);for(let e=0;e<3;e++)t[3*r+e]=t[3*r+e]/n,t[3*r+e]=.5+.5*t[3*r+e]}return t}generateCompColors(e,t,r){const n=i.generateHueBase(t),a=this.compWidth+1,s=this.compHeight+1,o=new Float32Array(a*s*4);let l=0;for(let t=0;t<s;t++)for(let i=0;i<a;i++){let a=i/this.compWidth,s=t/this.compHeight;const c=[1,1,1];for(let e=0;e<3;e++)c[e]=n[0+e]*a*s+n[3+e]*(1-a)*s+n[6+e]*a*(1-s)+n[9+e]*(1-a)*(1-s);let u=1;if(e){a*=this.mesh_width+1,s*=this.mesh_height+1,a=Math.clamp(a,0,this.mesh_width-1),s=Math.clamp(s,0,this.mesh_height-1);const e=Math.floor(a),t=Math.floor(s),n=a-e,i=s-t;u=r[4*(t*(this.mesh_width+1)+e)+3]*(1-n)*(1-i)+r[4*(t*(this.mesh_width+1)+(e+1))+3]*n*(1-i)+r[4*((t+1)*(this.mesh_width+1)+e)+3]*(1-n)*i+r[4*((t+1)*(this.mesh_width+1)+(e+1))+3]*n*i}o[l+0]=c[0],o[l+1]=c[1],o[l+2]=c[2],o[l+3]=u,l+=4}return o}renderQuadTexture(e,t,r,n,i,a,s,o,l,c){const u=this.generateCompColors(e,o,c);this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.compColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,u,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.compColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.compColorLocation);const h=0!==o.wrap?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,h),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,h),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,n),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];this.gl.activeTexture(this.gl.TEXTURE15+e),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(t.sampler)),this.gl.uniform1i(t.textureLoc,15+e)}this.gl.uniform1f(this.timeLoc,o.time),this.gl.uniform1f(this.gammaAdjLoc,o.gammaadj),this.gl.uniform1f(this.echoZoomLoc,o.echo_zoom),this.gl.uniform1f(this.echoAlphaLoc,o.echo_alpha),this.gl.uniform1f(this.echoOrientationLoc,o.echo_orient),this.gl.uniform1i(this.invertLoc,o.invert),this.gl.uniform1i(this.brightenLoc,o.brighten),this.gl.uniform1i(this.darkenLoc,o.darken),this.gl.uniform1i(this.solarizeLoc,o.solarize),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,o.bass),this.gl.uniform1f(this.midLoc,o.mid),this.gl.uniform1f(this.trebLoc,o.treb),this.gl.uniform1f(this.volLoc,(o.bass+o.mid+o.treb)/3),this.gl.uniform1f(this.bassAttLoc,o.bass_att),this.gl.uniform1f(this.midAttLoc,o.mid_att),this.gl.uniform1f(this.trebAttLoc,o.treb_att),this.gl.uniform1f(this.volAttLoc,(o.bass_att+o.mid_att+o.treb_att)/3),this.gl.uniform1f(this.frameLoc,o.frame),this.gl.uniform1f(this.fpsLoc,o.fps),this.gl.uniform4fv(this.randPresetLoc,o.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform1f(this.fShaderLoc,o.fshader),this.gl.uniform4fv(this.qaLoc,new Float32Array([l.q1||0,l.q2||0,l.q3||0,l.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([l.q5||0,l.q6||0,l.q7||0,l.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([l.q9||0,l.q10||0,l.q11||0,l.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([l.q13||0,l.q14||0,l.q15||0,l.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([l.q17||0,l.q18||0,l.q19||0,l.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([l.q21||0,l.q22||0,l.q23||0,l.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([l.q25||0,l.q26||0,l.q27||0,l.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([l.q29||0,l.q30||0,l.q31||0,l.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(.005*o.time),.5+.5*Math.cos(.008*o.time),.5+.5*Math.cos(.013*o.time),.5+.5*Math.cos(.022*o.time)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(.3*o.time),.5+.5*Math.cos(1.3*o.time),.5+.5*Math.cos(5*o.time),.5+.5*Math.cos(20*o.time)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(.005*o.time),.5+.5*Math.sin(.008*o.time),.5+.5*Math.sin(.013*o.time),.5+.5*Math.sin(.022*o.time)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(.3*o.time),.5+.5*Math.sin(1.3*o.time),.5+.5*Math.sin(5*o.time),.5+.5*Math.sin(20*o.time)]),this.bindBlurVals(a,s),e?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),e||this.gl.enable(this.gl.BLEND)}}},"./src/rendering/shaders/output.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t){this.gl=e,this.textureRatio=t.textureRatio,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.useFXAA()?this.createFXAAShader():this.createShader()}useFXAA(){return this.textureRatio<=1}updateGlobals(e){this.textureRatio=e.textureRatio,this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.gl.deleteProgram(this.shaderProgram),this.useFXAA()?this.createFXAAShader():this.createShader()}createFXAAShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       out vec2 v_rgbM;\n       out vec2 v_rgbNW;\n       out vec2 v_rgbNE;\n       out vec2 v_rgbSW;\n       out vec2 v_rgbSE;\n       uniform vec4 texsize;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n\n         v_rgbM = aPos * halfmad + halfmad;\n         v_rgbNW = v_rgbM + (vec2(-1.0, -1.0) * texsize.zx);\n         v_rgbNE = v_rgbM + (vec2(1.0, -1.0) * texsize.zx);\n         v_rgbSW = v_rgbM + (vec2(-1.0, 1.0) * texsize.zx);\n         v_rgbSE = v_rgbM + (vec2(1.0, 1.0) * texsize.zx);\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 v_rgbM;\n       in vec2 v_rgbNW;\n       in vec2 v_rgbNE;\n       in vec2 v_rgbSW;\n       in vec2 v_rgbSE;\n       out vec4 fragColor;\n       uniform vec4 texsize;\n       uniform sampler2D uTexture;\n\n       #ifndef FXAA_REDUCE_MIN\n         #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n       #endif\n       #ifndef FXAA_REDUCE_MUL\n         #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n       #endif\n       #ifndef FXAA_SPAN_MAX\n         #define FXAA_SPAN_MAX     8.0\n       #endif\n\n       void main(void) {\n         vec4 color;\n         vec3 rgbNW = textureLod(uTexture, v_rgbNW, 0.0).xyz;\n         vec3 rgbNE = textureLod(uTexture, v_rgbNE, 0.0).xyz;\n         vec3 rgbSW = textureLod(uTexture, v_rgbSW, 0.0).xyz;\n         vec3 rgbSE = textureLod(uTexture, v_rgbSE, 0.0).xyz;\n         vec3 rgbM  = textureLod(uTexture, v_rgbM, 0.0).xyz;\n         vec3 luma = vec3(0.299, 0.587, 0.114);\n         float lumaNW = dot(rgbNW, luma);\n         float lumaNE = dot(rgbNE, luma);\n         float lumaSW = dot(rgbSW, luma);\n         float lumaSE = dot(rgbSE, luma);\n         float lumaM  = dot(rgbM,  luma);\n         float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n         float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n         mediump vec2 dir;\n         dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n         dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n         float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                               (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n         float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n         dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n                   max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                   dir * rcpDirMin)) * texsize.zw;\n\n         vec3 rgbA = 0.5 * (\n             textureLod(uTexture, v_rgbM + dir * (1.0 / 3.0 - 0.5), 0.0).xyz +\n             textureLod(uTexture, v_rgbM + dir * (2.0 / 3.0 - 0.5), 0.0).xyz);\n         vec3 rgbB = rgbA * 0.5 + 0.25 * (\n             textureLod(uTexture, v_rgbM + dir * -0.5, 0.0).xyz +\n             textureLod(uTexture, v_rgbM + dir * 0.5, 0.0).xyz);\n\n         float lumaB = dot(rgbB, luma);\n         if ((lumaB < lumaMin) || (lumaB > lumaMax))\n           color = vec4(rgbA, 1.0);\n         else\n           color = vec4(rgbB, 1.0);\n\n         fragColor = color;\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize")}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       out vec2 uv;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n         uv = aPos * halfmad + halfmad;\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n\n       void main(void) {\n         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}renderQuadTexture(e){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(this.textureLoc,0),this.useFXAA()&&this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/resample.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e){this.gl=e,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       out vec2 uv;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n         uv = aPos * halfmad + halfmad;\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n\n       void main(void) {\n         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}renderQuadTexture(e){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.uniform1i(this.textureLoc,0),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/shaderUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));const n=/uniform sampler2D sampler_(?:.+?);/g,i=/uniform sampler2D sampler_(.+?);/;class a{static getShaderParts(e){const t=e.indexOf("shader_body");if(e&&t>-1){const r=e.substring(0,t),n=e.substring(t),i=n.indexOf("{"),a=n.lastIndexOf("}");return[r,n.substring(i+1,a)]}return["",e]}static getFragmentFloatPrecision(e){return e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0?"highp":e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}static getUserSamplers(e){const t=[],r=e.match(n);if(r&&r.length>0)for(let e=0;e<r.length;e++){const n=r[e].match(i);if(n&&n.length>0){const e=n[1];t.push({sampler:e})}}return t}}},"./src/rendering/shaders/warp.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t,r,i={}){this.gl=e,this.noise=t,this.image=r,this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.warpUvVertexBuf=this.gl.createBuffer(),this.warpColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),e.samplerParameteri(this.mainSampler,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSampler,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerFW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_MAG_FILTER,e.LINEAR),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerFC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_S,e.REPEAT),e.samplerParameteri(this.mainSamplerPW,e.TEXTURE_WRAP_T,e.REPEAT),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MIN_FILTER,e.NEAREST_MIPMAP_NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_MAG_FILTER,e.NEAREST),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.samplerParameteri(this.mainSamplerPC,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}buildPositions(){const e=this.mesh_width,t=this.mesh_height,r=e+1,n=t+1,i=2/e,a=2/t,s=[];for(let e=0;e<n;e++){const t=e*a-1;for(let e=0;e<r;e++){const r=e*i-1;s.push(r,-t,0)}}const o=[];for(let n=0;n<t;n++)for(let t=0;t<e;t++){const e=t+r*n,i=t+r*(n+1),a=t+1+r*(n+1),s=t+1+r*n;o.push(e,i,s),o.push(i,a,s)}this.vertices=new Float32Array(s),this.indices=new Uint16Array(o)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}createShader(e=""){let t,r;if(0===e.length)t="ret = texture(sampler_main, uv).rgb * decay;",r="";else{const i=n.default.getShaderParts(e);r=i[0],t=i[1]}t=t.replace(/texture2D/g,"texture"),t=t.replace(/texture3D/g,"texture"),this.userTextures=n.default.getUserSamplers(r),this.shaderProgram=this.gl.createProgram();const i=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(i,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      const vec2 halfmad = vec2(0.5);\n      in vec2 aPos;\n      in vec2 aWarpUv;\n      in vec4 aWarpColor;\n      out vec2 uv;\n      out vec2 uv_orig;\n      out vec4 vColor;\n      void main(void) {\n        gl_Position = vec4(aPos, 0.0, 1.0);\n        uv_orig = aPos * halfmad + halfmad;\n        uv = aWarpUv;\n        vColor = aWarpColor;\n      }\n      `.trim()),this.gl.compileShader(i);const a=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(a,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      precision mediump sampler3D;\n\n      in vec2 uv;\n      in vec2 uv_orig;\n      in vec4 vColor;\n      out vec4 fragColor;\n      uniform sampler2D sampler_main;\n      uniform sampler2D sampler_fw_main;\n      uniform sampler2D sampler_fc_main;\n      uniform sampler2D sampler_pw_main;\n      uniform sampler2D sampler_pc_main;\n      uniform sampler2D sampler_blur1;\n      uniform sampler2D sampler_blur2;\n      uniform sampler2D sampler_blur3;\n      uniform sampler2D sampler_noise_lq;\n      uniform sampler2D sampler_noise_lq_lite;\n      uniform sampler2D sampler_noise_mq;\n      uniform sampler2D sampler_noise_hq;\n      uniform sampler2D sampler_pw_noise_lq;\n      uniform sampler3D sampler_noisevol_lq;\n      uniform sampler3D sampler_noisevol_hq;\n      uniform float time;\n      uniform float decay;\n      uniform vec2 resolution;\n      uniform vec4 aspect;\n      uniform vec4 texsize;\n      uniform vec4 texsize_noise_lq;\n      uniform vec4 texsize_noise_mq;\n      uniform vec4 texsize_noise_hq;\n      uniform vec4 texsize_noise_lq_lite;\n      uniform vec4 texsize_noisevol_lq;\n      uniform vec4 texsize_noisevol_hq;\n\n      uniform float bass;\n      uniform float mid;\n      uniform float treb;\n      uniform float vol;\n      uniform float bass_att;\n      uniform float mid_att;\n      uniform float treb_att;\n      uniform float vol_att;\n\n      uniform float frame;\n      uniform float fps;\n\n      uniform vec4 _qa;\n      uniform vec4 _qb;\n      uniform vec4 _qc;\n      uniform vec4 _qd;\n      uniform vec4 _qe;\n      uniform vec4 _qf;\n      uniform vec4 _qg;\n      uniform vec4 _qh;\n\n      #define q1 _qa.x\n      #define q2 _qa.y\n      #define q3 _qa.z\n      #define q4 _qa.w\n      #define q5 _qb.x\n      #define q6 _qb.y\n      #define q7 _qb.z\n      #define q8 _qb.w\n      #define q9 _qc.x\n      #define q10 _qc.y\n      #define q11 _qc.z\n      #define q12 _qc.w\n      #define q13 _qd.x\n      #define q14 _qd.y\n      #define q15 _qd.z\n      #define q16 _qd.w\n      #define q17 _qe.x\n      #define q18 _qe.y\n      #define q19 _qe.z\n      #define q20 _qe.w\n      #define q21 _qf.x\n      #define q22 _qf.y\n      #define q23 _qf.z\n      #define q24 _qf.w\n      #define q25 _qg.x\n      #define q26 _qg.y\n      #define q27 _qg.z\n      #define q28 _qg.w\n      #define q29 _qh.x\n      #define q30 _qh.y\n      #define q31 _qh.z\n      #define q32 _qh.w\n\n      uniform vec4 slow_roam_cos;\n      uniform vec4 roam_cos;\n      uniform vec4 slow_roam_sin;\n      uniform vec4 roam_sin;\n\n      uniform float blur1_min;\n      uniform float blur1_max;\n      uniform float blur2_min;\n      uniform float blur2_max;\n      uniform float blur3_min;\n      uniform float blur3_max;\n\n      uniform float scale1;\n      uniform float scale2;\n      uniform float scale3;\n      uniform float bias1;\n      uniform float bias2;\n      uniform float bias3;\n\n      uniform vec4 rand_frame;\n      uniform vec4 rand_preset;\n\n      float PI = ${Math.PI};\n\n      ${r}\n\n      void main(void) {\n        vec3 ret;\n        float rad = length(uv_orig - 0.5);\n        float ang = atan(uv_orig.x - 0.5, uv_orig.y - 0.5);\n\n        ${t}\n\n        fragColor = vec4(ret, 1.0) * vColor;\n      }\n      `.trim()),this.gl.compileShader(a),this.gl.attachShader(this.shaderProgram,i),this.gl.attachShader(this.shaderProgram,a),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.warpUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpUv"),this.warpColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.decayLoc=this.gl.getUniformLocation(this.shaderProgram,"decay"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];t.textureLoc=this.gl.getUniformLocation(this.shaderProgram,`sampler_${t.sampler}`)}}updateShader(e){this.createShader(e)}bindBlurVals(e,t){const r=e[0],n=e[1],i=e[2],a=t[0],s=t[1],o=t[2],l=a-r,c=r,u=s-n,h=n,d=o-i,f=i;this.gl.uniform1f(this.blur1MinLoc,r),this.gl.uniform1f(this.blur1MaxLoc,a),this.gl.uniform1f(this.blur2MinLoc,n),this.gl.uniform1f(this.blur2MaxLoc,s),this.gl.uniform1f(this.blur3MinLoc,i),this.gl.uniform1f(this.blur3MaxLoc,o),this.gl.uniform1f(this.scale1Loc,l),this.gl.uniform1f(this.scale2Loc,u),this.gl.uniform1f(this.scale3Loc,d),this.gl.uniform1f(this.bias1Loc,c),this.gl.uniform1f(this.bias2Loc,h),this.gl.uniform1f(this.bias3Loc,f)}renderQuadTexture(e,t,r,n,i,a,s,o,l,c,u){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpUvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,c,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,u,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpColorLocation);const h=0!==o.wrap?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,h),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,h),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,n),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(let e=0;e<this.userTextures.length;e++){const t=this.userTextures[e];this.gl.activeTexture(this.gl.TEXTURE15+e),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(t.sampler)),this.gl.uniform1i(t.textureLoc,15+e)}this.gl.uniform1f(this.decayLoc,o.decay),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,[this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY]),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,o.bass),this.gl.uniform1f(this.midLoc,o.mid),this.gl.uniform1f(this.trebLoc,o.treb),this.gl.uniform1f(this.volLoc,(o.bass+o.mid+o.treb)/3),this.gl.uniform1f(this.bassAttLoc,o.bass_att),this.gl.uniform1f(this.midAttLoc,o.mid_att),this.gl.uniform1f(this.trebAttLoc,o.treb_att),this.gl.uniform1f(this.volAttLoc,(o.bass_att+o.mid_att+o.treb_att)/3),this.gl.uniform1f(this.timeLoc,o.time),this.gl.uniform1f(this.frameLoc,o.frame),this.gl.uniform1f(this.fpsLoc,o.fps),this.gl.uniform4fv(this.randPresetLoc,o.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform4fv(this.qaLoc,new Float32Array([l.q1||0,l.q2||0,l.q3||0,l.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([l.q5||0,l.q6||0,l.q7||0,l.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([l.q9||0,l.q10||0,l.q11||0,l.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([l.q13||0,l.q14||0,l.q15||0,l.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([l.q17||0,l.q18||0,l.q19||0,l.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([l.q21||0,l.q22||0,l.q23||0,l.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([l.q25||0,l.q26||0,l.q27||0,l.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([l.q29||0,l.q30||0,l.q31||0,l.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(.005*o.time),.5+.5*Math.cos(.008*o.time),.5+.5*Math.cos(.013*o.time),.5+.5*Math.cos(.022*o.time)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(.3*o.time),.5+.5*Math.cos(1.3*o.time),.5+.5*Math.cos(5*o.time),.5+.5*Math.cos(20*o.time)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(.005*o.time),.5+.5*Math.sin(.008*o.time),.5+.5*Math.sin(.013*o.time),.5+.5*Math.sin(.022*o.time)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(.3*o.time),.5+.5*Math.sin(1.3*o.time),.5+.5*Math.sin(5*o.time),.5+.5*Math.sin(20*o.time)]),this.bindBlurVals(a,s),e?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),e||this.gl.enable(this.gl.BLEND)}}},"./src/rendering/shapes/customShape.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r("./src/utils.js"),i=r("./src/rendering/shaders/shaderUtils.js");class a{constructor(e,t,r){this.index=e,this.gl=t,this.positions=new Float32Array(309),this.colors=new Float32Array(412),this.uvs=new Float32Array(206),this.borderPositions=new Float32Array(306),this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.uvVertexBuf=this.gl.createBuffer(),this.borderPositionVertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.createBorderShader(),this.mainSampler=this.gl.createSampler(),t.samplerParameteri(this.mainSampler,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_T,t.REPEAT)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      in vec4 aColor;\n      in vec2 aUv;\n      out vec4 vColor;\n      out vec2 vUv;\n      void main(void) {\n        vColor = aColor;\n        vUv = aUv;\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      uniform sampler2D uTexture;\n      uniform float uTextured;\n      in vec4 vColor;\n      in vec2 vUv;\n      out vec4 fragColor;\n      void main(void) {\n        if (uTextured != 0.0) {\n          fragColor = texture(uTexture, vUv) * vColor;\n        } else {\n          fragColor = vColor;\n        }\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.aUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.texturedLoc=this.gl.getUniformLocation(this.shaderProgram,"uTextured"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}createBorderShader(){this.borderShaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aBorderPos;\n      uniform vec2 thickOffset;\n      void main(void) {\n        gl_Position = vec4(aBorderPos +\n                            vec3(thickOffset, 0.0), 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 uBorderColor;\n      void main(void) {\n        fragColor = uBorderColor;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.borderShaderProgram,e),this.gl.attachShader(this.borderShaderProgram,t),this.gl.linkProgram(this.borderShaderProgram),this.aBorderPosLoc=this.gl.getAttribLocation(this.borderShaderProgram,"aBorderPos"),this.uBorderColorLoc=this.gl.getUniformLocation(this.borderShaderProgram,"uBorderColor"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}drawCustomShape(e,t,r,i,a){if(0!==i.baseVals.enabled)if(r.preset.useWASM){this.setupShapeBuffers(r.preset.globalPools.perFrame.wrap.value);const i=r.preset.shapes[this.index].baseVals,s=r.preset.globalPools[`shapePerFrame${this.index}`];n.default.setWasm(s,t,r.globalKeys),r.preset.shapes[this.index].frame_eqs||r.preset.restore_qs(),n.default.setWasm(s,r.mdVSTShapeInits[this.index],r.ts),r.preset.save_ts(),s.x.value=i.x,s.y.value=i.y,s.rad.value=i.rad,s.ang.value=i.ang,s.r.value=i.r,s.g.value=i.g,s.b.value=i.b,s.a.value=i.a,s.r2.value=i.r2,s.g2.value=i.g2,s.b2.value=i.b2,s.a2.value=i.a2,s.border_r.value=i.border_r,s.border_g.value=i.border_g,s.border_b.value=i.border_b,s.border_a.value=i.border_a,s.thickoutline.value=i.thickoutline,s.textured.value=i.textured,s.tex_zoom.value=i.tex_zoom,s.tex_ang.value=i.tex_ang,s.additive.value=i.additive,r.preset.shapes[this.index].frame_eqs_save();const o=Math.clamp(i.num_inst,1,1024);for(let t=0;t<o;t++){s.instance.value=t,r.preset.shapes[this.index].frame_eqs&&(r.preset.shapes[this.index].frame_eqs_restore(),r.preset.restore_qs(),r.preset.restore_ts(),r.preset.shapes[this.index].frame_eqs());let n=s.sides.value;n=Math.clamp(n,3,100),n=Math.floor(n);const i=s.rad.value,o=s.ang.value,l=2*s.x.value-1,c=-2*s.y.value+1,u=s.r.value,h=s.g.value,d=s.b.value,f=s.a.value,m=s.r2.value,p=s.g2.value,g=s.b2.value,A=s.a2.value,b=s.border_r.value,v=s.border_g.value,y=s.border_b.value,w=s.border_a.value;this.borderColor=[b,v,y,w*e];const E=s.thickoutline.value,_=s.textured.value,T=s.tex_zoom.value,x=s.tex_ang.value,S=s.additive.value,k=this.borderColor[3]>0,I=Math.abs(_)>=1,C=Math.abs(E)>=1,P=Math.abs(S)>=1;this.positions[0]=l,this.positions[1]=c,this.positions[2]=0,this.colors[0]=u,this.colors[1]=h,this.colors[2]=d,this.colors[3]=f*e,I&&(this.uvs[0]=.5,this.uvs[1]=.5);const M=.25*Math.PI;for(let t=1;t<=n+1;t++){const r=(t-1)/n*2*Math.PI,a=r+o+M;if(this.positions[3*t+0]=l+i*Math.cos(a)*this.aspecty,this.positions[3*t+1]=c+i*Math.sin(a),this.positions[3*t+2]=0,this.colors[4*t+0]=m,this.colors[4*t+1]=p,this.colors[4*t+2]=g,this.colors[4*t+3]=A*e,I){const e=r+x+M;this.uvs[2*t+0]=.5+.5*Math.cos(e)/T*this.aspecty,this.uvs[2*t+1]=.5+.5*Math.sin(e)/T}k&&(this.borderPositions[3*(t-1)+0]=this.positions[3*t+0],this.borderPositions[3*(t-1)+1]=this.positions[3*t+1],this.borderPositions[3*(t-1)+2]=this.positions[3*t+2])}this.drawCustomShapeInstance(a,n,I,k,C,P)}}else{this.setupShapeBuffers(r.mdVSFrame.wrap);let i=Object.assign({},r.mdVSShapes[this.index],r.mdVSFrameMapShapes[this.index],t);""===r.preset.shapes[this.index].frame_eqs_str&&(i=Object.assign(i,r.mdVSQAfterFrame,r.mdVSTShapeInits[this.index]));const s=r.preset.shapes[this.index].baseVals,o=Math.clamp(s.num_inst,1,1024);for(let t=0;t<o;t++){let n;i.instance=t,i.x=s.x,i.y=s.y,i.rad=s.rad,i.ang=s.ang,i.r=s.r,i.g=s.g,i.b=s.b,i.a=s.a,i.r2=s.r2,i.g2=s.g2,i.b2=s.b2,i.a2=s.a2,i.border_r=s.border_r,i.border_g=s.border_g,i.border_b=s.border_b,i.border_a=s.border_a,i.thickoutline=s.thickoutline,i.textured=s.textured,i.tex_zoom=s.tex_zoom,i.tex_ang=s.tex_ang,i.additive=s.additive,""!==r.preset.shapes[this.index].frame_eqs_str?(i=Object.assign(i,r.mdVSQAfterFrame,r.mdVSTShapeInits[this.index]),n=r.runShapeFrameEquations(this.index,i)):n=i;let o=n.sides;o=Math.clamp(o,3,100),o=Math.floor(o);const l=n.rad,c=n.ang,u=2*n.x-1,h=-2*n.y+1,d=n.r,f=n.g,m=n.b,p=n.a,g=n.r2,A=n.g2,b=n.b2,v=n.a2,y=n.border_r,w=n.border_g,E=n.border_b,_=n.border_a;this.borderColor=[y,w,E,_*e];const T=n.thickoutline,x=n.textured,S=n.tex_zoom,k=n.tex_ang,I=n.additive,C=this.borderColor[3]>0,P=Math.abs(x)>=1,M=Math.abs(T)>=1,R=Math.abs(I)>=1;this.positions[0]=u,this.positions[1]=h,this.positions[2]=0,this.colors[0]=d,this.colors[1]=f,this.colors[2]=m,this.colors[3]=p*e,P&&(this.uvs[0]=.5,this.uvs[1]=.5);const B=.25*Math.PI;for(let t=1;t<=o+1;t++){const r=(t-1)/o*2*Math.PI,n=r+c+B;if(this.positions[3*t+0]=u+l*Math.cos(n)*this.aspecty,this.positions[3*t+1]=h+l*Math.sin(n),this.positions[3*t+2]=0,this.colors[4*t+0]=g,this.colors[4*t+1]=A,this.colors[4*t+2]=b,this.colors[4*t+3]=v*e,P){const e=r+k+B;this.uvs[2*t+0]=.5+.5*Math.cos(e)/S*this.aspecty,this.uvs[2*t+1]=.5+.5*Math.sin(e)/S}C&&(this.borderPositions[3*(t-1)+0]=this.positions[3*t+0],this.borderPositions[3*(t-1)+1]=this.positions[3*t+1],this.borderPositions[3*(t-1)+2]=this.positions[3*t+2])}this.mdVSShapeFrame=n,this.drawCustomShapeInstance(a,o,P,C,M,R)}const l=r.mdVSUserKeysShapes[this.index],c=n.default.pick(this.mdVSShapeFrame,l);r.mdVSFrameMapShapes[this.index]=c}}setupShapeBuffers(e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.uvs,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.borderPositions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc);const t=0!==e?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,t),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,t)}drawCustomShapeInstance(e,t,r,n,i,a){if(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.positions,0,3*(t+2)),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.colors,0,4*(t+2)),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),r&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.uvs,0,2*(t+2)),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation)),this.gl.uniform1f(this.texturedLoc,r?1:0),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),a?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,t+2),n){this.gl.useProgram(this.borderShaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.borderPositions,0,3*(t+1)),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc),this.gl.uniform4fv(this.uBorderColorLoc,this.borderColor);const e=i?4:1;for(let r=0;r<e;r++){const e=2;0===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===r?this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,0]):2===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,e/this.texsizeY]):3===r&&this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,e/this.texsizeY]),this.gl.drawArrays(this.gl.LINE_STRIP,0,t+1)}}}}},"./src/rendering/sprites/border.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t={}){this.gl=e,this.positions=new Float32Array(72),this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}updateGlobals(e){this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      void main(void) {\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 u_color;\n      void main(void) {\n        fragColor = u_color;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}addTriangle(e,t,r,n){this.positions[e+0]=t[0],this.positions[e+1]=t[1],this.positions[e+2]=t[2],this.positions[e+3]=r[0],this.positions[e+4]=r[1],this.positions[e+5]=r[2],this.positions[e+6]=n[0],this.positions[e+7]=n[1],this.positions[e+8]=n[2]}generateBorder(e,t,r){if(t>0&&e[3]>0){const e=2,n=2,i=e/2,a=n/2,s=r/2,o=t/2+s,l=s*e,c=s*n,u=o*e,h=o*n;let d=[-i+l,-a+h,0],f=[-i+l,a-h,0],m=[-i+u,a-h,0],p=[-i+u,-a+h,0];return this.addTriangle(0,p,f,d),this.addTriangle(9,p,m,f),d=[i-l,-a+h,0],f=[i-l,a-h,0],m=[i-u,a-h,0],p=[i-u,-a+h,0],this.addTriangle(18,d,f,p),this.addTriangle(27,f,m,p),d=[-i+l,-a+c,0],f=[-i+l,h-a,0],m=[i-l,h-a,0],p=[i-l,-a+c,0],this.addTriangle(36,p,f,d),this.addTriangle(45,p,m,f),d=[-i+l,a-c,0],f=[-i+l,a-h,0],m=[i-l,a-h,0],p=[i-l,a-c,0],this.addTriangle(54,d,f,p),this.addTriangle(63,f,m,p),!0}return!1}drawBorder(e,t,r){this.generateBorder(e,t,r)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,e),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLES,0,this.positions.length/3))}}},"./src/rendering/sprites/darkenCenter.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t){this.gl=e,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions(),this.colors=new Float32Array([0,0,0,3/32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(e){this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions()}generatePositions(){this.positions=new Float32Array([0,0,0,-.05*this.aspecty,0,0,0,-.05,0,.05*this.aspecty,0,0,0,.05,0,-.05*this.aspecty,0,0])}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      in vec4 aColor;\n      out vec4 vColor;\n      void main(void) {\n        vColor = aColor;\n        gl_Position = vec4(aPos, 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      in vec4 vColor;\n      out vec4 fragColor;\n      void main(void) {\n        fragColor = vColor;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor")}drawDarkenCenter(e){0!==e.darken_center&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,this.positions.length/3))}}},"./src/rendering/text/titleText.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return i}));var n=r("./src/rendering/shaders/shaderUtils.js");class i{constructor(e,t={}){this.gl=e,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.textTexture=this.gl.createTexture(),this.indexBuf=e.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.vertexBuf=this.gl.createBuffer(),this.canvas=document.createElement("canvas"),this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY,this.context2D=this.canvas.getContext("2d"),this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader()}generateTitleTexture(e){this.context2D.clearRect(0,0,this.texsizeX,this.texsizeY),this.fontSize=Math.floor(this.texsizeX/256*16),this.fontSize=Math.max(this.fontSize,6),this.context2D.font=`italic ${this.fontSize}px Times New Roman`;let t=e,r=this.context2D.measureText(t).width;if(r>this.texsizeX){const e=this.texsizeX/r*.91;t=`${t.substring(0,Math.floor(t.length*e))}...`,r=this.context2D.measureText(t).width}this.context2D.fillStyle="#FFFFFF",this.context2D.fillText(t,(this.texsizeX-r)/2,this.texsizeY/2);const n=new Uint8Array(this.context2D.getImageData(0,0,this.texsizeX,this.texsizeY).data.buffer);this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,n),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY}buildPositions(){const e=[];for(let t=0;t<8;t++){const r=.2857142857142857*t-1;for(let t=0;t<16;t++){const n=.13333333333333333*t-1;e.push(n,-r,0)}}const t=[];for(let e=0;e<7;e++)for(let r=0;r<15;r++){const n=r+16*e,i=r+16*(e+1),a=r+1+16*(e+1),s=r+1+16*e;t.push(n,i,s),t.push(i,a,s)}this.vertices=new Float32Array(e),this.indices=new Uint16Array(t)}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"#version 300 es\n       const vec2 halfmad = vec2(0.5);\n       in vec2 aPos;\n       in vec2 aUv;\n       out vec2 uv_orig;\n       out vec2 uv;\n       void main(void) {\n         gl_Position = vec4(aPos, 0.0, 1.0);\n         uv_orig = aPos * halfmad + halfmad;\n         uv = aUv;\n       }"),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`#version 300 es\n       precision ${this.floatPrecision} float;\n       precision highp int;\n       precision mediump sampler2D;\n\n       in vec2 uv_orig;\n       in vec2 uv;\n       out vec4 fragColor;\n       uniform sampler2D uTexture;\n       uniform float textColor;\n\n       void main(void) {\n         fragColor = texture(uTexture, uv) * vec4(textColor);\n       }`),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.uvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.textColorLoc=this.gl.getUniformLocation(this.shaderProgram,"textColor")}generateUvs(e,t,r){const n=[];for(let r=0;r<8;r++)for(let i=0;i<16;i++){const a=i/15*2-1;let s=2*(.75*(r/7-.5)+.5)-1;e>=1&&(s+=1/this.texsizeY),n.push(a,t?s:-s)}const i=Math.max(0,1-1.5*e)**1.8*1.3;for(let e=0;e<8;e++)for(let t=0;t<16;t++){const a=16*e+t;n[a]+=.07*i*Math.sin(.31*r.time+.39*n[a]-1.94*n[a+1]),n[a]+=.044*i*Math.sin(.81*r.time-1.91*n[a]+.27*n[a+1]),n[a]+=.061*i*Math.sin(1.31*r.time+.61*n[a]+.74*n[a+1]),n[a+1]+=.061*i*Math.sin(.37*r.time+1.83*n[a]+.69*n[a+1]),n[a+1]+=.07*i*Math.sin(.67*r.time+.42*n[a]-1.39*n[a+1]),n[a+1]+=.087*i*Math.sin(1.07*r.time+3.55*n[a]+.89*n[a+1])}const a=1.01/(e**.21+.01);for(let e=0;e<n.length/2;e++)n[2*e]*=a,n[2*e+1]*=a*this.invAspecty,n[2*e]=(n[2*e]+1)/2,n[2*e+1]=(n[2*e+1]+1)/2;return new Float32Array(n)}renderTitle(e,t,r){this.gl.useProgram(this.shaderProgram);const n=this.generateUvs(e,t,r);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.uvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.uvLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.uniform1i(this.textureLoc,0),this.gl.uniform1f(this.textColorLoc,e**.3),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0)}}},"./src/rendering/waves/basicWaveform.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return a}));var n=r("./src/rendering/shaders/shaderUtils.js"),i=r("./src/rendering/waves/waveUtils.js");class a{constructor(e,t={}){this.gl=e,this.positions=new Float32Array(1536),this.positions2=new Float32Array(1536),this.oldPositions=new Float32Array(1536),this.oldPositions2=new Float32Array(1536),this.smoothedPositions=new Float32Array(3069),this.smoothedPositions2=new Float32Array(3069),this.color=[0,0,0,1],this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=n.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      in vec3 aPos;\n      uniform vec2 thickOffset;\n      void main(void) {\n        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      out vec4 fragColor;\n      uniform vec4 u_color;\n      void main(void) {\n        fragColor = u_color;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}static processWaveform(e,t){const r=[],n=t.wave_scale/128,i=t.wave_smoothing,a=n*(1-i);r.push(e[0]*n);for(let t=1;t<e.length;t++)r.push(e[t]*a+r[t-1]*i);return r}generateWaveform(e,t,r,n,s){let o=s.wave_a;const l=(s.bass+s.mid+s.treb)/3;if(l>-.01&&o>.001&&r.length>0){const c=a.processWaveform(r,s),u=a.processWaveform(n,s),h=Math.floor(s.wave_mode)%8,d=Math.floor(s.old_wave_mode)%8,f=2*s.wave_x-1,m=2*s.wave_y-1;this.numVert=0,this.oldNumVert=0;const p=e&&h!==d?2:1;for(let e=0;e<p;e++){const t=0===e?h:d;let r,n,i,a=s.wave_mystery;if(0!==t&&1!==t&&4!==t||!(a<-1||a>1)||(a=.5*a+.5,a-=Math.floor(a),a=Math.abs(a),a=2*a-1),0===e?(n=this.positions,i=this.positions2):(n=this.oldPositions,i=this.oldPositions2),o=s.wave_a,0===t){if(s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=Math.floor(c.length/2)+1;const e=1/(r-1),t=Math.floor((c.length-r)/2);for(let i=0;i<r-1;i++){let o=.5+.4*u[i+t]+a;const l=i*e*2*Math.PI+.2*s.time;if(i<r/10){let e=i/(.1*r);e=.5-.5*Math.cos(e*Math.PI),o=(1-e)*(.5+.4*u[i+r+t]+a)+o*e}n[3*i+0]=o*Math.cos(l)*this.aspecty+f,n[3*i+1]=o*Math.sin(l)*this.aspectx+m,n[3*i+2]=0}n[3*(r-1)+0]=n[0],n[3*(r-1)+1]=n[1],n[3*(r-1)+2]=0}else if(1===t){if(o*=1.25,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=Math.floor(c.length/2);for(let e=0;e<r;e++){const t=.53+.43*u[e]+a,r=.5*c[e+32]*Math.PI+2.3*s.time;n[3*e+0]=t*Math.cos(r)*this.aspecty+f,n[3*e+1]=t*Math.sin(r)*this.aspectx+m,n[3*e+2]=0}}else if(2===t){if(this.texsizeX<1024?o*=.09:this.texsizeX>=1024&&this.texsizeX<2048?o*=.11:o*=.13,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=c.length;for(let e=0;e<c.length;e++)n[3*e+0]=u[e]*this.aspecty+f,n[3*e+1]=c[(e+32)%c.length]*this.aspectx+m,n[3*e+2]=0}else if(3===t){if(this.texsizeX<1024?o*=.15:this.texsizeX>=1024&&this.texsizeX<2048?o*=.22:o*=.33,o*=1.3,o*=s.treb*s.treb,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=c.length;for(let e=0;e<c.length;e++)n[3*e+0]=u[e]*this.aspecty+f,n[3*e+1]=c[(e+32)%c.length]*this.aspectx+m,n[3*e+2]=0}else if(4===t){if(s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=c.length,r>this.texsizeX/3&&(r=Math.floor(this.texsizeX/3));const e=1/r,t=Math.floor((c.length-r)/2),i=.45+.5*(.5*a+.5),h=1-i;for(let a=0;a<r;a++){let r=2*a*e+(f-1)+.44*u[(a+25+t)%c.length],s=.47*c[a+t]+m;a>1&&(r=r*h+i*(2*n[3*(a-1)+0]-n[3*(a-2)+0]),s=s*h+i*(2*n[3*(a-1)+1]-n[3*(a-2)+1])),n[3*a+0]=r,n[3*a+1]=s,n[3*a+2]=0}}else if(5===t){if(this.texsizeX<1024?o*=.09:this.texsizeX>=1024&&this.texsizeX<2048?o*=.11:o*=.13,s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1);const e=Math.cos(.3*s.time),t=Math.sin(.3*s.time);r=c.length;for(let r=0;r<c.length;r++){const i=(r+32)%c.length,a=u[r]*c[i]+c[r]*u[i],s=u[r]*u[r]-c[i]*c[i];n[3*r+0]=(a*e-s*t)*(this.aspecty+f),n[3*r+1]=(a*t+s*e)*(this.aspectx+m),n[3*r+2]=0}}else if(6===t||7===t){if(s.modwavealphabyvolume>0){const e=s.modwavealphaend-s.modwavealphastart;o*=(l-s.modwavealphastart)/e}o=Math.clamp(o,0,1),r=Math.floor(c.length/2),r>this.texsizeX/3&&(r=Math.floor(this.texsizeX/3));const e=Math.floor((c.length-r)/2),h=.5*Math.PI*a;let d=Math.cos(h),p=Math.sin(h);const g=[f*Math.cos(h+.5*Math.PI)-3*d,f*Math.cos(h+.5*Math.PI)+3*d],A=[f*Math.sin(h+.5*Math.PI)-3*p,f*Math.sin(h+.5*Math.PI)+3*p];for(let e=0;e<2;e++)for(let t=0;t<4;t++){let r,n=!1;switch(t){case 0:g[e]>1.1&&(r=(1.1-g[1-e])/(g[e]-g[1-e]),n=!0);break;case 1:g[e]<-1.1&&(r=(-1.1-g[1-e])/(g[e]-g[1-e]),n=!0);break;case 2:A[e]>1.1&&(r=(1.1-A[1-e])/(A[e]-A[1-e]),n=!0);break;case 3:A[e]<-1.1&&(r=(-1.1-A[1-e])/(A[e]-A[1-e]),n=!0)}if(n){const t=g[e]-g[1-e],n=A[e]-A[1-e];g[e]=g[1-e]+t*r,A[e]=A[1-e]+n*r}}d=(g[1]-g[0])/r,p=(A[1]-A[0])/r;const b=Math.atan2(p,d),v=Math.cos(b+.5*Math.PI),y=Math.sin(b+.5*Math.PI);if(6===t)for(let t=0;t<r;t++){const r=c[t+e];n[3*t+0]=g[0]+d*t+.25*v*r,n[3*t+1]=A[0]+p*t+.25*y*r,n[3*t+2]=0}else if(7===t){const t=(.5*m+.5)**2;for(let i=0;i<r;i++){const r=c[i+e];n[3*i+0]=g[0]+d*i+v*(.25*r+t),n[3*i+1]=A[0]+p*i+y*(.25*r+t),n[3*i+2]=0}for(let n=0;n<r;n++){const r=u[n+e];i[3*n+0]=g[0]+d*n+v*(.25*r-t),i[3*n+1]=A[0]+p*n+y*(.25*r-t),i[3*n+2]=0}}}0===e?(this.positions=n,this.positions2=i,this.numVert=r,this.alpha=o):(this.oldPositions=n,this.oldPositions2=i,this.oldNumVert=r,this.oldAlpha=o)}const g=.5-.5*Math.cos(t*Math.PI),A=1-g;this.oldNumVert>0&&(o=g*this.alpha+A*this.oldAlpha);let b=Math.clamp(s.wave_r,0,1),v=Math.clamp(s.wave_g,0,1),y=Math.clamp(s.wave_b,0,1);if(0!==s.wave_brighten){const e=Math.max(b,v,y);e>.01&&(b/=e,v/=e,y/=e)}if(this.color=[b,v,y,o],this.oldNumVert>0)if(7===h){const e=(this.oldNumVert-1)/(2*this.numVert);for(let t=0;t<this.numVert;t++){const r=t*e,n=Math.floor(r),i=r-n,a=this.oldPositions[3*n+0]*(1-i)+this.oldPositions[3*(n+1)+0]*i,s=this.oldPositions[3*n+1]*(1-i)+this.oldPositions[3*(n+1)+1]*i;this.positions[3*t+0]=this.positions[3*t+0]*g+a*A,this.positions[3*t+1]=this.positions[3*t+1]*g+s*A,this.positions[3*t+2]=0}for(let t=0;t<this.numVert;t++){const r=(t+this.numVert)*e,n=Math.floor(r),i=r-n,a=this.oldPositions[3*n+0]*(1-i)+this.oldPositions[3*(n+1)+0]*i,s=this.oldPositions[3*n+1]*(1-i)+this.oldPositions[3*(n+1)+1]*i;this.positions2[3*t+0]=this.positions2[3*t+0]*g+a*A,this.positions2[3*t+1]=this.positions2[3*t+1]*g+s*A,this.positions2[3*t+2]=0}}else if(7===d){const e=this.numVert/2,t=(this.oldNumVert-1)/e;for(let r=0;r<e;r++){const e=r*t,n=Math.floor(e),i=e-n,a=this.oldPositions[3*n+0]*(1-i)+this.oldPositions[3*(n+1)+0]*i,s=this.oldPositions[3*n+1]*(1-i)+this.oldPositions[3*(n+1)+1]*i;this.positions[3*r+0]=this.positions[3*r+0]*g+a*A,this.positions[3*r+1]=this.positions[3*r+1]*g+s*A,this.positions[3*r+2]=0}for(let r=0;r<e;r++){const n=r*t,i=Math.floor(n),a=n-i,s=this.oldPositions2[3*i+0]*(1-a)+this.oldPositions2[3*(i+1)+0]*a,o=this.oldPositions2[3*i+1]*(1-a)+this.oldPositions2[3*(i+1)+1]*a;this.positions2[3*r+0]=this.positions[3*(r+e)+0]*g+s*A,this.positions2[3*r+1]=this.positions[3*(r+e)+1]*g+o*A,this.positions2[3*r+2]=0}}else{const e=(this.oldNumVert-1)/this.numVert;for(let t=0;t<this.numVert;t++){const r=t*e,n=Math.floor(r),i=r-n,a=this.oldPositions[3*n+0]*(1-i)+this.oldPositions[3*(n+1)+0]*i,s=this.oldPositions[3*n+1]*(1-i)+this.oldPositions[3*(n+1)+1]*i;this.positions[3*t+0]=this.positions[3*t+0]*g+a*A,this.positions[3*t+1]=this.positions[3*t+1]*g+s*A,this.positions[3*t+2]=0}}for(let e=0;e<this.numVert;e++)this.positions[3*e+1]=-this.positions[3*e+1];if(this.smoothedNumVert=2*this.numVert-1,i.default.smoothWave(this.positions,this.smoothedPositions,this.numVert),7===h||7===d){for(let e=0;e<this.numVert;e++)this.positions2[3*e+1]=-this.positions2[3*e+1];i.default.smoothWave(this.positions2,this.smoothedPositions2,this.numVert)}return!0}return!1}drawBasicWaveform(e,t,r,n,i){if(this.generateWaveform(e,t,r,n,i)){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color);let e=1;0===i.wave_thick&&0===i.wave_dots||(e=4),0!==i.additivewave?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const t=0!==i.wave_dots?this.gl.POINTS:this.gl.LINE_STRIP;for(let r=0;r<e;r++){const e=2;0===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===r?this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,0]):2===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,e/this.texsizeY]):3===r&&this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,e/this.texsizeY]),this.gl.drawArrays(t,0,this.smoothedNumVert)}if(7==Math.floor(i.wave_mode)%8){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions2,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc);for(let r=0;r<e;r++){const e=2;0===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===r?this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,0]):2===r?this.gl.uniform2fv(this.thickOffsetLoc,[0,e/this.texsizeY]):3===r&&this.gl.uniform2fv(this.thickOffsetLoc,[e/this.texsizeX,e/this.texsizeY]),this.gl.drawArrays(t,0,this.smoothedNumVert)}}}}}},"./src/rendering/waves/customWaveform.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return s}));var n=r("./src/utils.js"),i=r("./src/rendering/shaders/shaderUtils.js"),a=r("./src/rendering/waves/waveUtils.js");class s{constructor(e,t,r){this.index=e,this.gl=t;this.pointsData=[new Float32Array(512),new Float32Array(512)],this.positions=new Float32Array(1536),this.colors=new Float32Array(2048),this.smoothedPositions=new Float32Array(3069),this.smoothedColors=new Float32Array(4092),this.texsizeX=r.texsizeX,this.texsizeY=r.texsizeY,this.mesh_width=r.mesh_width,this.mesh_height=r.mesh_height,this.aspectx=r.aspectx,this.aspecty=r.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=i.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,"\n      #version 300 es\n      uniform float uSize;\n      uniform vec2 thickOffset;\n      in vec3 aPos;\n      in vec4 aColor;\n      out vec4 vColor;\n      void main(void) {\n        vColor = aColor;\n        gl_PointSize = uSize;\n        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);\n      }\n      ".trim()),this.gl.compileShader(e);const t=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(t,`\n      #version 300 es\n      precision ${this.floatPrecision} float;\n      precision highp int;\n      precision mediump sampler2D;\n      in vec4 vColor;\n      out vec4 fragColor;\n      void main(void) {\n        fragColor = vColor;\n      }\n      `.trim()),this.gl.compileShader(t),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,t),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.sizeLoc=this.gl.getUniformLocation(this.shaderProgram,"uSize"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}generateWaveform(e,t,r,i,s,o,l,c){if(0!==l.baseVals.enabled&&e.length>0){let u;if(o.preset.useWASM)u=o.runWaveFrameEquations(this.index,s);else{const e=Object.assign({},o.mdVSWaves[this.index],o.mdVSFrameMapWaves[this.index],o.mdVSQAfterFrame,o.mdVSTWaveInits[this.index],s);u=o.runWaveFrameEquations(this.index,e)}const h=512;Object.prototype.hasOwnProperty.call(u,"samples")?this.samples=u.samples:this.samples=h,this.samples>h&&(this.samples=h),this.samples=Math.floor(this.samples);const d=o.preset.waves[this.index].baseVals,f=Math.floor(u.sep),m=u.scaling,p=u.spectrum,g=u.smoothing,A=d.usedots,b=u.r,v=u.g,y=u.b,w=u.a,E=o.preset.baseVals.wave_scale;if(this.samples-=f,this.samples>=2||0!==A&&this.samples>=1){const s=0!==p,_=(s?.15:.004)*m*E,T=s?r:e,x=s?i:t,S=s?0:Math.floor((h-this.samples)/2-f/2),k=s?0:Math.floor((h-this.samples)/2+f/2),I=s?(h-f)/this.samples:1,C=(.98*g)**.5,P=1-C;this.pointsData[0][0]=T[S],this.pointsData[1][0]=x[k];for(let e=1;e<this.samples;e++){const t=T[Math.floor(e*I+S)],r=x[Math.floor(e*I+k)];this.pointsData[0][e]=t*P+this.pointsData[0][e-1]*C,this.pointsData[1][e]=r*P+this.pointsData[1][e-1]*C}for(let e=this.samples-2;e>=0;e--)this.pointsData[0][e]=this.pointsData[0][e]*P+this.pointsData[0][e+1]*C,this.pointsData[1][e]=this.pointsData[1][e]*P+this.pointsData[1][e+1]*C;for(let e=0;e<this.samples;e++)this.pointsData[0][e]*=_,this.pointsData[1][e]*=_;if(o.preset.useWASM){const e=o.preset.globalPools[`wavePerFrame${this.index}`];for(let t=0;t<this.samples;t++){const r=this.pointsData[0][t],n=this.pointsData[1][t];e.sample.value=t/(this.samples-1),e.value1.value=r,e.value2.value=n,e.x.value=.5+r,e.y.value=.5+n,e.r.value=b,e.g.value=v,e.b.value=y,e.a.value=w,l.point_eqs&&o.preset.waves[this.index].point_eqs();const i=(2*e.x.value-1)*this.invAspectx,a=(-2*e.y.value+1)*this.invAspecty,s=e.r.value,u=e.g.value,h=e.b.value,d=e.a.value;this.positions[3*t+0]=i,this.positions[3*t+1]=a,this.positions[3*t+2]=0,this.colors[4*t+0]=s,this.colors[4*t+1]=u,this.colors[4*t+2]=h,this.colors[4*t+3]=d*c}}else for(let e=0;e<this.samples;e++){const t=this.pointsData[0][e],r=this.pointsData[1][e];u.sample=e/(this.samples-1),u.value1=t,u.value2=r,u.x=.5+t,u.y=.5+r,u.r=b,u.g=v,u.b=y,u.a=w,""!==l.point_eqs&&(u=o.runWavePointEquations(this.index,u));const n=(2*u.x-1)*this.invAspectx,i=(-2*u.y+1)*this.invAspecty,a=u.r,s=u.g,h=u.b,d=u.a;this.positions[3*e+0]=n,this.positions[3*e+1]=i,this.positions[3*e+2]=0,this.colors[4*e+0]=a,this.colors[4*e+1]=s,this.colors[4*e+2]=h,this.colors[4*e+3]=d*c}if(o.preset.useWASM)u.usedots=A,u.thick=d.thick,u.additive=d.additive;else{const e=o.mdVSUserKeysWaves[this.index],t=n.default.pick(u,e);o.mdVSFrameMapWaves[this.index]=t}return this.mdVSWaveFrame=u,0===A&&a.default.smoothWaveAndColor(this.positions,this.colors,this.smoothedPositions,this.smoothedColors,this.samples),!0}}return!1}drawCustomWaveform(e,t,r,n,i,a,s,o){if(o&&this.generateWaveform(t,r,n,i,a,s,o,e)){this.gl.useProgram(this.shaderProgram);const e=0!==this.mdVSWaveFrame.usedots,t=0!==this.mdVSWaveFrame.thick,r=0!==this.mdVSWaveFrame.additive;let n,i,a;e?(n=this.positions,i=this.colors,a=this.samples):(n=this.smoothedPositions,i=this.smoothedColors,a=2*this.samples-1),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,i,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation);let s=1;e?t?this.gl.uniform1f(this.sizeLoc,2+(this.texsizeX>=1024?1:0)):this.gl.uniform1f(this.sizeLoc,1+(this.texsizeX>=1024?1:0)):(this.gl.uniform1f(this.sizeLoc,1),t&&(s=4)),r?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const o=e?this.gl.POINTS:this.gl.LINE_STRIP;for(let e=0;e<s;e++){const t=2;0===e?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):1===e?this.gl.uniform2fv(this.thickOffsetLoc,[t/this.texsizeX,0]):2===e?this.gl.uniform2fv(this.thickOffsetLoc,[0,t/this.texsizeY]):3===e&&this.gl.uniform2fv(this.thickOffsetLoc,[t/this.texsizeX,t/this.texsizeY]),this.gl.drawArrays(o,0,a)}}}}},"./src/rendering/waves/waveUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{static smoothWave(e,t,r,n=!1){let i,a=0,s=0,o=1;for(let l=0;l<r-1;l++){i=o,o=Math.min(r-1,l+2);for(let r=0;r<3;r++)t[3*a+r]=e[3*l+r];if(n)for(let r=0;r<3;r++)t[3*(a+1)+r]=.5*(-.15*e[3*s+r]+1.15*e[3*l+r]+1.15*e[3*i+r]+-.15*e[3*o+r]);else{for(let r=0;r<2;r++)t[3*(a+1)+r]=.5*(-.15*e[3*s+r]+1.15*e[3*l+r]+1.15*e[3*i+r]+-.15*e[3*o+r]);t[3*(a+1)+2]=0}s=l,a+=2}for(let n=0;n<3;n++)t[3*a+n]=e[3*(r-1)+n]}static smoothWaveAndColor(e,t,r,n,i,a=!1){let s,o=0,l=0,c=1;for(let u=0;u<i-1;u++){s=c,c=Math.min(i-1,u+2);for(let t=0;t<3;t++)r[3*o+t]=e[3*u+t];if(a)for(let t=0;t<3;t++)r[3*(o+1)+t]=.5*(-.15*e[3*l+t]+1.15*e[3*u+t]+1.15*e[3*s+t]+-.15*e[3*c+t]);else{for(let t=0;t<2;t++)r[3*(o+1)+t]=.5*(-.15*e[3*l+t]+1.15*e[3*u+t]+1.15*e[3*s+t]+-.15*e[3*c+t]);r[3*(o+1)+2]=0}for(let e=0;e<4;e++)n[4*o+e]=t[4*u+e],n[4*(o+1)+e]=t[4*u+e];l=u,o+=2}for(let t=0;t<3;t++)r[3*o+t]=e[3*(i-1)+t];for(let e=0;e<4;e++)n[4*o+e]=t[4*(i-1)+e]}}},"./src/utils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return n}));class n{static atan2(e,t){let r=Math.atan2(e,t);return r<0&&(r+=2*Math.PI),r}static cloneVars(e){return Object.assign({},e)}static range(e,t){return void 0===t?[...Array(e).keys()]:Array.from({length:t-e},((t,r)=>r+e))}static pick(e,t){const r={};for(let n=0;n<t.length;n++){const i=t[n];r[i]=e[i]||0}return r}static omit(e,t){const r=Object.assign({},e);for(let e=0;e<t.length;e++)delete r[t[e]];return r}static setWasm(e,t,r){for(let n=0;n<r.length;n++){const i=r[n];e[i].value=t[i]}}static pickWasm(e,t){const r={};for(let n=0;n<t.length;n++){const i=t[n];r[i]=e[i].value}return r}}},"./src/visualizer.js":function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return m}));var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),i=r.n(n),a=r("./node_modules/eel-wasm/dist/src/index.js"),s=r("./node_modules/@assemblyscript/loader/index.js"),o=r("./src/audio/audioProcessor.js"),l=r("./src/rendering/renderer.js"),c=r("./src/utils.js"),u=r("./src/assemblyscript/presetFunctions.ts"),h=r.n(u);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class m{constructor(e,t,r){this.opts=r,this.audio=new o.default(e);const n=r.width||1200,i=r.height||900;this.internalCanvas=document.createElement("canvas"),this.internalCanvas.width=n,this.internalCanvas.height=i,this.gl=this.internalCanvas.getContext("webgl2",{alpha:!1,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1}),this.outputGl=t.getContext("2d"),this.baseValsDefaults={decay:.98,gammaadj:2,echo_zoom:2,echo_alpha:0,echo_orient:0,red_blue:0,brighten:0,darken:0,wrap:1,darken_center:0,solarize:0,invert:0,bmotionvectorson:1,fshader:0,b1n:0,b2n:0,b3n:0,b1x:1,b2x:1,b3x:1,b1ed:.25,wave_mode:0,additivewave:0,wave_dots:0,wave_thick:0,wave_a:.8,wave_scale:1,wave_smoothing:.75,wave_mystery:0,modwavealphabyvolume:0,modwavealphastart:.75,modwavealphaend:.95,wave_r:1,wave_g:1,wave_b:1,wave_x:.5,wave_y:.5,wave_brighten:1,mv_x:12,mv_y:9,mv_dx:0,mv_dy:0,mv_l:.9,mv_r:1,mv_g:1,mv_b:1,mv_a:1,warpanimspeed:1,warpscale:1,zoomexp:1,zoom:1,rot:0,cx:.5,cy:.5,dx:0,dy:0,warp:1,sx:1,sy:1,ob_size:.01,ob_r:0,ob_g:0,ob_b:0,ob_a:0,ib_size:.01,ib_r:.25,ib_g:.25,ib_b:.25,ib_a:0},this.shapeBaseValsDefaults={enabled:0,sides:4,additive:0,thickoutline:0,textured:0,num_inst:1,tex_zoom:1,tex_ang:0,x:.5,y:.5,rad:.1,ang:0,r:1,g:0,b:0,a:1,r2:0,g2:1,b2:0,a2:0,border_r:1,border_g:1,border_b:1,border_a:.1},this.waveBaseValsDefaults={enabled:0,samples:512,sep:0,scaling:1,smoothing:.5,r:1,g:1,b:1,a:1,spectrum:0,usedots:0,thick:0,additive:0},this.qs=c.default.range(1,33).map((e=>`q${e}`)),this.ts=c.default.range(1,9).map((e=>`t${e}`)),this.globalPerFrameVars=["old_wave_mode","frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset"],this.globalPerPixelVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","x","y","rad","ang"],this.globalShapeVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","instance"],this.shapeBaseVars=["x","y","rad","ang","r","g","b","a","r2","g2","b2","a2","border_r","border_g","border_b","border_a","thickoutline","textured","tex_zoom","tex_ang","additive"],this.globalWaveVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","x","y","sample","value1","value2"],this.renderer=new l.default(this.gl,this.audio,r)}loseGLContext(){this.gl.getExtension("WEBGL_lose_context").loseContext(),this.outputGl=null}connectAudio(e){this.audioNode=e,this.audio.connectAudio(e)}disconnectAudio(e){this.audio.disconnectAudio(e)}static overrideDefaultVars(e,t){const r={};return Object.keys(e).forEach((n=>{Object.prototype.hasOwnProperty.call(t,n)?r[n]=t[n]:r[n]=e[n]})),r}createQVars(){const e={};return this.qs.forEach((t=>{e[t]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),e}createTVars(){const e={};return this.ts.forEach((t=>{e[t]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),e}createPerFramePool(e){const t={};return Object.keys(this.baseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalPerFrameVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}createPerPixelPool(e){const t={};return Object.keys(this.baseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalPerPixelVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}createCustomShapePerFramePool(e){const t={};return Object.keys(this.shapeBaseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalShapeVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}createCustomWavePerFramePool(e){const t={};return Object.keys(this.waveBaseValsDefaults).forEach((r=>{t[r]=new WebAssembly.Global({value:"f64",mutable:!0},e[r])})),this.globalWaveVars.forEach((e=>{t[e]=new WebAssembly.Global({value:"f64",mutable:!0},0)})),t}static makeShapeResetPool(e,t,r){return t.reduce(((t,n)=>f(f({},t),{},{[`${n}_${r}`]:e[n]})),{})}static base64ToArrayBuffer(e){for(var t=window.atob(e),r=t.length,n=new Uint8Array(r),i=0;i<r;i++)n[i]=t.charCodeAt(i);return n.buffer}async loadPreset(e,t=0){const r=JSON.parse(JSON.stringify(e));r.baseVals=m.overrideDefaultVars(this.baseValsDefaults,r.baseVals);for(let e=0;e<r.shapes.length;e++)r.shapes[e].baseVals=m.overrideDefaultVars(this.shapeBaseValsDefaults,r.shapes[e].baseVals);for(let e=0;e<r.waves.length;e++)r.waves[e].baseVals=m.overrideDefaultVars(this.waveBaseValsDefaults,r.waves[e].baseVals);const n=r.useJS&&!this.opts.onlyUseWASM;Object.prototype.hasOwnProperty.call(r,"init_eqs_eel")&&!n?(r.useWASM=!0,await this.loadWASMPreset(r,t)):this.opts.onlyUseWASM?console.warn("Tried to load a preset that doesn't support WASM with onlyUseWASM on"):Object.prototype.hasOwnProperty.call(r,"init_eqs_str")?this.loadJSPreset(r,t):console.warn("Tried to load a JS preset that doesn't have converted strings")}async loadWASMPreset(e,t){const r=this.createQVars(),n=this.createTVars(),i={perFrame:f(f({},r),this.createPerFramePool(e.baseVals)),perVertex:f(f({},r),this.createPerPixelPool(e.baseVals))},o={presetInit:{pool:"perFrame",code:e.init_eqs_eel},perFrame:{pool:"perFrame",code:e.frame_eqs_eel}};""!==e.pixel_eqs_eel&&(o.perPixel={pool:"perVertex",code:e.pixel_eqs_eel});for(let t=0;t<e.shapes.length;t++)i[`shapePerFrame${t}`]=f(f(f({},r),n),this.createCustomShapePerFramePool(e.shapes[t].baseVals)),0!==e.shapes[t].baseVals.enabled&&(o[`shapes_${t}_init_eqs`]={pool:`shapePerFrame${t}`,code:e.shapes[t].init_eqs_eel},o[`shapes_${t}_frame_eqs`]={pool:`shapePerFrame${t}`,code:e.shapes[t].frame_eqs_eel});for(let t=0;t<e.waves.length;t++)0!==e.waves[t].baseVals.enabled&&(i[`wavePerFrame${t}`]=f(f(f({},r),n),this.createCustomWavePerFramePool(e.waves[t].baseVals)),o[`waves_${t}_init_eqs`]={pool:`wavePerFrame${t}`,code:e.waves[t].init_eqs_eel},o[`waves_${t}_frame_eqs`]={pool:`wavePerFrame${t}`,code:e.waves[t].frame_eqs_eel},e.waves[t].point_eqs_eel&&""!==e.waves[t].point_eqs_eel&&(o[`waves_${t}_point_eqs`]={pool:`wavePerFrame${t}`,code:e.waves[t].point_eqs_eel}));const l=await Object(a.loadModule)({pools:i,functions:o,eelVersion:e.version||2}),c=e=>e||(()=>{}),u=await s.default.instantiate(m.base64ToArrayBuffer(h()()),{pixelEqs:{perPixelEqs:c(l.exports.perPixel)},pixelVarPool:{warp:i.perVertex.warp,zoom:i.perVertex.zoom,zoomexp:i.perVertex.zoomexp,cx:i.perVertex.cx,cy:i.perVertex.cy,sx:i.perVertex.sx,sy:i.perVertex.sy,dx:i.perVertex.dx,dy:i.perVertex.dy,rot:i.perVertex.rot,x:i.perVertex.x,y:i.perVertex.y,ang:i.perVertex.ang,rad:i.perVertex.rad},qVarPool:r,tVarPool:n,shapePool0:m.makeShapeResetPool(i.shapePerFrame0,this.shapeBaseVars,0),shapePool1:m.makeShapeResetPool(i.shapePerFrame1,this.shapeBaseVars,1),shapePool2:m.makeShapeResetPool(i.shapePerFrame2,this.shapeBaseVars,2),shapePool3:m.makeShapeResetPool(i.shapePerFrame3,this.shapeBaseVars,3),console:{logi:e=>{console.log("logi: "+e)},logf:e=>{console.log("logf: "+e)}},env:{abort:()=>{}}});e.globalPools=i,e.init_eqs=c(l.exports.presetInit),e.frame_eqs=c(l.exports.perFrame),e.save_qs=u.exports.saveQs,e.restore_qs=u.exports.restoreQs,e.save_ts=u.exports.saveTs,e.restore_ts=u.exports.restoreTs,l.exports.perPixel&&(e.pixel_eqs=l.exports.perPixel),e.pixel_eqs_initialize_array=(t,r)=>{const n=u.exports.createFloat32Array((t+1)*(r+1)*2);e.pixel_eqs_array=n},e.pixel_eqs_get_array=()=>u.exports.__getFloat32ArrayView(e.pixel_eqs_array),e.pixel_eqs_wasm=(...t)=>u.exports.runPixelEquations(e.pixel_eqs_array,...t);for(let t=0;t<e.shapes.length;t++)0!==e.shapes[t].baseVals.enabled&&(e.shapes[t].init_eqs=c(l.exports[`shapes_${t}_init_eqs`]),e.shapes[t].frame_eqs=l.exports[`shapes_${t}_frame_eqs`],e.shapes[t].frame_eqs_save=()=>u.exports[`shape${t}_save`](),e.shapes[t].frame_eqs_restore=()=>u.exports[`shape${t}_restore`]());for(let t=0;t<e.waves.length;t++)if(0!==e.waves[t].baseVals.enabled){const r={init_eqs:c(l.exports[`waves_${t}_init_eqs`]),frame_eqs:c(l.exports[`waves_${t}_frame_eqs`])};e.waves[t].point_eqs_eel&&""!==e.waves[t].point_eqs_eel?r.point_eqs=l.exports[`waves_${t}_point_eqs`]:r.point_eqs="",e.waves[t]=Object.assign({},e.waves[t],r)}this.renderer.loadPreset(e,t)}loadJSPreset(e,t){if("function"!=typeof e.init_eqs){e.init_eqs=new Function("a",`${e.init_eqs_str} return a;`),e.frame_eqs=new Function("a",`${e.frame_eqs_str} return a;`),e.pixel_eqs_str&&""!==e.pixel_eqs_str?e.pixel_eqs=new Function("a",`${e.pixel_eqs_str} return a;`):e.pixel_eqs="";for(let t=0;t<e.shapes.length;t++)0!==e.shapes[t].baseVals.enabled&&(e.shapes[t]=Object.assign({},e.shapes[t],{init_eqs:new Function("a",`${e.shapes[t].init_eqs_str} return a;`),frame_eqs:new Function("a",`${e.shapes[t].frame_eqs_str} return a;`)}));for(let t=0;t<e.waves.length;t++)if(0!==e.waves[t].baseVals.enabled){const r={init_eqs:new Function("a",`${e.waves[t].init_eqs_str} return a;`),frame_eqs:new Function("a",`${e.waves[t].frame_eqs_str} return a;`)};e.waves[t].point_eqs_str&&""!==e.waves[t].point_eqs_str?r.point_eqs=new Function("a",`${e.waves[t].point_eqs_str} return a;`):r.point_eqs="",e.waves[t]=Object.assign({},e.waves[t],r)}}this.renderer.loadPreset(e,t)}loadExtraImages(e){this.renderer.loadExtraImages(e)}setRendererSize(e,t,r={}){this.internalCanvas.width=e,this.internalCanvas.height=t,this.renderer.setRendererSize(e,t,r)}setInternalMeshSize(e,t){this.renderer.setInternalMeshSize(e,t)}setOutputAA(e){this.renderer.setOutputAA(e)}setCanvas(e){this.outputGl=e.getContext("2d")}render(e){const t=this.renderer.render(e);return this.outputGl&&this.outputGl.drawImage(this.internalCanvas,0,0),t}launchSongTitleAnim(e){this.renderer.launchSongTitleAnim(e)}toDataURL(){return this.renderer.toDataURL()}warpBufferToDataURL(){return this.renderer.warpBufferToDataURL()}}}})},e.exports=t()},487:e=>{var t={utf8:{stringToBytes:function(e){return t.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(t.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=t},7811:(e,t)=>{"use strict";var r=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,n=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,i=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,a=/\\([\u000b\u0020-\u00ff])/g,s=/([\\"])/g,o=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;function l(e){var t=String(e);if(i.test(t))return t;if(t.length>0&&!n.test(t))throw new TypeError("invalid parameter value");return'"'+t.replace(s,"\\$1")+'"'}function c(e){this.parameters=Object.create(null),this.type=e}t.format=function(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var t=e.parameters,r=e.type;if(!r||!o.test(r))throw new TypeError("invalid type");var n=r;if(t&&"object"==typeof t)for(var a,s=Object.keys(t).sort(),c=0;c<s.length;c++){if(a=s[c],!i.test(a))throw new TypeError("invalid parameter name");n+="; "+a+"="+l(t[a])}return n},t.parse=function(e){if(!e)throw new TypeError("argument string is required");var t="object"==typeof e?function(e){var t;if("function"==typeof e.getHeader?t=e.getHeader("content-type"):"object"==typeof e.headers&&(t=e.headers&&e.headers["content-type"]),"string"!=typeof t)throw new TypeError("content-type header is missing from object");return t}(e):e;if("string"!=typeof t)throw new TypeError("argument string is required to be a string");var n=t.indexOf(";"),i=-1!==n?t.substr(0,n).trim():t.trim();if(!o.test(i))throw new TypeError("invalid media type");var s=new c(i.toLowerCase());if(-1!==n){var l,u,h;for(r.lastIndex=n;u=r.exec(t);){if(u.index!==n)throw new TypeError("invalid parameter format");n+=u[0].length,l=u[1].toLowerCase(),'"'===(h=u[2])[0]&&(h=h.substr(1,h.length-2).replace(a,"$1")),s.parameters[l]=h}if(n!==t.length)throw new TypeError("invalid parameter format")}return s}},1012:e=>{var t,r;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var r=[],n=0;n<e.length;n+=3)for(var i=e[n]<<16|e[n+1]<<8|e[n+2],a=0;a<4;a++)8*n+6*a<=8*e.length?r.push(t.charAt(i>>>6*(3-a)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],n=0,i=0;n<e.length;i=++n%4)0!=i&&r.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*i+8)-1)<<2*i|t.indexOf(e.charAt(n))>>>6-2*i);return r}},e.exports=r},1227:(e,t,r)=>{var n=r(4155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(2447)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},2447:(e,t,r)=>{e.exports=function(e){function t(e){let r,i,a,s=null;function o(...e){if(!o.enabled)return;const n=o,i=Number(new Date),a=i-(r||i);n.diff=a,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";s++;const a=t.formatters[i];if("function"==typeof a){const t=e[s];r=a.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=n,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,a=t.enabled(e)),a),set:e=>{s=e}}),"function"==typeof t.init&&t.init(o),o}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(7824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},7187:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,a),n(r)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}p(e,t,a,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&p(e,"error",t,{once:!0})}(e,i)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function o(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var i,a,s,c;if(o(r),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]),void 0===s)s=a[t]=r,++e._eventsCount;else if("function"==typeof s?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=l(e))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,c=u,console&&console.warn&&console.warn(c)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=u.bind(n);return i.listener=r,n.wrapFn=i,i}function d(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):m(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function m(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function p(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(a){n.once&&e.removeEventListener(t,i),r(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,a=this._events;if(void 0!==a)i=i&&void 0===a.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var l=a[e];if(void 0===l)return!1;if("function"==typeof l)n(l,this,t);else{var c=l.length,u=m(l,c);for(r=0;r<c;++r)n(u[r],this,t)}return!0},a.prototype.addListener=function(e,t){return c(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return c(this,e,t,!0)},a.prototype.once=function(e,t){return o(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,i,a,s;if(o(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){s=r[a].listener,i=a;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,a=Object.keys(r);for(n=0;n<a.length;++n)"removeListener"!==(i=a[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return d(this,e,!0)},a.prototype.rawListeners=function(e){return d(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},1:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var Buffer=__webpack_require__(8764).Buffer;const Token=__webpack_require__(3416),strtok3=__webpack_require__(5849),{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=__webpack_require__(6188),supported=__webpack_require__(9898),minimumBytes=4100;async function fromStream(e){const t=await strtok3.fromStream(e);try{return await fromTokenizer(t)}finally{await t.close()}}async function fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||Buffer.isBuffer(e)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof e}\``);const t=e instanceof Buffer?e:Buffer.from(e);if(t&&t.length>1)return fromTokenizer(strtok3.fromBuffer(t))}function _check(e,t,r){r={offset:0,...r};for(const[n,i]of t.entries())if(r.mask){if(i!==(r.mask[n]&e[n+r.offset]))return!1}else if(i!==e[n+r.offset])return!1;return!0}async function fromTokenizer(e){try{return _fromTokenizer(e)}catch(e){if(!(e instanceof strtok3.EndOfStreamError))throw e}}async function _fromTokenizer(e){let t=Buffer.alloc(minimumBytes);const r=(e,r)=>_check(t,e,r),n=(e,t)=>r(stringToBytes(e),t);if(e.fileInfo.size||(e.fileInfo.size=Number.MAX_SAFE_INTEGER),await e.peekBuffer(t,{length:12,mayBeLess:!0}),r([66,77]))return{ext:"bmp",mime:"image/bmp"};if(r([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(r([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(r([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(r([37,33]))return await e.peekBuffer(t,{length:24,mayBeLess:!0}),n("PS-Adobe-",{offset:2})&&n(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(r([31,160])||r([31,157]))return{ext:"Z",mime:"application/x-compress"};if(r([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(r([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(r([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(r([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(n("ID3")){await e.ignore(6);const i=await e.readToken(uint32SyncSafeToken);return e.position+i>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(i),fromTokenizer(e))}if(n("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===t[0]||70===t[0])&&r([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(r([71,73,70]))return{ext:"gif",mime:"image/gif"};if(n("FLIF"))return{ext:"flif",mime:"image/flif"};if(n("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(n("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(n("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(n("FORM"))return{ext:"aif",mime:"audio/aiff"};if(n("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(r([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(t,{length:30});const a={compressedSize:t.readUInt32LE(18),uncompressedSize:t.readUInt32LE(22),filenameLength:t.readUInt16LE(26),extraFieldLength:t.readUInt16LE(28)};if(a.filename=await e.readToken(new Token.StringType(a.filenameLength,"utf-8")),await e.ignore(a.extraFieldLength),"META-INF/mozilla.rsa"===a.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(a.filename.endsWith(".rels")||a.filename.endsWith(".xml"))switch(a.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}if(a.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(a.filename.startsWith("3D/")&&a.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===a.filename&&a.compressedSize===a.uncompressedSize)switch(await e.readToken(new Token.StringType(a.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}if(0===a.compressedSize){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(t,{mayBeLess:!0}),s=t.indexOf("504B0304",0,"hex"),await e.ignore(s>=0?s:t.length)}else await e.ignore(a.compressedSize)}}catch(o){if(!(o instanceof strtok3.EndOfStreamError))throw o}return{ext:"zip",mime:"application/zip"}}if(n("OggS")){await e.ignore(28);const l=Buffer.alloc(8);return await e.readBuffer(l),_check(l,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(l,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(l,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(l,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(l,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(l,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(r([80,75])&&(3===t[2]||5===t[2]||7===t[2])&&(4===t[3]||6===t[3]||8===t[3]))return{ext:"zip",mime:"application/zip"};if(n("ftyp",{offset:4})&&0!=(96&t[8])){const c=t.toString("binary",8,12).replace("\0"," ").trim();switch(c){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return c.startsWith("3g")?c.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(n("MThd"))return{ext:"mid",mime:"audio/midi"};if(n("wOFF")&&(r([0,1,0,0],{offset:4})||n("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(n("wOF2")&&(r([0,1,0,0],{offset:4})||n("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(r([212,195,178,161])||r([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(n("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(n("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(n("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(r([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(n("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(n("%PDF")){await e.ignore(1350);const u=10485760,h=Buffer.alloc(Math.min(u,e.fileInfo.size));return await e.readBuffer(h,{mayBeLess:!0}),h.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(r([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(r([73,73,42,0]))return n("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:r([28,0,254,0],{offset:8})||r([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:r([8,0,0,0],{offset:4})&&(r([45,0,254,0],{offset:8})||r([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(t=Buffer.alloc(24),await e.peekBuffer(t),(r([16,251,134,1],{offset:4})||r([8,0,0,0],{offset:4}))&&r([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(r([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(n("MAC "))return{ext:"ape",mime:"audio/ape"};if(r([26,69,223,163])){async function d(){const t=await e.peekNumber(Token.UINT8);let r=128,n=0;for(;0==(t&r)&&0!==r;)++n,r>>=1;const i=Buffer.alloc(n+1);return await e.readBuffer(i),i}async function f(){const e=await d(),t=await d();t[0]^=128>>t.length-1;const r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}async function m(t,r){for(;r>0;){const t=await f();if(17026===t.id)return e.readToken(new Token.StringType(t.len,"utf-8"));await e.ignore(t.len),--r}}const p=await f();switch(await m(0,p.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(r([82,73,70,70])){if(r([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(r([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(r([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(n("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(r([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(n("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(n("MSCF")||n("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(r([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(r([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(r([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(r([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(n("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(n("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(r([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(n("IMPM"))return{ext:"it",mime:"audio/x-it"};if(n("-lh0-",{offset:2})||n("-lh1-",{offset:2})||n("-lh2-",{offset:2})||n("-lh3-",{offset:2})||n("-lh4-",{offset:2})||n("-lh5-",{offset:2})||n("-lh6-",{offset:2})||n("-lh7-",{offset:2})||n("-lzs-",{offset:2})||n("-lz4-",{offset:2})||n("-lz5-",{offset:2})||n("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(r([0,0,1,186])){if(r([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(r([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(n("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(r([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(n("<?xml "))return{ext:"xml",mime:"application/xml"};if(r([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(r([82,97,114,33,26,7])&&(0===t[6]||1===t[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(n("solid "))return{ext:"stl",mime:"model/stl"};if(n("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(n("!<arch>"))return await e.ignore(8),"debian-binary"===await e.readToken(new Token.StringType(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(r([137,80,78,71,13,10,26,10])){async function g(){return{length:await e.readToken(Token.INT32_BE),type:await e.readToken(new Token.StringType(4,"binary"))}}await e.ignore(8);do{const A=await g();if(A.length<0)return;switch(A.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(A.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(r([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(r([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(r([102,114,101,101],{offset:4})||r([109,100,97,116],{offset:4})||r([109,111,111,118],{offset:4})||r([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(r([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(n("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(r([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(r([48,38,178,117,142,102,207,17,166,217])){async function b(){const t=Buffer.alloc(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(Token.UINT64_LE))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const v=await b();let y=v.size-24;if(_check(v.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const w=Buffer.alloc(16);if(y-=await e.readBuffer(w),_check(w,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(w,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(y)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(r([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((r([126,16,4])||r([126,24,4]))&&r([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(r([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(r([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(r([255,10])||r([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(r([0,0,1,186])||r([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(r([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(r([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(r([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(r([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(t,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),n("BEGIN:")){if(n("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(n("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(n("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(n("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(n("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(r([4,0,0,0])&&t.length>=16){const E=t.readUInt32LE(12);if(E>12&&t.length>=E+16)try{const _=t.slice(16,E+16).toString();if(JSON.parse(_).files)return{ext:"asar",mime:"application/x-asar"}}catch(T){}}if(r([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(n("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(r([71],{offset:4})&&(r([71],{offset:192})||r([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(r([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(r([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(r([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(r([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(r([76,80],{offset:34})&&(r([0,0,1],{offset:8})||r([1,0,2],{offset:8})||r([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(r([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(t,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(t))return{ext:"tar",mime:"application/x-tar"};if(r([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(n("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(t.length>=2&&r([255,224],{offset:0,mask:[255,224]})){if(r([16],{offset:1,mask:[22]}))return r([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(r([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(r([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}const stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",(async()=>{const e=new stream.PassThrough;let t;t=stream.pipeline?stream.pipeline(readableStream,e,(()=>{})):readableStream.pipe(e);const r=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const t=await fromBuffer(r);e.fileType=t}catch(e){reject(e)}resolve(t)}))})),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get:()=>new Set(supported.extensions)}),Object.defineProperty(fileType,"mimeTypes",{get:()=>new Set(supported.mimeTypes)}),module.exports=fileType},9898:e=>{"use strict";e.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}},6188:(e,t)=>{"use strict";t.stringToBytes=e=>[...e].map((e=>e.charCodeAt(0))),t.tarHeaderChecksumMatches=(e,t=0)=>{const r=parseInt(e.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(r))return!1;let n=256;for(let r=t;r<t+148;r++)n+=e[r];for(let r=t+156;r<t+512;r++)n+=e[r];return r===n},t.uint32SyncSafeToken={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4}},6998:function(e){e.exports=function(e,t){if(null==t&&(t={fuzzy:!0}),/youtu\.?be/.test(e)){var r,n=[/youtu\.be\/([^#\&\?]{11})/,/\?v=([^#\&\?]{11})/,/\&v=([^#\&\?]{11})/,/embed\/([^#\&\?]{11})/,/\/v\/([^#\&\?]{11})/];for(r=0;r<n.length;++r)if(n[r].test(e))return n[r].exec(e)[1];if(t.fuzzy){var i=e.split(/[\/\&\?=#\.\s]/g);for(r=0;r<i.length;++r)if(/^[^#\&\?]{11}$/.test(i[r]))return i[r]}}return null}},645:(e,t)=>{t.read=function(e,t,r,n,i){var a,s,o=8*i-n-1,l=(1<<o)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,f=e[t+h];for(h+=d,a=f&(1<<-u)-1,f>>=-u,u+=o;u>0;a=256*a+e[t+h],h+=d,u-=8);for(s=a&(1<<-u)-1,a>>=-u,u+=n;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===a)a=1-c;else{if(a===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),a-=c}return(f?-1:1)*s*Math.pow(2,a-n)},t.write=function(e,t,r,n,i,a){var s,o,l,c=8*a-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:a-1,m=n?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(o=0,s=u):s+h>=1?(o=(t*l-1)*Math.pow(2,i),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&o,f+=m,o/=256,i-=8);for(s=s<<i|o,c+=i;c>0;e[r+f]=255&s,f+=m,s/=256,c-=8);e[r+f-m]|=128*p}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},8738:e=>{function t(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},9090:e=>{function t(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function r(e,t){e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,e))}}e.exports=function(e,n,i){var a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("script");"function"==typeof n&&(i=n,n={}),n=n||{},i=i||function(){},s.type=n.type||"text/javascript",s.charset=n.charset||"utf8",s.async=!("async"in n)||!!n.async,s.src=e,n.attrs&&function(e,t){for(var r in t)e.setAttribute(r,t[r])}(s,n.attrs),n.text&&(s.text=""+n.text),("onload"in s?t:r)(s,i),s.onload||t(s,i),a.appendChild(s)}},2568:(e,t,r)=>{var n,i,a,s,o;n=r(1012),i=r(487).utf8,a=r(8738),s=r(487).bin,(o=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?s.stringToBytes(e):i.stringToBytes(e):a(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var r=n.bytesToWords(e),l=8*e.length,c=1732584193,u=-271733879,h=-1732584194,d=271733878,f=0;f<r.length;f++)r[f]=16711935&(r[f]<<8|r[f]>>>24)|4278255360&(r[f]<<24|r[f]>>>8);r[l>>>5]|=128<<l%32,r[14+(l+64>>>9<<4)]=l;var m=o._ff,p=o._gg,g=o._hh,A=o._ii;for(f=0;f<r.length;f+=16){var b=c,v=u,y=h,w=d;c=m(c,u,h,d,r[f+0],7,-680876936),d=m(d,c,u,h,r[f+1],12,-389564586),h=m(h,d,c,u,r[f+2],17,606105819),u=m(u,h,d,c,r[f+3],22,-1044525330),c=m(c,u,h,d,r[f+4],7,-176418897),d=m(d,c,u,h,r[f+5],12,1200080426),h=m(h,d,c,u,r[f+6],17,-1473231341),u=m(u,h,d,c,r[f+7],22,-45705983),c=m(c,u,h,d,r[f+8],7,1770035416),d=m(d,c,u,h,r[f+9],12,-1958414417),h=m(h,d,c,u,r[f+10],17,-42063),u=m(u,h,d,c,r[f+11],22,-1990404162),c=m(c,u,h,d,r[f+12],7,1804603682),d=m(d,c,u,h,r[f+13],12,-40341101),h=m(h,d,c,u,r[f+14],17,-1502002290),c=p(c,u=m(u,h,d,c,r[f+15],22,1236535329),h,d,r[f+1],5,-165796510),d=p(d,c,u,h,r[f+6],9,-1069501632),h=p(h,d,c,u,r[f+11],14,643717713),u=p(u,h,d,c,r[f+0],20,-373897302),c=p(c,u,h,d,r[f+5],5,-701558691),d=p(d,c,u,h,r[f+10],9,38016083),h=p(h,d,c,u,r[f+15],14,-660478335),u=p(u,h,d,c,r[f+4],20,-405537848),c=p(c,u,h,d,r[f+9],5,568446438),d=p(d,c,u,h,r[f+14],9,-1019803690),h=p(h,d,c,u,r[f+3],14,-187363961),u=p(u,h,d,c,r[f+8],20,1163531501),c=p(c,u,h,d,r[f+13],5,-1444681467),d=p(d,c,u,h,r[f+2],9,-51403784),h=p(h,d,c,u,r[f+7],14,1735328473),c=g(c,u=p(u,h,d,c,r[f+12],20,-1926607734),h,d,r[f+5],4,-378558),d=g(d,c,u,h,r[f+8],11,-2022574463),h=g(h,d,c,u,r[f+11],16,1839030562),u=g(u,h,d,c,r[f+14],23,-35309556),c=g(c,u,h,d,r[f+1],4,-1530992060),d=g(d,c,u,h,r[f+4],11,1272893353),h=g(h,d,c,u,r[f+7],16,-155497632),u=g(u,h,d,c,r[f+10],23,-1094730640),c=g(c,u,h,d,r[f+13],4,681279174),d=g(d,c,u,h,r[f+0],11,-358537222),h=g(h,d,c,u,r[f+3],16,-722521979),u=g(u,h,d,c,r[f+6],23,76029189),c=g(c,u,h,d,r[f+9],4,-640364487),d=g(d,c,u,h,r[f+12],11,-421815835),h=g(h,d,c,u,r[f+15],16,530742520),c=A(c,u=g(u,h,d,c,r[f+2],23,-995338651),h,d,r[f+0],6,-198630844),d=A(d,c,u,h,r[f+7],10,1126891415),h=A(h,d,c,u,r[f+14],15,-1416354905),u=A(u,h,d,c,r[f+5],21,-57434055),c=A(c,u,h,d,r[f+12],6,1700485571),d=A(d,c,u,h,r[f+3],10,-1894986606),h=A(h,d,c,u,r[f+10],15,-1051523),u=A(u,h,d,c,r[f+1],21,-2054922799),c=A(c,u,h,d,r[f+8],6,1873313359),d=A(d,c,u,h,r[f+15],10,-30611744),h=A(h,d,c,u,r[f+6],15,-1560198380),u=A(u,h,d,c,r[f+13],21,1309151649),c=A(c,u,h,d,r[f+4],6,-145523070),d=A(d,c,u,h,r[f+11],10,-1120210379),h=A(h,d,c,u,r[f+2],15,718787259),u=A(u,h,d,c,r[f+9],21,-343485551),c=c+b>>>0,u=u+v>>>0,h=h+y>>>0,d=d+w>>>0}return n.endian([c,u,h,d])})._ff=function(e,t,r,n,i,a,s){var o=e+(t&r|~t&n)+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._gg=function(e,t,r,n,i,a,s){var o=e+(t&n|r&~n)+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._hh=function(e,t,r,n,i,a,s){var o=e+(t^r^n)+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._ii=function(e,t,r,n,i,a,s){var o=e+(r^(t|~n))+(i>>>0)+s;return(o<<a|o>>>32-a)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var r=n.wordsToBytes(o(e,t));return t&&t.asBytes?r:t&&t.asString?s.bytesToString(r):n.bytesToHex(r)}},2577:(e,t)=>{"use strict";var r=/^[A-Za-z0-9][A-Za-z0-9!#$&^_.-]{0,126}$/,n=/^[A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126}$/,i=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/;function a(e,t,r){this.type=e,this.subtype=t,this.suffix=r}t.format=function(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var t=e.subtype,i=e.suffix,a=e.type;if(!a||!n.test(a))throw new TypeError("invalid type");if(!t||!r.test(t))throw new TypeError("invalid subtype");var s=a+"/"+t;if(i){if(!n.test(i))throw new TypeError("invalid suffix");s+="+"+i}return s},t.parse=function(e){if(!e)throw new TypeError("argument string is required");if("string"!=typeof e)throw new TypeError("argument string is required to be a string");var t=i.exec(e.toLowerCase());if(!t)throw new TypeError("invalid media type");var r,n=t[1],s=t[2],o=s.lastIndexOf("+");return-1!==o&&(r=s.substr(o+1),s=s.substr(0,o)),new a(n,s,r)},t.test=function(e){if(!e)throw new TypeError("argument string is required");if("string"!=typeof e)throw new TypeError("argument string is required to be a string");return i.test(e.toLowerCase())}},7824:e=>{var t=1e3,r=60*t,n=60*r,i=24*n;function a(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,s){s=s||{};var o,l,c=typeof e;if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*n;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===c&&isFinite(e))return s.long?(o=e,(l=Math.abs(o))>=i?a(o,l,i,"day"):l>=n?a(o,l,n,"hour"):l>=r?a(o,l,r,"minute"):l>=t?a(o,l,t,"second"):o+" ms"):function(e){var a=Math.abs(e);return a>=i?Math.round(e/i)+"d":a>=n?Math.round(e/n)+"h":a>=r?Math.round(e/r)+"m":a>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},2463:(e,t,r)=>{"use strict";t.Aj=t.De=void 0;const n=r(1227),i=r(523),a=r(8090);n("music-metadata-browser:main");r(523);t.De=i.parseStream,t.Aj=async function(e,r){const n={mimeType:e.type,size:e.size};return e instanceof File&&(n.path=e.name),async function(e,r,n){const i=new a.ReadableWebToNodeStream(e),s=await(0,t.De)(i,"string"==typeof r?{mimeType:r}:r,n);return await i.close(),s}(e.stream?e.stream():function(e){const t=new FileReader;return new ReadableStream({start(r){t.onloadend=e=>{let t=e.target.result;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),r.enqueue(t),r.close()},t.onerror=e=>{r.close()},t.onabort=e=>{r.close()},t.readAsArrayBuffer(e)}})}(e),{mimeType:e.type,size:e.size},r)}},3275:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ParserFactory=t.parseHttpContentType=void 0;const i=r(1),a=r(7811),s=r(2577),o=r(1227),l=r(7584),c=r(5410),u=r(6742),h=r(1004),d=r(498),f=r(8841),m=r(60),p=r(9606),g=r(1915),A=r(2682),b=r(5870),v=r(1533),y=r(6789),w=r(78),E=(0,o.default)("music-metadata:parser:factory");function _(e){const t=a.parse(e),r=s.parse(t.type);return{type:r.type,subtype:r.subtype,suffix:r.suffix,parameters:t.parameters}}t.parseHttpContentType=_;class T{static async parseOnContentType(e,t){const{mimeType:r,path:n,url:i}=await e.fileInfo,a=T.getParserIdForMimeType(r)||T.getParserIdForExtension(n)||T.getParserIdForExtension(i);return a||E("No parser found for MIME-type / extension: "+r),this.parse(e,a,t)}static async parse(e,t,r){if(!t){E("Guess parser on content...");const r=n.alloc(4100);if(await e.peekBuffer(r,{mayBeLess:!0}),e.fileInfo.path&&(t=this.getParserIdForExtension(e.fileInfo.path)),!t){const e=await i.fromBuffer(r);if(!e)throw new Error("Failed to determine audio format");if(E(`Guessed file type is mime=${e.mime}, extension=${e.ext}`),!(t=T.getParserIdForMimeType(e.mime)))throw new Error("Guessed MIME-type not supported: "+e.mime)}}return async function(e,t,r={}){const n=await T.loadParser(t),i=new l.MetadataCollector(r);return await n.init(i,e,r).parse(),i.toCommonMetadata()}(e,t,r)}static getParserIdForExtension(e){if(e)switch(this.getExtension(e).toLocaleLowerCase()||e){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}static async loadParser(e){switch(e){case"aiff":return new c.AIFFParser;case"adts":case"mpeg":return new m.MpegParser;case"apev2":return new u.APEv2Parser;case"asf":return new h.AsfParser;case"dsf":return new v.DsfParser;case"dsdiff":return new y.DsdiffParser;case"flac":return new d.FlacParser;case"mp4":return new f.MP4Parser;case"musepack":return new p.default;case"ogg":return new g.OggParser;case"riff":return new A.WaveParser;case"wavpack":return new b.WavPackParser;case"matroska":return new w.MatroskaParser;default:throw new Error(`Unknown parser type: ${e}`)}}static getExtension(e){const t=e.lastIndexOf(".");return-1===t?"":e.slice(t)}static getParserIdForMimeType(e){let t;try{t=_(e)}catch(t){return void E(`Invalid HTTP Content-Type header value: ${e}`)}const r=0===t.subtype.indexOf("x-")?t.subtype.substring(2):t.subtype;switch(t.type){case"audio":switch(r){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(r){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(r){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}}}}t.ParserFactory=T},5410:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AIFFParser=void 0;const n=r(3416),i=r(1227),a=r(5849),s=r(8928),o=r(8049),l=r(7805),c=r(1162),u=r(4633),h=(0,i.default)("music-metadata:parser:aiff"),d={NONE:"not compressed\tPCM\tApple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float\tApple Computer",alaw:"ALaw 2:1\t8-bit ITU-T G.711 A-law",ulaw:"µLaw 2:1\t8-bit ITU-T G.711 µ-law\tApple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 µ-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32\tIEEE 32-bit float "};class f extends l.BasicParser{async parse(){if("FORM"!==(await this.tokenizer.readToken(u.Header)).chunkID)throw new Error("Invalid Chunk-ID, expected 'FORM'");const e=await this.tokenizer.readToken(o.FourCcToken);switch(e){case"AIFF":this.metadata.setFormat("container",e),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw Error("Unsupported AIFF type: "+e)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=u.Header.len;){h("Reading AIFF chunk at offset="+this.tokenizer.position);const e=await this.tokenizer.readToken(u.Header);h(`Chunk id=${e.chunkID}`);const t=2*Math.round(e.chunkSize/2),r=await this.readData(e);await this.tokenizer.ignore(t-r)}}catch(e){if(!(e instanceof a.EndOfStreamError))throw e;h("End-of-stream")}}async readData(e){var t;switch(e.chunkID){case"COMM":const r=await this.tokenizer.readToken(new c.Common(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",r.sampleSize),this.metadata.setFormat("sampleRate",r.sampleRate),this.metadata.setFormat("numberOfChannels",r.numChannels),this.metadata.setFormat("numberOfSamples",r.numSampleFrames),this.metadata.setFormat("duration",r.numSampleFrames/r.sampleRate),this.metadata.setFormat("codec",null!==(t=r.compressionName)&&void 0!==t?t:d[r.compressionType]),e.chunkSize;case"ID3 ":const i=await this.tokenizer.readToken(new n.Uint8ArrayType(e.chunkSize)),o=a.fromBuffer(i);return await(new s.ID3v2Parser).parse(this.metadata,o,this.options),e.chunkSize;case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;default:return 0}}}t.AIFFParser=f},1162:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Common=void 0;const n=r(3416),i=r(8049);t.Common=class{constructor(e,t){this.isAifc=t;const r=t?22:18;if(e.chunkSize<r)throw new Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,t){const r=e.readUInt16BE(t+8)-16398,a=e.readUInt16BE(t+8+2),s={numChannels:e.readUInt16BE(t),numSampleFrames:e.readUInt32BE(t+2),sampleSize:e.readUInt16BE(t+6),sampleRate:r<0?a>>Math.abs(r):a<<r};if(this.isAifc){if(s.compressionType=i.FourCcToken.get(e,t+18),this.len>22){const r=e.readInt8(t+22);if(r>0){if(23+r+(r+1)%2!==this.len)throw new Error("Illegal pstring length");s.compressionName=new n.StringType(r,"binary").get(e,t+23)}else s.compressionName=void 0}}else s.compressionName="PCM";return s}}},6742:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.APEv2Parser=void 0;const i=r(1227),a=r(5849),s=r(3416),o=r(3769),l=r(7805),c=r(876),u=(0,i.default)("music-metadata:parser:APEv2"),h="APEv2",d="APETAGEX";class f extends l.BasicParser{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,t,r){const n=new f;return n.init(e,t,r),n.tryParseApeHeader()}static calculateDuration(e){let t=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return t+=e.finalFrameBlocks,t/e.sampleRate}static async findApeFooterOffset(e,t){const r=n.alloc(c.TagFooter.len);await e.randomRead(r,0,c.TagFooter.len,t-c.TagFooter.len);const i=c.TagFooter.get(r,0);if("APETAGEX"===i.ID)return u(`APE footer header at offset=${t}`),{footer:i,offset:t-i.size}}static parseTagFooter(e,t,r){const n=c.TagFooter.get(t,t.length-c.TagFooter.len);if(n.ID!==d)throw new Error("Unexpected APEv2 Footer ID preamble value.");a.fromBuffer(t);const i=new f;return i.init(e,a.fromBuffer(t),r),i.parseTags(n)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<c.TagFooter.len)return void u("No APEv2 header found, end-of-file reached");const e=await this.tokenizer.peekToken(c.TagFooter);if(e.ID===d)return await this.tokenizer.ignore(c.TagFooter.len),this.parseTags(e);if(u(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){const e=this.tokenizer.fileInfo.size-this.tokenizer.position,t=n.alloc(e);return await this.tokenizer.readBuffer(t),f.parseTagFooter(this.metadata,t,this.options)}}async parse(){const e=await this.tokenizer.readToken(c.DescriptorParser);if("MAC "!==e.ID)throw new Error("Unexpected descriptor ID");this.ape.descriptor=e;const t=e.descriptorBytes-c.DescriptorParser.len,r=await(t>0?this.parseDescriptorExpansion(t):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){const t=n.alloc(256);let r=e.size-c.TagFooter.len;u(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let i=0;i<e.fields;i++){if(r<c.TagItemHeader.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-i} items remaining, but no more tag data to read.`);break}const a=await this.tokenizer.readToken(c.TagItemHeader);r-=c.TagItemHeader.len+a.size,await this.tokenizer.peekBuffer(t,{length:Math.min(t.length,r)});let l=o.findZero(t,0,t.length);const d=await this.tokenizer.readToken(new s.StringType(l,"ascii"));switch(await this.tokenizer.ignore(1),r-=d.length+1,a.flags.dataType){case c.DataType.text_utf8:{const e=(await this.tokenizer.readToken(new s.StringType(a.size,"utf8"))).split(/\x00/g);for(const t of e)this.metadata.addTag(h,d,t);break}case c.DataType.binary:if(this.options.skipCovers)await this.tokenizer.ignore(a.size);else{const e=n.alloc(a.size);await this.tokenizer.readBuffer(e),l=o.findZero(e,0,e.length);const t=e.toString("utf8",0,l),r=n.from(e.slice(l+1));this.metadata.addTag(h,d,{description:t,data:r})}break;case c.DataType.external_info:u(`Ignore external info ${d}`),await this.tokenizer.ignore(a.size);break;case c.DataType.reserved:u(`Ignore external info ${d}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${d}"`),await this.tokenizer.ignore(a.size)}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){const e=await this.tokenizer.readToken(c.Header);return this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",f.calculateDuration(e)),{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}t.APEv2Parser=f},8414:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APEv2TagMapper=void 0;const n=r(4132),i={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class a extends n.CaseInsensitiveTagMap{constructor(){super(["APEv2"],i)}}t.APEv2TagMapper=a},876:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBitSet=t.parseTagFlags=t.TagField=t.TagItemHeader=t.TagFooter=t.Header=t.DescriptorParser=t.DataType=void 0;const n=r(3416),i=r(8049);var a;function s(e){return{containsHeader:o(e,31),containsFooter:o(e,30),isHeader:o(e,31),readOnly:o(e,0),dataType:(6&e)>>1}}function o(e,t){return 0!=(e&1<<t)}(a=t.DataType||(t.DataType={}))[a.text_utf8=0]="text_utf8",a[a.binary=1]="binary",a[a.external_info=2]="external_info",a[a.reserved=3]="reserved",t.DescriptorParser={len:52,get:(e,t)=>({ID:i.FourCcToken.get(e,t),version:n.UINT32_LE.get(e,t+4)/1e3,descriptorBytes:n.UINT32_LE.get(e,t+8),headerBytes:n.UINT32_LE.get(e,t+12),seekTableBytes:n.UINT32_LE.get(e,t+16),headerDataBytes:n.UINT32_LE.get(e,t+20),apeFrameDataBytes:n.UINT32_LE.get(e,t+24),apeFrameDataBytesHigh:n.UINT32_LE.get(e,t+28),terminatingDataBytes:n.UINT32_LE.get(e,t+32),fileMD5:new n.Uint8ArrayType(16).get(e,t+36)})},t.Header={len:24,get:(e,t)=>({compressionLevel:n.UINT16_LE.get(e,t),formatFlags:n.UINT16_LE.get(e,t+2),blocksPerFrame:n.UINT32_LE.get(e,t+4),finalFrameBlocks:n.UINT32_LE.get(e,t+8),totalFrames:n.UINT32_LE.get(e,t+12),bitsPerSample:n.UINT16_LE.get(e,t+16),channel:n.UINT16_LE.get(e,t+18),sampleRate:n.UINT32_LE.get(e,t+20)})},t.TagFooter={len:32,get:(e,t)=>({ID:new n.StringType(8,"ascii").get(e,t),version:n.UINT32_LE.get(e,t+8),size:n.UINT32_LE.get(e,t+12),fields:n.UINT32_LE.get(e,t+16),flags:s(n.UINT32_LE.get(e,t+20))})},t.TagItemHeader={len:8,get:(e,t)=>({size:n.UINT32_LE.get(e,t),flags:s(n.UINT32_LE.get(e,t+4))})},t.TagField=e=>new n.Uint8ArrayType(e.size-t.TagFooter.len),t.parseTagFlags=s,t.isBitSet=o},5174:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.WmPictureToken=t.MetadataLibraryObjectState=t.MetadataObjectState=t.ExtendedStreamPropertiesObjectState=t.ExtendedContentDescriptionObjectState=t.ContentDescriptionObjectState=t.readCodecEntries=t.HeaderExtensionObject=t.StreamPropertiesObject=t.FilePropertiesObject=t.IgnoreObjectState=t.State=t.HeaderObjectToken=t.TopLevelHeaderObjectToken=t.DataType=void 0;const i=r(3769),a=r(3416),s=r(8054),o=r(2252),l=r(8281);var c;(c=t.DataType||(t.DataType={}))[c.UnicodeString=0]="UnicodeString",c[c.ByteArray=1]="ByteArray",c[c.Bool=2]="Bool",c[c.DWord=3]="DWord",c[c.QWord=4]="QWord",c[c.Word=5]="Word",t.TopLevelHeaderObjectToken={len:30,get:(e,t)=>({objectId:s.default.fromBin(new a.BufferType(16).get(e,t)),objectSize:Number(a.UINT64_LE.get(e,t+16)),numberOfHeaderObjects:a.UINT32_LE.get(e,t+24)})},t.HeaderObjectToken={len:24,get:(e,t)=>({objectId:s.default.fromBin(new a.BufferType(16).get(e,t)),objectSize:Number(a.UINT64_LE.get(e,t+16))})};class u{constructor(e){this.len=Number(e.objectSize)-t.HeaderObjectToken.len}postProcessTag(e,t,r,n){if("WM/Picture"===t)e.push({id:t,value:_.fromBuffer(n)});else{const i=o.AsfUtil.getParserForAttr(r);if(!i)throw new Error("unexpected value headerType: "+r);e.push({id:t,value:i(n)})}}}t.State=u,t.IgnoreObjectState=class extends u{constructor(e){super(e)}get(e,t){return null}};class h extends u{constructor(e){super(e)}get(e,t){return{fileId:s.default.fromBin(e,t),fileSize:a.UINT64_LE.get(e,t+16),creationDate:a.UINT64_LE.get(e,t+24),dataPacketsCount:a.UINT64_LE.get(e,t+32),playDuration:a.UINT64_LE.get(e,t+40),sendDuration:a.UINT64_LE.get(e,t+48),preroll:a.UINT64_LE.get(e,t+56),flags:{broadcast:i.getBit(e,t+64,24),seekable:i.getBit(e,t+64,25)},minimumDataPacketSize:a.UINT32_LE.get(e,t+68),maximumDataPacketSize:a.UINT32_LE.get(e,t+72),maximumBitrate:a.UINT32_LE.get(e,t+76)}}}t.FilePropertiesObject=h,h.guid=s.default.FilePropertiesObject;class d extends u{constructor(e){super(e)}get(e,t){return{streamType:s.default.decodeMediaType(s.default.fromBin(e,t)),errorCorrectionType:s.default.fromBin(e,t+8)}}}t.StreamPropertiesObject=d,d.guid=s.default.StreamPropertiesObject;class f{constructor(){this.len=22}get(e,t){return{reserved1:s.default.fromBin(e,t),reserved2:e.readUInt16LE(t+16),extensionDataSize:e.readUInt32LE(t+18)}}}t.HeaderExtensionObject=f,f.guid=s.default.HeaderExtensionObject;const m={len:20,get:(e,t)=>({entryCount:e.readUInt16LE(t+16)})};async function p(e){const t=await e.readNumber(a.UINT16_LE);return(await e.readToken(new a.StringType(2*t,"utf16le"))).replace("\0","")}async function g(e){const t=await e.readNumber(a.UINT16_LE),r=n.alloc(t);return await e.readBuffer(r),r}async function A(e){const t=await e.readNumber(a.UINT16_LE);return{type:{videoCodec:1==(1&t),audioCodec:2==(2&t)},codecName:await p(e),description:await p(e),information:await g(e)}}t.readCodecEntries=async function(e){const t=await e.readToken(m),r=[];for(let n=0;n<t.entryCount;++n)r.push(await A(e));return r};class b extends u{constructor(e){super(e)}get(e,t){const r=[];let n=t+10;for(let i=0;i<b.contentDescTags.length;++i){const a=e.readUInt16LE(t+2*i);if(a>0){const t=b.contentDescTags[i],s=n+a;r.push({id:t,value:o.AsfUtil.parseUnicodeAttr(e.slice(n,s))}),n=s}}return r}}t.ContentDescriptionObjectState=b,b.guid=s.default.ContentDescriptionObject,b.contentDescTags=["Title","Author","Copyright","Description","Rating"];class v extends u{constructor(e){super(e)}get(e,t){const r=[],n=e.readUInt16LE(t);let i=t+2;for(let t=0;t<n;t+=1){const t=e.readUInt16LE(i);i+=2;const n=o.AsfUtil.parseUnicodeAttr(e.slice(i,i+t));i+=t;const a=e.readUInt16LE(i);i+=2;const s=e.readUInt16LE(i);i+=2;const l=e.slice(i,i+s);i+=s,this.postProcessTag(r,n,a,l)}return r}}t.ExtendedContentDescriptionObjectState=v,v.guid=s.default.ExtendedContentDescriptionObject;class y extends u{constructor(e){super(e)}get(e,t){return{startTime:a.UINT64_LE.get(e,t),endTime:a.UINT64_LE.get(e,t+8),dataBitrate:e.readInt32LE(t+12),bufferSize:e.readInt32LE(t+16),initialBufferFullness:e.readInt32LE(t+20),alternateDataBitrate:e.readInt32LE(t+24),alternateBufferSize:e.readInt32LE(t+28),alternateInitialBufferFullness:e.readInt32LE(t+32),maximumObjectSize:e.readInt32LE(t+36),flags:{reliableFlag:i.getBit(e,t+40,0),seekableFlag:i.getBit(e,t+40,1),resendLiveCleanpointsFlag:i.getBit(e,t+40,2)},streamNumber:e.readInt16LE(t+42),streamLanguageId:e.readInt16LE(t+44),averageTimePerFrame:e.readInt32LE(t+52),streamNameCount:e.readInt32LE(t+54),payloadExtensionSystems:e.readInt32LE(t+56),streamNames:[],streamPropertiesObject:null}}}t.ExtendedStreamPropertiesObjectState=y,y.guid=s.default.ExtendedStreamPropertiesObject;class w extends u{constructor(e){super(e)}get(e,t){const r=[],i=n.from(e),a=i.readUInt16LE(t);let s=t+2;for(let e=0;e<a;e+=1){s+=4;const e=i.readUInt16LE(s);s+=2;const t=i.readUInt16LE(s);s+=2;const n=i.readUInt32LE(s);s+=4;const a=o.AsfUtil.parseUnicodeAttr(i.slice(s,s+e));s+=e;const l=i.slice(s,s+n);s+=n,this.postProcessTag(r,a,t,l)}return r}}t.MetadataObjectState=w,w.guid=s.default.MetadataObject;class E extends w{constructor(e){super(e)}}t.MetadataLibraryObjectState=E,E.guid=s.default.MetadataLibraryObject;class _{constructor(e){this.len=e}static fromBase64(e){return this.fromBuffer(n.from(e,"base64"))}static fromBuffer(e){return new _(e.length).get(e,0)}get(e,t){const r=e.readUInt8(t++),n=e.readInt32LE(t);let i=5;for(;0!==e.readUInt16BE(i);)i+=2;const a=e.slice(5,i).toString("utf16le");for(;0!==e.readUInt16BE(i);)i+=2;const s=e.slice(5,i).toString("utf16le");return{type:l.AttachedPictureType[r],format:a,description:s,size:n,data:e.slice(i+4)}}}t.WmPictureToken=_},1004:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsfParser=void 0;const n=r(1227),i=r(6032),a=r(8054),s=r(5174),o=r(7805),l=(0,n.default)("music-metadata:parser:ASF");class c extends o.BasicParser{async parse(){const e=await this.tokenizer.readToken(s.TopLevelHeaderObjectToken);if(!e.objectId.equals(a.default.HeaderObject))throw new Error("expected asf header; but was not found; got: "+e.objectId.str);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(e){l("Error while parsing ASF: %s",e)}}async parseObjectHeader(e){let t;do{const e=await this.tokenizer.readToken(s.HeaderObjectToken);switch(l("header GUID=%s",e.objectId.str),e.objectId.str){case s.FilePropertiesObject.guid.str:const r=await this.tokenizer.readToken(new s.FilePropertiesObject(e));this.metadata.setFormat("duration",Number(r.playDuration/BigInt(1e3))/1e4-Number(r.preroll)/1e3),this.metadata.setFormat("bitrate",r.maximumBitrate);break;case s.StreamPropertiesObject.guid.str:const n=await this.tokenizer.readToken(new s.StreamPropertiesObject(e));this.metadata.setFormat("container","ASF/"+n.streamType);break;case s.HeaderExtensionObject.guid.str:const o=await this.tokenizer.readToken(new s.HeaderExtensionObject);await this.parseExtensionObject(o.extensionDataSize);break;case s.ContentDescriptionObjectState.guid.str:t=await this.tokenizer.readToken(new s.ContentDescriptionObjectState(e)),this.addTags(t);break;case s.ExtendedContentDescriptionObjectState.guid.str:t=await this.tokenizer.readToken(new s.ExtendedContentDescriptionObjectState(e)),this.addTags(t);break;case a.default.CodecListObject.str:const c=await s.readCodecEntries(this.tokenizer);c.forEach((e=>{this.metadata.addStreamInfo({type:e.type.videoCodec?i.TrackType.video:i.TrackType.audio,codecName:e.codecName})}));const u=c.filter((e=>e.type.audioCodec)).map((e=>e.codecName)).join("/");this.metadata.setFormat("codec",u);break;case a.default.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(e.objectSize-s.HeaderObjectToken.len);break;case a.default.PaddingObject.str:l("Padding: %s bytes",e.objectSize-s.HeaderObjectToken.len),await this.tokenizer.ignore(e.objectSize-s.HeaderObjectToken.len);break;default:this.metadata.addWarning("Ignore ASF-Object-GUID: "+e.objectId.str),l("Ignore ASF-Object-GUID: %s",e.objectId.str),await this.tokenizer.readToken(new s.IgnoreObjectState(e))}}while(--e)}addTags(e){e.forEach((e=>{this.metadata.addTag("asf",e.id,e.value)}))}async parseExtensionObject(e){do{const t=await this.tokenizer.readToken(s.HeaderObjectToken),r=t.objectSize-s.HeaderObjectToken.len;switch(t.objectId.str){case s.ExtendedStreamPropertiesObjectState.guid.str:await this.tokenizer.readToken(new s.ExtendedStreamPropertiesObjectState(t));break;case s.MetadataObjectState.guid.str:const e=await this.tokenizer.readToken(new s.MetadataObjectState(t));this.addTags(e);break;case s.MetadataLibraryObjectState.guid.str:const n=await this.tokenizer.readToken(new s.MetadataLibraryObjectState(t));this.addTags(n);break;case a.default.PaddingObject.str:await this.tokenizer.ignore(r);break;case a.default.CompatibilityObject.str:this.tokenizer.ignore(r);break;case a.default.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning("Ignore ASF-Object-GUID: "+t.objectId.str),await this.tokenizer.readToken(new s.IgnoreObjectState(t))}e-=t.objectSize}while(e>0)}}t.AsfParser=c},9004:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsfTagMapper=void 0;const n=r(9918),i={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class a extends n.CommonTagMapper{static toRating(e){return{rating:parseFloat(e+1)/5}}constructor(){super(["asf"],i)}postMap(e){if("WM/SharedUserRating"===e.id){const t=e.id.split(":");e.value=a.toRating(e.value),e.id=t[0]}}}t.AsfTagMapper=a},2252:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AsfUtil=void 0;const i=r(3416),a=r(3769);class s{static getParserForAttr(e){return s.attributeParsers[e]}static parseUnicodeAttr(e){return a.stripNulls(a.decodeString(e,"utf16le"))}static parseByteArrayAttr(e){return n.from(e)}static parseBoolAttr(e,t=0){return 1===s.parseWordAttr(e,t)}static parseDWordAttr(e,t=0){return e.readUInt32LE(t)}static parseQWordAttr(e,t=0){return i.UINT64_LE.get(e,t)}static parseWordAttr(e,t=0){return e.readUInt16LE(t)}}t.AsfUtil=s,s.attributeParsers=[s.parseUnicodeAttr,s.parseByteArrayAttr,s.parseBoolAttr,s.parseDWordAttr,s.parseQWordAttr,s.parseWordAttr,s.parseByteArrayAttr]},8054:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.str=e}static fromBin(e,t=0){return new i(this.decode(e,t))}static decode(e,t=0){return(e.readUInt32LE(t).toString(16)+"-"+e.readUInt16LE(t+4).toString(16)+"-"+e.readUInt16LE(t+6).toString(16)+"-"+e.readUInt16BE(t+8).toString(16)+"-"+e.slice(t+10,t+16).toString("hex")).toUpperCase()}static decodeMediaType(e){switch(e.str){case i.AudioMedia.str:return"audio";case i.VideoMedia.str:return"video";case i.CommandMedia.str:return"command";case i.Degradable_JPEG_Media.str:return"degradable-jpeg";case i.FileTransferMedia.str:return"file-transfer";case i.BinaryMedia.str:return"binary"}}static encode(e){const t=n.alloc(16);return t.writeUInt32LE(parseInt(e.slice(0,8),16),0),t.writeUInt16LE(parseInt(e.slice(9,13),16),4),t.writeUInt16LE(parseInt(e.slice(14,18),16),6),n.from(e.slice(19,23),"hex").copy(t,8),n.from(e.slice(24),"hex").copy(t,10),t}equals(e){return this.str===e.str}toBin(){return i.encode(this.str)}}t.default=i,i.HeaderObject=new i("75B22630-668E-11CF-A6D9-00AA0062CE6C"),i.DataObject=new i("75B22636-668E-11CF-A6D9-00AA0062CE6C"),i.SimpleIndexObject=new i("33000890-E5B1-11CF-89F4-00A0C90349CB"),i.IndexObject=new i("D6E229D3-35DA-11D1-9034-00A0C90349BE"),i.MediaObjectIndexObject=new i("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C"),i.TimecodeIndexObject=new i("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C"),i.FilePropertiesObject=new i("8CABDCA1-A947-11CF-8EE4-00C00C205365"),i.StreamPropertiesObject=new i("B7DC0791-A9B7-11CF-8EE6-00C00C205365"),i.HeaderExtensionObject=new i("5FBF03B5-A92E-11CF-8EE3-00C00C205365"),i.CodecListObject=new i("86D15240-311D-11D0-A3A4-00A0C90348F6"),i.ScriptCommandObject=new i("1EFB1A30-0B62-11D0-A39B-00A0C90348F6"),i.MarkerObject=new i("F487CD01-A951-11CF-8EE6-00C00C205365"),i.BitrateMutualExclusionObject=new i("D6E229DC-35DA-11D1-9034-00A0C90349BE"),i.ErrorCorrectionObject=new i("75B22635-668E-11CF-A6D9-00AA0062CE6C"),i.ContentDescriptionObject=new i("75B22633-668E-11CF-A6D9-00AA0062CE6C"),i.ExtendedContentDescriptionObject=new i("D2D0A440-E307-11D2-97F0-00A0C95EA850"),i.ContentBrandingObject=new i("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E"),i.StreamBitratePropertiesObject=new i("7BF875CE-468D-11D1-8D82-006097C9A2B2"),i.ContentEncryptionObject=new i("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E"),i.ExtendedContentEncryptionObject=new i("298AE614-2622-4C17-B935-DAE07EE9289C"),i.DigitalSignatureObject=new i("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E"),i.PaddingObject=new i("1806D474-CADF-4509-A4BA-9AABCB96AAE8"),i.ExtendedStreamPropertiesObject=new i("14E6A5CB-C672-4332-8399-A96952065B5A"),i.AdvancedMutualExclusionObject=new i("A08649CF-4775-4670-8A16-6E35357566CD"),i.GroupMutualExclusionObject=new i("D1465A40-5A79-4338-B71B-E36B8FD6C249"),i.StreamPrioritizationObject=new i("D4FED15B-88D3-454F-81F0-ED5C45999E24"),i.BandwidthSharingObject=new i("A69609E6-517B-11D2-B6AF-00C04FD908E9"),i.LanguageListObject=new i("7C4346A9-EFE0-4BFC-B229-393EDE415C85"),i.MetadataObject=new i("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA"),i.MetadataLibraryObject=new i("44231C94-9498-49D1-A141-1D134E457054"),i.IndexParametersObject=new i("D6E229DF-35DA-11D1-9034-00A0C90349BE"),i.MediaObjectIndexParametersObject=new i("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7"),i.TimecodeIndexParametersObject=new i("F55E496D-9797-4B5D-8C8B-604DFE9BFB24"),i.CompatibilityObject=new i("26F18B5D-4584-47EC-9F5F-0E651F0452C9"),i.AdvancedContentEncryptionObject=new i("43058533-6981-49E6-9B74-AD12CB86D58C"),i.AudioMedia=new i("F8699E40-5B4D-11CF-A8FD-00805F5C442B"),i.VideoMedia=new i("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B"),i.CommandMedia=new i("59DACFC0-59E6-11D0-A3AC-00A0C90348F6"),i.JFIF_Media=new i("B61BE100-5B4E-11CF-A8FD-00805F5C442B"),i.Degradable_JPEG_Media=new i("35907DE0-E415-11CF-A917-00805F5C442B"),i.FileTransferMedia=new i("91BD222C-F21C-497A-8B6D-5AA86BFC0185"),i.BinaryMedia=new i("3AFB65E2-47EF-40F2-AC2C-70A90D71D343"),i.ASF_Index_Placeholder_Object=new i("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2")},7805:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BasicParser=void 0,t.BasicParser=class{init(e,t,r){return this.metadata=e,this.tokenizer=t,this.options=r,this}}},4132:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CaseInsensitiveTagMap=void 0;const n=r(9918);class i extends n.CommonTagMapper{constructor(e,t){const r={};for(const e of Object.keys(t))r[e.toUpperCase()]=t[e];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}t.CaseInsensitiveTagMap=i},6592:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombinedTagMapper=void 0;const n=r(2939),i=r(4005),a=r(9004),s=r(7183),o=r(8414),l=r(7852),c=r(9860),u=r(5756),h=r(5481);t.CombinedTagMapper=class{constructor(){this.tagMappers={},[new n.ID3v1TagMapper,new s.ID3v22TagMapper,new i.ID3v24TagMapper,new l.MP4TagMapper,new l.MP4TagMapper,new c.VorbisTagMapper,new o.APEv2TagMapper,new a.AsfTagMapper,new u.RiffInfoTagMapper,new h.MatroskaTagMapper].forEach((e=>{this.registerTagMapper(e)}))}mapTag(e,t,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(t,r);throw new Error("No generic tag mapper defined for tag-format: "+e)}registerTagMapper(e){for(const t of e.tagTypes)this.tagMappers[t]=e}}},8049:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.FourCcToken=void 0;const i=r(3769),a=/^[\x21-\x7e©][\x20-\x7e\x00()]{3}/;t.FourCcToken={len:4,get:(e,r)=>{const n=e.toString("binary",r,r+t.FourCcToken.len);if(!n.match(a))throw new Error(`FourCC contains invalid characters: ${i.a2hex(n)} "${n}"`);return n},put:(e,t,r)=>{const i=n.from(r,"binary");if(4!==i.length)throw new Error("Invalid length");return i.copy(e,t)}}},9918:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommonTagMapper=void 0;class r{constructor(e,t){this.tagTypes=e,this.tagMap=t}static toIntOrNull(e){const t=parseInt(e,10);return isNaN(t)?null:t}static normalizeTrack(e){const t=e.toString().split("/");return{no:parseInt(t[0],10)||null,of:parseInt(t[1],10)||null}}mapGenericTag(e,t){e={id:e.id,value:e.value},this.postMap(e,t);const r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,t){}}t.CommonTagMapper=r,r.maxRatingScore=1},103:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUnique=t.isSingleton=t.commonTags=void 0,t.commonTags={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}},t.isSingleton=function(e){return t.commonTags.hasOwnProperty(e)&&!t.commonTags[e].multiple},t.isUnique=function(e){return!t.commonTags[e].multiple||t.commonTags[e].unique}},7584:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.joinArtists=t.MetadataCollector=void 0;const n=r(6032),i=r(1227),a=r(103),s=r(6592),o=r(9918),l=r(3769),c=r(1),u=(0,i.default)("music-metadata:collector"),h=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","ID3v1"];function d(e){return e.length>2?e.slice(0,e.length-1).join(", ")+" & "+e[e.length-1]:e.join(" & ")}t.MetadataCollector=class{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new s.CombinedTagMapper;let t=1;for(const e of h)this.originPriority[e]=t++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){u(`streamInfo: type=${n.TrackType[e.type]}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,t){u(`format: ${e} = ${t}`),this.format[e]=t,this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:t}})}addTag(e,t,r){u(`tag ${e}.${t} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:t,value:r}),this.toCommon(e,t,r)}addWarning(e){this.quality.warnings.push({message:e})}postMap(e,t){switch(t.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:t.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:t.value});break;case"artists":if(!(this.common.artist&&this.commonOrigin.artist!==this.originPriority.artificial||this.common.artists&&-1!==this.common.artists.indexOf(t.value))){const e={id:"artist",value:d((this.common.artists||[]).concat([t.value]))};this.setGenericTag("artificial",e)}break;case"picture":return void this.postFixPicture(t.value).then((r=>{null!==r&&(t.value=r,this.setGenericTag(e,t))}));case"totaltracks":return void(this.common.track.of=o.CommonTagMapper.toIntOrNull(t.value));case"totaldiscs":return void(this.common.disk.of=o.CommonTagMapper.toIntOrNull(t.value));case"movementTotal":return void(this.common.movementIndex.of=o.CommonTagMapper.toIntOrNull(t.value));case"track":case"disk":case"movementIndex":const r=this.common[t.id].of;return this.common[t.id]=o.CommonTagMapper.normalizeTrack(t.value),void(this.common[t.id].of=null!=r?r:this.common[t.id].of);case"bpm":case"year":case"originalyear":t.value=parseInt(t.value,10);break;case"date":const n=parseInt(t.value.substr(0,4),10);isNaN(n)||(this.common.year=n);break;case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":t.value="string"==typeof t.value?parseInt(t.value,10):t.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":t.value=(0,l.toRatio)(t.value);break;case"replaygain_track_minmax":t.value=t.value.split(",").map((e=>parseInt(e,10)));break;case"replaygain_undo":const i=t.value.split(",").map((e=>parseInt(e,10)));t.value={leftChannel:i[0],rightChannel:i[1]};break;case"gapless":case"compilation":case"podcast":case"showMovement":t.value="1"===t.value||1===t.value;break;case"isrc":if(this.common[t.id]&&-1!==this.common[t.id].indexOf(t.value))return}null!==t.value&&this.setGenericTag(e,t)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){const t=await c.fromBuffer(e.data);if(!t)return null;e.format=t.mime}return e.format=e.format.toLocaleLowerCase(),"image/jpg"===e.format&&(e.format="image/jpeg"),e}return this.addWarning("Empty picture tag found"),null}toCommon(e,t,r){const n={id:t,value:r},i=this.tagMapper.mapTag(e,n,this);i&&this.postMap(e,i)}setGenericTag(e,t){u(`common.${t.id} = ${t.value}`);const r=this.commonOrigin[t.id]||1e3,n=this.originPriority[e];if((0,a.isSingleton)(t.id)){if(!(n<=r))return u(`Ignore native tag (singleton): ${e}.${t.id} = ${t.value}`);this.common[t.id]=t.value,this.commonOrigin[t.id]=n}else if(n===r)(0,a.isUnique)(t.id)&&-1!==this.common[t.id].indexOf(t.value)?u(`Ignore duplicate value: ${e}.${t.id} = ${t.value}`):this.common[t.id].push(t.value);else{if(!(n<r))return u(`Ignore native tag (list): ${e}.${t.id} = ${t.value}`);this.common[t.id]=[t.value],this.commonOrigin[t.id]=n}this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:t.id,value:t.value}})}},t.joinArtists=d},9461:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RandomUint8ArrayReader=void 0,t.RandomUint8ArrayReader=class{constructor(e){this.uint8Array=e,this.fileSize=e.length}async randomRead(e,t,r,n){return e.set(this.uint8Array.subarray(n,n+r),t),r}}},3769:(e,t,r)=>{"use strict";var n=r(8764).Buffer;function i(e,t,r,n){const a=r%8;let s=e[t+~~(r/8)];s&=255>>a;const o=8-a,l=n-o;return l<0?s>>=8-a-n:l>0&&(s<<=l,s|=i(e,t,r+o,l)),s}function a(e){return 10*Math.log10(e)}function s(e){return Math.pow(10,e/10)}Object.defineProperty(t,"__esModule",{value:!0}),t.toRatio=t.dbToRatio=t.ratioToDb=t.a2hex=t.isBitSet=t.getBitAllignedNumber=t.stripNulls=t.decodeString=t.trimRightNull=t.findZero=t.getBit=void 0,t.getBit=function(e,t,r){return 0!=(e[t]&1<<r)},t.findZero=function(e,t,r,n){let i=t;if("utf16le"===n){for(;0!==e[i]||0!==e[i+1];){if(i>=r)return r;i+=2}return i}for(;0!==e[i];){if(i>=r)return r;i++}return i},t.trimRightNull=function(e){const t=e.indexOf("\0");return-1===t?e:e.substr(0,t)},t.decodeString=function e(t,r){if(255===t[0]&&254===t[1])return e(t.subarray(2),r);if("utf16le"===r&&254===t[0]&&255===t[1]){if(0!=(1&t.length))throw new Error("Expected even number of octets for 16-bit unicode string");return e(function(e){const t=e.length;if(0!=(1&t))throw new Error("Buffer length must be even");for(let r=0;r<t;r+=2){const t=e[r];e[r]=e[r+1],e[r+1]=t}return e}(t),r)}return n.from(t).toString(r)},t.stripNulls=function(e){return(e=e.replace(/^\x00+/g,"")).replace(/\x00+$/g,"")},t.getBitAllignedNumber=i,t.isBitSet=function(e,t,r){return 1===i(e,t,r,1)},t.a2hex=function(e){const t=[];for(let r=0,n=e.length;r<n;r++){const n=Number(e.charCodeAt(r)).toString(16);t.push(1===n.length?"0"+n:n)}return t.join(" ")},t.ratioToDb=a,t.dbToRatio=s,t.toRatio=function(e){const t=e.split(" ").map((e=>e.trim().toLowerCase()));if(t.length>=1){const e=parseFloat(t[0]);return 2===t.length&&"db"===t[1]?{dB:e,ratio:s(e)}:{dB:a(e),ratio:e}}}},523:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanAppendingHeaders=t.selectCover=t.ratingToStars=t.orderTags=t.parseFromTokenizer=t.parseBuffer=t.parseStream=void 0;const n=r(5849),i=r(3275),a=r(9461),s=r(6742),o=r(2282),l=r(9941);function c(e,t){return i.ParserFactory.parseOnContentType(e,t)}async function u(e,t={}){let r=e.fileSize;await(0,o.hasID3v1Header)(e)&&(r-=128,r-=await(0,l.getLyricsHeaderLength)(e)),t.apeHeader=await s.APEv2Parser.findApeFooterOffset(e,r)}t.parseStream=function(e,t,r={}){return c(n.fromStream(e,"string"==typeof t?{mimeType:t}:t),r)},t.parseBuffer=async function(e,t,r={}){const i=new a.RandomUint8ArrayReader(e);return await u(i,r),c(n.fromBuffer(e,"string"==typeof t?{mimeType:t}:t),r)},t.parseFromTokenizer=c,t.orderTags=function(e){const t={};for(const r of e)(t[r.id]=t[r.id]||[]).push(r.value);return t},t.ratingToStars=function(e){return void 0===e?0:1+Math.round(4*e)},t.selectCover=function(e){return e?e.reduce(((e,t)=>t.name&&t.name.toLowerCase()in["front","cover","cover (front)"]?t:e)):null},t.scanAppendingHeaders=u},6789:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DsdiffParser=void 0;const n=r(3416),i=r(1227),a=r(5849),s=r(8049),o=r(7805),l=r(8928),c=r(9187),u=(0,i.default)("music-metadata:parser:aiff");class h extends o.BasicParser{async parse(){const e=await this.tokenizer.readToken(c.ChunkHeader64);if("FRM8"!==e.chunkID)throw new Error("Unexpected chunk-ID");const t=(await this.tokenizer.readToken(s.FourCcToken)).trim();if("DSD"===t)return this.metadata.setFormat("container",`DSDIFF/${t}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(s.FourCcToken.len));throw Error(`Unsupported DSDIFF type: ${t}`)}async readFmt8Chunks(e){for(;e>=c.ChunkHeader64.len;){const t=await this.tokenizer.readToken(c.ChunkHeader64);u(`Chunk id=${t.chunkID}`),await this.readData(t),e-=BigInt(c.ChunkHeader64.len)+t.chunkSize}}async readData(e){u(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);const t=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":const t=await this.tokenizer.readToken(n.UINT32_LE);u(`DSDIFF version=${t}`);break;case"PROP":if("SND "!==await this.tokenizer.readToken(s.FourCcToken))throw new Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(s.FourCcToken.len));break;case"ID3":const r=await this.tokenizer.readToken(new n.Uint8ArrayType(Number(e.chunkSize))),i=a.fromBuffer(r);await(new l.ID3v2Parser).parse(this.metadata,i,this.options);break;default:u(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break;case"DSD":this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate)}const r=e.chunkSize-BigInt(this.tokenizer.position-t);r>0&&(u(`After Parsing chunk, remaining ${r} bytes`),await this.tokenizer.ignore(Number(r)))}async handleSoundPropertyChunks(e){for(u(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){const t=await this.tokenizer.readToken(c.ChunkHeader64);u(`Sound-property-chunk[ID=${t.chunkID}, size=${t.chunkSize}]`);const r=this.tokenizer.position;switch(t.chunkID.trim()){case"FS":const e=await this.tokenizer.readToken(n.UINT32_BE);this.metadata.setFormat("sampleRate",e);break;case"CHNL":const r=await this.tokenizer.readToken(n.UINT16_BE);this.metadata.setFormat("numberOfChannels",r),await this.handleChannelChunks(t.chunkSize-BigInt(n.UINT16_BE.len));break;case"CMPR":const i=(await this.tokenizer.readToken(s.FourCcToken)).trim(),a=await this.tokenizer.readToken(n.UINT8),o=await this.tokenizer.readToken(new n.StringType(a,"ascii"));"DSD"===i&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${i} (${o})`);break;case"ABSS":const l=await this.tokenizer.readToken(n.UINT16_BE),c=await this.tokenizer.readToken(n.UINT8),h=await this.tokenizer.readToken(n.UINT8),d=await this.tokenizer.readToken(n.UINT32_BE);u(`ABSS ${l}:${c}:${h}.${d}`);break;case"LSCO":const f=await this.tokenizer.readToken(n.UINT16_BE);u(`LSCO lsConfig=${f}`);break;default:u(`Unknown sound-property-chunk[ID=${t.chunkID}, size=${t.chunkSize}]`),await this.tokenizer.ignore(Number(t.chunkSize))}const i=t.chunkSize-BigInt(this.tokenizer.position-r);i>0&&(u(`After Parsing sound-property-chunk ${t.chunkSize}, remaining ${i} bytes`),await this.tokenizer.ignore(Number(i))),e-=BigInt(c.ChunkHeader64.len)+t.chunkSize,u(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){const e=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",e)}}async handleChannelChunks(e){u(`Parsing channel-chunks, remainingSize=${e}`);const t=[];for(;e>=s.FourCcToken.len;){const r=await this.tokenizer.readToken(s.FourCcToken);u(`Channel[ID=${r}]`),t.push(r),e-=BigInt(s.FourCcToken.len)}return u(`Channels: ${t.join(", ")}`),t}}t.DsdiffParser=h},9187:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChunkHeader64=void 0;const n=r(3416),i=r(8049);t.ChunkHeader64={len:12,get:(e,t)=>({chunkID:i.FourCcToken.get(e,t),chunkSize:n.INT64_BE.get(e,t+4)})}},4101:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormatChunk=t.ChannelType=t.DsdChunk=t.ChunkHeader=void 0;const n=r(3416),i=r(8049);var a;t.ChunkHeader={len:12,get:(e,t)=>({id:i.FourCcToken.get(e,t),size:n.UINT64_LE.get(e,t+4)})},t.DsdChunk={len:16,get:(e,t)=>({fileSize:n.INT64_LE.get(e,t),metadataPointer:n.INT64_LE.get(e,t+8)})},(a=t.ChannelType||(t.ChannelType={}))[a.mono=1]="mono",a[a.stereo=2]="stereo",a[a.channels=3]="channels",a[a.quad=4]="quad",a[a["4 channels"]=5]="4 channels",a[a["5 channels"]=6]="5 channels",a[a["5.1 channels"]=7]="5.1 channels",t.FormatChunk={len:40,get:(e,t)=>({formatVersion:n.INT32_LE.get(e,t),formatID:n.INT32_LE.get(e,t+4),channelType:n.INT32_LE.get(e,t+8),channelNum:n.INT32_LE.get(e,t+12),samplingFrequency:n.INT32_LE.get(e,t+16),bitsPerSample:n.INT32_LE.get(e,t+20),sampleCount:n.INT64_LE.get(e,t+24),blockSizePerChannel:n.INT32_LE.get(e,t+32)})}},1533:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DsfParser=void 0;const n=r(1227),i=r(5159),a=r(4101),s=r(8928),o=(0,n.default)("music-metadata:parser:DSF");class l extends i.AbstractID3Parser{async postId3v2Parse(){const e=this.tokenizer.position,t=await this.tokenizer.readToken(a.ChunkHeader);if("DSD "!==t.id)throw new Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);const r=await this.tokenizer.readToken(a.DsdChunk);if(r.metadataPointer!==BigInt(0))return o(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-t.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),(new s.ID3v2Parser).parse(this.metadata,this.tokenizer,this.options);o("No ID3v2 tag present")}async parseChunks(e){for(;e>=a.ChunkHeader.len;){const t=await this.tokenizer.readToken(a.ChunkHeader);if(o(`Parsing chunk name=${t.id} size=${t.size}`),"fmt "===t.id){const e=await this.tokenizer.readToken(a.FormatChunk);this.metadata.setFormat("numberOfChannels",e.channelNum),this.metadata.setFormat("sampleRate",e.samplingFrequency),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("numberOfSamples",e.sampleCount),this.metadata.setFormat("duration",Number(e.sampleCount)/e.samplingFrequency);const t=e.bitsPerSample*e.samplingFrequency*e.channelNum;return void this.metadata.setFormat("bitrate",t)}this.tokenizer.ignore(Number(t.size)-a.ChunkHeader.len),e-=t.size}}}t.DsfParser=l},498:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlacParser=void 0;const n=r(3416),i=r(1227),a=r(3769),s=r(2127),o=r(5159),l=r(8049),c=r(4210),u=r(441),h=(0,i.default)("music-metadata:parser:FLAC");var d;!function(e){e[e.STREAMINFO=0]="STREAMINFO",e[e.PADDING=1]="PADDING",e[e.APPLICATION=2]="APPLICATION",e[e.SEEKTABLE=3]="SEEKTABLE",e[e.VORBIS_COMMENT=4]="VORBIS_COMMENT",e[e.CUESHEET=5]="CUESHEET",e[e.PICTURE=6]="PICTURE"}(d||(d={}));class f extends o.AbstractID3Parser{constructor(){super(...arguments),this.padding=0}init(e,t,r){return super.init(e,t,r),this.vorbisParser=new c.VorbisParser(e,r),this}async postId3v2Parse(){if("fLaC"!==(await this.tokenizer.readToken(l.FourCcToken)).toString())throw new Error("Invalid FLAC preamble");let e;do{e=await this.tokenizer.readToken(m.BlockHeader),await this.parseDataBlock(e)}while(!e.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){const e=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}parseDataBlock(e){switch(h(`blockHeader type=${e.type}, length=${e.length}`),e.type){case d.STREAMINFO:return this.parseBlockStreamInfo(e.length);case d.PADDING:this.padding+=e.length;break;case d.APPLICATION:case d.SEEKTABLE:break;case d.VORBIS_COMMENT:return this.parseComment(e.length);case d.CUESHEET:break;case d.PICTURE:return this.parsePicture(e.length).then();default:this.metadata.addWarning("Unknown block type: "+e.type)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==m.BlockStreamInfo.len)throw new Error("Unexpected block-stream-info length");const t=await this.tokenizer.readToken(m.BlockStreamInfo);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",t.channels),this.metadata.setFormat("bitsPerSample",t.bitsPerSample),this.metadata.setFormat("sampleRate",t.sampleRate),t.totalSamples>0&&this.metadata.setFormat("duration",t.totalSamples/t.sampleRate)}async parseComment(e){const t=await this.tokenizer.readToken(new n.Uint8ArrayType(e)),r=new u.VorbisDecoder(t,0);r.readStringUtf8();const i=r.readInt32();for(let e=0;e<i;e++){const e=r.parseUserComment();this.vorbisParser.addTag(e.key,e.value)}}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);{const t=await this.tokenizer.readToken(new s.VorbisPictureToken(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",t)}}}t.FlacParser=f;class m{}m.BlockHeader={len:4,get:(e,t)=>({lastBlock:a.getBit(e,t,7),type:a.getBitAllignedNumber(e,t,1,7),length:n.UINT24_BE.get(e,t+1)})},m.BlockStreamInfo={len:34,get:(e,t)=>({minimumBlockSize:n.UINT16_BE.get(e,t),maximumBlockSize:n.UINT16_BE.get(e,t+2)/1e3,minimumFrameSize:n.UINT24_BE.get(e,t+4),maximumFrameSize:n.UINT24_BE.get(e,t+7),sampleRate:n.UINT24_BE.get(e,t+10)>>4,channels:a.getBitAllignedNumber(e,t+12,4,3)+1,bitsPerSample:a.getBitAllignedNumber(e,t+12,7,5)+1,totalSamples:a.getBitAllignedNumber(e,t+13,4,36),fileMD5:new n.Uint8ArrayType(16).get(e,t+18)})}},2282:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.hasID3v1Header=t.ID3v1Parser=t.Genres=void 0;const i=r(1227),a=r(3416),s=r(3769),o=r(7805),l=r(6742),c=(0,i.default)("music-metadata:parser:ID3v1");t.Genres=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"];const u={len:128,get:(e,t)=>{const r=new h(3).get(e,t);return"TAG"===r?{header:r,title:new h(30).get(e,t+3),artist:new h(30).get(e,t+33),album:new h(30).get(e,t+63),year:new h(4).get(e,t+93),comment:new h(28).get(e,t+97),zeroByte:a.UINT8.get(e,t+127),track:a.UINT8.get(e,t+126),genre:a.UINT8.get(e,t+127)}:null}};class h extends a.StringType{constructor(e){super(e,"binary")}get(e,t){let r=super.get(e,t);return r=s.trimRightNull(r),r=r.trim(),r.length>0?r:void 0}}class d extends o.BasicParser{static getGenre(e){if(e<t.Genres.length)return t.Genres[e]}async parse(){if(!this.tokenizer.fileInfo.size)return void c("Skip checking for ID3v1 because the file-size is unknown");if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);const e=new l.APEv2Parser;e.init(this.metadata,this.tokenizer,this.options),await e.parseTags(this.options.apeHeader.footer)}const e=this.tokenizer.fileInfo.size-u.len;if(this.tokenizer.position>e)return void c("Already consumed the last 128 bytes");const t=await this.tokenizer.readToken(u,e);if(t){c("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-u.len);for(const e of["title","artist","album","comment","track","year"])t[e]&&""!==t[e]&&this.addTag(e,t[e]);const e=d.getGenre(t.genre);e&&this.addTag("genre",e)}else c("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-u.len)}addTag(e,t){this.metadata.addTag("ID3v1",e,t)}}t.ID3v1Parser=d,t.hasID3v1Header=async function(e){if(e.fileSize>=128){const t=n.alloc(3);return await e.randomRead(t,0,t.length,e.fileSize-128),"TAG"===t.toString("binary")}return!1}},2939:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v1TagMapper=void 0;const n=r(9918),i={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class a extends n.CommonTagMapper{constructor(){super(["ID3v1"],i)}}t.ID3v1TagMapper=a},5159:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractID3Parser=void 0;const n=r(5849),i=r(1227),a=r(8281),s=r(8928),o=r(2282),l=r(7805),c=(0,i.default)("music-metadata:parser:ID3");class u extends l.BasicParser{constructor(){super(...arguments),this.id3parser=new s.ID3v2Parser}static async startsWithID3v2Header(e){return"ID3"===(await e.peekToken(a.ID3v2Header)).fileIdentifier}async parse(){try{await this.parseID3v2()}catch(e){if(!(e instanceof n.EndOfStreamError))throw e;c("End-of-stream")}}finalize(){}async parseID3v2(){if(await this.tryReadId3v2Headers(),c("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny())this.finalize();else{const e=new o.ID3v1Parser;await e.init(this.metadata,this.tokenizer,this.options).parse(),this.finalize()}}async tryReadId3v2Headers(){if("ID3"===(await this.tokenizer.peekToken(a.ID3v2Header)).fileIdentifier)return c("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}t.AbstractID3Parser=u},907:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.FrameParser=t.parseGenre=void 0;const i=r(1227),a=r(3416),s=r(3769),o=r(8281),l=r(2282),c=(0,i.default)("music-metadata:id3v2:frame-parser"),u="latin1";function h(e){const t=[];let r,n="";for(const i of e)if("string"==typeof r)if("("===i&&""===r)n+="(",r=void 0;else if(")"===i){""!==n&&(t.push(n),n="");const e=d(r);e&&t.push(e),r=void 0}else r+=i;else"("===i?r="":n+=i;return n&&(0===t.length&&n.match(/^\d*$/)&&(n=l.Genres[n]),t.push(n)),t}function d(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?l.Genres[e]:void 0}t.parseGenre=h;class f{constructor(e,t){this.major=e,this.warningCollector=t}readData(e,t,r){if(0===e.length)return void this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${t}`);const{encoding:i,bom:l}=o.TextEncodingToken.get(e,0),d=e.length;let m=0,p=[];const g=f.getNullTerminatorLength(i);let A;const b={};switch(c(`Parsing tag type=${t}, encoding=${i}, bom=${l}`),"TXXX"!==t&&"T"===t[0]?"T*":t){case"T*":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":let l;try{l=s.decodeString(e.slice(1),i).replace(/\x00+$/,"")}catch(e){this.warningCollector.addWarning(`id3v2.${this.major} type=${t} header has invalid string value: ${e.message}`)}switch(t){case"TMCL":case"TIPL":case"IPLS":p=this.splitValue(t,l),p=f.functionList(p);break;case"TRK":case"TRCK":case"TPOS":p=l;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":p=this.splitValue(t,l);break;case"TCO":case"TCON":p=this.splitValue(t,l).map((e=>h(e))).reduce(((e,t)=>e.concat(t)),[]);break;case"PCS":case"PCST":p=this.major>=4?this.splitValue(t,l):[l],p=Array.isArray(p)&&""===p[0]?1:0;break;default:p=this.major>=4?this.splitValue(t,l):[l]}break;case"TXXX":p=f.readIdentifierAndData(e,m+1,d,i),p={description:p.id,text:this.splitValue(t,s.decodeString(p.data,i).replace(/\x00+$/,""))};break;case"PIC":case"APIC":if(r){const t={};switch(m+=1,this.major){case 2:t.format=s.decodeString(e.slice(m,m+3),"latin1"),m+=3;break;case 3:case 4:A=s.findZero(e,m,d,u),t.format=s.decodeString(e.slice(m,A),u),m=A+1;break;default:throw new Error("Warning: unexpected major versionIndex: "+this.major)}t.format=f.fixPictureMimeType(t.format),t.type=o.AttachedPictureType[e[m]],m+=1,A=s.findZero(e,m,d,i),t.description=s.decodeString(e.slice(m,A),i),m=A+g,t.data=n.from(e.slice(m,d)),p=t}break;case"CNT":case"PCNT":p=a.UINT32_BE.get(e,0);break;case"SYLT":for(m+=7,p=[];m<d;){const t=e.slice(m,m=s.findZero(e,m,d,i));m+=5,p.push(s.decodeString(t,i))}break;case"ULT":case"USLT":case"COM":case"COMM":m+=1,b.language=s.decodeString(e.slice(m,m+3),u),m+=3,A=s.findZero(e,m,d,i),b.description=s.decodeString(e.slice(m,A),i),m=A+g,b.text=s.decodeString(e.slice(m,d),i).replace(/\x00+$/,""),p=[b];break;case"UFID":p=f.readIdentifierAndData(e,m,d,u),p={owner_identifier:p.id,identifier:p.data};break;case"PRIV":p=f.readIdentifierAndData(e,m,d,u),p={owner_identifier:p.id,data:p.data};break;case"POPM":A=s.findZero(e,m,d,u);const v=s.decodeString(e.slice(m,A),u);m=A+1;const y=d-m;p={email:v,rating:a.UINT8.get(e,m),counter:y>=5?a.UINT32_BE.get(e,m+1):void 0};break;case"GEOB":{A=s.findZero(e,m+1,d,i);const t=s.decodeString(e.slice(m+1,A),u);m=A+1,A=s.findZero(e,m,d-m,i);const r=s.decodeString(e.slice(m,A),u);m=A+1,A=s.findZero(e,m,d-m,i),p={type:t,filename:r,description:s.decodeString(e.slice(m,A),u),data:e.slice(m+1,d)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":p=s.decodeString(e.slice(m,A),u);break;case"WXXX":{A=s.findZero(e,m+1,d,i);const t=s.decodeString(e.slice(m+1,A),i);m=A+("utf16le"===i?2:1),p={description:t,url:s.decodeString(e.slice(m,d),u)};break}case"WFD":case"WFED":p=s.decodeString(e.slice(m+1,s.findZero(e,m+1,d,i)),i);break;case"MCDI":p=e.slice(0,d);break;default:c("Warning: unsupported id3v2-tag-type: "+t)}return p}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){const t={};for(let r=0;r+1<e.length;r+=2){const n=e[r+1].split(",");t[e[r]]=t.hasOwnProperty(e[r])?t[e[r]].concat(n):n}return t}splitValue(e,t){let r;return this.major<4?(r=t.split(/\x00/g),r.length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=t.split(/\//g)):r=t.split(/\x00/g),f.trimArray(r)}static trimArray(e){return e.map((e=>e.replace(/\x00+$/,"").trim()))}static readIdentifierAndData(e,t,r,n){const i=s.findZero(e,t,r,n),a=s.decodeString(e.slice(t,i),n);return t=i+f.getNullTerminatorLength(n),{id:a,data:e.slice(t,r)}}static getNullTerminatorLength(e){return"utf16le"===e?2:1}}t.FrameParser=f},7183:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v22TagMapper=t.id3v22TagMap=void 0;const n=r(4132);t.id3v22TagMap={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website","COM:iTunPGAP":"gapless",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class i extends n.CaseInsensitiveTagMap{constructor(){super(["ID3v2.2"],t.id3v22TagMap)}}t.ID3v22TagMapper=i},4005:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v24TagMapper=void 0;const n=r(9918),i=r(4132),a=r(3769),s={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer","USLT:description":"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"date",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl"};class o extends i.CaseInsensitiveTagMap{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*n.CommonTagMapper.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],s)}postMap(e,t){switch(e.id){case"UFID":"http://musicbrainz.org"===e.value.owner_identifier&&(e.id+=":"+e.value.owner_identifier,e.value=a.decodeString(e.value.identifier,"latin1"));break;case"PRIV":switch(e.value.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=":"+e.value.owner_identifier,e.value=4===e.value.data.length?e.value.data.readUInt32LE(0):null,null===e.value&&t.addWarning("Failed to parse PRIV:PeakValue");break;default:t.addWarning(`Unknown PRIV owner-identifier: ${e.value.owner_identifier}`)}break;case"COMM":e.value=e.value?e.value.text:null;break;case"POPM":e.value=o.toRating(e.value)}}}t.ID3v24TagMapper=o},8928:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v2Parser=void 0;const i=r(3416),a=r(3769),s=r(907),o=r(8281);class l{static removeUnsyncBytes(e){let t=0,r=0;for(;t<e.length-1;)t!==r&&(e[r]=e[t]),t+=255===e[t]&&0===e[t+1]?2:1,r++;return t<e.length&&(e[r++]=e[t]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw new Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:a.getBit(e,0,6),file_alter_preservation:a.getBit(e,0,5),read_only:a.getBit(e,0,4)},format:{grouping_identity:a.getBit(e,1,7),compression:a.getBit(e,1,3),encryption:a.getBit(e,1,2),unsynchronisation:a.getBit(e,1,1),data_length_indicator:a.getBit(e,1,0)}}}static readFrameData(e,t,r,n,i){const a=new s.FrameParser(r,i);switch(r){case 2:return a.readData(e,t.id,n);case 3:case 4:return t.flags.format.unsynchronisation&&(e=l.removeUnsyncBytes(e)),t.flags.format.data_length_indicator&&(e=e.slice(4,e.length)),a.readData(e,t.id,n);default:throw new Error("Unexpected majorVer: "+r)}}static makeDescriptionTagName(e,t){return e+(t?":"+t:"")}async parse(e,t,r){this.tokenizer=t,this.metadata=e,this.options=r;const n=await this.tokenizer.readToken(o.ID3v2Header);if("ID3"!==n.fileIdentifier)throw new Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=n,this.headerType="ID3v2."+n.version.major,n.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(n.size)}async parseExtendedHeader(){const e=await this.tokenizer.readToken(o.ExtendedHeader),t=e.size-o.ExtendedHeader.len;return t>0?this.parseExtendedHeaderData(t,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,t){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-t)}async parseId3Data(e){const t=await this.tokenizer.readToken(new i.Uint8ArrayType(e));for(const e of this.parseMetadata(t))if("TXXX"===e.id){if(e.value)for(const t of e.value.text)this.addTag(l.makeDescriptionTagName(e.id,e.value.description),t)}else if("COM"===e.id)for(const t of e.value)this.addTag(l.makeDescriptionTagName(e.id,t.description),t.text);else if("COMM"===e.id)for(const t of e.value)this.addTag(l.makeDescriptionTagName(e.id,t.description),t);else if(Array.isArray(e.value))for(const t of e.value)this.addTag(e.id,t);else this.addTag(e.id,e.value)}addTag(e,t){this.metadata.addTag(this.headerType,e,t)}parseMetadata(e){let t=0;const r=[];for(;t!==e.length;){const n=l.getFrameHeaderLength(this.id3Header.version.major);if(t+n>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}const i=e.slice(t,t+=n),a=this.readFrameHeader(i,this.id3Header.version.major),s=e.slice(t,t+=a.length),o=l.readFrameData(s,a,this.id3Header.version.major,!this.options.skipCovers,this.metadata);o&&r.push({id:a.id,value:o})}return r}readFrameHeader(e,t){let r;switch(t){case 2:r={id:n.from(e.slice(0,3)).toString("ascii"),length:i.UINT24_BE.get(e,3)},r.id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:r={id:n.from(e.slice(0,4)).toString("ascii"),length:(4===t?o.UINT32SYNCSAFE:i.UINT32_BE).get(e,4),flags:l.readFrameFlags(e.slice(8,10))},r.id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw new Error("Unexpected majorVer: "+t)}return r}}t.ID3v2Parser=l},8281:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextEncodingToken=t.ExtendedHeader=t.ID3v2Header=t.UINT32SYNCSAFE=t.AttachedPictureType=void 0;const n=r(3416),i=r(3769);var a;(a=t.AttachedPictureType||(t.AttachedPictureType={}))[a.Other=0]="Other",a[a["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",a[a["Other file icon"]=2]="Other file icon",a[a["Cover (front)"]=3]="Cover (front)",a[a["Cover (back)"]=4]="Cover (back)",a[a["Leaflet page"]=5]="Leaflet page",a[a["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",a[a["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",a[a["Artist/performer"]=8]="Artist/performer",a[a.Conductor=9]="Conductor",a[a["Band/Orchestra"]=10]="Band/Orchestra",a[a.Composer=11]="Composer",a[a["Lyricist/text writer"]=12]="Lyricist/text writer",a[a["Recording Location"]=13]="Recording Location",a[a["During recording"]=14]="During recording",a[a["During performance"]=15]="During performance",a[a["Movie/video screen capture"]=16]="Movie/video screen capture",a[a["A bright coloured fish"]=17]="A bright coloured fish",a[a.Illustration=18]="Illustration",a[a["Band/artist logotype"]=19]="Band/artist logotype",a[a["Publisher/Studio logotype"]=20]="Publisher/Studio logotype",t.UINT32SYNCSAFE={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4},t.ID3v2Header={len:10,get:(e,r)=>({fileIdentifier:new n.StringType(3,"ascii").get(e,r),version:{major:n.INT8.get(e,r+3),revision:n.INT8.get(e,r+4)},flags:{unsynchronisation:i.getBit(e,r+5,7),isExtendedHeader:i.getBit(e,r+5,6),expIndicator:i.getBit(e,r+5,5),footer:i.getBit(e,r+5,4)},size:t.UINT32SYNCSAFE.get(e,r+6)})},t.ExtendedHeader={len:10,get:(e,t)=>({size:n.UINT32_BE.get(e,t),extendedFlags:n.UINT16_BE.get(e,t+4),sizeOfPadding:n.UINT32_BE.get(e,t+6),crcDataPresent:i.getBit(e,t+4,31)})},t.TextEncodingToken={len:1,get:(e,t)=>{switch(e[t]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf16le",bom:!0};case 2:return{encoding:"utf16le",bom:!1};default:return{encoding:"utf8",bom:!1}}}}},4633:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const n=r(3416),i=r(8049);t.Header={len:8,get:(e,t)=>({chunkID:i.FourCcToken.get(e,t),chunkSize:Number(BigInt(n.UINT32_BE.get(e,t+4)))})}},9941:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.getLyricsHeaderLength=t.endTag2=void 0,t.endTag2="LYRICS200",t.getLyricsHeaderLength=async function(e){if(e.fileSize>=143){const r=n.alloc(15);await e.randomRead(r,0,r.length,e.fileSize-143);const i=r.toString("binary");if(i.substr(6)===t.endTag2)return parseInt(i.substr(0,6),10)+15}return 0}},3121:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elements=void 0;const n=r(8591);t.elements={440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:n.DataType.uint},17143:{name:"ebmlReadVersion",value:n.DataType.uint},17138:{name:"ebmlMaxIDWidth",value:n.DataType.uint},17139:{name:"ebmlMaxSizeWidth",value:n.DataType.uint},17026:{name:"docType",value:n.DataType.string},17031:{name:"docTypeVersion",value:n.DataType.uint},17029:{name:"docTypeReadVersion",value:n.DataType.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",container:{21419:{name:"seekId",value:n.DataType.binary},21420:{name:"seekPosition",value:n.DataType.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:n.DataType.uid},29572:{name:"filename",value:n.DataType.string},3979555:{name:"prevUID",value:n.DataType.uid},3965867:{name:"prevFilename",value:n.DataType.string},4110627:{name:"nextUID",value:n.DataType.uid},4096955:{name:"nextFilename",value:n.DataType.string},2807729:{name:"timecodeScale",value:n.DataType.uint},17545:{name:"duration",value:n.DataType.float},17505:{name:"dateUTC",value:n.DataType.uint},31657:{name:"title",value:n.DataType.string},19840:{name:"muxingApp",value:n.DataType.string},22337:{name:"writingApp",value:n.DataType.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:n.DataType.uid},163:{name:"unknown",value:n.DataType.binary},167:{name:"position",value:n.DataType.uid},171:{name:"prevSize",value:n.DataType.uid}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:n.DataType.uint},29637:{name:"uid",value:n.DataType.uid},131:{name:"trackType",value:n.DataType.uint},185:{name:"flagEnabled",value:n.DataType.bool},136:{name:"flagDefault",value:n.DataType.bool},21930:{name:"flagForced",value:n.DataType.bool},156:{name:"flagLacing",value:n.DataType.bool},28135:{name:"minCache",value:n.DataType.uint},28136:{name:"maxCache",value:n.DataType.uint},2352003:{name:"defaultDuration",value:n.DataType.uint},2306383:{name:"timecodeScale",value:n.DataType.float},21358:{name:"name",value:n.DataType.string},2274716:{name:"language",value:n.DataType.string},134:{name:"codecID",value:n.DataType.string},25506:{name:"codecPrivate",value:n.DataType.binary},2459272:{name:"codecName",value:n.DataType.string},3839639:{name:"codecSettings",value:n.DataType.string},3883072:{name:"codecInfoUrl",value:n.DataType.string},2536e3:{name:"codecDownloadUrl",value:n.DataType.string},170:{name:"codecDecodeAll",value:n.DataType.bool},28587:{name:"trackOverlay",value:n.DataType.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:n.DataType.bool},21432:{name:"stereoMode",value:n.DataType.uint},176:{name:"pixelWidth",value:n.DataType.uint},186:{name:"pixelHeight",value:n.DataType.uint},21680:{name:"displayWidth",value:n.DataType.uint},21690:{name:"displayHeight",value:n.DataType.uint},21683:{name:"aspectRatioType",value:n.DataType.uint},3061028:{name:"colourSpace",value:n.DataType.uint},3126563:{name:"gammaValue",value:n.DataType.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:n.DataType.float},30901:{name:"outputSamplingFrequency",value:n.DataType.float},159:{name:"channels",value:n.DataType.uint},148:{name:"channels",value:n.DataType.uint},32123:{name:"channelPositions",value:n.DataType.binary},25188:{name:"bitDepth",value:n.DataType.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:n.DataType.uint},20530:{name:"scope",value:n.DataType.bool},20531:{name:"type",value:n.DataType.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:n.DataType.uint},16981:{name:"contentCompSettings",value:n.DataType.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:n.DataType.uint},18402:{name:"contentEncKeyID",value:n.DataType.binary},18403:{name:"contentSignature ",value:n.DataType.binary},18404:{name:"ContentSigKeyID  ",value:n.DataType.binary},18405:{name:"contentSigAlgo ",value:n.DataType.uint},18406:{name:"contentSigHashAlgo ",value:n.DataType.uint}}},25188:{name:"bitDepth",value:n.DataType.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:n.DataType.uid},183:{name:"positions",container:{247:{name:"track",value:n.DataType.uint},241:{name:"clusterPosition",value:n.DataType.uint},21368:{name:"blockNumber",value:n.DataType.uint},234:{name:"codecState",value:n.DataType.uint},219:{name:"reference",container:{150:{name:"time",value:n.DataType.uint},151:{name:"cluster",value:n.DataType.uint},21343:{name:"number",value:n.DataType.uint},235:{name:"codecState",value:n.DataType.uint}}},240:{name:"relativePosition",value:n.DataType.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:n.DataType.string},18030:{name:"name",value:n.DataType.string},18016:{name:"mimeType",value:n.DataType.string},18012:{name:"data",value:n.DataType.binary},18094:{name:"uid",value:n.DataType.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:n.DataType.uid},145:{name:"timeStart",value:n.DataType.uint},146:{name:"timeEnd",value:n.DataType.uid},152:{name:"hidden",value:n.DataType.bool},17816:{name:"enabled",value:n.DataType.uid},143:{name:"track",container:{137:{name:"trackNumber",value:n.DataType.uid},128:{name:"display",container:{133:{name:"string",value:n.DataType.string},17276:{name:"language ",value:n.DataType.string},17278:{name:"country ",value:n.DataType.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:n.DataType.uid},25540:{name:"tagChapterUID",value:n.DataType.uint},25542:{name:"tagAttachmentUID",value:n.DataType.uid},25546:{name:"targetType",value:n.DataType.string},26826:{name:"targetTypeValue",value:n.DataType.uint},25545:{name:"tagEditionUID",value:n.DataType.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:n.DataType.string},17543:{name:"string",value:n.DataType.string},17541:{name:"binary",value:n.DataType.binary},17530:{name:"language",value:n.DataType.string},17531:{name:"languageIETF",value:n.DataType.string},17540:{name:"default",value:n.DataType.bool}}}}}}}}}}},78:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MatroskaParser=void 0;const i=r(3416),a=r(1227),s=r(7805),o=r(8591),l=r(3121),c=(0,a.default)("music-metadata:parser:matroska");class u extends s.BasicParser{constructor(){super(),this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(o.DataType.uint,(e=>this.readUint(e))),this.parserMap.set(o.DataType.string,(e=>this.readString(e))),this.parserMap.set(o.DataType.binary,(e=>this.readBuffer(e))),this.parserMap.set(o.DataType.uid,(async e=>1===await this.readUint(e))),this.parserMap.set(o.DataType.bool,(e=>this.readFlag(e))),this.parserMap.set(o.DataType.float,(e=>this.readFloat(e)))}init(e,t,r){return super.init(e,t,r),this}async parse(){const e=await this.parseContainer(l.elements,this.tokenizer.fileInfo.size,[]);if(this.metadata.setFormat("container",`EBML/${e.ebml.docType}`),e.segment){const t=e.segment.info;if(t){const e=t.timecodeScale?t.timecodeScale:1e6,r=t.duration*e/1e9;this.addTag("segment:title",t.title),this.metadata.setFormat("duration",r)}const r=e.segment.tracks;if(r&&r.entries){r.entries.forEach((e=>{const t={codecName:e.codecID.replace("A_","").replace("V_",""),codecSettings:e.codecSettings,flagDefault:e.flagDefault,flagLacing:e.flagLacing,flagEnabled:e.flagEnabled,language:e.language,name:e.name,type:e.trackType,audio:e.audio,video:e.video};this.metadata.addStreamInfo(t)}));const t=r.entries.filter((e=>e.trackType===o.TrackType.audio.valueOf())).reduce(((e,t)=>e?!e.flagDefault&&t.flagDefault||t.trackNumber&&t.trackNumber<e.trackNumber?t:e:t),null);t&&(this.metadata.setFormat("codec",t.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",t.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",t.audio.channels)),e.segment.tags&&e.segment.tags.tag.forEach((e=>{const t=e.target,r=(null==t?void 0:t.targetTypeValue)?o.TargetType[t.targetTypeValue]:(null==t?void 0:t.targetType)?t.targetType:"track";e.simpleTags.forEach((e=>{const t=e.string?e.string:e.binary;this.addTag(`${r}:${e.name}`,t)}))})),e.segment.attachments&&e.segment.attachments.attachedFiles.filter((e=>e.mimeType.startsWith("image/"))).map((e=>({data:e.data,format:e.mimeType,description:e.description,name:e.name}))).forEach((e=>{this.addTag("picture",e)}))}}}async parseContainer(e,t,r){const n={};for(;this.tokenizer.position<t;){let t;try{t=await this.readElement()}catch(e){if("End-Of-Stream"===e.message)break;throw e}const i=e[t.id];if(i)if(c(`Element: name=${i.name}, container=${!!i.container}`),i.container){const e=await this.parseContainer(i.container,t.len>=0?this.tokenizer.position+t.len:-1,r.concat([i.name]));i.multiple?(n[i.name]||(n[i.name]=[]),n[i.name].push(e)):n[i.name]=e}else n[i.name]=await this.parserMap.get(i.value)(t);else 236===t.id?(this.padding+=t.len,await this.tokenizer.ignore(t.len)):(c(`parseEbml: path=${r.join("/")}, unknown element: id=${t.id.toString(16)}`),this.padding+=t.len,await this.tokenizer.ignore(t.len))}return n}async readVintData(e){const t=await this.tokenizer.peekNumber(i.UINT8);let r=128,a=1;for(;0==(t&r);){if(a>e)throw new Error("VINT value exceeding maximum size");++a,r>>=1}const s=n.alloc(a);return await this.tokenizer.readBuffer(s),s}async readElement(){const e=await this.readVintData(this.ebmlMaxIDLength),t=await this.readVintData(this.ebmlMaxSizeLength);t[0]^=128>>t.length-1;const r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}isMaxValue(e){if(e.length===this.ebmlMaxSizeLength){for(let t=1;t<this.ebmlMaxSizeLength;++t)if(255!==e[t])return!1;return!0}return!1}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(i.Float32_BE);case 8:case 10:return this.tokenizer.readNumber(i.Float64_BE);default:throw new Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return 1===await this.readUint(e)}async readUint(e){const t=await this.readBuffer(e),r=Math.min(6,e.len);return t.readUIntBE(e.len-r,r)}async readString(e){return(await this.tokenizer.readToken(new i.StringType(e.len,"utf-8"))).replace(/\00.*$/g,"")}async readBuffer(e){const t=n.alloc(e.len);return await this.tokenizer.readBuffer(t),t}addTag(e,t){this.metadata.addTag("matroska",e,t)}}t.MatroskaParser=u},5481:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MatroskaTagMapper=void 0;const n=r(4132),i={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class a extends n.CaseInsensitiveTagMap{constructor(){super(["matroska"],i)}}t.MatroskaTagMapper=a},8591:(e,t)=>{"use strict";var r,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.TrackType=t.TargetType=t.DataType=void 0,(i=t.DataType||(t.DataType={}))[i.string=0]="string",i[i.uint=1]="uint",i[i.uid=2]="uid",i[i.bool=3]="bool",i[i.binary=4]="binary",i[i.float=5]="float",(n=t.TargetType||(t.TargetType={}))[n.shot=10]="shot",n[n.scene=20]="scene",n[n.track=30]="track",n[n.part=40]="part",n[n.album=50]="album",n[n.edition=60]="edition",n[n.collection=70]="collection",(r=t.TrackType||(t.TrackType={}))[r.video=1]="video",r[r.audio=2]="audio",r[r.complex=3]="complex",r[r.logo=4]="logo",r[r.subtitle=17]="subtitle",r[r.button=18]="button",r[r.control=32]="control"},9134:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Atom=void 0;const n=r(1227),i=r(1060),a=(0,n.default)("music-metadata:parser:MP4:Atom");class s{constructor(e,t,r){this.header=e,this.extended=t,this.parent=r,this.children=[],this.atomPath=(this.parent?this.parent.atomPath+".":"")+this.header.name}static async readAtom(e,t,r,n){const o=e.position,l=await e.readToken(i.Header);l.length===BigInt(1)&&(l.length=await e.readToken(i.ExtendedSize));const c=new s(l,l.length===BigInt(1),r),u=c.getPayloadLength(n);return a(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${o}, len=${c.header.length}`),await c.readData(e,t,u),c}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,t,r){for(;r>0;){const n=await s.readAtom(e,t,this,r);this.children.push(n),r-=n.header.length===BigInt(0)?r:Number(n.header.length)}}async readData(e,t,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,t,this.getPayloadLength(r));case"meta":return await e.ignore(4),this.readAtoms(e,t,this.getPayloadLength(r)-4);default:return t(this,r)}}}t.Atom=s},1060:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ChapterText=t.StcoAtom=t.StszAtom=t.StscAtom=t.SampleToChunkToken=t.SttsAtom=t.TimeToSampleToken=t.SoundSampleDescriptionV0=t.SoundSampleDescriptionVersion=t.StsdAtom=t.TrackHeaderAtom=t.NameAtom=t.DataAtom=t.MvhdAtom=t.MdhdAtom=t.FixedLengthAtom=t.mhdr=t.tkhd=t.ftyp=t.ExtendedSize=t.Header=void 0;const i=r(3416),a=r(1227),s=r(8049),o=(0,a.default)("music-metadata:parser:MP4:atom");t.Header={len:8,get:(e,t)=>{const r=i.UINT32_BE.get(e,t);if(r<0)throw new Error("Invalid atom header length");return{length:BigInt(r),name:new i.StringType(4,"binary").get(e,t+4)}},put:(e,t,r)=>(i.UINT32_BE.put(e,t,Number(r.length)),s.FourCcToken.put(e,t+4,r.name))},t.ExtendedSize=i.UINT64_BE,t.ftyp={len:4,get:(e,t)=>({type:new i.StringType(4,"ascii").get(e,t)})},t.tkhd={len:4,get:(e,t)=>({type:new i.StringType(4,"ascii").get(e,t)})},t.mhdr={len:8,get:(e,t)=>({version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),nextItemID:i.UINT32_BE.get(e,t+4)})};class l{constructor(e,t,r){if(this.len=e,e<t)throw new Error(`Atom ${r} expected to be ${t}, but specifies ${e} bytes long.`);e>t&&o(`Warning: atom ${r} expected to be ${t}, but was actually ${e} bytes long.`)}}t.FixedLengthAtom=l;const c=(e,t)=>{const r=i.UINT32_BE.get(e,t)-2082844800;return new Date(1e3*r)};t.MdhdAtom=class extends l{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,t){return{version:i.UINT8.get(e,t+0),flags:i.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),timeScale:i.UINT32_BE.get(e,t+12),duration:i.UINT32_BE.get(e,t+16),language:i.UINT16_BE.get(e,t+20),quality:i.UINT16_BE.get(e,t+22)}}},t.MvhdAtom=class extends l{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,t){return{version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),timeScale:i.UINT32_BE.get(e,t+12),duration:i.UINT32_BE.get(e,t+16),preferredRate:i.UINT32_BE.get(e,t+20),preferredVolume:i.UINT16_BE.get(e,t+24),previewTime:i.UINT32_BE.get(e,t+72),previewDuration:i.UINT32_BE.get(e,t+76),posterTime:i.UINT32_BE.get(e,t+80),selectionTime:i.UINT32_BE.get(e,t+84),selectionDuration:i.UINT32_BE.get(e,t+88),currentTime:i.UINT32_BE.get(e,t+92),nextTrackID:i.UINT32_BE.get(e,t+96)}}},t.DataAtom=class{constructor(e){this.len=e}get(e,t){return{type:{set:i.UINT8.get(e,t+0),type:i.UINT24_BE.get(e,t+1)},locale:i.UINT24_BE.get(e,t+4),value:n.from(new i.Uint8ArrayType(this.len-8).get(e,t+8))}}},t.NameAtom=class{constructor(e){this.len=e}get(e,t){return{version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),name:new i.StringType(this.len-4,"utf-8").get(e,t+4)}}},t.TrackHeaderAtom=class{constructor(e){this.len=e}get(e,t){return{version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),trackId:i.UINT32_BE.get(e,t+12),duration:i.UINT32_BE.get(e,t+20),layer:i.UINT16_BE.get(e,t+24),alternateGroup:i.UINT16_BE.get(e,t+26),volume:i.UINT16_BE.get(e,t+28)}}};class u{constructor(e){this.len=e}get(e,t){return{dataFormat:s.FourCcToken.get(e,t),dataReferenceIndex:i.UINT16_BE.get(e,t+10),description:new i.Uint8ArrayType(this.len-12).get(e,t+12)}}}t.StsdAtom=class{constructor(e){this.len=e}get(e,t){const r=((e,t)=>({version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),numberOfEntries:i.UINT32_BE.get(e,t+4)}))(e,t);t+=8;const n=[];for(let a=0;a<r.numberOfEntries;++a){const r=i.UINT32_BE.get(e,t);t+=i.UINT32_BE.len,n.push(new u(r).get(e,t)),t+=r}return{header:r,table:n}}},t.SoundSampleDescriptionVersion={len:8,get:(e,t)=>({version:i.INT16_BE.get(e,t),revision:i.INT16_BE.get(e,t+2),vendor:i.INT32_BE.get(e,t+4)})},t.SoundSampleDescriptionV0={len:12,get:(e,t)=>({numAudioChannels:i.INT16_BE.get(e,t+0),sampleSize:i.INT16_BE.get(e,t+2),compressionId:i.INT16_BE.get(e,t+4),packetSize:i.INT16_BE.get(e,t+6),sampleRate:i.UINT16_BE.get(e,t+8)+i.UINT16_BE.get(e,t+10)/1e4})};class h{constructor(e,t){this.len=e,this.token=t}get(e,t){const r=i.INT32_BE.get(e,t+4);return{version:i.INT8.get(e,t+0),flags:i.INT24_BE.get(e,t+1),numberOfEntries:r,entries:d(e,this.token,t+8,this.len-8,r)}}}function d(e,t,r,n,i){if(o(`remainingLen=${n}, numberOfEntries=${i} * token-len=${t.len}`),0===n)return[];if(n!==i*t.len)throw new Error("mismatch number-of-entries with remaining atom-length");const a=[];for(let n=0;n<i;++n)a.push(t.get(e,r)),r+=t.len;return a}t.TimeToSampleToken={len:8,get:(e,t)=>({count:i.INT32_BE.get(e,t+0),duration:i.INT32_BE.get(e,t+4)})},t.SttsAtom=class extends h{constructor(e){super(e,t.TimeToSampleToken),this.len=e}},t.SampleToChunkToken={len:12,get:(e,t)=>({firstChunk:i.INT32_BE.get(e,t),samplesPerChunk:i.INT32_BE.get(e,t+4),sampleDescriptionId:i.INT32_BE.get(e,t+8)})},t.StscAtom=class extends h{constructor(e){super(e,t.SampleToChunkToken),this.len=e}},t.StszAtom=class{constructor(e){this.len=e}get(e,t){const r=i.INT32_BE.get(e,t+8);return{version:i.INT8.get(e,t),flags:i.INT24_BE.get(e,t+1),sampleSize:i.INT32_BE.get(e,t+4),numberOfEntries:r,entries:d(e,i.INT32_BE,t+12,this.len-12,r)}}},t.StcoAtom=class extends h{constructor(e){super(e,i.INT32_BE),this.len=e}},t.ChapterText=class{constructor(e){this.len=e}get(e,t){const r=i.INT16_BE.get(e,t+0);return new i.StringType(r,"utf-8").get(e,t+2)}}},8841:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MP4Parser=void 0;const i=r(1227),a=r(3416),s=r(7805),o=r(2282),l=r(6032),c=r(9134),u=r(1060),h=(0,i.default)("music-metadata:parser:MP4"),d={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function f(e,t,r){return r.indexOf(e)===t}class m extends s.BasicParser{constructor(){super(...arguments),this.atomParsers={mvhd:async e=>{const t=await this.tokenizer.readToken(new u.MvhdAtom(e));this.metadata.setFormat("creationTime",t.creationTime),this.metadata.setFormat("modificationTime",t.modificationTime)},mdhd:async e=>{const t=await this.tokenizer.readToken(new u.MdhdAtom(e)),r=this.getTrackDescription();r.creationTime=t.creationTime,r.modificationTime=t.modificationTime,r.timeScale=t.timeScale,r.duration=t.duration},chap:async e=>{const t=this.getTrackDescription(),r=[];for(;e>=a.UINT32_BE.len;)r.push(await this.tokenizer.readNumber(a.UINT32_BE)),e-=a.UINT32_BE.len;t.chapterList=r},tkhd:async e=>{const t=await this.tokenizer.readToken(new u.TrackHeaderAtom(e));this.tracks.push(t)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){const t=this.tracks.filter((e=>e.chapterList));if(1===t.length){const r=t[0].chapterList,n=this.tracks.filter((e=>-1!==r.indexOf(e.trackId)));if(1===n.length)return this.parseChapterTrack(n[0],t[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{const t=[];for(;e>0;){const r=await this.tokenizer.readToken(u.ftyp);e-=u.ftyp.len;const n=r.type.replace(/\W/g,"");n.length>0&&t.push(n)}h(`ftyp: ${t.join("/")}`);const r=t.filter(f).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{const t=await this.tokenizer.readToken(new u.StsdAtom(e));this.getTrackDescription().soundSampleDescription=t.table.map((e=>this.parseSoundSampleDescription(e)))},stsc:async e=>{const t=await this.tokenizer.readToken(new u.StscAtom(e));this.getTrackDescription().sampleToChunkTable=t.entries},stts:async e=>{const t=await this.tokenizer.readToken(new u.SttsAtom(e));this.getTrackDescription().timeToSampleTable=t.entries},stsz:async e=>{const t=await this.tokenizer.readToken(new u.StszAtom(e)),r=this.getTrackDescription();r.sampleSize=t.sampleSize,r.sampleSizeTable=t.entries},stco:async e=>{const t=await this.tokenizer.readToken(new u.StcoAtom(e));this.getTrackDescription().chunkOffsetTable=t.entries},date:async e=>{const t=await this.tokenizer.readToken(new a.StringType(e,"utf-8"));this.addTag("date",t)}}}static read_BE_Integer(e,t){const r=(t?"INT":"UINT")+8*e.length+(e.length>1?"_BE":""),n=a[r];if(!n)throw new Error('Token for integer type not found: "'+r+'"');return Number(n.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size;for(;!this.tokenizer.fileInfo.size||e>0;){try{if("\0\0\0\0"===(await this.tokenizer.peekToken(u.Header)).name){const e=`Error at offset=${this.tokenizer.position}: box.id=0`;h(e),this.addWarning(e);break}}catch(e){const t=`Error at offset=${this.tokenizer.position}: ${e.message}`;h(t),this.addWarning(t);break}const t=await c.Atom.readAtom(this.tokenizer,((e,t)=>this.handleAtom(e,t)),null,e);e-=t.header.length===BigInt(0)?e:Number(t.header.length)}const t=[];this.tracks.forEach((e=>{const r=[];e.soundSampleDescription.forEach((e=>{const t={},n=d[e.dataFormat];if(n?(r.push(n.format),t.codecName=n.format):t.codecName=`<${e.dataFormat}>`,e.description){const{description:r}=e;r.sampleRate>0&&(t.type=l.TrackType.audio,t.audio={samplingFrequency:r.sampleRate,bitDepth:r.sampleSize,channels:r.numAudioChannels})}this.metadata.addStreamInfo(t)})),r.length>=1&&t.push(r.join("/"))})),t.length>0&&this.metadata.setFormat("codec",t.filter(f).join("+"));const r=this.tracks.filter((e=>e.soundSampleDescription.length>=1&&e.soundSampleDescription[0].description&&e.soundSampleDescription[0].description.numAudioChannels>0));if(r.length>=1){const e=r[0],t=e.duration/e.timeScale;this.metadata.setFormat("duration",t);const n=e.soundSampleDescription[0];n.description&&(this.metadata.setFormat("sampleRate",n.description.sampleRate),this.metadata.setFormat("bitsPerSample",n.description.sampleSize),this.metadata.setFormat("numberOfChannels",n.description.numAudioChannels));const i=d[n.dataFormat];i&&this.metadata.setFormat("lossless",!i.lossy),this.calculateBitRate()}}async handleAtom(e,t){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](t);h(`No parser for atom path=${e.atomPath}, payload-len=${t}, ignoring atom`),await this.tokenizer.ignore(t)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}addTag(e,t){this.metadata.addTag("iTunes",e,t)}addWarning(e){h("Warning: "+e),this.metadata.addWarning(e)}parseMetadataItemData(e){let t=e.header.name;return e.readAtoms(this.tokenizer,(async(e,r)=>{const n=e.getPayloadLength(r);switch(e.header.name){case"data":return this.parseValueAtom(t,e);case"name":const r=await this.tokenizer.readToken(new u.NameAtom(n));t+=":"+r.name;break;case"mean":const i=await this.tokenizer.readToken(new u.NameAtom(n));t+=":"+i.name;break;default:const s=await this.tokenizer.readToken(new a.BufferType(n));this.addWarning("Unsupported meta-item: "+t+"["+e.header.name+"] => value="+s.toString("hex")+" ascii="+s.toString("ascii"))}}),e.getPayloadLength(0))}async parseValueAtom(e,t){const r=await this.tokenizer.readToken(new u.DataAtom(Number(t.header.length)-u.Header.len));if(0!==r.type.set)throw new Error("Unsupported type-set != 0: "+r.type.set);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":const t=a.UINT8.get(r.value,3),n=a.UINT8.get(r.value,5);this.addTag(e,t+"/"+n);break;case"gnre":const i=a.UINT8.get(r.value,1),s=o.Genres[i-1];this.addTag(e,s)}break;case 1:case 18:this.addTag(e,r.value.toString("utf-8"));break;case 13:if(this.options.skipCovers)break;this.addTag(e,{format:"image/jpeg",data:n.from(r.value)});break;case 14:if(this.options.skipCovers)break;this.addTag(e,{format:"image/png",data:n.from(r.value)});break;case 21:this.addTag(e,m.read_BE_Integer(r.value,!0));break;case 22:this.addTag(e,m.read_BE_Integer(r.value,!1));break;case 65:this.addTag(e,r.value.readInt8(0));break;case 66:this.addTag(e,r.value.readInt16BE(0));break;case 67:this.addTag(e,r.value.readInt32BE(0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){const t={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex};let r=0;const n=u.SoundSampleDescriptionVersion.get(e.description,r);return r+=u.SoundSampleDescriptionVersion.len,0===n.version||1===n.version?t.description=u.SoundSampleDescriptionV0.get(e.description,r):h(`Warning: sound-sample-description ${n} not implemented`),t}async parseChapterTrack(e,t,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw new Error("Expected equal chunk-offset-table & sample-size-table length.");const n=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){const a=e.chunkOffsetTable[i]-this.tokenizer.position,s=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if((r-=a+s)<0)throw new Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(a);const o=await this.tokenizer.readToken(new u.ChapterText(s));h(`Chapter ${i+1}: ${o}`);const l={title:o,sampleOffset:this.findSampleOffset(t,this.tokenizer.position)};h(`Chapter title=${l.title}, offset=${l.sampleOffset}/${this.tracks[0].duration}`),n.push(l)}this.metadata.setFormat("chapters",n),await this.tokenizer.ignore(r)}findSampleOffset(e,t){let r=0;e.timeToSampleTable.forEach((e=>{r+=e.count*e.duration})),h(`Total duration=${r}`);let n=0;for(;n<e.chunkOffsetTable.length&&e.chunkOffsetTable[n]<t;)++n;return this.getChunkDuration(n+1,e)}getChunkDuration(e,t){let r=0,n=t.timeToSampleTable[r].count,i=t.timeToSampleTable[r].duration,a=1,s=this.getSamplesPerChunk(a,t.sampleToChunkTable),o=0;for(;a<e;){const e=Math.min(n,s);o+=e*i,n-=e,s-=e,0===s?(++a,s=this.getSamplesPerChunk(a,t.sampleToChunkTable)):(++r,n=t.timeToSampleTable[r].count,i=t.timeToSampleTable[r].duration)}return o}getSamplesPerChunk(e,t){for(let r=0;r<t.length-1;++r)if(e>=t[r].firstChunk&&e<t[r+1].firstChunk)return t[r].samplesPerChunk;return t[t.length-1].samplesPerChunk}}t.MP4Parser=m},7852:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MP4TagMapper=t.tagType=void 0;const n=r(4132),i={"©nam":"title","©ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","©alb":"album","©day":"date","©cmt":"comment","©com":"comment",trkn:"track",disk:"disk","©gen":"genre",covr:"picture","©wrt":"composer","©lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","©grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","©cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","©too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear",desc:"description",ldes:"longDescription","©mvn":"movement","©mvi":"movementIndex","©mvc":"movementTotal","©wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik"};t.tagType="iTunes";class a extends n.CaseInsensitiveTagMap{constructor(){super([t.tagType],i)}}t.MP4TagMapper=a},5261:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedLameHeader=void 0;const n=r(3416),i=r(3769),a=r(6118);t.ExtendedLameHeader={len:27,get:(e,t)=>{const r=n.UINT32_BE.get(e,t+2);return{revision:i.getBitAllignedNumber(e,t,0,4),vbr_method:i.getBitAllignedNumber(e,t,4,4),lowpass_filter:100*n.UINT8.get(e,t+1),track_peak:0===r?void 0:r/Math.pow(2,23),track_gain:a.ReplayGain.get(e,6),album_gain:a.ReplayGain.get(e,8),music_length:n.UINT32_BE.get(e,t+20),music_crc:n.UINT8.get(e,t+24),header_crc:n.UINT16_BE.get(e,t+24)}}}},60:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MpegParser=void 0;const i=r(3416),a=r(5849),s=r(1227),o=r(3769),l=r(5159),c=r(3566),u=(0,s.default)("music-metadata:parser:mpeg"),h={AudioObjectTypes:["AAC Main","AAC LC","AAC SSR","AAC LTP"],SamplingFrequencies:[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,void 0,void 0,-1]},d=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class f{constructor(e,t){this.versionIndex=o.getBitAllignedNumber(e,t+1,3,2),this.layer=f.LayerDescription[o.getBitAllignedNumber(e,t+1,5,2)],this.versionIndex>1&&0===this.layer?this.parseAdtsHeader(e,t):this.parseMpegHeader(e,t),this.isProtectedByCRC=!o.isBitSet(e,t+1,7)}calcDuration(e){return e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return f.samplesInFrameTable[1===this.version?0:1][this.layer]}calculateSideInfoLength(){if(3!==this.layer)return 2;if(3===this.channelModeIndex){if(1===this.version)return 17;if(2===this.version||2.5===this.version)return 9}else{if(1===this.version)return 32;if(2===this.version||2.5===this.version)return 17}}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,t){this.container="MPEG",this.bitrateIndex=o.getBitAllignedNumber(e,t+2,0,4),this.sampRateFreqIndex=o.getBitAllignedNumber(e,t+2,4,2),this.padding=o.isBitSet(e,t+2,6),this.privateBit=o.isBitSet(e,t+2,7),this.channelModeIndex=o.getBitAllignedNumber(e,t+3,0,2),this.modeExtension=o.getBitAllignedNumber(e,t+3,2,2),this.isCopyrighted=o.isBitSet(e,t+3,4),this.isOriginalMedia=o.isBitSet(e,t+3,5),this.emphasis=o.getBitAllignedNumber(e,t+3,7,2),this.version=f.VersionID[this.versionIndex],this.channelMode=f.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;const r=this.calcBitrate();if(!r)throw new Error("Cannot determine bit-rate");if(this.bitrate=1e3*r,this.samplingRate=this.calcSamplingRate(),null==this.samplingRate)throw new Error("Cannot determine sampling-rate")}parseAdtsHeader(e,t){u("layer=0 => ADTS"),this.version=2===this.versionIndex?4:2,this.container="ADTS/MPEG-"+this.version;const r=o.getBitAllignedNumber(e,t+2,0,2);this.codec="AAC",this.codecProfile=h.AudioObjectTypes[r],u(`MPEG-4 audio-codec=${this.codec}`);const n=o.getBitAllignedNumber(e,t+2,2,4);this.samplingRate=h.SamplingFrequencies[n],u(`sampling-rate=${this.samplingRate}`);const i=o.getBitAllignedNumber(e,t+2,7,3);this.mp4ChannelConfig=d[i],u(`channel-config=${this.mp4ChannelConfig.join("+")}`),this.frameLength=o.getBitAllignedNumber(e,t+3,6,2)<<11}calcBitrate(){if(0===this.bitrateIndex||15===this.bitrateIndex)return;const e=`${Math.floor(this.version)}${this.layer}`;return f.bitrate_index[this.bitrateIndex][e]}calcSamplingRate(){return 3===this.sampRateFreqIndex?null:f.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}f.SyncByte1=255,f.SyncByte2=224,f.VersionID=[2.5,null,2,1],f.LayerDescription=[0,3,2,1],f.ChannelMode=["stereo","joint_stereo","dual_channel","mono"],f.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}},f.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}},f.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];class m extends l.AbstractID3Parser{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.calculateEofDuration=!1,this.buf_frame_header=n.alloc(4),this.syncPeek={buf:n.alloc(1024),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(!(e instanceof a.EndOfStreamError))throw e;if(u("End-of-stream"),this.calculateEofDuration){const e=this.frameCount*this.samplesPerFrame;this.metadata.setFormat("numberOfSamples",e);const t=e/this.metadata.format.sampleRate;u(`Calculate duration at EOF: ${t} sec.`,t),this.metadata.setFormat("duration",t)}}}finalize(){const e=this.metadata.format,t=this.metadata.native.hasOwnProperty("ID3v1");if(e.duration&&this.tokenizer.fileInfo.size){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0);e.codecProfile&&"V"===e.codecProfile[0]&&this.metadata.setFormat("bitrate",8*r/e.duration)}else if(this.tokenizer.fileInfo.size&&"CBR"===e.codecProfile){const r=this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0),n=Math.round(r/this.frame_size)*this.samplesPerFrame;this.metadata.setFormat("numberOfSamples",n);const i=n/e.sampleRate;u("Calculate CBR duration based on file size: %s",i),this.metadata.setFormat("duration",i)}}async sync(){let e=!1;for(;;){let t=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:1024,mayBeLess:!0}),this.syncPeek.len<=163)throw new a.EndOfStreamError;for(;;){if(e&&224==(224&this.syncPeek.buf[t]))return this.buf_frame_header[0]=f.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[t],await this.tokenizer.ignore(t),u(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(u(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),void(this.syncFrameCount=this.frameCount);if(e=!1,t=this.syncPeek.buf.indexOf(f.SyncByte1,t),-1===t){if(this.syncPeek.len<this.syncPeek.buf.length)throw new a.EndOfStreamError;await this.tokenizer.ignore(this.syncPeek.len);break}++t,e=!0}}}async parseCommonMpegHeader(){let e;0===this.frameCount&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});try{t=this.buf_frame_header,e=new f(t,0)}catch(e){return await this.tokenizer.ignore(1),this.metadata.addWarning("Parse error: "+e.message),!1}var t;return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version>=2&&0===e.layer?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels","mono"===e.channelMode?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<2e5&&u("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);const t=e.calcSlotSize();if(null===t)throw new Error("invalid slot_size");const r=e.calcSamplesPerFrame();u(`samples_per_frame=${r}`);const n=r/8*e.bitrate/e.samplingRate+(e.padding?t:0);if(this.frame_size=Math.floor(n),this.audioFrameHeader=e,this.bitrates.push(e.bitrate),1===this.frameCount)return this.offset=4,await this.skipSideInformation(),!1;if(3===this.frameCount){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return this.options.duration&&4===this.frameCount&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC?(await this.parseCrc(),!1):(await this.skipSideInformation(),!1)}async parseAdts(e){const t=n.alloc(3);await this.tokenizer.readBuffer(t),e.frameLength+=o.getBitAllignedNumber(t,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024;const r=e.samplingRate/this.samplesPerFrame,i=8*(0===this.frameCount?0:this.totalDataLength/this.frameCount)*r+.5;if(this.metadata.setFormat("bitrate",i),u(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${i}`),await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),3===this.frameCount){if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),!this.options.duration)return!0;this.calculateEofDuration=!0}return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(i.INT16_BE),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){const e=this.audioFrameHeader.calculateSideInfoLength();await this.tokenizer.readToken(new i.Uint8ArrayType(e)),this.offset+=e,await this.readXtraInfoHeader()}async readXtraInfoHeader(){const e=await this.tokenizer.readToken(c.InfoTagHeaderTag);switch(this.offset+=c.InfoTagHeaderTag.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":const e=(t=(await this.readXingInfoHeader()).vbrScale,"V"+Math.floor((100-t)/10));return this.metadata.setFormat("codecProfile",e),null;case"Xtra":break;case"LAME":const r=await this.tokenizer.readToken(c.LameEncoderVersion);if(this.frame_size>=this.offset+c.LameEncoderVersion.len)return this.offset+=c.LameEncoderVersion.len,this.metadata.setFormat("tool","LAME "+r),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header")}var t;const r=this.frame_size-this.offset;return r<0?this.metadata.addWarning("Frame "+this.frameCount+"corrupt: negative frameDataLeft"):await this.skipFrameData(r),null}async readXingInfoHeader(){const e=this.tokenizer.position,t=await(0,c.readXingHeader)(this.tokenizer);if(this.offset+=this.tokenizer.position-e,t.lame&&(this.metadata.setFormat("tool","LAME "+o.stripNulls(t.lame.version)),t.lame.extended&&(this.metadata.setFormat("trackPeakLevel",t.lame.extended.track_peak),t.lame.extended.track_gain&&this.metadata.setFormat("trackGain",t.lame.extended.track_gain.adjustment),t.lame.extended.album_gain&&this.metadata.setFormat("albumGain",t.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",t.lame.extended.music_length/1e3))),t.streamSize){const e=this.audioFrameHeader.calcDuration(t.numFrames);return this.metadata.setFormat("duration",e),u("Get duration from Xing header: %s",this.metadata.format.duration),t}const r=this.frame_size-this.offset;return await this.skipFrameData(r),t}async skipFrameData(e){if(e<0)throw new Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){const t=e[0];return e.every((e=>e===t))}}t.MpegParser=m},6118:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReplayGain=void 0;const n=r(3769);var i,a;!function(e){e[e.not_set=0]="not_set",e[e.radio=1]="radio",e[e.audiophile=2]="audiophile"}(i||(i={})),function(e){e[e.unspecified=0]="unspecified",e[e.engineer=1]="engineer",e[e.user=2]="user",e[e.automatic=3]="automatic",e[e.rms_average=4]="rms_average"}(a||(a={})),t.ReplayGain={len:2,get:(e,t)=>{const r=n.getBitAllignedNumber(e,t,0,3),i=n.getBitAllignedNumber(e,t,6,1),a=n.getBitAllignedNumber(e,t,7,9)/10;if(r>0)return{type:n.getBitAllignedNumber(e,t,0,3),origin:n.getBitAllignedNumber(e,t,3,3),adjustment:i?-a:a}}}},3566:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.readXingHeader=t.XingHeaderFlags=t.LameEncoderVersion=t.InfoTagHeaderTag=void 0;const i=r(3416),a=r(3769),s=r(5261);t.InfoTagHeaderTag=new i.StringType(4,"ascii"),t.LameEncoderVersion=new i.StringType(6,"ascii"),t.XingHeaderFlags={len:4,get:(e,t)=>({frames:a.isBitSet(e,t,31),bytes:a.isBitSet(e,t,30),toc:a.isBitSet(e,t,29),vbrScale:a.isBitSet(e,t,28)})},t.readXingHeader=async function(e){const r=await e.readToken(t.XingHeaderFlags),a={};if(r.frames&&(a.numFrames=await e.readToken(i.UINT32_BE)),r.bytes&&(a.streamSize=await e.readToken(i.UINT32_BE)),r.toc&&(a.toc=n.alloc(100),await e.readBuffer(a.toc)),r.vbrScale&&(a.vbrScale=await e.readToken(i.UINT32_BE)),"LAME"===await e.peekToken(new i.StringType(4,"ascii"))&&(await e.ignore(4),a.lame={version:await e.readToken(new i.StringType(5,"ascii"))},a.lame.version.match(/\d+.\d+/g))){const t=a.lame.version.match(/\d+.\d+/g)[0].split(".").map((e=>parseInt(e,10)));t[0]>=3&&t[1]>=90&&(a.lame.extended=await e.readToken(s.ExtendedLameHeader))}return a}},9606:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1227),i=r(3416),a=r(5159),s=r(5170),o=r(3928),l=(0,n.default)("music-metadata:parser:musepack");class c extends a.AbstractID3Parser{async postId3v2Parse(){let e;switch(await this.tokenizer.peekToken(new i.StringType(3,"binary"))){case"MP+":l("Musepack stream-version 7"),e=new o.MpcSv7Parser;break;case"MPC":l("Musepack stream-version 8"),e=new s.MpcSv8Parser;break;default:throw new Error("Invalid Musepack signature prefix")}return e.init(this.metadata,this.tokenizer,this.options),e.parse()}}t.default=c},2812:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BitReader=void 0;const n=r(3416);t.BitReader=class{constructor(e){this.tokenizer=e,this.pos=0,this.dword=void 0}async read(e){for(;void 0===this.dword;)this.dword=await this.tokenizer.readToken(n.UINT32_LE);let t=this.dword;return this.pos+=e,this.pos<32?(t>>>=32-this.pos,t&(1<<e)-1):(this.pos-=32,0===this.pos?(this.dword=void 0,t&(1<<e)-1):(this.dword=await this.tokenizer.readToken(n.UINT32_LE),this.pos&&(t<<=this.pos,t|=this.dword>>>32-this.pos),t&(1<<e)-1))}async ignore(e){if(this.pos>0){const t=32-this.pos;this.dword=void 0,e-=t,this.pos=0}const t=e%32,r=(e-t)/32;return await this.tokenizer.ignore(4*r),this.read(t)}}},3928:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MpcSv7Parser=void 0;const n=r(1227),i=r(7805),a=r(6742),s=r(2812),o=r(8153),l=(0,n.default)("music-metadata:parser:musepack");class c extends i.BasicParser{constructor(){super(...arguments),this.audioLength=0}async parse(){const e=await this.tokenizer.readToken(o.Header);if("MP+"!==e.signature)throw new Error("Unexpected magic number");l(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);const t=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",t),this.duration=t/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new s.BitReader(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);const r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),l(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){const e=await this.bitreader.read(20);this.audioLength+=20+e,await this.bitreader.ignore(e)}const t=await this.bitreader.read(11);this.audioLength+=t,this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}t.MpcSv7Parser=c},8153:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const i=r(3416),a=r(3769);t.Header={len:24,get:(e,t)=>{const r={signature:n.from(e).toString("latin1",t,t+3),streamMinorVersion:a.getBitAllignedNumber(e,t+3,0,4),streamMajorVersion:a.getBitAllignedNumber(e,t+3,4,4),frameCount:i.UINT32_LE.get(e,t+4),maxLevel:i.UINT16_LE.get(e,t+8),sampleFrequency:[44100,48e3,37800,32e3][a.getBitAllignedNumber(e,t+10,0,2)],link:a.getBitAllignedNumber(e,t+10,2,2),profile:a.getBitAllignedNumber(e,t+10,4,4),maxBand:a.getBitAllignedNumber(e,t+11,0,6),intensityStereo:a.isBitSet(e,t+11,6),midSideStereo:a.isBitSet(e,t+11,7),titlePeak:i.UINT16_LE.get(e,t+12),titleGain:i.UINT16_LE.get(e,t+14),albumPeak:i.UINT16_LE.get(e,t+16),albumGain:i.UINT16_LE.get(e,t+18),lastFrameLength:i.UINT32_LE.get(e,t+20)>>>20&2047,trueGapless:a.isBitSet(e,t+23,0)};return r.lastFrameLength=r.trueGapless?i.UINT32_LE.get(e,20)>>>20&2047:0,r}}},5170:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MpcSv8Parser=void 0;const n=r(1227),i=r(7805),a=r(6742),s=r(8049),o=r(8850),l=(0,n.default)("music-metadata:parser:musepack");class c extends i.BasicParser{constructor(){super(...arguments),this.audioLength=0}async parse(){if("MPCK"!==await this.tokenizer.readToken(s.FourCcToken))throw new Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){const e=new o.StreamReader(this.tokenizer);for(;;){const t=await e.readPacketHeader();switch(l(`packet-header key=${t.key}, payloadLength=${t.payloadLength}`),t.key){case"SH":const r=await e.readStreamHeader(t.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break;case"AP":this.audioLength+=t.payloadLength,await this.tokenizer.ignore(t.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(t.payloadLength);break;case"SE":return this.metadata.setFormat("bitrate",8*this.audioLength/this.metadata.format.duration),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw new Error(`Unexpected header: ${t.key}`)}}}}t.MpcSv8Parser=c},8850:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=void 0;const n=r(3416),i=r(1227),a=r(3769),s=(0,i.default)("music-metadata:parser:musepack:sv8"),o=new n.StringType(2,"binary"),l={len:5,get:(e,t)=>({crc:n.UINT32_LE.get(e,t),streamVersion:n.UINT8.get(e,t+4)})},c={len:2,get:(e,t)=>({sampleFrequency:[44100,48e3,37800,32e3][a.getBitAllignedNumber(e,t,0,3)],maxUsedBands:a.getBitAllignedNumber(e,t,3,5),channelCount:a.getBitAllignedNumber(e,t+1,0,4)+1,msUsed:a.isBitSet(e,t+1,4),audioBlockFrames:a.getBitAllignedNumber(e,t+1,5,3)})};t.StreamReader=class{constructor(e){this.tokenizer=e}async readPacketHeader(){const e=await this.tokenizer.readToken(o),t=await this.readVariableSizeField();return{key:e,payloadLength:t.value-2-t.len}}async readStreamHeader(e){const t={};s(`Reading SH at offset=${this.tokenizer.position}`);const r=await this.tokenizer.readToken(l);e-=l.len,Object.assign(t,r),s(`SH.streamVersion = ${r.streamVersion}`);const n=await this.readVariableSizeField();e-=n.len,t.sampleCount=n.value;const i=await this.readVariableSizeField();e-=i.len,t.beginningOfSilence=i.value;const a=await this.tokenizer.readToken(c);return e-=c.len,Object.assign(t,a),await this.tokenizer.ignore(e),t}async readVariableSizeField(e=1,t=0){let r=await this.tokenizer.readNumber(n.UINT8);return 0==(128&r)?{len:e,value:t+r}:(r&=127,r+=t,this.readVariableSizeField(e+1,r<<7))}}},1915:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.OggParser=t.SegmentTable=void 0;const i=r(3416),a=r(5849),s=r(1227),o=r(3769),l=r(8049),c=r(7805),u=r(4210),h=r(1272),d=r(573),f=r(2630),m=(0,s.default)("music-metadata:parser:ogg");class p{constructor(e){this.len=e.page_segments}static sum(e,t,r){let n=0;for(let i=t;i<t+r;++i)n+=e[i];return n}get(e,t){return{totalPageSize:p.sum(e,t,this.len)}}}t.SegmentTable=p;class g extends c.BasicParser{async parse(){m("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(g.Header),"OggS"!==e.capturePattern)throw new Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,m("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);const t=await this.tokenizer.readToken(new p(e));m("totalPageSize=%s",t.totalPageSize);const r=await this.tokenizer.readToken(new i.Uint8ArrayType(t.totalPageSize));if(m("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){const e=new i.StringType(7,"ascii").get(n.from(r),0);switch(e){case"vorbis":m("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new u.VorbisParser(this.metadata,this.options);break;case"OpusHea":m("Set page consumer to Ogg/Opus"),this.pageConsumer=new h.OpusParser(this.metadata,this.options,this.tokenizer);break;case"Speex  ":m("Set page consumer to Ogg/Speex"),this.pageConsumer=new d.SpeexParser(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":m("Set page consumer to Ogg/Theora"),this.pageConsumer=new f.TheoraParser(this.metadata,this.options,this.tokenizer);break;default:throw new Error("gg audio-codec not recognized (id="+e+")")}}this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof a.EndOfStreamError)this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),m("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header);else{if(!e.message.startsWith("FourCC"))throw e;this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),this.pageConsumer.flush())}}}}t.OggParser=g,g.Header={len:27,get:(e,t)=>({capturePattern:l.FourCcToken.get(e,t),version:i.UINT8.get(e,t+4),headerType:{continued:o.getBit(e,t+5,0),firstPage:o.getBit(e,t+5,1),lastPage:o.getBit(e,t+5,2)},absoluteGranulePosition:Number(i.UINT64_LE.get(e,t+6)),streamSerialNumber:i.UINT32_LE.get(e,t+14),pageSequenceNo:i.UINT32_LE.get(e,t+18),pageChecksum:i.UINT32_LE.get(e,t+22),page_segments:i.UINT8.get(e,t+26)})}},5044:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdHeader=void 0;const n=r(3416);t.IdHeader=class{constructor(e){if(this.len=e,e<19)throw new Error("ID-header-page 0 should be at least 19 bytes long")}get(e,t){return{magicSignature:new n.StringType(8,"ascii").get(e,t+0),version:e.readUInt8(t+8),channelCount:e.readUInt8(t+9),preSkip:e.readInt16LE(t+10),inputSampleRate:e.readInt32LE(t+12),outputGain:e.readInt16LE(t+16),channelMapping:e.readUInt8(t+18)}}}},1272:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpusParser=void 0;const n=r(3416),i=r(4210),a=r(5044);class s extends i.VorbisParser{constructor(e,t,r){super(e,t),this.tokenizer=r,this.lastPos=-1}parseFirstPage(e,t){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new a.IdHeader(t.length).get(t,0),"OpusHead"!==this.idHeader.magicSignature)throw new Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}parseFullPage(e){"OpusTags"===new n.StringType(8,"ascii").get(e,0)&&(this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length)}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){const t=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",t),this.metadata.setFormat("duration",t/48e3),-1!==this.lastPos&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){const e=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}}}t.OpusParser=s},6666:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const n=r(3416),i=r(3769);t.Header={len:80,get:(e,t)=>({speex:new n.StringType(8,"ascii").get(e,t+0),version:i.trimRightNull(new n.StringType(20,"ascii").get(e,t+8)),version_id:e.readInt32LE(t+28),header_size:e.readInt32LE(t+32),rate:e.readInt32LE(t+36),mode:e.readInt32LE(t+40),mode_bitstream_version:e.readInt32LE(t+44),nb_channels:e.readInt32LE(t+48),bitrate:e.readInt32LE(t+52),frame_size:e.readInt32LE(t+56),vbr:e.readInt32LE(t+60),frames_per_packet:e.readInt32LE(t+64),extra_headers:e.readInt32LE(t+68),reserved1:e.readInt32LE(t+72),reserved2:e.readInt32LE(t+76)})}},573:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpeexParser=void 0;const n=r(1227),i=r(4210),a=r(6666),s=(0,n.default)("music-metadata:parser:ogg:speex");class o extends i.VorbisParser{constructor(e,t,r){super(e,t),this.tokenizer=r}parseFirstPage(e,t){s("First Ogg/Speex page");const r=a.Header.get(t,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),-1!==r.bitrate&&this.metadata.setFormat("bitrate",r.bitrate)}}t.SpeexParser=o},5177:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentificationHeader=void 0;const n=r(3416);t.IdentificationHeader={len:42,get:(e,t)=>({id:new n.StringType(7,"ascii").get(e,t),vmaj:e.readUInt8(t+7),vmin:e.readUInt8(t+8),vrev:e.readUInt8(t+9),vmbw:e.readUInt16BE(t+10),vmbh:e.readUInt16BE(t+17),nombr:n.UINT24_BE.get(e,t+37),nqual:e.readUInt8(t+40)})}},2630:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TheoraParser=void 0;const n=r(1227),i=r(5177),a=(0,n.default)("music-metadata:parser:ogg:theora");t.TheoraParser=class{constructor(e,t,r){this.metadata=e,this.tokenizer=r}parsePage(e,t){e.headerType.firstPage&&this.parseFirstPage(e,t)}flush(){a("flush")}calculateDuration(e){a("duration calculation not implemented")}parseFirstPage(e,t){a("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");const r=i.IdentificationHeader.get(t,0);this.metadata.setFormat("bitrate",r.nombr)}}},2127:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.IdentificationHeader=t.CommonHeader=t.VorbisPictureToken=void 0;const i=r(3416),a=r(8281);class s{constructor(e){this.len=e}static fromBase64(e){return this.fromBuffer(n.from(e,"base64"))}static fromBuffer(e){return new s(e.length).get(e,0)}get(e,t){const r=a.AttachedPictureType[i.UINT32_BE.get(e,t)],s=i.UINT32_BE.get(e,t+=4),o=e.toString("utf-8",t+=4,t+s),l=i.UINT32_BE.get(e,t+=s),c=e.toString("utf-8",t+=4,t+l),u=i.UINT32_BE.get(e,t+=l),h=i.UINT32_BE.get(e,t+=4),d=i.UINT32_BE.get(e,t+=4),f=i.UINT32_BE.get(e,t+=4),m=i.UINT32_BE.get(e,t+=4);return{type:r,format:o,description:c,width:u,height:h,colour_depth:d,indexed_color:f,data:n.from(e.slice(t+=4,t+m))}}}t.VorbisPictureToken=s,t.CommonHeader={len:7,get:(e,t)=>({packetType:e.readUInt8(t),vorbis:new i.StringType(6,"ascii").get(e,t+1)})},t.IdentificationHeader={len:23,get:(e,t)=>{const r=new DataView(e.buffer,e.byteOffset);return{version:r.getUint32(t+0,!0),channelMode:r.getUint8(t+4),sampleRate:r.getUint32(t+5,!0),bitrateMax:r.getUint32(t+9,!0),bitrateNominal:r.getUint32(t+13,!0),bitrateMin:r.getUint32(t+17,!0)}}}},441:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisDecoder=void 0;const i=r(3416);t.VorbisDecoder=class{constructor(e,t){this.data=e,this.offset=t}readInt32(){const e=i.UINT32_LE.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){const e=this.readInt32(),t=n.from(this.data).toString("utf-8",this.offset,this.offset+e);return this.offset+=e,t}parseUserComment(){const e=this.offset,t=this.readStringUtf8(),r=t.indexOf("=");return{key:t.slice(0,r).toUpperCase(),value:t.slice(r+1),len:this.offset-e}}}},4210:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisParser=void 0;const i=r(3416),a=r(1227),s=r(441),o=r(2127),l=(0,a.default)("music-metadata:parser:ogg:vorbis1");t.VorbisParser=class{constructor(e,t){this.metadata=e,this.options=t,this.pageSegments=[]}parsePage(e,t){if(e.headerType.firstPage)this.parseFirstPage(e,t);else{if(e.headerType.continued){if(0===this.pageSegments.length)throw new Error("Cannot continue on previous page");this.pageSegments.push(t)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){const e=n.concat(this.pageSegments);this.parseFullPage(e)}this.pageSegments=e.headerType.lastPage?[]:[t]}}e.headerType.lastPage&&this.calculateDuration(e)}flush(){this.parseFullPage(n.concat(this.pageSegments))}parseUserComment(e,t){const r=new s.VorbisDecoder(e,t).parseUserComment();return this.addTag(r.key,r.value),r.len}addTag(e,t){if("METADATA_BLOCK_PICTURE"===e&&"string"==typeof t){if(this.options.skipCovers)return void l("Ignore picture");t=o.VorbisPictureToken.fromBase64(t),l(`Push picture: id=${e}, format=${t.format}`)}else l(`Push tag: id=${e}, value=${t}`);this.metadata.addTag("vorbis",e,t)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate))}parseFirstPage(e,t){this.metadata.setFormat("codec","Vorbis I"),l("Parse first page");const r=o.CommonHeader.get(t,0);if("vorbis"!==r.vorbis)throw new Error("Metadata does not look like Vorbis");if(1!==r.packetType)throw new Error("First Ogg page should be type 1: the identification header");{const e=o.IdentificationHeader.get(t,o.CommonHeader.len);this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("bitrate",e.bitrateNominal),this.metadata.setFormat("numberOfChannels",e.channelMode),l("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",e.sampleRate,e.bitrateNominal,e.channelMode)}}parseFullPage(e){const t=o.CommonHeader.get(e,0);if(l("Parse full page: type=%s, byteLength=%s",t.packetType,e.byteLength),3===t.packetType)return this.parseUserCommentList(e,o.CommonHeader.len)}parseUserCommentList(e,t){const r=i.UINT32_LE.get(e,t);t+=4,t+=r;let n=i.UINT32_LE.get(e,t);for(t+=4;n-- >0;)t+=this.parseUserComment(e,t)}}},9860:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisTagMapper=void 0;const n=r(9918),i={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class a extends n.CommonTagMapper{static toRating(e,t){return{source:e?e.toLowerCase():e,rating:parseFloat(t)*n.CommonTagMapper.maxRatingScore}}constructor(){super(["vorbis"],i)}postMap(e){if(0===e.id.indexOf("RATING:")){const t=e.id.split(":");e.value=a.toRating(t[1],e.value),e.id=t[0]}}}t.VorbisTagMapper=a},3211:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListInfoTagValue=t.Header=void 0;const n=r(3416);t.Header={len:8,get:(e,t)=>({chunkID:e.toString("binary",t,t+4),chunkSize:n.UINT32_LE.get(e,4)})},t.ListInfoTagValue=class{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=1&this.len}get(e,t){return new n.StringType(this.tagHeader.chunkSize,"ascii").get(e,t)}}},5756:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RiffInfoTagMapper=t.riffInfoTagMap=void 0;const n=r(9918);t.riffInfoTagMap={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class i extends n.CommonTagMapper{constructor(){super(["exif"],t.riffInfoTagMap)}}t.RiffInfoTagMapper=i},6032:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackType=void 0;var n=r(8591);Object.defineProperty(t,"TrackType",{enumerable:!0,get:function(){return n.TrackType}})},8053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BroadcastAudioExtensionChunk=void 0;const n=r(3416),i=r(3769);t.BroadcastAudioExtensionChunk={len:420,get:(e,t)=>({description:(0,i.stripNulls)(new n.StringType(256,"ascii").get(e,t)).trim(),originator:(0,i.stripNulls)(new n.StringType(32,"ascii").get(e,t+256)).trim(),originatorReference:(0,i.stripNulls)(new n.StringType(32,"ascii").get(e,t+288)).trim(),originationDate:(0,i.stripNulls)(new n.StringType(10,"ascii").get(e,t+320)).trim(),originationTime:(0,i.stripNulls)(new n.StringType(8,"ascii").get(e,t+330)).trim(),timeReferenceLow:n.UINT32_LE.get(e,t+338),timeReferenceHigh:n.UINT32_LE.get(e,t+342),version:n.UINT16_LE.get(e,t+346),umid:new n.Uint8ArrayType(64).get(e,t+348),loudnessValue:n.UINT16_LE.get(e,t+412),maxTruePeakLevel:n.UINT16_LE.get(e,t+414),maxMomentaryLoudness:n.UINT16_LE.get(e,t+416),maxShortTermLoudness:n.UINT16_LE.get(e,t+418)})}},9975:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.FactChunk=t.Format=t.WaveFormat=void 0,(r=t.WaveFormat||(t.WaveFormat={}))[r.PCM=1]="PCM",r[r.ADPCM=2]="ADPCM",r[r.IEEE_FLOAT=3]="IEEE_FLOAT",r[r.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",r[r.MPEG_LOAS=5634]="MPEG_LOAS",r[r.RAW_AAC1=255]="RAW_AAC1",r[r.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",r[r.DVM=8192]="DVM",r[r.RAW_SPORT=576]="RAW_SPORT",r[r.ESST_AC3=577]="ESST_AC3",r[r.DRM=9]="DRM",r[r.DTS2=8193]="DTS2",r[r.MPEG=80]="MPEG",t.Format=class{constructor(e){if(e.chunkSize<16)throw new Error("Invalid chunk size");this.len=e.chunkSize}get(e,t){return{wFormatTag:e.readUInt16LE(t),nChannels:e.readUInt16LE(t+2),nSamplesPerSec:e.readUInt32LE(t+4),nAvgBytesPerSec:e.readUInt32LE(t+8),nBlockAlign:e.readUInt16LE(t+12),wBitsPerSample:e.readUInt16LE(t+14)}}},t.FactChunk=class{constructor(e){if(e.chunkSize<4)throw new Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,t){return{dwSampleLength:e.readUInt32LE(t)}}}},2682:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WaveParser=void 0;const n=r(5849),i=r(3416),a=r(1227),s=r(3211),o=r(9975),l=r(8928),c=r(3769),u=r(8049),h=r(7805),d=r(8053),f=(0,a.default)("music-metadata:parser:RIFF");class m extends h.BasicParser{async parse(){const e=await this.tokenizer.readToken(s.Header);if(f(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),"RIFF"===e.chunkID)return this.parseRiffChunk(e.chunkSize).catch((e=>{if(!(e instanceof n.EndOfStreamError))throw e}))}async parseRiffChunk(e){const t=await this.tokenizer.readToken(u.FourCcToken);if(this.metadata.setFormat("container",t),"WAVE"===t)return this.readWaveChunk(e-u.FourCcToken.len);throw new Error(`Unsupported RIFF format: RIFF/${t}`)}async readWaveChunk(e){for(;e>=s.Header.len;){const t=await this.tokenizer.readToken(s.Header);switch(e-=s.Header.len+t.chunkSize,t.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=t,f(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${t.chunkID}`),t.chunkID){case"LIST":await this.parseListTag(t);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new o.FactChunk(t));break;case"fmt ":const e=await this.tokenizer.readToken(new o.Format(t));let r=o.WaveFormat[e.wFormatTag];r||(f("WAVE/non-PCM format="+e.wFormatTag),r="non-PCM ("+e.wFormatTag+")"),this.metadata.setFormat("codec",r),this.metadata.setFormat("bitsPerSample",e.wBitsPerSample),this.metadata.setFormat("sampleRate",e.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",e.nChannels),this.metadata.setFormat("bitrate",e.nBlockAlign*e.nSamplesPerSec*8),this.blockAlign=e.nBlockAlign;break;case"id3 ":case"ID3 ":const a=await this.tokenizer.readToken(new i.Uint8ArrayType(t.chunkSize)),s=n.fromBuffer(a);await(new l.ID3v2Parser).parse(this.metadata,s,this.options);break;case"data":!1!==this.metadata.format.lossless&&this.metadata.setFormat("lossless",!0);let c=t.chunkSize;if(this.tokenizer.fileInfo.size){const e=this.tokenizer.fileInfo.size-this.tokenizer.position;e<c&&(this.metadata.addWarning("data chunk length exceeding file length"),c=e)}const u=this.fact?this.fact.dwSampleLength:4294967295===c?void 0:c/this.blockAlign;u&&(this.metadata.setFormat("numberOfSamples",u),this.metadata.setFormat("duration",u/this.metadata.format.sampleRate)),this.metadata.setFormat("bitrate",this.metadata.format.numberOfChannels*this.blockAlign*this.metadata.format.sampleRate),await this.tokenizer.ignore(t.chunkSize);break;case"bext":const h=await this.tokenizer.readToken(d.BroadcastAudioExtensionChunk);Object.keys(h).forEach((e=>{this.metadata.addTag("exif","bext."+e,h[e])}));const m=t.chunkSize-d.BroadcastAudioExtensionChunk.len;await this.tokenizer.ignore(m);break;case"\0\0\0\0":f(`Ignore padding chunk: RIFF/${t.chunkID} of ${t.chunkSize} bytes`),this.metadata.addWarning("Ignore chunk: RIFF/"+t.chunkID),await this.tokenizer.ignore(t.chunkSize);break;default:f(`Ignore chunk: RIFF/${t.chunkID} of ${t.chunkSize} bytes`),this.metadata.addWarning("Ignore chunk: RIFF/"+t.chunkID),await this.tokenizer.ignore(t.chunkSize)}this.header.chunkSize%2==1&&(f("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){const t=await this.tokenizer.readToken(new i.StringType(4,"binary"));return f("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,t),"INFO"===t?this.parseRiffInfoTags(e.chunkSize-4):(this.metadata.addWarning("Ignore chunk: RIFF/WAVE/LIST/"+t),f("Ignoring chunkID=RIFF/WAVE/LIST/"+t),this.tokenizer.ignore(e.chunkSize-4).then())}async parseRiffInfoTags(e){for(;e>=8;){const t=await this.tokenizer.readToken(s.Header),r=new s.ListInfoTagValue(t),n=await this.tokenizer.readToken(r);this.addTag(t.chunkID,c.stripNulls(n)),e-=8+r.len}if(0!==e)throw Error("Illegal remaining size: "+e)}addTag(e,t){this.metadata.addTag("exif",e,t)}}t.WaveParser=m},5870:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.WavPackParser=void 0;const i=r(3416),a=r(6742),s=r(8049),o=r(7805),l=r(2989),c=(0,r(1227).default)("music-metadata:parser:WavPack");class u extends o.BasicParser{async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if("wvpk"!==await this.tokenizer.peekToken(s.FourCcToken))break;const e=await this.tokenizer.readToken(l.WavPack.BlockHeaderToken);if("wvpk"!==e.BlockID)throw new Error("Invalid WavPack Block-ID");c(`WavPack header blockIndex=${e.blockIndex}, len=${l.WavPack.BlockHeaderToken.len}`),0!==e.blockIndex||this.metadata.format.container||(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!e.flags.isHybrid),this.metadata.setFormat("bitsPerSample",e.flags.bitsPerSample),e.flags.isDSD||(this.metadata.setFormat("sampleRate",e.flags.samplingRate),this.metadata.setFormat("duration",e.totalSamples/e.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",e.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",e.totalSamples),this.metadata.setFormat("codec",e.flags.isDSD?"DSD":"PCM"));const t=e.blockSize-(l.WavPack.BlockHeaderToken.len-8);await(0===e.blockIndex?this.parseMetadataSubBlock(e,t):this.tokenizer.ignore(t)),e.blockSamples>0&&(this.audioDataSize+=e.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=l.WavPack.BlockHeaderToken.len);this.metadata.setFormat("bitrate",8*this.audioDataSize/this.metadata.format.duration)}async parseMetadataSubBlock(e,t){for(;t>l.WavPack.MetadataIdToken.len;){const r=await this.tokenizer.readToken(l.WavPack.MetadataIdToken),a=await this.tokenizer.readNumber(r.largeBlock?i.UINT24_LE:i.UINT8),s=n.alloc(2*a-(r.isOddSize?1:0));switch(await this.tokenizer.readBuffer(s),c(`Metadata Sub-Blocks functionId=0x${r.functionId.toString(16)}, id.largeBlock=${r.largeBlock},data-size=${s.length}`),r.functionId){case 0:break;case 14:c("ID_DSD_BLOCK");const t=1<<s.readUInt8(0),n=e.flags.samplingRate*t*8;if(!e.flags.isDSD)throw new Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",n),this.metadata.setFormat("duration",e.totalSamples/n);break;case 36:c("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",s);break;case 47:c(`ID_BLOCK_CHECKSUM: checksum=${s.toString("hex")}`);break;default:c(`Ignore unsupported meta-sub-block-id functionId=0x${r.functionId.toString(16)}`)}t-=l.WavPack.MetadataIdToken.len+(r.largeBlock?i.UINT24_LE.len:i.UINT8.len)+2*a,c(`remainingLength=${t}`),r.isOddSize&&this.tokenizer.ignore(1)}if(0!==t)throw new Error("metadata-sub-block should fit it remaining length")}}t.WavPackParser=u},2989:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WavPack=void 0;const n=r(3416),i=r(8049),a=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1];class s{static isBitSet(e,t){return 1===s.getBitAllignedNumber(e,t,1)}static getBitAllignedNumber(e,t,r){return e>>>t&4294967295>>>32-r}}t.WavPack=s,s.BlockHeaderToken={len:32,get:(e,t)=>{const r=n.UINT32_LE.get(e,t+24),o={BlockID:i.FourCcToken.get(e,t),blockSize:n.UINT32_LE.get(e,t+4),version:n.UINT16_LE.get(e,t+8),totalSamples:n.UINT32_LE.get(e,t+12),blockIndex:n.UINT32_LE.get(e,t+16),blockSamples:n.UINT32_LE.get(e,t+20),flags:{bitsPerSample:8*(1+s.getBitAllignedNumber(r,0,2)),isMono:s.isBitSet(r,2),isHybrid:s.isBitSet(r,3),isJointStereo:s.isBitSet(r,4),crossChannel:s.isBitSet(r,5),hybridNoiseShaping:s.isBitSet(r,6),floatingPoint:s.isBitSet(r,7),samplingRate:a[s.getBitAllignedNumber(r,23,4)],isDSD:s.isBitSet(r,31)},crc:new n.Uint8ArrayType(4).get(e,t+28)};return o.flags.isDSD&&(o.totalSamples*=8),o}},s.MetadataIdToken={len:1,get:(e,t)=>({functionId:s.getBitAllignedNumber(e[t],0,6),isOptional:s.isBitSet(e[t],5),isOddSize:s.isBitSet(e[t],6),largeBlock:s.isBitSet(e[t],7)})}},8985:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0,t.Deferred=class{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}}},7279:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndOfStreamError=t.defaultMessages=void 0,t.defaultMessages="End-Of-Stream";class r extends Error{constructor(){super(t.defaultMessages)}}t.EndOfStreamError=r},6654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=t.EndOfStreamError=void 0;const n=r(7279),i=r(8985);var a=r(7279);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return a.EndOfStreamError}}),t.StreamReader=class{constructor(e){if(this.s=e,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!e.read||!e.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",(()=>this.reject(new n.EndOfStreamError))),this.s.once("error",(e=>this.reject(e))),this.s.once("close",(()=>this.reject(new Error("Stream closed"))))}async peek(e,t,r){const n=await this.read(e,t,r);return this.peekQueue.push(e.subarray(t,t+n)),n}async read(e,t,r){if(0===r)return 0;if(0===this.peekQueue.length&&this.endOfStream)throw new n.EndOfStreamError;let i=r,a=0;for(;this.peekQueue.length>0&&i>0;){const r=this.peekQueue.pop();if(!r)throw new Error("peekData should be defined");const n=Math.min(r.length,i);e.set(r.subarray(0,n),t+a),a+=n,i-=n,n<r.length&&this.peekQueue.push(r.subarray(n))}for(;i>0&&!this.endOfStream;){const r=Math.min(i,1048576),n=await this.readFromStream(e,t+a,r);if(a+=n,n<r)break;i-=n}return a}async readFromStream(e,t,r){const n=this.s.read(r);if(n)return e.set(n,t),n.length;{const n={buffer:e,offset:t,length:r,deferred:new i.Deferred};return this.deferred=n.deferred,this.s.once("readable",(()=>{this.readDeferred(n)})),n.deferred.promise}}readDeferred(e){const t=this.s.read(e.length);t?(e.buffer.set(t,e.offset),e.deferred.resolve(t.length),this.deferred=null):this.s.once("readable",(()=>{this.readDeferred(e)}))}reject(e){this.endOfStream=!0,this.deferred&&(this.deferred.reject(e),this.deferred=null)}}},5167:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=t.EndOfStreamError=void 0;var n=r(7279);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return n.EndOfStreamError}});var i=r(6654);Object.defineProperty(t,"StreamReader",{enumerable:!0,get:function(){return i.StreamReader}})},4155:e=>{var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var o,l=[],c=!1,u=-1;function h(){c&&o&&(c=!1,o.length?l=o.concat(l):u=-1,l.length&&d())}function d(){if(!c){var e=s(h);c=!0;for(var t=l.length;t;){for(o=l,l=[];++u<t;)o&&o[u].run();u=-1,t=l.length}o=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new f(e,t)),1!==l.length||c||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},4448:(e,t,r)=>{"use strict";var n=r(7294),i=r(3840);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function p(e,t,r,n,i,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var A=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function v(e,t,r,n){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null==t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?function(e){return!!h.call(m,e)||!h.call(f,e)&&(d.test(e)?m[e]=!0:(f[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(A,b);g[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(A,b);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(A,b);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var y=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),E=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),k=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var B=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function D(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=L&&e[L]||e["@@iterator"])?e:null}var N,F=Object.assign;function O(e){if(void 0===N)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var z=!1;function U(e,t){if(!e||z)return"";z=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var n=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){n=e}e.call(t.prototype)}else{try{throw Error()}catch(e){n=e}e()}}catch(t){if(t&&n&&"string"==typeof t.stack){for(var i=t.stack.split("\n"),a=n.stack.split("\n"),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==a[o]){var l="\n"+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?O(e):""}function j(e){switch(e.tag){case 5:return O(e.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return U(e.type,!1);case 11:return U(e.type.render,!1);case 1:return U(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case _:return"Fragment";case E:return"Portal";case x:return"Profiler";case T:return"StrictMode";case C:return"Suspense";case P:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case M:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return V(e(t))}catch(e){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function Q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function X(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=X(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function H(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=X(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function G(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var r=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Y(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=Q(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function K(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function J(e,t){K(e,t);var r=Q(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,Q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&G(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Q(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(a(92));if(te(r)){if(1<r.length)throw Error(a(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:Q(r)}}function ae(e,t){var r=Q(t.value),n=Q(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function pe(e,t,r){return null==t||"boolean"==typeof t||""===t?"":r||"number"!=typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=pe(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(fe).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var Ae=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(Ae[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,_e=null,Te=null;function xe(e){if(e=vi(e)){if("function"!=typeof Ee)throw Error(a(280));var t=e.stateNode;t&&(t=wi(t),Ee(e.stateNode,e.type,t))}}function Se(e){_e?Te?Te.push(e):Te=[e]:_e=e}function ke(){if(_e){var e=_e,t=Te;if(Te=_e=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function Ie(e,t){return e(t)}function Ce(){}var Pe=!1;function Me(e,t,r){if(Pe)return e(t,r);Pe=!0;try{return Ie(e,t,r)}finally{Pe=!1,(null!==_e||null!==Te)&&(Ce(),ke())}}function Re(e,t){var r=e.stateNode;if(null===r)return null;var n=wi(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!=typeof r)throw Error(a(231,t,typeof r));return r}var Be=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Be=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ue){Be=!1}function De(e,t,r,n,i,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(e){this.onError(e)}}var Ne=!1,Fe=null,Oe=!1,ze=null,Ue={onError:function(e){Ne=!0,Fe=e}};function je(e,t,r,n,i,a,s,o,l){Ne=!1,Fe=null,De.apply(Ue,arguments)}function Ve(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Qe(e){if(Ve(e)!==e)throw Error(a(188))}function Xe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(a(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(n=i.return)){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Qe(i),e;if(s===n)return Qe(i),t;s=s.sibling}throw Error(a(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(a(189))}}if(r.alternate!==n)throw Error(a(190))}if(3!==r.tag)throw Error(a(188));return r.stateNode.current===r?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var He=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,$e=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Ke=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,rt=i.unstable_LowPriority,nt=i.unstable_IdlePriority,it=null,at=null,st=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2,ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=268435455&r;if(0!==s){var o=s&~i;0!==o?n=ht(o):0!=(a&=s)&&(n=ht(a))}else 0!=(s=r&~i)?n=ht(s):0!==a&&(n=ht(a));if(0===n)return 0;if(0!==t&&t!==n&&0==(t&i)&&((i=n&-n)>=(a=t&-t)||16===i&&0!=(4194240&a)))return t;if(0!=(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-st(t)),n|=e[r],t&=~i;return n}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function mt(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0==(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function At(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=r}function bt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-st(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var vt=0;function yt(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var wt,Et,_t,Tt,xt,St=!1,kt=[],It=null,Ct=null,Pt=null,Mt=new Map,Rt=new Map,Bt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Mt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Nt(e,t,r,n,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},null!==t&&null!==(t=vi(t))&&Et(t),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=bi(e.target);if(null!==t){var r=Ve(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=qe(r)))return e.blockedOn=t,void xt(e.priority,(function(){_t(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ot(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=vi(r))&&Et(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);ye=n,r.target.dispatchEvent(n),ye=null,t.shift()}return!0}function zt(e,t,r){Ot(e)&&r.delete(t)}function Ut(){St=!1,null!==It&&Ot(It)&&(It=null),null!==Ct&&Ot(Ct)&&(Ct=null),null!==Pt&&Ot(Pt)&&(Pt=null),Mt.forEach(zt),Rt.forEach(zt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function Vt(e){function t(t){return jt(t,e)}if(0<kt.length){jt(kt[0],e);for(var r=1;r<kt.length;r++){var n=kt[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==It&&jt(It,e),null!==Ct&&jt(Ct,e),null!==Pt&&jt(Pt,e),Mt.forEach(t),Rt.forEach(t),r=0;r<Bt.length;r++)(n=Bt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Bt.length&&null===(r=Bt[0]).blockedOn;)Ft(r),null===r.blockedOn&&Bt.shift()}var qt=y.ReactCurrentBatchConfig,Qt=!0;function Xt(e,t,r,n){var i=vt,a=qt.transition;qt.transition=null;try{vt=1,Ht(e,t,r,n)}finally{vt=i,qt.transition=a}}function Wt(e,t,r,n){var i=vt,a=qt.transition;qt.transition=null;try{vt=4,Ht(e,t,r,n)}finally{vt=i,qt.transition=a}}function Ht(e,t,r,n){if(Qt){var i=$t(e,t,r,n);if(null===i)Qn(e,t,n,Gt,r),Dt(e,n);else if(function(e,t,r,n,i){switch(t){case"focusin":return It=Nt(It,e,t,r,n,i),!0;case"dragenter":return Ct=Nt(Ct,e,t,r,n,i),!0;case"mouseover":return Pt=Nt(Pt,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return Mt.set(a,Nt(Mt.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,Rt.set(a,Nt(Rt.get(a)||null,e,t,r,n,i)),!0}return!1}(i,e,t,r,n))n.stopPropagation();else if(Dt(e,n),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var a=vi(i);if(null!==a&&wt(a),null===(a=$t(e,t,r,n))&&Qn(e,t,n,Gt,r),a===i)break;i=a}null!==i&&n.stopPropagation()}else Qn(e,t,n,null,r)}}var Gt=null;function $t(e,t,r,n){if(Gt=null,null!==(e=bi(e=we(n))))if(null===(t=Ve(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Kt=null,Jt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Jt,n=r.length,i="value"in Kt?Kt.value:Kt.textContent,a=i.length;for(e=0;e<n&&r[e]===i[e];e++);var s=n-e;for(t=1;t<=s&&r[n-t]===i[a-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ir(e){function t(t,r,n,i,a){for(var s in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ar,sr,or,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=ir(lr),ur=F({},lr,{view:0,detail:0}),hr=ir(ur),dr=F({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==or&&(or&&"mousemove"===e.type?(ar=e.screenX-or.screenX,sr=e.screenY-or.screenY):sr=ar=0,or=e),ar)},movementY:function(e){return"movementY"in e?e.movementY:sr}}),fr=ir(dr),mr=ir(F({},dr,{dataTransfer:0})),pr=ir(F({},ur,{relatedTarget:0})),gr=ir(F({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),Ar=F({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),br=ir(Ar),vr=ir(F({},lr,{data:0})),yr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Er={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _r(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Er[e])&&!!t[e]}function Tr(){return _r}var xr=F({},ur,{key:function(e){if(e.key){var t=yr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sr=ir(xr),kr=ir(F({},dr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ir=ir(F({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tr})),Cr=ir(F({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pr=F({},dr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mr=ir(Pr),Rr=[9,13,27,32],Br=u&&"CompositionEvent"in window,Lr=null;u&&"documentMode"in document&&(Lr=document.documentMode);var Dr=u&&"TextEvent"in window&&!Lr,Nr=u&&(!Br||Lr&&8<Lr&&11>=Lr),Fr=String.fromCharCode(32),Or=!1;function zr(e,t){switch(e){case"keyup":return-1!==Rr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ur(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var jr=!1,Vr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vr[e.type]:"textarea"===t}function Qr(e,t,r,n){Se(n),0<(t=Wn(t,"onChange")).length&&(r=new cr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Xr=null,Wr=null;function Hr(e){On(e,0)}function Gr(e){if(H(yi(e)))return e}function $r(e,t){if("change"===e)return t}var Yr=!1;if(u){var Kr;if(u){var Jr="oninput"in document;if(!Jr){var Zr=document.createElement("div");Zr.setAttribute("oninput","return;"),Jr="function"==typeof Zr.oninput}Kr=Jr}else Kr=!1;Yr=Kr&&(!document.documentMode||9<document.documentMode)}function en(){Xr&&(Xr.detachEvent("onpropertychange",tn),Wr=Xr=null)}function tn(e){if("value"===e.propertyName&&Gr(Wr)){var t=[];Qr(t,Wr,e,we(e)),Me(Hr,t)}}function rn(e,t,r){"focusin"===e?(en(),Wr=r,(Xr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gr(Wr)}function an(e,t){if("click"===e)return Gr(t)}function sn(e,t){if("input"===e||"change"===e)return Gr(t)}var on="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function ln(e,t){if(on(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!h.call(t,i)||!on(e[i],t[i]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var r,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dn(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var r="string"==typeof t.contentWindow.location.href}catch(e){r=!1}if(!r)break;t=G((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mn(e){var t=dn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hn(r.ownerDocument.documentElement,r)){if(null!==n&&fn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=void 0===n.end?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=un(r,a);var s=un(r,n);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pn=u&&"documentMode"in document&&11>=document.documentMode,gn=null,An=null,bn=null,vn=!1;function yn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;vn||null==gn||gn!==G(n)||(n="selectionStart"in(n=gn)&&fn(n)?{start:n.selectionStart,end:n.selectionEnd}:{anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},bn&&ln(bn,n)||(bn=n,0<(n=Wn(An,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=gn)))}function wn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var En={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},_n={},Tn={};function xn(e){if(_n[e])return _n[e];if(!En[e])return e;var t,r=En[e];for(t in r)if(r.hasOwnProperty(t)&&t in Tn)return _n[e]=r[t];return e}u&&(Tn=document.createElement("div").style,"AnimationEvent"in window||(delete En.animationend.animation,delete En.animationiteration.animation,delete En.animationstart.animation),"TransitionEvent"in window||delete En.transitionend.transition);var Sn=xn("animationend"),kn=xn("animationiteration"),In=xn("animationstart"),Cn=xn("transitionend"),Pn=new Map,Mn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rn(e,t){Pn.set(e,t),l(t,[e])}for(var Bn=0;Bn<Mn.length;Bn++){var Ln=Mn[Bn];Rn(Ln.toLowerCase(),"on"+(Ln[0].toUpperCase()+Ln.slice(1)))}Rn(Sn,"onAnimationEnd"),Rn(kn,"onAnimationIteration"),Rn(In,"onAnimationStart"),Rn("dblclick","onDoubleClick"),Rn("focusin","onFocus"),Rn("focusout","onBlur"),Rn(Cn,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dn));function Fn(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,i,s,o,l,c){if(je.apply(this,arguments),Ne){if(!Ne)throw Error(a(198));var u=Fe;Ne=!1,Fe=null,Oe||(Oe=!0,ze=u)}}(n,t,void 0,e),e.currentTarget=null}function On(e,t){t=0!=(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;Fn(i,o,c),a=l}else for(s=0;s<n.length;s++){if(l=(o=n[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;Fn(i,o,c),a=l}}}if(Oe)throw e=ze,Oe=!1,ze=null,e}function zn(e,t){var r=t[pi];void 0===r&&(r=t[pi]=new Set);var n=e+"__bubble";r.has(n)||(qn(t,e,2,!1),r.add(n))}function Un(e,t,r){var n=0;t&&(n|=4),qn(r,e,n,t)}var jn="_reactListening"+Math.random().toString(36).slice(2);function Vn(e){if(!e[jn]){e[jn]=!0,s.forEach((function(t){"selectionchange"!==t&&(Nn.has(t)||Un(t,!1,e),Un(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jn]||(t[jn]=!0,Un("selectionchange",!1,t))}}function qn(e,t,r,n){switch(Yt(t)){case 1:var i=Xt;break;case 4:i=Wt;break;default:i=Ht}r=i.bind(null,t,r,e),i=void 0,!Be||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Qn(e,t,r,n,i){var a=n;if(0==(1&t)&&0==(2&t)&&null!==n)e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var o=n.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=n.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=bi(o)))return;if(5===(l=s.tag)||6===l){n=a=s;continue e}o=o.parentNode}}n=n.return}Me((function(){var n=a,i=we(r),s=[];e:{var o=Pn.get(e);if(void 0!==o){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=Sr;break;case"focusin":c="focus",l=pr;break;case"focusout":c="blur",l=pr;break;case"beforeblur":case"afterblur":l=pr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ir;break;case Sn:case kn:case In:l=gr;break;case Cn:l=Cr;break;case"scroll":l=hr;break;case"wheel":l=Mr;break;case"copy":case"cut":case"paste":l=br;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=kr}var u=0!=(4&t),h=!u&&"scroll"===e,d=u?null!==o?o+"Capture":null:o;u=[];for(var f,m=n;null!==m;){var p=(f=m).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==d&&null!=(p=Re(m,d))&&u.push(Xn(m,p,f))),h)break;m=m.return}0<u.length&&(o=new l(o,c,null,r,i),s.push({event:o,listeners:u}))}}if(0==(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===ye||!(c=r.relatedTarget||r.fromElement)||!bi(c)&&!c[mi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?bi(c):null)&&(c!==(h=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(u=fr,p="onMouseLeave",d="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=kr,p="onPointerLeave",d="onPointerEnter",m="pointer"),h=null==l?o:yi(l),f=null==c?o:yi(c),(o=new u(p,m+"leave",l,r,i)).target=h,o.relatedTarget=f,p=null,bi(i)===n&&((u=new u(d,m+"enter",c,r,i)).target=f,u.relatedTarget=h,p=u),h=p,l&&c)e:{for(d=c,m=0,f=u=l;f;f=Hn(f))m++;for(f=0,p=d;p;p=Hn(p))f++;for(;0<m-f;)u=Hn(u),m--;for(;0<f-m;)d=Hn(d),f--;for(;m--;){if(u===d||null!==d&&u===d.alternate)break e;u=Hn(u),d=Hn(d)}u=null}else u=null;null!==l&&Gn(s,o,l,u,!1),null!==c&&null!==h&&Gn(s,h,c,u,!0)}if("select"===(l=(o=n?yi(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=$r;else if(qr(o))if(Yr)g=sn;else{g=nn;var A=rn}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=an);switch(g&&(g=g(e,n))?Qr(s,g,r,i):(A&&A(e,o,n),"focusout"===e&&(A=o._wrapperState)&&A.controlled&&"number"===o.type&&ee(o,"number",o.value)),A=n?yi(n):window,e){case"focusin":(qr(A)||"true"===A.contentEditable)&&(gn=A,An=n,bn=null);break;case"focusout":bn=An=gn=null;break;case"mousedown":vn=!0;break;case"contextmenu":case"mouseup":case"dragend":vn=!1,yn(s,r,i);break;case"selectionchange":if(pn)break;case"keydown":case"keyup":yn(s,r,i)}var b;if(Br)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else jr?zr(e,r)&&(v="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(v="onCompositionStart");v&&(Nr&&"ko"!==r.locale&&(jr||"onCompositionStart"!==v?"onCompositionEnd"===v&&jr&&(b=er()):(Jt="value"in(Kt=i)?Kt.value:Kt.textContent,jr=!0)),0<(A=Wn(n,v)).length&&(v=new vr(v,e,null,r,i),s.push({event:v,listeners:A}),(b||null!==(b=Ur(r)))&&(v.data=b))),(b=Dr?function(e,t){switch(e){case"compositionend":return Ur(t);case"keypress":return 32!==t.which?null:(Or=!0,Fr);case"textInput":return(e=t.data)===Fr&&Or?null:e;default:return null}}(e,r):function(e,t){if(jr)return"compositionend"===e||!Br&&zr(e,t)?(e=er(),Zt=Jt=Kt=null,jr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nr&&"ko"!==t.locale?null:t.data}}(e,r))&&0<(n=Wn(n,"onBeforeInput")).length&&(i=new vr("onBeforeInput","beforeinput",null,r,i),s.push({event:i,listeners:n}),i.data=b)}On(s,t)}))}function Xn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Wn(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Re(e,r))&&n.unshift(Xn(e,a,i)),null!=(a=Re(e,t))&&n.push(Xn(e,a,i))),e=e.return}return n}function Hn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gn(e,t,r,n,i){for(var a=t._reactName,s=[];null!==r&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(null!==l&&l===n)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=Re(r,a))&&s.unshift(Xn(r,l,o)):i||null!=(l=Re(r,a))&&s.push(Xn(r,l,o))),r=r.return}0!==s.length&&e.push({event:t,listeners:s})}var $n=/\r\n?/g,Yn=/\u0000|\uFFFD/g;function Kn(e){return("string"==typeof e?e:""+e).replace($n,"\n").replace(Yn,"")}function Jn(e,t,r){if(t=Kn(t),Kn(e)!==t&&r)throw Error(a(425))}function Zn(){}var ei=null,ti=null;function ri(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ni="function"==typeof setTimeout?setTimeout:void 0,ii="function"==typeof clearTimeout?clearTimeout:void 0,ai="function"==typeof Promise?Promise:void 0,si="function"==typeof queueMicrotask?queueMicrotask:void 0!==ai?function(e){return ai.resolve(null).then(e).catch(oi)}:ni;function oi(e){setTimeout((function(){throw e}))}function li(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&8===i.nodeType)if("/$"===(r=i.data)){if(0===n)return e.removeChild(i),void Vt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=i}while(r);Vt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,mi="__reactContainer$"+hi,pi="__reactEvents$"+hi,gi="__reactListeners$"+hi,Ai="__reactHandles$"+hi;function bi(e){var t=e[di];if(t)return t;for(var r=e.parentNode;r;){if(t=r[mi]||r[di]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=ui(e);null!==e;){if(r=e[di])return r;e=ui(e)}return t}r=(e=r).parentNode}return null}function vi(e){return!(e=e[di]||e[mi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function yi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function wi(e){return e[fi]||null}var Ei=[],_i=-1;function Ti(e){return{current:e}}function xi(e){0>_i||(e.current=Ei[_i],Ei[_i]=null,_i--)}function Si(e,t){_i++,Ei[_i]=e.current,e.current=t}var ki={},Ii=Ti(ki),Ci=Ti(!1),Pi=ki;function Mi(e,t){var r=e.type.contextTypes;if(!r)return ki;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in r)a[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ri(e){return null!=e.childContextTypes}function Bi(){xi(Ci),xi(Ii)}function Li(e,t,r){if(Ii.current!==ki)throw Error(a(168));Si(Ii,t),Si(Ci,r)}function Di(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return r;for(var i in n=n.getChildContext())if(!(i in t))throw Error(a(108,q(e)||"Unknown",i));return F({},r,n)}function Ni(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ki,Pi=Ii.current,Si(Ii,e),Si(Ci,Ci.current),!0}function Fi(e,t,r){var n=e.stateNode;if(!n)throw Error(a(169));r?(e=Di(e,t,Pi),n.__reactInternalMemoizedMergedChildContext=e,xi(Ci),xi(Ii),Si(Ii,e)):xi(Ci),Si(Ci,r)}var Oi=null,zi=!1,Ui=!1;function ji(e){null===Oi?Oi=[e]:Oi.push(e)}function Vi(){if(!Ui&&null!==Oi){Ui=!0;var e=0,t=vt;try{var r=Oi;for(vt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Oi=null,zi=!1}catch(t){throw null!==Oi&&(Oi=Oi.slice(e+1)),He(Ze,Vi),t}finally{vt=t,Ui=!1}}return null}var qi=[],Qi=0,Xi=null,Wi=0,Hi=[],Gi=0,$i=null,Yi=1,Ki="";function Ji(e,t){qi[Qi++]=Wi,qi[Qi++]=Xi,Xi=e,Wi=t}function Zi(e,t,r){Hi[Gi++]=Yi,Hi[Gi++]=Ki,Hi[Gi++]=$i,$i=e;var n=Yi;e=Ki;var i=32-st(n)-1;n&=~(1<<i),r+=1;var a=32-st(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Yi=1<<32-st(t)+i|r<<i|n,Ki=a+e}else Yi=1<<a|r<<i|n,Ki=e}function ea(e){null!==e.return&&(Ji(e,1),Zi(e,1,0))}function ta(e){for(;e===Xi;)Xi=qi[--Qi],qi[Qi]=null,Wi=qi[--Qi],qi[Qi]=null;for(;e===$i;)$i=Hi[--Gi],Hi[Gi]=null,Ki=Hi[--Gi],Hi[Gi]=null,Yi=Hi[--Gi],Hi[Gi]=null}var ra=null,na=null,ia=!1,aa=null;function sa(e,t){var r=Mc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function oa(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ra=e,na=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ra=e,na=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==$i?{id:Yi,overflow:Ki}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Mc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ra=e,na=null,!0);default:return!1}}function la(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function ca(e){if(ia){var t=na;if(t){var r=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=ci(r.nextSibling);var n=ra;t&&oa(e,t)?sa(n,r):(e.flags=-4097&e.flags|2,ia=!1,ra=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,ra=e}}}function ua(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ra=e}function ha(e){if(e!==ra)return!1;if(!ia)return ua(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ri(e.type,e.memoizedProps)),t&&(t=na)){if(la(e))throw da(),Error(a(418));for(;t;)sa(e,t),t=ci(t.nextSibling)}if(ua(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){na=ci(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}na=null}}else na=ra?ci(e.stateNode.nextSibling):null;return!0}function da(){for(var e=na;e;)e=ci(e.nextSibling)}function fa(){na=ra=null,ia=!1}function ma(e){null===aa?aa=[e]:aa.push(e)}var pa=y.ReactCurrentBatchConfig;function ga(e,t){if(e&&e.defaultProps){for(var r in t=F({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var Aa=Ti(null),ba=null,va=null,ya=null;function wa(){ya=va=ba=null}function Ea(e){var t=Aa.current;xi(Aa),e._currentValue=t}function _a(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ta(e,t){ba=e,ya=va=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(yo=!0),e.firstContext=null)}function xa(e){var t=e._currentValue;if(ya!==e)if(e={context:e,memoizedValue:t,next:null},null===va){if(null===ba)throw Error(a(308));va=e,ba.dependencies={lanes:0,firstContext:e}}else va=va.next=e;return t}var Sa=null;function ka(e){null===Sa?Sa=[e]:Sa.push(e)}function Ia(e,t,r,n){var i=t.interleaved;return null===i?(r.next=r,ka(t)):(r.next=i.next,i.next=r),t.interleaved=r,Ca(e,n)}function Ca(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Pa=!1;function Ma(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ra(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ba(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function La(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!=(2&Il)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Ca(e,r)}return null===(i=n.interleaved)?(t.next=t,ka(n)):(t.next=i.next,i.next=t),n.interleaved=t,Ca(e,r)}function Da(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,bt(e,r)}}function Na(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===a?i=a=s:a=a.next=s,r=r.next}while(null!==r);null===a?i=a=t:a=a.next=t}else i=a=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Fa(e,t,r,n){var i=e.updateQueue;Pa=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var u=e.alternate;null!==u&&(o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l)}if(null!==a){var h=i.baseState;for(s=0,u=c=l=null,o=a;;){var d=o.lane,f=o.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(d=t,f=r,p.tag){case 1:if("function"==typeof(m=p.payload)){h=m.call(f,h,d);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(d="function"==typeof(m=p.payload)?m.call(f,h,d):m))break e;h=F({},h,d);break e;case 2:Pa=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,s|=d;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(d=o).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Nl|=s,e.lanes=s,e.memoizedState=h}}function Oa(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!=typeof i)throw Error(a(191,i));i.call(n)}}}var za=(new n.Component).refs;function Ua(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:F({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var ja={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ec(),i=tc(e),a=Ba(n,i);a.payload=t,null!=r&&(a.callback=r),null!==(t=La(e,a,i))&&(rc(t,e,i,n),Da(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ec(),i=tc(e),a=Ba(n,i);a.tag=1,a.payload=t,null!=r&&(a.callback=r),null!==(t=La(e,a,i))&&(rc(t,e,i,n),Da(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ec(),n=tc(e),i=Ba(r,n);i.tag=2,null!=t&&(i.callback=t),null!==(t=La(e,i,n))&&(rc(t,e,n,r),Da(t,e,n))}};function Va(e,t,r,n,i,a,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,s):!(t.prototype&&t.prototype.isPureReactComponent&&ln(r,n)&&ln(i,a))}function qa(e,t,r){var n=!1,i=ki,a=t.contextType;return"object"==typeof a&&null!==a?a=xa(a):(i=Ri(t)?Pi:Ii.current,a=(n=null!=(n=t.contextTypes))?Mi(e,i):ki),t=new t(r,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ja,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Qa(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ja.enqueueReplaceState(t,t.state,null)}function Xa(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=za,Ma(e);var a=t.contextType;"object"==typeof a&&null!==a?i.context=xa(a):(a=Ri(t)?Pi:Ii.current,i.context=Mi(e,a)),i.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(Ua(e,t,a,r),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ja.enqueueReplaceState(i,i.state,null),Fa(e,r,i,n),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}function Wa(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(a(309));var n=r.stateNode}if(!n)throw Error(a(147,e));var i=n,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;t===za&&(t=i.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!=typeof e)throw Error(a(284));if(!r._owner)throw Error(a(290,e))}return e}function Ha(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ga(e){return(0,e._init)(e._payload)}function $a(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Bc(e,t)).index=0,e.sibling=null,e}function s(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Fc(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function c(e,t,r,n){var a=r.type;return a===_?h(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===R&&Ga(a)===t.type)?((n=i(t,r.props)).ref=Wa(e,t,r),n.return=e,n):((n=Lc(r.type,r.key,r.props,null,e.mode,n)).ref=Wa(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Oc(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function h(e,t,r,n,a){return null===t||7!==t.tag?((t=Dc(r,e.mode,n,a)).return=e,t):((t=i(t,r)).return=e,t)}function d(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Fc(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case w:return(r=Lc(t.type,t.key,t.props,null,e.mode,r)).ref=Wa(e,null,t),r.return=e,r;case E:return(t=Oc(t,e.mode,r)).return=e,t;case R:return d(e,(0,t._init)(t._payload),r)}if(te(t)||D(t))return(t=Dc(t,e.mode,r,null)).return=e,t;Ha(e,t)}return null}function f(e,t,r,n){var i=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r)return null!==i?null:l(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===i?c(e,t,r,n):null;case E:return r.key===i?u(e,t,r,n):null;case R:return f(e,t,(i=r._init)(r._payload),n)}if(te(r)||D(r))return null!==i?null:h(e,t,r,n,null);Ha(e,r)}return null}function m(e,t,r,n,i){if("string"==typeof n&&""!==n||"number"==typeof n)return l(t,e=e.get(r)||null,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case w:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i);case E:return u(t,e=e.get(null===n.key?r:n.key)||null,n,i);case R:return m(e,t,r,(0,n._init)(n._payload),i)}if(te(n)||D(n))return h(t,e=e.get(r)||null,n,i,null);Ha(t,n)}return null}function p(i,a,o,l){for(var c=null,u=null,h=a,p=a=0,g=null;null!==h&&p<o.length;p++){h.index>p?(g=h,h=null):g=h.sibling;var A=f(i,h,o[p],l);if(null===A){null===h&&(h=g);break}e&&h&&null===A.alternate&&t(i,h),a=s(A,a,p),null===u?c=A:u.sibling=A,u=A,h=g}if(p===o.length)return r(i,h),ia&&Ji(i,p),c;if(null===h){for(;p<o.length;p++)null!==(h=d(i,o[p],l))&&(a=s(h,a,p),null===u?c=h:u.sibling=h,u=h);return ia&&Ji(i,p),c}for(h=n(i,h);p<o.length;p++)null!==(g=m(h,i,p,o[p],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?p:g.key),a=s(g,a,p),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(i,e)})),ia&&Ji(i,p),c}function g(i,o,l,c){var u=D(l);if("function"!=typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var h=u=null,p=o,g=o=0,A=null,b=l.next();null!==p&&!b.done;g++,b=l.next()){p.index>g?(A=p,p=null):A=p.sibling;var v=f(i,p,b.value,c);if(null===v){null===p&&(p=A);break}e&&p&&null===v.alternate&&t(i,p),o=s(v,o,g),null===h?u=v:h.sibling=v,h=v,p=A}if(b.done)return r(i,p),ia&&Ji(i,g),u;if(null===p){for(;!b.done;g++,b=l.next())null!==(b=d(i,b.value,c))&&(o=s(b,o,g),null===h?u=b:h.sibling=b,h=b);return ia&&Ji(i,g),u}for(p=n(i,p);!b.done;g++,b=l.next())null!==(b=m(p,i,g,b.value,c))&&(e&&null!==b.alternate&&p.delete(null===b.key?g:b.key),o=s(b,o,g),null===h?u=b:h.sibling=b,h=b);return e&&p.forEach((function(e){return t(i,e)})),ia&&Ji(i,g),u}return function e(n,a,s,l){if("object"==typeof s&&null!==s&&s.type===_&&null===s.key&&(s=s.props.children),"object"==typeof s&&null!==s){switch(s.$$typeof){case w:e:{for(var c=s.key,u=a;null!==u;){if(u.key===c){if((c=s.type)===_){if(7===u.tag){r(n,u.sibling),(a=i(u,s.props.children)).return=n,n=a;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===R&&Ga(c)===u.type){r(n,u.sibling),(a=i(u,s.props)).ref=Wa(n,u,s),a.return=n,n=a;break e}r(n,u);break}t(n,u),u=u.sibling}s.type===_?((a=Dc(s.props.children,n.mode,l,s.key)).return=n,n=a):((l=Lc(s.type,s.key,s.props,null,n.mode,l)).ref=Wa(n,a,s),l.return=n,n=l)}return o(n);case E:e:{for(u=s.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){r(n,a.sibling),(a=i(a,s.children||[])).return=n,n=a;break e}r(n,a);break}t(n,a),a=a.sibling}(a=Oc(s,n.mode,l)).return=n,n=a}return o(n);case R:return e(n,a,(u=s._init)(s._payload),l)}if(te(s))return p(n,a,s,l);if(D(s))return g(n,a,s,l);Ha(n,s)}return"string"==typeof s&&""!==s||"number"==typeof s?(s=""+s,null!==a&&6===a.tag?(r(n,a.sibling),(a=i(a,s)).return=n,n=a):(r(n,a),(a=Fc(s,n.mode,l)).return=n,n=a),o(n)):r(n,a)}}var Ya=$a(!0),Ka=$a(!1),Ja={},Za=Ti(Ja),es=Ti(Ja),ts=Ti(Ja);function rs(e){if(e===Ja)throw Error(a(174));return e}function ns(e,t){switch(Si(ts,t),Si(es,e),Si(Za,Ja),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xi(Za),Si(Za,t)}function is(){xi(Za),xi(es),xi(ts)}function as(e){rs(ts.current);var t=rs(Za.current),r=le(t,e.type);t!==r&&(Si(es,e),Si(Za,r))}function ss(e){es.current===e&&(xi(Za),xi(es))}var os=Ti(0);function ls(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var cs=[];function us(){for(var e=0;e<cs.length;e++)cs[e]._workInProgressVersionPrimary=null;cs.length=0}var hs=y.ReactCurrentDispatcher,ds=y.ReactCurrentBatchConfig,fs=0,ms=null,ps=null,gs=null,As=!1,bs=!1,vs=0,ys=0;function ws(){throw Error(a(321))}function Es(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!on(e[r],t[r]))return!1;return!0}function _s(e,t,r,n,i,s){if(fs=s,ms=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hs.current=null===e||null===e.memoizedState?so:oo,e=r(n,i),bs){s=0;do{if(bs=!1,vs=0,25<=s)throw Error(a(301));s+=1,gs=ps=null,t.updateQueue=null,hs.current=lo,e=r(n,i)}while(bs)}if(hs.current=ao,t=null!==ps&&null!==ps.next,fs=0,gs=ps=ms=null,As=!1,t)throw Error(a(300));return e}function Ts(){var e=0!==vs;return vs=0,e}function xs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===gs?ms.memoizedState=gs=e:gs=gs.next=e,gs}function Ss(){if(null===ps){var e=ms.alternate;e=null!==e?e.memoizedState:null}else e=ps.next;var t=null===gs?ms.memoizedState:gs.next;if(null!==t)gs=t,ps=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ps=e).memoizedState,baseState:ps.baseState,baseQueue:ps.baseQueue,queue:ps.queue,next:null},null===gs?ms.memoizedState=gs=e:gs=gs.next=e}return gs}function ks(e,t){return"function"==typeof t?t(e):t}function Is(e){var t=Ss(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=ps,i=n.baseQueue,s=r.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(null!==i){s=i.next,n=n.baseState;var l=o=null,c=null,u=s;do{var h=u.lane;if((fs&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,o=n):c=c.next=d,ms.lanes|=h,Nl|=h}u=u.next}while(null!==u&&u!==s);null===c?o=n:c.next=l,on(n,t.memoizedState)||(yo=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(null!==(e=r.interleaved)){i=e;do{s=i.lane,ms.lanes|=s,Nl|=s,i=i.next}while(i!==e)}else null===i&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Cs(e){var t=Ss(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(null!==i){r.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);on(s,t.memoizedState)||(yo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Ps(){}function Ms(e,t){var r=ms,n=Ss(),i=t(),s=!on(n.memoizedState,i);if(s&&(n.memoizedState=i,yo=!0),n=n.queue,qs(Ls.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||null!==gs&&1&gs.memoizedState.tag){if(r.flags|=2048,Os(9,Bs.bind(null,r,n,i,t),void 0,null),null===Cl)throw Error(a(349));0!=(30&fs)||Rs(r,t,i)}return i}function Rs(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Bs(e,t,r,n){t.value=r,t.getSnapshot=n,Ds(t)&&Ns(e)}function Ls(e,t,r){return r((function(){Ds(t)&&Ns(e)}))}function Ds(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!on(e,r)}catch(e){return!0}}function Ns(e){var t=Ca(e,1);null!==t&&rc(t,e,1,-1)}function Fs(e){var t=xs();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ks,lastRenderedState:e},t.queue=e,e=e.dispatch=to.bind(null,ms,e),[t.memoizedState,e]}function Os(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function zs(){return Ss().memoizedState}function Us(e,t,r,n){var i=xs();ms.flags|=e,i.memoizedState=Os(1|t,r,void 0,void 0===n?null:n)}function js(e,t,r,n){var i=Ss();n=void 0===n?null:n;var a=void 0;if(null!==ps){var s=ps.memoizedState;if(a=s.destroy,null!==n&&Es(n,s.deps))return void(i.memoizedState=Os(t,r,a,n))}ms.flags|=e,i.memoizedState=Os(1|t,r,a,n)}function Vs(e,t){return Us(8390656,8,e,t)}function qs(e,t){return js(2048,8,e,t)}function Qs(e,t){return js(4,2,e,t)}function Xs(e,t){return js(4,4,e,t)}function Ws(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Hs(e,t,r){return r=null!=r?r.concat([e]):null,js(4,4,Ws.bind(null,t,e),r)}function Gs(){}function $s(e,t){var r=Ss();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Es(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Ys(e,t){var r=Ss();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Es(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Ks(e,t,r){return 0==(21&fs)?(e.baseState&&(e.baseState=!1,yo=!0),e.memoizedState=r):(on(r,t)||(r=pt(),ms.lanes|=r,Nl|=r,e.baseState=!0),t)}function Js(e,t){var r=vt;vt=0!==r&&4>r?r:4,e(!0);var n=ds.transition;ds.transition={};try{e(!1),t()}finally{vt=r,ds.transition=n}}function Zs(){return Ss().memoizedState}function eo(e,t,r){var n=tc(e);r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ro(e)?no(t,r):null!==(r=Ia(e,t,r,n))&&(rc(r,e,n,ec()),io(r,t,n))}function to(e,t,r){var n=tc(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ro(e))no(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,on(o,s)){var l=t.interleaved;return null===l?(i.next=i,ka(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(e){}null!==(r=Ia(e,t,i,n))&&(rc(r,e,n,i=ec()),io(r,t,n))}}function ro(e){var t=e.alternate;return e===ms||null!==t&&t===ms}function no(e,t){bs=As=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function io(e,t,r){if(0!=(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,bt(e,r)}}var ao={readContext:xa,useCallback:ws,useContext:ws,useEffect:ws,useImperativeHandle:ws,useInsertionEffect:ws,useLayoutEffect:ws,useMemo:ws,useReducer:ws,useRef:ws,useState:ws,useDebugValue:ws,useDeferredValue:ws,useTransition:ws,useMutableSource:ws,useSyncExternalStore:ws,useId:ws,unstable_isNewReconciler:!1},so={readContext:xa,useCallback:function(e,t){return xs().memoizedState=[e,void 0===t?null:t],e},useContext:xa,useEffect:Vs,useImperativeHandle:function(e,t,r){return r=null!=r?r.concat([e]):null,Us(4194308,4,Ws.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Us(4194308,4,e,t)},useInsertionEffect:function(e,t){return Us(4,2,e,t)},useMemo:function(e,t){var r=xs();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=xs();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=eo.bind(null,ms,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},xs().memoizedState=e},useState:Fs,useDebugValue:Gs,useDeferredValue:function(e){return xs().memoizedState=e},useTransition:function(){var e=Fs(!1),t=e[0];return e=Js.bind(null,e[1]),xs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ms,i=xs();if(ia){if(void 0===r)throw Error(a(407));r=r()}else{if(r=t(),null===Cl)throw Error(a(349));0!=(30&fs)||Rs(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Vs(Ls.bind(null,n,s,e),[e]),n.flags|=2048,Os(9,Bs.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=xs(),t=Cl.identifierPrefix;if(ia){var r=Ki;t=":"+t+"R"+(r=(Yi&~(1<<32-st(Yi)-1)).toString(32)+r),0<(r=vs++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=ys++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oo={readContext:xa,useCallback:$s,useContext:xa,useEffect:qs,useImperativeHandle:Hs,useInsertionEffect:Qs,useLayoutEffect:Xs,useMemo:Ys,useReducer:Is,useRef:zs,useState:function(){return Is(ks)},useDebugValue:Gs,useDeferredValue:function(e){return Ks(Ss(),ps.memoizedState,e)},useTransition:function(){return[Is(ks)[0],Ss().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Ms,useId:Zs,unstable_isNewReconciler:!1},lo={readContext:xa,useCallback:$s,useContext:xa,useEffect:qs,useImperativeHandle:Hs,useInsertionEffect:Qs,useLayoutEffect:Xs,useMemo:Ys,useReducer:Cs,useRef:zs,useState:function(){return Cs(ks)},useDebugValue:Gs,useDeferredValue:function(e){var t=Ss();return null===ps?t.memoizedState=e:Ks(t,ps.memoizedState,e)},useTransition:function(){return[Cs(ks)[0],Ss().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Ms,useId:Zs,unstable_isNewReconciler:!1};function co(e,t){try{var r="",n=t;do{r+=j(n),n=n.return}while(n);var i=r}catch(e){i="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:i,digest:null}}function uo(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var fo="function"==typeof WeakMap?WeakMap:Map;function mo(e,t,r){(r=Ba(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ql||(Ql=!0,Xl=n),ho(0,t)},r}function po(e,t,r){(r=Ba(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){ho(0,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(r.callback=function(){ho(0,t),"function"!=typeof n&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function go(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new fo;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=xc.bind(null,e,t,r),t.then(e,e))}function Ao(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bo(e,t,r,n,i){return 0==(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Ba(-1,1)).tag=2,La(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var vo=y.ReactCurrentOwner,yo=!1;function wo(e,t,r,n){t.child=null===e?Ka(t,null,r,n):Ya(t,e.child,r,n)}function Eo(e,t,r,n,i){r=r.render;var a=t.ref;return Ta(t,i),n=_s(e,t,r,n,a,i),r=Ts(),null===e||yo?(ia&&r&&ea(t),t.flags|=1,wo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Qo(e,t,i))}function _o(e,t,r,n,i){if(null===e){var a=r.type;return"function"!=typeof a||Rc(a)||void 0!==a.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Lc(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,To(e,t,a,n,i))}if(a=e.child,0==(e.lanes&i)){var s=a.memoizedProps;if((r=null!==(r=r.compare)?r:ln)(s,n)&&e.ref===t.ref)return Qo(e,t,i)}return t.flags|=1,(e=Bc(a,n)).ref=t.ref,e.return=t,t.child=e}function To(e,t,r,n,i){if(null!==e){var a=e.memoizedProps;if(ln(a,n)&&e.ref===t.ref){if(yo=!1,t.pendingProps=n=a,0==(e.lanes&i))return t.lanes=e.lanes,Qo(e,t,i);0!=(131072&e.flags)&&(yo=!0)}}return ko(e,t,r,n,i)}function xo(e,t,r){var n=t.pendingProps,i=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Si(Bl,Rl),Rl|=r;else{if(0==(1073741824&r))return e=null!==a?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Si(Bl,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==a?a.baseLanes:r,Si(Bl,Rl),Rl|=n}else null!==a?(n=a.baseLanes|r,t.memoizedState=null):n=r,Si(Bl,Rl),Rl|=n;return wo(e,t,i,r),t.child}function So(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function ko(e,t,r,n,i){var a=Ri(r)?Pi:Ii.current;return a=Mi(t,a),Ta(t,i),r=_s(e,t,r,n,a,i),n=Ts(),null===e||yo?(ia&&n&&ea(t),t.flags|=1,wo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Qo(e,t,i))}function Io(e,t,r,n,i){if(Ri(r)){var a=!0;Ni(t)}else a=!1;if(Ta(t,i),null===t.stateNode)qo(e,t),qa(t,r,n),Xa(t,r,n,i),n=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=r.contextType;c="object"==typeof c&&null!==c?xa(c):Mi(t,c=Ri(r)?Pi:Ii.current);var u=r.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;h||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==n||l!==c)&&Qa(t,s,n,c),Pa=!1;var d=t.memoizedState;s.state=d,Fa(t,n,s,i),l=t.memoizedState,o!==n||d!==l||Ci.current||Pa?("function"==typeof u&&(Ua(t,r,u,n),l=t.memoizedState),(o=Pa||Va(t,r,o,n,d,l,c))?(h||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):("function"==typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Ra(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ga(t.type,o),s.props=c,h=t.pendingProps,d=s.context,l="object"==typeof(l=r.contextType)&&null!==l?xa(l):Mi(t,l=Ri(r)?Pi:Ii.current);var f=r.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==h||d!==l)&&Qa(t,s,n,l),Pa=!1,d=t.memoizedState,s.state=d,Fa(t,n,s,i);var m=t.memoizedState;o!==h||d!==m||Ci.current||Pa?("function"==typeof f&&(Ua(t,r,f,n),m=t.memoizedState),(c=Pa||Va(t,r,c,n,d,m,l)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(n,m,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,m,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),s.props=n,s.state=m,s.context=l,n=c):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return Co(e,t,r,n,a,i)}function Co(e,t,r,n,i,a){So(e,t);var s=0!=(128&t.flags);if(!n&&!s)return i&&Fi(t,r,!1),Qo(e,t,a);n=t.stateNode,vo.current=t;var o=s&&"function"!=typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=Ya(t,e.child,null,a),t.child=Ya(t,null,o,a)):wo(e,t,o,a),t.memoizedState=n.state,i&&Fi(t,r,!0),t.child}function Po(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),ns(e,t.containerInfo)}function Mo(e,t,r,n,i){return fa(),ma(i),t.flags|=256,wo(e,t,r,n),t.child}var Ro,Bo,Lo,Do={dehydrated:null,treeContext:null,retryLane:0};function No(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,r){var n,i=t.pendingProps,s=os.current,o=!1,l=0!=(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!=(2&s)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Si(os,1&s),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0==(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Nc(l,i,0,null),e=Dc(e,i,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=No(r),t.memoizedState=Do,e):Oo(t,l));if(null!==(s=e.memoizedState)&&null!==(n=s.dehydrated))return function(e,t,r,n,i,s,o){if(r)return 256&t.flags?(t.flags&=-257,zo(e,t,o,n=uo(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Nc({mode:"visible",children:n.children},i,0,null),(s=Dc(s,i,o,null)).flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,0!=(1&t.mode)&&Ya(t,e.child,null,o),t.child.memoizedState=No(o),t.memoizedState=Do,s);if(0==(1&t.mode))return zo(e,t,o,null);if("$!"===i.data){if(n=i.nextSibling&&i.nextSibling.dataset)var l=n.dgst;return n=l,zo(e,t,o,n=uo(s=Error(a(419)),n,void 0))}if(l=0!=(o&e.childLanes),yo||l){if(null!==(n=Cl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!=(i&(n.suspendedLanes|o))?0:i)&&i!==s.retryLane&&(s.retryLane=i,Ca(e,i),rc(n,e,i,-1))}return pc(),zo(e,t,o,n=uo(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=kc.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,na=ci(i.nextSibling),ra=t,ia=!0,aa=null,null!==e&&(Hi[Gi++]=Yi,Hi[Gi++]=Ki,Hi[Gi++]=$i,Yi=e.id,Ki=e.overflow,$i=t),(t=Oo(t,n.children)).flags|=4096,t)}(e,t,l,i,n,s,r);if(o){o=i.fallback,l=t.mode,n=(s=e.child).sibling;var c={mode:"hidden",children:i.children};return 0==(1&l)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Bc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==n?o=Bc(n,o):(o=Dc(o,l,r,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?No(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~r,t.memoizedState=Do,i}return e=(o=e.child).sibling,i=Bc(o,{mode:"visible",children:i.children}),0==(1&t.mode)&&(i.lanes=r),i.return=t,i.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function Oo(e,t){return(t=Nc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zo(e,t,r,n){return null!==n&&ma(n),Ya(t,e.child,null,r),(e=Oo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Uo(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),_a(e.return,t,r)}function jo(e,t,r,n,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function Vo(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(wo(e,t,n.children,r),0!=(2&(n=os.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Uo(e,r,t);else if(19===e.tag)Uo(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Si(os,n),0==(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===ls(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),jo(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ls(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}jo(t,!0,r,null,a);break;case"together":jo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qo(e,t){0==(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qo(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Nl|=t.lanes,0==(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(r=Bc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Bc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Xo(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Wo(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Ho(e,t,r){var n=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wo(t),null;case 1:case 17:return Ri(t.type)&&Bi(),Wo(t),null;case 3:return n=t.stateNode,is(),xi(Ci),xi(Ii),us(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==aa&&(sc(aa),aa=null))),Wo(t),null;case 5:ss(t);var i=rs(ts.current);if(r=t.type,null!==e&&null!=t.stateNode)Bo(e,t,r,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(a(166));return Wo(t),null}if(e=rs(Za.current),ha(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[di]=t,n[fi]=s,e=0!=(1&t.mode),r){case"dialog":zn("cancel",n),zn("close",n);break;case"iframe":case"object":case"embed":zn("load",n);break;case"video":case"audio":for(i=0;i<Dn.length;i++)zn(Dn[i],n);break;case"source":zn("error",n);break;case"img":case"image":case"link":zn("error",n),zn("load",n);break;case"details":zn("toggle",n);break;case"input":Y(n,s),zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},zn("invalid",n);break;case"textarea":ie(n,s),zn("invalid",n)}for(var l in be(r,s),i=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"==typeof c?n.textContent!==c&&(!0!==s.suppressHydrationWarning&&Jn(n.textContent,c,e),i=["children",c]):"number"==typeof c&&n.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Jn(n.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zn("scroll",n)}switch(r){case"input":W(n),Z(n,s,!0);break;case"textarea":W(n),se(n);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(n.onclick=Zn)}n=i,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof n.is?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),"select"===r&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[di]=t,e[fi]=n,Ro(e,t),t.stateNode=e;e:{switch(l=ve(r,n),r){case"dialog":zn("cancel",e),zn("close",e),i=n;break;case"iframe":case"object":case"embed":zn("load",e),i=n;break;case"video":case"audio":for(i=0;i<Dn.length;i++)zn(Dn[i],e);i=n;break;case"source":zn("error",e),i=n;break;case"img":case"image":case"link":zn("error",e),zn("load",e),i=n;break;case"details":zn("toggle",e),i=n;break;case"input":Y(e,n),i=$(e,n),zn("invalid",e);break;case"option":default:i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=F({},n,{value:void 0}),zn("invalid",e);break;case"textarea":ie(e,n),i=ne(e,n),zn("invalid",e)}for(s in be(r,i),c=i)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===s?"string"==typeof u?("textarea"!==r||""!==u)&&de(e,u):"number"==typeof u&&de(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&zn("scroll",e):null!=u&&v(e,s,u,l))}switch(r){case"input":W(e),Z(e,n,!1);break;case"textarea":W(e),se(e);break;case"option":null!=n.value&&e.setAttribute("value",""+Q(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?re(e,!!n.multiple,s,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof i.onClick&&(e.onclick=Zn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wo(t),null;case 6:if(e&&null!=t.stateNode)Lo(0,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(a(166));if(r=rs(ts.current),rs(Za.current),ha(t)){if(n=t.stateNode,r=t.memoizedProps,n[di]=t,(s=n.nodeValue!==r)&&null!==(e=ra))switch(e.tag){case 3:Jn(n.nodeValue,r,0!=(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jn(n.nodeValue,r,0!=(1&e.mode))}s&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[di]=t,t.stateNode=n}return Wo(t),null;case 13:if(xi(os),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==na&&0!=(1&t.mode)&&0==(128&t.flags))da(),fa(),t.flags|=98560,s=!1;else if(s=ha(t),null!==n&&null!==n.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[di]=t}else fa(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wo(t),s=!1}else null!==aa&&(sc(aa),aa=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!=(128&t.flags)?(t.lanes=r,t):((n=null!==n)!=(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&os.current)?0===Ll&&(Ll=3):pc())),null!==t.updateQueue&&(t.flags|=4),Wo(t),null);case 4:return is(),null===e&&Vn(t.stateNode.containerInfo),Wo(t),null;case 10:return Ea(t.type._context),Wo(t),null;case 19:if(xi(os),null===(s=t.memoizedState))return Wo(t),null;if(n=0!=(128&t.flags),null===(l=s.rendering))if(n)Xo(s,!1);else{if(0!==Ll||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ls(e))){for(t.flags|=128,Xo(s,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(s=r).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Si(os,1&os.current|2),t.child}e=e.sibling}null!==s.tail&&Ke()>Vl&&(t.flags|=128,n=!0,Xo(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ls(l))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Xo(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ia)return Wo(t),null}else 2*Ke()-s.renderingStartTime>Vl&&1073741824!==r&&(t.flags|=128,n=!0,Xo(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=s.last)?r.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ke(),t.sibling=null,r=os.current,Si(os,n?1&r|2:1&r),t):(Wo(t),null);case 22:case 23:return hc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!=(1&t.mode)?0!=(1073741824&Rl)&&(Wo(t),6&t.subtreeFlags&&(t.flags|=8192)):Wo(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Go(e,t){switch(ta(t),t.tag){case 1:return Ri(t.type)&&Bi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return is(),xi(Ci),xi(Ii),us(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ss(t),null;case 13:if(xi(os),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xi(os),null;case 4:return is(),null;case 10:return Ea(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ro=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Bo=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,rs(Za.current);var a,s=null;switch(r){case"input":i=$(e,i),n=$(e,n),s=[];break;case"select":i=F({},i,{value:void 0}),n=F({},n,{value:void 0}),s=[];break;case"textarea":i=ne(e,i),n=ne(e,n),s=[];break;default:"function"!=typeof i.onClick&&"function"==typeof n.onClick&&(e.onclick=Zn)}for(u in be(r,n),r=null,i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=null!=i?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(s||(s=[]),s.push(u,r)),r=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&zn("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Lo=function(e,t,r,n){r!==n&&(t.flags|=4)};var $o=!1,Yo=!1,Ko="function"==typeof WeakSet?WeakSet:Set,Jo=null;function Zo(e,t){var r=e.ref;if(null!==r)if("function"==typeof r)try{r(null)}catch(r){Tc(e,t,r)}else r.current=null}function el(e,t,r){try{r()}catch(r){Tc(e,t,r)}}var tl=!1;function rl(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&el(t,r,a)}i=i.next}while(i!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function il(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"==typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[pi],delete t[gi],delete t[Ai]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!=(r=r._reactRootContainer)||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(ll(e,t,r),e=e.sibling;null!==e;)ll(e,t,r),e=e.sibling}function cl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}var ul=null,hl=!1;function dl(e,t,r){for(r=r.child;null!==r;)fl(e,t,r),r=r.sibling}function fl(e,t,r){if(at&&"function"==typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,r)}catch(e){}switch(r.tag){case 5:Yo||Zo(r,t);case 6:var n=ul,i=hl;ul=null,dl(e,t,r),hl=i,null!==(ul=n)&&(hl?(e=ul,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):ul.removeChild(r.stateNode));break;case 18:null!==ul&&(hl?(e=ul,r=r.stateNode,8===e.nodeType?li(e.parentNode,r):1===e.nodeType&&li(e,r),Vt(e)):li(ul,r.stateNode));break;case 4:n=ul,i=hl,ul=r.stateNode.containerInfo,hl=!0,dl(e,t,r),ul=n,hl=i;break;case 0:case 11:case 14:case 15:if(!Yo&&null!==(n=r.updateQueue)&&null!==(n=n.lastEffect)){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,void 0!==s&&(0!=(2&a)||0!=(4&a))&&el(r,t,s),i=i.next}while(i!==n)}dl(e,t,r);break;case 1:if(!Yo&&(Zo(r,t),"function"==typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(e){Tc(r,t,e)}dl(e,t,r);break;case 21:dl(e,t,r);break;case 22:1&r.mode?(Yo=(n=Yo)||null!==r.memoizedState,dl(e,t,r),Yo=n):dl(e,t,r);break;default:dl(e,t,r)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Ko),t.forEach((function(t){var n=Ic.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function pl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));fl(s,o,i),ul=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(e){Tc(i,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),Al(e),4&n){try{rl(3,e,e.return),nl(3,e)}catch(t){Tc(e,e.return,t)}try{rl(5,e,e.return)}catch(t){Tc(e,e.return,t)}}break;case 1:pl(t,e),Al(e),512&n&&null!==r&&Zo(r,r.return);break;case 5:if(pl(t,e),Al(e),512&n&&null!==r&&Zo(r,r.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(t){Tc(e,e.return,t)}}if(4&n&&null!=(i=e.stateNode)){var s=e.memoizedProps,o=null!==r?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&K(i,s),ve(l,o);var u=ve(l,s);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):v(i,h,d,u)}switch(l){case"input":J(i,s);break;case"textarea":ae(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;null!=m?re(i,!!s.multiple,m,!1):f!==!!s.multiple&&(null!=s.defaultValue?re(i,!!s.multiple,s.defaultValue,!0):re(i,!!s.multiple,s.multiple?[]:"",!1))}i[fi]=s}catch(t){Tc(e,e.return,t)}}break;case 6:if(pl(t,e),Al(e),4&n){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(t){Tc(e,e.return,t)}}break;case 3:if(pl(t,e),Al(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(t){Tc(e,e.return,t)}break;case 4:default:pl(t,e),Al(e);break;case 13:pl(t,e),Al(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(jl=Ke())),4&n&&ml(e);break;case 22:if(h=null!==r&&null!==r.memoizedState,1&e.mode?(Yo=(u=Yo)||h,pl(t,e),Yo=u):pl(t,e),Al(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!=(1&e.mode))for(Jo=e,h=e.child;null!==h;){for(d=Jo=h;null!==Jo;){switch(m=(f=Jo).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:Zo(f,f.return);var p=f.stateNode;if("function"==typeof p.componentWillUnmount){n=f,r=f.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(e){Tc(n,r,e)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){wl(d);continue}}null!==m?(m.return=f,Jo=m):wl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"==typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=d.stateNode,o=null!=(c=d.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",o))}catch(t){Tc(e,e.return,t)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(t){Tc(e,e.return,t)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:pl(t,e),Al(e),4&n&&ml(e);case 21:}}function Al(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(sl(r)){var n=r;break e}r=r.return}throw Error(a(160))}switch(n.tag){case 5:var i=n.stateNode;32&n.flags&&(de(i,""),n.flags&=-33),cl(e,ol(e),i);break;case 3:case 4:var s=n.stateNode.containerInfo;ll(e,ol(e),s);break;default:throw Error(a(161))}}catch(t){Tc(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,r){Jo=e,vl(e,t,r)}function vl(e,t,r){for(var n=0!=(1&e.mode);null!==Jo;){var i=Jo,a=i.child;if(22===i.tag&&n){var s=null!==i.memoizedState||$o;if(!s){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=$o;var c=Yo;if($o=s,(Yo=l)&&!c)for(Jo=i;null!==Jo;)l=(s=Jo).child,22===s.tag&&null!==s.memoizedState?El(i):null!==l?(l.return=s,Jo=l):El(i);for(;null!==a;)Jo=a,vl(a,t,r),a=a.sibling;Jo=i,$o=o,Yo=c}yl(e)}else 0!=(8772&i.subtreeFlags)&&null!==a?(a.return=i,Jo=a):yl(e)}}function yl(e){for(;null!==Jo;){var t=Jo;if(0!=(8772&t.flags)){var r=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Yo)if(null===r)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ga(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Oa(t,s,n);break;case 3:var o=t.updateQueue;if(null!==o){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Oa(t,o,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Vt(d)}}}break;default:throw Error(a(163))}Yo||512&t.flags&&il(t)}catch(e){Tc(t,t.return,e)}}if(t===e){Jo=null;break}if(null!==(r=t.sibling)){r.return=t.return,Jo=r;break}Jo=t.return}}function wl(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Jo=r;break}Jo=t.return}}function El(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nl(4,t)}catch(e){Tc(t,r,e)}break;case 1:var n=t.stateNode;if("function"==typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(e){Tc(t,i,e)}}var a=t.return;try{il(t)}catch(e){Tc(t,a,e)}break;case 5:var s=t.return;try{il(t)}catch(e){Tc(t,s,e)}}}catch(e){Tc(t,t.return,e)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var _l,Tl=Math.ceil,xl=y.ReactCurrentDispatcher,Sl=y.ReactCurrentOwner,kl=y.ReactCurrentBatchConfig,Il=0,Cl=null,Pl=null,Ml=0,Rl=0,Bl=Ti(0),Ll=0,Dl=null,Nl=0,Fl=0,Ol=0,zl=null,Ul=null,jl=0,Vl=1/0,ql=null,Ql=!1,Xl=null,Wl=null,Hl=!1,Gl=null,$l=0,Yl=0,Kl=null,Jl=-1,Zl=0;function ec(){return 0!=(6&Il)?Ke():-1!==Jl?Jl:Jl=Ke()}function tc(e){return 0==(1&e.mode)?1:0!=(2&Il)&&0!==Ml?Ml&-Ml:null!==pa.transition?(0===Zl&&(Zl=pt()),Zl):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,r,n){if(50<Yl)throw Yl=0,Kl=null,Error(a(185));At(e,r,n),0!=(2&Il)&&e===Cl||(e===Cl&&(0==(2&Il)&&(Fl|=r),4===Ll&&oc(e,Ml)),nc(e,n),1===r&&0===Il&&0==(1&t.mode)&&(Vl=Ke()+500,zi&&Vi()))}function nc(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-st(a),o=1<<s,l=i[s];-1===l?0!=(o&r)&&0==(o&n)||(i[s]=ft(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var n=dt(e,e===Cl?Ml:0);if(0===n)null!==r&&Ge(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Ge(r),1===t)0===e.tag?function(e){zi=!0,ji(e)}(lc.bind(null,e)):ji(lc.bind(null,e)),si((function(){0==(6&Il)&&Vi()})),r=null;else{switch(yt(n)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Cc(r,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ic(e,t){if(Jl=-1,Zl=0,0!=(6&Il))throw Error(a(327));var r=e.callbackNode;if(Ec()&&e.callbackNode!==r)return null;var n=dt(e,e===Cl?Ml:0);if(0===n)return null;if(0!=(30&n)||0!=(n&e.expiredLanes)||t)t=gc(e,n);else{t=n;var i=Il;Il|=2;var s=mc();for(Cl===e&&Ml===t||(ql=null,Vl=Ke()+500,dc(e,t));;)try{bc();break}catch(t){fc(e,t)}wa(),xl.current=s,Il=i,null!==Pl?t=0:(Cl=null,Ml=0,t=Ll)}if(0!==t){if(2===t&&0!==(i=mt(e))&&(n=i,t=ac(e,i)),1===t)throw r=Dl,dc(e,0),oc(e,n),nc(e,Ke()),r;if(6===t)oc(e,n);else{if(i=e.current.alternate,0==(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!on(a(),i))return!1}catch(e){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,n))&&0!==(s=mt(e))&&(n=s,t=ac(e,s)),1===t))throw r=Dl,dc(e,0),oc(e,n),nc(e,Ke()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,Ul,ql);break;case 3:if(oc(e,n),(130023424&n)===n&&10<(t=jl+500-Ke())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ni(wc.bind(null,e,Ul,ql),t);break}wc(e,Ul,ql);break;case 4:if(oc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-st(n);s=1<<o,(o=t[o])>i&&(i=o),n&=~s}if(n=i,10<(n=(120>(n=Ke()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Tl(n/1960))-n)){e.timeoutHandle=ni(wc.bind(null,e,Ul,ql),n);break}wc(e,Ul,ql);break;default:throw Error(a(329))}}}return nc(e,Ke()),e.callbackNode===r?ic.bind(null,e):null}function ac(e,t){var r=zl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ul,Ul=r,null!==t&&sc(t)),e}function sc(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function oc(e,t){for(t&=~Ol,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-st(t),n=1<<r;e[r]=-1,t&=~n}}function lc(e){if(0!=(6&Il))throw Error(a(327));Ec();var t=dt(e,0);if(0==(1&t))return nc(e,Ke()),null;var r=gc(e,t);if(0!==e.tag&&2===r){var n=mt(e);0!==n&&(t=n,r=ac(e,n))}if(1===r)throw r=Dl,dc(e,0),oc(e,t),nc(e,Ke()),r;if(6===r)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Ul,ql),nc(e,Ke()),null}function cc(e,t){var r=Il;Il|=1;try{return e(t)}finally{0===(Il=r)&&(Vl=Ke()+500,zi&&Vi())}}function uc(e){null!==Gl&&0===Gl.tag&&0==(6&Il)&&Ec();var t=Il;Il|=1;var r=kl.transition,n=vt;try{if(kl.transition=null,vt=1,e)return e()}finally{vt=n,kl.transition=r,0==(6&(Il=t))&&Vi()}}function hc(){Rl=Bl.current,xi(Bl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,ii(r)),null!==Pl)for(r=Pl.return;null!==r;){var n=r;switch(ta(n),n.tag){case 1:null!=(n=n.type.childContextTypes)&&Bi();break;case 3:is(),xi(Ci),xi(Ii),us();break;case 5:ss(n);break;case 4:is();break;case 13:case 19:xi(os);break;case 10:Ea(n.type._context);break;case 22:case 23:hc()}r=r.return}if(Cl=e,Pl=e=Bc(e.current,null),Ml=Rl=t,Ll=0,Dl=null,Ol=Fl=Nl=0,Ul=zl=null,null!==Sa){for(t=0;t<Sa.length;t++)if(null!==(n=(r=Sa[t]).interleaved)){r.interleaved=null;var i=n.next,a=r.pending;if(null!==a){var s=a.next;a.next=i,n.next=s}r.pending=n}Sa=null}return e}function fc(e,t){for(;;){var r=Pl;try{if(wa(),hs.current=ao,As){for(var n=ms.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}As=!1}if(fs=0,gs=ps=ms=null,bs=!1,vs=0,Sl.current=null,null===r||null===r.return){Ll=1,Dl=t,Pl=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=Ml,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,h=l,d=h.tag;if(0==(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=Ao(o);if(null!==m){m.flags&=-257,bo(m,o,l,0,t),1&m.mode&&go(s,u,t),c=u;var p=(t=m).updateQueue;if(null===p){var g=new Set;g.add(c),t.updateQueue=g}else p.add(c);break e}if(0==(1&t)){go(s,u,t),pc();break e}c=Error(a(426))}else if(ia&&1&l.mode){var A=Ao(o);if(null!==A){0==(65536&A.flags)&&(A.flags|=256),bo(A,o,l,0,t),ma(co(c,l));break e}}s=c=co(c,l),4!==Ll&&(Ll=2),null===zl?zl=[s]:zl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Na(s,mo(0,c,t));break e;case 1:l=c;var b=s.type,v=s.stateNode;if(0==(128&s.flags)&&("function"==typeof b.getDerivedStateFromError||null!==v&&"function"==typeof v.componentDidCatch&&(null===Wl||!Wl.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t,Na(s,po(s,l,t));break e}}s=s.return}while(null!==s)}yc(r)}catch(e){t=e,Pl===r&&null!==r&&(Pl=r=r.return);continue}break}}function mc(){var e=xl.current;return xl.current=ao,null===e?ao:e}function pc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Cl||0==(268435455&Nl)&&0==(268435455&Fl)||oc(Cl,Ml)}function gc(e,t){var r=Il;Il|=2;var n=mc();for(Cl===e&&Ml===t||(ql=null,dc(e,t));;)try{Ac();break}catch(t){fc(e,t)}if(wa(),Il=r,xl.current=n,null!==Pl)throw Error(a(261));return Cl=null,Ml=0,Ll}function Ac(){for(;null!==Pl;)vc(Pl)}function bc(){for(;null!==Pl&&!$e();)vc(Pl)}function vc(e){var t=_l(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?yc(e):Pl=t,Sl.current=null}function yc(e){var t=e;do{var r=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(r=Ho(r,t,Rl)))return void(Pl=r)}else{if(null!==(r=Go(r,t)))return r.flags&=32767,void(Pl=r);if(null===e)return Ll=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Ll&&(Ll=5)}function wc(e,t,r){var n=vt,i=kl.transition;try{kl.transition=null,vt=1,function(e,t,r,n){do{Ec()}while(null!==Gl);if(0!=(6&Il))throw Error(a(327));r=e.finishedWork;var i=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-st(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}(e,s),e===Cl&&(Pl=Cl=null,Ml=0),0==(2064&r.subtreeFlags)&&0==(2064&r.flags)||Hl||(Hl=!0,Cc(tt,(function(){return Ec(),null}))),s=0!=(15990&r.flags),0!=(15990&r.subtreeFlags)||s){s=kl.transition,kl.transition=null;var o=vt;vt=1;var l=Il;Il|=4,Sl.current=null,function(e,t){if(ei=Qt,fn(e=dn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch(e){r=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var m;d!==r||0!==i&&3!==d.nodeType||(l=o+i),d!==s||0!==n&&3!==d.nodeType||(c=o+n),3===d.nodeType&&(o+=d.nodeValue.length),null!==(m=d.firstChild);)f=d,d=m;for(;;){if(d===e)break t;if(f===r&&++u===i&&(l=o),f===s&&++h===n&&(c=o),null!==(m=d.nextSibling))break;f=(d=f).parentNode}d=m}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ti={focusedElem:e,selectionRange:r},Qt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var p=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,A=p.memoizedState,b=t.stateNode,v=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:ga(t.type,g),A);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(a(163))}}catch(e){Tc(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}p=tl,tl=!1}(e,r),gl(r,e),mn(ti),Qt=!!ei,ti=ei=null,e.current=r,bl(r,e,i),Ye(),Il=l,vt=o,kl.transition=s}else e.current=r;if(Hl&&(Hl=!1,Gl=e,$l=i),0===(s=e.pendingLanes)&&(Wl=null),function(e){if(at&&"function"==typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128==(128&e.current.flags))}catch(e){}}(r.stateNode),nc(e,Ke()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)n((i=t[r]).value,{componentStack:i.stack,digest:i.digest});if(Ql)throw Ql=!1,e=Xl,Xl=null,e;0!=(1&$l)&&0!==e.tag&&Ec(),0!=(1&(s=e.pendingLanes))?e===Kl?Yl++:(Yl=0,Kl=e):Yl=0,Vi()}(e,t,r,n)}finally{kl.transition=i,vt=n}return null}function Ec(){if(null!==Gl){var e=yt($l),t=kl.transition,r=vt;try{if(kl.transition=null,vt=16>e?16:e,null===Gl)var n=!1;else{if(e=Gl,Gl=null,$l=0,0!=(6&Il))throw Error(a(331));var i=Il;for(Il|=4,Jo=e.current;null!==Jo;){var s=Jo,o=s.child;if(0!=(16&Jo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Jo=u;null!==Jo;){var h=Jo;switch(h.tag){case 0:case 11:case 15:rl(8,h,s)}var d=h.child;if(null!==d)d.return=h,Jo=d;else for(;null!==Jo;){var f=(h=Jo).sibling,m=h.return;if(al(h),h===u){Jo=null;break}if(null!==f){f.return=m,Jo=f;break}Jo=m}}}var p=s.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var A=g.sibling;g.sibling=null,g=A}while(null!==g)}}Jo=s}}if(0!=(2064&s.subtreeFlags)&&null!==o)o.return=s,Jo=o;else e:for(;null!==Jo;){if(0!=(2048&(s=Jo).flags))switch(s.tag){case 0:case 11:case 15:rl(9,s,s.return)}var b=s.sibling;if(null!==b){b.return=s.return,Jo=b;break e}Jo=s.return}}var v=e.current;for(Jo=v;null!==Jo;){var y=(o=Jo).child;if(0!=(2064&o.subtreeFlags)&&null!==y)y.return=o,Jo=y;else e:for(o=v;null!==Jo;){if(0!=(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(e){Tc(l,l.return,e)}if(l===o){Jo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Jo=w;break e}Jo=l.return}}if(Il=i,Vi(),at&&"function"==typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(e){}n=!0}return n}finally{vt=r,kl.transition=t}}return!1}function _c(e,t,r){e=La(e,t=mo(0,t=co(r,t),1),1),t=ec(),null!==e&&(At(e,1,t),nc(e,t))}function Tc(e,t,r){if(3===e.tag)_c(e,e,r);else for(;null!==t;){if(3===t.tag){_c(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Wl||!Wl.has(n))){t=La(t,e=po(t,e=co(r,e),1),1),e=ec(),null!==t&&(At(t,1,e),nc(t,e));break}}t=t.return}}function xc(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&r,Cl===e&&(Ml&r)===r&&(4===Ll||3===Ll&&(130023424&Ml)===Ml&&500>Ke()-jl?dc(e,0):Ol|=r),nc(e,t)}function Sc(e,t){0===t&&(0==(1&e.mode)?t=1:(t=ut,0==(130023424&(ut<<=1))&&(ut=4194304)));var r=ec();null!==(e=Ca(e,t))&&(At(e,t,r),nc(e,r))}function kc(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Sc(e,r)}function Ic(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(a(314))}null!==n&&n.delete(t),Sc(e,r)}function Cc(e,t){return He(e,t)}function Pc(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(e,t,r,n){return new Pc(e,t,r,n)}function Rc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Bc(e,t){var r=e.alternate;return null===r?((r=Mc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Lc(e,t,r,n,i,s){var o=2;if(n=e,"function"==typeof e)Rc(e)&&(o=1);else if("string"==typeof e)o=5;else e:switch(e){case _:return Dc(r.children,i,s,t);case T:o=8,i|=8;break;case x:return(e=Mc(12,r,t,2|i)).elementType=x,e.lanes=s,e;case C:return(e=Mc(13,r,t,i)).elementType=C,e.lanes=s,e;case P:return(e=Mc(19,r,t,i)).elementType=P,e.lanes=s,e;case B:return Nc(r,i,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case S:o=10;break e;case k:o=9;break e;case I:o=11;break e;case M:o=14;break e;case R:o=16,n=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Mc(o,r,t,i)).elementType=e,t.type=n,t.lanes=s,t}function Dc(e,t,r,n){return(e=Mc(7,e,n,t)).lanes=r,e}function Nc(e,t,r,n){return(e=Mc(22,e,n,t)).elementType=B,e.lanes=r,e.stateNode={isHidden:!1},e}function Fc(e,t,r){return(e=Mc(6,e,null,t)).lanes=r,e}function Oc(e,t,r){return(t=Mc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uc(e,t,r,n,i,a,s,o,l){return e=new zc(e,t,r,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Mc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ma(a),e}function jc(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}function Vc(e){if(!e)return ki;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var r=e.type;if(Ri(r))return Di(e,r,t)}return t}function qc(e,t,r,n,i,a,s,o,l){return(e=Uc(r,n,!0,e,0,a,0,o,l)).context=Vc(null),r=e.current,(a=Ba(n=ec(),i=tc(r))).callback=null!=t?t:null,La(r,a,i),e.current.lanes=i,At(e,i,n),nc(e,n),e}function Qc(e,t,r,n){var i=t.current,a=ec(),s=tc(i);return r=Vc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Ba(a,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=La(i,t,s))&&(rc(e,i,s,a),Da(e,i,s)),s}function Xc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Hc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}_l=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ci.current)yo=!0;else{if(0==(e.lanes&r)&&0==(128&t.flags))return yo=!1,function(e,t,r){switch(t.tag){case 3:Po(t),fa();break;case 5:as(t);break;case 1:Ri(t.type)&&Ni(t);break;case 4:ns(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Si(Aa,n._currentValue),n._currentValue=i;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Si(os,1&os.current),t.flags|=128,null):0!=(r&t.child.childLanes)?Fo(e,t,r):(Si(os,1&os.current),null!==(e=Qo(e,t,r))?e.sibling:null);Si(os,1&os.current);break;case 19:if(n=0!=(r&t.childLanes),0!=(128&e.flags)){if(n)return Vo(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Si(os,os.current),n)break;return null;case 22:case 23:return t.lanes=0,xo(e,t,r)}return Qo(e,t,r)}(e,t,r);yo=0!=(131072&e.flags)}else yo=!1,ia&&0!=(1048576&t.flags)&&Zi(t,Wi,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;qo(e,t),e=t.pendingProps;var i=Mi(t,Ii.current);Ta(t,r),i=_s(null,t,n,e,i,r);var s=Ts();return t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(n)?(s=!0,Ni(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ma(t),i.updater=ja,t.stateNode=i,i._reactInternals=t,Xa(t,n,e,r),t=Co(null,t,n,!0,s,r)):(t.tag=0,ia&&s&&ea(t),wo(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(qo(e,t),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=function(e){if("function"==typeof e)return Rc(e)?1:0;if(null!=e){if((e=e.$$typeof)===I)return 11;if(e===M)return 14}return 2}(n),e=ga(n,e),i){case 0:t=ko(null,t,n,e,r);break e;case 1:t=Io(null,t,n,e,r);break e;case 11:t=Eo(null,t,n,e,r);break e;case 14:t=_o(null,t,n,ga(n.type,e),r);break e}throw Error(a(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,ko(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 1:return n=t.type,i=t.pendingProps,Io(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 3:e:{if(Po(t),null===e)throw Error(a(387));n=t.pendingProps,i=(s=t.memoizedState).element,Ra(e,t),Fa(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Mo(e,t,n,r,i=co(Error(a(423)),t));break e}if(n!==i){t=Mo(e,t,n,r,i=co(Error(a(424)),t));break e}for(na=ci(t.stateNode.containerInfo.firstChild),ra=t,ia=!0,aa=null,r=Ka(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(fa(),n===i){t=Qo(e,t,r);break e}wo(e,t,n,r)}t=t.child}return t;case 5:return as(t),null===e&&ca(t),n=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,o=i.children,ri(n,i)?o=null:null!==s&&ri(n,s)&&(t.flags|=32),So(e,t),wo(e,t,o,r),t.child;case 6:return null===e&&ca(t),null;case 13:return Fo(e,t,r);case 4:return ns(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Ya(t,null,n,r):wo(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,Eo(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 7:return wo(e,t,t.pendingProps,r),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Si(Aa,n._currentValue),n._currentValue=o,null!==s)if(on(s.value,o)){if(s.children===i.children&&!Ci.current){t=Qo(e,t,r);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===s.tag){(c=Ba(-1,r&-r)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=r,null!==(c=s.alternate)&&(c.lanes|=r),_a(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=r,null!==(l=o.alternate)&&(l.lanes|=r),_a(o,r,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}wo(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Ta(t,r),n=n(i=xa(i)),t.flags|=1,wo(e,t,n,r),t.child;case 14:return i=ga(n=t.type,t.pendingProps),_o(e,t,n,i=ga(n.type,i),r);case 15:return To(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ga(n,i),qo(e,t),t.tag=1,Ri(n)?(e=!0,Ni(t)):e=!1,Ta(t,r),qa(t,n,i),Xa(t,n,i,r),Co(null,t,n,!0,e,r);case 19:return Vo(e,t,r);case 22:return xo(e,t,r)}throw Error(a(156,t.tag))};var Gc="function"==typeof reportError?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if("function"==typeof i){var o=i;i=function(){var e=Xc(s);o.call(e)}}Qc(t,s,e,i)}else s=function(e,t,r,n,i){if(i){if("function"==typeof n){var a=n;n=function(){var e=Xc(s);a.call(e)}}var s=qc(t,n,e,0,null,!1,0,"",Zc);return e._reactRootContainer=s,e[mi]=s.current,Vn(8===e.nodeType?e.parentNode:e),uc(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"==typeof n){var o=n;n=function(){var e=Xc(l);o.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[mi]=l.current,Vn(8===e.nodeType?e.parentNode:e),uc((function(){Qc(t,l,r,n)})),l}(r,t,e,i,n);return Xc(s)}Yc.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Qc(e,t,null,null)},Yc.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Qc(null,e,null,null)})),t[mi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Bt.length&&0!==t&&t<Bt[r].priority;r++);Bt.splice(r,0,e),0===r&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ht(t.pendingLanes);0!==r&&(bt(t,1|r),nc(t,Ke()),0==(6&Il)&&(Vl=Ke()+500,Vi()))}break;case 13:uc((function(){var t=Ca(e,1);if(null!==t){var r=ec();rc(t,e,1,r)}})),Hc(e,1)}},Et=function(e){if(13===e.tag){var t=Ca(e,134217728);null!==t&&rc(t,e,134217728,ec()),Hc(e,134217728)}},_t=function(e){if(13===e.tag){var t=tc(e),r=Ca(e,t);null!==r&&rc(r,e,t,ec()),Hc(e,t)}},Tt=function(){return vt},xt=function(e,t){var r=vt;try{return vt=e,t()}finally{vt=r}},Ee=function(e,t,r){switch(t){case"input":if(J(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=wi(n);if(!i)throw Error(a(90));H(n),J(n,i)}}}break;case"textarea":ae(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ie=cc,Ce=uc;var tu={usingClientEntryPoint:!1,Events:[vi,yi,wi,Se,ke,cc]},ru={findFiberByHostInstance:bi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nu={bundleType:ru.bundleType,version:ru.version,rendererPackageName:ru.rendererPackageName,rendererConfig:ru.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Xe(e))?null:e.stateNode},findFiberByHostInstance:ru.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{it=iu.inject(nu),at=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(a(200));return jc(e,t,null,r)},t.createRoot=function(e,t){if(!Kc(e))throw Error(a(299));var r=!1,n="",i=Gc;return null!=t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Uc(e,1,!1,null,0,r,0,n,i),e[mi]=t.current,Vn(8===e.nodeType?e.parentNode:e),new $c(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return null===(e=Xe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,r){if(!Jc(t))throw Error(a(200));return eu(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Kc(e))throw Error(a(405));var n=null!=r&&r.hydratedSources||null,i=!1,s="",o=Gc;if(null!=r&&(!0===r.unstable_strictMode&&(i=!0),void 0!==r.identifierPrefix&&(s=r.identifierPrefix),void 0!==r.onRecoverableError&&(o=r.onRecoverableError)),t=qc(t,null,e,1,null!=r?r:null,i,0,s,o),e[mi]=t.current,Vn(e),n)for(e=0;e<n.length;e++)i=(i=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Yc(t)},t.render=function(e,t,r){if(!Jc(t))throw Error(a(200));return eu(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[mi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Jc(r))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return eu(e,t,r,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},745:(e,t,r)=>{"use strict";var n=r(3935);t.s=n.createRoot,n.hydrateRoot},3935:(e,t,r)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=r(4448)},2408:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator,m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function A(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}function b(){}function v(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||m}A.prototype.isReactComponent={},A.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},A.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=A.prototype;var y=v.prototype=new b;y.constructor=v,p(y,A.prototype),y.isPureReactComponent=!0;var w=Array.isArray,E=Object.prototype.hasOwnProperty,_={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,n){var i,a={},s=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)E.call(t,i)&&!T.hasOwnProperty(i)&&(a[i]=t[i]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:r,type:e,key:s,ref:o,props:a,_owner:_.current}}function S(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var k=/\/+/g;function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,i,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case n:l=!0}}if(l)return s=s(l=e),e=""===a?"."+I(l,0):a,w(s)?(i="",null!=e&&(i=e.replace(k,"$&/")+"/"),C(s,t,i,"",(function(e){return e}))):null!=s&&(S(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+e)),t.push(s)),1;if(l=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var u=a+I(o=e[c],c);l+=C(o,t,i,u,s)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,i,u=a+I(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,r){if(null==e)return e;var n=[],i=0;return C(e,n,"","",(function(e){return t.call(r,e,i++)})),n}function M(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},B={transition:null},L={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:B,ReactCurrentOwner:_};t.Children={map:P,forEach:function(e,t,r){P(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=A,t.Fragment=i,t.Profiler=s,t.PureComponent=v,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.cloneElement=function(e,t,n){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=p({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=_.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!T.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:r,type:e.type,key:a,ref:s,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=B.transition;B.transition={};try{e()}finally{B.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,r){return R.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,r){return R.current.useReducer(e,t,r)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return R.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return R.current.useTransition()},t.version="18.2.0"},7294:(e,t,r)=>{"use strict";e.exports=r(2408)},8090:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableWebToNodeStream=void 0;const n=r(5507);class i extends n.Readable{constructor(e){super(),this.bytesRead=0,this.released=!1,this.reader=e.getReader()}async _read(){if(this.released)return void this.push(null);this.pendingRead=this.reader.read();const e=await this.pendingRead;delete this.pendingRead,e.done||this.released?this.push(null):(this.bytesRead+=e.value.length,this.push(e.value))}async waitForReadToComplete(){this.pendingRead&&await this.pendingRead}async close(){await this.syncAndRelease()}async syncAndRelease(){this.released=!0,await this.waitForReadToComplete(),await this.reader.releaseLock()}}t.ReadableWebToNodeStream=i},1281:e=>{"use strict";var t={};function r(e,r,n){n||(n=Error);var i=function(e){var t,n;function i(t,n,i){return e.call(this,function(e,t,n){return"string"==typeof r?r:r(e,t,n)}(t,n,i))||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(n);i.prototype.name=n.name,i.prototype.code=e,t[e]=i}function n(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}r("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),r("ERR_INVALID_ARG_TYPE",(function(e,t,r){var i,a,s,o,l;if("string"==typeof t&&(a="not ",t.substr(0,a.length)===a)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(i," ").concat(n(t,"type"));else{var c=("number"!=typeof l&&(l=0),l+".".length>(o=e).length||-1===o.indexOf(".",l)?"argument":"property");s='The "'.concat(e,'" ').concat(c," ").concat(i," ").concat(n(t,"type"))}return s+". Received type ".concat(typeof r)}),TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},6201:(e,t,r)=>{"use strict";var n=r(4155),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=u;var a=r(2460),s=r(1103);r(5717)(u,a);for(var o=i(s.prototype),l=0;l<o.length;l++){var c=o[l];u.prototype[c]||(u.prototype[c]=s.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);a.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||n.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},4404:(e,t,r)=>{"use strict";e.exports=i;var n=r(7749);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(5717)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},2460:(e,t,r)=>{"use strict";var n,i=r(4155);e.exports=x,x.ReadableState=T,r(7187).EventEmitter;var a,s=function(e,t){return e.listeners(t).length},o=r(8114),l=r(8764).Buffer,c=r.g.Uint8Array||function(){},u=r(3838);a=u&&u.debuglog?u.debuglog("stream"):function(){};var h,d,f,m=r(597),p=r(358),g=r(5267).getHighWaterMark,A=r(1281).q,b=A.ERR_INVALID_ARG_TYPE,v=A.ERR_STREAM_PUSH_AFTER_EOF,y=A.ERR_METHOD_NOT_IMPLEMENTED,w=A.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(5717)(x,o);var E=p.errorOrDestroy,_=["error","close","destroy","pause","resume"];function T(e,t,i){n=n||r(6201),e=e||{},"boolean"!=typeof i&&(i=t instanceof n),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",i),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(2553).s),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function x(e){if(n=n||r(6201),!(this instanceof x))return new x(e);var t=this instanceof n;this._readableState=new T(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function S(e,t,r,n,i){a("readableAddChunk",t);var s,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(a("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?P(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}}(e,o);else if(i||(s=function(e,t){var r,n;return n=t,l.isBuffer(n)||n instanceof c||"string"==typeof t||void 0===t||e.objectMode||(r=new b("chunk",["string","Buffer","Uint8Array"],t)),r}(o,t)),s)E(e,s);else if(o.objectMode||t&&t.length>0)if("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),n)o.endEmitted?E(e,new w):k(e,o,t,!0);else if(o.ended)E(e,new v);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?k(e,o,t,!1):R(e,o)):k(e,o,t,!1)}else n||(o.reading=!1,R(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function k(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&P(e)),R(e,t)}Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),x.prototype.destroy=p.destroy,x.prototype._undestroy=p.undestroy,x.prototype._destroy=function(e,t){t(e)},x.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=l.from(e,t),t=""),r=!0),S(this,e,t,!1,r)},x.prototype.unshift=function(e){return S(this,e,null,!0,!1)},x.prototype.isPaused=function(){return!1===this._readableState.flowing},x.prototype.setEncoding=function(e){h||(h=r(2553).s);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var I=1073741824;function C(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=I?e=I:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function P(e){var t=e._readableState;a("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(a("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(M,e))}function M(e){var t=e._readableState;a("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,F(e)}function R(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(B,e,t))}function B(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(a("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){a("readable nexttick read 0"),e.read(0)}function N(e,t){a("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),F(e),t.flowing&&!t.reading&&e.read(0)}function F(e){var t=e._readableState;for(a("flow",t.flowing);t.flowing&&null!==e.read(););}function O(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function z(e){var t=e._readableState;a("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(U,t,e))}function U(e,t){if(a("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function j(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}x.prototype.read=function(e){a("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return a("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?z(this):P(this),null;if(0===(e=C(e,t))&&t.ended)return 0===t.length&&z(this),null;var n,i=t.needReadable;return a("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&a("length less than watermark",i=!0),t.ended||t.reading?a("reading or ended",i=!1):i&&(a("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=C(r,t))),null===(n=e>0?O(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&z(this)),null!==n&&this.emit("data",n),n},x.prototype._read=function(e){E(this,new y("_read()"))},x.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,a("pipe count=%d opts=%j",n.pipesCount,t);var o=t&&!1===t.end||e===i.stdout||e===i.stderr?p:l;function l(){a("onend"),e.end()}n.endEmitted?i.nextTick(o):r.once("end",o),e.on("unpipe",(function t(i,s){a("onunpipe"),i===r&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,a("cleanup"),e.removeListener("close",f),e.removeListener("finish",m),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",t),r.removeListener("end",l),r.removeListener("end",p),r.removeListener("data",h),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}));var c=function(e){return function(){var t=e._readableState;a("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,F(e))}}(r);e.on("drain",c);var u=!1;function h(t){a("ondata");var i=e.write(t);a("dest.write",i),!1===i&&((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==j(n.pipes,e))&&!u&&(a("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function d(t){a("onerror",t),p(),e.removeListener("error",d),0===s(e,"error")&&E(e,t)}function f(){e.removeListener("finish",m),p()}function m(){a("onfinish"),e.removeListener("close",f),p()}function p(){a("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events.error?Array.isArray(e._events.error)?e._events.error.unshift(r):e._events.error=[r,e._events.error]:e.on(t,r)}(e,"error",d),e.once("close",f),e.once("finish",m),e.emit("pipe",r),n.flowing||(a("pipe resume"),r.resume()),e},x.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var s=j(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},x.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===e&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,a("on readable",n.length,n.reading),n.length?P(this):n.reading||i.nextTick(D,this))),r},x.prototype.addListener=x.prototype.on,x.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(L,this),r},x.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(L,this),t},x.prototype.resume=function(){var e=this._readableState;return e.flowing||(a("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(N,e,t))}(this,e)),e.paused=!1,this},x.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},x.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(a("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){a("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<_.length;s++)e.on(_[s],this.emit.bind(this,_[s]));return this._read=function(t){a("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(x.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=r(6913)),d(this)}),Object.defineProperty(x.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(x.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(x.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),x._fromList=O,Object.defineProperty(x.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(x.from=function(e,t){return void 0===f&&(f=r(2887)),f(x,e,t)})},7749:(e,t,r)=>{"use strict";e.exports=u;var n=r(1281).q,i=n.ERR_METHOD_NOT_IMPLEMENTED,a=n.ERR_MULTIPLE_CALLBACK,s=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=n.ERR_TRANSFORM_WITH_LENGTH_0,l=r(6201);function c(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);l.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,r){d(e,t,r)}))}function d(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new o;if(e._transformState.transforming)throw new s;return e.push(null)}r(5717)(u,l),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,r){r(new i("_transform()"))},u.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}},1103:(e,t,r)=>{"use strict";var n,i=r(4155);function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(undefined),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=x,x.WritableState=T;var s,o={deprecate:r(4927)},l=r(8114),c=r(8764).Buffer,u=r.g.Uint8Array||function(){},h=r(358),d=r(5267).getHighWaterMark,f=r(1281).q,m=f.ERR_INVALID_ARG_TYPE,p=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,A=f.ERR_STREAM_CANNOT_PIPE,b=f.ERR_STREAM_DESTROYED,v=f.ERR_STREAM_NULL_VALUES,y=f.ERR_STREAM_WRITE_AFTER_END,w=f.ERR_UNKNOWN_ENCODING,E=h.errorOrDestroy;function _(){}function T(e,t,s){n=n||r(6201),e=e||{},"boolean"!=typeof s&&(s=t instanceof n),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,a=r.writecb;if("function"!=typeof a)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,a){--t.pendingcb,r?(i.nextTick(a,n),i.nextTick(M,e,t),e._writableState.errorEmitted=!0,E(e,n)):(a(n),e._writableState.errorEmitted=!0,E(e,n),M(e,t))}(e,r,n,t,a);else{var s=C(r)||e.destroyed;s||r.corked||r.bufferProcessing||!r.bufferedRequest||I(e,r),n?i.nextTick(k,e,r,s,a):k(e,r,s,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function x(e){var t=this instanceof(n=n||r(6201));if(!t&&!s.call(x,this))return new x(e);this._writableState=new T(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),l.call(this)}function S(e,t,r,n,i,a,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new b("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function k(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),M(e,t)}function I(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var o=0,l=!0;r;)i[o]=r,r.isBuf||(l=!1),r=r.next,o+=1;i.allBuffers=l,S(e,t,!0,t.length,i,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,h=r.callback;if(S(e,t,!1,t.objectMode?1:c.length,c,u,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function C(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function P(e,t){e._final((function(r){t.pendingcb--,r&&E(e,r),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=C(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(P,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return r}r(5717)(x,l),T.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(T.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(x,Symbol.hasInstance,{value:function(e){return!!s.call(this,e)||this===x&&e&&e._writableState instanceof T}})):s=function(e){return e instanceof this},x.prototype.pipe=function(){E(this,new A)},x.prototype.write=function(e,t,r){var n,a=this._writableState,s=!1,o=!a.objectMode&&(n=e,c.isBuffer(n)||n instanceof u);return o&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=a.defaultEncoding),"function"!=typeof r&&(r=_),a.ending?function(e,t){var r=new y;E(e,r),i.nextTick(t,r)}(this,r):(o||function(e,t,r,n){var a;return null===r?a=new v:"string"==typeof r||t.objectMode||(a=new m("chunk",["string","Buffer"],r)),!a||(E(e,a),i.nextTick(n,a),!1)}(this,a,e,r))&&(a.pendingcb++,s=function(e,t,r,n,i,a){if(!r){var s=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,r)),t}(t,n,i);n!==s&&(r=!0,i="buffer",n=s)}var o=t.objectMode?1:n.length;t.length+=o;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else S(e,t,!1,o,n,i,a);return l}(this,a,o,e,t,r)),s},x.prototype.cork=function(){this._writableState.corked++},x.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||I(this,e))},x.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(x.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(x.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),x.prototype._write=function(e,t,r){r(new p("_write()"))},x.prototype._writev=null,x.prototype.end=function(e,t,r){var n=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?i.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,n,r),this},Object.defineProperty(x.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),x.prototype.destroy=h.destroy,x.prototype._undestroy=h.undestroy,x.prototype._destroy=function(e,t){t(e)}},6913:(e,t,r)=>{"use strict";var n,i=r(4155);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=r(2880),o=Symbol("lastResolve"),l=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),h=Symbol("lastPromise"),d=Symbol("handlePromise"),f=Symbol("stream");function m(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[h]=null,e[o]=null,e[l]=null,t(m(r,!1)))}}function g(e){i.nextTick(p,e)}var A=Object.getPrototypeOf((function(){})),b=Object.setPrototypeOf((a(n={get stream(){return this[f]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(m(void 0,!0));if(this[f].destroyed)return new Promise((function(t,r){i.nextTick((function(){e[c]?r(e[c]):t(m(void 0,!0))}))}));var r,n=this[h];if(n)r=new Promise(function(e,t){return function(r,n){e.then((function(){t[u]?r(m(void 0,!0)):t[d](r,n)}),n)}}(n,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(m(a,!1));r=new Promise(this[d])}return this[h]=r,r}},Symbol.asyncIterator,(function(){return this})),a(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(m(void 0,!0))}))}))})),n),A);e.exports=function(e){var t,r=Object.create(b,(a(t={},f,{value:e,writable:!0}),a(t,o,{value:null,writable:!0}),a(t,l,{value:null,writable:!0}),a(t,c,{value:null,writable:!0}),a(t,u,{value:e._readableState.endEmitted,writable:!0}),a(t,d,{value:function(e,t){var n=r[f].read();n?(r[h]=null,r[o]=null,r[l]=null,e(m(n,!1))):(r[o]=e,r[l]=t)},writable:!0}),t));return r[h]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[l];return null!==t&&(r[h]=null,r[o]=null,r[l]=null,t(e)),void(r[c]=e)}var n=r[o];null!==n&&(r[h]=null,r[o]=null,r[l]=null,n(m(void 0,!0))),r[u]=!0})),e.on("readable",g.bind(null,r)),r}},597:(e,t,r)=>{"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=r(8764).Buffer,o=r(9283).inspect,l=o&&o.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r;return t=e,r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,r,n,i=s.allocUnsafe(e>>>0),a=this.head,o=0;a;)t=a.data,r=i,n=o,s.prototype.copy.call(t,r,n),o+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?n+=i:n+=i.slice(0,e),0==(e-=a)){a===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0==(e-=a)){a===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(a));break}++n}return this.length-=n,t}},{key:l,value:function(e,t){return o(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],r&&a(t.prototype,r),e}()},358:(e,t,r)=>{"use strict";var n=r(4155);function i(e,t){s(e,t),a(e)}function a(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function s(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,o=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return o||l?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(s,this,e)):n.nextTick(s,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?r._writableState?r._writableState.errorEmitted?n.nextTick(a,r):(r._writableState.errorEmitted=!0,n.nextTick(i,r,e)):n.nextTick(i,r,e):t?(n.nextTick(a,r),t(e)):n.nextTick(a,r)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}},2880:(e,t,r)=>{"use strict";var n=r(1281).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,a){if("function"==typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(a||i);var s=r.readable||!1!==r.readable&&t.readable,o=r.writable||!1!==r.writable&&t.writable,l=function(){t.writable||u()},c=t._writableState&&t._writableState.finished,u=function(){o=!1,c=!0,s||a.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){s=!1,h=!0,o||a.call(t)},f=function(e){a.call(t,e)},m=function(){var e;return s&&!h?(t._readableState&&t._readableState.ended||(e=new n),a.call(t,e)):o&&!c?(t._writableState&&t._writableState.ended||(e=new n),a.call(t,e)):void 0},p=function(){t.req.on("finish",u)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",u),t.on("abort",m),t.req?p():t.on("request",p)):o&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",d),t.on("finish",u),!1!==r.error&&t.on("error",f),t.on("close",m),function(){t.removeListener("complete",u),t.removeListener("abort",m),t.removeListener("request",p),t.req&&t.req.removeListener("finish",u),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",u),t.removeListener("end",d),t.removeListener("error",f),t.removeListener("close",m)}}},2887:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},677:(e,t,r)=>{"use strict";var n,i=r(1281).q,a=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function o(e){if(e)throw e}function l(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var o=!1;e.on("close",(function(){o=!0})),void 0===n&&(n=r(2880)),n(e,{readable:t,writable:i},(function(e){if(e)return a(e);o=!0,a()}));var l=!1;return function(t){if(!o&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void a(t||new s("pipe"))}}function c(e){e()}function u(e,t){return e.pipe(t)}function h(e){return e.length?"function"!=typeof e[e.length-1]?o:e.pop():o}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var s=t.map((function(e,r){var a=r<t.length-1;return l(e,a,r>0,(function(e){n||(n=e),e&&s.forEach(c),a||(s.forEach(c),i(n))}))}));return t.reduce(u)}},5267:(e,t,r)=>{"use strict";var n=r(1281).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new n(i?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},8114:(e,t,r)=>{e.exports=r(7187).EventEmitter},5507:(e,t,r)=>{(t=e.exports=r(2460)).Stream=t,t.Readable=t,t.Writable=r(1103),t.Duplex=r(6201),t.Transform=r(7749),t.PassThrough=r(4404),t.finished=r(2880),t.pipeline=r(677)},9509:(e,t,r)=>{var n=r(8764),i=n.Buffer;function a(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=s),s.prototype=Object.create(i.prototype),a(i,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},53:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<a(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,s=i>>>1;n<s;){var o=2*(n+1)-1,l=e[o],c=o+1,u=e[c];if(0>a(l,r))c<i&&0>a(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[o]=r,n=o);else{if(!(c<i&&0>a(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,m=!1,p=!1,g=!1,A="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function y(e){for(var t=n(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,r(c,t)}t=n(u)}}function w(e){if(g=!1,y(e),!p)if(null!==n(c))p=!0,B(E);else{var t=n(u);null!==t&&L(w,t.startTime-e)}}function E(e,r){p=!1,g&&(g=!1,b(S),S=-1),m=!0;var a=f;try{for(y(r),d=n(c);null!==d&&(!(d.expirationTime>r)||e&&!C());){var s=d.callback;if("function"==typeof s){d.callback=null,f=d.priorityLevel;var o=s(d.expirationTime<=r);r=t.unstable_now(),"function"==typeof o?d.callback=o:d===n(c)&&i(c),y(r)}else i(c);d=n(c)}if(null!==d)var l=!0;else{var h=n(u);null!==h&&L(w,h.startTime-r),l=!1}return l}finally{d=null,f=a,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,T=!1,x=null,S=-1,k=5,I=-1;function C(){return!(t.unstable_now()-I<k)}function P(){if(null!==x){var e=t.unstable_now();I=e;var r=!0;try{r=x(!0,e)}finally{r?_():(T=!1,x=null)}}else T=!1}if("function"==typeof v)_=function(){v(P)};else if("undefined"!=typeof MessageChannel){var M=new MessageChannel,R=M.port2;M.port1.onmessage=P,_=function(){R.postMessage(null)}}else _=function(){A(P,0)};function B(e){x=e,T||(T=!0,_())}function L(e,r){S=A((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||m||(p=!0,B(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?s+a:s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,r(u,e),null===n(c)&&e===n(u)&&(g?(b(S),S=-1):g=!0,L(w,a-s))):(e.sortIndex=o,r(c,e),p||m||(p=!0,B(E))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},3840:(e,t,r)=>{"use strict";e.exports=r(53)},3988:e=>{"use strict";var t;t=function(){var e={},t={};return e.on=function(e,r){var n={name:e,handler:r};return t[e]=t[e]||[],t[e].unshift(n),n},e.off=function(e){var r=t[e.name].indexOf(e);-1!==r&&t[e.name].splice(r,1)},e.trigger=function(e,r){var n,i=t[e];if(i)for(n=i.length;n--;)i[n].handler(r)},e},e.exports=t},5754:e=>{"use strict";var t,r,n,i,a,s,o,l,c=(t="https://api.spotify.com/v1",r=null,n=null,i=function(e,t){return e.abort=t,e},a=function(){var e=Array.prototype.slice.call(arguments),t=e[0],r=e.slice(1);return t=t||{},r.forEach((function(e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})),t},s=function(e,t){var a=new XMLHttpRequest,s=function(n,i){var s=e.type||"GET";if(a.open(s,function(e,t){var r="";for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];r+=encodeURIComponent(n)+"="+encodeURIComponent(i)+"&"}return r.length>0&&(e=e+"?"+(r=r.substring(0,r.length-1))),e}(e.url,e.params)),r&&a.setRequestHeader("Authorization","Bearer "+r),a.onreadystatechange=function(){if(4===a.readyState){var e=null;try{e=a.responseText?JSON.parse(a.responseText):""}catch(e){console.error(e)}a.status>=200&&a.status<300?function(e){n&&n(e),t&&t(null,e)}(e):(i&&i(a),t&&t(a,null))}},"GET"===s)a.send(null);else{var o=null;e.postData&&("image/jpeg"===e.contentType?(o=e.postData,a.setRequestHeader("Content-Type",e.contentType)):(o=JSON.stringify(e.postData),a.setRequestHeader("Content-Type","application/json"))),a.send(o)}};return t?(s(),null):function(e,t){var r;if(null!==n){var s=n.defer();e((function(e){s.resolve(e)}),(function(e){s.reject(e)})),r=s.promise}else window.Promise&&(r=new window.Promise(e));return r?new i(r,(function(){a.abort()})):null}(s)},o=function(e,t,r,n){var i={},o=null;return"object"==typeof t?(i=t,o=r):"function"==typeof t&&(o=t),"GET"!==(e.type||"GET")&&e.postData&&!n?e.postData=a(e.postData,i):e.params=a(e.params,i),s(e,o)},((l=function(){}).prototype={constructor:c}).getGeneric=function(e,t){return o({url:e},t)},l.prototype.getMe=function(e,r){return o({url:t+"/me"},e,r)},l.prototype.getMySavedTracks=function(e,r){return o({url:t+"/me/tracks"},e,r)},l.prototype.addToMySavedTracks=function(e,r,n){return o({url:t+"/me/tracks",type:"PUT",postData:e},r,n)},l.prototype.removeFromMySavedTracks=function(e,r,n){return o({url:t+"/me/tracks",type:"DELETE",postData:e},r,n)},l.prototype.containsMySavedTracks=function(e,r,n){var i={url:t+"/me/tracks/contains",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getMySavedAlbums=function(e,r){return o({url:t+"/me/albums"},e,r)},l.prototype.addToMySavedAlbums=function(e,r,n){return o({url:t+"/me/albums",type:"PUT",postData:e},r,n)},l.prototype.removeFromMySavedAlbums=function(e,r,n){return o({url:t+"/me/albums",type:"DELETE",postData:e},r,n)},l.prototype.containsMySavedAlbums=function(e,r,n){var i={url:t+"/me/albums/contains",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getMyTopArtists=function(e,r){return o({url:t+"/me/top/artists"},e,r)},l.prototype.getMyTopTracks=function(e,r){return o({url:t+"/me/top/tracks"},e,r)},l.prototype.getMyRecentlyPlayedTracks=function(e,r){return o({url:t+"/me/player/recently-played"},e,r)},l.prototype.followUsers=function(e,r){var n={url:t+"/me/following/",type:"PUT",params:{ids:e.join(","),type:"user"}};return o(n,r)},l.prototype.followArtists=function(e,r){var n={url:t+"/me/following/",type:"PUT",params:{ids:e.join(","),type:"artist"}};return o(n,r)},l.prototype.followPlaylist=function(e,r,n){return o({url:t+"/playlists/"+e+"/followers",type:"PUT",postData:{}},r,n)},l.prototype.unfollowUsers=function(e,r){var n={url:t+"/me/following/",type:"DELETE",params:{ids:e.join(","),type:"user"}};return o(n,r)},l.prototype.unfollowArtists=function(e,r){var n={url:t+"/me/following/",type:"DELETE",params:{ids:e.join(","),type:"artist"}};return o(n,r)},l.prototype.unfollowPlaylist=function(e,r){return o({url:t+"/playlists/"+e+"/followers",type:"DELETE"},r)},l.prototype.isFollowingUsers=function(e,r){var n={url:t+"/me/following/contains",type:"GET",params:{ids:e.join(","),type:"user"}};return o(n,r)},l.prototype.isFollowingArtists=function(e,r){var n={url:t+"/me/following/contains",type:"GET",params:{ids:e.join(","),type:"artist"}};return o(n,r)},l.prototype.areFollowingPlaylist=function(e,r,n){var i={url:t+"/playlists/"+e+"/followers/contains",type:"GET",params:{ids:r.join(",")}};return o(i,n)},l.prototype.getFollowedArtists=function(e,r){return o({url:t+"/me/following",type:"GET",params:{type:"artist"}},e,r)},l.prototype.getUser=function(e,r,n){var i={url:t+"/users/"+encodeURIComponent(e)};return o(i,r,n)},l.prototype.getUserPlaylists=function(e,r,n){var i;return"string"==typeof e?i={url:t+"/users/"+encodeURIComponent(e)+"/playlists"}:(i={url:t+"/me/playlists"},n=r,r=e),o(i,r,n)},l.prototype.getPlaylist=function(e,r,n){return o({url:t+"/playlists/"+e},r,n)},l.prototype.getPlaylistTracks=function(e,r,n){return o({url:t+"/playlists/"+e+"/tracks"},r,n)},l.prototype.getPlaylistCoverImage=function(e,r){return o({url:t+"/playlists/"+e+"/images"},r)},l.prototype.createPlaylist=function(e,r,n){var i={url:t+"/users/"+encodeURIComponent(e)+"/playlists",type:"POST",postData:r};return o(i,r,n)},l.prototype.changePlaylistDetails=function(e,r,n){return o({url:t+"/playlists/"+e,type:"PUT",postData:r},r,n)},l.prototype.addTracksToPlaylist=function(e,r,n,i){return o({url:t+"/playlists/"+e+"/tracks",type:"POST",postData:{uris:r}},n,i,!0)},l.prototype.replaceTracksInPlaylist=function(e,r,n){return o({url:t+"/playlists/"+e+"/tracks",type:"PUT",postData:{uris:r}},{},n)},l.prototype.reorderTracksInPlaylist=function(e,r,n,i,a){return o({url:t+"/playlists/"+e+"/tracks",type:"PUT",postData:{range_start:r,insert_before:n}},i,a)},l.prototype.removeTracksFromPlaylist=function(e,r,n){var i=r.map((function(e){return"string"==typeof e?{uri:e}:e}));return o({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{tracks:i}},{},n)},l.prototype.removeTracksFromPlaylistWithSnapshotId=function(e,r,n,i){var a=r.map((function(e){return"string"==typeof e?{uri:e}:e}));return o({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{tracks:a,snapshot_id:n}},{},i)},l.prototype.removeTracksFromPlaylistInPositions=function(e,r,n,i){return o({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{positions:r,snapshot_id:n}},{},i)},l.prototype.uploadCustomPlaylistCoverImage=function(e,r,n){var i={url:t+"/playlists/"+e+"/images",type:"PUT",postData:r.replace(/^data:image\/jpeg;base64,/,""),contentType:"image/jpeg"};return o(i,{},n)},l.prototype.getAlbum=function(e,r,n){return o({url:t+"/albums/"+e},r,n)},l.prototype.getAlbumTracks=function(e,r,n){return o({url:t+"/albums/"+e+"/tracks"},r,n)},l.prototype.getAlbums=function(e,r,n){var i={url:t+"/albums/",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getTrack=function(e,r,n){var i={};return i.url=t+"/tracks/"+e,o(i,r,n)},l.prototype.getTracks=function(e,r,n){var i={url:t+"/tracks/",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getArtist=function(e,r,n){return o({url:t+"/artists/"+e},r,n)},l.prototype.getArtists=function(e,r,n){var i={url:t+"/artists/",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getArtistAlbums=function(e,r,n){return o({url:t+"/artists/"+e+"/albums"},r,n)},l.prototype.getArtistTopTracks=function(e,r,n,i){return o({url:t+"/artists/"+e+"/top-tracks",params:{country:r}},n,i)},l.prototype.getArtistRelatedArtists=function(e,r,n){return o({url:t+"/artists/"+e+"/related-artists"},r,n)},l.prototype.getFeaturedPlaylists=function(e,r){return o({url:t+"/browse/featured-playlists"},e,r)},l.prototype.getNewReleases=function(e,r){return o({url:t+"/browse/new-releases"},e,r)},l.prototype.getCategories=function(e,r){return o({url:t+"/browse/categories"},e,r)},l.prototype.getCategory=function(e,r,n){return o({url:t+"/browse/categories/"+e},r,n)},l.prototype.getCategoryPlaylists=function(e,r,n){return o({url:t+"/browse/categories/"+e+"/playlists"},r,n)},l.prototype.search=function(e,r,n,i){var a={url:t+"/search/",params:{q:e,type:r.join(",")}};return o(a,n,i)},l.prototype.searchAlbums=function(e,t,r){return this.search(e,["album"],t,r)},l.prototype.searchArtists=function(e,t,r){return this.search(e,["artist"],t,r)},l.prototype.searchTracks=function(e,t,r){return this.search(e,["track"],t,r)},l.prototype.searchPlaylists=function(e,t,r){return this.search(e,["playlist"],t,r)},l.prototype.searchShows=function(e,t,r){return this.search(e,["show"],t,r)},l.prototype.searchEpisodes=function(e,t,r){return this.search(e,["episode"],t,r)},l.prototype.getAudioFeaturesForTrack=function(e,r){var n={};return n.url=t+"/audio-features/"+e,o(n,{},r)},l.prototype.getAudioFeaturesForTracks=function(e,r){return o({url:t+"/audio-features",params:{ids:e}},{},r)},l.prototype.getAudioAnalysisForTrack=function(e,r){var n={};return n.url=t+"/audio-analysis/"+e,o(n,{},r)},l.prototype.getRecommendations=function(e,r){return o({url:t+"/recommendations"},e,r)},l.prototype.getAvailableGenreSeeds=function(e){return o({url:t+"/recommendations/available-genre-seeds"},{},e)},l.prototype.getMyDevices=function(e){return o({url:t+"/me/player/devices"},{},e)},l.prototype.getMyCurrentPlaybackState=function(e,r){return o({url:t+"/me/player"},e,r)},l.prototype.getMyCurrentPlayingTrack=function(e,r){return o({url:t+"/me/player/currently-playing"},e,r)},l.prototype.transferMyPlayback=function(e,r,n){var i=r||{};return i.device_ids=e,o({type:"PUT",url:t+"/me/player",postData:i},r,n)},l.prototype.play=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null,i={};return["context_uri","uris","offset","position_ms"].forEach((function(t){t in e&&(i[t]=e[t])})),o({type:"PUT",url:t+"/me/player/play",params:n,postData:i},"function"==typeof e?e:{},r)},l.prototype.queue=function(e,r,n){var i="device_id"in(r=r||{})?{uri:e,device_id:r.device_id}:{uri:e};return o({type:"POST",url:t+"/me/player/queue",params:i},r,n)},l.prototype.pause=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null;return o({type:"PUT",url:t+"/me/player/pause",params:n},e,r)},l.prototype.skipToNext=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null;return o({type:"POST",url:t+"/me/player/next",params:n},e,r)},l.prototype.skipToPrevious=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null;return o({type:"POST",url:t+"/me/player/previous",params:n},e,r)},l.prototype.seek=function(e,r,n){var i={position_ms:e};return"device_id"in(r=r||{})&&(i.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/seek",params:i},r,n)},l.prototype.setRepeat=function(e,r,n){var i={state:e};return"device_id"in(r=r||{})&&(i.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/repeat",params:i},r,n)},l.prototype.setVolume=function(e,r,n){var i={volume_percent:e};return"device_id"in(r=r||{})&&(i.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/volume",params:i},r,n)},l.prototype.setShuffle=function(e,r,n){var i={state:e};return"device_id"in(r=r||{})&&(i.device_id=r.device_id),o({type:"PUT",url:t+"/me/player/shuffle",params:i},r,n)},l.prototype.getShow=function(e,r,n){var i={};return i.url=t+"/shows/"+e,o(i,r,n)},l.prototype.getShows=function(e,r,n){var i={url:t+"/shows/",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getMySavedShows=function(e,r){return o({url:t+"/me/shows"},e,r)},l.prototype.addToMySavedShows=function(e,r,n){return o({url:t+"/me/shows",type:"PUT",postData:e},r,n)},l.prototype.removeFromMySavedShows=function(e,r,n){return o({url:t+"/me/shows",type:"DELETE",postData:e},r,n)},l.prototype.containsMySavedShows=function(e,r,n){var i={url:t+"/me/shows/contains",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getShowEpisodes=function(e,r,n){return o({url:t+"/shows/"+e+"/episodes"},r,n)},l.prototype.getEpisode=function(e,r,n){var i={};return i.url=t+"/episodes/"+e,o(i,r,n)},l.prototype.getEpisodes=function(e,r,n){var i={url:t+"/episodes/",params:{ids:e.join(",")}};return o(i,r,n)},l.prototype.getAccessToken=function(){return r},l.prototype.setAccessToken=function(e){r=e},l.prototype.setPromiseImplementation=function(e){var t=!1;try{var r=new e((function(e){e()}));"function"==typeof r.then&&"function"==typeof r.catch&&(t=!0)}catch(e){console.error(e)}if(!t)throw new Error("Unsupported implementation of Promises/A+");n=e},l);"object"==typeof e.exports&&(e.exports=c)},2553:(e,t,r)=>{"use strict";var n=r(9509).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=u,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function u(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.s=a,a.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},a.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=s(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=s(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=s(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},842:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractTokenizer=void 0;const i=r(5167);t.AbstractTokenizer=class{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=e||{}}async readToken(e,t=this.position){const r=n.alloc(e.len);if(await this.readBuffer(r,{position:t})<e.len)throw new i.EndOfStreamError;return e.get(r,0)}async peekToken(e,t=this.position){const r=n.alloc(e.len);if(await this.peekBuffer(r,{position:t})<e.len)throw new i.EndOfStreamError;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new i.EndOfStreamError;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new i.EndOfStreamError;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){const t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){}normalizeOptions(e,t){if(t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return t?{mayBeLess:!0===t.mayBeLess,offset:t.offset?t.offset:0,length:t.length?t.length:e.length-(t.offset?t.offset:0),position:t.position?t.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}},778:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferTokenizer=void 0;const n=r(5167),i=r(842);class a extends i.AbstractTokenizer{constructor(e,t){super(t),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,t){if(t&&t.position){if(t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=t.position}const r=await this.peekBuffer(e,t);return this.position+=r,r}async peekBuffer(e,t){const r=this.normalizeOptions(e,t),i=Math.min(this.uint8Array.length-r.position,r.length);if(!r.mayBeLess&&i<r.length)throw new n.EndOfStreamError;return e.set(this.uint8Array.subarray(r.position,r.position+i),r.offset),i}async close(){}}t.BufferTokenizer=a},599:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadStreamTokenizer=void 0;const n=r(842),i=r(5167);class a extends n.AbstractTokenizer{constructor(e,t){super(t),this.streamReader=new i.StreamReader(e)}async getFileInfo(){return this.fileInfo}async readBuffer(e,t){const r=this.normalizeOptions(e,t),n=r.position-this.position;if(n>0)return await this.ignore(n),this.readBuffer(e,t);if(n<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(0===r.length)return 0;const a=await this.streamReader.read(e,r.offset,r.length);if(this.position+=a,(!t||!t.mayBeLess)&&a<r.length)throw new i.EndOfStreamError;return a}async peekBuffer(e,t){const r=this.normalizeOptions(e,t);let n=0;if(r.position){const t=r.position-this.position;if(t>0){const i=new Uint8Array(r.length+t);return n=await this.peekBuffer(i,{mayBeLess:r.mayBeLess}),e.set(i.subarray(t),r.offset),n-t}if(t<0)throw new Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{n=await this.streamReader.peek(e,r.offset,r.length)}catch(e){if(t&&t.mayBeLess&&e instanceof i.EndOfStreamError)return 0;throw e}if(!r.mayBeLess&&n<r.length)throw new i.EndOfStreamError}return n}async ignore(e){const t=Math.min(256e3,e),r=new Uint8Array(t);let n=0;for(;n<e;){const i=e-n,a=await this.readBuffer(r,{length:Math.min(t,i)});if(a<0)return a;n+=a}return n}}t.ReadStreamTokenizer=a},5849:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromBuffer=t.fromStream=t.EndOfStreamError=void 0;const n=r(599),i=r(778);var a=r(5167);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return a.EndOfStreamError}}),t.fromStream=function(e,t){return t=t||{},new n.ReadStreamTokenizer(e,t)},t.fromBuffer=function(e,t){return new i.BufferTokenizer(e,t)}},3416:(e,t,r)=>{"use strict";var n=r(8764).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AnsiStringType=t.StringType=t.BufferType=t.Uint8ArrayType=t.IgnoreType=t.Float80_LE=t.Float80_BE=t.Float64_LE=t.Float64_BE=t.Float32_LE=t.Float32_BE=t.Float16_LE=t.Float16_BE=t.INT64_BE=t.UINT64_BE=t.INT64_LE=t.UINT64_LE=t.INT32_LE=t.INT32_BE=t.INT24_BE=t.INT24_LE=t.INT16_LE=t.INT16_BE=t.INT8=t.UINT32_BE=t.UINT32_LE=t.UINT24_BE=t.UINT24_LE=t.UINT16_BE=t.UINT16_LE=t.UINT8=void 0;const i=r(645);function a(e){return new DataView(e.buffer,e.byteOffset)}t.UINT8={len:1,get:(e,t)=>a(e).getUint8(t),put:(e,t,r)=>(a(e).setUint8(t,r),t+1)},t.UINT16_LE={len:2,get:(e,t)=>a(e).getUint16(t,!0),put:(e,t,r)=>(a(e).setUint16(t,r,!0),t+2)},t.UINT16_BE={len:2,get:(e,t)=>a(e).getUint16(t),put:(e,t,r)=>(a(e).setUint16(t,r),t+2)},t.UINT24_LE={len:3,get(e,t){const r=a(e);return r.getUint8(t)+(r.getUint16(t+1,!0)<<8)},put(e,t,r){const n=a(e);return n.setUint8(t,255&r),n.setUint16(t+1,r>>8,!0),t+3}},t.UINT24_BE={len:3,get(e,t){const r=a(e);return(r.getUint16(t)<<8)+r.getUint8(t+2)},put(e,t,r){const n=a(e);return n.setUint16(t,r>>8),n.setUint8(t+2,255&r),t+3}},t.UINT32_LE={len:4,get:(e,t)=>a(e).getUint32(t,!0),put:(e,t,r)=>(a(e).setUint32(t,r,!0),t+4)},t.UINT32_BE={len:4,get:(e,t)=>a(e).getUint32(t),put:(e,t,r)=>(a(e).setUint32(t,r),t+4)},t.INT8={len:1,get:(e,t)=>a(e).getInt8(t),put:(e,t,r)=>(a(e).setInt8(t,r),t+1)},t.INT16_BE={len:2,get:(e,t)=>a(e).getInt16(t),put:(e,t,r)=>(a(e).setInt16(t,r),t+2)},t.INT16_LE={len:2,get:(e,t)=>a(e).getInt16(t,!0),put:(e,t,r)=>(a(e).setInt16(t,r,!0),t+2)},t.INT24_LE={len:3,get(e,r){const n=t.UINT24_LE.get(e,r);return n>8388607?n-16777216:n},put(e,t,r){const n=a(e);return n.setUint8(t,255&r),n.setUint16(t+1,r>>8,!0),t+3}},t.INT24_BE={len:3,get(e,r){const n=t.UINT24_BE.get(e,r);return n>8388607?n-16777216:n},put(e,t,r){const n=a(e);return n.setUint16(t,r>>8),n.setUint8(t+2,255&r),t+3}},t.INT32_BE={len:4,get:(e,t)=>a(e).getInt32(t),put:(e,t,r)=>(a(e).setInt32(t,r),t+4)},t.INT32_LE={len:4,get:(e,t)=>a(e).getInt32(t,!0),put:(e,t,r)=>(a(e).setInt32(t,r,!0),t+4)},t.UINT64_LE={len:8,get:(e,t)=>a(e).getBigUint64(t,!0),put:(e,t,r)=>(a(e).setBigUint64(t,r,!0),t+8)},t.INT64_LE={len:8,get:(e,t)=>a(e).getBigInt64(t,!0),put:(e,t,r)=>(a(e).setBigInt64(t,r,!0),t+8)},t.UINT64_BE={len:8,get:(e,t)=>a(e).getBigUint64(t),put:(e,t,r)=>(a(e).setBigUint64(t,r),t+8)},t.INT64_BE={len:8,get:(e,t)=>a(e).getBigInt64(t),put:(e,t,r)=>(a(e).setBigInt64(t,r),t+8)},t.Float16_BE={len:2,get(e,t){return i.read(e,t,!1,10,this.len)},put(e,t,r){return i.write(e,r,t,!1,10,this.len),t+this.len}},t.Float16_LE={len:2,get(e,t){return i.read(e,t,!0,10,this.len)},put(e,t,r){return i.write(e,r,t,!0,10,this.len),t+this.len}},t.Float32_BE={len:4,get:(e,t)=>a(e).getFloat32(t),put:(e,t,r)=>(a(e).setFloat32(t,r),t+4)},t.Float32_LE={len:4,get:(e,t)=>a(e).getFloat32(t,!0),put:(e,t,r)=>(a(e).setFloat32(t,r,!0),t+4)},t.Float64_BE={len:8,get:(e,t)=>a(e).getFloat64(t),put:(e,t,r)=>(a(e).setFloat64(t,r),t+8)},t.Float64_LE={len:8,get:(e,t)=>a(e).getFloat64(t,!0),put:(e,t,r)=>(a(e).setFloat64(t,r,!0),t+8)},t.Float80_BE={len:10,get(e,t){return i.read(e,t,!1,63,this.len)},put(e,t,r){return i.write(e,r,t,!1,63,this.len),t+this.len}},t.Float80_LE={len:10,get(e,t){return i.read(e,t,!0,63,this.len)},put(e,t,r){return i.write(e,r,t,!0,63,this.len),t+this.len}},t.IgnoreType=class{constructor(e){this.len=e}get(e,t){}},t.Uint8ArrayType=class{constructor(e){this.len=e}get(e,t){return e.subarray(t,t+this.len)}},t.BufferType=class{constructor(e){this.len=e}get(e,t){return n.from(e.subarray(t,t+this.len))}},t.StringType=class{constructor(e,t){this.len=e,this.encoding=t}get(e,t){return n.from(e).toString(this.encoding,t,t+this.len)}};class s{constructor(e){this.len=e}static decode(e,t,r){let n="";for(let i=t;i<r;++i)n+=s.codePointToString(s.singleByteDecoder(e[i]));return n}static inRange(e,t,r){return t<=e&&e<=r}static codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}static singleByteDecoder(e){if(s.inRange(e,0,127))return e;const t=s.windows1252[e-128];if(null===t)throw Error("invaliding encoding");return t}get(e,t=0){return s.decode(e,t,t+this.len)}}t.AnsiStringType=s,s.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},4927:(e,t,r)=>{function n(e){try{if(!r.g.localStorage)return!1}catch(e){return!1}var t=r.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}},6006:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=r(2275))&&n.__esModule?n:{default:n};t.default={pauseVideo:{acceptableStates:[i.default.ENDED,i.default.PAUSED],stateChangeRequired:!1},playVideo:{acceptableStates:[i.default.ENDED,i.default.PLAYING],stateChangeRequired:!1},seekTo:{acceptableStates:[i.default.ENDED,i.default.PLAYING,i.default.PAUSED],stateChangeRequired:!0,timeout:3e3}},e.exports=t.default},9125:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(9215)),i=o(r(8255)),a=o(r(5279)),s=o(r(6006));function o(e){return e&&e.__esModule?e:{default:e}}var l=(0,n.default)("youtube-player"),c={proxyEvents:function(e){var t={},r=function(r){var n="on"+r.slice(0,1).toUpperCase()+r.slice(1);t[n]=function(t){l('event "%s"',n,t),e.trigger(r,t)}},n=!0,i=!1,s=void 0;try{for(var o,c=a.default[Symbol.iterator]();!(n=(o=c.next()).done);n=!0)r(o.value)}catch(e){i=!0,s=e}finally{try{!n&&c.return&&c.return()}finally{if(i)throw s}}return t},promisifyPlayer:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={},n=function(n){t&&s.default[n]?r[n]=function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.then((function(e){var t=s.default[n],i=e.getPlayerState(),a=e[n].apply(e,r);return t.stateChangeRequired||Array.isArray(t.acceptableStates)&&-1===t.acceptableStates.indexOf(i)?new Promise((function(r){e.addEventListener("onStateChange",(function n(){var i=e.getPlayerState(),a=void 0;"number"==typeof t.timeout&&(a=setTimeout((function(){e.removeEventListener("onStateChange",n),r()}),t.timeout)),Array.isArray(t.acceptableStates)&&-1!==t.acceptableStates.indexOf(i)&&(e.removeEventListener("onStateChange",n),clearTimeout(a),r())}))})).then((function(){return a})):a}))}:r[n]=function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.then((function(e){return e[n].apply(e,r)}))}},a=!0,o=!1,l=void 0;try{for(var c,u=i.default[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var h=c.value;n(h)}}catch(e){o=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(o)throw l}}return r}};t.default=c,e.exports=t.default},2275:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={BUFFERING:3,ENDED:0,PAUSED:2,PLAYING:1,UNSTARTED:-1,VIDEO_CUED:5},e.exports=t.default},5279:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["ready","stateChange","playbackQualityChange","playbackRateChange","error","apiChange","volumeChange"],e.exports=t.default},8255:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=["cueVideoById","loadVideoById","cueVideoByUrl","loadVideoByUrl","playVideo","pauseVideo","stopVideo","getVideoLoadedFraction","cuePlaylist","loadPlaylist","nextVideo","previousVideo","playVideoAt","setShuffle","setLoop","getPlaylist","getPlaylistIndex","setOption","mute","unMute","isMuted","setVolume","getVolume","seekTo","getPlayerState","getPlaybackRate","setPlaybackRate","getAvailablePlaybackRates","getPlaybackQuality","setPlaybackQuality","getAvailableQualityLevels","getCurrentTime","getDuration","removeEventListener","getVideoUrl","getVideoEmbedCode","getOptions","getOption","addEventListener","destroy","setSize","getIframe"],e.exports=t.default},1062:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=o(r(3988)),a=o(r(5900)),s=o(r(9125));function o(e){return e&&e.__esModule?e:{default:e}}var l=void 0;t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i.default)();if(l||(l=(0,a.default)(o)),t.events)throw new Error("Event handlers cannot be overwritten.");if("string"==typeof e&&!document.getElementById(e))throw new Error('Element "'+e+'" does not exist.');t.events=s.default.proxyEvents(o);var c=new Promise((function(r){"object"===(void 0===e?"undefined":n(e))&&e.playVideo instanceof Function?r(e):l.then((function(n){var i=new n.Player(e,t);return o.on("ready",(function(){r(i)})),null}))})),u=s.default.promisifyPlayer(c,r);return u.on=o.on,u.off=o.off,u},e.exports=t.default},5900:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=r(9090))&&n.__esModule?n:{default:n};t.default=function(e){return new Promise((function(t){if(window.YT&&window.YT.Player&&window.YT.Player instanceof Function)t(window.YT);else{var r="http:"===window.location.protocol?"http:":"https:";(0,i.default)(r+"//www.youtube.com/iframe_api",(function(t){t&&e.trigger("error",t)}));var n=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=function(){n&&n(),t(window.YT)}}}))},e.exports=t.default},9215:(e,t,r)=>{var n=r(4155);function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}(t=e.exports=r(5046)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),r){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var i=0,a=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(a=i))})),e.splice(a,0,n)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())},5046:(e,t,r)=>{var n;function i(e){function r(){if(r.enabled){var e=r,i=+new Date,a=i-(n||i);e.diff=a,e.prev=n,e.curr=i,n=i;for(var s=new Array(arguments.length),o=0;o<s.length;o++)s[o]=arguments[o];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var l=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;l++;var i=t.formatters[n];if("function"==typeof i){var a=s[l];r=i.call(e,a),s.splice(l,1),l--}return r})),t.formatArgs.call(e,s);var c=r.log||t.log||console.log.bind(console);c.apply(e,s)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length,i=0;i<n;i++)r[i]&&("-"===(e=r[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(4680),t.names=[],t.skips=[],t.formatters={}},4680:e=>{var t=1e3,r=60*t,n=60*r,i=24*n;function a(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,s){s=s||{};var o,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*n;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===l&&!1===isNaN(e))return s.long?a(o=e,i,"day")||a(o,n,"hour")||a(o,r,"minute")||a(o,t,"second")||o+" ms":function(e){return e>=i?Math.round(e/i)+"d":e>=n?Math.round(e/n)+"h":e>=r?Math.round(e/r)+"m":e>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},9283:()=>{},3838:()=>{}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{"use strict";var e=__webpack_require__(7294),t=__webpack_require__(745);class r{constructor(e,t=localStorage){this.storage=t,this.id=`ampcast/${e}`}getItem(e){return this.storage.getItem(`${this.id}/${e}`)}setItem(e,t){this.storage.setItem(`${this.id}/${e}`,null!=t?t:"")}removeItem(e){this.storage.removeItem(`${this.id}/${e}`)}clear(){const e=[];for(let t=0;t<this.storage.length;t++){const r=this.storage.key(t);(null==r?void 0:r.startsWith(`${this.id}/`))&&e.push(r)}e.forEach((e=>this.storage.removeItem(e)))}}const n=new r("layout"),i={get(e,t=0){const r=n.getItem(e);return Number(r)||t},set(e,t){n.setItem(e,String(Number(t)||0))}};function a(t,r){const n=(0,e.useRef)(r);(0,e.useEffect)((()=>{n.current=r}),[r]),(0,e.useLayoutEffect)((()=>{const e=t.current;if(e){const t=new ResizeObserver((()=>n.current()));return t.observe(e),()=>t.disconnect()}}),[t])}const s=document.createElement("div");function o(){const t=(0,e.useRef)(s),[r,n]=(0,e.useState)(0);return(0,e.useEffect)((()=>{s.parentElement||(document.body.append(s),n(l()))}),[]),a(t,(0,e.useCallback)((()=>n(l())),[])),r}function l(){return parseInt(getComputedStyle(s).fontSize,10)||16}function c({vertical:t,primary:r,size:n,children:i}){const a={};return r||(t?a.height=`${n}px`:a.width=`${n}px`),e.createElement("div",{className:"layout-pane layout-pane-"+(r?"primary":"secondary"),style:a},i)}function u({id:t,arrange:r="columns",primaryIndex:n=0,children:s}){const l=(0,e.useRef)(null),[u,h]=(0,e.useState)({width:0,height:0}),[d,f]=(0,e.useState)(0),[m,p]=(0,e.useState)(0),[g,A]=(0,e.useState)(0),[b,v]=(0,e.useState)((()=>t?i.get(t):0)),[y,w]=(0,e.useState)(-1),[E,_]=(0,e.useState)(0),T=-1!==y,x=o(),S="rows"===r;(0,e.useEffect)((()=>{t&&i.set(t,b)}),[t,b]),(0,e.useLayoutEffect)((()=>{var e;if(x>0){const t=l.current,r=S?"minHeight":"minWidth",n=t.querySelector(":scope > .layout-pane-primary");if(n){n.style[r]="";const e=parseInt(getComputedStyle(n)[r],10);n.style[r]="unset",f(e||80)}const i=t.querySelector(":scope > .layout-pane-secondary");if(i){i.style[r]="";const n=parseInt(getComputedStyle(i)[r],10);i.style[r]="unset",p(n||80);const a=S?"offsetHeight":"offsetWidth",s=t.querySelector(":scope > .layout-splitter");A(null!==(e=null==s?void 0:s[a])&&void 0!==e?e:4)}}}),[S,x]),(0,e.useLayoutEffect)((()=>{const e=S?u.height:u.width;if(e>0){const t=e-g-b;t<d?v(Math.max(b-(d-t),0)):b<m&&v(Math.min(e-g-d,m))}}),[S,u,d,m,g,b]);const k=(0,e.useCallback)((e=>{if(0===e.button){const t=S?e.screenY:e.screenX;w(t),_(b),e.preventDefault()}}),[S,b]),I=(0,e.useCallback)((e=>{const t=(S?e.screenY:e.screenX)-y;v(0===n?E-t:E+t)}),[S,n,y,E]),C=(0,e.useCallback)((()=>{w(-1),_(0)}),[]);return(0,e.useEffect)((()=>{if(T)return document.documentElement.style.cursor=S?"ns-resize":"ew-resize",document.body.classList.add("dragging"),document.addEventListener("mouseup",C),document.addEventListener("mousemove",I),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",C),document.removeEventListener("mousemove",I)}}),[S,T,I,C]),a(l,(0,e.useCallback)((()=>{const e=l.current;h({width:e.clientWidth,height:e.clientHeight})}),[])),e.createElement("div",{className:`splitter splitter-${r}`,id:t,ref:l},e.Children.toArray(s).slice(0,2).map(((t,r)=>{const i=r===n,a=i?0:b,s=[];return 1===r&&s.push(e.createElement("div",{className:"layout-splitter "+(T?"active":""),role:"separator",onMouseDown:k,key:"splitter"})),s.push(e.createElement(c,{vertical:S,primary:i,size:a,key:r},t)),s})))}s.style.cssText="\n    position: absolute;\n    pointer-events: none;\n    visibility: hidden;\n    font-size: 1rem;\n    width: 1rem;\n    height: 1rem;\n";var h=function(e,t){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},h(e,t)};function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function f(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return s}function g(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function A(e){return this instanceof A?(this.v=e,this):new A(e)}function b(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),a=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||o(e,t)}))})}function o(e,t){try{(r=i[e](t)).value instanceof A?Promise.resolve(r.value.v).then(l,c):u(a[0][2],r)}catch(e){u(a[0][3],e)}var r}function l(e){o("next",e)}function c(e){o("throw",e)}function u(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}}function v(e){return"function"==typeof e}function y(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Object.create,Object.create;var w=y((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function E(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var _=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,r,n,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var s=m(a),o=s.next();!o.done;o=s.next())o.value.remove(this)}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else a.remove(this);var l=this.initialTeardown;if(v(l))try{l()}catch(e){i=e instanceof w?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var u=m(c),h=u.next();!h.done;h=u.next()){var d=h.value;try{S(d)}catch(e){i=null!=i?i:[],e instanceof w?i=g(g([],p(i)),p(e.errors)):i.push(e)}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}}if(i)throw new w(i)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)S(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&E(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&E(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}(),T=_.EMPTY;function x(e){return e instanceof _||e&&"closed"in e&&v(e.remove)&&v(e.add)&&v(e.unsubscribe)}function S(e){v(e)?e():e.unsubscribe()}var k=null,I=null,C=void 0,P=!1,M=!1,R={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=R.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,g([e,t],p(r))):setTimeout.apply(void 0,g([e,t],p(r)))},clearTimeout:function(e){var t=R.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function B(e){R.setTimeout((function(){if(!k)throw e;k(e)}))}function L(){}var D=N("C",void 0,void 0);function N(e,t,r){return{kind:e,value:t,error:r}}var F=null;function O(e){if(P){var t=!F;if(t&&(F={errorThrown:!1,error:null}),e(),t){var r=F,n=r.errorThrown,i=r.error;if(F=null,n)throw i}}else e()}var z=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,x(t)&&t.add(r)):r.destination=W,r}return d(t,e),t.create=function(e,t,r){return new q(e,t,r)},t.prototype.next=function(e){this.isStopped?X(function(e){return N("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?X(N("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?X(D,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(_),U=Function.prototype.bind;function j(e,t){return U.call(e,t)}var V=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){Q(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){Q(e)}else Q(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){Q(e)}},e}(),q=function(e){function t(t,r,n){var i,a,s=e.call(this)||this;return v(t)||!t?i={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:s&&M?((a=Object.create(t)).unsubscribe=function(){return s.unsubscribe()},i={next:t.next&&j(t.next,a),error:t.error&&j(t.error,a),complete:t.complete&&j(t.complete,a)}):i=t,s.destination=new V(i),s}return d(t,e),t}(z);function Q(e){var t;P?(t=e,P&&F&&(F.errorThrown=!0,F.error=t)):B(e)}function X(e,t){var r=I;r&&R.setTimeout((function(){return r(e,t)}))}var W={closed:!0,next:L,error:function(e){throw e},complete:L},H="function"==typeof Symbol&&Symbol.observable||"@@observable";function G(e){return e}function $(e){return 0===e.length?G:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Y=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this,i=function(e){return e&&e instanceof z||function(e){return e&&v(e.next)&&v(e.error)&&v(e.complete)}(e)&&x(e)}(e)?e:new q(e,t,r);return O((function(){var e=n,t=e.operator,r=e.source;i.add(t?t.call(i,r):r?n._subscribe(i):n._trySubscribe(i))})),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=K(t))((function(t,n){var i=new q({next:function(t){try{e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:t});r.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[H]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return $(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=K(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function K(e){var t;return null!==(t=null!=e?e:C)&&void 0!==t?t:Promise}var J=y((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),Z=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return d(t,e),t.prototype.lift=function(e){var t=new ee(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new J},t.prototype.next=function(e){var t=this;O((function(){var r,n;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=m(t.currentObservers),a=i.next();!a.done;a=i.next())a.value.next(e)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}}))},t.prototype.error=function(e){var t=this;O((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}}))},t.prototype.complete=function(){var e=this;O((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=this,n=r.hasError,i=r.isStopped,a=r.observers;return n||i?T:(this.currentObservers=null,a.push(e),new _((function(){t.currentObservers=null,E(a,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,r=t.hasError,n=t.thrownError,i=t.isStopped;r?e.error(n):i&&e.complete()},t.prototype.asObservable=function(){var e=new Y;return e.source=this,e},t.create=function(e,t){return new ee(e,t)},t}(Y),ee=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return d(t,e),t.prototype.next=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)},t.prototype.error=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:T},t}(Z),te=function(e){function t(t){var r=e.call(this)||this;return r._value=t,r}return d(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},t.prototype.getValue=function(){var e=this,t=e.hasError,r=e.thrownError,n=e._value;if(t)throw r;return this._throwIfClosed(),n},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Z);const re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1H\nAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=";class ne{constructor(e="",t=!1,r=window.console){const n=e?` ${e}:`:"",i=(e,t)=>e&&t?`${e}/${t}`:t||e,a=(...t)=>{e.startsWith(ne.only)&&r.log(...t)};this.log=(...e)=>a(`##${n}`,...e),this.warn=(...e)=>a(`###${n}`,...e),this.error=t=>{e.startsWith(ne.only)&&(a(`####${n} ERROR`),r.error(t))},t&&(this.next=this.log,this.complete=()=>this.log("***complete***")),this.id=n=>new ne(i(e,n),t,r),this.all=t=>new ne(i(e,t),!0,r),this.only=()=>(ne.only=e,this)}}ne.only="";var ie=__webpack_require__(4155),ae=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},se=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},oe=function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"},le=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},ce=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ue=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],he=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function de(e){var t=function(e){return""!==e&&ue.reduce((function(t,r){var n=r[0],i=r[1];if(t)return t;var a=i.exec(e);return!!a&&[n,a]}),!1)}(e);if(!t)return null;var r=t[0],n=t[1];if("searchbot"===r)return new le;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<3&&(i=ae(ae([],i,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-i.length),!0)):i=[];var a=i.join("."),s=function(e){for(var t=0,r=he.length;t<r;t++){var n=he[t],i=n[0];if(n[1].exec(e))return i}return null}(e),o=ce.exec(e);return o&&o[1]?new oe(r,a,s,o[1]):new se(r,a,s)}const fe="undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}:"undefined"!=typeof navigator?de(navigator.userAgent):void 0!==ie&&ie.version?new function(e){this.version=e,this.type="node",this.name="node",this.os=ie.platform}(ie.version.slice(1)):null;const me=(null==fe?void 0:fe.name)||"unknown",pe=/^edge/.test(me)?"Microsoft Edge":me.replace(/^\w/,(e=>e.toUpperCase())),ge={name:me,displayName:pe,version:(null==fe?void 0:fe.version)||"0",os:(null==fe?void 0:fe.os)||"unknown"};function Ae(e){return null!=e}const be={};function ve(e){return t=this,r=void 0,i=function*(){if(!be[e])return new Promise(((t,r)=>{let n=document.querySelector(`script[src="${e}"]`);n||(n=document.createElement("script"),n.async=!0,n.src=e),n.addEventListener("load",(()=>{be[e]=!0,t()})),n.addEventListener("error",(()=>r(`Failed to load script: '${e}'`))),n.parentElement||document.head.appendChild(n)}))},new((n=void 0)||(n=Promise))((function(e,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(t.value).then(s,o)}l((i=i.apply(t,r||[])).next())}));var t,r,n,i}const ye={url:re,width:1,height:1};function we(e=[],t=360,r=1){if(0===e.length)return ye;e.sort(((e,t)=>t.width*t.height-e.width*e.height));const[n,i]=Ee(e,(e=>e.width<=t&&e.height<=t));return n.length>0?(n.sort(((e,t)=>{const n=e.width/e.height,i=Math.abs(n-r),a=t.width/t.height;return i-Math.abs(a-r)})),n[0]):i[i.length-1]||ye}function Ee(e,t){const r=[],n=[];for(const i of e)t(i)?r.push(i):n.push(i);return[r,n]}function _e(e){e.preventDefault()}function Te(e){e.stopPropagation()}function xe(e){return{itemType:e,src:"",title:""}}function Se(e,t,r=0){if(1===e.length)return e[0];const n=e[Math.floor(Math.random()*e.length)];return void 0!==t&&n===t&&r<3?Se(e,t,r++):n}var ke;!function(e){e[e.Media=0]="Media",e[e.Album=1]="Album",e[e.Artist=2]="Artist",e[e.Playlist=3]="Playlist"}(ke||(ke={}));const Ie=ke;function Ce(e){return e&&v(e.schedule)}function Pe(e){return e[e.length-1]}function Me(e){return v(Pe(e))?e.pop():void 0}function Re(e){return Ce(Pe(e))?e.pop():void 0}function Be(e,t){return"number"==typeof Pe(e)?e.pop():t}var Le=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function De(e){return v(null==e?void 0:e.then)}function Ne(e){return v(e[H])}function Fe(e){return Symbol.asyncIterator&&v(null==e?void 0:e[Symbol.asyncIterator])}function Oe(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var ze="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ue(e){return v(null==e?void 0:e[ze])}function je(e){return b(this,arguments,(function(){var t,r,n;return f(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,A(t.read())];case 3:return r=i.sent(),n=r.value,r.done?[4,A(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,A(n)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function Ve(e){return v(null==e?void 0:e.getReader)}function qe(e){if(e instanceof Y)return e;if(null!=e){if(Ne(e))return i=e,new Y((function(e){var t=i[H]();if(v(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(Le(e))return t=e,new Y((function(e){for(var r=0;r<t.length&&!e.closed;r++)e.next(t[r]);e.complete()}));if(De(e))return n=e,new Y((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,B)}));if(Fe(e))return Qe(e);if(Ue(e))return r=e,new Y((function(e){var t,n;try{for(var i=m(r),a=i.next();!a.done;a=i.next()){var s=a.value;if(e.next(s),e.closed)return}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}e.complete()}));if(Ve(e))return Qe(je(e))}var t,r,n,i;throw Oe(e)}function Qe(e){return new Y((function(t){(function(e,t){var r,n,i,a,s,o,l,c;return s=this,o=void 0,c=function(){var s,o;return f(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),r=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=m(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}(e),l.label=1;case 1:return[4,r.next()];case 2:if((n=l.sent()).done)return[3,4];if(s=n.value,t.next(s),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),i={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),n&&!n.done&&(a=r.return)?[4,a.call(r)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((l=void 0)||(l=Promise))((function(e,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function n(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):function(e){return e instanceof l?e:new l((function(t){t(e)}))}(t.value).then(r,n)}i((c=c.apply(s,o||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}function Xe(e,t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var a=t.schedule((function(){r(),i?e.add(this.schedule(null,n)):this.unsubscribe()}),n);if(e.add(a),!i)return a}function We(e){return function(t){if(function(e){return v(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function He(e,t,r,n,i){return new Ge(e,t,r,n,i)}var Ge=function(e){function t(t,r,n,i,a,s){var o=e.call(this,t)||this;return o.onFinalize=a,o.shouldUnsubscribe=s,o._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,o._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,o._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,o}return d(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(z);function $e(e,t){return void 0===t&&(t=0),We((function(r,n){r.subscribe(He(n,(function(r){return Xe(n,e,(function(){return n.next(r)}),t)}),(function(){return Xe(n,e,(function(){return n.complete()}),t)}),(function(r){return Xe(n,e,(function(){return n.error(r)}),t)})))}))}function Ye(e,t){return void 0===t&&(t=0),We((function(r,n){n.add(e.schedule((function(){return r.subscribe(n)}),t))}))}function Ke(e,t){if(!e)throw new Error("Iterable cannot be null");return new Y((function(r){Xe(r,t,(function(){var n=e[Symbol.asyncIterator]();Xe(r,t,(function(){n.next().then((function(e){e.done?r.complete():r.next(e.value)}))}),0,!0)}))}))}function Je(e,t){return t?function(e,t){if(null!=e){if(Ne(e))return function(e,t){return qe(e).pipe(Ye(t),$e(t))}(e,t);if(Le(e))return function(e,t){return new Y((function(r){var n=0;return t.schedule((function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())}))}))}(e,t);if(De(e))return function(e,t){return qe(e).pipe(Ye(t),$e(t))}(e,t);if(Fe(e))return Ke(e,t);if(Ue(e))return function(e,t){return new Y((function(r){var n;return Xe(r,t,(function(){n=e[ze](),Xe(r,t,(function(){var e,t,i;try{t=(e=n.next()).value,i=e.done}catch(e){return void r.error(e)}i?r.complete():r.next(t)}),0,!0)})),function(){return v(null==n?void 0:n.return)&&n.return()}}))}(e,t);if(Ve(e))return function(e,t){return Ke(je(e),t)}(e,t)}throw Oe(e)}(e,t):qe(e)}function Ze(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Re(e);return Je(e,r)}var et=new Y((function(e){return e.complete()}));class tt{constructor(e=[]){this.items=e}get size(){return this.items.length}observeComplete(){return Ze(this.items)}observeItems(){return Ze(this.items)}observeSize(){return Ze(this.items.length)}observeMaxSize(){return Ze(this.items.length)}observeError(){return et}fetchAt(){}disconnect(){}}function rt(e,t){return void 0===t&&(t=G),e=null!=e?e:nt,We((function(r,n){var i,a=!0;r.subscribe(He(n,(function(r){var s=t(r);!a&&e(i,s)||(a=!1,i=s,n.next(r))})))}))}function nt(e,t){return e===t}function it(e,t){return We((function(r,n){var i=0;r.subscribe(He(n,(function(r){n.next(e.call(t,r,i++))})))}))}const at="eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6Ijk3RjI2N1daRDkifQ.eyJpYXQiOjE2NTY3MDUwMjksImV4cCI6MTY3MjI1NzAyOSwiaXNzIjoiODM4Nk5ERlhMQiJ9.P6k3R2eCHfinKym779xE4i9Q2DUpb3k8p_cyhQkO9vIKe3qUKolpnIuJKLOstPw-OdAvuXZFsZMexhpbZyBztA".toString(),st="41bd731be5b78200d2bbaea2312b917b".toString(),ot="78aa93b641329f00e68cf1542356b8fc".toString(),lt="68c1c915728f4b9da193da1028692f0d".toString(),ct="AIzaSyD-cQaU5ntJBcCEBAbmK5pIXD4FQ19fdho".toString(),ut="364143070327-sgopc15lidje8uq4l16k1u8pqo2hpc4o.apps.googleusercontent.com".toString();var ht=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::appleAuth");const dt=new ne("appleAuth"),ft=new te("");function mt(){return ft.pipe(rt()).pipe(it((e=>""!==e)),rt())}function pt(){return ht(this,void 0,void 0,(function*(){if(""===ft.getValue())try{const e=yield At(),t=yield e.authorize();dt.log("Access token successfully obtained."),ft.next(t)}catch(e){dt.log("Could not obtain access token."),dt.error(e)}}))}function gt(){return ht(this,void 0,void 0,(function*(){yield MusicKit.getInstance().unauthorize(),ft.next("")}))}function At(){return ht(this,void 0,void 0,(function*(){return window.MusicKit?MusicKit.getInstance():new Promise(((e,t)=>{ve("https://js-cdn.music.apple.com/musickit/v3/musickit.js").then(void 0,t),document.addEventListener("musickitloaded",(()=>{MusicKit.configure({developerToken:at,app:{name:"ampcast",build:"0.4.11"},sourceType:8,suppressErrorDialog:!0}).then(e,t)}))}))}))}const bt={observeIsLoggedIn:mt,login:pt,logout:gt};var vt;!function(){ht(this,void 0,void 0,(function*(){const e=yield At();if(e.isAuthorized){const t=yield e.authorize();dt.log("Access token successfully obtained."),ft.next(t)}}))}(),function(e){e[e.Audio=0]="Audio",e[e.Video=1]="Video"}(vt||(vt={}));const yt=vt;var wt=Array.isArray,Et=Object.getPrototypeOf,_t=Object.prototype,Tt=Object.keys;function xt(e){if(1===e.length){var t=e[0];if(wt(t))return{args:t,keys:null};if((n=t)&&"object"==typeof n&&Et(n)===_t){var r=Tt(t);return{args:r.map((function(e){return t[e]})),keys:r}}}var n;return{args:e,keys:null}}var St=Array.isArray;function kt(e){return it((function(t){return function(e,t){return St(t)?e.apply(void 0,g([],p(t))):e(t)}(e,t)}))}function It(e,t){return e.reduce((function(e,r,n){return e[r]=t[n],e}),{})}function Ct(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Re(e),n=Me(e),i=xt(e),a=i.args,s=i.keys;if(0===a.length)return Je([],r);var o=new Y(Pt(a,r,s?function(e){return It(s,e)}:G));return n?o.pipe(kt(n)):o}function Pt(e,t,r){return void 0===r&&(r=G),function(n){Mt(t,(function(){for(var i=e.length,a=new Array(i),s=i,o=i,l=function(i){Mt(t,(function(){var l=Je(e[i],t),c=!1;l.subscribe(He(n,(function(e){a[i]=e,c||(c=!0,o--),o||n.next(r(a.slice()))}),(function(){--s||n.complete()})))}),n)},c=0;c<i;c++)l(c)}),n)}}function Mt(e,t,r){e?Xe(r,e,t):t()}function Rt(e,t,r){var n=v(e)||t||r?{next:e,error:t,complete:r}:e;return n?We((function(e,t){var r;null===(r=n.subscribe)||void 0===r||r.call(n);var i=!0;e.subscribe(He(t,(function(e){var r;null===(r=n.next)||void 0===r||r.call(n,e),t.next(e)}),(function(){var e;i=!1,null===(e=n.complete)||void 0===e||e.call(n),t.complete()}),(function(e){var r;i=!1,null===(r=n.error)||void 0===r||r.call(n,e),t.error(e)}),(function(){var e,t;i&&(null===(e=n.unsubscribe)||void 0===e||e.call(n)),null===(t=n.finalize)||void 0===t||t.call(n)})))})):G}function Bt(e,t,r){return void 0===r&&(r=1/0),v(t)?Bt((function(r,n){return it((function(e,i){return t(r,e,n,i)}))(qe(e(r,n)))}),r):("number"==typeof t&&(r=t),We((function(t,n){return function(e,t,r,n,i,a,s,o){var l=[],c=0,u=0,h=!1,d=function(){!h||l.length||c||t.complete()},f=function(e){return c<n?m(e):l.push(e)},m=function(e){c++;var i=!1;qe(r(e,u++)).subscribe(He(t,(function(e){t.next(e)}),(function(){i=!0}),void 0,(function(){if(i)try{c--;for(;l.length&&c<n;)e=void 0,e=l.shift(),m(e);d()}catch(e){t.error(e)}var e})))};return e.subscribe(He(t,f,(function(){h=!0,d()}))),function(){}}(t,n,e,r)})))}function Lt(e){return We((function(t,r){var n,i=null,a=!1;i=t.subscribe(He(r,void 0,void 0,(function(s){n=qe(e(s,Lt(e)(t))),i?(i.unsubscribe(),i=null,n.subscribe(r)):a=!0}))),a&&(i.unsubscribe(),i=null,n.subscribe(r))}))}function Dt(e){return We((function(t,r){qe(e).subscribe(He(r,(function(){return r.complete()}),L)),!r.closed&&t.subscribe(r)}))}function Nt(e){return e<=0?function(){return et}:We((function(t,r){var n=0;t.subscribe(He(r,(function(t){++n<=e&&(r.next(t),e<=n&&r.complete())})))}))}function Ft(e,t){return We((function(r,n){var i=0;r.subscribe(He(n,(function(r){return e.call(t,r,i++)&&n.next(r)})))}))}function Ot(e,t){return We((function(r,n){var i=null,a=0,s=!1,o=function(){return s&&!i&&n.complete()};r.subscribe(He(n,(function(r){null==i||i.unsubscribe();var s=0,l=a++;qe(e(r,l)).subscribe(i=He(n,(function(e){return n.next(t?t(r,e,l,s++):e)}),(function(){i=null,o()})))}),(function(){s=!0,o()})))}))}var zt={now:function(){return(zt.delegate||Date).now()},delegate:void 0},Ut=function(e){function t(t,r,n){void 0===t&&(t=1/0),void 0===r&&(r=1/0),void 0===n&&(n=zt);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=r,i._timestampProvider=n,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=r===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,r),i}return d(t,e),t.prototype.next=function(t){var r=this,n=r.isStopped,i=r._buffer,a=r._infiniteTimeWindow,s=r._timestampProvider,o=r._windowTime;n||(i.push(t),!a&&i.push(s.now()+o)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),r=this._infiniteTimeWindow,n=this._buffer.slice(),i=0;i<n.length&&!e.closed;i+=r?1:2)e.next(n[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,r=e._timestampProvider,n=e._buffer,i=e._infiniteTimeWindow,a=(i?1:2)*t;if(t<1/0&&a<n.length&&n.splice(0,n.length-a),!i){for(var s=r.now(),o=0,l=1;l<n.length&&n[l]<=s;l+=2)o=l;o&&n.splice(0,o+1)}},t}(Z);const jt=[],Vt=new ne("AbstractPager");let qt=0;class Qt{constructor(e){this.items$=new te(jt),this.size$=new Ut(1),this.maxSize$=new Ut(1),this.error$=new Ut(1),this.fetches$=new te({index:0,length:0}),this.disconnected=!1,this.config=Object.assign({},e),(null==e?void 0:e.maxSize)&&this.maxSize$.next(null==e?void 0:e.maxSize)}observeComplete(){return Ct([this.observeItems(),this.observeSize()]).pipe(Ft((([e,t])=>e.reduce((e=>e+1),0)===t)),it((([e])=>e)),Nt(1))}observeItems(){return this.items$.pipe(Ft((e=>e!==jt)))}observeSize(){return this.size$.pipe(rt())}observeMaxSize(){return this.maxSize$.pipe(rt())}observeError(){return this.error$}disconnect(){this.disconnected||(this.disconnected=!0,this.subscriptions&&(this.subscriptions.unsubscribe(),Vt.log("Pager disconnected. connected pagers="+--qt)),this.items.forEach((e=>{var t;return null===(t=e.pager)||void 0===t?void 0:t.disconnect()})),this.items$.complete(),this.size$.complete(),this.maxSize$.complete(),this.error$.complete())}fetchAt(e,t){if(this.disconnected)Vt.warn("disconnected");else{if(!this.subscriptions&&(this.createSubscriptions(),this.config.calculatePageSize)){const{minPageSize:e=10,maxPageSize:r=100}=this.config,n=10*Math.ceil(2*t/10);this.config.pageSize=Math.max(Math.min(n,r),e)}this.fetches$.next({index:e,length:t})}}get items(){return this.items$.getValue()}get maxSize(){var e,t;return null!==(t=null===(e=this.config)||void 0===e?void 0:e.maxSize)&&void 0!==t?t:1/0}createSubscriptions(){this.subscriptions||(Vt.log("Pager connected. connected pagers="+ ++qt),this.subscriptions=new _,this.subscriptions.add(this.observeAdditions().pipe(Rt((e=>this.addPagerDecorations(e)))).subscribe(Vt)))}observeAdditions(){return this.items$.pipe(We((function(e,t){var r,n=!1;e.subscribe(He(t,(function(e){var i=r;r=e,n&&t.next([i,e]),n=!0})))})),it((([e,t])=>t.filter((t=>!e.find((e=>e.src===t.src)))))))}addPagerDecorations(e){e.forEach((e=>{if(e.itemType===Ie.Playlist&&!e.trackCount&&e.pager){const t=e.src;this.subscriptions.add(e.pager.observeSize().pipe(Rt((e=>{const r=this.items.findIndex((e=>e.src===t));if(-1!==r){const t=this.items.slice(),n=t[r];t[r]=Object.assign(Object.assign({},n),{trackCount:e}),this.items$.next(t)}}))).subscribe(Vt))}}))}}const Xt=new ne("SequentialPager");class Wt extends Qt{constructor(e,t){super(t),this.fetchNext=e,this.fetching$=new te(!1),this.emptyCount=0}createSubscriptions(){var e,t;this.subscriptions||(super.createSubscriptions(),this.subscriptions.add(this.observeShouldFetch().pipe(Rt((()=>this.fetching$.next(!0))),(e=()=>this.fetchNext(this.config.pageSize),v(t)?Bt(e,t,1):Bt(e,1)),Rt((e=>this.addPage(e))),Lt((e=>(Xt.error(e),this.error$.next(e),Ze(void 0)))),Rt((()=>this.fetching$.next(!1))),Dt(this.observeComplete()),Nt(100)).subscribe(Xt)))}observeShouldFetch(){const e=Ct([this.fetches$,this.items$]).pipe(it((([{index:e,length:t},r])=>e+2*t>r.length)),Ft((e=>e)),it((()=>{})),Nt(1));return this.fetching$.pipe(Ot((t=>t?et:e)))}addPage(e){const t=(e.items||[]).filter(Ae),r=this.items.concat(t).filter(((e,t,r)=>t===r.findIndex((t=>e.src===t.src))));r.length===this.items.length&&this.emptyCount++,r.length=Math.min(r.length,this.maxSize);const n=e.atEnd||r.length===this.maxSize||this.emptyCount>2?r.length:e.total;void 0!==n&&this.size$.next(n),this.items$.next(r)}}var Ht=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};class Gt{constructor(e,t,r){this.nextPageUrl=void 0,this.pager=new Wt((r=>Ht(this,void 0,void 0,(function*(){const n=yield this.fetchNext(this.nextPageUrl||e,r),i=t(n.data),a=this.createItems(i.items),s=i.total,o=!i.nextPageUrl;return this.nextPageUrl=i.nextPageUrl,{items:a,total:s,atEnd:o}}))),r)}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeMaxSize(){return this.pager.observeMaxSize()}observeSize(){return this.pager.observeSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}fetchNext(e,t){return Ht(this,void 0,void 0,(function*(){const r=MusicKit.getInstance();return t&&!/[?&]limit=/.test(e)&&(e=`${e}${e.includes("?")?"&":"?"}limit=${t}`),r.api.music(e)}))}createItems(e){return e.map((e=>this.createItem(e)))}createItem(e){switch(e.type){case"playlists":case"library-playlists":return this.createMediaPlaylist(e);case"artists":case"library-artists":return this.createMediaArtist(e);case"albums":case"library-albums":return this.createMediaAlbum(e);case"songs":case"library-songs":case"music-videos":return this.createMediaItem(e)}}createMediaPlaylist(e){const t=e.attributes,{id:r,kind:n}=t.playParams||{id:e.id,kind:"playlist"};return Object.assign(Object.assign({},xe(Ie.Playlist)),{src:`apple:${n}:${r}`,externalUrl:t.url,title:t.name,thumbnails:this.createThumbnails(e),apple:{href:e.href},owner:{name:t.curatorName||"",url:""},pager:this.createPager(`${e.href}?include=tracks`),unplayable:!t.playParams})}createMediaArtist(e){var t;const r=e.attributes;return Object.assign(Object.assign({},xe(Ie.Artist)),{src:`apple:artist:${e.id}`,externalUrl:r.url,title:r.name,thumbnails:this.createThumbnails(e),genre:r.genreNames.join(";"),apple:{href:e.href},pager:this.createPager((null===(t=e.relationships)||void 0===t?void 0:t.albums.href)||`/v1/catalog/{{storefrontId}}/artists/${e.id}/albums`)})}createMediaAlbum(e){const t=e.attributes,{id:r,kind:n}=t.playParams||{id:e.id,kind:"album"};return Object.assign(Object.assign({},xe(Ie.Album)),{src:`apple:${n}:${r}`,externalUrl:t.url,title:t.name,thumbnails:this.createThumbnails(e),artist:t.artistName,trackCount:t.trackCount,genre:t.genreNames.join(";"),year:new Date(t.releaseDate).getFullYear()||0,pager:this.createPager(e.href),apple:{href:e.href},unplayable:!t.playParams})}createMediaItem(e){const t=e.attributes,{id:r,kind:n}=t.playParams||{id:e.id,kind:"music-videos"===e.type?"musicVideo":"song"};return Object.assign(Object.assign({},xe(Ie.Media)),{mediaType:"musicVideo"===n?yt.Video:yt.Audio,src:`apple:${n}:${r}`,externalUrl:t.url,title:t.name,thumbnails:this.createThumbnails(e),artist:t.artistName,albumArtist:t.albumName?t.artistName:void 0,album:t.albumName,duration:t.durationInMillis/1e3,genre:t.genreNames.join(";"),disc:t.discNumber,track:t.trackNumber,year:new Date(t.releaseDate).getFullYear()||void 0,apple:{href:e.href},unplayable:!t.playParams})}createThumbnails(e){var t;const r=null===(t=e.attributes)||void 0===t?void 0:t.artwork;return r?[this.createThumbnail(r,60),this.createThumbnail(r,120),this.createThumbnail(r,240),this.createThumbnail(r,480)]:[]}createThumbnail(e,t){return{url:MusicKit.formatArtworkURL(e,t,t),width:t,height:t}}createPager(e,t){return new Gt(e,(e=>{var t,r,n;const i=(null===(r=null===(t=e.data[0])||void 0===t?void 0:t.relationships)||void 0===r?void 0:r.tracks)||e,a=i.data||[],s=i.next;return{items:a,total:null===(n=i.meta)||void 0===n?void 0:n.total,nextPageUrl:s}}),t)}}console.log("module::apple");const $t={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","Duration"]};function Yt(e,t="songs",r){if(e){const n="/v1/catalog/{{storefrontId}}/search",i=new URLSearchParams({term:e,types:t});return new Gt(`${n}?${i}`,(e=>{var r;const n=e.results[t]||{data:[]},i=n.next,a=null===(r=e.meta)||void 0===r?void 0:r.total;return{items:n.data,total:a,nextPageUrl:i}}),Object.assign({maxSize:250,pageSize:25},r))}return new tt}const Kt={id:"apple/video",title:"Music Video",icon:"video",itemType:Ie.Media,searchable:!0,layout:$t,search:e=>e?Yt(e,"music-videos",{maxSize:100}):new tt},Jt={id:"apple/recently-played",title:"Recently Played",icon:"clock",itemType:Ie.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search:()=>new Gt("/v1/me/recent/played/tracks",(e=>{var t;const r=e.data,n=e.next;return{items:r,total:null===(t=e.meta)||void 0===t?void 0:t.total,nextPageUrl:n}}),{pageSize:30})},Zt={id:"apple/liked-songs",title:"Liked Songs",icon:"heart",itemType:Ie.Media,layout:$t,search:()=>new Gt("/v1/me/library/songs",(e=>{var t;const r=e.data,n=e.next;return{items:r,total:null===(t=e.meta)||void 0===t?void 0:t.total,nextPageUrl:n}}))},er={id:"apple/liked-albums",title:"Liked Albums",icon:"heart",itemType:Ie.Album,search:()=>new Gt("/v1/me/library/albums",(e=>{var t;const r=e.data,n=e.next;return{items:r,total:null===(t=e.meta)||void 0===t?void 0:t.total,nextPageUrl:n}}))},tr={id:"apple/playlists",title:"Playlists",icon:"playlists",itemType:Ie.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","TrackCount"]},search:()=>new Gt("/v1/me/library/playlists",(e=>{var t;const r=e.data,n=e.next;return{items:r,total:null===(t=e.meta)||void 0===t?void 0:t.total,nextPageUrl:n}}))};function rr(e,t){return Object.assign(Object.assign({},t),{id:`apple/search/${e}`,icon:"",searchable:!0,search:t=>Yt(t,e)})}const nr={id:"apple",title:"Apple Music",icon:"apple",searches:[rr("songs",{title:"Songs",itemType:Ie.Media,layout:$t}),rr("albums",{title:"Albums",itemType:Ie.Album}),rr("artists",{title:"Artists",itemType:Ie.Artist}),rr("playlists",{title:"Playlists",itemType:Ie.Playlist})],sources:[Kt,Jt,Zt,er,tr],observeIsLoggedIn:mt,login:pt,logout:gt};var ir;!function(e){e[e.Pending=0]="Pending",e[e.Fulfilled=1]="Fulfilled",e[e.Rejected=2]="Rejected"}(ir||(ir={}));const ar=new ne("OffsetPager");class sr extends Qt{constructor(e,t){super(t),this.fetch=e,this.fetchStates={},this.size=0}createSubscriptions(){this.subscriptions||(super.createSubscriptions(),this.subscriptions.add(this.fetches$.pipe(Ft((({index:e})=>this.isInRange(e))),it((({index:e,length:t})=>this.getPageNumbersFromIndex(e,t))),Bt((e=>e)),Bt((e=>this.fetchPage(e))),Lt((e=>(ar.error(e),this.error$.next(e),Ze(void 0)))),Dt(this.observeComplete())).subscribe(ar)))}get pageSize(){return this.config.pageSize||20}fetchPage(e){return t=this,r=void 0,i=function*(){if(this.fetchStates[e]!==ir.Fulfilled&&this.fetchStates[e]!==ir.Pending){this.fetchStates[e]=ir.Pending;try{const t=yield this.fetch(e,this.pageSize);this.fetchStates[e]=ir.Fulfilled,this.insertPage(e,t)}catch(t){throw this.fetchStates[e]=ir.Rejected,t}}},new((n=void 0)||(n=Promise))((function(e,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(t.value).then(s,o)}l((i=i.apply(t,r||[])).next())}));var t,r,n,i}insertPage(e,t){const r=this.items.slice(),n=Math.min(t.total,this.maxSize),i=Math.ceil(n/this.pageSize),a=(e-1)*this.pageSize,s=e===i;if(r.length=s||t.items.length<this.pageSize?a:n,t.items.forEach(((e,t)=>r[t+a]=e)),r.length=Math.min(r.length,n),t.items.length===n)for(let e=0;e<=i;e++)this.fetchStates[e+1]=ir.Fulfilled;this.size=n,this.size$.next(n),this.items$.next(r)}getPageNumbersFromIndex(e,t){const r=this.size,n=Math.max(Math.ceil(this.pageSize/2),t),i=Math.max(e-n,0),a=Math.min(e+n+t-1,0===r?1/0:r-1),s=this.getPageNumberFromIndex(i),o=this.getPageNumberFromIndex(a);if(s===o)return[s];{const e=[];for(let t=s;t<=o;t++)e.push(t);return e}}getPageNumberFromIndex(e){return Math.floor(e/this.pageSize)+1}isInRange(e){return 0===this.size?e>=0:e>=0&&e<this.size}}let or=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"");const lr=new r("jellyfin"),cr={get host(){return lr.getItem("host")||""},set host(e){lr.setItem("host",e)},get device(){return"PC"},get deviceId(){let e=lr.getItem("deviceId");return e||(e=or(),lr.setItem("deviceId",e)),e},get token(){return lr.getItem("token")||""},set token(e){lr.setItem("token",e)},get userId(){return lr.getItem("userId")||""},set userId(e){lr.setItem("userId",e)},clear(){lr.removeItem("userId"),lr.removeItem("token")}};var ur=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};function hr(e,t){return ur(this,void 0,void 0,(function*(){const{device:r,deviceId:n,token:i}=cr;return t.headers=Object.assign(Object.assign({},t.headers),{"X-Emby-Authorization":`MediaBrowser Client="ampcast", Version="0.4.11", Device="${r}", DeviceId="${n}", Token="${i}"`}),window.fetch(`${cr.host}/${e}`,t)}))}console.log("module::jellyfinApi");const dr={get:function(e,t){return ur(this,void 0,void 0,(function*(){return hr(`${e}?${new URLSearchParams(t)}`,{method:"GET"})}))},post:function(e,t){return ur(this,void 0,void 0,(function*(){const r=JSON.stringify(t);return hr(e,{method:"POST",headers:{"Content-Type":"application/json"},body:r})}))},getPlayableUrlFromSrc:function(e){const{host:t,userId:r,token:n,deviceId:i}=cr;if(t&&r&&n&&i){const[,,a]=e.split(":");return`${t}/Audio/${a}/universal?${new URLSearchParams({MaxStreamingBitrate:"140000000",MaxSampleRate:"48000",TranscodingProtocol:"hls",TranscodingContainer:"ts",Container:"opus,webm|opus,mp3,aac,m4a|aac,m4b|aac,flac,webma,webm|webma,wav,ogg",AudioCodec:"aac",static:"true",UserId:r,api_key:n,DeviceId:i})}`}throw Error("Not logged in.")}},fr=dr;class mr{constructor(e,t={}){this.path=e,this.params=t,this.pageSize=mr.minPageSize,this.pager=new sr((e=>this.fetch(e)),{pageSize:this.pageSize})}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeMaxSize(){return this.pager.observeMaxSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}fetch(e){return t=this,r=void 0,i=function*(){const t=Object.assign(Object.assign({IncludeItemTypes:"Audio",Fields:"AudioInfo,Genres",Recursive:"true",ImageTypeLimit:"1",EnableImageTypes:"Primary"},this.params),{Limit:String(this.pageSize),StartIndex:String((e-1)*this.pageSize)}),r=yield fr.get(this.path,t);if(!r.ok)throw Error(`${r.status}: ${r.statusText}`);const{Items:n,TotalRecordCount:i}=yield r.json();return{items:n.map((e=>this.createItem(e))),total:i}},new((n=void 0)||(n=Promise))((function(e,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(t.value).then(s,o)}l((i=i.apply(t,r||[])).next())}));var t,r,n,i}createItem(e){switch(e.Type){case"MusicArtist":return this.createMediaArtist(e);case"MusicAlbum":return this.createMediaAlbum(e);case"Playlist":return this.createMediaPlaylist(e);default:return this.createMediaItemFromTrack(e)}}createMediaArtist(e){var t;return console.log("createMediaItemFromArtist",e),Object.assign(Object.assign({},xe(Ie.Artist)),{src:`jellyfin:album:${e.Id}`,title:e.Name||"",genre:null===(t=e.Genres)||void 0===t?void 0:t.join(";"),thumbnails:this.createThumbnails(e.Id),pager:this.createAlbumsPager(e)})}createMediaAlbum(e){var t,r,n;return console.log("createMediaItemFromAlbum",e),Object.assign(Object.assign({},xe(Ie.Album)),{src:`jellyfin:album:${e.Id}`,title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,playedOn:(null===(t=e.UserData)||void 0===t?void 0:t.LastPlayedDate)?new Date(e.UserData.LastPlayedDate).getTime():void 0,playCount:(null===(r=e.UserData)||void 0===r?void 0:r.PlayCount)||void 0,genre:null===(n=e.Genres)||void 0===n?void 0:n.join(";"),thumbnails:this.createThumbnails(e.Id),trackCount:e.ChildCount||void 0,pager:this.createAlbumPager(e),artist:e.AlbumArtist||void 0,year:e.ProductionYear||void 0})}createMediaPlaylist(e){var t,r,n;return Object.assign(Object.assign({},xe(Ie.Playlist)),{src:`jellyfin:playlist:${e.Id}`,title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,playedOn:(null===(t=e.UserData)||void 0===t?void 0:t.LastPlayedDate)?new Date(e.UserData.LastPlayedDate).getTime():void 0,playCount:(null===(r=e.UserData)||void 0===r?void 0:r.PlayCount)||void 0,genre:null===(n=e.Genres)||void 0===n?void 0:n.join(";"),thumbnails:this.createThumbnails(e.Id),trackCount:e.ChildCount||void 0,pager:this.createPlaylistPager(e)})}createMediaItemFromTrack(e){var t,r,n,i,a;const s=(null===(t=e.ImageTags)||void 0===t?void 0:t.Primary)?e.Id:e.AlbumId;return Object.assign(Object.assign({},xe(Ie.Media)),{mediaType:yt.Audio,src:`jellyfin:audio:${e.Id}`,title:e.Name||"",duration:e.RunTimeTicks?e.RunTimeTicks/1e7:0,year:e.ProductionYear||void 0,playedOn:(null===(r=e.UserData)||void 0===r?void 0:r.LastPlayedDate)?new Date(e.UserData.LastPlayedDate).getTime():void 0,playCount:(null===(n=e.UserData)||void 0===n?void 0:n.PlayCount)||void 0,genre:null===(i=e.Genres)||void 0===i?void 0:i.join(";"),thumbnails:this.createThumbnails(s),artist:(null===(a=e.Artists)||void 0===a?void 0:a.join("/"))||e.AlbumArtist||void 0,albumArtist:e.AlbumArtist||void 0,album:e.Album||void 0,track:e.Album&&e.IndexNumber||0})}createThumbnails(e){return e?[this.createThumbnail(e,60),this.createThumbnail(e,120),this.createThumbnail(e,240),this.createThumbnail(e,480)]:void 0}createThumbnail(e,t,r=t){return{url:`${cr.host}/Items/${e}/Images/Primary?fillWidth=${t}&fillHeight=${r}`,width:t,height:r}}createAlbumPager(e){return new mr(`Users/${cr.userId}/Items`,{ParentId:e.Id,SortBy:"SortName",SortOrder:"Ascending"})}createAlbumsPager(e){return new mr(`Users/${cr.userId}/Items`,{AlbumArtistIds:e.Id,IncludeItemTypes:"MusicAlbum",SortOrder:"Descending"})}createPlaylistPager(e){return new mr(`Playlists/${e.Id}/Items`,{UserId:cr.userId,MediaType:"Audio",Fields:"ChildCount"})}}mr.minPageSize=100,mr.maxPageSize=1e3;var pr=__webpack_require__(3935),gr=window.CustomEvent;function Ar(e,t){var r="on"+t.type.toLowerCase();return"function"==typeof e[r]&&e[r](t),e.dispatchEvent(t)}function br(e){for(;e;){if("dialog"===e.localName)return e;e=e.parentElement?e.parentElement:e.parentNode?e.parentNode.host:null}return null}function vr(e){for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;e&&e.blur&&e!==document.body&&e.blur()}function yr(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1}function wr(e){return!(!e||!e.hasAttribute("method"))&&"dialog"===e.getAttribute("method").toLowerCase()}function Er(e){var t=["button","input","keygen","select","textarea"].map((function(e){return e+":not([disabled])"}));t.push('[tabindex]:not([disabled]):not([tabindex=""])');var r=e.querySelector(t.join(", "));if(!r&&"attachShadow"in Element.prototype)for(var n=e.querySelectorAll("*"),i=0;i<n.length&&!(n[i].tagName&&n[i].shadowRoot&&(r=Er(n[i].shadowRoot)));i++);return r}function _r(e){return e.isConnected||document.body.contains(e)}function Tr(e){if(e.submitter)return e.submitter;var t=e.target;if(!(t instanceof HTMLFormElement))return null;var r=kr.formSubmitter;if(!r){var n=e.target;r=("getRootNode"in n&&n.getRootNode()||document).activeElement}return r&&r.form===t?r:null}function xr(e){if(!e.defaultPrevented){var t=e.target,r=kr.imagemapUseValue,n=Tr(e);null===r&&n&&(r=n.value);var i=br(t);i&&"dialog"===(n&&n.getAttribute("formmethod")||t.getAttribute("method"))&&(e.preventDefault(),null!=r?i.close(r):i.close())}}function Sr(e){if(this.dialog_=e,this.replacedStyleTop_=!1,this.openAsModal_=!1,e.hasAttribute("role")||e.setAttribute("role","dialog"),e.show=this.show.bind(this),e.showModal=this.showModal.bind(this),e.close=this.close.bind(this),e.addEventListener("submit",xr,!1),"returnValue"in e||(e.returnValue=""),"MutationObserver"in window)new MutationObserver(this.maybeHideModal.bind(this)).observe(e,{attributes:!0,attributeFilter:["open"]});else{var t,r=!1,n=function(){r?this.downgradeModal():this.maybeHideModal(),r=!1}.bind(this),i=function(i){if(i.target===e){var a="DOMNodeRemoved";r|=i.type.substr(0,a.length)===a,window.clearTimeout(t),t=window.setTimeout(n,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach((function(t){e.addEventListener(t,i)}))}Object.defineProperty(e,"open",{set:this.setOpen.bind(this),get:e.hasAttribute.bind(e,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("mouseup",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("mousedown",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("click",this.backdropMouseEvent_.bind(this))}gr&&"object"!=typeof gr||((gr=function(e,t){t=t||{};var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail||null),r}).prototype=window.Event.prototype),Sr.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&_r(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),kr.dm.removeDialog(this))},setOpen:function(e){e?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropMouseEvent_:function(e){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var t=document.createElement("div");this.dialog_.insertBefore(t,this.dialog_.firstChild),t.tabIndex=-1,t.focus(),this.dialog_.removeChild(t)}var r=document.createEvent("MouseEvents");r.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),this.dialog_.dispatchEvent(r),e.stopPropagation()},focus_:function(){var e=this.dialog_.querySelector("[autofocus]:not([disabled])");!e&&this.dialog_.tabIndex>=0&&(e=this.dialog_),e||(e=Er(this.dialog_)),vr(document.activeElement),e&&e.focus()},updateZIndex:function(e,t){if(e<t)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=e,this.backdrop_.style.zIndex=t},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!_r(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!kr.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function(e){for(;e&&e!==document.body;){var t=window.getComputedStyle(e),r=function(e,r){return!(void 0===t[e]||t[e]===r)};if(t.opacity<1||r("zIndex","auto")||r("transform","none")||r("mixBlendMode","normal")||r("filter","none")||r("perspective","none")||"isolate"===t.isolation||"fixed"===t.position||"touch"===t.webkitOverflowScrolling)return!0;e=e.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,kr.needsCentering(this.dialog_)?(kr.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(e){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==e&&(this.dialog_.returnValue=e);var t=new gr("close",{bubbles:!1,cancelable:!1});Ar(this.dialog_,t)}};var kr={reposition:function(e){var t=document.body.scrollTop||document.documentElement.scrollTop,r=t+(window.innerHeight-e.offsetHeight)/2;e.style.top=Math.max(t,r)+"px"},isInlinePositionSetByStylesheet:function(e){for(var t=0;t<document.styleSheets.length;++t){var r=document.styleSheets[t],n=null;try{n=r.cssRules}catch(e){}if(n)for(var i=0;i<n.length;++i){var a=n[i],s=null;try{s=document.querySelectorAll(a.selectorText)}catch(e){}if(s&&yr(s,e)){var o=a.style.getPropertyValue("top"),l=a.style.getPropertyValue("bottom");if(o&&"auto"!==o||l&&"auto"!==l)return!0}}}return!1},needsCentering:function(e){return!("absolute"!==window.getComputedStyle(e).position||"auto"!==e.style.top&&""!==e.style.top||"auto"!==e.style.bottom&&""!==e.style.bottom||kr.isInlinePositionSetByStylesheet(e))},forceRegisterDialog:function(e){if((window.HTMLDialogElement||e.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",e),"dialog"!==e.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new Sr(e)},registerDialog:function(e){e.showModal||kr.forceRegisterDialog(e)},DialogManager:function(){this.pendingDialogStack=[];var e=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(t){this.forwardTab_=void 0,t.stopPropagation(),e([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver((function(t){var r=[];t.forEach((function(e){for(var t,n=0;t=e.removedNodes[n];++n)t instanceof Element&&("dialog"===t.localName&&r.push(t),r=r.concat(t.querySelectorAll("dialog")))})),r.length&&e(r)})))}};if(kr.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},kr.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},kr.DialogManager.prototype.updateStacking=function(){for(var e,t=this.zIndexHigh_,r=0;e=this.pendingDialogStack[r];++r)e.updateZIndex(--t,--t),0===r&&(this.overlay.style.zIndex=--t);var n=this.pendingDialogStack[0];n?(n.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},kr.DialogManager.prototype.containedByTopDialog_=function(e){for(;e=br(e);){for(var t,r=0;t=this.pendingDialogStack[r];++r)if(t.dialog===e)return 0===r;e=e.parentElement}return!1},kr.DialogManager.prototype.handleFocus_=function(e){var t=e.composedPath?e.composedPath()[0]:e.target;if(!this.containedByTopDialog_(t)&&document.activeElement!==document.documentElement&&(e.preventDefault(),e.stopPropagation(),vr(t),void 0!==this.forwardTab_)){var r=this.pendingDialogStack[0];return r.dialog.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?r.focus_():t!==document.documentElement&&document.documentElement.focus()),!1}},kr.DialogManager.prototype.handleKey_=function(e){if(this.forwardTab_=void 0,27===e.keyCode){e.preventDefault(),e.stopPropagation();var t=new gr("cancel",{bubbles:!1,cancelable:!0}),r=this.pendingDialogStack[0];r&&Ar(r.dialog,t)&&r.dialog.close()}else 9===e.keyCode&&(this.forwardTab_=!e.shiftKey)},kr.DialogManager.prototype.checkDOM_=function(e){this.pendingDialogStack.slice().forEach((function(t){-1!==e.indexOf(t.dialog)?t.downgradeModal():t.maybeHideModal()}))},kr.DialogManager.prototype.pushDialog=function(e){var t=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=t||(1===this.pendingDialogStack.unshift(e)&&this.blockDocument(),this.updateStacking(),0))},kr.DialogManager.prototype.removeDialog=function(e){var t=this.pendingDialogStack.indexOf(e);-1!==t&&(this.pendingDialogStack.splice(t,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},kr.dm=new kr.DialogManager,kr.formSubmitter=null,kr.imagemapUseValue=null,void 0===window.HTMLDialogElement){var Ir=document.createElement("form");if(Ir.setAttribute("method","dialog"),"dialog"!==Ir.method){var Cr=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(Cr){var Pr=Cr.get;Cr.get=function(){return wr(this)?"dialog":Pr.call(this)};var Mr=Cr.set;Cr.set=function(e){return"string"==typeof e&&"dialog"===e.toLowerCase()?this.setAttribute("method",e):Mr.call(this,e)},Object.defineProperty(HTMLFormElement.prototype,"method",Cr)}}document.addEventListener("click",(function(e){if(kr.formSubmitter=null,kr.imagemapUseValue=null,!e.defaultPrevented){var t=e.target;if("composedPath"in e&&(t=e.composedPath().shift()||t),t&&wr(t.form)){if(!("submit"===t.type&&["button","input"].indexOf(t.localName)>-1)){if("input"!==t.localName||"image"!==t.type)return;kr.imagemapUseValue=e.offsetX+","+e.offsetY}br(t)&&(kr.formSubmitter=t)}}}),!1),document.addEventListener("submit",(function(e){var t=e.target;if(!br(t)){var r=Tr(e);"dialog"===(r&&r.getAttribute("formmethod")||t.getAttribute("method"))&&e.preventDefault()}}));var Rr=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!wr(this))return Rr.call(this);var e=br(this);e&&e.close()}}const Br=kr;const Lr=(0,e.forwardRef)((function(t,r){var{onKeyDown:n}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["onKeyDown"]);const a=(0,e.useCallback)((e=>{" "===e.key&&e.stopPropagation(),null==n||n(e)}),[n]);return e.createElement("button",Object.assign({},i,{onKeyDown:a,ref:r}))}));function Dr({name:t,className:r=""}){switch(r=`icon icon-${t} ${r}`,t){case"play":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"}));case"pause":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"}));case"stop":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"}));case"volume":return e.createElement("svg",{className:r,viewBox:"0 0 16 16"},e.createElement("path",{className:"high medium",d:"M11.536 14.01A8.473 8.473 0 0 0 14.026 8a8.473 8.473 0 0 0-2.49-6.01l-.708.707A7.476 7.476 0 0 1 13.025 8c0 2.071-.84 3.946-2.197 5.303l.708.707z"}),e.createElement("path",{className:"medium",d:"M10.121 12.596A6.48 6.48 0 0 0 12.025 8a6.48 6.48 0 0 0-1.904-4.596l-.707.707A5.483 5.483 0 0 1 11.025 8a5.483 5.483 0 0 1-1.61 3.89l.706.706z"}),e.createElement("path",{d:"M8.707 11.182A4.486 4.486 0 0 0 10.025 8a4.486 4.486 0 0 0-1.318-3.182L8 5.525A3.489 3.489 0 0 1 9.025 8 3.49 3.49 0 0 1 8 10.475l.707.707zM6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06z"}));case"muted":return e.createElement("svg",{className:r,viewBox:"0 0 16 16"},e.createElement("path",{d:"M6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06zm7.137 2.096a.5.5 0 0 1 0 .708L12.207 8l1.647 1.646a.5.5 0 0 1-.708.708L11.5 8.707l-1.646 1.647a.5.5 0 0 1-.708-.708L10.793 8 9.146 6.354a.5.5 0 1 1 .708-.708L11.5 7.293l1.646-1.647a.5.5 0 0 1 .708 0z"}));case"prev":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M64 468V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12v176.4l195.5-181C352.1 22.3 384 36.6 384 64v384c0 27.4-31.9 41.7-52.5 24.6L136 292.7V468c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12z"}));case"next":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M384 44v424c0 6.6-5.4 12-12 12h-48c-6.6 0-12-5.4-12-12V291.6l-195.5 181C95.9 489.7 64 475.4 64 448V64c0-27.4 31.9-41.7 52.5-24.6L312 219.3V44c0-6.6 5.4-12 12-12h48c6.6 0 12 5.4 12 12z"}));case"info":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"}));case"settings":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}));case"locked":return e.createElement("svg",{className:r,viewBox:"0 0 448 512",transform:"scale(0.95)"},e.createElement("path",{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"}));case"unlocked":return e.createElement("svg",{className:r,viewBox:"0 0 576 512",transform:"scale(0.95)"},e.createElement("path",{d:"M423.5 0C339.5.3 272 69.5 272 153.5V224H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48h-48v-71.1c0-39.6 31.7-72.5 71.3-72.9 40-.4 72.7 32.1 72.7 72v80c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24v-80C576 68 507.5-.3 423.5 0z"}));case"left":return e.createElement("svg",{className:r,viewBox:"0 0 320 512"},e.createElement("path",{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"}));case"right":return e.createElement("svg",{className:r,viewBox:"0 0 320 512"},e.createElement("path",{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"}));case"saved":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}));case"unsaved":return e.createElement("svg",{className:r,viewBox:"0 0 448 512"},e.createElement("path",{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM272 80v80H144V80h128zm122 352H54a6 6 0 0 1-6-6V86a6 6 0 0 1 6-6h42v104c0 13.255 10.745 24 24 24h176c13.255 0 24-10.745 24-24V83.882l78.243 78.243a6 6 0 0 1 1.757 4.243V426a6 6 0 0 1-6 6zM224 232c-48.523 0-88 39.477-88 88s39.477 88 88 88 88-39.477 88-88-39.477-88-88-88zm0 128c-22.056 0-40-17.944-40-40s17.944-40 40-40 40 17.944 40 40-17.944 40-40 40z"}));case"close":return e.createElement("svg",{className:r,viewBox:"0 0 64 64"},e.createElement("path",{d:"M 10.5,-0.5 C 12.1667,-0.5 13.8333,-0.5 15.5,-0.5C 20.7971,5.29805 26.2971,10.9647 32,16.5C 37.0314,10.303 42.5314,4.63636 48.5,-0.5C 49.8333,-0.5 51.1667,-0.5 52.5,-0.5C 55.8333,3.5 59.5,7.16667 63.5,10.5C 63.5,11.8333 63.5,13.1667 63.5,14.5C 57.7019,19.7971 52.0353,25.2971 46.5,31C 52.0353,36.7029 57.7019,42.2029 63.5,47.5C 63.5,49.1667 63.5,50.8333 63.5,52.5C 59.5,55.8333 55.8333,59.5 52.5,63.5C 50.8333,63.5 49.1667,63.5 47.5,63.5C 42.1604,57.8275 36.8271,52.1608 31.5,46.5C 25.479,51.8543 19.8123,57.521 14.5,63.5C 13.1667,63.5 11.8333,63.5 10.5,63.5C 7.16667,59.5 3.5,55.8333 -0.5,52.5C -0.5,50.8333 -0.5,49.1667 -0.5,47.5C 5.17254,42.1604 10.8392,36.8271 16.5,31.5C 10.8392,26.1729 5.17254,20.8396 -0.5,15.5C -0.5,13.8333 -0.5,12.1667 -0.5,10.5C 3.5,7.16667 7.16667,3.5 10.5,-0.5 Z"}));case"audio":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.941 97.941l-83.882-83.882A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v416c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48V131.882a48 48 0 0 0-14.059-33.941zM332.118 128H256V51.882L332.118 128zM48 464V48h160v104c0 13.255 10.745 24 24 24h104v288H48zm144-76.024c0 10.691-12.926 16.045-20.485 8.485L136 360.486h-28c-6.627 0-12-5.373-12-12v-56c0-6.627 5.373-12 12-12h28l35.515-36.947c7.56-7.56 20.485-2.206 20.485 8.485v135.952zm41.201-47.13c9.051-9.297 9.06-24.133.001-33.439-22.149-22.752 12.235-56.246 34.395-33.481 27.198 27.94 27.212 72.444.001 100.401-21.793 22.386-56.947-10.315-34.397-33.481z"}));case"video":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.941 97.941l-83.882-83.882A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v416c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48V131.882a48 48 0 0 0-14.059-33.941zM332.118 128H256V51.882L332.118 128zM48 464V48h160v104c0 13.255 10.745 24 24 24h104v288H48zm228.687-211.303L224 305.374V268c0-11.046-8.954-20-20-20H100c-11.046 0-20 8.954-20 20v104c0 11.046 8.954 20 20 20h104c11.046 0 20-8.954 20-20v-37.374l52.687 52.674C286.704 397.318 304 390.28 304 375.986V264.011c0-14.311-17.309-21.319-27.313-11.314z"}));case"note":return e.createElement("svg",{className:r,viewBox:"0 0 24 24",transform:"scale(1.25)"},e.createElement("path",{stroke:"none",d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"}));case"star":return e.createElement("svg",{className:r,viewBox:"0 0 576 512"},e.createElement("path",{d:"M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z"}));case"heart":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M458.4 64.3C400.6 15.7 311.3 23 256 79.3 200.7 23 111.4 15.6 53.6 64.3-21.6 127.6-10.6 230.8 43 285.5l175.4 178.7c10 10.2 23.4 15.9 37.6 15.9 14.3 0 27.6-5.6 37.6-15.8L469 285.6c53.5-54.7 64.7-157.9-10.6-221.3zm-23.6 187.5L259.4 430.5c-2.4 2.4-4.4 2.4-6.8 0L77.2 251.8c-36.5-37.2-43.9-107.6 7.3-150.7 38.9-32.7 98.9-27.8 136.5 10.5l35 35.7 35-35.7c37.8-38.5 97.8-43.2 136.5-10.6 51.1 43.1 43.5 113.9 7.3 150.8z"}));case"thumbs-up":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M466.27 286.69C475.04 271.84 480 256 480 236.85c0-44.015-37.218-85.58-85.82-85.58H357.7c4.92-12.81 8.85-28.13 8.85-46.54C366.55 31.936 328.86 0 271.28 0c-61.607 0-58.093 94.933-71.76 108.6-22.747 22.747-49.615 66.447-68.76 83.4H32c-17.673 0-32 14.327-32 32v240c0 17.673 14.327 32 32 32h64c14.893 0 27.408-10.174 30.978-23.95 44.509 1.001 75.06 39.94 177.802 39.94 7.22 0 15.22.01 22.22.01 77.117 0 111.986-39.423 112.94-95.33 13.319-18.425 20.299-43.122 17.34-66.99 9.854-18.452 13.664-40.343 8.99-62.99zm-61.75 53.83c12.56 21.13 1.26 49.41-13.94 57.57 7.7 48.78-17.608 65.9-53.12 65.9h-37.82c-71.639 0-118.029-37.82-171.64-37.82V240h10.92c28.36 0 67.98-70.89 94.54-97.46 28.36-28.36 18.91-75.63 37.82-94.54 47.27 0 47.27 32.98 47.27 56.73 0 39.17-28.36 56.72-28.36 94.54h103.99c21.11 0 37.73 18.91 37.82 37.82.09 18.9-12.82 37.81-22.27 37.81 13.489 14.555 16.371 45.236-5.21 65.62zM88 432c0 13.255-10.745 24-24 24s-24-10.745-24-24 10.745-24 24-24 24 10.745 24 24z"}));case"most-played":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48z"}),e.createElement("polygon",{points:"130,250 270,325 130,400",strokeWidth:"30",strokeLinejoin:"round"}));case"clock":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"}));case"recently-added":return e.createElement("svg",{className:r,viewBox:"0 0 384 512"},e.createElement("path",{d:"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48z"}),e.createElement("rect",{x:"177",y:"220",width:"40",height:"210",strokeWidth:"20",strokeLinejoin:"round"}),e.createElement("rect",{x:"87",y:"310",width:"210",height:"40",strokeWidth:"20",strokeLinejoin:"round"}));case"playlists":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("path",{d:"M88 48C101.3 48 112 58.75 112 72V120C112 133.3 101.3 144 88 144H40C26.75 144 16 133.3 16 120V72C16 58.75 26.75 48 40 48H88zM480 64C497.7 64 512 78.33 512 96C512 113.7 497.7 128 480 128H192C174.3 128 160 113.7 160 96C160 78.33 174.3 64 192 64H480zM480 224C497.7 224 512 238.3 512 256C512 273.7 497.7 288 480 288H192C174.3 288 160 273.7 160 256C160 238.3 174.3 224 192 224H480zM480 384C497.7 384 512 398.3 512 416C512 433.7 497.7 448 480 448H192C174.3 448 160 433.7 160 416C160 398.3 174.3 384 192 384H480zM16 232C16 218.7 26.75 208 40 208H88C101.3 208 112 218.7 112 232V280C112 293.3 101.3 304 88 304H40C26.75 304 16 293.3 16 280V232zM88 368C101.3 368 112 378.7 112 392V440C112 453.3 101.3 464 88 464H40C26.75 464 16 453.3 16 440V392C16 378.7 26.75 368 40 368H88z"}));case"file":case"blob":return e.createElement("svg",{className:r,viewBox:"0 0 448 512",transform:"scale(0.875)"},e.createElement("path",{fill:"#00cccc",d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"}));case"apple":return e.createElement("svg",{className:r,viewBox:"0 0 24 24",transform:"scale(1.1) translate(0,-1)"},e.createElement("path",{fillRule:"nonzero",d:"M11.624 7.222c-.876 0-2.232-.996-3.66-.96-1.884.024-3.612 1.092-4.584 2.784-1.956 3.396-.504 8.412 1.404 11.172.936 1.344 2.04 2.856 3.504 2.808 1.404-.06 1.932-.912 3.636-.912 1.692 0 2.172.912 3.66.876 1.512-.024 2.472-1.368 3.396-2.724 1.068-1.56 1.512-3.072 1.536-3.156-.036-.012-2.94-1.128-2.976-4.488-.024-2.808 2.292-4.152 2.4-4.212-1.32-1.932-3.348-2.148-4.056-2.196-1.848-.144-3.396 1.008-4.26 1.008zm3.12-2.832c.78-.936 1.296-2.244 1.152-3.54-1.116.048-2.46.744-3.264 1.68-.72.828-1.344 2.16-1.176 3.432 1.236.096 2.508-.636 3.288-1.572z"}));case"plex":return e.createElement("svg",{className:r,viewBox:"0 0 122.88 122.88"},e.createElement("path",{className:"icon-plex-outer",d:"M18.43,0h86.02c10.18,0,18.43,8.25,18.43,18.43v86.02c0,10.18-8.25,18.43-18.43,18.43H18.43 C8.25,122.88,0,114.63,0,104.45l0-86.02C0,8.25,8.25,0,18.43,0L18.43,0z"}),e.createElement("polygon",{className:"icon-plex-inner",points:"61.44,16.8 35.52,16.8 61.44,61.44 35.52,106.08 61.44,106.08 87.36,61.44 61.44,16.8"}));case"jellyfin":return e.createElement("svg",{className:r,viewBox:"0 0 512 512"},e.createElement("defs",null,e.createElement("linearGradient",{id:"jellyfin-linear-gradient",gradientUnits:"userSpaceOnUse",x1:"110.25",y1:"213.3",x2:"496.14",y2:"436.09"},e.createElement("stop",{offset:"0",style:{stopColor:"#aa5cc3"}}),e.createElement("stop",{offset:"1",style:{stopColor:"#00a4dc"}}))),e.createElement("path",{d:"M256,201.6c-20.4,0-86.2,119.3-76.2,139.4s142.5,19.9,152.4,0S276.5,201.6,256,201.6z"}),e.createElement("path",{d:"M256,23.3c-61.6,0-259.8,359.4-229.6,420.1s429.3,60,459.2,0S317.6,23.3,256,23.3z M406.5,390.8c-19.6,39.3-281.1,39.8-300.9,0s110.1-275.3,150.4-275.3S426.1,351.4,406.5,390.8z"}));case"spotify":return e.createElement("svg",{className:r,viewBox:"0 0 168 168"},e.createElement("path",{stroke:"none",d:"m83.996 0.277c-46.249 0-83.743 37.493-83.743 83.742 0 46.251 37.494 83.741 83.743 83.741 46.254 0 83.744-37.49 83.744-83.741 0-46.246-37.49-83.738-83.745-83.738l0.001-0.004zm38.404 120.78c-1.5 2.46-4.72 3.24-7.18 1.73-19.662-12.01-44.414-14.73-73.564-8.07-2.809 0.64-5.609-1.12-6.249-3.93-0.643-2.81 1.11-5.61 3.926-6.25 31.9-7.291 59.263-4.15 81.337 9.34 2.46 1.51 3.24 4.72 1.73 7.18zm10.25-22.805c-1.89 3.075-5.91 4.045-8.98 2.155-22.51-13.839-56.823-17.846-83.448-9.764-3.453 1.043-7.1-0.903-8.148-4.35-1.04-3.453 0.907-7.093 4.354-8.143 30.413-9.228 68.222-4.758 94.072 11.127 3.07 1.89 4.04 5.91 2.15 8.976v-0.001zm0.88-23.744c-26.99-16.031-71.52-17.505-97.289-9.684-4.138 1.255-8.514-1.081-9.768-5.219-1.254-4.14 1.08-8.513 5.221-9.771 29.581-8.98 78.756-7.245 109.83 11.202 3.73 2.209 4.95 7.016 2.74 10.733-2.2 3.722-7.02 4.949-10.73 2.739z"}));case"lastfm":return e.createElement("svg",{className:r,viewBox:"0 0 455 455"},e.createElement("rect",{className:"icon-lastfm-inner",x:"5",y:"5",width:"445",height:"445"}),e.createElement("path",{className:"icon-lastfm-outer",fillRule:"evenodd",clipRule:"evenodd",d:"M0,0v455h455V0H0z M309.94,315.01c-62.425,0-84.085-28.145-95.625-63.145 L202.77,215.77c-8.65-26.33-18.75-46.915-50.505-46.915c-22.035,0-44.395,15.88-44.395,60.275c0,34.63,17.695,56.29,42.575,56.29 c28.145,0,46.915-20.94,46.915-20.94l11.565,31.385c0,0-19.495,19.125-60.275,19.125c-50.51,0-78.65-29.57-78.65-84.435 c0-56.99,28.14-90.565,81.19-90.565c47.99,0,72.165,17.325,87.305,64.235L250.41,240.3c8.65,26.35,23.805,45.47,60.25,45.47 c24.555,0,37.52-5.41,37.52-18.77c0-10.45-6.13-18.025-24.53-22.365l-24.53-5.76c-29.94-7.225-41.855-22.735-41.855-47.265 c0-39.335,31.755-51.6,64.215-51.6c36.82,0,59.18,13.34,62.07,45.82l-36.07,4.335c-1.445-15.53-10.82-22.015-28.145-22.015 c-15.88,0-25.625,7.21-25.625,19.475c0,10.84,4.685,17.325,20.565,20.94l23.085,5.055c31.035,7.21,47.64,22.365,47.64,51.585 C385,301.295,354.685,315.01,309.94,315.01z"}));case"youtube":return e.createElement("svg",{className:r,viewBox:"0 0 576 512",transform:"scale(1.125)"},e.createElement("rect",{className:"icon-youtube-inner",x:"144",y:"128",width:"288",height:"256"}),e.createElement("path",{className:"icon-youtube-outer",d:"M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"}))}}const Nr={left:0,top:0},Fr=(0,e.forwardRef)((function({title:t,className:r="",children:n,onClose:i,target:a="system"},s){const o=(0,e.useRef)(null),[l,c]=(0,e.useState)(Nr),[u,h]=(0,e.useState)(null),[d,f]=(0,e.useState)(Nr);(0,e.useImperativeHandle)(s,(()=>({close:e=>{o.current.open&&o.current.close(e)}}))),(0,e.useEffect)((()=>{const e=o.current;Br.registerDialog(e),e.showModal()}),[]);const m=(0,e.useCallback)((()=>{o.current.close()}),[]),p=(0,e.useCallback)((()=>{i(o.current.returnValue)}),[i]),g=(0,e.useCallback)((e=>{const t=e.target;"submit"===t.type&&"#cancel"===t.value&&(e.preventDefault(),o.current.close())}),[]),A=(0,e.useCallback)((e=>{e.preventDefault(),0===e.button&&h({left:e.screenX,top:e.screenY})}),[]),b=(0,e.useCallback)((e=>{f({left:e.screenX-u.left,top:e.screenY-u.top})}),[u]),v=(0,e.useCallback)((e=>{c({left:l.left+(e.screenX-u.left),top:l.top+(e.screenY-u.top)}),f(Nr),h(null)}),[l,u]);return(0,e.useEffect)((()=>{if(u)return document.documentElement.style.cursor="default",document.body.classList.add("dragging"),document.addEventListener("mouseup",v),document.addEventListener("mousemove",b),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",v),document.removeEventListener("mousemove",b)}}),[u,b,v]),pr.createPortal(e.createElement("dialog",{className:`dialog ${r}`,onClose:p,style:{transform:`translate(${l.left+d.left}px, ${l.top+d.top}px)`},ref:o},e.createElement("header",{className:"dialog-head",onMouseDown:A},e.createElement("h2",null,t),e.createElement(Lr,{onClick:m,onMouseDown:Te},e.createElement(Dr,{name:"close"}))),e.createElement("div",{className:"dialog-body",onClick:g},n)),document.getElementById(a))}));function Or(t,r){const[n,i]=(0,e.useState)(!1),a=(0,e.useCallback)((()=>i(!0)),[]),s=(0,e.useCallback)((()=>i(!1)),[]);return[n?e.createElement(t,{onClose:s,target:r}):null,a]}function zr(r){return n=this,i=void 0,s=function*(){return new Promise(((n,i)=>{const a=document.createElement("div"),s=(0,t.s)(a);try{const t=e=>{s.unmount(),a.remove(),n(e)};document.body.append(a),s.render(e.createElement(r,{onClose:t}))}catch(e){s.unmount(),a.remove(),i(e)}}))},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof a?e:new a((function(t){t(e)}))}(t.value).then(r,o)}l((s=s.apply(n,i||[])).next())}));var n,i,a,s}const Ur=(0,e.forwardRef)((function(t,r){var{onKeyDown:n}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["onKeyDown"]);const a=(0,e.useCallback)((e=>{" "===e.key&&e.stopPropagation(),null==n||n(e)}),[n]);return e.createElement("input",Object.assign({},i,{onKeyDown:a,ref:r}))}));var jr=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};function Vr(t){const r=(0,e.useRef)(null),n=(0,e.useRef)(null),i=(0,e.useRef)(null),a=(0,e.useRef)(null),s=(0,e.useCallback)((()=>jr(this,void 0,void 0,(function*(){try{const e=i.current.value,t=a.current.value;cr.host=n.current.value;const{device:s,deviceId:o}=cr,l=`MediaBrowser Client="ampcast", Version="0.4.11", Device="${s}", DeviceId="${o}"`,c=yield fetch(`${cr.host}/Users/AuthenticateByName`,{method:"POST",headers:{"Content-Type":"application/json","X-Emby-Authorization":l},body:JSON.stringify({Username:e,Pw:t})});if(!c.ok)throw Error(`${c.status}: ${c.statusText}`);const u=yield c.json(),h=u.User.Id,d=u.AccessToken;r.current.close(JSON.stringify({userId:h,token:d}))}catch(e){console.error(e)}}))),[]),o=(0,e.useCallback)((e=>jr(this,void 0,void 0,(function*(){"Enter"===e.key&&(e.preventDefault(),e.repeat||(yield s()))}))),[s]);return e.createElement(Fr,Object.assign({},t,{className:"jellyfin-login-dialog",title:"Login to Jellyfin",ref:r}),e.createElement("form",{method:"dialog",onKeyDown:o},e.createElement("p",null,e.createElement("label",{htmlFor:"jellyfin-host"},"Host:"),e.createElement(Ur,{type:"url",id:"jellyfin-host",defaultValue:cr.host,ref:n})),e.createElement("p",null,e.createElement("label",{htmlFor:"jellyfin-username"},"User:"),e.createElement(Ur,{type:"text",id:"jellyfin-username",autoFocus:!0,ref:i})),e.createElement("p",null,e.createElement("label",{htmlFor:"jellyfin-password"},"Password:"),e.createElement(Ur,{type:"password",id:"jellyfin-password",ref:a})),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel"},"Cancel"),e.createElement(Lr,{type:"button",onClick:s},"Login"))))}var qr=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::jellyfinAuth");const Qr=new ne("jellyfinAuth"),Xr=new te("");function Wr(e){e&&Qr.log("Access token successfully obtained."),cr.token=e,Xr.next(e)}function Hr(e){return Ft((function(t,r){return e<=r}))}Wr(cr.token);var Gr=["addListener","removeListener"],$r=["addEventListener","removeEventListener"],Yr=["on","off"];function Kr(e,t,r,n){if(v(r)&&(n=r,r=void 0),n)return Kr(e,t,r).pipe(kt(n));var i=p(function(e){return v(e.addEventListener)&&v(e.removeEventListener)}(e)?$r.map((function(n){return function(i){return e[n](t,i,r)}})):function(e){return v(e.addListener)&&v(e.removeListener)}(e)?Gr.map(Jr(e,t)):function(e){return v(e.on)&&v(e.off)}(e)?Yr.map(Jr(e,t)):[],2),a=i[0],s=i[1];if(!a&&Le(e))return Bt((function(e){return Kr(e,t,r)}))(qe(e));if(!a)throw new TypeError("Invalid event target");return new Y((function(e){var t=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.next(1<t.length?t:t[0])};return a(t),function(){return s(t)}}))}function Jr(e,t){return function(r){return function(n){return e[r](t,n)}}}function Zr(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Me(e);return We((function(t,n){for(var i=e.length,a=new Array(i),s=e.map((function(){return!1})),o=!1,l=function(t){qe(e[t]).subscribe(He(n,(function(e){a[t]=e,o||s[t]||(s[t]=!0,(o=s.every(G))&&(s=null))}),L))},c=0;c<i;c++)l(c);t.subscribe(He(n,(function(e){if(o){var t=g([e],p(a));n.next(r?r.apply(void 0,g([],p(t))):t)}})))}))}var en=function(e){function t(t,r){return e.call(this)||this}return d(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(_),tn={setInterval:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=tn.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,g([e,t],p(r))):setInterval.apply(void 0,g([e,t],p(r)))},clearInterval:function(e){var t=tn.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},rn=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return d(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(n,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),tn.setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;tn.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r,n=!1;try{this.work(e)}catch(e){n=!0,r=e||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,E(n,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(en),nn=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=zt.now,e}(),an=function(e){function t(t,r){void 0===r&&(r=nn.now);var n=e.call(this,t,r)||this;return n.actions=[],n._active=!1,n._scheduled=void 0,n}return d(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},t}(nn),sn=new an(rn),on=sn;function ln(e){return new Promise(((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)}))}function cn(e,t){const r=indexedDB.open(e);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=ln(r);return(e,r)=>n.then((n=>r(n.transaction(t,e).objectStore(t))))}let un;function hn(){return un||(un=cn("keyval-store","keyval")),un}function dn(e,t=hn()){return t("readonly",(t=>ln(t.get(e))))}function fn(e,t,r=hn()){return r("readwrite",(r=>(r.put(t,e),ln(r.transaction))))}var mn=__webpack_require__(2463);const pn=new r("playlist"),gn={allowDuplicates:!0,showLineNumbers:!0,zeroPadLineNumbers:!0,showSourceIcons:!0},An=new te(function(){try{const e=pn.getItem("settings");return e?JSON.parse(e):gn}catch(e){return console.error(e),gn}}()),bn=function(){return An},vn=function(){return An.getValue()},yn=function(e){pn.setItem("settings",JSON.stringify(e)),An.next(e)};var wn=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::playlist");const En=cn("ampcast/playlist","keyval"),_n=[],Tn=new te(_n),xn=new te("");function Sn(){var e;return wn(this,void 0,void 0,(function*(){if(Tn.getValue()===_n){const t=null!==(e=yield dn("items",En))&&void 0!==e?e:[];Tn.next(t)}return Tn.getValue()}))}function kn(e){return wn(this,void 0,void 0,(function*(){e=e.concat(),yield fn("items",e,En),Tn.next(e),0!==e.length&&((yield In())||Cn(e[0].id))}))}function In(){return wn(this,void 0,void 0,(function*(){return xn.getValue()}))}function Cn(e){return wn(this,void 0,void 0,(function*(){yield fn("currently-playing-id",e,En),xn.next(e)}))}function Pn(e){return wn(this,void 0,void 0,(function*(){yield Cn(e.id)}))}function Mn(){return xn.pipe(Zr(Tn),it((([e,t])=>{var r;return null!==(r=t.find((t=>t.id===e)))&&void 0!==r?r:null})),rt())}function Rn(e){return wn(this,void 0,void 0,(function*(){const t=yield In();if(t){const r=yield Sn(),n=r.findIndex((e=>e.id===t));if(-1!==n){const t=r[n+e];t&&(yield Pn(t))}}}))}function Bn(e,t){return wn(this,void 0,void 0,(function*(){const r=yield Sn(),n=vn().allowDuplicates;let i=yield function(e){return wn(this,void 0,void 0,(function*(){let t=[];if(Array.isArray(e))if(On(e[0])){const r=yield Promise.all(e.map(Dn));for(const e of r)t=t.concat(e)}else t=yield Promise.all(e.map(Nn));else t=On(e)?yield Dn(e):e instanceof FileList?yield Promise.all(Array.from(e).map(Fn)):[yield Nn(e)];return t.filter(Ae)}))}(e);if(n||(i=i.filter((e=>-1===r.findIndex((t=>t.src===e.src))))),i.length>0){const e=i.map((e=>Object.assign(Object.assign({},e),{id:or()})));t>=0&&t<r.length?(r.splice(t,0,...e),yield kn(r)):yield kn(r.concat(e))}}))}function Ln(e){return wn(this,void 0,void 0,(function*(){const t=yield Sn(),r=Array.isArray(e)?e:[e],n=t.filter((e=>!r.includes(e)));if(n.length!==t.length){const e=yield In(),t=n.findIndex((t=>t.id===e));-1===t&&(yield Cn("")),yield kn(n)}}))}function Dn(e){return wn(this,void 0,void 0,(function*(){return new Promise(((t,r)=>{const n=e.pager.observeItems(),i=e.pager.observeError();n.pipe(Dt(i),Nt(1)).subscribe(t),i.pipe(Dt(n),Nt(1)).subscribe(r),e.pager.fetchAt(0,1e3)}))}))}function Nn(e){return wn(this,void 0,void 0,(function*(){return e instanceof File?/^(audio|video)/.test(e.type)?Fn(e):null:e}))}function Fn(e){var t,r,n,i;return wn(this,void 0,void 0,(function*(){let a;try{a=yield(0,mn.Aj)(e,{duration:!0,skipCovers:!0})}catch(t){console.log(`Error parsing file: ${e.name}`),console.log(`music-metadata says: ${t}`),a={format:{},common:{}}}const{common:s,format:o}=a,l=e.type.startsWith("video"),c=o.duration||(yield function(e){return wn(this,void 0,void 0,(function*(){return new Promise((t=>{const r=e.type.startsWith("video"),n=document.createElement(r?"video":"audio"),i=URL.createObjectURL(e),a=()=>{const e=n.error?0:n.duration;n.ondurationchange=null,n.onerror=null,n.src="",n.removeAttribute("src"),URL.revokeObjectURL(i),t(e)};n.ondurationchange=a,n.onerror=a,n.onended=a,n.muted=!0,n.src=i}))}))}(e)),u=(e=0)=>Math.floor(Number(e))||0;return Object.assign(Object.assign({},xe(Ie.Media)),{mediaType:l?yt.Video:yt.Audio,src:`blob:${or()}`,title:s.title||e.name.replace(/\.\w+$/,""),artist:s.artist||(null===(t=s.artists)||void 0===t?void 0:t.join(";"))||"",albumArtist:s.album&&s.albumartist||"",album:s.album||"",genre:(null===(r=s.genre)||void 0===r?void 0:r.join(";"))||"",duration:c?Number(c.toFixed(3)):0,track:u(null===(n=s.track)||void 0===n?void 0:n.no),disc:u(null===(i=s.disk)||void 0===i?void 0:i.no),bpm:u(s.bpm),year:u(s.year),mood:s.mood||"",rating:Number(s.rating)||0,blob:e})}))}function On(e){return"itemType"in e&&e.itemType===Ie.Album}const zn={observe:function(){return Tn},observeCurrentItem:Mn,observeCurrentIndex:function(){return xn.pipe(Zr(Tn),it((([e,t])=>t.findIndex((t=>t.id===e)))),rt())},observeSize:function(){return Tn.pipe(it((e=>e.length)),rt())},getCurrentItem:function(){return wn(this,void 0,void 0,(function*(){const e=yield In();return e&&(yield Sn()).find((t=>t.id===e))||null}))},setCurrentItem:Pn,add:function(e){return wn(this,void 0,void 0,(function*(){yield Bn(e,-1)}))},clear:function(){return wn(this,void 0,void 0,(function*(){yield kn([])}))},insertAt:Bn,moveSelection:function(e,t){return wn(this,void 0,void 0,(function*(){const r=yield Sn(),n=r[t];if(e.includes(n))return;const i=r.filter((t=>!e.includes(t))),a=i.indexOf(n);a>=0?(i.splice(a,0,...e),yield kn(i)):yield kn(i.concat(e))}))},next:function(){return wn(this,void 0,void 0,(function*(){yield Rn(1)}))},prev:function(){return wn(this,void 0,void 0,(function*(){yield Rn(-1)}))},remove:Ln,removeAt:function(e){return wn(this,void 0,void 0,(function*(){const t=yield function(e){var t;return wn(this,void 0,void 0,(function*(){const r=yield Sn();return null!==(t=r[e])&&void 0!==t?t:null}))}(e);t&&(yield Ln(t))}))},shuffle:function(){return wn(this,void 0,void 0,(function*(){const e=yield Sn();let t=e.length;for(;t>0;){const r=Math.floor(Math.random()*t);t--;const n=e[t];e[t]=e[r],e[r]=n}yield kn(e)}))}},Un=zn;wn(void 0,void 0,void 0,(function*(){var e;yield Sn();const t=null!==(e=yield dn("currently-playing-id",En))&&void 0!==e?e:"";xn.next(t)}));var jn={leading:!0,trailing:!1};function Vn(e,t,r){void 0===e&&(e=0),void 0===r&&(r=on);var n=-1;return null!=t&&(Ce(t)?r=t:n=t),new Y((function(t){var i=function(e){return e instanceof Date&&!isNaN(e)}(e)?+e-r.now():e;i<0&&(i=0);var a=0;return r.schedule((function(){t.closed||(t.next(a++),0<=n?this.schedule(void 0,n):t.complete())}),i)}))}function qn(e,t,r){void 0===t&&(t=sn),void 0===r&&(r=jn);var n=Vn(e,t);return function(e,t){return void 0===t&&(t=jn),We((function(e,r){var i=t.leading,a=t.trailing,s=!1,o=null,l=null,c=!1,u=function(){null==l||l.unsubscribe(),l=null,a&&(f(),c&&r.complete())},h=function(){l=null,c&&r.complete()},d=function(e){return l=qe(n).subscribe(He(r,u,h))},f=function(){if(s){s=!1;var e=o;o=null,r.next(e),!c&&d()}};e.subscribe(He(r,(function(e){s=!0,o=e,(!l||l.closed)&&(i?f():d())}),(function(){c=!0,(!(a&&s&&l)||l.closed)&&r.complete()})))}))}(0,r)}console.log("module::playback");const Qn=new te({currentItem:null,currentTime:0,startedAt:0,endedAt:0,duration:0,paused:!0});function Xn(){return Qn}function Wn(){return Xn().pipe(Ft((e=>0!==e.startedAt)),rt(((e,t)=>e.startedAt===t.startedAt)))}function Hn(){return Xn().pipe(Ft((e=>0!==e.endedAt)),rt(((e,t)=>e.endedAt===t.endedAt)))}function Gn(){const e=Qn.getValue();e.startedAt&&(e.endedAt||Qn.next(Object.assign(Object.assign({},e),{endedAt:Date.now()})),Qn.next(Object.assign(Object.assign({},e),{startedAt:0,endedAt:0})))}Mn().subscribe((e=>{Gn(),Qn.next(Object.assign(Object.assign({},Qn.getValue()),{currentItem:e,currentTime:0,duration:(null==e?void 0:e.duration)||0,startedAt:0,endedAt:0}))}));const $n={get paused(){return Qn.getValue().paused},observeState:Xn,observePlaybackStart:Wn,observePlaybackEnd:Hn,observePlaybackProgress:function(e=1e4){return Wn().pipe(Ot((()=>Xn().pipe(qn(e,void 0,{trailing:!0}),Dt(Hn())))))},observeCurrentTime:function(){return Xn().pipe(it((e=>e.currentTime)),rt())},observeDuration:function(){return Xn().pipe(it((e=>e.duration)),rt())},observePaused:function(){return Xn().pipe(it((e=>e.paused)),rt())},getCurrentTime:function(){return Qn.getValue().currentTime},setCurrentTime:function(e){const t=Qn.getValue();(e=Math.max(Math.min(Math.floor(isFinite(e)?e:0),t.duration),0))!==t.currentTime&&Qn.next(Object.assign(Object.assign({},t),{currentTime:e}))},getDuration:function(){return Qn.getValue().duration},setDuration:function(e){const t=Qn.getValue();if((e=Math.max(Math.floor(isFinite(e)?e:0),0))!==t.duration){const r=Math.min(t.currentTime,e);Qn.next(Object.assign(Object.assign({},t),{duration:e,currentTime:r}))}},play:function(){const e=Qn.getValue();e.currentItem&&e.paused&&Qn.next(Object.assign(Object.assign({},e),{paused:!1}))},pause:function(){const e=Qn.getValue();e.paused||Qn.next(Object.assign(Object.assign({},e),{paused:!0}))},stop:function(){const e=Qn.getValue();if(!e.paused||0!==e.currentTime||0!==e.startedAt&&0===e.endedAt){const t=Object.assign(Object.assign({},e),{paused:!0,currentTime:0,endedAt:e.endedAt||(e.startedAt?Date.now():0)});Qn.next(t),e.startedAt&&Qn.next(Object.assign(Object.assign({},t),{startedAt:0,endedAt:0}))}},started:function(){const e=Qn.getValue();e.startedAt||Qn.next(Object.assign(Object.assign({},e),{startedAt:Date.now()}))},ended:Gn},Yn=$n;console.log("module::audio");const Kn=new AudioContext,Jn=new AnalyserNode(Kn,{fftSize:2048,smoothingTimeConstant:0});let Zn,ei;Jn.connect(Kn.destination);const ti=new te(Kn.createMediaElementSource(new Audio));function ri(){return ti.pipe(rt())}function ni(e){return void 0===e&&(e=1/0),Bt(G,e)}function ii(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Re(e),n=Be(e,1/0),i=e;return i.length?1===i.length?qe(i[0]):ni(n)(Je(i,r)):et}Wn().subscribe((({currentItem:e})=>{if(e.src.startsWith("apple:")){if(!ei){const e=document.querySelector("audio#apple-music-player");e&&(ei=Kn.createMediaElementSource(e))}ei&&ti.next(ei)}else{if(!Zn){const e=document.querySelector("audio.html5-audio");e&&(Zn=Kn.createMediaElementSource(e))}Zn&&ti.next(Zn)}})),ri().pipe(Hr(1)).subscribe((e=>e.connect(Jn)));var ai,si,oi=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},li=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};class ci{constructor(e,t,r){this.players=e,this.selectPlayer=t,this.loadPlayer=r,this.player$=new te(null),this.error$=new Z,ai.set(this,!1),si.set(this,!1),e.forEach((e=>{e.autoplay=!1,e.muted=!0,e.hidden=!0}))}get hidden(){return oi(this,ai,"f")}set hidden(e){li(this,ai,e,"f"),this.currentPlayer&&(this.currentPlayer.hidden=e)}get autoplay(){return this.players[0].autoplay}set autoplay(e){this.players.forEach((t=>t.autoplay=e))}get loop(){return this.players[0].loop}set loop(e){this.players.forEach((t=>t.loop=e))}get muted(){return oi(this,si,"f")}set muted(e){li(this,si,e,"f"),this.currentPlayer&&(this.currentPlayer.muted=e)}get volume(){return this.players[0].volume}set volume(e){this.players.forEach((t=>t.volume=e))}observeCurrentTime(){return this.observeCurrentPlayer().pipe(Ot((e=>e?e.observeCurrentTime():Ze(0))),rt())}observeDuration(){return this.observeCurrentPlayer().pipe(Ot((e=>e?e.observeDuration():Ze(0))),rt())}observeEnded(){return this.observeCurrentPlayer().pipe(Ot((e=>e?e.observeEnded():et)))}observeError(){return this.observeCurrentPlayer().pipe(Ot((e=>e?ii(this.error$,e.observeError()):et)))}observePlaying(){return this.observeCurrentPlayer().pipe(Ot((e=>e?e.observePlaying():et)))}appendTo(e){this.players.forEach((t=>t.appendTo(e)))}load(e){const t=this.currentPlayer,r=this.selectPlayer(e);if(t&&t!==r&&(t.muted=!0,t.hidden=!0,t.stop()),this.player$.next(r),r)try{this.loadPlayer(r,e),r.muted=this.muted,r.hidden=this.hidden}catch(e){this.error$.next(e)}else this.error$.next(Error("No player found."))}play(){var e;this.autoplay=!0,null===(e=this.currentPlayer)||void 0===e||e.play()}pause(){this.autoplay=!1,this.players.forEach((e=>e.pause()))}stop(){this.autoplay=!1,this.players.forEach((e=>e.stop()))}seek(e){var t;null===(t=this.currentPlayer)||void 0===t||t.seek(e)}resize(e,t){e*t>0&&this.players.forEach((r=>r.resize(e,t)))}get currentPlayer(){return this.player$.getValue()}observeCurrentPlayer(){return this.player$.pipe(rt())}}function ui(e){return We((function(t,r){var n=!1,i=0;t.subscribe(He(r,(function(t){return(n||(n=!e(t,i++)))&&r.next(t)})))}))}ai=new WeakMap,si=new WeakMap;var hi=__webpack_require__(1062),di=__webpack_require__.n(hi),fi=__webpack_require__(6998),mi=__webpack_require__.n(fi),pi=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::youtubeAuth");const gi=new ne("youtubeAuth"),Ai="https://www.googleapis.com/auth/youtube.readonly",bi=["https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest"],vi=new te("");function yi(){return vi.getValue()}function wi(){return pi(this,void 0,void 0,(function*(){if(""===yi())try{const e=yield function(){return pi(this,void 0,void 0,(function*(){const e=yield Ei();return new Promise(((t,r)=>{e.initTokenClient({client_id:ut,scope:Ai,callback:e=>{e.error?r(e.error_description):(vi.next(e.access_token),t(e.access_token))}}).requestAccessToken()}))}))}();vi.next(e),gi.log("Access token successfully obtained.")}catch(e){gi.log("Could not obtain access token."),gi.error(e)}}))}function Ei(){var e,t;return pi(this,void 0,void 0,(function*(){return(null===(t=null===(e=window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.oauth2)||(yield ve("https://accounts.google.com/gsi/client")),google.accounts.oauth2}))}!function(){pi(this,void 0,void 0,(function*(){const e=(yield function(){return pi(this,void 0,void 0,(function*(){const e=yield function(){return pi(this,void 0,void 0,(function*(){return window.gapi||(yield ve("https://apis.google.com/js/api.js")),window.gapi}))}();return e.client?e.client:new Promise(((t,r)=>{e.load("client",{callback:()=>{const n={apiKey:ct,clientId:ut,discoveryDocs:bi,scope:Ai};e.client.init(n).then((()=>t(e.client)),r)},onerror:r})}))}))}()).getToken();e&&(gi.log("Access token successfully obtained."),vi.next(e.access_token)),gapi.load("client:auth2",(()=>{gapi.auth2.getAuthInstance().isSignedIn.listen((e=>{if(e){const e=gapi.client.getToken();vi.next((null==e?void 0:e.access_token)||"")}else vi.next("")}))}))}))}();var _i=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))},Ti=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const xi=cn("ampcast/youtube-cache","keyval");!function(){_i(this,void 0,void 0,(function*(){const e=yield function(e=hn()){return e("readonly",(t=>{if(t.getAll&&t.getAllKeys)return Promise.all([ln(t.getAllKeys()),ln(t.getAll())]).then((([e,t])=>e.map(((e,r)=>[e,t[r]]))));const r=[];return e("readonly",(e=>function(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},ln(e.transaction)}(e,(e=>r.push([e.key,e.value]))).then((()=>r))))}))}(xi),t=[],r=Date.now();for(const[n,i]of e)r-i.cachedAt>6048e5&&t.push(n);t.length>0&&(yield function(e,t=hn()){return t("readwrite",(t=>(e.forEach((e=>t.delete(e))),ln(t.transaction))))}(t,xi))}))}();class Si{constructor(e,t,r){this.defaultConfig={pageSize:Si.maxPageSize},this.nextPageToken=void 0,this.pageNumber=1,this.config=Object.assign(Object.assign({},this.defaultConfig),r),this.pager=new Wt((()=>_i(this,void 0,void 0,(function*(){return this.fetchPage(e,t)}))),this.config)}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeMaxSize(){return this.pager.observeMaxSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createItems({kind:e,items:t=[]},r){return _i(this,void 0,void 0,(function*(){switch(e){case"youtube#playlistListResponse":return t.map((e=>this.createMediaPlaylist(e)));case"youtube#playlistItemListResponse":{const e=t.map((e=>e.contentDetails.videoId));return(yield this.fetchVideos(e,r)).map((e=>this.createMediaItem(e)))}case"youtube#searchListResponse":{const e=t.map((e=>e.id.videoId));return(yield this.fetchVideos(e,r)).map((e=>this.createMediaItem(e)))}default:return t.map((e=>this.createMediaItem(e)))}}))}createMediaPlaylist(e){var t,r,n;return Object.assign(Object.assign({},xe(Ie.Playlist)),{src:`youtube:playlist:${e.id}`,externalUrl:`${ki}/playlist?list=${e.id}`,title:(null===(t=e.snippet)||void 0===t?void 0:t.title)||e.id,thumbnails:this.mapThumbnails(null===(r=e.snippet)||void 0===r?void 0:r.thumbnails),trackCount:null===(n=e.contentDetails)||void 0===n?void 0:n.itemCount,owner:this.createOwner(e.snippet),pager:this.createPlaylistPager(e.id)})}createMediaItem(e){var t,r,n,i,a;return Object.assign(Object.assign({},xe(Ie.Media)),{mediaType:yt.Video,src:`youtube:video:${e.id}`,externalUrl:`${ki}/watch?v=${e.id}`,title:(null===(t=e.snippet)||void 0===t?void 0:t.title)||e.id,duration:this.parseDuration(null===(r=e.contentDetails)||void 0===r?void 0:r.duration),thumbnails:this.mapThumbnails(null===(n=e.snippet)||void 0===n?void 0:n.thumbnails),owner:this.createOwner(e.snippet),globalRating:this.parseNumber(null===(i=e.statistics)||void 0===i?void 0:i.likeCount),globalPlayCount:this.parseNumber(null===(a=e.statistics)||void 0===a?void 0:a.viewCount)})}createOwner({channelId:e="",channelTitle:t=""}){return e?{name:t,url:`${ki}/channel/${e}`}:void 0}createPlaylistPager(e){return new Si("/playlistItems",{playlistId:e,part:"contentDetails",fields:"items(contentDetails(videoId))"})}mapThumbnails(e){if(e)return Object.keys(e).map((t=>e[t]))}parseDuration(e=""){const[,t=0,r=0,n=0]=/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/.exec(e)||[];return 60*Number(t)*60+60*Number(r)+Number(n)||0}fetchPage(e,t){return _i(this,void 0,void 0,(function*(){const r=this.createCacheKey(e,t,this.pageNumber),n=yield this.getFromCache(r),i=this.nextPageToken,a=yield this.fetch(e,Object.assign(Object.assign({},t),{fields:`etag,kind,pageInfo,nextPageToken,${t.fields||"items"}`,maxResults:String(this.config.pageSize),pageToken:i}),n),{pageInfo:s,nextPageToken:o}=a,l=Ti(a,["pageInfo","nextPageToken"]),c=yield this.createItems(l,r),u=null==s?void 0:s.totalResults,h=!o;return this.nextPageToken=o,this.pageNumber++,yield this.saveToCache(r,a),{items:c,total:u,atEnd:h}}))}fetchVideos(e,t){return _i(this,void 0,void 0,(function*(){const r=`${t}/videos`,n=yield this.getFromCache(r),i=yield this.fetch("/videos",{id:e.join(","),part:"contentDetails,snippet,statistics",fields:`etag,${Si.videoFields}`},n);return yield this.saveToCache(r,i),i.items||[]}))}fetch(e,t,r){return _i(this,void 0,void 0,(function*(){const n=(null==r?void 0:r.etag)?{"If-None-Match":r.etag}:void 0;return gapi.client.request({path:`https://www.googleapis.com/youtube/v3${e}`,params:t,headers:n}).then((e=>_i(this,void 0,void 0,(function*(){const{result:t,status:n,statusText:i}=e;if(t)return t;if(304===n&&r)return r;throw Error(i||`Error (${n})`)}))))}))}getFromCache(e){return _i(this,void 0,void 0,(function*(){const t=yield dn(e,xi);return null!=t?t:null}))}saveToCache(e,t){return _i(this,void 0,void 0,(function*(){this.config.noCache||(yield fn(e,Object.assign(Object.assign({},t),{cachedAt:Date.now()}),xi))}))}createCacheKey(e,t,r){const{fields:n}=t,i=Ti(t,["fields"]);return`${e}?${new URLSearchParams(i)}#${r}`}parseNumber(e){if(null!=e&&!isNaN(Number(e)))return Number(e)}}Si.minPageSize=5,Si.maxPageSize=50,Si.videoFields="items(id,snippet(title,thumbnails,channelId,channelTitle),contentDetails(duration),statistics(viewCount,likeCount))",Si.playlistFields="items(id,snippet(title,thumbnails,channelId,channelTitle),contentDetails(itemCount))";console.log("module::youtube");const ki="https://www.youtube.com",Ii={view:"card",fields:["Thumbnail","Title","Duration","Owner"]};function Ci(e){return t=this,r=void 0,i=function*(){const t=`${ki}/watch?v=${e}`,r=yield fetch(`${ki}/oembed?url=${t}&format=json`);if(!r.ok)throw r;const n=yield r.json();return Object.assign(Object.assign({},xe(Ie.Media)),{mediaType:yt.Video,src:`youtube:video:${e}`,externalUrl:t,title:n.title,aspectRatio:n.width/n.height||16/9,duration:0,track:0,thumbnails:[{url:n.thumbnail_url,width:n.thumbnail_width,height:n.thumbnail_height}],owner:{name:n.author_name,url:n.author_url}})},new((n=void 0)||(n=Promise))((function(e,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(t.value).then(s,o)}l((i=i.apply(t,r||[])).next())}));var t,r,n,i}const Pi={id:"youtube",title:"YouTube",icon:"youtube",sources:[{id:"youtube/likes",title:"Likes",icon:"thumbs-up",itemType:Ie.Media,layout:Ii,search:()=>new Si("/videos",{myRating:"like",part:"snippet,contentDetails,statistics",fields:Si.videoFields})},{id:"youtube/playlists",title:"Playlists",icon:"playlists",itemType:Ie.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","TrackCount","Owner"]},secondaryLayout:Ii,search:()=>new Si("/playlists",{mine:"true",part:"snippet,contentDetails",fields:Si.playlistFields})}],searches:[{id:"youtube/search/video",title:"Video",icon:"",itemType:Ie.Media,layout:Ii,searchable:!0,search:e=>e?new Si("/search",{q:e,type:"video",videoCategoryId:"10",part:"id",fields:"items(id(videoId))"},{maxSize:Si.maxPageSize,noCache:!0}):new tt}],observeIsLoggedIn:function(){return vi.pipe(rt()).pipe(it((e=>""!==e)),rt())},login:wi,logout:function(){return pi(this,void 0,void 0,(function*(){const e=yi();e&&(yield Ei()).revoke(e,(()=>vi.next("")))}))}};var Mi,Ri,Bi=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},Li=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};const Di=(e,t)=>e.width===t.width&&e.height===t.height,Ni=16/9,Fi={autohide:1,autoplay:0,controls:0,disablekb:1,enablejsapi:1,fs:0,iv_load_policy:3,modestbranding:1,rel:0,showinfo:0};var Oi;!function(e){e[e.UNSTARTED=-1]="UNSTARTED",e[e.ENDED=0]="ENDED",e[e.PLAYING=1]="PLAYING",e[e.PAUSED=2]="PAUSED",e[e.BUFFERING=3]="BUFFERING",e[e.CUED=5]="CUED"}(Oi||(Oi={}));class zi{constructor(e,{startTime:t=0}={}){this.player=null,this.src$=new te(""),this.size$=new te({width:0,height:0}),this.error$=new Z,this.ready$=new Z,this.state$=new te(Oi.UNSTARTED),this.autoplay=!1,this.loop=!1,Mi.set(this,!0),Ri.set(this,1);const r=this.element=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),a=this.logger=new ne(`YouTubePlayer(${e})`);this.targetId=`youtube-iframe-${e}`,r.hidden=!0,r.className="youtube-video",n.className="youtube-video-wrapper",i.id=this.targetId,n.append(i),r.append(n),this.observeReady().pipe(Bt((()=>this.observeSrc())),ui((e=>!e)),Rt((e=>{const r=this.player,[,n,i]=e.split(":");if(i)if("playlist"===n){const e={list:i,listType:n,startSeconds:t};this.autoplay?r.loadPlaylist(e):r.cuePlaylist(e)}else this.autoplay?r.loadVideoById(i,t):r.cueVideoById(i,t);else r.stopVideo()}))).subscribe(a),this.observeReady().pipe(Bt((()=>this.observeVideoSize())),Rt((({width:e,height:t})=>this.player.setSize(e,t)))).subscribe(a),this.observeState().pipe(Ft((e=>e===Oi.ENDED&&this.loop)),Rt((()=>this.player.seekTo(0,!0)))).subscribe(a),this.observeState().pipe(Ft((e=>e===Oi.PLAYING)),Rt((()=>this.element.style.visibility=""))).subscribe(a),this.observeError().subscribe(a.error)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e,e&&(this.element.style.visibility="hidden")}get muted(){return Bi(this,Mi,"f")}set muted(e){Bi(this,Mi,"f")!==e&&(Li(this,Mi,e,"f"),this.player&&(e?this.player.mute():0!==this.volume&&this.player.unMute()))}get volume(){return Bi(this,Ri,"f")}set volume(e){Bi(this,Ri,"f")!==e&&(Li(this,Ri,e,"f"),this.player&&(this.player.setVolume(100*e),0===e?this.player.mute():this.muted||this.player.unMute()))}observeCurrentTime(){return this.observeState().pipe(Ot((e=>{var t;return e===Oi.PLAYING?Vn(250-Math.round(1e3*this.player.getCurrentTime())%250,250).pipe(it((()=>this.player.getCurrentTime())),Dt(this.observeState().pipe(Hr(1)))):Ze((null===(t=this.player)||void 0===t?void 0:t.getCurrentTime())||0)})))}observeDuration(){return this.observeState().pipe(it((()=>{var e;return(null===(e=this.player)||void 0===e?void 0:e.getDuration())||0})),Ft((e=>0!==e)),rt())}observeEnded(){return this.observeState().pipe(Ft((e=>e===Oi.ENDED&&!this.loop)),it((()=>{})))}observeError(){return this.error$}observePlaying(){return this.observeState().pipe(Ft((e=>e===Oi.PLAYING)),it((()=>{})))}appendTo(e){if(e.appendChild(this.element),!this.player){const e=di()(this.targetId,{playerVars:Fi});e.on("ready",(({target:e})=>{this.player=e,e.setVolume(100*this.volume),(this.muted||0===this.volume)&&e.mute(),this.ready$.next(void 0)})),e.on("stateChange",(({data:e})=>{this.state$.next(e)})),e.on("error",(e=>{this.error$.next(e)}))}}load(e){this.autoplay&&!this.player?this.error$.next(Error("YouTube player not loaded.")):this.autoplay&&this.player&&e===this.src?this.player.playVideo():this.src$.next(e)}play(){this.player?this.player.playVideo():this.error$.next(Error("YouTube player not loaded."))}pause(){var e;null===(e=this.player)||void 0===e||e.pauseVideo()}stop(){var e;null===(e=this.player)||void 0===e||e.stopVideo()}seek(e){var t;null===(t=this.player)||void 0===t||t.seekTo(e,!0)}resize(e,t){this.size$.next({width:e,height:t})}destroy(){var e;null===(e=this.player)||void 0===e||e.destroy(),this.element.remove()}get src(){return this.src$.getValue()}observeAspectRatio(){return this.observeVideoId().pipe(Ot((e=>e?this.getAspectRatio(e):Ze(Ni))),rt())}observeReady(){return this.ready$.pipe(Nt(1))}observeSize(){return this.size$.pipe(rt(Di),Ft((({width:e,height:t})=>e*t>0)))}observeSrc(){return this.src$.pipe(rt())}observeState(){return this.state$}observeVideoId(){return this.observeState().pipe(it((()=>{var e;return this.getVideoId((null===(e=this.player)||void 0===e?void 0:e.getVideoUrl())||"")})),rt())}observeVideoSize(){return Ct([this.observeSize(),this.observeAspectRatio()]).pipe(it((([{width:e,height:t},r])=>{const n=Math.max(Math.round(e/r),t);return{width:Math.max(Math.round(n*r),e),height:n}})),rt(Di))}getAspectRatio(e){return Je(Ci(e)).pipe(Dt(Vn(3e3)),Dt(this.observeVideoId().pipe(Hr(1))),it((({aspectRatio:e})=>e||Ni)),Lt((t=>(this.logger.log(`Could not obtain oembed info: videoId='${e}' (status=${t.status})`),t.status>=400&&(401===t.status?this.error$.next(Error("Embedding prevented by channel owner.")):403===t.status?this.error$.next(Error("Private video.")):404===t.status?this.error$.next(Error("Video does not exist.")):this.error$.next(`Error: ${t.statusText} (${t.status})`)),Ze(Ni)))))}getPlayerState(){return this.player?this.player.getPlayerState():Oi.UNSTARTED}getPlaylist(){var e;return(null===(e=this.player)||void 0===e?void 0:e.getPlaylist())||[]}getVideoId(e){return e.startsWith("youtube:")?e.replace("youtube:video:",""):mi()(e)||""}}Mi=new WeakMap,Ri=new WeakMap;const Ui=new r("plex"),ji={get clientId(){let e=Ui.getItem("clientId");return e||(e=or(),Ui.setItem("clientId",e)),e},get connection(){const e=Ui.getItem("connection");return e?JSON.parse(e):null},set connection(e){Ui.setItem("connection",JSON.stringify(e))},get host(){var e;return(null===(e=this.connection)||void 0===e?void 0:e.uri)||""},get libraryId(){return Ui.getItem("libraryId")||""},set libraryId(e){Ui.setItem("libraryId",e)},get server(){const e=Ui.getItem("server");return e?JSON.parse(e):null},set server(e){Ui.setItem("server",JSON.stringify(e))},get serverToken(){var e;return(null===(e=this.server)||void 0===e?void 0:e.accessToken)||""},get userToken(){return Ui.getItem("userToken")||""},set userToken(e){Ui.setItem("userToken",e)},get userId(){return Ui.getItem("userId")||""},set userId(e){Ui.setItem("userId",e)},clear(){const e=this.clientId;Ui.clear(),e&&Ui.setItem("clientId",e)}};var Vi=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};function qi({host:e=ji.host,path:t,method:r="GET",params:n,headers:i,body:a,token:s,keepalive:o}){return Vi(this,void 0,void 0,(function*(){if(!e)throw Error("No Plex connection.");(t=n?`${t}?${new URLSearchParams(n)}`:t).startsWith("/")||(t=`/${t}`),s||(s=e===ji.host?ji.serverToken:ji.userToken);const l=yield window.fetch(`${e}${t}`,{method:r,headers:Object.assign(Object.assign({},i),Qi(s)),body:a,keepalive:o});if(!l.ok)throw Error(l.statusText);return l}))}function Qi(e){const t={"X-Plex-Product":"ampcast","X-Plex-Version":"0.4.11","X-Plex-Platform":ge.displayName,"X-Plex-Platform-Version":ge.version,"X-Plex-Device":ge.os,"X-Plex-Device-Name":ge.displayName,"X-Plex-Client-Identifier":ji.clientId,"X-Plex-Model":"hosted","Accept-Encoding":"gzip, deflate, br"};return e&&(t["X-Plex-Token"]=e),t}console.log("module::plexApi");const Xi={fetch:qi,fetchJSON:function(e){var{headers:t,body:r}=e,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(e,["headers","body"]);return Vi(this,void 0,void 0,(function*(){return t=Object.assign(Object.assign({},t),{Accept:"application/json"}),r&&(t=Object.assign(Object.assign({},t),{"Content-Type":"application/json"}),r=JSON.stringify(r)),(yield qi(Object.assign({headers:t,body:r},n))).json()}))},getPlayableUrlFromSrc:function(e){const{host:t,serverToken:r}=ji;if(t&&r){const[,,n]=e.split(":");return`${t}${n}?X-Plex-Token=${r}`}throw Error("Not logged in.")}},Wi=Xi;class Hi{constructor(e){this.error$=new Z,this.src="",this.loadedSrc="",this.autoplay=!1;const t=this.element=document.createElement(e);t.hidden=!0,t.muted=!0,t.autoplay=!1,t.className=`html5-${e}`,t.crossOrigin="anonymous",Kr(t,"error").pipe(it((()=>t.error))).subscribe(this.error$);const r=new ne(`HTML5Player.${e}`);this.observeError().subscribe(r.error)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e}get loop(){return this.element.loop}set loop(e){this.element.loop=e}get muted(){return this.element.muted}set muted(e){this.element.muted=e}get volume(){return this.element.volume}set volume(e){this.element.volume=e}observeCurrentTime(){return Kr(this.element,"timeupdate").pipe(it((()=>this.element.currentTime)),it((e=>isFinite(e)?e:0)))}observeDuration(){return Kr(this.element,"durationchange").pipe(it((()=>this.element.duration)),it((e=>isFinite(e)?e:0)))}observeEnded(){return Kr(this.element,"ended").pipe(it((()=>{})))}observeError(){return this.error$}observePlaying(){return Kr(this.element,"playing").pipe(it((()=>{})))}appendTo(e){e.appendChild(this.element)}load(e){this.src=e;try{const t=this.getMediaSource(this.src);this.loadedSrc=e,this.element.setAttribute("src",t),this.autoplay&&this.element.play().then(void 0,(e=>this.error$.next(e)))}catch(e){this.error$.next(e)}}play(){try{const e=this.getMediaSource(this.src);this.src!==this.loadedSrc&&(this.loadedSrc=this.src,this.element.setAttribute("src",e)),this.element.play().then(void 0,(e=>this.error$.next(e)))}catch(e){this.error$.next(e)}}pause(){this.element.pause()}stop(){this.element.pause(),this.element.currentTime=0}seek(e){this.element.currentTime=e}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}getMediaSource(e){return e.startsWith("jellyfin:")?fr.getPlayableUrlFromSrc(e):e.startsWith("plex:")?Wi.getPlayableUrlFromSrc(e):e}}const Gi=new Hi("video"),$i=new zi("ambient",{startTime:120}),Yi=new ci([Gi,$i],(function(e){return e?e.startsWith("youtube:")?$i:Gi:null}),(function(e,t){e.load(t)}));Yi.loop=!0,Yi.volume=0,Yi.hidden=!0;const Ki=Yi;class Ji{constructor(){this.autoplay=!1,this.loop=!0,this.muted=!0,this.volume=0}observeCurrentTime(){return et}observeDuration(){return et}observeEnded(){return et}observeError(){return et}observePlaying(){return et}seek(){}}const Zi=new ne("AmpShade"),ea=2*Math.PI,ta=Math.PI/2,ra=ea/3600;class na{constructor(e,t={}){let r;if(this._ready=!1,this._gradients={classic:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )",{pos:.6,color:"hsl( 60, 100%, 50% )"},"hsl( 120, 100%, 50% )"]},prism:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 50% )","hsl( 240, 100%, 50% )"]},rainbow:{bgColor:"#111",dir:"h",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 47% )","hsl( 240, 100%, 58% )","hsl( 300, 100%, 50% )","hsl( 360, 100%, 50% )"]}},this._container=e||document.body,this._defaultWidth=this._container.clientWidth||640,this._defaultHeight=this._container.clientHeight||270,t.source&&(r=t.source.context));else if(r=t.audioCtx);else try{r=new(window.AudioContext||window.webkitAudioContext)}catch(e){throw new ia("ERR_AUDIO_CONTEXT_FAIL","Could not create audio context. Web Audio API not supported?")}if(!r.createGain)throw new ia("ERR_INVALID_AUDIO_CONTEXT","Provided audio context is not valid");const n=this._analyzer=[r.createAnalyser(),r.createAnalyser()],i=this._splitter=r.createChannelSplitter(2),a=this._merger=r.createChannelMerger(2);this._input=r.createGain(),this._output=r.createGain(),this._sources=[],t.source&&this.connectInput(t.source);for(const e of[0,1])i.connect(n[e],e);a.connect(this._output),this._outNodes=[],!1!==t.connectSpeakers&&this.connectOutput(),this._energy={val:0,peak:0,hold:0};const s=document.createElement("canvas");s.style="max-width: 100%;",this._canvasCtx=s.getContext("2d");for(const e of["_scaleX","_scaleR"])this[e]=document.createElement("canvas").getContext("2d");this._fsEl=t.fsElement||s;const o=()=>{this._fsTimeout||(this._fsTimeout=window.setTimeout((()=>{this._fsChanging||(this._setCanvas("resize"),this._fsTimeout=0)}),60))};window.ResizeObserver&&new ResizeObserver(o).observe(this._container),window.addEventListener("resize",o),s.addEventListener("fullscreenchange",(()=>{this._fsChanging=!0,this._fsTimeout&&window.clearTimeout(this._fsTimeout),this._setCanvas("fschange"),this._fsTimeout=window.setTimeout((()=>{this._fsChanging=!1,this._fsTimeout=0}),60)}));const l=()=>{"suspended"==r.state&&r.resume(),window.removeEventListener("click",l)};window.addEventListener("click",l),this._calcAux(),this._setProps(t,!0),this.useCanvas&&this._container.appendChild(s),this._ready=!0,this._setCanvas("create")}get alphaBars(){return this._alphaBars}set alphaBars(e){this._alphaBars=!!e,this._calcAux()}get barSpace(){return this._barSpace}set barSpace(e){this._barSpace=+e||0,this._calcAux()}get fftSize(){return this._analyzer[0].fftSize}set fftSize(e){for(const t of[0,1])this._analyzer[t].fftSize=e;const t=this._analyzer[0].frequencyBinCount;this._fftData=[new Uint8Array(t),new Uint8Array(t)],this._calcBars()}get gradient(){return this._gradient}set gradient(e){if(!this._gradients.hasOwnProperty(e))throw new ia("ERR_UNKNOWN_GRADIENT",`Unknown gradient: '${e}'`);this._gradient=e,this._makeGrad()}get height(){return this._height}set height(e){this._height=e,this._setCanvas("user")}get ledBars(){return this._showLeds}set ledBars(e){this._showLeds=!!e,this._calcAux()}get loRes(){return this._loRes}set loRes(e){this._loRes=!!e,this._setCanvas("lores")}get lumiBars(){return this._lumiBars}set lumiBars(e){this._lumiBars=!!e,this._calcAux(),this._calcLeds(),this._makeGrad()}get maxDecibels(){return this._analyzer[0].maxDecibels}set maxDecibels(e){for(const t of[0,1])this._analyzer[t].maxDecibels=e}get maxFreq(){return this._maxFreq}set maxFreq(e){if(e<1)throw new ia("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._maxFreq=e,this._calcBars()}get minDecibels(){return this._analyzer[0].minDecibels}set minDecibels(e){for(const t of[0,1])this._analyzer[t].minDecibels=e}get minFreq(){return this._minFreq}set minFreq(e){if(e<1)throw new ia("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._minFreq=e,this._calcBars()}get mirror(){return this._mirror}set mirror(e){this._mirror=0|Math.sign(e),this._calcAux(),this._calcBars(),this._makeGrad()}get mode(){return this._mode}set mode(e){const t=0|e;if(!(t>=0&&t<=10&&9!=t))throw new ia("ERR_INVALID_MODE",`Invalid mode: ${e}`);this._mode=t,this._calcAux(),this._calcBars(),this._makeGrad()}get outlineBars(){return this._outlineBars}set outlineBars(e){this._outlineBars=!!e,this._calcAux()}get radial(){return this._radial}set radial(e){this._radial=!!e,this._calcAux(),this._calcBars(),this._makeGrad()}get reflexRatio(){return this._reflexRatio}set reflexRatio(e){if((e=+e||0)<0||e>=1)throw new ia("ERR_REFLEX_OUT_OF_RANGE","Reflex ratio must be >= 0 and < 1");this._reflexRatio=e,this._calcAux(),this._makeGrad(),this._calcLeds()}get showLeds(){return this.ledBars}set showLeds(e){this.ledBars=e}get smoothing(){return this._analyzer[0].smoothingTimeConstant}set smoothing(e){for(const t of[0,1])this._analyzer[t].smoothingTimeConstant=e}get spinSpeed(){return this._spinSpeed}set spinSpeed(e){e=+e||0,void 0!==this._spinSpeed&&0!=e||(this._spinAngle=-ta),this._spinSpeed=e}get splitGradient(){return this._splitGradient}set splitGradient(e){this._splitGradient=!!e,this._makeGrad()}get stereo(){return this._stereo}set stereo(e){this._stereo=!!e,this._input.disconnect(),this._input.connect(this._stereo?this._splitter:this._analyzer[0]),this._analyzer[0].disconnect(),this._outNodes.length&&this._analyzer[0].connect(this._stereo?this._merger:this._output),this._calcAux(),this._createScales(),this._calcLeds(),this._makeGrad()}get volume(){return this._output.gain.value}set volume(e){this._output.gain.value=e}get width(){return this._width}set width(e){this._width=e,this._setCanvas("user")}get audioCtx(){return this._input.context}get canvas(){return this._canvasCtx.canvas}get canvasCtx(){return this._canvasCtx}get connectedSources(){return this._sources}get connectedTo(){return this._outNodes}get energy(){return this.getEnergy()}get fps(){return this._fps}get fsHeight(){return this._fsHeight}get fsWidth(){return this._fsWidth}get isAlphaBars(){return this._isAlphaBars}get isFullscreen(){return(document.fullscreenElement||document.webkitFullscreenElement)===this._fsEl}get isLedBars(){return this._isLedDisplay}get isLedDisplay(){return this.isLedBars}get isLumiBars(){return this._isLumiBars}get isOctaveBands(){return this._isOctaveBands}get isOn(){return void 0!==this._runId}get isOutlineBars(){return this._isOutline}get peakEnergy(){return this.getEnergy("peak")}get pixelRatio(){return this._pixelRatio}static get version(){return"3.6.0"}connectInput(e){const t=e instanceof HTMLMediaElement;if(!t&&!e.connect)throw new ia("ERR_INVALID_AUDIO_SOURCE","Audio source must be an instance of HTMLMediaElement or AudioNode");const r=t?this.audioCtx.createMediaElementSource(e):e;return this._sources.includes(r)||(r.connect(this._input),this._sources.push(r)),r}connectOutput(e=this.audioCtx.destination){if(!this._outNodes.includes(e)&&(this._output.connect(e),this._outNodes.push(e),1==this._outNodes.length))for(const e of[0,1])this._analyzer[e].connect(this._stereo||e?this._merger:this._output,0,e)}disconnectInput(e){e?Array.isArray(e)||(e=[e]):e=Array.from(this._sources);for(const t of e){const e=this._sources.indexOf(t);e>=0&&(t.disconnect(this._input),this._sources.splice(e,1))}}disconnectOutput(e){if((!e||this._outNodes.includes(e))&&(this._output.disconnect(e),this._outNodes=e?this._outNodes.filter((t=>t!==e)):[],0==this._outNodes.length))for(const e of[0,1])this._analyzer[e].disconnect()}getBars(){return Array.from(this._bars,(({posX:e,freqLo:t,freqHi:r,hold:n,peak:i,value:a})=>({posX:e,freqLo:t,freqHi:r,hold:n,peak:i,value:a})))}getEnergy(e,t){if(void 0===e)return this._energy.val;if(e!=+e){if("peak"==e)return this._energy.peak;const r={bass:[20,250],lowMid:[250,500],mid:[500,2e3],highMid:[2e3,4e3],treble:[4e3,16e3]};if(!r[e])return null;[e,t]=r[e]}const r=this._freqToBin(e),n=t?this._freqToBin(t):r,i=this._stereo+1;let a=0;for(let e=0;e<i;e++)for(let t=r;t<=n;t++)a+=this._fftData[e][t];return a/(n-r+1)/i/255}registerGradient(e,t){if("string"!=typeof e||0==e.trim().length)throw new ia("ERR_GRADIENT_INVALID_NAME","Gradient name must be a non-empty string");if("object"!=typeof t)throw new ia("ERR_GRADIENT_NOT_AN_OBJECT","Gradient options must be an object");if(void 0===t.colorStops||t.colorStops.length<2)throw new ia("ERR_GRADIENT_MISSING_COLOR","Gradient must define at least two colors");this._gradients[e]={bgColor:t.bgColor||"#111",dir:t.dir,colorStops:t.colorStops},e==this._gradient&&this._makeGrad()}setCanvasSize(e,t){this._width=e,this._height=t,this._setCanvas("user")}setFreqRange(e,t){if(e<1||t<1)throw new ia("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._minFreq=Math.min(e,t),this._maxFreq=Math.max(e,t),this._calcBars()}setLedParams(e){let t,r,n;e&&(t=0|e.maxLeds,r=+e.spaceV,n=+e.spaceH),this._ledParams=t>0&&r>0&&n>=0?[t,r,n]:void 0,this._calcLeds()}setOptions(e){this._setProps(e)}setSensitivity(e,t){for(const r of[0,1])this._analyzer[r].minDecibels=Math.min(e,t),this._analyzer[r].maxDecibels=Math.max(e,t)}toggleAnalyzer(e){const t=this.isOn;return void 0===e&&(e=!t),t&&!e?(cancelAnimationFrame(this._runId),this._runId=void 0):!t&&e&&(this._frame=this._fps=0,this._time=performance.now(),this._runId=requestAnimationFrame((e=>this._draw(e)))),this.isOn}toggleFullscreen(){if(this.isFullscreen)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{const e=this._fsEl;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}}_calcAux(){const e=this.canvas,t=this._radial,r=this._stereo&&!t,n=e.width>>1;this._radius=Math.min(e.width,e.height)*(this._stereo?.375:.125)|0,this._barSpacePx=Math.min(this._barWidth-1,this._barSpace>0&&this._barSpace<1?this._barWidth*this._barSpace:this._barSpace),this._isOctaveBands=this._mode%10!=0,this._isLedDisplay=this._showLeds&&this._isOctaveBands&&!t,this._isLumiBars=this._lumiBars&&this._isOctaveBands&&!t,this._isAlphaBars=this._alphaBars&&!this._isLumiBars&&10!=this._mode,this._isOutline=this._outlineBars&&this._isOctaveBands&&!this._isLumiBars&&!this._isLedDisplay,this._maximizeLeds=!this._stereo||this._reflexRatio>0&&!this._isLumiBars,this._channelHeight=e.height-(r&&!this._isLedDisplay?.5:0)>>r,this._analyzerHeight=this._channelHeight*(this._isLumiBars||t?1:1-this._reflexRatio)|0,this._channelGap=r?e.height-2*this._channelHeight:0,this._analyzerWidth=e.width-n*(0!=this._mirror),this._initialX=n*(-1==this._mirror&&!t)}_calcBars(){const e=this._bars=[];if(!this._ready)return;const t=e=>e*this.audioCtx.sampleRate/this.fftSize||1,r=(t,r,n,i,a,s,o)=>e.push({posX:t,binLo:r,binHi:n,freqLo:i,freqHi:a,ratioLo:s,ratioHi:o,peak:[0,0],hold:[0],value:[0]}),n=this._analyzerWidth,i=this._initialX,a=this._maxFreq,s=this._minFreq;let o,l;if(this._isOctaveBands){let c=[];for(let e=0;e<11;e++)for(let r=0;r<24;r++){const n=16.351597831287332*1.029302236643492**(24*e+r),i=this._freqToBin(n,"floor"),a=t(i),s=(n-a)/(t(i+1)-a);c.push({freq:n,bin:i,ratio:s})}const u=[0,1,2,3,4,6,8,12,24][this._mode];for(let n=0;n<c.length;n+=u){let{freq:i,bin:o,ratio:l}=c[n],{freq:h,bin:d,ratio:f}=c[n+u-1];const m=e.length,p=e[m-1];if(h>a||d>=this.fftSize/2){p.binHi++,p.ratioHi=0,p.freqHi=t(p.binHi);break}if(i>=s){if(m>0){const r=o-p.binHi;r>1&&(p.binHi=o-(r>>1),p.ratioHi=0,p.freqHi=t(p.binHi),m>1&&p.binHi>p.binLo&&p.binLo>e[m-2].binHi&&(p.ratioLo=0,p.freqLo=t(p.binLo)),o=p.binHi+1),d>o&&o>p.binHi&&(l=0,i=t(o))}r(0,o,d,i,h,l,f)}}this._barWidth=n/e.length,e.forEach(((e,t)=>e.posX=i+t*this._barWidth)),o=Math.log10(e[0].freqLo),l=n/(Math.log10(e[e.length-1].freqHi)-o)}else{this._barWidth=1,o=Math.log10(s),l=n/(Math.log10(a)-o);const c=this._freqToBin(s,"floor"),u=this._freqToBin(a);let h=-999;for(let n=c;n<=u;n++){const a=t(n),s=i+Math.round(l*(Math.log10(a)-o));s>h?(r(s,n,n,a,a,0,0),h=s):e.length&&(e[e.length-1].binHi=n,e[e.length-1].freqHi=a)}}this._minLog=o,this._logWidth=l,this._calcAux(),this._createScales(),this._calcLeds()}_calcLeds(){if(!this._isOctaveBands||!this._ready)return;const e=this._pixelRatio/(window.devicePixelRatio>1&&window.screen.height<=540?2:1),t=this._ledParams,[r,n,i]=t||[[],[128,3,.45],[128,4,.225],[96,6,.225],[80,6,.225],[80,6,.125],[64,6,.125],[48,8,.125],[24,16,.125]][this._mode];let a,s,o=this._analyzerHeight;if(t){const t=2*e;let i;a=r+1;do{a--,i=o/a/(1+n),s=i*n}while((i<t||s<t)&&a>1)}else{const t=540/n;s=Math.min(n*e,Math.max(2,o/t+.1|0))}this._maximizeLeds&&(o+=s),t||(a=Math.min(r,o/(2*s)|0)),this._leds=[a,i>=1?i:this._barWidth*i,s,o/a-s]}_createScales(){const e=[16,31,63,125,250,500,1e3,2e3,4e3,8e3,16e3],t=this._canvasCtx.canvas,r=this._scaleX,n=this._scaleR,i=r.canvas,a=n.canvas,s=.03*Math.min(t.width,t.height)|0;a.width=a.height=(this._radius<<1)+this._stereo*s;const o=a.width>>1,l=o-.7*s,c=(e,r)=>{const i=ea*(e/t.width),a=i-ta,s=l*Math.cos(a),c=l*Math.sin(a);n.save(),n.translate(o+s,o+c),n.rotate(i),n.fillText(r,0,0),n.restore()};i.width|=0,r.fillStyle=n.strokeStyle="#000c",r.fillRect(0,0,i.width,i.height),n.arc(o,o,o-s/2,0,ea),n.lineWidth=s,n.stroke(),r.fillStyle=n.fillStyle="#fff",r.font=(i.height>>1)+"px sans-serif",n.font=(s>>1)+"px sans-serif",r.textAlign=n.textAlign="center";for(const n of e){const e=n>=1e3?n/1e3+"k":n,a=this._logWidth*(Math.log10(n)-this._minLog);a>=0&&a<=this._analyzerWidth&&(r.fillText(e,this._initialX+a,.75*i.height),a<this._analyzerWidth&&c(a,e),this._mirror&&(r.fillText(e,(this._initialX||t.width)-a,.75*i.height),a>10&&c(-a,e)))}}_draw(e){const t=this._canvasCtx,r=t.canvas,n=this._scaleX.canvas,i=this._scaleR.canvas,a=this._energy,s=this._mode,o=this._isAlphaBars,l=this._isLedDisplay,c=this._isLumiBars,u=this._isOctaveBands,h=this._isOutline,d=this._radial,f=this._stereo,m=+this.lineWidth,p=this._mirror,g=this._channelHeight,A=this._channelGap,b=this._analyzerHeight,v=d?r.width:this._analyzerWidth,y=this._initialX,w=y+v,E=r.width>>1,_=r.height>>1,T=this._radius,x=d?Math.min(E,_)-T:b,S=this.useCanvas;a.val>0&&(this._spinAngle+=this._spinSpeed*ra);const k=e=>{if(e&&m){const e=t.globalAlpha;t.globalAlpha=1,t.stroke(),t.globalAlpha=e}},I=(e,t,n)=>{const i=T+t,a=n*ea*(e/r.width)+this._spinAngle;return[E+i*Math.cos(a),_+i*Math.sin(a)]},C=(e,r,n,i,a)=>{t.beginPath();for(const a of p?[1,-1]:[1])t.moveTo(...I(e,r,a)),t.lineTo(...I(e,r+i,a)),t.lineTo(...I(e+n,r+i,a)),t.lineTo(...I(e+n,r,a));k(a),t.fill()},[P,M,R,B]=this._leds||[],L=e=>(e*P|0)*(B+R)-R,D=!this.showBgColor||l&&!this.overlay?"#000":this._gradients[this._gradient].bgColor;let N=this._barWidth-(u?Math.max(l?M:0,this._barSpacePx):0);0!=this._barSpace||l||(N|=0);let F=0;const O=this._bars.length;for(let e=0;e<f+1;e++){const i=g*e+A*e,a=i+g,u=i+b-(l&&!this._maximizeLeds?R:0);if(S){if(this.overlay&&t.clearRect(0,i-A,r.width,g+A),this.overlay&&!this.showBgColor||(this.overlay&&(t.globalAlpha=this.bgAlpha),t.fillStyle=D,d&&0!=e||t.fillRect(y,i-A,v,(this.overlay&&1==this.reflexAlpha?b:g)+A),t.globalAlpha=1),this.showScaleY&&!c&&!d){const e=n.height,a=e>>1,s=this._analyzer[0].minDecibels,o=this._analyzer[0].maxDecibels,l=b/(o-s);t.fillStyle="#888",t.font=`${a}px sans-serif`,t.textAlign="right",t.lineWidth=1;for(let n=o;n>s;n-=5){const s=i+(o-n)*l,c=n%2==0|0;if(c){const o=s+a*(s==i?.8:.35);-1!=p&&t.fillText(n,.85*e,o),1!=p&&t.fillText(n,r.width-.1*e,o),t.strokeStyle="#888",t.setLineDash([2,4]),t.lineDashOffset=0}else t.strokeStyle="#555",t.setLineDash([2,8]),t.lineDashOffset=1;t.beginPath(),t.moveTo(y+e*c*(-1!=p),.5+~~s),t.lineTo(w-e*c*(1!=p),.5+~~s),t.stroke()}t.setLineDash([]),t.lineDashOffset=0}l?(t.setLineDash([B,R]),t.lineWidth=N):t.lineWidth=h?Math.min(m,N/2):m,t.fillStyle=t.strokeStyle=this._canvasGradient}const P=this._fftData[e];this._analyzer[e].getByteFrequencyData(P);const z=(e,t)=>P[e]+(P[e+1]-P[e])*t;t.beginPath();let U=[];for(let r=0;r<O;r++){const n=this._bars[r],{binLo:f,binHi:g,ratioLo:A,ratioHi:b}=n;let v=Math.max(z(f,A),z(g,b));for(let e=f+1;e<g;e++)P[e]>v&&(v=P[e]);if(v/=255,n.value[e]=v,F+=v,n.peak[e]>0&&(n.hold[e]--,n.hold[e]<0&&(n.peak[e]+=n.hold[e]/x)),v>=n.peak[e]&&(n.peak[e]=v,n.hold[e]=30),!S)continue;c||o?t.globalAlpha=v:h&&(t.globalAlpha=this.fillAlpha),l?(v=L(v),v<0&&(v=0)):v=v*x|0,d&&1==e&&(v*=-1);let E=N,_=n.posX;if(10==s){const n=r?0:(P[this._bars[1].binLo]/255*x*(!d||!e||-1)+v)/2;if(d){if(0==r&&t.lineTo(...I(0,_<0?n:v,1)),_>=0){const e=[_,v];t.lineTo(...I(...e,1)),U.push(e)}}else{if(0==r)if(-1!=p){const e=f?P[f-1]/255*x:v;t.moveTo(y-m,u-e)}else t.moveTo(y,u-(_<y?n:v));(-1!=p||_>=y)&&t.lineTo(_,u-v)}}else if(s>0&&(l?_+=Math.max(M/2,this._barSpacePx/2):0==this._barSpace?(_|=0,r>0&&_>this._bars[r-1].posX+N&&(_--,E++)):_+=this._barSpacePx/2),l){const e=_+N/2;if(this.showBgColor&&!this.overlay){const r=t.globalAlpha;t.beginPath(),t.moveTo(e,i),t.lineTo(e,u),t.strokeStyle="#7f7f7f22",t.globalAlpha=1,t.stroke(),t.strokeStyle=t.fillStyle,t.globalAlpha=r}t.beginPath(),t.moveTo(e,c?i:u),t.lineTo(e,c?a:u-v),t.stroke()}else if(_>=y)if(d)C(_,0,E,v,h);else{const e=_,r=c?i:u,n=E,s=c?a:-v;t.beginPath(),t.moveTo(e,r),t.lineTo(e,r+s),t.lineTo(e+n,r+s),t.lineTo(e+n,r),k(h),t.fill()}const T=n.peak[e];T>0&&this.showPeaks&&!c&&_>=y&&_<w&&(h&&m>0?t.globalAlpha=1:o&&(t.globalAlpha=T),l?t.fillRect(_,u-L(T),N,B):d?10!=s&&C(_,T*x*(!e||-1),E,-2):t.fillRect(_,u-T*x,E,2))}if(S){if(t.globalAlpha=1,10==s){if(d){if(p){let e;for(;e=U.pop();)t.lineTo(...I(...e,-1))}t.closePath()}m>0&&t.stroke(),this.fillAlpha>0&&(d?(t.moveTo(E+T,_),t.arc(E,_,T,0,ea,!0)):(t.lineTo(w,u),t.lineTo(y,u)),t.globalAlpha=this.fillAlpha,t.fill(),t.globalAlpha=1)}if(this._reflexRatio>0&&!c){let n,a;this.reflexFit||f?(n=f&&0==e?g+A:0,a=g-b):(n=r.height-2*b,a=b),t.globalAlpha=this.reflexAlpha,1!=this.reflexBright&&(t.filter=`brightness(${this.reflexBright})`),t.setTransform(1,0,0,-1,0,r.height),t.drawImage(r,0,i,r.width,b,0,n,r.width,a),t.setTransform(1,0,0,1,0,0),t.filter="none",t.globalAlpha=1}}}a.val=F/(O<<f),a.val>=a.peak?(a.peak=a.val,a.hold=30):a.hold>0?a.hold--:a.peak>0&&(a.peak*=(30+a.hold--)/30),S&&(p&&!d&&(t.setTransform(-1,0,0,1,r.width-y,0),t.drawImage(r,y,0,E,r.height,0,0,E,r.height),t.setTransform(1,0,0,1,0,0)),t.setLineDash([]),this.showScaleX&&(d?(t.save(),t.translate(E,_),this._spinSpeed&&t.rotate(this._spinAngle+ta),t.drawImage(i,-i.width>>1,-i.width>>1),t.restore()):t.drawImage(n,0,r.height-n.height))),this._frame++;const z=e-this._time;if(z>=1e3&&(this._fps=this._frame/(z/1e3),this._frame=0,this._time=e),this.showFPS){const e=n.height;t.font=`bold ${e}px sans-serif`,t.fillStyle="#0f0",t.textAlign="right",t.fillText(Math.round(this._fps),r.width-e,2*e)}this.onCanvasDraw&&(t.save(),t.fillStyle=t.strokeStyle=this._canvasGradient,this.onCanvasDraw(this),t.restore()),this._runId=requestAnimationFrame((e=>this._draw(e)))}_freqToBin(e,t="round"){const r=this._analyzer[0].frequencyBinCount-1,n=Math[t](e*this.fftSize/this.audioCtx.sampleRate);return n<r?n:r}_makeGrad(){if(!this._ready)return;const e=this._canvasCtx,t=e.canvas,r=this._isLumiBars,n=r?t.height:t.height*(1-this._reflexRatio*!this._stereo)|0,i=1-this._reflexRatio,a=this._initialX,s=t.width>>1,o=t.height>>1,l=Math.min(s,o),c=this._radius,u=this._gradients[this._gradient],h=u.colorStops,d="h"==u.dir;let f;if(f=this._radial?e.createRadialGradient(s,o,l,s,o,c-(l-c)*this._stereo):e.createLinearGradient(...d?[a,0,a+this._analyzerWidth,0]:[0,0,0,n]),h){const e=this._stereo&&!this._splitGradient&&!d,t=(e,t)=>f.addColorStop(e,t.color||t);for(let n=0;n<1+e;n++)h.forEach(((a,s)=>{const o=h.length-1;let l=void 0!==a.pos?a.pos:s/o;if(e&&(l/=2),!this._stereo||r||this._radial||d||(l*=i,!e&&l>.5*i&&(l+=.5*this._reflexRatio)),1==n)if(this._radial||r){const e=o-s;l=1-(void 0!==(a=h[e]).pos?a.pos:e/o)/2}else 0==s&&l>0&&t(.5,a),l+=.5;t(l,a),this._stereo&&s==o&&l<.5&&t(.5,a)}))}this._canvasGradient=f}_setCanvas(e){if(!this._ready)return;const t=this._canvasCtx,r=t.canvas,n=this._scaleX.canvas,i=window.devicePixelRatio/(this._loRes+1);let a=window.screen.width*i,s=window.screen.height*i;90==Math.abs(window.orientation)&&a<s&&([a,s]=[s,a]);const o=this.isFullscreen,l=o&&this._fsEl==r,c=l?a:(this._width||this._container.clientWidth||this._defaultWidth)*i|0,u=l?s:(this._height||this._container.clientHeight||this._defaultHeight)*i|0;this._pixelRatio=i,this._fsWidth=a,this._fsHeight=s,r.width==c&&r.height==u||(r.width=c,r.height=u,this._calcAux(),this.overlay||(t.fillStyle="#000",t.fillRect(0,0,c,u)),t.lineJoin="bevel",n.width=c,n.height=Math.max(20*i,Math.min(c,u)/27|0),this._makeGrad(),this._calcBars(),void 0!==this._fsStatus&&this._fsStatus!==o&&(e="fschange"),this._fsStatus=o,this.onCanvasResize&&this.onCanvasResize(e,this))}_setProps(e,t){const r={alphaBars:!1,barSpace:.1,bgAlpha:.7,fftSize:8192,fillAlpha:1,gradient:"classic",ledBars:!1,lineWidth:0,loRes:!1,lumiBars:!1,maxDecibels:-25,maxFreq:22e3,minDecibels:-85,minFreq:20,mirror:0,mode:0,outlineBars:!1,overlay:!1,radial:!1,reflexAlpha:.15,reflexBright:1,reflexFit:!0,reflexRatio:0,showBgColor:!0,showFPS:!1,showPeaks:!0,showScaleX:!0,showScaleY:!1,smoothing:.5,spinSpeed:0,splitGradient:!1,start:!0,stereo:!1,useCanvas:!0,volume:1},n=["onCanvasDraw","onCanvasResize"],i=Object.keys(r).filter((e=>"start"!=e)).concat(n,["height","width"]);e&&void 0!==e.showLeds&&void 0===e.ledBars&&(e.ledBars=e.showLeds),(t||void 0===e)&&(e={...r,...e});for(const t of Object.keys(e))n.includes(t)&&"function"!=typeof e[t]?this[t]=void 0:i.includes(t)&&(this[t]=e[t]);void 0!==e.start&&this.toggleAnalyzer(e.start)}}class ia extends Error{constructor(e,t){super(t),this.name="AudioMotionError",this.code=e}}const aa=[{name:"Anemone",options:{radial:!0,ledBars:!1,spinSpeed:1,mode:8,barSpace:0,gradient:"rainbow",reflexRatio:.4,showPeaks:!0,mirror:-1,maxFreq:8e3,lineWidth:2,fillAlpha:.2}},{name:"Classic LEDs",options:{mode:7,barSpace:0,gradient:"classic",ledBars:!0,lumiBars:!1,radial:!1,reflexRatio:0,showPeaks:!0}},{name:"Mirror wave",options:{mode:10,fillAlpha:.6,gradient:"rainbow",lineWidth:2,mirror:-1,radial:!1,reflexAlpha:1,reflexBright:1,reflexRatio:.5,showPeaks:!1}},{name:"Radial overlay",options:{mode:5,barSpace:.1,gradient:"prism",radial:!0,ledBars:!1,showPeaks:!0,spinSpeed:1}},{name:"Reflex Bars",options:{mode:5,barSpace:.25,gradient:"rainbow",lumiBars:!1,radial:!1,reflexAlpha:.25,reflexBright:1,reflexFit:!0,reflexRatio:.3,ledBars:!1,showPeaks:!0}}],sa=new ne("AudioMotion");var oa=__webpack_require__(2238),la=__webpack_require__.n(oa),ca=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};const ua=new te([]);function ha(){return ua.getValue()}setTimeout((()=>ca(void 0,void 0,void 0,(function*(){yield ve("./lib/butterchurn-presets-base.min.js");const e=window.butterchurnPresets;e&&(ua.next(Object.keys(e).map((t=>({name:t,data:e[t]})))),setTimeout((()=>ca(void 0,void 0,void 0,(function*(){yield ve("./lib/butterchurn-presets-extra.min.js");const e=window.butterchurnPresetsExtra;e&&ua.next(ua.getValue().concat(Object.keys(e).map((t=>({name:t,data:e[t]})))))}))),1e3))}))),1e3);const da={get size(){return ha().length},observe:function(){return ua},find:function(e){return ua.getValue().find((t=>t.name===e))||null},get:ha,getNames:function(){return ua.getValue().map((e=>e.name))}},fa=new ne("Milkdrop");function ma(e){const t=Object.seal({...e}),r={__all__:[]};for(var n in t)r[n]=[];const i={set(e,t,n){let i;return i=function(e){const t=typeof e;return null==e||"object"!=t&&"function"!=t}(e[t])?e[t]:Array.isArray(e[t])?[...e[t]]:{...e[t]},e[t]=n,r[t]&&(r[t].map((e=>e(n,i))),r.__all__.map((e=>e(n,i)))),!0}};return new Proxy({...t,watch(e,t){"string"==typeof e&&e in r&&r[e].push(t),"function"==typeof e&&r.__all__.push(e)}},{set:i.set})}function pa(e,t){return function(r){return e*(1-r)+t*r}}var ga=Math.sqrt(50),Aa=Math.sqrt(10),ba=Math.sqrt(2);function va(e,t,r){var n,i,a,s,o=-1;if(r=+r,(e=+e)==(t=+t)&&r>0)return[e];if((n=t<e)&&(i=e,e=t,t=i),0===(s=function(e,t,r){var n=(t-e)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),a=n/Math.pow(10,i);return i>=0?(a>=ga?10:a>=Aa?5:a>=ba?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=ga?10:a>=Aa?5:a>=ba?2:1)}(e,t,r))||!isFinite(s))return[];if(s>0){let r=Math.round(e/s),n=Math.round(t/s);for(r*s<e&&++r,n*s>t&&--n,a=new Array(i=n-r+1);++o<i;)a[o]=(r+o)*s}else{s=-s;let r=Math.round(e*s),n=Math.round(t*s);for(r/s<e&&++r,n/s>t&&--n,a=new Array(i=n-r+1);++o<i;)a[o]=(r+o)/s}return n&&a.reverse(),a}var ya,wa=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ea(e){if(!(t=wa.exec(e)))throw new Error("invalid format: "+e);var t;return new _a({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function _a(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Ta(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function xa(e,t){var r=Ta(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}Ea.prototype=_a.prototype,_a.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Sa={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>xa(100*e,t),r:xa,s:function(e,t){var r=Ta(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(ya=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Ta(e,Math.max(0,t+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ka(e){return e}var Ia,Ca,Pa=Array.prototype.map,Ma=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Ra(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ba(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function La(e){let t,r,n;function i(e,n,i=0,a=e.length){if(i<a){if(0!==t(n,n))return a;do{const t=i+a>>>1;r(e[t],n)<0?i=t+1:a=t}while(i<a)}return i}return 2!==e.length?(t=Ra,r=(t,r)=>Ra(e(t),r),n=(t,r)=>e(t)-r):(t=e===Ra||e===Ba?e:Da,r=e,n=e),{left:i,center:function(e,t,r=0,a=e.length){const s=i(e,t,r,a-1);return s>r&&n(e[s-1],t)>-n(e[s],t)?s-1:s},right:function(e,n,i=0,a=e.length){if(i<a){if(0!==t(n,n))return a;do{const t=i+a>>>1;r(e[t],n)<=0?i=t+1:a=t}while(i<a)}return i}}}function Da(){return 0}Ia=function(e){var t,r,n=void 0===e.grouping||void 0===e.thousands?ka:(t=Pa.call(e.grouping,Number),r=e.thousands+"",function(e,n){for(var i=e.length,a=[],s=0,o=t[0],l=0;i>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),a.push(e.substring(i-=o,i+o)),!((l+=o+1)>n));)o=t[s=(s+1)%t.length];return a.reverse().join(r)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",s=void 0===e.decimal?".":e.decimal+"",o=void 0===e.numerals?ka:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Pa.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"−":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=Ea(e)).fill,r=e.align,h=e.sign,d=e.symbol,f=e.zero,m=e.width,p=e.comma,g=e.precision,A=e.trim,b=e.type;"n"===b?(p=!0,b="g"):Sa[b]||(void 0===g&&(g=12),A=!0,b="g"),(f||"0"===t&&"="===r)&&(f=!0,t="0",r="=");var v="$"===d?i:"#"===d&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",y="$"===d?a:/[%p]/.test(b)?l:"",w=Sa[b],E=/[defgprs%]/.test(b);function _(e){var i,a,l,d=v,_=y;if("c"===b)_=w(e)+_,e="";else{var T=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:w(Math.abs(e),g),A&&(e=function(e){e:for(var t,r=e.length,n=1,i=-1;n<r;++n)switch(e[n]){case".":i=t=n;break;case"0":0===i&&(i=n),t=n;break;default:if(!+e[n])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),T&&0==+e&&"+"!==h&&(T=!1),d=(T?"("===h?h:c:"-"===h||"("===h?"":h)+d,_=("s"===b?Ma[8+ya/3]:"")+_+(T&&"("===h?")":""),E)for(i=-1,a=e.length;++i<a;)if(48>(l=e.charCodeAt(i))||l>57){_=(46===l?s+e.slice(i+1):e.slice(i))+_,e=e.slice(0,i);break}}p&&!f&&(e=n(e,1/0));var x=d.length+e.length+_.length,S=x<m?new Array(m-x+1).join(t):"";switch(p&&f&&(e=n(S+e,S.length?m-_.length:1/0),S=""),r){case"<":e=d+e+_+S;break;case"=":e=d+S+e+_;break;case"^":e=S.slice(0,x=S.length>>1)+d+e+_+S.slice(x);break;default:e=S+d+e+_}return o(e)}return g=void 0===g?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),_.toString=function(){return e+""},_}return{format:h,formatPrefix:function(e,t){var r,n=h(((e=Ea(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor((r=t,((r=Ta(Math.abs(r)))?r[1]:NaN)/3)))),a=Math.pow(10,-i),s=Ma[8+i/3];return function(e){return n(a*e)+s}}}}({thousands:",",grouping:[3],currency:["$",""]}),Ca=Ia.format,Ia.formatPrefix;const Na=La(Ra),Fa=Na.right,Oa=(Na.left,La((function(e){return null===e?NaN:+e})).center,Fa);function za(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Ua(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function ja(){}var Va=.7,qa=1/Va,Qa="\\s*([+-]?\\d+)\\s*",Xa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Wa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ha=/^#([0-9a-f]{3,8})$/,Ga=new RegExp(`^rgb\\(${Qa},${Qa},${Qa}\\)$`),$a=new RegExp(`^rgb\\(${Wa},${Wa},${Wa}\\)$`),Ya=new RegExp(`^rgba\\(${Qa},${Qa},${Qa},${Xa}\\)$`),Ka=new RegExp(`^rgba\\(${Wa},${Wa},${Wa},${Xa}\\)$`),Ja=new RegExp(`^hsl\\(${Xa},${Wa},${Wa}\\)$`),Za=new RegExp(`^hsla\\(${Xa},${Wa},${Wa},${Xa}\\)$`),es={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ts(){return this.rgb().formatHex()}function rs(){return this.rgb().formatRgb()}function ns(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Ha.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?is(t):3===r?new ls(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?as(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?as(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Ga.exec(e))?new ls(t[1],t[2],t[3],1):(t=$a.exec(e))?new ls(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Ya.exec(e))?as(t[1],t[2],t[3],t[4]):(t=Ka.exec(e))?as(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Ja.exec(e))?ms(t[1],t[2]/100,t[3]/100,1):(t=Za.exec(e))?ms(t[1],t[2]/100,t[3]/100,t[4]):es.hasOwnProperty(e)?is(es[e]):"transparent"===e?new ls(NaN,NaN,NaN,0):null}function is(e){return new ls(e>>16&255,e>>8&255,255&e,1)}function as(e,t,r,n){return n<=0&&(e=t=r=NaN),new ls(e,t,r,n)}function ss(e){return e instanceof ja||(e=ns(e)),e?new ls((e=e.rgb()).r,e.g,e.b,e.opacity):new ls}function os(e,t,r,n){return 1===arguments.length?ss(e):new ls(e,t,r,null==n?1:n)}function ls(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function cs(){return`#${fs(this.r)}${fs(this.g)}${fs(this.b)}`}function us(){const e=hs(this.opacity);return`${1===e?"rgb(":"rgba("}${ds(this.r)}, ${ds(this.g)}, ${ds(this.b)}${1===e?")":`, ${e})`}`}function hs(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ds(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function fs(e){return((e=ds(e))<16?"0":"")+e.toString(16)}function ms(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new gs(e,t,r,n)}function ps(e){if(e instanceof gs)return new gs(e.h,e.s,e.l,e.opacity);if(e instanceof ja||(e=ns(e)),!e)return new gs;if(e instanceof gs)return e;var t=(e=e.rgb()).r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),s=NaN,o=a-i,l=(a+i)/2;return o?(s=t===a?(r-n)/o+6*(r<n):r===a?(n-t)/o+2:(t-r)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new gs(s,o,l,e.opacity)}function gs(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function As(e){return(e=(e||0)%360)<0?e+360:e}function bs(e){return Math.max(0,Math.min(1,e||0))}function vs(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}function ys(e,t,r,n,i){var a=e*e,s=a*e;return((1-3*e+3*a-s)*t+(4-6*a+3*s)*r+(1+3*e+3*a-3*s)*n+s*i)/6}function ws(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],a=e[n+1],s=n>0?e[n-1]:2*i-a,o=n<t-1?e[n+2]:2*a-i;return ys((r-n/t)*t,s,i,a,o)}}za(ja,ns,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ts,formatHex:ts,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return ps(this).formatHsl()},formatRgb:rs,toString:rs}),za(ls,os,Ua(ja,{brighter(e){return e=null==e?qa:Math.pow(qa,e),new ls(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Va:Math.pow(Va,e),new ls(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ls(ds(this.r),ds(this.g),ds(this.b),hs(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:cs,formatHex:cs,formatHex8:function(){return`#${fs(this.r)}${fs(this.g)}${fs(this.b)}${fs(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:us,toString:us})),za(gs,(function(e,t,r,n){return 1===arguments.length?ps(e):new gs(e,t,r,null==n?1:n)}),Ua(ja,{brighter(e){return e=null==e?qa:Math.pow(qa,e),new gs(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Va:Math.pow(Va,e),new gs(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new ls(vs(e>=240?e-240:e+120,i,n),vs(e,i,n),vs(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new gs(As(this.h),bs(this.s),bs(this.l),hs(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=hs(this.opacity);return`${1===e?"hsl(":"hsla("}${As(this.h)}, ${100*bs(this.s)}%, ${100*bs(this.l)}%${1===e?")":`, ${e})`}`}}));const Es=e=>()=>e;function _s(e,t){var r=t-e;return r?function(e,t){return function(r){return e+r*t}}(e,r):Es(isNaN(e)?t:e)}const Ts=function e(t){var r=function(e){return 1==(e=+e)?_s:function(t,r){return r-t?function(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}(t,r,e):Es(isNaN(t)?r:t)}}(t);function n(e,t){var n=r((e=os(e)).r,(t=os(t)).r),i=r(e.g,t.g),a=r(e.b,t.b),s=_s(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=i(t),e.b=a(t),e.opacity=s(t),e+""}}return n.gamma=e,n}(1);function xs(e){return function(t){var r,n,i=t.length,a=new Array(i),s=new Array(i),o=new Array(i);for(r=0;r<i;++r)n=os(t[r]),a[r]=n.r||0,s[r]=n.g||0,o[r]=n.b||0;return a=e(a),s=e(s),o=e(o),n.opacity=1,function(e){return n.r=a(e),n.g=s(e),n.b=o(e),n+""}}}function Ss(e,t){var r,n=t?t.length:0,i=e?Math.min(n,e.length):0,a=new Array(i),s=new Array(n);for(r=0;r<i;++r)a[r]=Ls(e[r],t[r]);for(;r<n;++r)s[r]=t[r];return function(e){for(r=0;r<i;++r)s[r]=a[r](e);return s}}function ks(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Is(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Cs(e,t){var r,n={},i={};for(r in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)r in e?n[r]=Ls(e[r],t[r]):i[r]=t[r];return function(e){for(r in n)i[r]=n[r](e);return i}}xs(ws),xs((function(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],a=e[n%t],s=e[(n+1)%t],o=e[(n+2)%t];return ys((r-n/t)*t,i,a,s,o)}}));var Ps=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ms=new RegExp(Ps.source,"g");function Rs(e,t){var r,n,i,a=Ps.lastIndex=Ms.lastIndex=0,s=-1,o=[],l=[];for(e+="",t+="";(r=Ps.exec(e))&&(n=Ms.exec(t));)(i=n.index)>a&&(i=t.slice(a,i),o[s]?o[s]+=i:o[++s]=i),(r=r[0])===(n=n[0])?o[s]?o[s]+=n:o[++s]=n:(o[++s]=null,l.push({i:s,x:Is(r,n)})),a=Ms.lastIndex;return a<t.length&&(i=t.slice(a),o[s]?o[s]+=i:o[++s]=i),o.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var r,n=0;n<t;++n)o[(r=l[n]).i]=r.x(e);return o.join("")})}function Bs(e,t){t||(t=[]);var r,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(r=0;r<n;++r)i[r]=e[r]*(1-a)+t[r]*a;return i}}function Ls(e,t){var r,n,i=typeof t;return null==t||"boolean"===i?Es(t):("number"===i?Is:"string"===i?(r=ns(t))?(t=r,Ts):Rs:t instanceof ns?Ts:t instanceof Date?ks:(n=t,!ArrayBuffer.isView(n)||n instanceof DataView?Array.isArray(t)?Ss:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Cs:Is:Bs))(e,t)}function Ds(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Ns(e){return+e}var Fs=[0,1];function Os(e){return e}function zs(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:(r=isNaN(t)?NaN:.5,function(){return r});var r}function Us(e,t,r){var n=e[0],i=e[1],a=t[0],s=t[1];return i<n?(n=zs(i,n),a=r(s,a)):(n=zs(n,i),a=r(a,s)),function(e){return a(n(e))}}function js(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)i[s]=zs(e[s],e[s+1]),a[s]=r(t[s],t[s+1]);return function(t){var r=Oa(e,t,1,n)-1;return a[r](i[r](t))}}function Vs(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function qs(){var e,t,r,n,i,a,s=Fs,o=Fs,l=Ls,c=Os;function u(){var e,t,r,l=Math.min(s.length,o.length);return c!==Os&&(e=s[0],t=s[l-1],e>t&&(r=e,e=t,t=r),c=function(r){return Math.max(e,Math.min(t,r))}),n=l>2?js:Us,i=a=null,h}function h(t){return null==t||isNaN(t=+t)?r:(i||(i=n(s.map(e),o,l)))(e(c(t)))}return h.invert=function(r){return c(t((a||(a=n(o,s.map(e),Is)))(r)))},h.domain=function(e){return arguments.length?(s=Array.from(e,Ns),u()):s.slice()},h.range=function(e){return arguments.length?(o=Array.from(e),u()):o.slice()},h.rangeRound=function(e){return o=Array.from(e),l=Ds,u()},h.clamp=function(e){return arguments.length?(c=!!e||Os,u()):c!==Os},h.interpolate=function(e){return arguments.length?(l=e,u()):l},h.unknown=function(e){return arguments.length?(r=e,h):r},function(r,n){return e=r,t=n,u()}}function Qs(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function Xs(e){return Math.log(e)}function Ws(e){return Math.exp(e)}function Hs(e){return-Math.log(-e)}function Gs(e){return-Math.exp(-e)}function $s(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Ys(e){return(t,r)=>-e(-t,r)}function Ks(e){const t=e(Xs,Ws),r=t.domain;let n,i,a=10;function s(){return n=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(a),i=function(e){return 10===e?$s:e===Math.E?Math.exp:t=>Math.pow(e,t)}(a),r()[0]<0?(n=Ys(n),i=Ys(i),e(Hs,Gs)):e(Xs,Ws),t}return t.base=function(e){return arguments.length?(a=+e,s()):a},t.domain=function(e){return arguments.length?(r(e),s()):r()},t.ticks=e=>{const t=r();let s=t[0],o=t[t.length-1];const l=o<s;l&&([s,o]=[o,s]);let c,u,h=n(s),d=n(o);const f=null==e?10:+e;let m=[];if(!(a%1)&&d-h<f){if(h=Math.floor(h),d=Math.ceil(d),s>0){for(;h<=d;++h)for(c=1;c<a;++c)if(u=h<0?c/i(-h):c*i(h),!(u<s)){if(u>o)break;m.push(u)}}else for(;h<=d;++h)for(c=a-1;c>=1;--c)if(u=h>0?c/i(-h):c*i(h),!(u<s)){if(u>o)break;m.push(u)}2*m.length<f&&(m=va(s,o,f))}else m=va(h,d,Math.min(d-h,f)).map(i);return l?m.reverse():m},t.tickFormat=(e,r)=>{if(null==e&&(e=10),null==r&&(r=10===a?"s":","),"function"!=typeof r&&(a%1||null!=(r=Ea(r)).precision||(r.trim=!0),r=Ca(r)),e===1/0)return r;const s=Math.max(1,a*e/t.ticks().length);return e=>{let t=e/i(Math.round(n(e)));return t*a<a-.5&&(t*=a),t<=s?r(e):""}},t.nice=()=>r(function(e,t){var r,n=0,i=(e=e.slice()).length-1,a=e[n],s=e[i];return s<a&&(r=n,n=i,i=r,r=a,a=s,s=r),e[n]=t.floor(a),e[i]=t.ceil(s),e}(r(),{floor:e=>i(Math.floor(n(e))),ceil:e=>i(Math.ceil(n(e)))})),t}function Js(){const e=Ks(qs()).domain([1,10]);return e.copy=()=>Vs(e,Js()).base(e.base()),Qs.apply(e,arguments),e}function Zs(e,t){let r;if(void 0===t)for(const t of e)null!=t&&(r>t||void 0===r&&t>=t)&&(r=t);else{let n=-1;for(let i of e)null!=(i=t(i,++n,e))&&(r>i||void 0===r&&i>=i)&&(r=i)}return r}const eo={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>e*(2-e),easeInOutQuad:e=>e<.5?2*e*e:(4-2*e)*e-1,easeInCubic:e=>e*e*e,easeOutCubic:e=>--e*e*e+1,easeInOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1- --e*e*e*e,easeInOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1+--e*e*e*e*e,easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e};var to=__webpack_require__(5754),ro=__webpack_require__.n(to),no=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::spotifyAuth");const io=new ne("spotifyAuth"),ao=new r("spotify/auth"),so=location.hostname,oo=("localhost"===so?`http://${so}:${location.port}`:`https://${so}`)+"/auth/spotify/callback/",lo="https://accounts.spotify.com",co=new te("");function uo(){return co.pipe(rt())}function ho(){return no(this,void 0,void 0,(function*(){if(""===co.getValue())try{mo(yield function(){return no(this,void 0,void 0,(function*(){const e=function(e){let t="";const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let e=0;e<64;e++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}(),t=yield function(e){return no(this,void 0,void 0,(function*(){const t=yield crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}))}(e);return ao.setItem("code_verifier",e),new Promise(((e,r)=>{let n=null;const i=t=>{if(/(localhost|ampcast)/.test(t.origin)){if(clearInterval(s),window.removeEventListener("message",i,!1),null==n||n.close(),n=null,t.origin!==location.origin)return void r({message:`Origin ${t.origin} does not match ${location.origin}`});(function(e){return no(this,void 0,void 0,(function*(){const t=ao.getItem("code_verifier"),r=yield fetch(`${lo}/api/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({client_id:lt,grant_type:"authorization_code",code:e,redirect_uri:oo,code_verifier:t})});if(!r.ok)throw r;return yield r.json()}))})(t.data.code).then(e,r)}};window.addEventListener("message",i,!1);const a=new URLSearchParams({client_id:lt,scope:["user-read-recently-played","user-read-playback-position","user-top-read","user-read-playback-state","user-modify-playback-state","user-read-currently-playing","streaming","user-read-email","user-read-private","playlist-read-private","user-library-read"].join(" "),redirect_uri:oo,response_type:"code",code_challenge_method:"S256",code_challenge:t});n=window.open(`${lo}/authorize?${a}`,"Spotify","popup");const s=setInterval((()=>{(null==n?void 0:n.closed)&&(clearInterval(s),r({message:"access_denied"}))}),500)}))}))}())}catch(e){io.log("Could not obtain access token."),io.error(e)}}))}function fo(){return no(this,void 0,void 0,(function*(){const e=po(),t=null==e?void 0:e.refresh_token;if(t){const e=yield fetch(`${lo}/api/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:new URLSearchParams({client_id:lt,grant_type:"refresh_token",refresh_token:t})});if(!e.ok)throw Ao(),Error(e.statusText);const r=yield e.json();return mo(r),r.access_token}throw Ao(),Error("No 'refresh_token'")}))}function mo(e){const{access_token:t,refresh_token:r,expires_in:n}=e,i=new Date,a=new Date(i.setSeconds(i.getSeconds()+n)).toISOString();ao.setItem("token",JSON.stringify({access_token:t,refresh_token:r,expires_at:a})),go(t)}function po(){const e=JSON.parse(ao.getItem("token")||"null");return e&&(e.expires_at=new Date(e.expires_at)),e}function go(e){io.log("Access token successfully obtained."),co.next(e)}function Ao(){ao.removeItem("token"),co.next("")}!function(){no(this,void 0,void 0,(function*(){const e=po();e&&(e.expires_at.getTime()-Date.now()<=0?yield fo():go(e.access_token))}))}();var bo=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};class vo{constructor(e,t){this.defaultConfig={minPageSize:vo.minPageSize,maxPageSize:vo.maxPageSize,pageSize:vo.maxPageSize},this.pageNumber=1;const r=Object.assign(Object.assign({},this.defaultConfig),t);this.pager=new Wt(((t=this.defaultConfig.pageSize)=>bo(this,void 0,void 0,(function*(){const r=(this.pageNumber-1)*t,n=()=>bo(this,void 0,void 0,(function*(){const{items:n,total:i,next:a}=yield e(r,t);return this.pageNumber++,{items:n.map((e=>this.createMediaObject(e))),total:i,atEnd:!a}}));try{return yield n()}catch(e){if(401===e.status)return yield fo(),yield n();throw e}}))),r)}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeMaxSize(){return this.pager.observeMaxSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createMediaObject(e){switch(e.type){case"episode":return this.createMediaItemFromEpisode(e);case"artist":return this.createMediaArtist(e);case"album":return this.createMediaAlbum(e);case"playlist":return this.createMediaPlaylist(e);case"track":return this.createMediaItemFromTrack(e)}}createMediaItemFromEpisode(e){return Object.assign(Object.assign({},xe(Ie.Media)),{mediaType:yt.Audio,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,duration:e.duration_ms/1e3,thumbnails:e.images,unplayable:!1===e.is_playable})}createMediaAlbum(e){var t;return Object.assign(Object.assign({},xe(Ie.Album)),{src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,artist:e.artists.map((e=>e.name)).join("/"),year:new Date(e.release_date).getFullYear(),thumbnails:e.images,trackCount:null===(t=e.tracks)||void 0===t?void 0:t.total,pager:this.createAlbumPager(e)})}createMediaArtist(e){return Object.assign(Object.assign({},xe(Ie.Artist)),{src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,thumbnails:e.images,pager:this.createArtistAlbumsPager(e)})}createMediaPlaylist(e){return Object.assign(Object.assign({},xe(Ie.Playlist)),{src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,thumbnails:e.images,trackCount:e.tracks.total,pager:this.createPlaylistPager(e),owner:{name:e.owner.display_name||"",url:e.owner.external_urls.spotify}})}createMediaItemFromTrack(e){var t,r,n,i,a;const s=/album|compilation/i.test((null===(t=e.album)||void 0===t?void 0:t.album_type)||"")?e.album:null;return Object.assign(Object.assign({},xe(Ie.Media)),{mediaType:yt.Audio,src:e.uri,externalUrl:e.external_urls.spotify,title:e.name,artist:e.artists.map((e=>e.name)).join("/"),albumArtist:null===(r=null==s?void 0:s.artists[0])||void 0===r?void 0:r.name,album:null==s?void 0:s.name,duration:e.duration_ms/1e3,playedOn:e.played_at&&new Date(e.played_at).getTime()||void 0,genre:null===(i=null===(n=e.album)||void 0===n?void 0:n.genres)||void 0===i?void 0:i.join(";"),disc:s?e.disc_number:void 0,track:s?e.track_number:void 0,year:e.album?new Date(e.album.release_date).getFullYear():void 0,thumbnails:null===(a=e.album)||void 0===a?void 0:a.images,unplayable:!1===e.is_playable})}createArtistAlbumsPager(e){const t=this.getMarket();return new vo(((r,n)=>bo(this,void 0,void 0,(function*(){const{items:i,total:a,next:s}=yield Eo.getArtistAlbums(e.id,{offset:r,limit:n,market:t});return{items:i,total:a,next:s}}))))}createAlbumPager(e){var t;const r=null===(t=e.tracks)||void 0===t?void 0:t.items;if(r&&r.length===e.total_tracks)return new tt(r.map((e=>this.createMediaItemFromTrack(e))));{const t=this.getMarket();return new vo(((r,n)=>bo(this,void 0,void 0,(function*(){return yield Eo.getAlbumTracks(e.id,{offset:r,limit:n,market:t})}))))}}createPlaylistPager(e){const t=this.getMarket();return new vo(((r,n)=>bo(this,void 0,void 0,(function*(){const{items:i,total:a,next:s}=yield Eo.getPlaylistTracks(e.id,{offset:r,limit:n,market:t});return{items:i.map((e=>e.track)),total:a,next:s}}))))}getMarket(){return ao.getItem("market")||""}}vo.minPageSize=10,vo.maxPageSize=50;var yo=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::spotify");const wo=new ne("spotify"),Eo=new(ro()),_o={view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","Duration"]};function To(){return ao.getItem("market")||""}const xo={id:"spotify",title:"Spotify",icon:"spotify",sources:[{id:"spotify/recently-played",title:"Recently Played",icon:"clock",itemType:Ie.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search(){return new vo(((e,t)=>yo(this,void 0,void 0,(function*(){const{items:e,total:r}=yield Eo.getMyRecentlyPlayedTracks({limit:t});return{items:e.map((e=>Object.assign({played_at:e.played_at},e.track))),total:r,next:void 0}}))),{maxSize:50,pageSize:50})}},{id:"spotify/top-tracks",title:"Top Tracks",icon:"star",itemType:Ie.Media,layout:_o,search(){return new vo(((e,t)=>yo(this,void 0,void 0,(function*(){return Eo.getMyTopTracks({offset:e,limit:t})}))))}},{id:"spotify/liked-songs",title:"Liked Songs",icon:"heart",itemType:Ie.Media,layout:_o,search(){const e=To();return new vo(((t,r)=>yo(this,void 0,void 0,(function*(){const{items:n,total:i,next:a}=yield Eo.getMySavedTracks({offset:t,limit:r,market:e});return{items:n.map((e=>e.track)),total:i,next:a}}))))}},{id:"spotify/liked-albums",title:"Liked Albums",icon:"heart",itemType:Ie.Album,search(){const e=To();return new vo(((t,r)=>yo(this,void 0,void 0,(function*(){const{items:n,total:i,next:a}=yield Eo.getMySavedAlbums({offset:t,limit:r,market:e});return{items:n.map((e=>e.album)),total:i,next:a}}))),{calculatePageSize:!0})}},{id:"spotify/playlists",title:"Playlists",icon:"playlists",itemType:Ie.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","TrackCount","Owner"]},search(){const e=To();return new vo(((t,r)=>yo(this,void 0,void 0,(function*(){const{items:n,total:i,next:a}=yield Eo.getUserPlaylists(void 0,{offset:t,limit:r,market:e});return{items:n,total:i,next:a}}))))}}],searches:[{id:"spotify/search/songs",title:"Songs",icon:"",itemType:Ie.Media,layout:_o,searchable:!0,search(e){if(e){const t=To();return new vo(((r,n)=>yo(this,void 0,void 0,(function*(){const{tracks:{items:i,total:a,next:s}}=yield Eo.searchTracks(e,{offset:r,limit:n,market:t});return{items:i,total:a,next:s}}))),{maxSize:250})}return new tt}},{id:"spotify/search/albums",title:"Albums",icon:"",itemType:Ie.Album,searchable:!0,search(e){if(e){const t=To();return new vo(((r,n)=>yo(this,void 0,void 0,(function*(){const{albums:{items:i,total:a,next:s}}=yield Eo.searchAlbums(e,{offset:r,limit:n,market:t});return{items:i,total:a,next:s}}))),{maxSize:250})}return new tt}},{id:"spotify/search/artists",title:"Artists",icon:"",itemType:Ie.Artist,searchable:!0,search(e){if(e){const t=To();return new vo(((r,n)=>yo(this,void 0,void 0,(function*(){const{artists:{items:i,total:a,next:s}}=yield Eo.searchArtists(e,{offset:r,limit:n,market:t});return{items:i,total:a,next:s}}))),{maxSize:250})}return new tt}},{id:"spotify/search/playlists",title:"Playlists",icon:"",itemType:Ie.Playlist,searchable:!0,search(e){if(e){const t=To();return new vo(((r,n)=>yo(this,void 0,void 0,(function*(){const{playlists:{items:i,total:a,next:s}}=yield Eo.searchPlaylists(e,{offset:r,limit:n,market:t});return{items:i,total:a,next:s}}))),{maxSize:250})}return new tt}}],observeIsLoggedIn:function(){return uo().pipe(it((e=>""!==e)),rt())},login:ho,logout:function(){return no(this,void 0,void 0,(function*(){Ao(),ao.clear()}))}};function So(e,t){return void 0===e&&(e=0),void 0===t&&(t=sn),e<0&&(e=0),Vn(e,e,t)}function ko(){return ni(1)}function Io(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ko()(Je(e,Re(e)))}function Co(e,t){return t?function(r){return Io(t.pipe(Nt(1),We((function(e,t){e.subscribe(He(t,L))}))),r.pipe(Co(e)))}:Bt((function(t,r){return e(t,r).pipe(Nt(1),function(e){return it((function(){return e}))}(t))}))}function Po(e,t){void 0===t&&(t=sn);var r=Vn(e,t);return Co((function(){return r}))}uo().subscribe((e=>Eo.setAccessToken(e))),To()||uo().pipe(ui((e=>!e)),Bt((()=>Eo.getMe())),Rt((e=>ao.setItem("market",e.country))),Nt(1)).subscribe(wo);var Mo,Ro,Bo=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))},Lo=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},Do=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};const No=new ne("SpotifyPlayer"),Fo="Spotify player not connected.",Oo=(e,t)=>e.paused===t.paused&&e.position===t.position;Mo=new WeakMap,Ro=new WeakMap;const zo=new class{constructor(e){this.accessToken$=e,this.player=null,this.paused$=new te(!0),this.src$=new te(""),this.error$=new Z,this.ready$=new Z,this.state$=new te(null),this.loadedSrc="",this.currentTrackSrc="",this.isLoggedIn=!1,this.deviceId="",this.autoplay=!1,this.hidden=!0,this.loop=!1,Mo.set(this,!0),Ro.set(this,1),this.onSpotifyWebPlaybackSDKReady=()=>{No.log("onSpotifyWebPlaybackSDKReady"),this.observeAccessToken().pipe(Ft((e=>""!==e)),Rt((e=>{let t=!1;const r=new Spotify.Player({name:"ampcast",getOAuthToken:r=>Bo(this,void 0,void 0,(function*(){t&&(e=yield fo()),t=!0,r(e)})),volume:this.muted?0:this.volume});r.addListener("initialization_error",No.error),r.addListener("authentication_error",No.error),r.addListener("account_error",No.error),r.addListener("playback_error",(e=>this.error$.next(e))),r.addListener("player_state_changed",(e=>this.state$.next(e))),r.addListener("not_ready",(()=>{No.log("not_ready"),this.deviceId=""})),r.addListener("ready",(({device_id:e})=>{No.log("ready"),this.player=r,this.deviceId=e,this.ready$.next(void 0)})),r.connect()})),Nt(1)).subscribe(No)},window.onSpotifyWebPlaybackSDKReady=this.onSpotifyWebPlaybackSDKReady,this.observeReady().pipe(Bt((()=>this.observeIsLoggedIn())),Ot((e=>e?this.observeSrc():et)),Zr(this.observeAccessToken()),Ot((([e,t])=>e&&e!==this.loadedSrc?this.observeNotLoading().pipe(Co((()=>this.loadError?this.reconnect():Ze(0))),Bt((()=>this.addToQueue(e,t))),Bt((()=>this.observeState().pipe(it((e=>e.track_window.current_track.uri)),ui((e=>e===this.currentTrackSrc)),Rt((e=>this.currentTrackSrc=e)),Nt(1)))),Lt((t=>(this.loadedSrc="",this.currentTrackSrc="",this.loadError={src:e,error:t,timeStamp:Date.now()},this.error$.next(t),et))),Nt(1)):et))).subscribe(No),this.observeState().pipe(Rt((e=>{this.paused&&!e.paused?this.player.pause().then(void 0,No.error):e.paused&&!this.paused&&e.track_window.current_track.uri===this.currentTrackSrc&&this.player.resume().then(void 0,(e=>this.error$.next(e)))}))).subscribe(No),this.observeIsLoggedIn().pipe(ui((e=>e===this.isLoggedIn)),Rt((e=>{this.isLoggedIn=e,e||this.paused||(this.stop(),this.error$.next(Error(Fo)))}))).subscribe(No),this.observeError().subscribe(No.error),ve("https://sdk.scdn.co/spotify-player.js")}get muted(){return Lo(this,Mo,"f")}set muted(e){Lo(this,Mo,"f")!==e&&(Do(this,Mo,e,"f"),this.setVolume(e?0:this.volume))}get volume(){return Lo(this,Ro,"f")}set volume(e){Lo(this,Ro,"f")!==e&&(Do(this,Ro,e,"f"),this.setVolume(this.muted?0:e))}observeCurrentTime(){return ii(this.observeCurrentTrackState(),this.observePaused().pipe(Ot((e=>e?this.getCurrentState():So(250).pipe(Bt((()=>this.getCurrentState()))))))).pipe(it((e=>e?e.position/1e3:0)),rt())}observeDuration(){return this.observeSrc().pipe(Ot((e=>e?this.observeCurrentTrackState().pipe(it((e=>e.duration/1e3)),Nt(1)):Ze(0))))}observeEnded(){return this.observeCurrentTrackState().pipe(rt(Oo),Zr(this.observePaused()),it((([e,t])=>!t&&e.paused&&0===e.position)),Ft((e=>e)),it((()=>{})))}observeError(){return this.error$}observePlaying(){return this.observeCurrentTrackState().pipe(rt(Oo),Zr(this.observePaused()),it((([e,t])=>!t&&!e.paused)),Ft((e=>e)),it((()=>{})))}observeCurrentTrackState(){return this.observeState().pipe(Ft((e=>{var t,r;return(null===(r=null===(t=e.track_window)||void 0===t?void 0:t.current_track)||void 0===r?void 0:r.uri)===this.currentTrackSrc})),it((e=>e)))}appendTo(){}load(e){this.src$.next(e),this.player&&this.isLoggedIn?this.autoplay&&(this.paused$.next(!1),e===this.loadedSrc&&this.player.resume().then(void 0,(e=>this.error$.next(e)))):this.autoplay&&this.error$.next(Error(Fo))}play(){var e;this.paused$.next(!1),this.player&&this.isLoggedIn?this.src===(null===(e=this.loadError)||void 0===e?void 0:e.src)?this.error$.next(this.loadError.error):this.src===this.loadedSrc&&this.player.resume().then(void 0,(e=>this.error$.next(e))):this.error$.next(Error(Fo))}pause(){var e;this.paused$.next(!0),this.loadedSrc&&(null===(e=this.player)||void 0===e||e.pause())}stop(){var e;this.paused$.next(!0),this.loadedSrc&&(null===(e=this.player)||void 0===e||e.seek(0).then((()=>this.player.pause())))}seek(e){var t;null===(t=this.player)||void 0===t||t.seek(1e3*e)}resize(){}get paused(){return this.paused$.getValue()}get src(){return this.src$.getValue()}observeAccessToken(){return this.accessToken$}observeIsLoggedIn(){return this.observeAccessToken().pipe(it((e=>!!e)),rt())}observeNotLoading(){return this.state$.pipe(it((e=>!0!==(null==e?void 0:e.loading))),rt(),it((()=>{})))}observePaused(){return this.paused$.pipe(rt())}observeReady(){return this.ready$.pipe(Nt(1))}observeSrc(){return this.src$.pipe(rt())}observeState(){return this.state$.pipe(Ft(Ae))}getCurrentState(){return this.player?this.player.getCurrentState():Promise.resolve(null)}addToQueue(e,t,r=3){return Bo(this,void 0,void 0,(function*(){if(!t)throw Error(Fo);const n=yield fetch(`https://api.spotify.com/v1/me/player/play?device_id=${this.deviceId}`,{method:"PUT",body:JSON.stringify({uris:[e],position_ms:0}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!n.ok){if(401===n.status&&r>0){const t=yield fo();return this.addToQueue(e,t,--r)}throw n}this.loadError=void 0,this.loadedSrc=e}))}reconnect(){return Je(Promise.resolve().then((()=>this.player.disconnect()))).pipe(Po(1e3),Bt((()=>this.player.connect())),Po(1e3),Rt((()=>this.loadError=void 0)),it((()=>{})))}setVolume(e){return this.player?this.player.setVolume(e).then(void 0,No.error):Promise.resolve()}}(uo());class Uo{currentTrackId="";currentTrackAnalysis=null;constructor({volumeSmoothing:e=100}={}){this.state=ma({intervalTypes:["tatums","segments","beats","bars","sections"],activeIntervals:ma({tatums:{},segments:{},beats:{},bars:{},sections:{}}),trackAnalysis:{},initialTrackProgress:0,initialStart:0,trackProgress:0,active:!1,initialized:!1,volumeSmoothing:e,volume:0,queues:{volume:[],beat:[]}}),zo.observeCurrentTrackState().subscribe((async e=>{const t=e.track_window?.current_track?.id;if(t&&this.currentTrackId!==t){this.currentTrackId=t;try{this.currentTrackAnalysis=await Eo.getAudioAnalysisForTrack(t),e=await zo.getCurrentState()}catch(t){console.error(t),this.currentTrackAnalysis=null,e=null}}const r=!(!this.currentTrackAnalysis||!e||e.paused||e.loading);this.state.active!==r&&(r&&this.updateState(e),this.state.active=r)})),this.initHooks()}get volumeSmoothing(){return this.state.volumeSmoothing}set volumeSmoothing(e){this.state.volumeSmoothing=e}initHooks(){this.hooks={tatum:()=>{},segment:()=>{},beat:()=>{},bar:()=>{},section:()=>{}},this.state.activeIntervals.watch("tatums",(e=>this.hooks.tatum(e))),this.state.activeIntervals.watch("segments",(e=>this.hooks.segment(e))),this.state.activeIntervals.watch("beats",(e=>this.hooks.beat(e))),this.state.activeIntervals.watch("bars",(e=>this.hooks.bar(e))),this.state.activeIntervals.watch("sections",(e=>this.hooks.section(e)))}async updateState(e){this.state.trackAnalysis=JSON.parse(JSON.stringify(this.currentTrackAnalysis)),this.state.intervalTypes.forEach((t=>{const r=this.state.trackAnalysis[t];r[0].duration=r[0].start+r[0].duration,r[0].start=0,r[r.length-1].duration=e.duration/1e3-r[r.length-1].start,r.forEach((e=>{e.loudness_max_time&&(e.loudness_max_time=1e3*e.loudness_max_time),e.start=1e3*e.start,e.duration=1e3*e.duration}))})),this.state.initialTrackProgress=e.position,this.state.trackProgress=e.position,this.state.initialStart=window.performance.now(),!1===this.state.initialized&&(this.state.initialized=!0,requestAnimationFrame(this.tick.bind(this)))}setActiveIntervals(){const e=e=>{const t=this.state.trackAnalysis[e],r=this.state.trackProgress;for(let e=0;e<t.length;e++){if(e===t.length-1)return e;if(t[e].start<r&&r<t[e+1].start)return e}};this.state.intervalTypes.forEach((t=>{const r=e(t);this.state.activeIntervals[t].start&&r===this.state.activeIntervals[t].index||(this.state.activeIntervals[t]={...this.state.trackAnalysis[t][r],index:r});const{start:n,duration:i}=this.state.activeIntervals[t],a=this.state.trackProgress-n;this.state.activeIntervals[t].elapsed=a,this.state.activeIntervals[t].progress=function(e,t="easeOutQuart"){if(!eo[t])throw new Error(`Unknown easing function "${t}"`);const r=Math.min(Math.max(0,e),1);return eo[t](r)}(a/i)}))}getVolume(){const{loudness_max:e,loudness_start:t,loudness_max_time:r,duration:n,elapsed:i,start:a,index:s}=this.state.activeIntervals.segments;if(!this.state.trackAnalysis.segments[s+1])return 0;const o=this.state.trackAnalysis.segments[s+1].loudness_start,l=a+i;if(i<r){const n=Math.min(1,i/r);return pa(t,e)(n)}{const t=l-(a+r),i=n-r,s=Math.min(1,t/i);return pa(e,o)(s)}}watch(e,t){this.state.watch(e,t)}on(e,t){this.hooks[e]=t}get isActive(){return!0===this.state.active}get tatum(){return this.state.activeIntervals.tatums}get segment(){return this.state.activeIntervals.segments}get beat(){return this.state.activeIntervals.beats}get bar(){return this.state.activeIntervals.bars}get section(){return this.state.activeIntervals.sections}getInterval(e){return this.state.activeIntervals[e+"s"]}tick(e){if(requestAnimationFrame(this.tick.bind(this)),!this.state.active)return;this.state.trackProgress=e-this.state.initialStart+this.state.initialTrackProgress,this.setActiveIntervals();const t=this.getVolume(),r=this.state.queues;function n(e){return e.reduce(((e,t)=>e+t))/e.length}r.volume.unshift(t),r.volume.length>400&&r.volume.pop(),r.beat.unshift(t),r.beat.length>this.state.volumeSmoothing&&r.beat.pop();const i=Js().domain([Zs(r.volume),n(r.volume)]).range([0,1]),a=n(r.beat);this.volume=i(a)}}class jo{animationFrameId=0;constructor({main:e=null,hidpi:t=!0,fill:r=null}={}){this.hidpi=t,this.active=!1,this.queue=[],this.fill=r,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.resize(100,100),null!==e&&this.add("main",e)}appendTo(e){e.appendChild(this.canvas)}resize(e,t){const r=this.hidpi?window.devicePixelRatio:1;this.width=e,this.height=t,this.canvas.width=e*r,this.canvas.height=t*r,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.ctx.scale(r,r)}add(e,t,r=null){this.queue.push({name:e,method:t,duration:r,start:window.performance.now()})}remove(e){this.queue=this.queue.filter((t=>t.name!==e))}start(){!0!==this.active&&(this.active=!0,this.animationFrameId=requestAnimationFrame(this.loop.bind(this)))}stop(){!1!==this.active&&(this.active=!1,cancelAnimationFrame(this.animationFrameId))}paint(e,{name:t,start:r,duration:n,method:i}){const a=e-r,s="number"==typeof n?Math.min(a/n,1):null,o={ctx:this.ctx,width:this.width,height:this.height,largest:Math.max(this.width,this.height),smallest:Math.min(this.width,this.height),now:e,progress:s,duration:n,elapsed:a,start:r};this.fill&&(this.ctx.save(),this.ctx.fillStyle=this.fill,this.ctx.fillRect(0,0,this.width,this.height),this.ctx.restore()),i(o),1===s&&this.remove(t)}loop(e){this.active&&(this.animationFrameId=requestAnimationFrame(this.loop.bind(this))),this.queue.forEach((t=>this.paint(e,t)))}}class Vo{constructor(e=!0){this.sync=new Uo,this.sketch=new jo({main:this.paint.bind(this),hidpi:e}),this.watch(),this.hooks()}appendTo(e){this.sketch.appendTo(e)}load(e){this.preset=e,this.sync.volumeSmoothing=e?.volumeSmoothing??100}watch(){this.sync.watch("active",(e=>{!0===e?this.sketch.start():this.sketch.stop()}))}hooks(){this.sync.on("tatum",(e=>{this.preset?.onTatum?.(e)})),this.sync.on("segment",(e=>{this.preset?.onSegment?.(e)})),this.sync.on("beat",(e=>{this.preset?.onBeat?.(e)})),this.sync.on("bar",(e=>{this.preset?.onBar?.(e)})),this.sync.on("section",(e=>{this.preset?.onSection?.(e)}))}paint({ctx:e,height:t,width:r,now:n}){this.preset?.onPaint?.({ctx:e,height:t,width:r,now:n,sync:this.sync})}resize(e,t){this.sketch.resize(e,t)}start(){this.sketch.start()}stop(){this.sketch.stop()}}const qo=2*Math.PI,Qo={volumeSmoothing:10,theme:["#18FF2A","#7718FF","#06C5FE","#FF4242","#18FF2A"],lastColor:"#18FF2A",nextColor:"#18FF2A",onBar(){this.lastColor=this.nextColor||this.getRandomElement(this.theme),this.nextColor=this.getRandomElement(this.theme.filter((e=>e!==this.nextColor)))},onPaint({ctx:e,height:t,width:r,now:n,sync:i}){const a=ws([0,10*i.volume,0])(i.bar.progress),s=ws([0,300*i.volume,0])(i.beat.progress);e.fillStyle="rgba(0, 0, 0, .08)",e.fillRect(0,0,r,t),e.lineWidth=a,e.strokeStyle=Ts(this.lastColor,this.nextColor)(i.bar.progress),function(e,t,r,n,i,a=5){const s=e=>n*Math.sin(e/i+t)+r,{width:o}=e.canvas;e.beginPath();for(var l=-50;l<o+50;l+=a)-50===l?e.moveTo(l,s(l)):e.lineTo(l,s(l))}(e,n/50,t/2,50*i.volume,100),e.stroke(),e.fillStyle="rgba(0, 0, 0, 1)",e.beginPath(),e.lineWidth=s,function(e,t,r,n,i=0,a=qo){e.beginPath(),e.arc(t,r,n,i,a),e.closePath()}(e,r/2,t/2,i.volume*t/5+s/10),e.stroke(),e.fill()},getRandomElement:e=>e[Math.floor(Math.random()*e.length)]},Xo=new ne("SpotifyViz");function Wo(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var r=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function Ho(e){return Math.min(1,Math.max(0,e))}function Go(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function $o(e){return e<=1?"".concat(100*Number(e),"%"):e}function Yo(e){return 1===e.length?"0"+e:String(e)}function Ko(e,t,r){e=Wo(e,255),t=Wo(t,255),r=Wo(r,255);var n=Math.max(e,t,r),i=Math.min(e,t,r),a=0,s=0,o=(n+i)/2;if(n===i)s=0,a=0;else{var l=n-i;switch(s=o>.5?l/(2-n-i):l/(n+i),n){case e:a=(t-r)/l+(t<r?6:0);break;case t:a=(r-e)/l+2;break;case r:a=(e-t)/l+4}a/=6}return{h:a,s,l:o}}function Jo(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*r*(t-e):r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Zo(e,t,r){e=Wo(e,255),t=Wo(t,255),r=Wo(r,255);var n=Math.max(e,t,r),i=Math.min(e,t,r),a=0,s=n,o=n-i,l=0===n?0:o/n;if(n===i)a=0;else{switch(n){case e:a=(t-r)/o+(t<r?6:0);break;case t:a=(r-e)/o+2;break;case r:a=(e-t)/o+4}a/=6}return{h:a,s:l,v:s}}function el(e,t,r,n){var i=[Yo(Math.round(e).toString(16)),Yo(Math.round(t).toString(16)),Yo(Math.round(r).toString(16))];return n&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function tl(e){return rl(e)/255}function rl(e){return parseInt(e,16)}var nl={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var il="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),al="[\\s|\\(]+(".concat(il,")[,|\\s]+(").concat(il,")[,|\\s]+(").concat(il,")\\s*\\)?"),sl="[\\s|\\(]+(".concat(il,")[,|\\s]+(").concat(il,")[,|\\s]+(").concat(il,")[,|\\s]+(").concat(il,")\\s*\\)?"),ol={CSS_UNIT:new RegExp(il),rgb:new RegExp("rgb"+al),rgba:new RegExp("rgba"+sl),hsl:new RegExp("hsl"+al),hsla:new RegExp("hsla"+sl),hsv:new RegExp("hsv"+al),hsva:new RegExp("hsva"+sl),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function ll(e){return Boolean(ol.CSS_UNIT.exec(String(e)))}var cl=function(){function e(t,r){var n;if(void 0===t&&(t=""),void 0===r&&(r={}),t instanceof e)return t;"number"==typeof t&&(t=function(e){return{r:e>>16,g:(65280&e)>>8,b:255&e}}(t)),this.originalInput=t;var i=function(e){var t,r,n,i={r:0,g:0,b:0},a=1,s=null,o=null,l=null,c=!1,u=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(nl[e])e=nl[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var r=ol.rgb.exec(e);return r?{r:r[1],g:r[2],b:r[3]}:(r=ol.rgba.exec(e))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=ol.hsl.exec(e))?{h:r[1],s:r[2],l:r[3]}:(r=ol.hsla.exec(e))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=ol.hsv.exec(e))?{h:r[1],s:r[2],v:r[3]}:(r=ol.hsva.exec(e))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=ol.hex8.exec(e))?{r:rl(r[1]),g:rl(r[2]),b:rl(r[3]),a:tl(r[4]),format:t?"name":"hex8"}:(r=ol.hex6.exec(e))?{r:rl(r[1]),g:rl(r[2]),b:rl(r[3]),format:t?"name":"hex"}:(r=ol.hex4.exec(e))?{r:rl(r[1]+r[1]),g:rl(r[2]+r[2]),b:rl(r[3]+r[3]),a:tl(r[4]+r[4]),format:t?"name":"hex8"}:!!(r=ol.hex3.exec(e))&&{r:rl(r[1]+r[1]),g:rl(r[2]+r[2]),b:rl(r[3]+r[3]),format:t?"name":"hex"}}(e)),"object"==typeof e&&(ll(e.r)&&ll(e.g)&&ll(e.b)?(t=e.r,r=e.g,n=e.b,i={r:255*Wo(t,255),g:255*Wo(r,255),b:255*Wo(n,255)},c=!0,u="%"===String(e.r).substr(-1)?"prgb":"rgb"):ll(e.h)&&ll(e.s)&&ll(e.v)?(s=$o(e.s),o=$o(e.v),i=function(e,t,r){e=6*Wo(e,360),t=Wo(t,100),r=Wo(r,100);var n=Math.floor(e),i=e-n,a=r*(1-t),s=r*(1-i*t),o=r*(1-(1-i)*t),l=n%6;return{r:255*[r,s,a,a,o,r][l],g:255*[o,r,r,s,a,a][l],b:255*[a,a,o,r,r,s][l]}}(e.h,s,o),c=!0,u="hsv"):ll(e.h)&&ll(e.s)&&ll(e.l)&&(s=$o(e.s),l=$o(e.l),i=function(e,t,r){var n,i,a;if(e=Wo(e,360),t=Wo(t,100),r=Wo(r,100),0===t)i=r,a=r,n=r;else{var s=r<.5?r*(1+t):r+t-r*t,o=2*r-s;n=Jo(o,s,e+1/3),i=Jo(o,s,e),a=Jo(o,s,e-1/3)}return{r:255*n,g:255*i,b:255*a}}(e.h,s,l),c=!0,u="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(a=e.a)),a=Go(a),{ok:c,format:e.format||u,r:Math.min(255,Math.max(i.r,0)),g:Math.min(255,Math.max(i.g,0)),b:Math.min(255,Math.max(i.b,0)),a}}(t);this.originalInput=t,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(n=r.format)&&void 0!==n?n:i.format,this.gradientType=r.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},e.prototype.getLuminance=function(){var e=this.toRgb(),t=e.r/255,r=e.g/255,n=e.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(e){return this.a=Go(e),this.roundA=Math.round(100*this.a)/100,this},e.prototype.toHsv=function(){var e=Zo(this.r,this.g,this.b);return{h:360*e.h,s:e.s,v:e.v,a:this.a}},e.prototype.toHsvString=function(){var e=Zo(this.r,this.g,this.b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.v);return 1===this.a?"hsv(".concat(t,", ").concat(r,"%, ").concat(n,"%)"):"hsva(".concat(t,", ").concat(r,"%, ").concat(n,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var e=Ko(this.r,this.g,this.b);return{h:360*e.h,s:e.s,l:e.l,a:this.a}},e.prototype.toHslString=function(){var e=Ko(this.r,this.g,this.b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.l);return 1===this.a?"hsl(".concat(t,", ").concat(r,"%, ").concat(n,"%)"):"hsla(".concat(t,", ").concat(r,"%, ").concat(n,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(e){return void 0===e&&(e=!1),el(this.r,this.g,this.b,e)},e.prototype.toHexString=function(e){return void 0===e&&(e=!1),"#"+this.toHex(e)},e.prototype.toHex8=function(e){return void 0===e&&(e=!1),function(e,t,r,n,i){var a,s=[Yo(Math.round(e).toString(16)),Yo(Math.round(t).toString(16)),Yo(Math.round(r).toString(16)),Yo((a=n,Math.round(255*parseFloat(a)).toString(16)))];return i&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}(this.r,this.g,this.b,this.a,e)},e.prototype.toHex8String=function(e){return void 0===e&&(e=!1),"#"+this.toHex8(e)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),r=Math.round(this.b);return 1===this.a?"rgb(".concat(e,", ").concat(t,", ").concat(r,")"):"rgba(".concat(e,", ").concat(t,", ").concat(r,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var e=function(e){return"".concat(Math.round(100*Wo(e,255)),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var e=function(e){return Math.round(100*Wo(e,255))};return 1===this.a?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var e="#"+el(this.r,this.g,this.b,!1),t=0,r=Object.entries(nl);t<r.length;t++){var n=r[t],i=n[0];if(e===n[1])return i}return!1},e.prototype.toString=function(e){var t=Boolean(e);e=null!=e?e:this.format;var r=!1,n=this.a<1&&this.a>=0;return t||!n||!e.startsWith("hex")&&"name"!==e?("rgb"===e&&(r=this.toRgbString()),"prgb"===e&&(r=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(r=this.toHexString()),"hex3"===e&&(r=this.toHexString(!0)),"hex4"===e&&(r=this.toHex8String(!0)),"hex8"===e&&(r=this.toHex8String()),"name"===e&&(r=this.toName()),"hsl"===e&&(r=this.toHslString()),"hsv"===e&&(r=this.toHsvString()),r||this.toHexString()):"name"===e&&0===this.a?this.toName():this.toRgbString()},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.l+=t/100,r.l=Ho(r.l),new e(r)},e.prototype.brighten=function(t){void 0===t&&(t=10);var r=this.toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(-t/100*255))),r.g=Math.max(0,Math.min(255,r.g-Math.round(-t/100*255))),r.b=Math.max(0,Math.min(255,r.b-Math.round(-t/100*255))),new e(r)},e.prototype.darken=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.l-=t/100,r.l=Ho(r.l),new e(r)},e.prototype.tint=function(e){return void 0===e&&(e=10),this.mix("white",e)},e.prototype.shade=function(e){return void 0===e&&(e=10),this.mix("black",e)},e.prototype.desaturate=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.s-=t/100,r.s=Ho(r.s),new e(r)},e.prototype.saturate=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.s+=t/100,r.s=Ho(r.s),new e(r)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var r=this.toHsl(),n=(r.h+t)%360;return r.h=n<0?360+n:n,new e(r)},e.prototype.mix=function(t,r){void 0===r&&(r=50);var n=this.toRgb(),i=new e(t).toRgb(),a=r/100;return new e({r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a})},e.prototype.analogous=function(t,r){void 0===t&&(t=6),void 0===r&&(r=30);var n=this.toHsl(),i=360/r,a=[this];for(n.h=(n.h-(i*t>>1)+720)%360;--t;)n.h=(n.h+i)%360,a.push(new e(n));return a},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){void 0===t&&(t=6);for(var r=this.toHsv(),n=r.h,i=r.s,a=r.v,s=[],o=1/t;t--;)s.push(new e({h:n,s:i,v:a})),a=(a+o)%1;return s},e.prototype.splitcomplement=function(){var t=this.toHsl(),r=t.h;return[this,new e({h:(r+72)%360,s:t.s,l:t.l}),new e({h:(r+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var r=this.toRgb(),n=new e(t).toRgb();return new e({r:n.r+(r.r-n.r)*r.a,g:n.g+(r.g-n.g)*r.a,b:n.b+(r.b-n.b)*r.a})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var r=this.toHsl(),n=r.h,i=[this],a=360/t,s=1;s<t;s++)i.push(new e({h:(n+s*a)%360,s:r.s,l:r.l}));return i},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function ul(e,t){var r=new cl(e),n=new cl(t);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)}function hl(e,t,r){void 0===r&&(r={includeFallbackColors:!1,level:"AA",size:"small"});for(var n=null,i=0,a=r.includeFallbackColors,s=r.level,o=r.size,l=0,c=t;l<c.length;l++){var u=c[l],h=ul(e,u);h>i&&(i=h,n=new cl(u))}return function(e,t,r){var n,i;void 0===r&&(r={level:"AA",size:"small"});var a=ul(e,t);switch((null!==(n=r.level)&&void 0!==n?n:"AA")+(null!==(i=r.size)&&void 0!==i?i:"small")){case"AAsmall":case"AAAlarge":return a>=4.5;case"AAlarge":return a>=3;case"AAAsmall":return a>=7;default:return!1}}(e,n,{level:s,size:o})||!a?n:(r.includeFallbackColors=!1,hl(e,["#fff","#000"],r))}const dl=JSON.parse('{"name":"Black Gold","backgroundColor":"#0d0c0c","textColor":"#cbccad","frameColor":"#0e0e0c","frameTextColor":"#e8e8bf","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.25,"flat":false}'),fl=JSON.parse('{"name":"Boring Skyblue","backgroundColor":"#08090a","textColor":"#7ccaf8","frameColor":"#333738","frameTextColor":"#d2d2d2","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#163d5a","selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0,"flat":false}'),ml=JSON.parse('{"name":"Grey Green","backgroundColor":"#0f0f10","textColor":"#d1f5d2","frameColor":"#24322c","frameTextColor":"#c3feca","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.25,"flat":false}'),pl=JSON.parse('{"name":"Indigo","backgroundColor":"#06181e","textColor":"#d1d3f5","frameColor":"#43477a","frameTextColor":"#f3f3f7","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#4b4049","selectedTextColor":"#ffffff","evenRowBackgroundColor":null,"spacing":0.625,"roundness":0.84375,"flat":true}'),gl=JSON.parse('{"name":"Lemon","backgroundColor":"#e7fdfc","textColor":"#000000","frameColor":"#e8d502","frameTextColor":"#180c06","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#aaaaaa","selectedTextColor":"#000000","evenRowBackgroundColor":null,"spacing":0.375,"roundness":0,"flat":true}'),Al=JSON.parse('{"name":"Lilac","backgroundColor":"#12051a","textColor":"#f5d1ed","frameColor":"#79437a","frameTextColor":"#f3f7f3","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.625,"roundness":0.84375,"flat":true}'),bl=JSON.parse('{"name":"Moody Blue","backgroundColor":"#000000","textColor":"#bec1c0","frameColor":"#125673","frameTextColor":"#d8eee7","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.53125,"roundness":0.40625,"flat":false}'),vl=JSON.parse('{"name":"Olive Oil","backgroundColor":"#1e1710","textColor":"#cbccad","frameColor":"#81810e","frameTextColor":"#181816","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.25,"flat":false}'),yl=JSON.parse('{"name":"Pale Pink","backgroundColor":"#f7f7f7","textColor":"#120f0c","frameColor":"#cfbdd0","frameTextColor":"#121211","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.53125,"flat":true}'),wl=JSON.parse('{"name":"Purplelicious (Winamp)","backgroundColor":"#000000","textColor":"#ffb464","frameColor":"#3e0445","frameTextColor":"#ffb464","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#3e0445","selectedTextColor":"#ffb464","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),El=JSON.parse('{"name":"Saddle","backgroundColor":"#271607","textColor":"#cbbe86","frameColor":"#331d0a","frameTextColor":"#fedfc3","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":null,"selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.375,"roundness":0.34375,"flat":false}'),_l=JSON.parse('{"name":"Seaweed","backgroundColor":"#244319","textColor":"#bef3c5","frameColor":"#3b722c","frameTextColor":"#fcfcf7","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":"#54e3da","mediaButtonTextColor":null,"selectedBackgroundColor":"#04958b","selectedTextColor":null,"evenRowBackgroundColor":null,"spacing":0.78125,"roundness":0.8125,"flat":true}'),Tl=JSON.parse('{"name":"Tangerine","backgroundColor":"#eaf2c5","textColor":"#2e1f05","frameColor":"#e89f02","frameTextColor":"#180c06","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":null,"mediaButtonTextColor":null,"selectedBackgroundColor":"#adaaaa","selectedTextColor":"#000000","evenRowBackgroundColor":null,"spacing":0.46875,"roundness":1,"flat":false}'),xl=JSON.parse('{"name":"Winamp Amber","backgroundColor":"#000000","textColor":"#e79a36","frameColor":"#383757","frameTextColor":"#d2d2d2","buttonColor":"#464379","buttonTextColor":"#ebebeb","mediaButtonColor":"#cccccc","mediaButtonTextColor":"#111111","selectedBackgroundColor":"#76490e","selectedTextColor":"#ebebeb","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),Sl=JSON.parse('{"name":"Winamp Classic","backgroundColor":"#000000","textColor":"#00e200","frameColor":"#383757","frameTextColor":"#d2d2d2","buttonColor":"#464379","buttonTextColor":"#d2d2d2","mediaButtonColor":"#cccccc","mediaButtonTextColor":"#111111","selectedBackgroundColor":"#040dae","selectedTextColor":"#d2d2d2","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),kl=JSON.parse('{"name":"Winamp Modern (WACUP)","backgroundColor":"#14121c","textColor":"#8ac440","frameColor":"#1f1f36","frameTextColor":"#f0f0f0","buttonColor":null,"buttonTextColor":null,"mediaButtonColor":"#cccccc","mediaButtonTextColor":"#111111","selectedBackgroundColor":"#2f2f76","selectedTextColor":"#f0f0f0","evenRowBackgroundColor":null,"spacing":0.21875,"roundness":0.09375,"flat":false}'),Il={name:"",backgroundColor:"#000000",textColor:"#ebebeb",frameColor:"#000000",frameTextColor:"#ebebeb",buttonColor:null,buttonTextColor:null,mediaButtonColor:null,mediaButtonTextColor:null,selectedBackgroundColor:null,selectedTextColor:null,evenRowBackgroundColor:null,spacing:.375,roundness:.25,flat:!1},Cl=[Il,dl,fl,ml,pl,gl,Al,bl,vl,yl,wl,El,_l,Tl,xl,Sl,kl],Pl=new r("theme"),Ml=new class{constructor(){this.app=document.getElementById("app"),this.popup=document.getElementById("popup"),this.system=document.getElementById("system"),this.theme$=new te(Il);const e=document.createElement("style");document.head.append(e),this.sheet=e.sheet,this.rootStyle=this.createStyle(":root"),this.appStyle=this.createStyle(".app"),this.playheadStyle=this.createStyle("#playhead"),this.restore()}observe(){return this.theme$}get backgroundColor(){return this.current.backgroundColor}set backgroundColor(e){this.setColor("backgroundColor",e),this.app.classList.toggle("dark",this.isDark),this.app.classList.toggle("light",this.isLight),this.popup.classList.toggle("dark",this.isDark),this.popup.classList.toggle("light",this.isLight)}get buttonColor(){return this.current.buttonColor}set buttonColor(e){this.setColor("buttonColor",e)}get buttonTextColor(){return this.current.buttonTextColor}set buttonTextColor(e){this.setColor("buttonTextColor",e)}get current(){return this.theme$.value}get evenRowBackgroundColor(){return this.current.evenRowBackgroundColor}set evenRowBackgroundColor(e){this.setColor("evenRowBackgroundColor",e)}get flat(){return this.current.flat}set flat(e){this.app.classList.toggle("flat",!!e),this.popup.classList.toggle("flat",!!e),this.theme$.next(Object.assign(Object.assign({},this.current),{flat:e}))}get fontSize(){return Number(this.rootStyle.getPropertyValue("--font-size"))||16}set fontSize(e){this.rootStyle.setProperty("--font-size",String(e)),this.createPlayheadSmiley()}get frameColor(){return this.current.frameColor}set frameColor(e){this.setColor("frameColor",e),this.app.classList.toggle("frame-light",this.isFrameLight),this.app.classList.toggle("frame-dark",this.isFrameDark),this.popup.classList.toggle("frame-light",this.isFrameLight),this.popup.classList.toggle("frame-dark",this.isFrameDark),this.createPlayheadSmiley()}get frameTextColor(){return this.current.frameTextColor}set frameTextColor(e){this.setColor("frameTextColor",e)}get mediaButtonColor(){return this.current.mediaButtonColor}set mediaButtonColor(e){this.setColor("mediaButtonColor",e)}get mediaButtonTextColor(){return this.current.mediaButtonTextColor}set mediaButtonTextColor(e){this.setColor("mediaButtonTextColor",e)}get name(){return this.current.name}set name(e){this.theme$.next(Object.assign(Object.assign({},this.current),{name:e}))}get roundness(){return this.current.roundness}set roundness(e){this.setProperty("roundness",e),this.theme$.next(Object.assign(Object.assign({},this.current),{roundness:e}))}get selectedBackgroundColor(){var e;return null!==(e=this.current.selectedBackgroundColor)&&void 0!==e?e:null}set selectedBackgroundColor(e){if(this.setColor("selectedBackgroundColor",e),this.selectedBackgroundColor){let e=new cl(this.selectedBackgroundColor).desaturate(40);e=e.isLight()?e.tint(25):e.shade(25),this.setProperty("selected-background-color-blurred",e.toHexString())}}get selectedTextColor(){return this.current.selectedTextColor}set selectedTextColor(e){this.setColor("selectedTextColor",e)}get spacing(){return this.current.spacing}set spacing(e){this.setProperty("spacing",e),this.theme$.next(Object.assign(Object.assign({},this.current),{spacing:e}))}get textColor(){return this.current.textColor}set textColor(e){this.setColor("textColor",e)}get isDark(){return new cl(this.backgroundColor).isDark()}get isLight(){return new cl(this.backgroundColor).isLight()}get isFrameDark(){return new cl(this.frameColor).isDark()}get isFrameLight(){return new cl(this.frameColor).isLight()}load(e){let t;t="string"==typeof e?Cl.find((t=>t.name===e)):e,t&&Object.assign(this,this.applyDefaults(t))}restore(){const e=this.retrieve("current"),t=e?JSON.parse(e):Il;Object.assign(this,this.applyDefaults(t)),this.fontSize=Number(this.retrieve("fontSize"))||16,this.app.classList.toggle("dark",this.isDark),this.app.classList.toggle("light",this.isLight),this.app.classList.toggle("frame-light",this.isFrameLight),this.app.classList.toggle("frame-dark",this.isFrameDark),this.popup.classList.toggle("dark",this.isDark),this.popup.classList.toggle("light",this.isLight),this.popup.classList.toggle("frame-light",this.isFrameLight),this.popup.classList.toggle("frame-dark",this.isFrameDark),this.system.classList.toggle("dark",this.isDark),this.system.classList.toggle("light",this.isLight),this.createPlayheadSmiley()}save(){this.store("fontSize",this.fontSize),this.store("current",JSON.stringify(this.current)),this.system.classList.toggle("dark",this.isDark),this.system.classList.toggle("light",this.isLight)}applyDefaults(e){if(!e.selectedBackgroundColor){const t=new cl(e.textColor),r=t.monochromatic();r.sort(((e,t)=>e.getBrightness()-t.getBrightness())),t.isLight()?e.selectedBackgroundColor=r[1].toHexString():e.selectedBackgroundColor=r[r.length-2].toHexString(),r.push(new cl("white"),new cl("black")),e.selectedTextColor=hl(e.selectedBackgroundColor,r,{includeFallbackColors:!0,level:"AA",size:"large"}).toHexString()}return e}setColor(e,t){"string"==typeof t&&(t=new cl(t));const r=null==t?void 0:t.toHsl(),n=this.toDashName(e);this.setProperty(`${n}-h`,r?String(r.h):null),this.setProperty(`${n}-s`,r?100*r.s+"%":null),this.setProperty(`${n}-l`,r?100*r.l+"%":null),this.theme$.next(Object.assign(Object.assign({},this.current),{[e]:t?t.toHexString():null}))}setProperty(e,t){this.appStyle.setProperty(`--${e}`,null==t?null:String(t))}createStyle(e){const t=this.sheet.insertRule(`${e}{}`);return this.sheet.cssRules[t].style}get defaultMediaButtonColor(){const e=new cl(this.frameColor).toHsl();return e.s+=1-.33*e.s,e.l+=1-.5*e.l,new cl(e).toHexString()}get defaultMediaButtonTextColor(){const e=new cl(this.defaultMediaButtonColor).toHsl();return e.s-=.5*e.s,e.l-=.9*e.l,new cl(e).toHexString()}get smileyColor(){return this.mediaButtonTextColor||this.defaultMediaButtonTextColor}createPlayheadSmiley(){const e=new cl(this.smileyColor).toRgbString(),t=[`<path fill='${e}' d='M 160.5,164.5 C 183.647,162.813 194.147,173.48 192,196.5C 186.494,211.009 175.994,216.842 160.5,214C 145.991,208.494 140.158,197.994 143,182.5C 145.683,173.318 151.517,167.318 160.5,164.5 Z'/>`,`<path fill='${e}' d='M 335.5,164.5 C 358.647,162.813 369.147,173.48 367,196.5C 361.494,211.009 350.994,216.842 335.5,214C 320.991,208.494 315.158,197.994 318,182.5C 320.683,173.318 326.517,167.318 335.5,164.5 Z'/>`,`<path fill='${e}' d='M 164.5,296.5 C 172.699,295.1 179.865,297.1 186,302.5C 201.99,327.582 224.823,341.582 254.5,344.5C 279.499,342.418 299.999,331.751 316,312.5C 318.955,308.756 321.789,304.922 324.5,301C 334.716,294.616 344.55,295.116 354,302.5C 358.296,308.845 359.63,315.845 358,323.5C 334.118,361.698 299.618,382.365 254.5,385.5C 209.382,382.365 174.882,361.698 151,323.5C 148.138,310.557 152.638,301.557 164.5,296.5 Z'/>`].join(""),r=this.createBase64SVG(512,512,t);this.playheadStyle.setProperty("--smiley",r),this.playheadStyle.setProperty("--thumb-size",`${Math.round(1.25*this.fontSize)}px`)}createBase64SVG(e,t,r){return`url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='${e}' height='${t}'>${r}</svg>")`}retrieve(e){return Pl.getItem(e)}store(e,t){Pl.setItem(e,String(t))}toDashName(e){return e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))}},Rl=new ne("Waveform");console.log("module::visualizer/player");const Bl=new ne("visualizer/player"),Ll=new class extends Ji{constructor(e,t){super(),this.audioContext=e,this.analyser=t,this.canvas=document.createElement("canvas"),this.gl=this.canvas.getContext("webgl"),this.animationFrameId=0;const r=this.canvas,n=this.gl;r.hidden=!0,r.className="visualizer visualizer-ampshade",this.shader=function(e,t){const r=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(r,"\nattribute vec2 position;\n\nvoid main(void) {\n  gl_Position = vec4(position, 0, 1);\n}\n"),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(r));const n=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,"\nprecision mediump float;\n\nuniform float time;\nuniform vec2 resolution;\nuniform sampler2D spectrum;\n\nvoid main(void) {\n  vec3 c;\n  float z = 0.1 * time;\n  vec2 uv = gl_FragCoord.xy / resolution;\n  vec2 p = uv - 0.5;\n  p.x *= resolution.x / resolution.y;\n  float l = 0.2 * length(p);\n  for (int i = 0; i < 3; i++) {\n    z += 0.07;\n    uv += p / l * (sin(z) + 1.0) * abs(sin(l * 9.0 - z * 2.0));\n    c[i] = 0.01 / length(abs(mod(uv, 1.0) - 0.5));\n  }\n  float intensity = texture2D(spectrum, vec2(l, 0.5)).x;\n  gl_FragColor = vec4(c / l * intensity, time);\n}\n"),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(n));const i=e.createProgram();return e.attachShader(i,r),e.attachShader(i,n),e.linkProgram(i),e.useProgram(i),i}(n);const i=n.getAttribLocation(this.shader,"position");n.enableVertexAttribArray(i),this.fragTime=n.getUniformLocation(this.shader,"time"),n.uniform1f(this.fragTime,e.currentTime),this.fragResolution=n.getUniformLocation(this.shader,"resolution"),n.uniform2f(this.fragResolution,r.width,r.height),this.spectrum=new Uint8Array(this.analyser.frequencyBinCount),this.fragSpectrumArray=new Uint8Array(4*this.spectrum.length),function(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}(n),function(e){const t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t);const r=new Float32Array([-1,-1,1,-1,-1,1,1,1]);e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0)}(n)}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e||this.animationFrameId||this.render())}appendTo(e){e.append(this.canvas)}load(){Zi.log("load"),this.play()}play(){Zi.log("play"),this.animationFrameId||this.render()}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){const r=this.canvas,n=this.gl;r.width=e,r.height=t,n.viewport(0,0,e,t),this.fragResolution=n.getUniformLocation(this.shader,"resolution"),n.uniform2f(this.fragResolution,r.width,r.height),this.renderFrame()}clear(){}render(){this.renderFrame(),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((()=>this.render())))}renderFrame(){this.analyser.getByteFrequencyData(this.spectrum),this.gl.uniform1f(this.fragTime,this.audioContext.currentTime),function(e,t,r){for(let e=0;e<t.length;e++)r[4*e+0]=t[e],r[4*e+1]=t[e],r[4*e+2]=t[e],r[4*e+3]=255;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t.length,1,0,e.RGBA,e.UNSIGNED_BYTE,r)}(this.gl,this.spectrum,this.fragSpectrumArray),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}(Kn,Jn),Dl=new class extends Ji{constructor(e,t){super();const r=this.element=document.createElement("div");r.hidden=!0,r.className="visualizer visualizer-audiomotion",this.audioSourceNode=e.createMediaElementSource(new Audio);const n=this.visualizer=new na(r,{source:this.audioSourceNode,showBgColor:!1,overlay:!0,showScaleX:!1,showScaleY:!1,connectSpeakers:!1});t.subscribe((e=>{this.audioSourceNode=e,this.element.hidden||n.connectInput(e)}))}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden!==e&&(this.element.hidden=e,e?this.visualizer.disconnectInput():this.visualizer.connectInput(this.audioSourceNode))}appendTo(e){e.append(this.element)}load(e){sa.log("load");const t=aa.find((t=>t.name===e));t&&(sa.log(`Using AudioMotion preset: ${t.name}`),this.visualizer.setOptions(t.options)),this.autoplay&&this.play()}play(){sa.log("play"),this.visualizer.toggleAnalyzer(!0)}pause(){this.visualizer.toggleAnalyzer(!1)}stop(){this.visualizer.toggleAnalyzer(!0)}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}}(Kn,ri()),Nl=new class extends Ji{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"),this.animationFrameId=0,this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-milkdrop",(this.visualizer=la().createVisualizer(e.context,this.canvas,{width:400,height:200})).connectAudio(e)}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e?this.visualizer.disconnectAudio(this.analyser):(this.visualizer.connectAudio(this.analyser),this.animationFrameId||this.render()))}appendTo(e){e.append(this.canvas)}load(e){fa.log("load",e);const t=da.find(e);t&&(fa.log(`Using butterchurn preset: ${t.name}`),this.visualizer.loadPreset(t.data,.5)),this.play()}play(){fa.log("play"),this.animationFrameId||this.render()}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){this.canvas.width=e,this.canvas.height=t,this.visualizer.render(),this.visualizer.setRendererSize(e,t),this.visualizer.render()}clear(){const e=this.canvas.width,t=this.canvas.height;this.canvasContext.clearRect(0,0,e,t)}render(){this.visualizer.render(),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((()=>this.render())))}}(Jn),Fl=new class extends Ji{constructor(){super(),this.element=document.createElement("div"),this.visualizer=new Vo,this.visualizer.appendTo(this.element),this.element.hidden=!0,this.element.className="visualizer visualizer-spotify-viz"}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e}appendTo(e){e.append(this.element)}load(){Xo.log("load"),this.visualizer.load(Qo),this.autoplay&&this.visualizer.start()}play(){Xo.log("play"),this.visualizer.start()}pause(){Xo.log("pause"),this.visualizer.stop()}stop(){Xo.log("stop"),this.visualizer.stop()}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`,this.visualizer.resize(e,t)}},Ol=new class extends Ji{constructor(e){super(),this.analyser=e,this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"),this.animationFrameId=0,this.canvas.hidden=!0,this.canvas.className="visualizer visualizer-waveform"}get hidden(){return this.canvas.hidden}set hidden(e){this.canvas.hidden!==e&&(this.canvas.hidden=e,e||this.animationFrameId||this.render())}appendTo(e){e.append(this.canvas)}load(){Rl.log("load"),this.play()}play(){Rl.log("play"),this.animationFrameId||this.render()}pause(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)}stop(){this.pause(),this.clear()}resize(e,t){this.canvas.width=e,this.canvas.height=t,this.renderFrame()}clear(){const e=this.canvas.width,t=this.canvas.height;this.canvasContext.clearRect(0,0,e,t)}render(){this.renderFrame(),this.autoplay&&!this.canvas.hidden&&(this.animationFrameId=requestAnimationFrame((()=>this.render())))}renderFrame(){const e=this.analyser.frequencyBinCount,t=new Uint8Array(e),r=this.canvasContext,n=this.canvas.width,i=this.canvas.height,a=n/e;let s=0;r.lineWidth=2,Ml.isLight&&Ml.isFrameLight?r.strokeStyle=Ml.frameColor:r.strokeStyle=Ml.textColor,r.clearRect(0,0,n,i),r.beginPath(),this.analyser.getByteTimeDomainData(t);for(let n=0;n<e;n++){const e=t[n]/128*i/2;0===n?r.moveTo(s,e):r.lineTo(s,e),s+=a}r.lineTo(n,i/2),r.stroke()}}(Jn),zl=new ci([Ll,Dl,Nl,Fl,Ol,Ki],(function(e){switch(e.provider){case"ampshade":return Ll;case"audiomotion":return Dl;case"milkdrop":return Nl;case"video":return Ki;case"waveform":return Ol;case"spotify-viz":return Fl;default:return null}}),(function(e,t){e.load(t.preset)}));zl.loop=!0,zl.muted=!0,zl.volume=.07;const Ul=zl;zl.observeError().subscribe(Bl.error),zl.observePlaying().subscribe(Bl.all("playing")),zl.observeEnded().subscribe(Bl.all("ended"));var jl,Vl,ql=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},Ql=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};const Xl=new ne("MusicKitPlayer"),Wl="Apple Music player not connected.";jl=new WeakMap,Vl=new WeakMap;const Hl=new class{constructor(e){this.isLoggedIn$=e,this.duration$=new Z,this.currentTime$=new Z,this.ended$=new Z,this.playing$=new Z,this.error$=new Z,this.playerReady$=new Z,this.src$=new te(""),this.loadedSrc="",this.isLoggedIn=!1,this.loop=!1,this.autoplay=!1,jl.set(this,!0),Vl.set(this,1),this.onPlaybackStateChange=({state:e})=>{if(e===MusicKit.PlaybackStates.ended)this.ended$.next(void 0);else if(e===MusicKit.PlaybackStates.playing){const[,,e]=this.src.split(":"),t=this.player.nowPlayingItem;!1===(null==t?void 0:t.isPlayable)&&(null==t?void 0:t.id)===e?(this.error$.next(Error("Unplayable")),this.player.stop()):this.playing$.next(void 0)}},this.onPlaybackDurationChange=({duration:e})=>{this.duration$.next(e)},this.onPlaybackTimeChange=({currentPlaybackTime:e})=>{this.currentTime$.next(e)},this.onPlaybackError=e=>{console.log("MusicKit::onPlaybackError",e)};const t=this.element=document.createElement("div");t.hidden=!0,t.className="apple-video",t.id="apple-music-video-container",this.observeIsLoggedIn().pipe(Ft((e=>e)),Rt((()=>{const e=this.player=MusicKit.getInstance(),t=MusicKit.Events;e.addEventListener(t.playbackStateDidChange,this.onPlaybackStateChange),e.addEventListener(t.playbackDurationDidChange,this.onPlaybackDurationChange),e.addEventListener(t.playbackTimeDidChange,this.onPlaybackTimeChange),e.addEventListener(t.mediaPlaybackError,this.onPlaybackError),e.volume=this.muted?0:this.volume,this.playerReady$.next(void 0)})),Nt(1)).subscribe(Xl),this.observeReady().pipe(Bt((()=>Ct([this.observeSrc(),this.observeIsLoggedIn()]))),Ot((([e,t])=>{if(t&&e&&e!==this.loadedSrc){const[,t,r]=e.split(":");return Je(this.player.setQueue({[t]:r})).pipe(Bt((()=>(this.loadedSrc=e,this.autoplay?this.player.play():et))),Lt((e=>(this.error$.next(e),et))))}return et}))).subscribe(Xl),this.observeIsLoggedIn().pipe(ui((e=>e===this.isLoggedIn))).subscribe((e=>{var t;this.isLoggedIn=e,!e&&(null===(t=this.player)||void 0===t?void 0:t.isPlaying)&&(this.stop(),this.error$.next(Error(Wl)))})),this.observeError().subscribe(Xl.error)}get hidden(){return this.element.hidden}set hidden(e){this.element.hidden=e}get muted(){return ql(this,jl,"f")}set muted(e){ql(this,jl,"f")!==e&&(Ql(this,jl,e,"f"),this.player&&(this.player.volume=e?0:this.volume))}get volume(){return ql(this,Vl,"f")}set volume(e){ql(this,Vl,"f")!==e&&(Ql(this,Vl,e,"f"),this.player&&(this.player.volume=this.muted?0:e))}observeCurrentTime(){return this.currentTime$.pipe(rt())}observeDuration(){return this.duration$.pipe(rt())}observePlaying(){return this.playing$}observeEnded(){return this.ended$}observeError(){return this.error$}appendTo(e){e.appendChild(this.element)}load(e){this.src$.next(e),this.player&&this.isLoggedIn?this.autoplay&&e===this.loadedSrc&&this.player.play().then(void 0,(e=>this.error$.next(e))):this.autoplay&&this.error$.next(Error(Wl))}play(){this.player&&this.isLoggedIn?this.src===this.loadedSrc&&this.player.play().then(void 0,(e=>this.error$.next(e))):this.error$.next(Error(Wl))}pause(){var e;(null===(e=this.player)||void 0===e?void 0:e.isPlaying)&&this.player.pause()}stop(){var e;null===(e=this.player)||void 0===e||e.stop()}seek(e){var t;null===(t=this.player)||void 0===t||t.seekToTime(e)}resize(e,t){this.element.style.width=`${e}px`,this.element.style.height=`${t}px`}get src(){return this.src$.getValue()}observeIsLoggedIn(){return this.isLoggedIn$}observeReady(){return this.playerReady$.pipe(it((()=>{})),Nt(1))}observeSrc(){return this.src$.pipe(rt())}}(mt());console.log("module::mediaPlayer");const Gl=new Hi("audio"),$l=new Hi("video"),Yl=new zi("main"),Kl=new ci([Gl,$l,Yl,Hl,zo],(function(e){return e?e.src.startsWith("youtube:")?Yl:e.src.startsWith("apple:")?Hl:e.src.startsWith("spotify:")?zo:e.mediaType===yt.Video?$l:Gl:null}),(function(e,t){if(null==t?void 0:t.unplayable)throw Error("Unplayable.");e.load(function(e){return e?e.blob?URL.createObjectURL(e.blob):e.src||"":""}(t))})),Jl=Kl;console.log("module::mediaPlayback");const Zl=new ne("mediaPlayback"),ec=new r("mediaPlayback"),tc=new r("mediaPlayback",sessionStorage),rc=new te(!1);let nc="forward";function ic(){return rc.pipe(rt(),Ot((e=>e?et:Un.observeCurrentItem())))}function ac(){return Yn.observeCurrentTime()}function sc(){return Yn.observeDuration()}function oc(){return Jl.observeEnded()}function lc(){return Yn.observePaused()}function cc(){return Yn.observePlaybackStart()}function uc(){return Yn.observePlaybackEnd()}function hc(e){return Yn.observePlaybackProgress(e)}function dc(){return Yn.observeState()}function fc(){return Jl.observePlaying()}function mc(e){Zl.log("load",null==e?void 0:e.title),Jl.load(e)}function pc(){Zl.log("play"),nc="forward",Tc(),Yn.play(),Yn.paused||Jl.play()}function gc(){Zl.log("pause"),Tc(),Yn.pause(),Jl.pause()}function Ac(e){Jl.seek(e)}function bc(){Zl.log("stop"),Tc(),Yn.stop(),Jl.stop()}function vc(){nc="backward",_c(),Un.prev()}function yc(){nc="forward",_c(),Un.next()}function wc(){Un.shuffle()}function Ec(){return Ct([Un.observeCurrentIndex(),Un.observeSize()]).pipe(it((([e,t])=>e===t-1)),rt())}function _c(){Yn.paused||!1!==rc.getValue()||(bc(),Yn.play()),rc.next(!0)}function Tc(){rc.next(!1)}const xc={get autoplay(){return Jl.autoplay},set autoplay(e){Jl.autoplay=e,Ul.autoplay=e},get hidden(){return!1},get loop(){return!1},get muted(){return Jl.muted},set muted(e){tc.setItem("muted",String(e)),Jl.muted=e},get paused(){return Yn.paused},get volume(){return Jl.volume},set volume(e){ec.setItem("volume",String(e)),Jl.volume=e},observeCurrentItem:ic,observeCurrentTime:ac,observeDuration:sc,observeEnded:oc,observeError:function(){return Jl.observeError()},observePaused:lc,observePlaying:fc,observePlaybackStart:cc,observePlaybackEnd:uc,observePlaybackProgress:hc,observePlaybackState:dc,appendTo:function(e){const t=e.querySelector("#players"),r=e.querySelector("#visualizers");Jl.appendTo(t),Ul.appendTo(r)},load:mc,play:pc,pause:gc,stop:bc,seek:Ac,resize:function(e,t){Jl.resize(e,t),Ul.resize(e,t)},next:yc,prev:vc,shuffle:wc},Sc=xc;var kc;xc.muted="true"===tc.getItem("muted"),xc.volume=Number(ec.getItem("volume"))||1,Jl.observeCurrentTime().subscribe((e=>Yn.setCurrentTime(e))),Jl.observeDuration().subscribe((e=>Yn.setDuration(e))),Jl.observePlaying().subscribe((()=>Yn.started())),Jl.observeEnded().subscribe((()=>Yn.ended())),Jl.observePlaying().subscribe((()=>nc="forward")),Jl.observeEnded().pipe(Zr(Ec())).subscribe((([,e])=>{e?bc():Un.next()})),Jl.observeError().pipe(Zr(lc(),Un.observeCurrentIndex().pipe(it((e=>0===e)),rt()),Ec())).subscribe((([,e,t,r])=>{r||t&&"backward"===nc?bc():e||("backward"===nc?Un.prev():Un.next())})),Un.observeSize().pipe(it((e=>0===e)),rt(),Ft((e=>e))).subscribe(bc),rc.pipe((250,void 0===kc&&(kc=sn),We((function(e,t){var r=null,n=null,i=null,a=function(){if(r){r.unsubscribe(),r=null;var e=n;n=null,t.next(e)}};function s(){var e=i+250,n=kc.now();if(n<e)return r=this.schedule(void 0,e-n),void t.add(r);a()}e.subscribe(He(t,(function(e){n=e,i=kc.now(),r||(r=kc.schedule(s,250),t.add(r))}),(function(){a(),t.complete()}),void 0,(function(){n=r=null})))}))),Ft((e=>e)),Rt((()=>{xc.autoplay=!Yn.paused,rc.next(!1)}))).subscribe(Zl),ic().subscribe(mc),Kr(window,"pagehide").subscribe(bc),sc().subscribe(Zl.all("duration")),ac().pipe(Ft((e=>Math.round(e)%10==0))).subscribe(Zl.all("currentTime")),fc().subscribe(Zl.all("playing")),oc().subscribe(Zl.all("ended")),cc().subscribe(Zl.all("playbackStart")),uc().subscribe(Zl.all("playbackEnd"));var Ic=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};function Cc(e,t,r,n){return Ic(this,void 0,void 0,(function*(){const[,,i]=e.src.split(":");yield fr.post("Sessions/Playing/Progress",{ItemId:i,IsPaused:r,PositionTicks:Math.floor(1e7*t),PlayMethod:"Transcode",EventName:n})}))}console.log("module::jellyfinPlayback"),console.log("module::jellyfinReporting");const Pc=e=>{var t;return(null===(t=e.currentItem)||void 0===t?void 0:t.src.startsWith("jellyfin:"))||!1},Mc=Ft(Pc);cc().pipe(Mc).subscribe((({currentItem:e})=>function(e){return Ic(this,void 0,void 0,(function*(){const[,,t]=e.src.split(":");yield fr.post("Sessions/Playing",{ItemId:t,IsPaused:!1,PositionTicks:0,PlayMethod:"Transcode"})}))}(e))),uc().pipe(Mc).subscribe((({currentItem:e,currentTime:t})=>function(e,t){return Ic(this,void 0,void 0,(function*(){const[,,r]=e.src.split(":");yield fr.post("Sessions/Playing/Stopped",{ItemId:r,IsPaused:!1,PositionTicks:Math.floor(1e7*t),PlayMethod:"Transcode"})}))}(e,t))),hc(1e4).pipe(Mc).subscribe((({currentItem:e,currentTime:t,paused:r})=>Cc(e,t,r,"timeupdate"))),cc().pipe(Ot((e=>Pc(e)?dc().pipe(rt(((e,t)=>e.paused===t.paused)),Hr(1),Dt(uc())):et))).subscribe((({currentItem:e,currentTime:t,paused:r})=>Cc(e,t,r,r?"pause":"unpause"))),console.log("module::jellyfin");const Rc={view:"details",fields:["Artist","Title","Album","Track","Duration","Genre","PlayCount"]},Bc={id:"jellyfin/liked-songs",title:"Liked Songs",icon:"heart",itemType:Ie.Media,layout:Rc,search:()=>Oc({Filters:"IsFavorite"})},Lc={id:"jellyfin/liked-albums",title:"Liked Albums",icon:"heart",itemType:Ie.Album,search:()=>Oc({Filters:"IsFavorite",IncludeItemTypes:"MusicAlbum"})},Dc={id:"jellyfin/recently-played",title:"Recently Played",icon:"clock",itemType:Ie.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search:()=>Oc({SortBy:"DatePlayed",SortOrder:"Descending",Filters:"IsPlayed"})},Nc={id:"jellyfin/most-played",title:"Most Played",icon:"most-played",itemType:Ie.Media,layout:Rc,search:()=>Oc({SortBy:"PlayCount,DatePlayed",SortOrder:"Descending",Filters:"IsPlayed"})},Fc={id:"jellyfin/playlists",title:"Playlists",icon:"playlists",itemType:Ie.Playlist,layout:{view:"card compact",fields:["Thumbnail","Title","TrackCount"]},secondaryLayout:Rc,search:()=>Oc({SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"Playlist"})};function Oc(e){return new mr(`Users/${cr.userId}/Items`,e)}function zc(e,t){return Object.assign(Object.assign({},t),{id:e,icon:"",searchable:!0,search:t=>function(e,t="Audio"){return e?Oc({SearchTerm:e,IncludeItemTypes:t}):new tt}(t,e)})}const Uc={id:"jellyfin",title:"Jellyfin",icon:"jellyfin",searches:[zc("Audio",{title:"Songs",itemType:Ie.Media}),zc("MusicAlbum",{title:"Albums",itemType:Ie.Album}),{id:"Artist",title:"Artists",icon:"",itemType:Ie.Artist,searchable:!0,search:e=>e?new mr("Artists",{searchTerm:e}):new tt},zc("Playlist",{title:"Playlists",itemType:Ie.Playlist})],sources:[Nc,Dc,Bc,Lc,Fc],observeIsLoggedIn:function(){return Xr.pipe(rt()).pipe(it((e=>""!==e)),rt())},login:function(){return qr(this,void 0,void 0,(function*(){if(""===Xr.getValue())try{const e=yield function(){return jr(this,void 0,void 0,(function*(){return zr(Vr)}))}(),{userId:t,token:r}=JSON.parse(e);cr.userId=t,Wr(r)}catch(e){Qr.log("Could not obtain access token."),Qr.error(e)}}))},logout:function(){return qr(this,void 0,void 0,(function*(){Wr(""),cr.clear()}))}};var jc=__webpack_require__(2568),Vc=__webpack_require__.n(jc);const qc=new r("lastfm"),Qc={get token(){return qc.getItem("token")||""},set token(e){qc.setItem("token",e)},get userId(){return qc.getItem("userId")||""},set userId(e){qc.setItem("userId",e)},get sessionKey(){return qc.getItem("sessionKey")||""},set sessionKey(e){qc.setItem("sessionKey",e)},clear(){qc.clear()}};var Xc=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::lastfmAuth");const Wc=new ne("lastfmAuth"),Hc=new te(""),Gc=new te("");function $c(){return Hc.pipe(rt())}function Yc(){return Gc.pipe(rt())}function Kc(e){const t=Object.keys(e);let r="";return t.sort(),t.forEach((t=>r+=t+e[t])),r+=ot,Vc()(r)}Gc.next(Qc.sessionKey),Hc.next(Qc.token);class Jc{constructor(e,t,r,n="playcount"){this.playCountName=n,this.defaultConfig={minPageSize:Jc.minPageSize,maxPageSize:Jc.maxPageSize,pageSize:50},this.pageNumber=1;const i=Object.assign(Object.assign({},this.defaultConfig),r);this.pager=new Wt(((r=this.defaultConfig.pageSize)=>{return n=this,i=void 0,s=function*(){const n=yield fetch(`https://ws.audioscrobbler.com/2.0?${e}&page=${this.pageNumber}&limit=${r}`);if(this.pageNumber++,!n.ok)throw n;const i=yield n.json(),{items:a,total:s,atEnd:o,itemType:l}=t(i);return{items:this.createMediaObjects(l,a),total:s,atEnd:o}},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof a?e:new a((function(t){t(e)}))}(t.value).then(r,o)}l((s=s.apply(n,i||[])).next())}));var n,i,a,s}),i)}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeMaxSize(){return this.pager.observeMaxSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}createMediaObjects(e,t){switch(e){case Ie.Artist:return t.map((e=>this.createMediaArtist(e)));case Ie.Album:return t.map((e=>this.createMediaAlbum(e)));case Ie.Media:return t.map((e=>this.createMediaItem(e)));case Ie.Playlist:return[]}}createMediaItem(e){var t,r;return Object.assign(Object.assign({},this.createMediaObject(Ie.Media,e)),{mediaType:yt.Audio,src:`lastfm:track:${or()}`,artist:null===(t=e.artist)||void 0===t?void 0:t.name,album:null===(r=e.album)||void 0===r?void 0:r["#text"],duration:Number(e.duration)||0,playedOn:e.date?1e3*e.date.uts:void 0,unplayable:!0})}createMediaAlbum(e){var t;return Object.assign(Object.assign({},this.createMediaObject(Ie.Album,e)),{src:`lastfm:album:${or()}`,artist:e.artist.name,year:(null===(t=e.wiki)||void 0===t?void 0:t.published)&&new Date(e.wiki.published).getFullYear()||void 0,pager:this.createAlbumPager(e),unplayable:!0})}createMediaArtist(e){return Object.assign(Object.assign({},this.createMediaObject(Ie.Artist,e)),{src:`lastfm:artist:${or()}`,pager:this.createArtistAlbumsPager(e)})}createMediaObject(e,t){return Object.assign(Object.assign({},xe(e)),{title:t.name,rating:Number(t.loved)||0,playCount:Number(t[this.playCountName])||void 0,globalPlayCount:"userplaycount"===this.playCountName&&Number(t.playcount)||void 0,thumbnails:this.createThumbnails(t.image),externalUrl:t.url})}createThumbnails(e){return e?[this.createThumbnail(e[0],34),this.createThumbnail(e[1],64),this.createThumbnail(e[2],174),this.createThumbnail(e[3],300)].filter(Ae):void 0}createThumbnail(e,t,r=t){if(e){const n=e["#text"];if(n&&!n.endsWith("2a96cbd8b46e442fc41c2b86b821562f.png"))return{url:n,width:t,height:r}}}createArtistAlbumsPager(e){return new Jc(`method=artist.getTopAlbums&artist=${encodeURIComponent(e.name)}&api_key=${st}&format=json`,(({topalbums:e})=>{const t=e["@attr"];return{items:e.album,total:Number(t.total)||void 0,atEnd:t.page===t.totalPages,itemType:Ie.Album}}),{maxSize:100},"userplaycount")}createAlbumPager(e){return new Jc(`method=album.getInfo&album=${encodeURIComponent(e.name)}&artist=${encodeURIComponent(e.artist.name)}&api_key=${st}&user=${Qc.userId}&format=json`,(({album:e})=>{if(e.tracks){const t=e.tracks.track;return{items:t,total:t.length,atEnd:!0,itemType:Ie.Media}}throw Error("No track info")}),void 0,"userplaycount")}}Jc.minPageSize=10,Jc.maxPageSize=200;var Zc=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::lastfmScrobbler");const eu=new ne("lastfmScrobbler"),tu="https://ws.audioscrobbler.com/2.0",ru=({currentItem:e})=>!!(null==e?void 0:e.title)&&!!(null==e?void 0:e.artist)&&(null==e?void 0:e.duration)>30;function nu(e){const t={};return t.track=e.title,t.artist=e.artist,e.album&&(t.album=e.album),e.albumArtist&&(t.albumArtist=e.albumArtist),e.duration&&(t.duration=String(Math.round(e.duration))),e.track&&(t.trackNumber=String(e.track)),t}cc().pipe(Ft(ru),Zr($c(),Yc()),Ft((([,e,t])=>!!e&&!!t)),Bt((([{currentItem:e},t,r])=>function(e,t,r){return Zc(this,void 0,void 0,(function*(){const n=Object.assign({api_key:st,token:t,sk:r,method:"track.updateNowPlaying"},nu(e)),i=Kc(n);yield fetch(tu,{method:"POST",body:`${new URLSearchParams(n)}&api_sig=${i}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}))}(e,t,r)))).subscribe(eu),uc().pipe(Ft(ru),Zr($c(),Yc()),Ft((([,e,t])=>!!e&&!!t)),Bt((([{currentItem:e,startedAt:t},r,n])=>function(e,t,r,n){return Zc(this,void 0,void 0,(function*(){n=Math.floor(n/1e3);const i=Math.floor(Date.now()/1e3)-n;if(i>240||i>e.duration/2){const i="track.scrobble",a=String(n),s=Object.assign({api_key:st,token:t,sk:r,method:i,timestamp:a},nu(e)),o=Kc(s);yield fetch(tu,{method:"POST",body:`${new URLSearchParams(s)}&api_sig=${o}`,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}))}(e,r,n,t)))).subscribe(eu),console.log("module::lastfm");const iu={view:"card compact",fields:["Thumbnail","Title","Artist","Year","PlayCount"]},au={view:"details",fields:["Index","Title","Artist"]},su={id:"lastfm/recently-played",title:"Recently Played",icon:"clock",itemType:Ie.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},unplayable:!0,search:()=>new Jc(`method=user.getRecentTracks&user=${Qc.userId}&api_key=${st}&extended=1&format=json`,(({recenttracks:e})=>{var t,r;const n=e["@attr"],i=e.track,a="true"===(null===(r=null===(t=i[0])||void 0===t?void 0:t["@attr"])||void 0===r?void 0:r.nowplaying),s=Number(n.total)+(a?1:0),o=n.page===n.totalPages;return a&&"1"!==n.page&&i.shift(),{items:i,total:s,atEnd:o,itemType:Ie.Media}}))};function ou(e,t){return Object.assign(Object.assign({},t),{id:e,icon:"",searchable:!1,unplayable:!0,search:()=>function(e,t){return new Jc(`method=${e}&user=${Qc.userId}&api_key=${st}&format=json`,(r=>{const[,n]=e.toLowerCase().split("."),i=r[n.slice(3)],a=i["@attr"];return{items:i[n.slice(6,-1)],total:Number(a.total)||void 0,atEnd:a.page===a.totalPages,itemType:t}}))}(e,t.itemType)})}const lu={id:"lastfm",title:"last.fm",icon:"lastfm",sources:[su],searches:[ou("user.getTopTracks",{title:"Top Tracks",itemType:Ie.Media,layout:{view:"card compact",fields:["Thumbnail","Title","Artist","PlayCount"]}}),ou("user.getTopAlbums",{title:"Top Albums",itemType:Ie.Album,layout:iu,secondaryLayout:au}),ou("user.getTopArtists",{title:"Top Artists",itemType:Ie.Artist,layout:{view:"card minimal",fields:["Thumbnail","Title","PlayCount"]},secondaryLayout:iu,tertiaryLayout:au})],observeIsLoggedIn:function(){return $c().pipe(it((e=>""!==e)),rt())},login:function(){return Xc(this,void 0,void 0,(function*(){if(""===Hc.getValue())try{const e=yield function(){return Xc(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{const r=location.hostname,n=("localhost"===r?`http://${r}:${location.port}`:`https://${r}`)+"/auth/lastfm/callback/";let i=null;const a=r=>{if(/(localhost|ampcast)/.test(r.origin)){if(clearInterval(s),window.removeEventListener("message",a,!1),null==i||i.close(),i=null,r.origin!==location.origin)return void t({message:`Origin ${r.origin} does not match ${location.origin}`});e(r.data.token)}};window.addEventListener("message",a,!1),i=window.open(`https://www.last.fm/api/auth?api_key=${st}&cb=${n}`,"last.fm","popup");const s=setInterval((()=>{(null==i?void 0:i.closed)&&(clearInterval(s),t({message:"access_denied"}))}),500)}))}))}(),t=yield function(e){return Xc(this,void 0,void 0,(function*(){const t="auth.getSession",r=Kc({api_key:st,token:e,method:t}),n=yield fetch(`https://ws.audioscrobbler.com/2.0?method=${t}&api_key=${st}&token=${e}&api_sig=${r}&format=json`);if(!n.ok)throw n;const{session:i}=yield n.json();return Qc.userId=i.name,Qc.token=e,Qc.sessionKey=i.key,i.key}))}(e);Gc.next(t),Hc.next(e),Wc.log("Access token successfully obtained.")}catch(e){Wc.log("Could not obtain access token."),Wc.error(e)}}))},logout:function(){return Xc(this,void 0,void 0,(function*(){Gc.next(""),Hc.next(""),Qc.clear()}))}};var cu=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::plexAuth");const uu=new ne("plexAuth"),hu="https://plex.tv/api/v2",du=new te(""),fu=new te(!1);function mu(){return du.pipe(rt()).pipe(it((e=>""!==e)),rt())}function pu(e){e&&uu.log("Access token successfully obtained."),ji.userToken=e,du.next(e)}pu(ji.userToken),mu().pipe(Ft((e=>e)),Rt((()=>cu(void 0,void 0,void 0,(function*(){const e=function(e,t){return cu(this,void 0,void 0,(function*(){try{return yield Wi.fetch({host:e.uri,path:"/",method:"HEAD",token:t}),e}catch(e){return null}}))},t=ji.connection;if(t){if(yield e(t,ji.serverToken))return uu.log(`Using existing ${t.local?"local":"public"} connection.`),void fu.next(!0);ji.server=null,ji.connection=null}uu.log("Searching for a connection...");const r=(yield function(){return cu(this,void 0,void 0,(function*(){return Wi.fetchJSON({host:hu,path:"/resources",params:{includeHttps:"1"}})}))}()).filter((e=>"server"===e.provides));for(const t of r){const r=yield Promise.all([...t.connections.map((r=>e(r,t.accessToken)))]),n=r.filter(Ae);if(n.length){const e=n.find((e=>e.local))||n[0];return ji.server=t,ji.connection=e,uu.log(`Using ${e.local?"local":"public"} connection.`),void fu.next(!0)}}uu.log("Could not establish a connection.")}))))).subscribe(uu),fu.pipe(Ft((e=>e)),Rt((()=>cu(void 0,void 0,void 0,(function*(){uu.log("Connected");const{MediaContainer:{Directory:e}}=yield Wi.fetchJSON({path:"/library/sections"}),t=e.find((e=>"artist"===e.type));ji.libraryId=(null==t?void 0:t.key)||""}))))).subscribe(uu);class gu{constructor(e,t){var r;this.path=e,this.params=t,this.pageSize=(null===(r=ji.connection)||void 0===r?void 0:r.local)?gu.maxPageSize:gu.minPageSize,this.pager=new sr((e=>this.fetch(e)),{pageSize:this.pageSize})}observeComplete(){return this.pager.observeComplete()}observeItems(){return this.pager.observeItems()}observeSize(){return this.pager.observeSize()}observeMaxSize(){return this.pager.observeMaxSize()}observeError(){return this.pager.observeError()}disconnect(){this.pager.disconnect()}fetchAt(e,t){this.pager.fetchAt(e,t)}fetch(e){return t=this,r=void 0,i=function*(){const t=yield Wi.fetchJSON({path:this.path,params:this.params,headers:{"X-Plex-Container-Size":String(this.pageSize),"X-Plex-Container-Start":String((e-1)*this.pageSize)}}),{MediaContainer:{Metadata:r=[],totalSize:n}}=t;return{items:r.map((e=>this.createItem(e))),total:n}},new((n=void 0)||(n=Promise))((function(e,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(t.value).then(s,o)}l((i=i.apply(t,r||[])).next())}));var t,r,n,i}createItem(e){switch(e.type){case"clip":return this.createMediaItemFromVideo(e);case"album":return this.createMediaAlbum(e);case"artist":return this.createMediaArtist(e);case"playlist":return this.createMediaPlaylist(e);default:return this.createMediaItemFromTrack(e)}}createMediaItemFromTrack(e){const[t]=e.Media,[r]=t.Part,n="[Unknown Album]"===e.parentTitle?"":e.parentTitle||"";return Object.assign(Object.assign({},xe(Ie.Media)),{mediaType:yt.Audio,src:`plex:audio:${r.key}`,title:e.title,addedOn:e.addedAt,artist:e.grandparentTitle,albumArtist:n?e.grandparentTitle:void 0,album:n,duration:e.duration/1e3,track:n?e.index:void 0,rating:e.userRating,year:e.parentYear,playedOn:e.lastViewedAt?1e3*e.lastViewedAt:void 0,playCount:e.viewCount,plex:{ratingKey:e.ratingKey},thumbnails:this.createThumbnails(e.thumb)})}createMediaAlbum(e){var t;return Object.assign(Object.assign({},xe(Ie.Album)),{src:`plex:album:${e.ratingKey}`,title:e.title||"",addedOn:e.addedAt,artist:e.parentTitle,rating:e.userRating,year:e.year,playedOn:e.lastViewedAt?1e3*e.lastViewedAt:void 0,playCount:e.viewCount,genre:null===(t=e.Genre)||void 0===t?void 0:t.map((e=>e.tag)).join(";"),plex:{ratingKey:e.ratingKey},pager:this.createPager(e.key),thumbnails:this.createThumbnails(e.thumb)})}createMediaArtist(e){var t;return Object.assign(Object.assign({},xe(Ie.Artist)),{src:`plex:album:${e.ratingKey}`,title:e.title,addedOn:e.addedAt,rating:e.userRating,genre:null===(t=e.Genre)||void 0===t?void 0:t.map((e=>e.tag)).join(";"),plex:{ratingKey:e.ratingKey},pager:this.createPager(e.key),thumbnails:this.createThumbnails(e.thumb)})}createMediaItemFromVideo(e){const[t]=e.Media,[r]=t.Part;return Object.assign(Object.assign({},xe(Ie.Media)),{mediaType:yt.Video,src:`plex:video:${r.key}`,title:e.title||"Video",addedOn:e.addedAt,artist:e.grandparentTitle,duration:e.duration/1e3,playedOn:e.lastViewedAt?1e3*e.lastViewedAt:void 0,playCount:e.viewCount,plex:{ratingKey:e.ratingKey},thumbnails:this.createThumbnails(e.thumb)})}createMediaPlaylist(e){return Object.assign(Object.assign({},xe(Ie.Playlist)),{src:`plex:playlist:${e.key}`,title:e.title,addedOn:e.addedAt,duration:e.duration/1e3,playedOn:e.lastViewedAt?1e3*e.lastViewedAt:void 0,playCount:e.viewCount,trackCount:e.leafCount,plex:{ratingKey:e.ratingKey},pager:this.createPager(e.key),thumbnails:this.createThumbnails(e.composite)})}createThumbnails(e){return e?[this.createThumbnail(e,60),this.createThumbnail(e,120),this.createThumbnail(e,240),this.createThumbnail(e,480)]:void 0}createThumbnail(e,t,r=t){return{url:`${ji.host}/photo/:/transcode?url=${encodeURIComponent(e)}&width=${t}&height=${r}&minSize=1&upscale=1&X-Plex-Token=${ji.serverToken}`,width:t,height:r}}createPager(e){return new gu(e)}}gu.minPageSize=100,gu.maxPageSize=1e3;var Au=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};console.log("module::plexPlayback");let bu=null;function vu(e,t,r){return Au(this,void 0,void 0,(function*(){yield yu(e,t,r)}))}function yu(e,t,r,n){return Au(this,void 0,void 0,(function*(){const[,,i]=e.src.split(":");yield Wi.fetch({path:"/:/timeline",params:{key:i,ratingKey:e.plex.ratingKey,playQueueItemID:String(bu.playQueueSelectedItemID),state:r,hasMDE:"1",time:String(Math.floor(1e3*t)),duration:String(Math.floor(1e3*e.duration))},keepalive:n})}))}console.log("module::plexReporting");const wu=new ne("plexReporting"),Eu=e=>{var t;return(null===(t=e.currentItem)||void 0===t?void 0:t.src.startsWith("plex:"))||!1};cc().pipe(Ft(Eu),Rt((({currentItem:e})=>function(e){return Au(this,void 0,void 0,(function*(){const[,,t]=e.src.split(":");bu=yield function(e){return Au(this,void 0,void 0,(function*(){return Wi.fetchJSON({path:"/playQueues",method:"POST",params:{type:"music",continuous:"0",uri:`server://${ji.server.clientIdentifier}/com.plexapp.plugins.library/${e}`,repeat:"0",own:"1",includeExternalMedia:"1"}})}))}(t),yield yu(e,0,"playing")}))}(e)))).subscribe(wu),uc().pipe(Ft(Eu),Rt((({currentItem:e})=>function(e){return Au(this,void 0,void 0,(function*(){yield yu(e,0,"stopped",!0)}))}(e)))).subscribe(wu),hc(1e4).pipe(Ft(Eu),Rt((({currentItem:e,currentTime:t,paused:r})=>vu(e,t,r?"paused":"playing")))).subscribe(wu),cc().pipe(Ot((e=>Eu(e)?dc().pipe(rt(((e,t)=>e.paused===t.paused)),Hr(1),Dt(uc())):et)),Rt((({currentItem:e,currentTime:t,paused:r})=>vu(e,t,r?"paused":"playing")))).subscribe(wu),console.log("module::plex");const _u={id:"plex/video",title:"Music Video",icon:"video",itemType:Ie.Media,searchable:!0,search:e=>new gu(`/library/sections/${ji.libraryId}/extras/all`,{title:e,type:"8",extraType:"4"})},Tu={id:"plex/recently-played",title:"Recently Played",icon:"clock",itemType:Ie.Media,layout:{view:"card",fields:["Thumbnail","Title","Artist","AlbumAndYear","LastPlayed"]},search:()=>new gu(`/library/sections/${ji.libraryId}/all`,{type:"10","lastViewedAt>":"-3mon",sort:"lastViewedAt:desc"})};function xu(e,t){return Object.assign(Object.assign({},t),{id:e,icon:"",searchable:!0,search:t=>function(e,t){return e?new gu(`/library/sections/${ji.libraryId}/all`,{title:e,type:t}):new tt}(t,e)})}const Su={id:"plex",title:"Plex",icon:"plex",sources:[_u,{id:"plex/most-played",title:"Most Played",icon:"most-played",itemType:Ie.Media,search:()=>new gu(`/library/sections/${ji.libraryId}/all`,{type:"10","viewCount>":"1",sort:"viewCount:desc,lastViewedAt:desc"})},Tu,{id:"plex/top-rated",title:"Top Rated",icon:"star",itemType:Ie.Media,search:()=>new gu(`/library/sections/${ji.libraryId}/all`,{type:"10","track.userRating>":"1",sort:"track.userRating:desc,viewCount:desc,lastViewedAt:desc"})},{id:"plex/playlists",title:"Playlists",icon:"playlists",itemType:Ie.Playlist,search:()=>new gu("/playlists/all",{type:"15",playlistType:"audio"})}],searches:[xu("10",{title:"Songs",itemType:Ie.Media}),xu("9",{title:"Albums",itemType:Ie.Album}),xu("8",{title:"Artists",itemType:Ie.Artist}),xu("15",{title:"Playlists",itemType:Ie.Playlist})],observeIsLoggedIn:mu,login:function(){return cu(this,void 0,void 0,(function*(){if(""===du.getValue())try{const{id:e,authToken:t}=yield function(){return cu(this,void 0,void 0,(function*(){const e=yield Wi.fetchJSON({host:hu,path:"/pins",method:"POST",params:{strong:"true"}});return new Promise(((t,r)=>{const n=location.hostname,i=("localhost"===n?`http://${n}:${location.port}`:`https://${n}`)+"/auth/plex/callback/";let a=null;const s=n=>{if(/(localhost|ampcast)/.test(n.origin)){if(clearInterval(l),window.removeEventListener("message",s,!1),null==a||a.close(),a=null,n.origin!==location.origin)return void r({message:`Origin ${n.origin} does not match ${location.origin}`});let i=10;const o=()=>cu(this,void 0,void 0,(function*(){i--;try{const{authToken:n,id:a}=yield Wi.fetchJSON({host:hu,path:`/pins/${e.id}`});n?t({id:a,authToken:n}):i?setTimeout(o,200):r("Timeout.")}catch(e){r(e)}}));o()}};window.addEventListener("message",s,!1);const o=`clientID=${ji.clientId}&code=${e.code}&forwardUrl=${encodeURIComponent(i)}&context%5Bdevice%5D%5Bproduct%5D=ampcast`;a=window.open(`https://app.plex.tv/auth#?${o}`,"Plex","popup");const l=setInterval((()=>{(null==a?void 0:a.closed)&&(clearInterval(l),r({message:"access_denied"}))}),500)}))}))}();ji.userId=e,pu(t)}catch(e){uu.log("Could not obtain access token."),uu.error(e)}}))},logout:function(){return cu(this,void 0,void 0,(function*(){fu.next(!1),pu(""),ji.clear()}))}},ku=[nr,xo,Pi,Su,Uc,lu];var Iu;const Cu=new r("sources"),Pu=ku.reduce(((e,t)=>(e.push(t.id,...t.sources.map((e=>e.id))),e)),[]),Mu=new te((null===(Iu=Cu.getItem("all"))||void 0===Iu?void 0:Iu.split(","))||Pu);function Ru(){return Mu}function Bu(){return Mu.getValue()}function Lu(){return ku.map((e=>e.id))}function Du(e){Cu.setItem("all",String(e)),Mu.next(e)}const Nu={observeAll:Ru,getAll:Bu,getServices:function(){const e=Lu();return Bu().filter((t=>e.includes(t)))},setServices:function(e){const t=new Set(Bu());Lu().forEach((r=>{e.includes(r)?t.add(r):t.delete(r)})),Du([...t])},getSources:function(e){return Bu().filter((t=>t.startsWith(`${e}/`)))},setSources:function(e,t){const r=new Set(Bu()),n=function(e){var t;return(null===(t=ku.find((t=>t.id===e)))||void 0===t?void 0:t.sources.map((e=>e.id)))||[]}(e);n.forEach((e=>{t.includes(e)?r.add(e):r.delete(e)})),Du([...r])}},Fu=Nu;function Ou({children:t}){return e.createElement(e.Fragment,null,t)}function zu(e,t){switch(t.type){case"resize":{const r=Math.max(t.clientSize,0),n=Math.max(t.scrollSize,r);if(r!==e.clientSize||n!==e.scrollSize){const t=n-r,i=Uu(e.position,t);return Object.assign(Object.assign({},e),{position:i,max:t,clientSize:r,scrollSize:n})}return e}case"scrollBy":{const r=Uu(e.position+t.amount,e.max);return r!==e.position?Object.assign(Object.assign({},e),{position:r}):e}case"scrollTo":{const r=Uu(t.position,e.max);return r!==e.position?Object.assign(Object.assign({},e),{position:r}):e}default:return e}}function Uu(e,t){return Math.min(Math.max(e,0),t)}const ju={position:0,max:0,clientSize:0,scrollSize:0};const Vu=(0,e.memo)((function(t){var{orientation:r,scrollAmount:n,onChange:i,onResize:s,scrollbarRef:o}=t,l=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["orientation","scrollAmount","onChange","onResize","scrollbarRef"]);const c=(0,e.useRef)(null),u=(0,e.useRef)(null),{position:h,max:d,clientSize:f,scrollSize:m,resize:p,scrollBy:g,scrollTo:A}=function(){const[{position:t,max:r,clientSize:n,scrollSize:i},a]=(0,e.useReducer)(zu,ju),s=(0,e.useCallback)(((e,t)=>a({type:"resize",clientSize:e,scrollSize:t})),[]),o=(0,e.useCallback)((e=>a({type:"scrollTo",position:e})),[]);return{position:t,max:r,clientSize:n,scrollSize:i,scrollTo:o,scrollBy:(0,e.useCallback)((e=>a({type:"scrollBy",amount:e})),[]),resize:s}}(),[b,v]=(0,e.useState)(0),[y,w]=(0,e.useState)(0),[E,_]=(0,e.useState)(0),[T,x]=(0,e.useState)(-1),[S,k]=(0,e.useState)(0),I=-1!==T,C="vertical"===r,P=Math.ceil(h/d*(y-E));(0,e.useEffect)((()=>{o.current={scrollBy:g,scrollTo:A}}),[o,g,A]),(0,e.useLayoutEffect)((()=>p(l.clientSize,l.scrollSize)),[l.clientSize,l.scrollSize,p]),(0,e.useLayoutEffect)((()=>null==i?void 0:i(h)),[h,i]),(0,e.useLayoutEffect)((()=>null==s?void 0:s(b)),[b,s]),a(c,(0,e.useCallback)((()=>{const e=c.current.getBoundingClientRect();w(C?e.height:e.width),v(C?e.width:e.height)}),[C])),a(u,(0,e.useCallback)((()=>{const e=u.current.getBoundingClientRect();_(C?e.height:e.width)}),[C]));const M=(0,e.useCallback)(((e,t)=>{const r=()=>o.current.scrollBy(t),n=t=>t.target===e,i=Kr(document,"mouseup"),a=Kr(e,"mouseover").pipe(it(n),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Re(e);return We((function(t,n){(r?Io(e,t,r):Io(e,t)).subscribe(n)}))}(!0)),s=ii(a,Kr(e,"mouseout").pipe(Ft(n),it((()=>!1)))).pipe(Ot(((e,t)=>e?Vn(0===t?400:0,40):et)),Dt(i)).subscribe(r);return r(),()=>s.unsubscribe()}),[o]),R=(0,e.useCallback)((e=>{if(0===e.button)return e.stopPropagation(),M(e.target,-n)}),[n,M]),B=(0,e.useCallback)((e=>{if(0===e.button)return e.stopPropagation(),M(e.target,n)}),[n,M]),L=(0,e.useCallback)((e=>{if(0===e.button){e.preventDefault();const t=C?e.nativeEvent.offsetY:e.nativeEvent.offsetX;return M(e.target,t<P?-f:f)}}),[C,f,P,M]),D=(0,e.useCallback)((e=>{0===e.button&&(e.preventDefault(),e.stopPropagation(),x(C?e.screenY:e.screenX),k(P))}),[C,P]),N=(0,e.useCallback)((e=>{const t=C?e.screenY:e.screenX;A((S+(t-T))*d/(y-E))}),[C,T,S,d,E,y,A]),F=(0,e.useCallback)((()=>{x(-1),k(0)}),[]);return(0,e.useEffect)((()=>{if(I)return document.body.classList.add("dragging"),document.addEventListener("mouseup",F),document.addEventListener("mousemove",N),()=>{document.body.classList.remove("dragging"),document.removeEventListener("mouseup",F),document.removeEventListener("mousemove",N)}}),[I,N,F]),e.createElement("div",{className:`scrollbar scrollbar-${r}`},e.createElement("div",{className:"scrollbar-button scrollbar-button-decrement",onMouseDown:R},e.createElement("svg",{className:"icon",viewBox:"0 0 50 50"},e.createElement("polygon",{points:C?"0,50 25,0 50,50":"50,0 0,25 50,50"}))),e.createElement("div",{className:"scrollbar-track",onMouseDown:L,ref:c},e.createElement("div",{className:"scrollbar-thumb",onMouseDown:D,style:{[C?"height":"width"]:y*(m?f/m:0)+"px",transform:`translate${C?"Y":"X"}(${P}px)`},ref:u})),e.createElement("div",{className:"scrollbar-button scrollbar-button-increment",onMouseDown:B},e.createElement("svg",{className:"icon",viewBox:"0 0 50 50"},e.createElement("polygon",{points:C?"0,0 25,50 50,0":"0,0 50,25 0,50"}))))}));function qu({children:t,scrollWidth:r=0,scrollHeight:n=0,scrollAmount:i=10,droppable:s,onResize:o,onScroll:l,scrollableRef:c}){const u=(0,e.useRef)(null),h=(0,e.useRef)(null),d=(0,e.useRef)(null),f=(0,e.useRef)(null),m=(0,e.useRef)(null),p=(0,e.useRef)(null),[g,A]=(0,e.useState)(0),[b,v]=(0,e.useState)(0),[y,w]=(0,e.useState)(0),[E,_]=(0,e.useState)(0),[T,x]=(0,e.useState)(0),[S,k]=(0,e.useState)(r),[I,C]=(0,e.useState)(n),[P,M]=(0,e.useState)(0),[R,B]=(0,e.useState)(0),[L,D]=(0,e.useState)(!1),[N,F]=(0,e.useState)(!1),[O,z]=(0,e.useState)(0),U=P-(N?b:0),j=R-(L?g:0);(0,e.useEffect)((()=>{c&&(c.current={scrollTo:({left:e,top:t})=>{void 0!==e&&m.current.scrollTo(e),void 0!==t&&p.current.scrollTo(t)}})}),[c]),(0,e.useLayoutEffect)((()=>{D(S-U>1)}),[U,S]),(0,e.useLayoutEffect)((()=>{F(I-j>1)}),[j,I]),(0,e.useLayoutEffect)((()=>{u.current.classList.toggle("overflow-x",L)}),[L]),(0,e.useLayoutEffect)((()=>{u.current.classList.toggle("overflow-y",N)}),[N]),(0,e.useLayoutEffect)((()=>{var e;k(0===r?(null===(e=h.current)||void 0===e?void 0:e.scrollWidth)||0:r)}),[r]),(0,e.useLayoutEffect)((()=>{var e;C(0===n?(null===(e=h.current)||void 0===e?void 0:e.scrollHeight)||0:n)}),[n]);const V=(0,e.useCallback)((()=>{const e=u.current;M(e.clientWidth),B(e.clientHeight),w(e.getBoundingClientRect().top)}),[]),q=(0,e.useCallback)((()=>{const e=h.current,t=f.current;0===r&&k(e.scrollWidth),0===n&&C(t.scrollHeight+d.current.clientHeight),null==o||o({width:e.clientWidth,height:e.clientHeight})}),[r,n,o]);a(u,V),a(h,q),a(f,q),(0,e.useLayoutEffect)((()=>{null==l||l({left:E,top:T})}),[E,T,l]);const Q=(0,e.useCallback)((e=>{p.current.scrollBy(3*i*Math.sign(e.deltaY))}),[i]),X=(0,e.useCallback)((e=>{const t=e.nativeEvent.clientY-y;t+i/2>R?z(i):t<i&&z(-i)}),[y,R,i]);(0,e.useEffect)((()=>{if(O){const e=()=>p.current.scrollBy(O),t=So(100).subscribe(e);return()=>t.unsubscribe()}}),[O]);const W=(0,e.useCallback)((()=>z(0)),[]),[H,G]=Ee(e.Children.toArray(t),(e=>(null==e?void 0:e.type)===Ou));return e.createElement("div",{className:"scrollable",onWheel:Q,ref:u},e.createElement("div",{className:"scrollable-content",onDragOver:s?X:void 0,onDragLeave:s?W:void 0,onDragEnd:s?W:void 0,onDrop:s?W:void 0,style:{right:N?`${b}px`:"0",bottom:L?`${g}px`:"0",transform:`translateX(-${E}px)`},ref:h},e.createElement("div",{className:"scrollable-head",ref:d},H),e.createElement("div",{className:"scrollable-body",style:{width:r?`${r}px`:void 0}},e.createElement("div",{className:"scrollable-body-content",style:{transform:`translateY(-${T}px)`},ref:f},G))),e.createElement(Vu,{orientation:"horizontal",clientSize:U,scrollSize:S,scrollAmount:i,onChange:_,onResize:A,scrollbarRef:m}),e.createElement(Vu,{orientation:"vertical",clientSize:j,scrollSize:I,scrollAmount:i,onChange:x,onResize:v,scrollbarRef:p}))}function Qu(t=200){const[r,n]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{const e=(e,t)=>Kr(document,e,{capture:!0}).pipe(it((()=>t))),r=ii(e("keydown",!0),e("keyup",!1)).pipe((i=e=>e?Ze(0):Vn(t),We((function(e,t){var r=!1,n=null,a=null,s=function(){if(null==a||a.unsubscribe(),a=null,r){r=!1;var e=n;n=null,t.next(e)}};e.subscribe(He(t,(function(e){null==a||a.unsubscribe(),r=!0,n=e,a=He(t,s,L),qe(i(e)).subscribe(a)}),(function(){s(),t.complete()}),void 0,(function(){n=a=null})))})))).subscribe(n);var i;return()=>r.unsubscribe()}),[t]),r}function Xu(t){return(0,e.useMemo)((()=>Wu(t)),[t])}function Wu(e){return e.reduce(((e,t)=>(e.push(t.id),t.children?e.concat(Wu(t.children)):e)),[])}function Hu(t){return{storeExpandedState:(0,e.useCallback)(((e,r)=>{t&&localStorage.setItem(`${t}/${e}`,String(!!r))}),[t]),retrieveExpandedState:(0,e.useCallback)(((e,r=!1)=>{if(t){const n=localStorage.getItem(`${t}/${e}`);return"string"==typeof n?"true"===n:r}return r}),[t]),storeSelectedNodeId:(0,e.useCallback)((e=>{t&&localStorage.setItem(`${t}/selectedId`,e)}),[t]),retrieveSelectedNodeId:(0,e.useCallback)((e=>t&&localStorage.getItem(`${t}/selectedId`)||e),[t])}}function Gu(t,r){const{storeExpandedState:n,retrieveExpandedState:i}=Hu(r),a=Xu(t),[s,o]=(0,e.useState)((()=>$u(t,i)));(0,e.useEffect)((()=>{const e=s.filter((e=>a.includes(e)));e.length!==s.length&&o(e)}),[a,s]);const l=(0,e.useCallback)(((e,t)=>{const r=s.includes(e);r!==t&&(o(r?s.filter((t=>t!==e)):s.concat(e)),n(e,!r))}),[s,n]);return{expandedIds:s,toggle:l}}function $u(e,t){return e.reduce(((e,r)=>(t(r.id,r.startExpanded)&&e.push(r.id),r.children?e.concat($u(r.children,t)):e)),[])}function Yu(t,r){return(0,e.useMemo)((()=>Ku(t,r)),[t,r])}function Ku(e,t){return e.reduce(((e,r)=>(e.push(r.id),r.children&&t.includes(r.id)?e.concat(Ku(r.children,t)):e)),[])}function Ju({id:t,label:r,children:n=[],selectedId:i,expandedIds:a,level:s,rowHeight:o,nodeIndex:l,setSize:c,onSelect:u,onToggle:h}){const d=a.includes(t),f=0!==n.length,m=t===i,p=`${f?"expandable":""} ${d?"expanded":""} ${m?"selected":""} ${0===n.length?"empty":""}`,g=(0,e.useCallback)((e=>{e.stopPropagation()}),[]),A=(0,e.useCallback)((e=>{e.stopPropagation(),null==u||u(t)}),[t,u]),b=(0,e.useCallback)((e=>{e.stopPropagation(),null==h||h(t)}),[t,h]),v=(0,e.useCallback)((e=>{e.stopPropagation(),null==h||h(t),d&&eh(n,i)&&(null==u||u(t))}),[t,i,d,n,u,h]);return e.createElement("li",{className:`tree-view-node ${p}`,id:`tree-view-node-${t}`,role:"treeitem","aria-selected":m?"true":void 0,"aria-expanded":d?"true":void 0,"aria-labelledby":`tree-view-node-label-${t}`,"aria-level":s,"aria-setsize":c,"aria-posinset":l+1,onMouseDown:A},e.createElement("span",{className:"tree-view-row",onDoubleClick:b,style:{height:`${o}px`}},f&&e.createElement("svg",{className:"tree-view-node-marker",viewBox:`0 0 ${d?320:256} 512`,onMouseDown:g,onClick:v},d?e.createElement("path",{d:"M143 352.3L7 216.3c-9.4-9.4-9.4-24.6 0-33.9l22.6-22.6c9.4-9.4 24.6-9.4 33.9 0l96.4 96.4 96.4-96.4c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9l-136 136c-9.2 9.4-24.4 9.4-33.8 0z"}):e.createElement("path",{d:"M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"})),e.createElement("span",{className:"tree-view-node-label",id:`tree-view-node-label-${t}`},r)),d&&e.createElement("ul",{className:"tree-view-node-children",role:"group"},n.map(((t,r)=>{var{id:l}=t,c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["id"]);return e.createElement(Ju,Object.assign({},c,{id:l,selectedId:i,expandedIds:a,level:s+1,rowHeight:o,nodeIndex:r,setSize:n.length,onSelect:u,onToggle:h,key:l}))}))))}function Zu({roots:t,className:r="",storeId:n,onContextMenu:i,onDelete:s,onEnter:o,onInfo:l,onSelect:c}){const u=(0,e.useRef)(null),h=(0,e.useRef)(null),d=(0,e.useRef)(null),{storeSelectedNodeId:f,retrieveSelectedNodeId:m}=Hu(n),[p,g]=(0,e.useState)((()=>{var e;return m(null===(e=t[0])||void 0===e?void 0:e.id)})),{expandedIds:A,toggle:b}=Gu(t,n),v=Yu(t,A),y=v.indexOf(p),[w,E]=(0,e.useState)(0),[_,T]=(0,e.useState)(24),[x,S]=(0,e.useState)(0),k=Math.floor(w/_)-1,I=v.length,C=th(t,p),P=Qu()&&!(0===y||y===I-1),[M,R]=(0,e.useState)((()=>C));(0,e.useLayoutEffect)((()=>{if(!eh(t,p)){const e=t.find((e=>p.startsWith(`${e.id}/`)))||t[0];g(null==e?void 0:e.id)}}),[t,p]),(0,e.useLayoutEffect)((()=>{null==c||c(M)}),[M,c]),(0,e.useEffect)((()=>{f(p)}),[p,f]),(0,e.useEffect)((()=>{P||R(C)}),[C,P]);const B=(0,e.useCallback)((e=>{e.preventDefault(),null==i||i(C,e.pageX,e.pageY)}),[C,i]),L=(0,e.useCallback)((e=>{switch(e.key){case"Enter":e.stopPropagation(),e.repeat||null==o||o(C);break;case"Delete":e.stopPropagation(),e.repeat||null==s||s(C);break;case"Info":case"i":e.stopPropagation(),e.repeat||null==l||l(C);break;case"ArrowLeft":e.stopPropagation(),e.repeat||b(p,!1);break;case"ArrowRight":e.stopPropagation(),e.repeat||b(p,!0);break;default:{const t=function(e,t,r){switch(e){case"ArrowUp":return t[t.indexOf(r)-1]||r;case"ArrowDown":return t[t.indexOf(r)+1]||r;case"Home":return t[0]||r;case"End":return t[t.length-1]||r;default:return""}}(e.key,v,p);if(t&&(e.preventDefault(),t!==p)){e.stopPropagation();const r=h.current,n=Math.floor(x/_),i=v.indexOf(t);if(i>=n+k-1){const e=I*_,t=I-k-1,n=Math.min(I-1,i+1)-k,a=n===t?e:n*_;r.scrollTo({top:a})}else if(i<=n){const e=Math.max(0,i-1)*_;r.scrollTo({top:e})}g(t)}}}}),[v,p,C,_,k,I,x,s,o,l,b]),D=(0,e.useCallback)((({height:e})=>E(e)),[]),N=(0,e.useCallback)((({top:e})=>S(e)),[]);return a(d,(0,e.useCallback)((()=>{T(d.current.getBoundingClientRect().height)}),[])),e.createElement("div",{className:`tree-view ${r}`,tabIndex:0,onContextMenu:B,onKeyDown:L,ref:u},e.createElement(qu,{scrollAmount:_,onResize:D,onScroll:N,scrollableRef:h},e.createElement("ul",{role:"tree"},t.map(((r,n)=>{var{id:i}=r,a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(r,["id"]);return e.createElement(Ju,Object.assign({},a,{id:i,selectedId:p,expandedIds:A,level:1,rowHeight:_,nodeIndex:n,setSize:t.length,onSelect:g,onToggle:b,key:i}))}))),e.createElement("div",{className:"tree-view-cursor",style:{transform:`translateY(${y*_}px)`},ref:d})))}function eh(e,t){for(const r of e){if(r.id===t)return!0;if(r.children&&eh(r.children,t))return!0}return!1}function th(e,t){return e.reduce(((e,r)=>{if(void 0===e)if(r.id===t)e=r.value;else if(r.children)return th(r.children,t);return e}),void 0)}function rh(){return e.createElement("div",{className:"panel"},e.createElement("div",{className:"page login"},e.createElement("p",null,"You need to be logged in to play music from Spotify*."),e.createElement("p",null,e.createElement(Lr,{className:"branded login",onClick:ho},"Log in to Spotify")),e.createElement("p",null,e.createElement("small",null,e.createElement("em",null,"*Spotify Premium required.")))))}function nh(){return e.createElement("div",{className:"panel"},e.createElement("div",{className:"page login"},e.createElement("p",null,"You can still play YouTube videos without being logged in.",e.createElement("br",null),"But you need to be logged in to search for music."),e.createElement("p",null,e.createElement(Lr,{className:"branded login",onClick:wi},"Log in to YouTube"))))}function ih({service:t}){switch(t.id){case"spotify":return e.createElement(rh,null);case"youtube":return e.createElement(nh,null);default:return e.createElement("div",{className:"panel"},e.createElement("div",{className:"page login"},e.createElement("p",null,"You need to be logged in to play music from ",t.title,"."),e.createElement("p",null,e.createElement(Lr,{className:"branded login",onClick:t.login},"Log in to ",t.title))))}}function ah({onSubmit:t}){const r=(0,e.useRef)(null),n=(0,e.useCallback)((e=>{const n=r.current.value;e.preventDefault(),null==t||t(n)}),[t]);return e.createElement("form",{className:"search-bar",onSubmit:n},e.createElement("p",{className:"search-bar-input"},e.createElement(Ur,{type:"search",spellCheck:!1,autoComplete:"off",autoCapitalize:"off",ref:r}),e.createElement(Lr,{type:"submit"},"Search")))}function sh(t,r){const[n,i]=(0,e.useState)(r),a=(0,e.useMemo)(t,[t]);return(0,e.useEffect)((()=>{const e=a.subscribe(i);return()=>e.unsubscribe()}),[a]),n}function oh(){const t=(0,e.useRef)(null);null===t.current&&(t.current=new Z),(0,e.useEffect)((()=>()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.complete()}),[]);const r=(0,e.useCallback)((e=>{t.current.next(e)}),[]);return[t.current,r]}function lh({item:t}){switch(t.itemType){case Ie.Media:return e.createElement(ch,{item:t});case Ie.Artist:return e.createElement(hh,{item:t});case Ie.Album:return e.createElement(uh,{item:t});case Ie.Playlist:return e.createElement(dh,{item:t})}}function ch({item:t}){return e.createElement("article",{className:"media-info media-item-info"},e.createElement("div",{className:"media-info-main"},e.createElement(vh,{thumbnails:t.thumbnails}),e.createElement(fh,{title:t.title}),e.createElement(mh,{artist:t.artist}),e.createElement(Ah,{album:t.album,year:t.year}),e.createElement(ph,{owner:t.owner,src:t.src})),e.createElement(gh,{url:t.externalUrl,src:t.src}))}function uh({item:t}){return e.createElement("article",{className:"media-info album-info"},e.createElement("div",{className:"media-info-main"},e.createElement(vh,{thumbnails:t.thumbnails}),e.createElement(fh,{title:t.title}),e.createElement(mh,{artist:t.artist}),e.createElement(bh,{year:t.year})),e.createElement(gh,{url:t.externalUrl,src:t.src}))}function hh({item:t}){return e.createElement("article",{className:"media-info artist-info"},e.createElement("div",{className:"media-info-main"},e.createElement(vh,{thumbnails:t.thumbnails}),e.createElement(fh,{title:t.title})),e.createElement(gh,{url:t.externalUrl,src:t.src}))}function dh({item:t}){return e.createElement("article",{className:"media-info playlist-info"},e.createElement("div",{className:"media-info-main"},e.createElement(vh,{thumbnails:t.thumbnails}),e.createElement(fh,{title:t.title}),e.createElement(ph,{owner:t.owner,src:t.src})),e.createElement(gh,{url:t.externalUrl,src:t.src}))}function fh({title:t}){return e.createElement("h3",{className:"title"},t||"(no title)")}function mh({artist:t}){return t?e.createElement("h4",{className:"artist"},"By: ",t):null}function ph({src:t,owner:r}){if(!r)return null;const[n]=t.split(":");let i="Owner";return"youtube"!==n?null:(i="Channel",e.createElement("p",{className:"owner"},i,":"," ",e.createElement("a",{href:r.url,target:`ampcast-${n}`},r.name)))}function gh({src:t,url:r}){if(!r)return null;const[n]=t.split(":");let i="";switch(n){case"apple":i="Apple Music";break;case"spotify":i="Spotify";break;case"youtube":i="YouTube";break;case"lastfm":i="last.fm";break;default:return null}return e.createElement("p",{className:"external-view"},"View on ",i,": ",e.createElement(Dr,{name:n})," ",e.createElement("a",{href:r,target:`ampcast-${n}`},r))}function Ah({album:t,year:r}){return t&&r?e.createElement("h4",{className:"album"},"From: ",t," (",r,")"):t?e.createElement("h4",{className:"album"},"From: ",t):r?e.createElement("h4",{className:"album"},"Year: ",r):null}function bh({year:t}){return t?e.createElement("p",{className:"year"},"Year: ",t):null}function vh({thumbnails:t}){const r=we(t);return e.createElement("div",{className:"thumbnail"},e.createElement("div",{className:"thumbnail-img",style:{backgroundImage:`url(${r.url})`}}))}function yh(t){zr((r=>e.createElement(wh,Object.assign({},r,{item:t,target:"popup"}))))}function wh(t){var{item:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["item"]);return e.createElement(Fr,Object.assign({},n,{className:"media-info-dialog",title:"Media Info"}),e.createElement("form",{method:"dialog"},e.createElement(lh,{item:r}),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,null,"Close"))))}let Eh=null;const _h=function(e){return"#globalDrag"===e.dataTransfer.getData("text")?Eh:null},Th=function(e,t){e.dataTransfer.setData("text","#globalDrag"),Eh=t},xh=function(){Eh=null};function Sh({style:t,title:r}){return e.createElement("div",{className:"list-view-cell",style:t},r)}function kh({col:t,onResize:r}){const[n,i]=(0,e.useState)(t.width),[a,s]=(0,e.useState)(-1),[o,l]=(0,e.useState)(0),c=-1!==a,u=(0,e.useCallback)((e=>{e.preventDefault(),0===e.button&&(s(e.screenX),l(n))}),[n]);(0,e.useEffect)((()=>r(t.index,n)),[t.index,n,r]);const h=(0,e.useCallback)((e=>{i(Math.max(20,o+(e.screenX-a)))}),[a,o]),d=(0,e.useCallback)((()=>{s(-1),l(0)}),[]);return(0,e.useEffect)((()=>{if(c)return document.documentElement.style.cursor="col-resize",document.body.classList.add("dragging"),document.addEventListener("mouseup",d),document.addEventListener("mousemove",h),()=>{document.documentElement.style.cursor="",document.body.classList.remove("dragging"),document.removeEventListener("mouseup",d),document.removeEventListener("mousemove",h)}}),[c,h,d]),e.createElement("span",{className:"column-resizer",onMouseDown:u,style:{left:t.left+n-4+"px"}})}function Ih({width:t,height:r,cols:n,sizeable:i,onColumnResize:a}){const s=(0,e.useCallback)(((e,t)=>{null==a||a(e,t)}),[a]);return e.createElement("header",{className:"list-view-head",style:{width:`${t}px`}},e.createElement("div",{className:"list-view-row",style:{width:`${t}px`,height:`${r}px`}},n.map((t=>e.createElement(Sh,Object.assign({},t,{key:t.title}))))," ",i&&n.map((t=>e.createElement(kh,{col:t,onResize:s,key:t.title})))))}function Ch({rowIndex:t,col:{className:r="",render:n,style:i},item:a}){return e.createElement("div",{className:`list-view-cell ${r}`,style:i},n(a,t))}function Ph({item:t,className:r,rowIndex:n,height:i,selected:a,cols:s,setSize:o,dragIndex:l}){const c=`${r} ${a?"selected":""} ${l===o?n===o-1?"drag-over-last":"":l===n?"drag-over":""}`;return e.createElement("li",{role:"option",className:`list-view-row ${c}`,"aria-selected":a?"true":void 0,"aria-setsize":o,"aria-posinset":n+1,style:{height:`${i}px`,transform:`translateY(${i*n}px)`}},s.map((r=>e.createElement(Ch,{rowIndex:n,col:r,item:t,key:r.title}))))}function Mh({width:t,height:r,rowHeight:n,cols:i,items:a,itemKey:s,itemClassName:o,scrollTop:l,overScan:c=20,selection:u,draggable:h,dragIndex:d}){const f=(0,e.useRef)(null),m=a.length,p=Math.floor(l/n),g=Math.floor(r/n),A=Math.max(0,p-c),b=Math.min(m,g+2*c),v=(0,e.useMemo)((()=>a.slice(A,A+b)),[a,A,b]);return e.createElement("ol",{role:"listbox",className:"list-view-body",draggable:h,style:{width:t?`${t}px`:void 0},ref:f},v.map(((t,r)=>e.createElement(Ph,{className:o(t),rowIndex:A+r,height:n,selected:u.includes(t),cols:i,item:t,setSize:m,dragIndex:d,key:t[s]}))))}const Rh=()=>"";function Bh({items:t=[],itemKey:r,itemClassName:n=Rh,layout:i,className:s="",draggable:l,droppable:c,droppableTypes:u=[],multiSelect:h,reorderable:d,onClick:f,onDoubleClick:m,onContextMenu:p,onDrop:g,onDelete:A,onEnter:b,onInfo:v,onRowIndexChange:y,onScrollIndexChange:w,onPageSizeChange:E,onSelect:_,onMove:T,listViewRef:x}){const S=(0,e.useRef)(null),k=(0,e.useRef)(null),I=(0,e.useRef)(null),C=(0,e.useRef)(null),P="details"===i.view&&i.showTitles,M="details"===i.view&&i.sizeable,[R,B]=(0,e.useState)(-1),[L,D]=(0,e.useState)(0),[N,F]=(0,e.useState)(0),[O,z]=(0,e.useState)(0),[U,j]=(0,e.useState)(0),[V,q]=function(t,r=!1){const[n,i]=(0,e.useState)([]);(0,e.useEffect)((()=>{i(t.reduce(((e,t,n)=>{const i=e[n-1],a=i?i.left+i.width:0,{className:s="",align:o="left",sortOrder:l="none",sortPriority:c=0,width:u=200}=t,h=r?{left:`${a}px`,width:`${u}px`,textAlign:o}:{textAlign:o};return e.push(Object.assign(Object.assign({},t),{className:s,align:o,index:n,left:a,width:u,style:h,sortOrder:l,sortPriority:c})),e}),[]))}),[t,r]);const a=(0,e.useCallback)(((e,t)=>{r&&n[e].width!==t&&i(n.reduce(((r,n,i)=>{if(i>=e){const a=r[i-1],s=a?a.left+a.width:0,o=i===e?t:n.width,l={left:`${s}px`,width:`${o}px`,textAlign:n.align};r.push(Object.assign(Object.assign({},n),{left:s,width:o,style:l}))}else r.push(n);return r}),[]))}),[n,r]);return[n,a]}(i.cols,M),Q=(0,e.useMemo)((()=>V.reduce(((e,t)=>e+t.width),0)),[V]),X=U?Math.floor(N/U)-(P?1:0):0,W=t.length,{selectedItems:H,selectAll:G,selectAt:$,selectRange:Y,toggleSelectionAt:K}=function(t,r){const[n,i]=(0,e.useState)([]);(0,e.useLayoutEffect)((()=>{const e=t.filter((e=>n.some((t=>t[r]===e[r]))));var a,s;s=e,(a=n).length===s.length&&a.every(((e,t)=>s[t]===e))||i(e)}),[t,n,r]);const a=(0,e.useCallback)((()=>{i(t.slice())}),[t]),s=(0,e.useCallback)((e=>{const r=t[e];i(r?[r]:[])}),[t]),o=(0,e.useCallback)(((e,r)=>{const n=Math.min(e,r),a=Math.max(e,r),s=t.slice(n,a+1);i(s)}),[t]),l=(0,e.useCallback)(((e,r)=>{const a=t[e],s=n.includes(a);s!==r&&i(s?n.filter((e=>e!==a)):n.concat(a))}),[t,n]);return{selectedItems:n,selectAll:a,selectAt:s,selectRange:o,toggleSelectionAt:l}}(t,r),J=o(),[Z,ee]=(0,e.useState)(-1),[te,re]=(0,e.useState)(-1),[ne,ie]=(0,e.useState)(-1),ae=0===W,se=function(t){const r=(0,e.useRef)();return(0,e.useEffect)((()=>{r.current=t}),[t]),r.current}(ae),oe=-1!==ne,le=U?Math.floor(L/U):0,ce=Qu()&&!(0===R||R===W-1),[ue,he]=(0,e.useState)((()=>H)),[de,fe,me,pe]=l?ue:[];(0,e.useEffect)((()=>{x&&(x.current={selectAll:G})}),[x,G]),(0,e.useLayoutEffect)((()=>null==y?void 0:y(R)),[R,y]),(0,e.useLayoutEffect)((()=>null==w?void 0:w(le)),[le,w]),(0,e.useLayoutEffect)((()=>null==E?void 0:E(X)),[X,E]),(0,e.useLayoutEffect)((()=>null==_?void 0:_(ue)),[ue,_]),(0,e.useEffect)((()=>B(Math.min(W-1,R))),[W,R]),(0,e.useEffect)((()=>{ce||he(H)}),[H,ce]),(0,e.useEffect)((()=>{ae?B(-1):se&&(B(0),$(0))}),[ae,se,$]);const ge=(0,e.useCallback)((e=>{switch(e.key){case"Enter":e.stopPropagation(),e.repeat||null==b||b(H,e.ctrlKey,e.shiftKey);break;case"Delete":e.stopPropagation(),null==A||A(H);break;case"i":if(e.stopPropagation(),e.ctrlKey&&!e.repeat){null==v||v(H);break}break;case"Info":e.preventDefault(),e.stopPropagation(),e.repeat||null==v||v(H);break;case"a":e.ctrlKey&&(e.preventDefault(),e.stopPropagation(),e.repeat||G());break;case"Shift":e.repeat||ee(R);break;case" ":e.preventDefault(),e.repeat||(e.ctrlKey?(e.stopPropagation(),K(R)):H.includes(t[R])||(e.stopPropagation(),K(R,!0)));break;default:{const r=t.length,n=function(e,t,r,n){switch(e){case"ArrowUp":t-=1;break;case"ArrowDown":t+=1;break;case"PageUp":t-=r-1;break;case"PageDown":t+=r-1;break;case"Home":t=0;break;case"End":t=n-1;break;default:return-1}return Math.min(Math.max(t,0),n-1)}(e.key,R,X,r);if(-1!==n){if(e.preventDefault(),n!==R){e.stopPropagation();const t=k.current,i=Math.floor(L/U);if(n>=i+X-1){const e=(r+(P?1:0))*U,i=r-X-1,a=Math.min(r-1,n+1)-X,s=a===i?e:a*U;t.scrollTo({top:s})}else if(n<=i){const e=Math.max(0,n-1)*U;t.scrollTo({top:e})}B(n)}h&&e.shiftKey&&-1!==Z?Y(Z,n):e.ctrlKey||$(n)}}}}),[R,t,X,U,P,b,A,v,G,$,Y,K,H,h,Z,L]),Ae=(0,e.useCallback)((e=>{const t=Lh(e);-1!==t&&(B(t),h&&e.ctrlKey?K(t):h&&e.shiftKey?-1===Z?Y(t,R):Y(Z,t):function(e){const t=Dh(e);return(null==t?void 0:t.classList.contains("selected"))||!1}(e)||$(t))}),[$,K,Y,R,Z,h]),be=(0,e.useCallback)((e=>{if(0===e.button){const t=Lh(e);-1!==t&&(!h||e.ctrlKey||e.shiftKey||$(t))}}),[$,h]),ve=(0,e.useCallback)((e=>{"Shift"===e.key&&ee(-1)}),[]),ye=(0,e.useCallback)((({width:e,height:t})=>{z(e),F(t)}),[]),we=(0,e.useCallback)((({top:e})=>{D(e)}),[]);a(I,(0,e.useCallback)((()=>{j(I.current.getBoundingClientRect().height)}),[])),(0,e.useLayoutEffect)((()=>{S.current.classList.toggle("thin",20*J>O)}),[J,O]);const Ee=(0,e.useCallback)((e=>{const r=Lh(e);-1!==r&&(e.preventDefault(),null==f||f(t[r],r))}),[t,f]),_e=(0,e.useCallback)((e=>{e.preventDefault(),-1!==Lh(e)&&(null==p||p(H,e.pageX,e.pageY))}),[H,p]),Te=(0,e.useCallback)((e=>{const r=Lh(e);-1!==r&&(e.preventDefault(),null==m||m(t[r],r))}),[t,m]);(0,e.useEffect)((()=>{const e=C.current;for(;e.hasChildNodes();)e.removeChild(e.lastChild);const t=Array.from(S.current.querySelectorAll(".list-view-body:not(list-view-drag-image) li.selected"));t.length=Math.min(t.length,4);for(let r=0;r<t.length;r++){const n=t[r].cloneNode(!0);n.style.transform=`translateY(${U*r}px)`,e.appendChild(n)}}),[de,fe,me,pe,U]);const xe=(0,e.useCallback)((e=>{const t=e.dataTransfer;l||d?(Th(e,H),t.setDragImage(C.current,-10,-10),t.effectAllowed=l&&d?"copyMove":l?"copy":"move",ie(R)):t.effectAllowed="none"}),[l,d,H,R]),Se=(0,e.useCallback)((e=>{const t=e.dataTransfer;if(c||d){const r=t.types.includes("text/plain");let n=Lh(e);-1===n&&(n=W),oe?d&&r?(t.dropEffect="move",re(n)):(t.dropEffect="none",re(-1)):c&&(r||Nh(t.items,u))?(t.dropEffect="copy",re(n)):(t.dropEffect="none",re(-1))}else oe?t.dropEffect="copy":(t.dropEffect="none",re(-1));e.preventDefault(),e.stopPropagation()}),[W,oe,c,u,d]),ke=(0,e.useCallback)((e=>{if(c||d){const t=e.dataTransfer;let r=Lh(e);if(-1===r&&(r=W),"copy"===t.effectAllowed){const t=_h(e);t&&(null==g||g(t,r))}else if("move"===t.effectAllowed){const e=ne<r?-1:0;null==T||T(H,r),B(r+e)}else c&&Nh(t.items,u)&&(null==g||g(t.files,r))}re(-1),e.preventDefault(),e.stopPropagation()}),[W,H,c,u,d,ne,g,T]),Ie=(0,e.useCallback)((()=>{xh(),ie(-1)}),[]),Ce=(0,e.useCallback)((()=>{re(-1)}),[]);return e.createElement("div",{className:`list-view list-view-${i.view} ${s}`,tabIndex:0,onClick:Ee,onContextMenu:_e,onDoubleClick:Te,onDragStart:xe,onDragEnter:Se,onDragOver:Se,onDragLeave:Ce,onDragEnd:Ie,onDrop:ke,onKeyDown:ge,onKeyUp:ve,onMouseDown:Ae,onMouseUp:be,ref:S},e.createElement(qu,{scrollWidth:M?Q:void 0,scrollHeight:(W+(c?1:0)+(P?1:0))*U,scrollAmount:U,droppable:c||d&&oe,onResize:ye,onScroll:we,scrollableRef:k},P&&e.createElement(Ou,null,e.createElement(Ih,{width:Q,height:U,sizeable:M,cols:V,onColumnResize:q})),e.createElement(Mh,{width:M?Q:void 0,height:N,rowHeight:U,cols:V,items:t,itemKey:r,itemClassName:n,scrollTop:L,selection:H,dragIndex:te,draggable:l||d}),e.createElement("div",{className:"list-view-cursor",style:{width:M?`${Q}px`:void 0,transform:`translateY(${R*U}px)`},ref:I}),e.createElement("ul",{className:"list-view-drag-image list-view-body",ref:C})))}function Lh(e){let t=0;const r=Dh(e);return r&&(t=Number(r.getAttribute("aria-posinset"))||0),t-1}function Dh(e){let t=e.target;for(;t&&!(null==t?void 0:t.hasAttribute("aria-posinset"));)t=t.parentElement;return t}function Nh(e,t){return-1!==Array.from(e).findIndex((e=>t.some((t=>((e,t)=>{const[r,n]=e.split("/"),[i,a]=t.split("/");return r===i&&(n===a||"*"===n)})(t,e.type)))))}new Image(0,0).src=re;var Fh,Oh=1,zh={};function Uh(e){return e in zh&&(delete zh[e],!0)}var jh=function(e){var t=Oh++;return zh[t]=!0,Fh||(Fh=Promise.resolve()),Fh.then((function(){return Uh(t)&&e()})),t},Vh=function(e){Uh(e)},qh={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=qh.delegate;return((null==r?void 0:r.setImmediate)||jh).apply(void 0,g([],p(e)))},clearImmediate:function(e){var t=qh.delegate;return((null==t?void 0:t.clearImmediate)||Vh)(e)},delegate:void 0},Qh=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n}return d(t,e),t.prototype.requestAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&n>0?e.prototype.requestAsyncId.call(this,t,r,n):(t.actions.push(this),t._scheduled||(t._scheduled=qh.setImmediate(t.flush.bind(t,void 0))))},t.prototype.recycleAsyncId=function(t,r,n){if(void 0===n&&(n=0),null!=n&&n>0||null==n&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,r,n);t.actions.some((function(e){return e.id===r}))||(qh.clearImmediate(r),t._scheduled=void 0)},t}(rn),Xh=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var r,n=this.actions;e=e||n.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=n[0])&&e.id===t&&n.shift());if(this._active=!1,r){for(;(e=n[0])&&e.id===t&&n.shift();)e.unsubscribe();throw r}},t}(an))(Qh);function Wh({children:t}){return e.createElement("footer",{className:"status-bar"},t)}function Hh({items:t,size:r,maxSize:n,error:i,loading:a,loadingText:s="Loading",selectedCount:o,itemName:l="item",itemNamePlural:c=l+"s"}){let u="";if(a)u=e.createElement("span",{className:"message"},s,"...");else if(t.length>0){const i=t.reduce((e=>e+1),0),a=e.createElement("span",{className:"selected"},"(",o," selected)"),s=i===r?`${r.toLocaleString()} ${1===r?l:c}`:`Loaded ${i}/${void 0===r?n||`${t.length}+`:n?Math.min(r,n):r} ${c}`;u=e.createElement("span",{className:"message"},s," ",a)}else if(i){const t=null==i?void 0:i.message;u=e.createElement("span",{className:"error"},t?`Error: ${t}`:"Error")}else u=e.createElement("span",{className:"message"},"0 ",c);return e.createElement(Wh,null,u)}function Gh({time:t,className:r}){return e.createElement("time",{className:r},function(e){return new Date(Math.round(1e3*(e||0))).toISOString().slice(11,19).replace(/^[0:]+(.{4,})$/,"$1")}(t))}const $h={view:"details",fields:["Title","Genre","Owner"]};const Yh=t=>e.createElement(Gh,{time:t.duration||0}),Kh={Index:{title:"#",render:(e,t)=>t+1,className:"index",align:"right",width:60},Artist:{title:"Artist",render:e=>e.artist,className:"artist"},Title:{title:"Title",render:e=>e.title,className:"title"},Album:{title:"Album",render:e=>e.album,className:"album"},AlbumAndYear:{title:"Album",render:e=>e.album?e.year?`${e.album} (${e.year})`:e.album:e.year||"",className:"album"},Track:{title:"Track",render:e=>e.track||"-",align:"right",width:80,className:"track"},Duration:{title:"Time",render:Yh,align:"right",width:120,className:"duration"},PlayCount:{title:"Play Count",render:e=>e.playCount||"",align:"right",width:120,className:"play-count"},TrackCount:{title:"Tracks",render:e=>e.trackCount||"",align:"right",width:120,className:"track-count"},Year:{title:"Year",render:e=>e.year||"",align:"right",width:120,className:"year"},Genre:{title:"Genre",render:e=>{var t;return null===(t=e.genre)||void 0===t?void 0:t.split(";").join(", ")},className:"genre"},Owner:{title:"Owner",render:e=>{var t;return null===(t=e.owner)||void 0===t?void 0:t.name},className:"owner"},LastPlayed:{title:"Last Played",render:e=>{if(!e.playedOn)return"";const t=Date.now()-e.playedOn;if(t<12e4)return"just now";const r=36e5;if(t<54e5)return`${Math.round(t/6e4)} minutes ago`;const n=24*r;if(t<1.5*n)return`${Math.round(t/r)} hours ago`;if(t<12*n)return`${Math.round(t/n)} days ago`;const i=7*n;if(t<10*i)return`${Math.round(t/i)} weeks ago`;const a=365*n;return t<a?`${Math.round(t/2592e6)} months ago`:t<2*a?"1 year ago":`${Math.floor(t/a)} years ago`},className:"played-on"},Thumbnail:{title:"Thumbnail",render:t=>{const r=we(t.thumbnails);return e.createElement("div",{className:"thumbnail-img",style:{backgroundImage:`url(${r.url})`}})},className:"thumbnail"}};function Jh(t){var{className:r="",pager:n=null,keepAlive:i,statusBar:a=!0,loadingText:s,onSelect:o,unplayable:l}=t,c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["className","pager","keepAlive","statusBar","loadingText","onSelect","unplayable"]);const u=function(t=$h){return(0,e.useMemo)((()=>function(e){const{view:t,fields:r}=e,n=r.map((e=>Kh[e]));return"details"===t?{view:t,cols:n,showTitles:!0,sizeable:!0}:{view:t,cols:n}}(t)),[t])}(c.layout),[h,d]=(0,e.useState)(0),[f,m]=(0,e.useState)(0),[{items:p,loaded:g,error:A,size:b,maxSize:v},y]=function(t,r=!1){const[n,i]=oh(),[a,s]=(0,e.useState)([]),[o,l]=(0,e.useState)(void 0),[c,u]=(0,e.useState)(void 0),[h,d]=(0,e.useState)(),[f,m]=(0,e.useState)(!1),p=(0,e.useMemo)((()=>({items:a,size:o,maxSize:c,error:h,loaded:f})),[a,o,c,h,f]),g=(0,e.useCallback)(((e,t)=>{i([e,t])}),[i]);return(0,e.useEffect)((()=>{if(s([]),l(void 0),u(void 0),d(void 0),m(!1),!t)return;const e=t.observeItems(),i=t.observeSize(),a=t.observeMaxSize(),o=t.observeError(),c=ii(e,o).pipe(Nt(1),it((()=>!0))),h=Io(Ze([]),et.pipe(Po(0,Xh))),f=new _;return f.add(Io(h,e).subscribe(s)),f.add(i.subscribe(l)),f.add(a.subscribe(u)),f.add(o.subscribe(d)),f.add(c.subscribe(m)),f.add(n.subscribe((([e,r])=>t.fetchAt(e,r)))),r||f.add((()=>t.disconnect())),()=>f.unsubscribe()}),[t,n,r]),[p,g]}(n,i),[w,E]=(0,e.useState)(0);(0,e.useEffect)((()=>{h>=0&&f>0&&y(h,f)}),[y,h,f,n]);const T=(0,e.useCallback)((e=>{E(e.length),null==o||o(e)}),[o]);return e.createElement("div",{className:`panel ${r}`},e.createElement(Bh,Object.assign({},c,{className:"media-list "+(l?"":"playable"),layout:u,items:p,itemKey:"src",onPageSizeChange:m,onScrollIndexChange:d,onSelect:T})),a?e.createElement(Hh,{items:p,error:A,size:b,maxSize:v,loading:!!n&&!g,loadingText:s,selectedCount:w}):null)}function Zh({className:t="",children:r,onClose:n,x:i,y:a}){const s=(0,e.useRef)(null),[o,l]=(0,e.useState)({visibility:"hidden"});(0,e.useLayoutEffect)((()=>{const e={},t=s.current;i+t.offsetWidth>document.body.clientWidth?e.left=i-t.offsetWidth+"px":e.left=`${i}px`,a+t.offsetHeight>document.body.clientHeight?e.top=a-t.offsetHeight+"px":e.top=`${a}px`,l(e)}),[i,a]),(0,e.useEffect)((()=>{const e=ii(Kr(document,"click"),Kr(document,"keydown",{capture:!0}),Kr(document,"contextmenu",{capture:!0}),Kr(window,"blur")).subscribe((()=>n("")));return()=>e.unsubscribe()}),[n]);const c=(0,e.useCallback)((e=>{let t=e.target;for(;t&&!t.value;)t=t.parentElement;(null==t?void 0:t.value)&&(e.stopPropagation(),n(t.value))}),[n]);return pr.createPortal(e.createElement("menu",{className:`popup-menu ${t}`,onClick:c,style:o,ref:s},r),document.getElementById("popup"))}function ed({label:t,acceleratorKey:r="",action:n}){return e.createElement("li",{className:"popup-menu-item"},e.createElement(Lr,{value:n},e.createElement("span",{className:"popup-menu-item-label"},t),e.createElement("span",{className:"popup-menu-item-accelerator-key"},r)))}function td(r,n,i){return a=this,s=void 0,l=function*(){return new Promise(((a,s)=>{const o=document.createElement("div"),l=(0,t.s)(o);try{const t=e=>{l.unmount(),o.remove(),a(e)};document.body.append(o),l.render(e.createElement(r,{x:n,y:i,onClose:t}))}catch(e){l.unmount(),o.remove(),s(e)}}))},new((o=void 0)||(o=Promise))((function(e,t){function r(e){try{i(l.next(e))}catch(e){t(e)}}function n(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):function(e){return e instanceof o?e:new o((function(t){t(e)}))}(t.value).then(r,n)}i((l=l.apply(a,s||[])).next())}));var a,s,o,l}function rd(t,r,n,i){return a=this,s=void 0,l=function*(){return td((r=>e.createElement(nd,Object.assign({},r,{items:t,unplayable:i}))),r,n)},new((o=void 0)||(o=Promise))((function(e,t){function r(e){try{i(l.next(e))}catch(e){t(e)}}function n(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):function(e){return e instanceof o?e:new o((function(t){t(e)}))}(t.value).then(r,n)}i((l=l.apply(a,s||[])).next())}));var a,s,o,l}function nd(t){var{items:r,unplayable:n}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["items","unplayable"]);const a=1===r.length,s=!n&&r.every((e=>e.itemType===Ie.Media||e.itemType===Ie.Album));return e.createElement(Zh,Object.assign({},i,{className:"actions"}),e.createElement("ul",{className:"actions-menu-items"},s?e.createElement(e.Fragment,null,e.createElement(ed,{label:"Queue",action:"queue",acceleratorKey:"Enter",key:"queue"}),e.createElement(ed,{label:"Play next",action:"play-next",acceleratorKey:"Shift+Enter",key:"play-next"}),e.createElement(ed,{label:"Play now",action:"play",acceleratorKey:"Ctrl+Enter",key:"play"})):null,a?e.createElement(ed,{label:"Info...",action:"info",acceleratorKey:"Ctrl+I",key:"info"}):null))}var id=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};const ad={view:"card compact",fields:["Thumbnail","Title","Artist","Year"]};function sd(t){var{className:r="",layout:n=ad,unplayable:i}=t,a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["className","layout","unplayable"]);const s=sh(Un.observeCurrentIndex,-1),o=(0,e.useCallback)((([e],t,r)=>id(this,void 0,void 0,(function*(){switch(yield rd([e],t,r,i)){case"play":Sc.autoplay=!0,yield Un.insertAt(e,s+1),Sc.next();break;case"play-next":yield Un.insertAt(e,s+1);break;case"queue":Un.add(e);break;case"info":yh(e)}}))),[s,i]),l=(0,e.useCallback)((e=>{i||Un.add(e)}),[i]),c=(0,e.useCallback)((([e],t,r)=>id(this,void 0,void 0,(function*(){i||(t||r?t&&!r?(Sc.autoplay=!0,yield Un.insertAt(e,s+1),Sc.next()):r&&!t&&(yield Un.insertAt(e,s+1)):Un.add(e))}))),[s,i]),u=(0,e.useCallback)((([e])=>{e&&yh(e)}),[]);return e.createElement(Jh,Object.assign({},a,{className:`albums ${r}`,layout:n,draggable:!i,unplayable:i,onContextMenu:o,onDoubleClick:l,onEnter:c,onInfo:u}))}function od(){return sh(Mn,null)}var ld=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))};const cd={view:"details",fields:["Artist","Title","Album","Track","Duration","Genre","PlayCount"]};function ud(t){var{className:r="",layout:n=cd,unplayable:i}=t,a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["className","layout","unplayable"]);const s=od(),o=sh(Un.observeCurrentIndex,-1),l=(0,e.useCallback)((e=>{const[t]=e.src.split(":");return`source-${t} ${e.src===(null==s?void 0:s.src)?"playing":""} ${e.unplayable?"unplayable":""}`}),[s]),c=(0,e.useCallback)(((e,t,r)=>ld(this,void 0,void 0,(function*(){switch(yield rd(e,t,r,i)){case"play":Sc.autoplay=!0,yield Un.insertAt(e,o+1),Sc.next();break;case"play-next":yield Un.insertAt(e,o+1);break;case"queue":Un.add(e);break;case"info":yh(e[0])}}))),[o,i]),u=(0,e.useCallback)((e=>{i||Un.add(e)}),[i]),h=(0,e.useCallback)(((e,t,r)=>ld(this,void 0,void 0,(function*(){i||(t||r?t&&!r?(Sc.autoplay=!0,yield Un.insertAt(e,o+1),Sc.next()):r&&!t&&(yield Un.insertAt(e,o+1)):Un.add(e))}))),[o,i]),d=(0,e.useCallback)((([e])=>{e&&yh(e)}),[]);return e.createElement(Jh,Object.assign({},a,{className:`media-items ${r}`,itemClassName:l,layout:n,multiSelect:!0,draggable:!i,unplayable:i,onContextMenu:c,onDoubleClick:u,onEnter:h,onInfo:d}))}const hd={view:"details",fields:["Index","Title","Artist","Duration"]};function dd(t){var{source:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source"]);const[i,a]=(0,e.useState)(null),s=(0,e.useCallback)((([e])=>{a(e||null)}),[]);return e.createElement("div",{className:"panel album-browser"},e.createElement(u,{id:"album-browser-layout",arrange:"rows",primaryIndex:1},e.createElement(sd,Object.assign({},n,{unplayable:r.unplayable,onSelect:s})),e.createElement(ud,{className:"album-items",pager:null==i?void 0:i.pager,keepAlive:!0,layout:r.secondaryLayout||hd,unplayable:r.unplayable})))}const fd={view:"card minimal",fields:["Thumbnail","Title"]};function md(t){var{className:r="",layout:n=fd}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["className","layout"]);const a=(0,e.useCallback)((([e],t,r)=>{return n=this,i=void 0,s=function*(){"info"===(yield rd([e],t,r))&&yh(e)},new((a=void 0)||(a=Promise))((function(e,t){function r(e){try{l(s.next(e))}catch(e){t(e)}}function o(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof a?e:new a((function(t){t(e)}))}(t.value).then(r,o)}l((s=s.apply(n,i||[])).next())}));var n,i,a,s}),[]),s=(0,e.useCallback)((([e])=>{e&&yh(e)}),[]);return e.createElement(Jh,Object.assign({},i,{className:`artists ${r}`,layout:n,onContextMenu:a,onInfo:s}))}const pd={view:"card compact",fields:["Thumbnail","Title","Year"]},gd={view:"details",fields:["Index","Title","Artist","Duration"]};function Ad(t){var{source:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source"]);const[i,a]=(0,e.useState)(null),[s,o]=(0,e.useState)(null),l=(0,e.useCallback)((([e])=>{a(e||null)}),[]),c=(0,e.useCallback)((([e])=>{o(e||null)}),[]);return e.createElement("div",{className:"panel artist-browser"},e.createElement(u,{id:"artist-browser-layout",arrange:"columns",primaryIndex:0},e.createElement(md,Object.assign({},n,{unplayable:r.unplayable,onSelect:l})),e.createElement(u,{id:"artist-album-browser-layout",arrange:"rows",primaryIndex:1},e.createElement(sd,{className:"artist-albums",pager:null==i?void 0:i.pager,keepAlive:!0,layout:r.secondaryLayout||pd,unplayable:r.unplayable,onSelect:c}),e.createElement(ud,{className:"album-items",pager:null==s?void 0:s.pager,keepAlive:!0,layout:r.tertiaryLayout||gd,unplayable:r.unplayable}))))}function bd(t){var{source:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source"]);return e.createElement("div",{className:"panel media-item-browser"},"return ",e.createElement(ud,Object.assign({},n,{unplayable:r.unplayable})),";")}function vd({sources:t,onSourceChange:r}){const n=(0,e.useId)(),i=(0,e.useCallback)((e=>{const n=Number(e.target.value),i=t[n];null==r||r(i)}),[t,r]);return e.createElement("form",{className:"media-source-selector"},e.createElement("ul",{className:"media-sources"},t.map(((t,r)=>e.createElement("li",{className:"media-source",key:t.id},e.createElement(Ur,{id:`${n}-${t.id}`,type:"radio",name:"search-type",value:r,defaultChecked:0===r,onChange:i}),e.createElement("label",{htmlFor:`${n}-${t.id}`},t.title))))))}const yd={view:"card compact",fields:["Thumbnail","Title","TrackCount","Owner"]};function wd(t){var{className:r="",layout:n=yd,unplayable:i}=t,a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["className","layout","unplayable"]);const s=(0,e.useCallback)((([e],t,r)=>{return n=this,a=void 0,o=function*(){"info"===(yield rd([e],t,r,i))&&yh(e)},new((s=void 0)||(s=Promise))((function(e,t){function r(e){try{l(o.next(e))}catch(e){t(e)}}function i(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof s?e:new s((function(t){t(e)}))}(t.value).then(r,i)}l((o=o.apply(n,a||[])).next())}));var n,a,s,o}),[i]),o=(0,e.useCallback)((([e])=>{e&&yh(e)}),[]);return e.createElement(Jh,Object.assign({},a,{className:`playlists ${r}`,layout:n,unplayable:i,onContextMenu:s,onInfo:o}))}const Ed={view:"details",fields:["Index","Artist","Title","Album","Duration","Genre","PlayCount"]};function _d(t){var{source:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["source"]);const[i,a]=(0,e.useState)(null),s=(0,e.useCallback)((([e])=>{a(e||null)}),[]);return e.createElement("div",{className:"panel playlist-browser"},e.createElement(u,{id:"playlist-browser-layout",arrange:"rows",primaryIndex:1},e.createElement(wd,Object.assign({},n,{unplayable:r.unplayable,onSelect:s})),e.createElement(ud,{className:"playlist-items",pager:null==i?void 0:i.pager,keepAlive:!0,layout:r.secondaryLayout||Ed,unplayable:r.unplayable})))}function Td({service:t,sources:r}){const n=sh(t.observeIsLoggedIn,!1),i=String(r.map((e=>e.id)));return e.createElement("div",{className:`media-browser ${t.id}-browser`,key:i},n?0===t.sources.length?null:e.createElement(xd,{service:t,sources:r}):e.createElement(ih,{service:t}))}function xd({sources:t}){const[r,n]=(0,e.useState)((()=>t[0])),[i,a]=(0,e.useState)(""),s=function(t,r=""){const[n,i]=oh(),[a,s]=(0,e.useState)(null);return(0,e.useEffect)((()=>{if(t){const e=n.pipe(it((e=>t.search(e)))).subscribe(s);return()=>e.unsubscribe()}s(null)}),[t,n]),(0,e.useEffect)((()=>i(r)),[r,t,i]),a}(r,i),o=!!r.searchable;return e.createElement(e.Fragment,null,o&&e.createElement(ah,{onSubmit:a}),t.length>1?e.createElement(vd,{sources:t,onSourceChange:n}):null,e.createElement(Sd,{source:r,pager:s,layout:r.layout,loadingText:i?"Searching":void 0}))}function Sd(t){switch(t.source.itemType){case Ie.Artist:return e.createElement(Ad,Object.assign({},t));case Ie.Album:return e.createElement(dd,Object.assign({},t));case Ie.Playlist:return e.createElement(_d,Object.assign({},t));default:return e.createElement(bd,Object.assign({},t))}}function kd({icon:t,text:r,showConnectivity:n}){return e.createElement("span",{className:"media-source-label"},e.createElement(Dr,{name:t,className:n?"show-connectivity":""}),e.createElement("span",{className:"text"},r))}function Id({onSelect:t}){const r=function(){const t=sh(Ru,(0,e.useMemo)(Bu,[]));return(0,e.useMemo)((()=>ku.filter((e=>t.includes(e.id))).map((r=>({id:r.id,label:e.createElement(kd,{icon:r.icon,text:r.title,showConnectivity:!0}),value:e.createElement(Td,{sources:r.searches,service:r}),startExpanded:!0,children:r.sources.filter((e=>t.includes(e.id))).map((t=>({id:t.id,label:e.createElement(kd,{icon:t.icon,text:t.title}),value:e.createElement(Td,{sources:[t],service:r})})))})))),[t])}();return e.createElement("div",{className:"panel media-sources"},e.createElement(Zu,{roots:r,onSelect:t,storeId:Cu.id}))}function Cd({label:t,items:r,className:n=""}){const i=(0,e.useId)(),[a,s]=(0,e.useState)(0),o=r.length,l=(0,e.useCallback)((e=>{switch(e.key){case"left":e.preventDefault(),a>0&&(s(a-1),e.stopPropagation());break;case"right":e.preventDefault(),a<o-1&&(s(a+1),e.stopPropagation())}}),[a,o]);return e.createElement("div",{className:`tab-list ${n}`},e.createElement("ul",{className:"tab-list-tabs",role:"tablist","aria-label":t,onKeyDown:l},r.map(((t,r)=>e.createElement("li",{role:"presentation",key:r},e.createElement(Pd,{id:i,item:t,index:r,selected:r===a,onSelect:s}))))),e.createElement("div",{className:"tab-list-panels"},r.map(((t,r)=>e.createElement(Md,{id:i,item:t,index:r,hidden:r!==a,key:r})))))}function Pd({id:t,item:r,index:n,selected:i,onSelect:a}){const s=(0,e.useCallback)((()=>a(n)),[n,a]);return e.createElement(Lr,{className:"tab",id:`${t}-tab-${n}`,tabIndex:i?0:-1,role:"tab","aria-selected":i,"aria-controls":`${t}-panel-${n}`,onFocus:s},r.tab)}function Md({id:t,item:r,index:n,hidden:i}){return e.createElement("div",{className:"tab-panel",id:`${t}-panel-${n}`,tabIndex:0,hidden:i,role:"tabpanel","aria-labelledby":`${t}-tab-${n}`},r.panel)}console.log("component::MediaSources");function Rd(t){var{colorName:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["colorName"]);const i=(0,e.useCallback)((e=>{Ml[r]=e.target.value}),[r]);return e.createElement(Ur,Object.assign({},n,{type:"color",onChange:i}))}const Bd=[{tab:"Theme",panel:e.createElement((function(){const t=(0,e.useMemo)((()=>Ml.fontSize),[]),r=sh((()=>Ml.observe()),Il);(0,e.useLayoutEffect)((()=>(document.getElementById("system").style.setProperty("--font-size",String(Ml.fontSize)),()=>Ml.restore())),[]);const n=(0,e.useCallback)((()=>Ml.save()),[]),i=(0,e.useCallback)((e=>{Ml.load(e.target.value)}),[]),a=(0,e.useCallback)((e=>{Ml.spacing=e.target.valueAsNumber}),[]),s=(0,e.useCallback)((e=>{Ml.fontSize=e.target.valueAsNumber}),[]),o=(0,e.useCallback)((e=>{Ml.roundness=e.target.valueAsNumber}),[]),l=(0,e.useCallback)((e=>{Ml.flat=e.target.checked}),[]);return e.createElement("form",{className:"theme-settings",method:"dialog",onSubmit:n},e.createElement("fieldset",null,e.createElement("legend",null,e.createElement("label",{htmlFor:"theme-name"},"Name:"),e.createElement("select",{id:"theme-name",onChange:i,value:Ml.name},Cl.map((({name:t})=>e.createElement("option",{value:t,key:t},t||"(none)"))))),e.createElement("div",{className:"table-layout"},e.createElement("p",null,e.createElement("label",{htmlFor:"theme-fontFamily"},"Font:"),e.createElement("select",{id:"theme-fontFamily"},e.createElement("option",null,"Arial, sans-serif"))),e.createElement("p",null,e.createElement("label",null,"Frame:"),e.createElement(Rd,{id:"frameColor",colorName:"frameColor",value:r.frameColor,title:"Frame background"}),e.createElement(Rd,{colorName:"frameTextColor",value:r.frameTextColor,title:"Frame text"})),e.createElement("p",null,e.createElement("label",null,"Content:"),e.createElement(Rd,{colorName:"backgroundColor",value:r.backgroundColor,title:"Content background"}),e.createElement(Rd,{colorName:"textColor",value:r.textColor,title:"Content text"})),e.createElement("p",null,e.createElement("label",{htmlFor:"theme-spacing"},"Spacing:"),e.createElement(Ur,{type:"range",id:"theme-spacing",min:0,max:1,step:.03125,value:r.spacing,onChange:a})),e.createElement("p",null,e.createElement("label",{htmlFor:"theme-roundness"},"Roundness:"),e.createElement(Ur,{type:"range",id:"theme-roundness",min:0,max:1,step:.03125,value:r.roundness,onChange:o})),e.createElement("p",null,e.createElement("label",{htmlFor:"theme-flat"},"Flat:"),e.createElement(Ur,{type:"checkbox",id:"theme-flat",checked:r.flat,onChange:l}))),e.createElement("p",{className:"dialog-buttons"},e.createElement(Lr,{className:"small",type:"button",disabled:!0},"Save…"))),e.createElement("p",null,e.createElement("label",{htmlFor:"theme-fontSize"},"Font Size:"),e.createElement(Ur,{type:"range",id:"theme-fontSize",min:10,max:32,step:1,defaultValue:t,onChange:s,key:t})),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel"},"Cancel"),e.createElement(Lr,null,"Confirm")))}),null)}],Ld=[{tab:"General",panel:e.createElement((function(){const t=(0,e.useMemo)((()=>vn()),[]),r=sh(bn,t),n=(0,e.useRef)(null),i=(0,e.useRef)(null),a=(0,e.useRef)(null),s=(0,e.useRef)(null),o=(0,e.useCallback)((()=>{yn(t)}),[t]),l=(0,e.useCallback)((()=>{yn({allowDuplicates:n.current.checked,showLineNumbers:i.current.checked,zeroPadLineNumbers:a.current.checked,showSourceIcons:s.current.checked})}),[]);return e.createElement("form",{className:"playlist-general-settings",method:"dialog"},e.createElement("fieldset",null,e.createElement("legend",null,"Content"),e.createElement("p",null,e.createElement(Ur,{id:"playlist-allow-duplicates",type:"checkbox",checked:r.allowDuplicates,onChange:l,ref:n}),e.createElement("label",{htmlFor:"playlist-allow-duplicates"},"Allow duplicates"))),e.createElement("fieldset",null,e.createElement("legend",null,"Display"),e.createElement("p",null,e.createElement(Ur,{id:"playlist-item-numbers",type:"checkbox",checked:r.showLineNumbers,onChange:l,ref:i}),e.createElement("label",{htmlFor:"playlist-item-numbers"},"Show playlist line numbers")),e.createElement("p",null,e.createElement(Ur,{id:"playlist-zero-pad",type:"checkbox",checked:r.zeroPadLineNumbers,disabled:!r.showLineNumbers,onChange:l,ref:a}),e.createElement("label",{htmlFor:"playlist-zero-pad"},"Zero pad line numbers")),e.createElement("p",null,e.createElement(Ur,{id:"playlist-source-icons",type:"checkbox",checked:r.showSourceIcons,onChange:l,ref:s}),e.createElement("label",{htmlFor:"playlist-source-icons"},"Show media source icons"))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel",onClick:o},"Cancel"),e.createElement(Lr,null,"Confirm")))}),null)}];function Dd(e,t){return function(r,n){return!e.call(t,r,n)}}function Nd(e,t,r){return[Ft(t,r)(qe(e)),Ft(Dd(t,r))(qe(e))]}const Fd="\nmo2re_RX3Bs blXien2Jh_o etiatMRgFcM DYsMJiwiZSI _MZ7UZ5frCI 33XT9PQUfVU HCx1Z92PjJE dIP7wWY4Znw\nA1m0SEqmmbE 9uZ8CCa0t4Y MXlFDpaQ1ec wz_ItcoR0-c jS4-FmNEDKo Tz77vqH_LJw K73lfmxDVR0 W8ayfyRWUrg\ncbuldALGsaQ AJZon2grzmA H5ASEM9dMiA GE2YEq7vaLc MYGOdJNAzrI Oszl95YWfbs b0-IkxXyhmY\nAgpGXSAS7Cs p-OUNPqRzII XaTxLSPh_Is 1n3ezT1cvAM CWU1pZVw0xM ry1Q7KaQdxM VlC5LSTvoj0\ng5yQtQc3K-0 f6OZ01vvmko o4jE24WixcI BIej9P2LrzM dxw91a7C5BQ jmh_usvhHLw VVkZKzTbWQs vXCB1zGGFiY\nJHARFKMl8dU KSB1AZ0-I74 IGqfU6cJJc8 8zg22-ZCUfE WMlR8eJRS3I V0ggp2sJqA0 A5pbF_YBulo dRFRsKobN9I\ntlN0LoTv3c0 IlDvBTDGanI Az3UNGBKRX8 mOmwk3WyYnw im2eWwIiTOc lxQS58t39_U yk076o8NF3k oggiHfuV4m8\np_GnUkm-G1M xVMsAgHy_IY VdZkfef44JI ZxOd8tmdsIM fszuqfJWKxc 0LGL_lx9XcA i_hU5eUrVIs\nuZjCNtOeZG4 ZpXnEvW0XD0 -C8TYbhnVTU WzxSiEWK3cg ZE8vuq4aqNA 7HMw3bcIgRE ZJiCEDweLl8 lyh2kAjcmSY\nvFwqZ4qAUkE QLbPYQcUcgM xwf7EssFnXU FvNFuSTDPuk vvm8b2jAfv0 XkRFSnxXQ_w Ee0Qh_nIoHw 78rppSvbh7A\nNXIaYDJql1c e5eg-tOusSo ZkRjihsMdp8 e1M6jHcRrlM z9Ug-3qhrwY mA30W2dHQIo XIhEPwTMjWk -Tm4H4CrKT0\nT6tapzmF_n0 7QetsPh7BPM xBDqge4w-XA suWbFuw1O_I yCUQ8n2OxjI ZX8fSO8uTPg xX9xfFT-Qw0 0G9a9o3wOIQ\n-WIamcIaipI Zjc6DwVDvq0 eHjoav_sb88 7E0WVROBsEE BvLIJSmzAnY YPurG3WT8xI\naC7s2UVXt3c EJArkl7K29k 9eFVeErnUzg 7eyYe-MN1Nc B1-yyoNMUzs Ab5I38wGxko sVuqgnXD9AE\nY0U0HAwpw2s Shf_P0PLhNA Nde5P8Ob2xg f-Xul0mdBCA ExStG9rRkoY tMzCwwvHwN0\nQ6YbP3m-KvA eYpCCSAW3aw XfBNIrQ5JKQ -b68N6Q4Qus H3mdjo7kYiQ 9CJLtzzUphU yy-aMo2ds2k\nLtPGmDskDiY U9rtWGI6H5A NHa506wwN0Y PLSxe5Z8Asw ubQKAfwSLDA aFsNz5VMyC8 h6yhFP_qUro\nPEgQ0dIOB5c KWz3SXWnFys MGRDy2PqCGk 4DcMcAHrURw ETwbuC3p1ls iszl1WqjQIk njcvxMb8TVQ sTS5tBOS4GM\nhNNN5xPyyeY 8ls8xBn70gM 2XREaQqoU1U MXL2qjIL4qI 9YqbQcfIre0 JVI9BvU8-Oo\nPaIH77c53LA FSlhSL8bFoI XLuV3_a-ro0 mo7mUJZV6DM IqWPDr8KCmQ v-QS_Kh_i6o RvZFYE5jo1M Xn8tufsbSz0\n7gG4l70v8mw thurNCHVo08 YgryBZTMVZY XAmU3yQc90M KBUg3U3MRao v_My9t4gadA Xwb1xsWClCM KlH1g1x6RJk\nyYP2A8TkSQ0 LMSmWzCqlPE oN3glsVrnRY PPBV3hem5iM 1JbI8Ml25WQ nSJ67PGjQfQ EoBF2xRsbAc KDUYy3xwCFs\nRZOcoZS_52Q pSP9_otXcTU H36qe8NatNQ qgfd-uWTVwg Blu_yCEFYvk HeYMIBFtwh4 fb0QX7DbqLg kdqyAA0ILD4\nriZWEoGKyuU 4qo9bKRxgYA t0j_GdkG1BM hLq9J32lGRs zfc53CpvlZ4 IjNKQbm4AQ8 Ms0uDHae8FY tG991Undnbc\nsh8l2-cCAGQ XDE5pd4V_xc C2BVXFIX7bY ySPxZpoqXZ8 hiEUaLX4cCM wHxEyBMi1A4 YJSw3ougt9Y 2hUJBRUtrPU\nWsCCYv2adkM kD5x3_b1J0o 9Rvtm2zGEl4 DGlAMkUjcY0 h2s_WOkfTXk 0VhxPdtX0xg 6vuFh6NNa70 ukOHqdPbYYg\nH6OmEQ8RqVk qPp315pPVSI FQqj6gN7M6M Xrwks9O2-JQ ipRwt3TDgY4 aVqRyfRviwA X33dmu12C5c QEwzFKoG7tk\nh98nR30UD8Q Z7WpAwRjprI ilqlSBYfCGs V6SoeDWDon0 d-Hwz42Vfw4 hcmxvqJDpDw 22dlye7h3qU\nblSZ365wpfQ ADF4KgfhzPs jSRvD7Uma1g uLMC6bL_q38 k9DuPxFQ7HQ 7f2taFPyqxc YVYDz_coSfY\nOad8nSzotHw YiezM4raRrY H3GL5jO53NU acTsYqhq-AA vp2yiZnjK0w eR5vsN1Lq4E D_l0pBDHFgs HFnt39uG5W0\n7qXiAaxxGBs m6m6bqHiT6U l5jUOT0XiUM NLxwmtJSvk4 dv_QzcJGHAE kaPD4n9uQ2k r7HpeG2ofU0 O1AQcFpPs04\n44ih4WRTyGg W5BmjLsEsB0 JkNlFaei_k8 2ttB1FzBpZ4 k3Q1vse7In8 7xltSb3VBJQ ojbiGfhnjTU _Qb7TJ-T1HM\ngvT3gIDSwq8 4X95pykbYTY BPDznHIgVMA OIA5xQWkk2U 2uQ58Xwx1V4 UVjCFpYMR6A -uww0BzTb7g EqWBy5i8LyQ\nszErNcJMCdA 5k1DGpr_qDw YNEkjkh0bYo jmjrpHYegzc Eye8xYrjm24 rVLOQB5kGGw F8MN0o6RS9o viim_l9gbF8\nsBtYWK817-0 cFRcqnCpqoo y7vz1qQGUd8 -0ewPjoBBNI S1emxk9UWBE 1muEwEFDKgk nnDBkUfVU1Y MPEvXbw3hYA\nwwXpkTd1CaQ W2A_PcIhUVM ZIb8u6uJwBo TWjid2dVjMk gdJjc6l6iII n3Dru5y3ROc OOf4Z7tyLVM iDXDrTKJehk\nwYhliE9O_3k nw0uvJZonBc cK7x6lUUsYo XPjkpBDEs2U e2AUzM6QgGs 3cxyYOXiJss AsD5u6k6dKI d_hx39kXDUg\nhlvfDL3nSoo 6L2xYzu724E OhBo1A8atuA V-ntXk-4TPo yttvb9ByOtY ctqujFKaFZQ NWF3dNJ-EhQ WUkwH9WmmBA\nef1wAfrMg5I eN-RZVkFGj0 dc8LEG9jDFM 0-skl5qAC9Q u1rRUwx_Vy4 iTjgWeJMUJo WL9EOfzoSsA xrCNwCD-z-M\nCC3AanQdQZA ZGLrP5eawdY HoOghpRTkvs N787WRdI35A Cw0d-nqSNE8 2vifO3_gjiM OeJ5xXrbkfU\njP4gBqxfheI gIJxDy25nwM oN8q7p57nZw 6vnxzfejWN4 gVamQ6jodK0 iU5QjAbuhec qLIU_90P4Ac z8k_ximc8Og\nZFBoN7yIMZw 4mexI7cACZk bx-0YlFprqc NDWpXTg3koc Vo2AcHSCRiQ 2ve6LNoU6Qk WXI7byeZk5s y8d7Ihe0IwE\nubmUJcwor3k CGslieDL-04 w7ljU-lmaK4 I0B21LjeSUQ PyFN_FYwqvc vlyVzeLzNe8 ahmrb5EYoxY HGxuVWpN8vQ\nDNR1zyr5Go4 eyPhudLTuis aPWXL4ahxdY JB0A8Me8EKk dGy_6qyyY7c rxrDLgt5YFA uhcocK-td5E 4Z5FLeh7P18\nVB0zDS9ITmk VukLV0AoeFA CouF-tNHV3g lTvYjERVAnY S27YOjpgaaE 24uCC_-zaaE DslTxXsDLsw xilGAQPx5Xw\nzlHISDs2HtQ tdi8B0YzxHg R1OHRQoJOP0 fbqmVbEj9fg asL1AN3hifU rUkLoqxFOTw 3ma3yXXc3V8 1U1We59en3s\niNm7PPqO6rM CLRk8SgtVS4 VYO8Biwffns -imG6CNF9kI ZMOC332wC7A doORhRob3Qg E2sSvVCRI4s nPQ4BpTfK1Q\nE6Ww7lpuZ2k Ueqm3PQKYPk eFiKAcbp2MY dAfMgDBeqwU Wuq5NHJPXyQ LAFK1EvwulU rU07g1g-PIY L_mlofcsRaA\neZe4Q_58UTU NXObT_Fl-xI t6jlhqNxRYk _WkkH31sTMI ALJcKvnOjHM 85Y1N8avsXs NCY42RnUpCE 2QSukL7dl5o\n0Tpq2mLtXDc Zp1Oajc7VQw WGi4XiEGe8M b6L40CEYVyM Mw9qiV7XlFs UgHKb_7884o mvIYmMo906E 2RakvEQhTTA\nRyOu7hdbqg0 k9rKpHXwA1E MTG3VA-m6qk cU3XY6Ii8v0 Flbhk1KHHJw k5sznEJz8BA R8W3U0Mu6t4\n6KBo0GhU9XM d5R3FK9vLBs N5b7Iy4W0ow VogwWGEO1-c YKRe7n3jQ_M A-mPDdnzipI 6gqU-HL68wE\nVIlQIVVLWVs 6A-kQCdEIpI _lisL6tLbdg VarS6olPfTA va306f9aN3A zzscMK0ZtjE KpFU_kIw6To\nbHK0ZvQzfOY PkF4EKJQOOg 0aMUCiKjBDI D1KsEOUqCEU _SFTmh-b-Z4 omlVslJvzxQ FoS3732REf0\nqqC80mXlOKo MS2asGj1-_M BizH494DmJI IahW6hJ1-SM 9MIJm1NeUpE 2qzbMPpgtDw H3UY2gQfj-s 9kekiNImlsI\n5zUCClmhjF0 76Atd-tAkmg e18IjYKZnTA MAFdQs_yWvg xkAUTCdoteI X0IEHj4PhCc JX19TZp8gDQ 7TML_MTQdg4\nSH4f_DnPIto\n".match(/\S+/g).map((e=>`youtube:video:${e}`));var Od=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};console.log("module::visualizer");const zd=new ne("visualizer"),Ud=aa.map((e=>e.name)),jd=new r("visualizer"),Vd={provider:"none",preset:""},qd=new te(Vd),Qd=new te({}),Xd=new Z,Wd=ic().pipe(Ft((e=>null==e))),Hd=ic().pipe(Ft(Ae)),[Gd,$d]=Nd(Hd,(e=>e.mediaType===yt.Audio)),[Yd,Kd]=Nd(lc(),Boolean),Jd=[...Array(83).fill("milkdrop"),...Array(10).fill("video"),...Array(5).fill("audiomotion"),...Array(1).fill("ampshade"),...Array(1).fill("waveform")];function Zd(){return qd}function ef(){return rf().pipe(it((e=>!!e.locked)))}function tf(){return rf().pipe(it((e=>e.provider||"")),rt())}function rf(){return Qd}function nf(){Xd.next(void 0)}function af(){of(!0)}function sf(){of(!1)}function of(e){const t=Qd.getValue(),{locked:r}=t,n=Od(t,["locked"]);if(!!r!==e){const t=qd.getValue(),r=e?Object.assign(Object.assign({},n),{locked:t}):n;jd.setItem("settings",JSON.stringify(r)),Qd.next(r)}}(()=>{try{const e=jd.getItem("settings")||"{}";Qd.next(JSON.parse(e))}catch(e){zd.error(e)}})(),Wd.subscribe((()=>Ul.stop())),Gd.subscribe((()=>Ul.hidden=!1)),$d.subscribe((()=>{Ul.pause(),Ul.hidden=!0})),Yd.subscribe((()=>Ul.pause())),ii(Gd,Xd,tf(),Ul.observeError()).pipe(Zr(Gd,rf()),it((([,e,t])=>function(e,t){const r=t.locked;if(r)return"milkdrop"!==r.provider||da.find(r.preset)?r:Vd;let n=t.provider,i="";e.src.startsWith("spotify:")?"video"!==n&&(n="spotify-viz"):"spotify-viz"===n&&(n="milkdrop"),n||(n=Se(Jd));const a=qd.getValue().preset;switch(n){case"audiomotion":i=Se(Ud,a);break;case"milkdrop":if(i=Se(da.getNames(),a),!i)return Vd;break;case"video":i=Se(Fd,a)}return{provider:n,preset:i}}(e,t))),rt()).subscribe(qd),Zd().pipe(Rt((e=>Ul.load(e)))).subscribe(zd),Gd.pipe(Ot((()=>Kd))).subscribe((()=>Ul.play())),zd.log("Ambient videos:",Fd.length),zd.log("AudioMotion presets:",aa.length),da.observe().pipe(Zr(Zd()),Rt((([,e])=>{e===Vd&&nf(),zd.log("Butterchurn presets:",da.size)})),Nt(3)).subscribe(zd);const lf=[{tab:"General",panel:e.createElement((function(){const t=(0,e.useRef)(null),r=sh(tf,""),n=(0,e.useCallback)((()=>{!function(e){const t=Qd.getValue(),{provider:r}=t,n=Od(t,["provider"]);if(e!==r){const t=e?Object.assign(Object.assign({},n),{provider:e}):n;jd.setItem("settings",JSON.stringify(t)),Qd.next(t)}}(t.current.value)}),[]);return e.createElement("form",{className:"visualizer-general-settings",method:"dialog",onSubmit:n},e.createElement("p",null,e.createElement("label",{htmlFor:"visualizer-provider"},"Provider:"),e.createElement("select",{id:"visualizer-provider",defaultValue:r,key:r,ref:t},e.createElement("option",{value:"none"},"(none)"),e.createElement("option",{value:""},"(random)"),e.createElement("option",{value:"video"},"Ambient Video"),e.createElement("option",{value:"audiomotion"},"AudioMotion"),e.createElement("option",{value:"milkdrop"},"Milkdrop"),e.createElement("option",{value:"spotify-viz"},"SpotifyViz"),e.createElement("option",{value:"waveform"},"Waveform"),e.createElement("option",{value:"ampshade"},"Ampshade"))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel"},"Cancel"),e.createElement(Lr,null,"Confirm")))}),null)}];function cf(){return e.createElement(Cd,{items:lf,label:"Visualizers"})}function uf(t){return e.createElement(Fr,Object.assign({},t,{className:"visualizer-settings-dialog",title:"Visualizer Settings"}),e.createElement(cf,null))}function hf(){const t=(0,e.useId)(),r=(0,e.useRef)(null),n=(0,e.useMemo)((()=>Fu.getServices()),[]),i=(0,e.useCallback)((()=>{const e=[],t=r.current.elements;for(const r of t)r.checked&&e.push(r.value);Fu.setServices(e)}),[]);return e.createElement("form",{className:"media-library-general-settings",method:"dialog",onSubmit:i},e.createElement("fieldset",{ref:r},e.createElement("legend",null,"Display"),e.createElement("ul",null,ku.map((r=>e.createElement("li",{key:r.id},e.createElement(Ur,{id:`${t}-${r.id}`,type:"checkbox",value:r.id,defaultChecked:n.includes(r.id),disabled:"local"===r.id}),e.createElement("label",{htmlFor:`${t}-${r.id}`},r.title)))))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel"},"Cancel"),e.createElement(Lr,null,"Confirm")))}function df({service:t}){const r=(0,e.useMemo)((()=>[{tab:"General",panel:e.createElement(ff,{service:t})}]),[t]);return e.createElement(Cd,{items:r,label:t.title})}function ff({service:t}){const r=(0,e.useId)(),n=(0,e.useRef)(null),i=sh(t.observeIsLoggedIn,!1),a=(0,e.useMemo)((()=>Fu.getSources(t.id)),[t]),s=(0,e.useCallback)((()=>{const e=[],r=n.current.elements;for(const t of r)t.checked&&e.push(t.value);Fu.setSources(t.id,e)}),[t]);return e.createElement("form",{className:`media-library-settings ${t.id}-settings`,method:"dialog",onSubmit:s},e.createElement("p",null,e.createElement(Lr,{className:"disconnect",onClick:t.logout,disabled:!i},i?"Disconnect...":"Not connected")),e.createElement("fieldset",{ref:n},e.createElement("legend",null,"Display"),e.createElement("ul",null,t.sources.map((t=>e.createElement("li",{key:t.id},e.createElement(Ur,{id:`${r}-${t.id}`,type:"checkbox",value:t.id,defaultChecked:a.includes(t.id)}),e.createElement("label",{htmlFor:`${r}-${t.id}`},t.title)))))),e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,{value:"#cancel"},"Cancel"),e.createElement(Lr,null,"Confirm")))}const mf=[{id:"services",label:"Media Services",value:e.createElement((function(){const t=(0,e.useMemo)((()=>[{tab:"General",panel:e.createElement(hf,null)}]),[]);return e.createElement(Cd,{items:t,label:"Media Services"})}),null),startExpanded:!0,children:[{id:"apple",label:e.createElement(kd,{icon:"apple",text:"Apple Music"}),value:e.createElement((function(){return e.createElement(df,{service:nr})}),null)},{id:"spotify",label:e.createElement(kd,{icon:"spotify",text:"Spotify"}),value:e.createElement((function(){return e.createElement(df,{service:xo})}),null)},{id:"youtube",label:e.createElement(kd,{icon:"youtube",text:"YouTube"}),value:e.createElement((function(){return e.createElement(df,{service:Pi})}),null)},{id:"plex",label:e.createElement(kd,{icon:"plex",text:"Plex"}),value:e.createElement((function(){return e.createElement(df,{service:Su})}),null)},{id:"jellyfin",label:e.createElement(kd,{icon:"jellyfin",text:"Jellyfin"}),value:e.createElement((function(){return e.createElement(df,{service:Uc})}),null)},{id:"lastfm",label:e.createElement(kd,{icon:"lastfm",text:"last.fm"}),value:e.createElement((function(){return e.createElement(df,{service:lu})}),null)}]},{id:"visualizer",label:"Visualizer",value:e.createElement(cf,null)},{id:"playlist",label:"Playlist",value:e.createElement((function(){return e.createElement(Cd,{items:Ld,label:"Playlist Settings"})}),null)},{id:"playback",label:"Playback",value:e.createElement("div",null)},{id:"appearance",label:"Appearance",value:e.createElement((function(){return e.createElement(Cd,{items:Bd,label:"Appearance"})}),null)}];function pf(){return mf}function gf(t){const r=pf(),[n,i]=(0,e.useState)(e.createElement("div",null));return e.createElement(Fr,Object.assign({},t,{className:"settings-dialog",title:"Settings"}),e.createElement(Zu,{className:"settings-dialog-sources",roots:r,storeId:"settings-dialog-sources",onSelect:i}),e.createElement("div",{className:"settings-dialog-source"},n))}function Af(t){var{icon:r,className:n=""}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["icon","className"]);return e.createElement(Lr,Object.assign({},i,{className:`icon-button icon-button-${r} ${n}`,onMouseDown:_e,onDoubleClick:Te}),e.createElement(Dr,{name:r}))}function bf(){const[t,r]=(0,e.useState)(null),[n,i]=Or(gf);return e.createElement("div",{className:"media-library"},e.createElement("header",{className:"media-library-head"},e.createElement("h1",null,"Ampcast ",e.createElement("span",{className:"version"},"0.4.11")),e.createElement(Af,{icon:"settings",className:"in-frame",title:"Settings",onClick:i}),n),e.createElement("div",{className:"media-library-body"},e.createElement(u,{id:"media-library-layout",arrange:"columns",primaryIndex:1},e.createElement(Id,{onSelect:r}),t)))}function vf(){return sh(Zd,null)}function yf({className:t="",children:r}){return e.createElement("div",{className:`icon-buttons ${t}`},r)}function wf(t){const[r,n]=(0,e.useState)(null);return(0,e.useEffect)((()=>{null==r&&null!=t&&n(t)}),[r,t]),r}function Ef({visualizer:t}){return e.createElement("article",{className:"visualizer-info"},e.createElement(_f,{visualizer:t}),e.createElement(Tf,{visualizer:t}))}function _f({visualizer:t}){return e.createElement("h3",null,"Visualizer: ",function(e){switch(null==e?void 0:e.provider){case"ampshade":return"Ampshade";case"audiomotion":return"AudioMotion";case"milkdrop":return"Milkdrop";case"video":return"Ambient Video";case"waveform":return"Waveform";default:return"none"}}(t))}function Tf({visualizer:t}){return"video"===(null==t?void 0:t.provider)&&t.preset.startsWith("youtube:")?e.createElement(xf,{visualizer:t}):(null==t?void 0:t.preset)?e.createElement("h4",null,"Name: ",t.preset):null}function xf({visualizer:t}){const r=function(t){const[r,,n]=t.split(":"),[i,a]=(0,e.useState)(null);return(0,e.useEffect)((()=>{if(a(null),n&&"youtube"===r){const e=Je(Ci(n)).subscribe(a);return()=>e.unsubscribe()}}),[r,n]),i}(t.preset);return r?e.createElement("div",{className:"youtube-video-info"},e.createElement("h4",null,"Title: ",r.title),e.createElement(ph,{owner:r.owner,src:r.src}),e.createElement(gh,{url:r.externalUrl,src:r.src})):null}function Sf(t){const r=od(),n=vf(),i=wf(r),a=wf(n);return e.createElement(Fr,Object.assign({},t,{className:"currently-playing-dialog",title:"Media Info"}),e.createElement("form",{method:"dialog"},i?e.createElement(lh,{item:i}):e.createElement("p",null,"The playlist is empty."),i&&i.mediaType!==yt.Video?e.createElement(Ef,{visualizer:a}):null,e.createElement("footer",{className:"dialog-buttons"},e.createElement(Lr,null,"Close"))))}function kf(){const t=sh(ef,!1),[r,n]=Or(Sf,"popup"),[i,a]=Or(uf),s=function(){const t=od(),r=vf(),[n,i]=(0,e.useState)("");return(0,e.useEffect)((()=>{(null==t?void 0:t.src.startsWith("youtube:"))?i("youtube"):(null==t?void 0:t.src.startsWith("apple:"))&&(null==t?void 0:t.mediaType)===yt.Video?i("apple"):(null==r?void 0:r.preset.startsWith("youtube:"))?i("youtube"):i("")}),[t,r]),n}();return e.createElement("div",{className:"visualizer-controls"},e.createElement(yf,{className:"visualizer-controls-settings"},e.createElement(Af,{className:"with-overlay",icon:"info",title:"Info",tabIndex:-1,onClick:n}),r,e.createElement(Af,{className:"with-overlay",icon:"settings",title:"Settings",tabIndex:-1,onClick:a}),i),e.createElement(yf,{className:"visualizer-controls-selector"},e.createElement(Af,{className:"with-overlay",icon:t?"locked":"unlocked",title:t?"Unlock":"Lock the current visualizer",tabIndex:-1,onClick:t?sf:af}),t?null:e.createElement(Af,{className:"with-overlay",icon:"right",title:"Next visualizer",tabIndex:-1,onClick:nf})),s?e.createElement(Dr,{className:"source-icon",name:s}):null)}function If(){const t=od(),[r,n]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{const e=setTimeout((()=>n(!1)),5e3);return n(!0),()=>clearTimeout(e)}),[t]),e.createElement("div",{className:"interstitial "+(r?"is-recent":"")},t?e.createElement(Cf,{item:t}):e.createElement("p",null,"The playlist is empty."))}function Cf({item:t}){return e.createElement("div",{className:"currently-playing"},e.createElement("h3",null,t.title),t.artist?e.createElement(e.Fragment,null,e.createElement("span",{className:"by"},"by"),e.createElement("h4",null,t.artist)):null)}function Pf(){const t=(0,e.useRef)(null),[r,n]=(0,e.useState)(!1),i=vf(),s=!i||"none"===i.provider;(0,e.useLayoutEffect)((()=>{Sc.appendTo(t.current)}),[]),(0,e.useLayoutEffect)((()=>{const e=Kr(document,"fullscreenchange").pipe(it((()=>document.fullscreenElement===t.current))).subscribe(n);return()=>e.unsubscribe()}),[]),a(t,(0,e.useCallback)((()=>{const e=t.current;Sc.resize(e.clientWidth,e.clientHeight)}),[]));const o=(0,e.useCallback)((()=>{r?document.exitFullscreen():t.current.requestFullscreen()}),[r]);return e.createElement("div",{className:"panel media "+(s?"no-visualizer":""),onDoubleClick:o,ref:t},e.createElement("div",{id:"players"}),e.createElement("div",{id:"visualizers"}),e.createElement(If,null),e.createElement(kf,null))}function Mf({icon:t,onClick:r}){return e.createElement(Lr,{className:`media-button media-button-${t}`,onClick:r},e.createElement(Dr,{name:t}))}function Rf(){const t=(0,e.useRef)(null),r=(0,e.useRef)(null),n=sh(ac,0),i=sh(sc,0),a=sh(lc,!0),[s,o]=(0,e.useState)((()=>Sc.muted)),[l,c]=(0,e.useState)((()=>Sc.volume)),u=l<=.33?"low":l<=.67?"medium":"high";(0,e.useEffect)((()=>{Sc.muted=s}),[s]),(0,e.useEffect)((()=>{Sc.volume=l}),[l]);const h=(0,e.useCallback)((()=>{Ac(t.current.valueAsNumber)}),[]),d=(0,e.useCallback)((()=>{const e=r.current.valueAsNumber;c(e),o(0===e)}),[]),f=(0,e.useCallback)((()=>{o((e=>!e))}),[]);return e.createElement("div",{className:`media-playback-bar volume-${u}`},e.createElement("p",{className:"media-playback-bar-current-time"},e.createElement(Gh,{time:n}),e.createElement(Ur,{id:"playhead",type:"range",min:0,max:i,step:1,value:n,disabled:a,onChange:h,ref:t})),e.createElement("div",{className:"media-playback-bar-controls"},e.createElement("p",{className:"media-playback-bar-volume"},e.createElement(Af,{icon:s?"muted":"volume",className:"in-frame",title:s?"unmute":"mute",onClick:f}),e.createElement(Ur,{type:"range",min:0,max:1,step:.01,value:s?0:l,onChange:d,ref:r})),e.createElement("p",{className:"media-playback-bar-buttons"},e.createElement(Mf,{icon:"prev",onClick:vc}),e.createElement(Mf,{icon:a?"play":"pause",onClick:a?pc:gc}),e.createElement(Mf,{icon:"stop",onClick:bc}),e.createElement(Mf,{icon:"next",onClick:yc})),e.createElement("p",{className:"media-playback-bar-more"},e.createElement(Lr,{className:"media-button media-button-shuffle",onClick:wc},"Shuffle"))))}console.log("component::MediaLibrary"),console.log("component::Media");function Bf(t){var{items:r}=t,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["items"]);const i=1===r.length;return e.createElement(Zh,Object.assign({},n,{className:"actions"}),e.createElement("ul",{className:"actions-menu-items"},e.createElement(ed,{label:"Select all",action:"select-all",acceleratorKey:"Ctrl+A",key:"select-all"}),i?e.createElement(ed,{label:"Play",action:"play",acceleratorKey:"Enter",key:"play"}):null,e.createElement(ed,{label:"Remove",action:"remove",acceleratorKey:"Del",key:"remove"}),i?e.createElement(ed,{label:"Info...",action:"info",acceleratorKey:"Ctrl+I",key:"info"}):null))}const Lf={view:"details",showTitles:!1,cols:[{title:"#",render:()=>null,align:"right",className:"track"},{title:"Source",render:function({src:t}){const[r]=t.split(":");return e.createElement(Dr,{name:r,className:"youtube"===r?"":"show-connectivity"})},align:"center",className:"source"},{title:"Title",render:function({title:t,artist:r}){return r?e.createElement(e.Fragment,null,e.createElement("span",{className:"artist-text"},r),e.createElement("span",{role:"separator"},"-"),e.createElement("span",{className:"title-text"},t)):e.createElement("span",{className:"title-text"},t)},className:"title"},{title:"Time",render:Yh,align:"right",className:"duration"}]};const Df=["audio/*","video/*"];function Nf(t){var{onSelect:r,onPlay:n}=t,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(t,["onSelect","onPlay"]);const a=(0,e.useRef)(null),s=sh(Un.observe,[]),o=function(t){const r=String(t).length,{zeroPadLineNumbers:n,showLineNumbers:i,showSourceIcons:a}=sh(bn,vn());return(0,e.useMemo)((()=>Object.assign(Object.assign({},Lf),{cols:Lf.cols.filter((e=>{switch(e.className){case"track":return i;case"source":return a;default:return!0}})).map((e=>"track"===e.className?Object.assign(Object.assign({},e),{render:(e,t)=>function(e,t=0){return String(e+1).padStart(t,"0")}(t,n?r:0)}):e))})),[n,i,a,r])}(s.length),l=od(),[c,u]=(0,e.useState)(0),h=(0,e.useCallback)((e=>{const[t]=e.src.split(":");return`source-${t} ${e.id===(null==l?void 0:l.id)?"playing":""} ${e.unplayable?"unplayable":""}`}),[l]),d=(0,e.useCallback)((e=>{u(e.length),null==r||r(e)}),[r]),f=(0,e.useCallback)((e=>{null==n||n(e)}),[n]),m=(0,e.useCallback)((e=>{1===e.length&&(null==n||n(e[0]))}),[n]),p=(0,e.useCallback)(((t,r,i)=>{return s=this,o=void 0,c=function*(){const s=yield function(t,r,n){return i=this,a=void 0,o=function*(){return td((r=>e.createElement(Bf,Object.assign({},r,{items:t}))),r,n)},new((s=void 0)||(s=Promise))((function(e,t){function r(e){try{l(o.next(e))}catch(e){t(e)}}function n(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof s?e:new s((function(t){t(e)}))}(t.value).then(r,n)}l((o=o.apply(i,a||[])).next())}));var i,a,s,o}(t,r,i);switch(s){case"play":null==n||n(t[0]);break;case"remove":Un.remove(t);break;case"info":yh(t[0]);break;case"select-all":a.current.selectAll()}},new((l=void 0)||(l=Promise))((function(e,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function n(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):function(e){return e instanceof l?e:new l((function(t){t(e)}))}(t.value).then(r,n)}i((c=c.apply(s,o||[])).next())}));var s,o,l,c}),[n]);return e.createElement("div",{className:"playlist"},e.createElement(Bh,Object.assign({},i,{className:"media-list playable",layout:o,items:s,itemKey:"id",itemClassName:h,droppable:!0,droppableTypes:Df,multiSelect:!0,reorderable:!0,onContextMenu:p,onDelete:Un.remove,onDoubleClick:f,onDrop:Un.insertAt,onEnter:m,onMove:Un.moveSelection,onSelect:d,listViewRef:a})),e.createElement(Hh,{items:s,size:s.length,selectedCount:c}))}function Ff(){return sh(lc,!0)}function Of(){const t=Ff(),r=(0,e.useCallback)((e=>{return t=this,r=void 0,i=function*(){Sc.autoplay=!0,yield Un.setCurrentItem(e),Sc.play()},new((n=void 0)||(n=Promise))((function(e,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(t){t.done?e(t.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(t.value).then(s,o)}l((i=i.apply(t,r||[])).next())}));var t,r,n,i}),[]);return e.createElement("div",{className:"media-playback "+(t?"paused":"")},e.createElement(u,{id:"media-playback-layout",arrange:"rows"},e.createElement("div",{className:"panel playback"},e.createElement(Rf,null),e.createElement(Nf,{onPlay:r})),e.createElement(Pf,null)))}console.log("component::MediaPlayback");const zf={apple:bt,jellyfin:Uc,lastfm:lu,plex:Su,spotify:xo,youtube:Pi};function Uf(e){const t=e.dataTransfer;t&&(e.preventDefault(),t.effectAllowed="none",t.dropEffect="none")}const jf=navigator.mediaSession;console.log("module::App"),(0,t.s)(document.getElementById("app")).render(e.createElement((function(){return(0,e.useEffect)((()=>{document.body.classList.add(`browser-${ge.name.replace(/\s+/g,"-")}`)}),[]),(0,e.useEffect)((()=>{const e=new _;return Object.keys(zf).forEach((t=>{const r=zf[t].observeIsLoggedIn().subscribe((e=>{document.body.classList.toggle(`${t}-connected`,e),document.body.classList.toggle(`${t}-not-connected`,!e)}));e.add(r)})),()=>e.unsubscribe()}),[]),(0,e.useEffect)((()=>{const e=Kr(document,"dragenter"),t=Kr(document,"dragover"),r=Kr(document,"drop"),n=ii(e,t).pipe(Rt(Uf)),i=ii(n,r.pipe(Rt(_e))).subscribe();return()=>i.unsubscribe()}),[]),function(){const t=od(),r=Ff(),n=sh(ac,0),i=sh(sc,0);(0,e.useEffect)((()=>{jf.setPositionState({duration:i,position:n,playbackRate:1})}),[i,n]),(0,e.useEffect)((()=>{const e=t?r?"paused":"playing":"none",n=Vn(0,100).pipe(Nt(2),Rt((()=>{!function(e){var t;jf.metadata=e?new MediaMetadata({title:e.title,artist:e.artist,album:e.artist?"":e.album,artwork:(null===(t=e.thumbnails)||void 0===t?void 0:t.map((e=>({src:e.url,sizes:`${e.width}x${e.height}`}))))||[]}):null}(t),jf.setActionHandler("play",pc),jf.setActionHandler("pause",gc),jf.setActionHandler("stop",bc),jf.setActionHandler("previoustrack",vc),jf.setActionHandler("nexttrack",yc),jf.setActionHandler("seekto",(e=>{null!=e.seekTime&&Ac(e.seekTime)})),jf.playbackState=e}))).subscribe();return()=>n.unsubscribe()}),[t,r])}(),function(){const t=Ff();(0,e.useEffect)((()=>{document.getElementById("system").addEventListener("keydown",Te),document.getElementById("popup").addEventListener("keydown",Te)}),[]),(0,e.useEffect)((()=>{document.body.addEventListener("keydown",(e=>function(e,t){switch(e.key){case" ":case"MediaPlayPause":e.preventDefault(),t?Sc.play():Sc.pause();break;case"MediaStop":e.preventDefault(),Sc.stop();break;case"MediaTrackPrevious":e.preventDefault(),Sc.prev();break;case"MediaTrackNext":e.preventDefault(),Sc.next();break;case"AudioVolumeMute":e.preventDefault(),Sc.muted=!0}}(e,t)))}),[t])}(),function(){(0,e.useEffect)((()=>{(()=>{var e,t,r,n;e=this,t=void 0,n=function*(){var e,t,r,n;const{state:i="granted"}=(yield null===(e=navigator.permissions)||void 0===e?void 0:e.query({name:"persistent-storage"}))||{};let a=yield null===(r=null===(t=navigator.storage)||void 0===t?void 0:t.persisted)||void 0===r?void 0:r.call(t);"granted"!==i||a||(a=yield null===(n=navigator.storage)||void 0===n?void 0:n.persist()),console.log("Persisted storage:",{state:i,persisted:a})},new((r=void 0)||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}l((n=n.apply(e,t||[])).next())}))})()}),[])}(),e.createElement("main",null,e.createElement(u,{id:"main-layout",arrange:"columns"},e.createElement(bf,null),e.createElement(Of,null)))}),null))})()})();